2022-09-20 17:02:39.534 +01:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2022-09-20 17:02:39.701 +01:00 [DBG] Hosting starting
2022-09-20 17:02:40.086 +01:00 [DBG] Using development certificate: CN=localhost (Thumbprint: 9CC642E9838495A6C3C202DECA6A8AD300396DD2)
2022-09-20 17:02:40.166 +01:00 [INF] Now listening on: https://localhost:7036
2022-09-20 17:02:40.168 +01:00 [INF] Now listening on: http://localhost:5036
2022-09-20 17:02:40.169 +01:00 [DBG] Loaded hosting startup assembly APIBank
2022-09-20 17:02:40.170 +01:00 [DBG] Loaded hosting startup assembly Microsoft.AspNetCore.Watch.BrowserRefresh
2022-09-20 17:02:40.171 +01:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.BrowserLink.Net
2022-09-20 17:02:40.172 +01:00 [INF] Application started. Press Ctrl+C to shut down.
2022-09-20 17:02:40.173 +01:00 [INF] Hosting environment: Development
2022-09-20 17:02:40.173 +01:00 [INF] Content root path: C:\Users\mguedesa\OneDrive - NTT DATA EMEAL\Documentos\GitHub\OpenBankAPI-NTT\APIBank\APIBank\
2022-09-20 17:02:40.174 +01:00 [DBG] Hosting started
2022-09-20 17:02:40.332 +01:00 [DBG] Connection id "0HMKR465O8PAV" accepted.
2022-09-20 17:02:40.332 +01:00 [DBG] Connection id "0HMKR465O8PAU" accepted.
2022-09-20 17:02:40.337 +01:00 [DBG] Connection id "0HMKR465O8PAV" started.
2022-09-20 17:02:40.337 +01:00 [DBG] Connection id "0HMKR465O8PAU" started.
2022-09-20 17:02:40.341 +01:00 [DBG] Connection id "0HMKR465O8PAV" received FIN.
2022-09-20 17:02:40.341 +01:00 [DBG] Connection id "0HMKR465O8PAU" received FIN.
2022-09-20 17:02:40.359 +01:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException:  Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveBlobAsync[TIOAdapter](TIOAdapter adapter)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](TIOAdapter adapter, Boolean receiveFirst, Byte[] reAuthenticationData, Boolean isApm)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2022-09-20 17:02:40.359 +01:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException:  Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveBlobAsync[TIOAdapter](TIOAdapter adapter)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](TIOAdapter adapter, Boolean receiveFirst, Byte[] reAuthenticationData, Boolean isApm)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2022-09-20 17:02:40.431 +01:00 [DBG] Connection id "0HMKR465O8PAU" stopped.
2022-09-20 17:02:40.431 +01:00 [DBG] Connection id "0HMKR465O8PAV" stopped.
2022-09-20 17:02:40.437 +01:00 [DBG] Connection id "0HMKR465O8PAV" sending FIN because: "The Socket transport's send loop completed gracefully."
2022-09-20 17:02:40.437 +01:00 [DBG] Connection id "0HMKR465O8PAU" sending FIN because: "The Socket transport's send loop completed gracefully."
2022-09-20 17:02:40.665 +01:00 [DBG] Connection id "0HMKR465O8PB0" accepted.
2022-09-20 17:02:40.691 +01:00 [DBG] Connection id "0HMKR465O8PB0" started.
2022-09-20 17:02:40.839 +01:00 [DBG] Connection 0HMKR465O8PB0 established using the following protocol: "Tls12"
2022-09-20 17:02:40.962 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/swagger/index.html - -
2022-09-20 17:02:41.038 +01:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2022-09-20 17:02:41.093 +01:00 [DBG] No candidates found for the request path '/swagger/index.html'
2022-09-20 17:02:41.095 +01:00 [DBG] Request did not match any endpoints
2022-09-20 17:02:41.292 +01:00 [DBG] Response markup is scheduled to include browser refresh script injection.
2022-09-20 17:02:41.584 +01:00 [DBG] Response markup was updated to include browser refresh script injection.
2022-09-20 17:02:41.599 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/swagger/index.html - - - 200 - text/html;charset=utf-8 642.9255ms
2022-09-20 17:02:41.650 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/_framework/aspnetcore-browser-refresh.js - -
2022-09-20 17:02:41.650 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/_vs/browserLink - -
2022-09-20 17:02:41.662 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/_framework/aspnetcore-browser-refresh.js - - - 200 11984 application/javascript;+charset=utf-8 12.0291ms
2022-09-20 17:02:41.787 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/_vs/browserLink - - - 200 - text/javascript;+charset=UTF-8 136.8861ms
2022-09-20 17:02:41.856 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/swagger/v1/swagger.json - -
2022-09-20 17:02:41.860 +01:00 [DBG] No candidates found for the request path '/swagger/v1/swagger.json'
2022-09-20 17:02:41.861 +01:00 [DBG] Request did not match any endpoints
2022-09-20 17:02:42.111 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/swagger/v1/swagger.json - - - 200 - application/json;charset=utf-8 255.6445ms
2022-09-20 17:02:58.717 +01:00 [INF] Request starting HTTP/2 POST https://localhost:7036/api/Accounts/Create application/json 39
2022-09-20 17:02:58.739 +01:00 [DBG] 1 candidate(s) found for the request path '/api/Accounts/Create'
2022-09-20 17:02:58.749 +01:00 [DBG] Endpoint 'APIBank.Controllers.AccountsController.Create (APIBank)' with route pattern 'api/Accounts/Create' is valid for the request path '/api/Accounts/Create'
2022-09-20 17:02:58.757 +01:00 [DBG] Request matched endpoint 'APIBank.Controllers.AccountsController.Create (APIBank)'
2022-09-20 17:02:58.761 +01:00 [DBG] Static files was skipped as the request already matched an endpoint.
2022-09-20 17:02:59.246 +01:00 [INF] Executing endpoint 'APIBank.Controllers.AccountsController.Create (APIBank)'
2022-09-20 17:02:59.276 +01:00 [INF] Route matched with {action = "Create", controller = "Accounts"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult Create(APIBank.Models.Accounts.Requests.CreateAccountRequest, System.String) on controller APIBank.Controllers.AccountsController (APIBank).
2022-09-20 17:02:59.280 +01:00 [DBG] Execution plan of authorization filters (in the following order): ["APIBank.Authorization.AuthorizeAttribute"]
2022-09-20 17:02:59.282 +01:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2022-09-20 17:02:59.284 +01:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2022-09-20 17:02:59.288 +01:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2022-09-20 17:02:59.289 +01:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2022-09-20 17:02:59.291 +01:00 [INF] Authorization failed for the request at filter 'APIBank.Authorization.AuthorizeAttribute'.
2022-09-20 17:02:59.293 +01:00 [INF] Executing JsonResult, writing value of type '<>f__AnonymousType0`1[[System.String, System.Private.CoreLib, Version=6.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2022-09-20 17:02:59.306 +01:00 [INF] Executed action APIBank.Controllers.AccountsController.Create (APIBank) in 8.6448ms
2022-09-20 17:02:59.308 +01:00 [INF] Executed endpoint 'APIBank.Controllers.AccountsController.Create (APIBank)'
2022-09-20 17:02:59.313 +01:00 [INF] Request finished HTTP/2 POST https://localhost:7036/api/Accounts/Create application/json 39 - 401 - application/json;+charset=utf-8 595.7103ms
2022-09-20 17:02:59.315 +01:00 [DBG] Connection id "0HMKR465O8PB0", Request id "0HMKR465O8PB0:00000009": started reading request body.
2022-09-20 17:02:59.317 +01:00 [DBG] Connection id "0HMKR465O8PB0", Request id "0HMKR465O8PB0:00000009": done reading request body.
2022-09-20 17:03:16.848 +01:00 [INF] Request starting HTTP/2 POST https://localhost:7036/api/Users/Login application/json 58
2022-09-20 17:03:16.853 +01:00 [DBG] 1 candidate(s) found for the request path '/api/Users/Login'
2022-09-20 17:03:16.857 +01:00 [DBG] Endpoint 'APIBank.Controllers.UsersController.Login (APIBank)' with route pattern 'api/Users/Login' is valid for the request path '/api/Users/Login'
2022-09-20 17:03:16.860 +01:00 [DBG] Request matched endpoint 'APIBank.Controllers.UsersController.Login (APIBank)'
2022-09-20 17:03:16.862 +01:00 [DBG] Static files was skipped as the request already matched an endpoint.
2022-09-20 17:03:16.874 +01:00 [INF] Executing endpoint 'APIBank.Controllers.UsersController.Login (APIBank)'
2022-09-20 17:03:16.878 +01:00 [INF] Route matched with {action = "Login", controller = "Users"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult Login(APIBank.Models.Requests.LoginRequest) on controller APIBank.Controllers.UsersController (APIBank).
2022-09-20 17:03:16.879 +01:00 [DBG] Execution plan of authorization filters (in the following order): ["APIBank.Authorization.AuthorizeAttribute"]
2022-09-20 17:03:16.881 +01:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2022-09-20 17:03:16.882 +01:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2022-09-20 17:03:16.888 +01:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2022-09-20 17:03:16.890 +01:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2022-09-20 17:03:16.892 +01:00 [DBG] Executing controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-20 17:03:16.896 +01:00 [DBG] Executed controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-20 17:03:16.917 +01:00 [DBG] Attempting to bind parameter 'model' of type 'APIBank.Models.Requests.LoginRequest' ...
2022-09-20 17:03:16.924 +01:00 [DBG] Attempting to bind parameter 'model' of type 'APIBank.Models.Requests.LoginRequest' using the name '' in request data ...
2022-09-20 17:03:16.927 +01:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2022-09-20 17:03:16.932 +01:00 [DBG] Connection id "0HMKR465O8PB0", Request id "0HMKR465O8PB0:0000000B": started reading request body.
2022-09-20 17:03:16.936 +01:00 [DBG] Connection id "0HMKR465O8PB0", Request id "0HMKR465O8PB0:0000000B": done reading request body.
2022-09-20 17:03:16.943 +01:00 [DBG] JSON input formatter succeeded, deserializing to type 'APIBank.Models.Requests.LoginRequest'
2022-09-20 17:03:16.944 +01:00 [DBG] Done attempting to bind parameter 'model' of type 'APIBank.Models.Requests.LoginRequest'.
2022-09-20 17:03:16.947 +01:00 [DBG] Done attempting to bind parameter 'model' of type 'APIBank.Models.Requests.LoginRequest'.
2022-09-20 17:03:16.948 +01:00 [DBG] Attempting to validate the bound parameter 'model' of type 'APIBank.Models.Requests.LoginRequest' ...
2022-09-20 17:03:16.959 +01:00 [DBG] Done attempting to validate the bound parameter 'model' of type 'APIBank.Models.Requests.LoginRequest'.
2022-09-20 17:03:17.131 +01:00 [DBG] An additional 'IServiceProvider' was created for internal use by Entity Framework. An existing service provider was not used due to the following configuration changes: configuration changed for 'Core:ConfigureWarnings', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:UseAdminDatabase', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:SetPostgresVersion', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:UseRedshift', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:ReverseNullOrdering', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:RemoteCertificateValidationCallback', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:ProvideClientCertificatesCallback', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:ProvidePasswordCallback'.
2022-09-20 17:03:18.824 +01:00 [INF] Entity Framework Core 6.0.9 initialized 'PostgresContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:6.0.7+5b98e4b74de93b590b44aef8dd7967c03acc433c' with options: None
2022-09-20 17:03:18.908 +01:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .SingleOrDefault(x => x.Username == __model_Username_0)'
2022-09-20 17:03:19.443 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<User>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: User.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: User.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 1], [Property: User.Email (string) Required Index MaxLength(254), 2], [Property: User.FullName (string) Required MaxLength(100), 3], [Property: User.PasswordChangedAt (DateTime) Required ValueGenerated.OnAdd, 4], [Property: User.PasswordHash (string) Required MaxLength(200), 5], [Property: User.Username (string) Required Index MaxLength(50), 6] }
        SELECT TOP(2) u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
        FROM users AS u
        WHERE u.username == @__model_Username_0), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, User>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)
    .SingleOrDefault()'
2022-09-20 17:03:19.512 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-20 17:03:19.642 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (120ms).
2022-09-20 17:03:19.657 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-20 17:03:20.017 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-20 17:03:20.055 +01:00 [DBG] Executing DbCommand [Parameters=[@__model_Username_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.username = @__model_Username_0
LIMIT 2
2022-09-20 17:03:20.205 +01:00 [INF] Executed DbCommand (171ms) [Parameters=[@__model_Username_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.username = @__model_Username_0
LIMIT 2
2022-09-20 17:03:20.276 +01:00 [DBG] Context 'PostgresContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-20 17:03:20.356 +01:00 [DBG] A data reader was disposed.
2022-09-20 17:03:20.364 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-20 17:03:20.375 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-20 17:03:20.847 +01:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .Any(user => user.RefreshTokenCollection
        .Any(reftoken => reftoken.RefToken == __token_0))'
2022-09-20 17:03:21.006 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<bool>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            EmptyProjectionMember -> 0
        SELECT EXISTS (
            SELECT 1
            FROM users AS u
            WHERE EXISTS (
                SELECT 1
                FROM refresh_token AS r
                WHERE ((u.id != NULL) && (u.id == r.user_id)) && (r.token == @__token_0)))), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, bool>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)
    .Single()'
2022-09-20 17:03:21.024 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-20 17:03:21.026 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (2ms).
2022-09-20 17:03:21.027 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-20 17:03:21.028 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-20 17:03:21.028 +01:00 [DBG] Executing DbCommand [Parameters=[@__token_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM users AS u
    WHERE EXISTS (
        SELECT 1
        FROM refresh_token AS r
        WHERE (u.id = r.user_id) AND (r.token = @__token_0)))
2022-09-20 17:03:21.034 +01:00 [INF] Executed DbCommand (6ms) [Parameters=[@__token_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM users AS u
    WHERE EXISTS (
        SELECT 1
        FROM refresh_token AS r
        WHERE (u.id = r.user_id) AND (r.token = @__token_0)))
2022-09-20 17:03:21.040 +01:00 [DBG] A data reader was disposed.
2022-09-20 17:03:21.041 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-20 17:03:21.042 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-20 17:03:21.069 +01:00 [DBG] An entity of type 'User' tracked by 'PostgresContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-20 17:03:21.077 +01:00 [DBG] SaveChanges starting for 'PostgresContext'.
2022-09-20 17:03:21.084 +01:00 [DBG] DetectChanges starting for 'PostgresContext'.
2022-09-20 17:03:21.117 +01:00 [DBG] 1 entities were added and 0 entities were removed from navigation 'User.RefreshTokenCollection'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-20 17:03:21.161 +01:00 [DBG] 'PostgresContext' generated a temporary value for the property 'Id.RefreshToken'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-20 17:03:21.217 +01:00 [DBG] Context 'PostgresContext' started tracking 'RefreshToken' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-20 17:03:21.224 +01:00 [DBG] DetectChanges completed for 'PostgresContext'.
2022-09-20 17:03:21.240 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-20 17:03:21.242 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-20 17:03:21.251 +01:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2022-09-20 17:03:21.263 +01:00 [DBG] Began transaction with isolation level 'ReadCommitted'.
2022-09-20 17:03:21.338 +01:00 [DBG] Executing 2 update commands as a batch.
2022-09-20 17:03:21.376 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-20 17:03:21.378 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (2ms).
2022-09-20 17:03:21.384 +01:00 [DBG] Executing DbCommand [Parameters=[@p0='?' (DbType = DateTime), @p1='?', @p2='?' (DbType = DateTime), @p3='?' (DbType = Boolean), @p4='?' (DbType = Boolean), @p5='?' (DbType = Boolean), @p6='?', @p7='?', @p8='?', @p9='?' (DbType = DateTime), @p10='?', @p11='?' (DbType = Int32), @p18='?' (DbType = Int32), @p12='?' (DbType = DateTime), @p13='?', @p14='?', @p15='?' (DbType = DateTime), @p16='?', @p17='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO refresh_token (created, created_by_ip, expires, is_active, is_expired, is_revoked, reason_revoked, token, replaced_by_token, revoked, revoked_by_ip, user_id)
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11)
RETURNING id;
UPDATE users SET created_at = @p12, email = @p13, full_name = @p14, password_changed_at = @p15, password_hash = @p16, username = @p17
WHERE id = @p18;
2022-09-20 17:03:21.408 +01:00 [INF] Executed DbCommand (24ms) [Parameters=[@p0='?' (DbType = DateTime), @p1='?', @p2='?' (DbType = DateTime), @p3='?' (DbType = Boolean), @p4='?' (DbType = Boolean), @p5='?' (DbType = Boolean), @p6='?', @p7='?', @p8='?', @p9='?' (DbType = DateTime), @p10='?', @p11='?' (DbType = Int32), @p18='?' (DbType = Int32), @p12='?' (DbType = DateTime), @p13='?', @p14='?', @p15='?' (DbType = DateTime), @p16='?', @p17='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO refresh_token (created, created_by_ip, expires, is_active, is_expired, is_revoked, reason_revoked, token, replaced_by_token, revoked, revoked_by_ip, user_id)
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11)
RETURNING id;
UPDATE users SET created_at = @p12, email = @p13, full_name = @p14, password_changed_at = @p15, password_hash = @p16, username = @p17
WHERE id = @p18;
2022-09-20 17:03:21.434 +01:00 [DBG] The foreign key property 'RefreshToken.Id' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2022-09-20 17:03:21.444 +01:00 [DBG] A data reader was disposed.
2022-09-20 17:03:21.452 +01:00 [DBG] Committing transaction.
2022-09-20 17:03:21.465 +01:00 [DBG] Committed transaction.
2022-09-20 17:03:21.469 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-20 17:03:21.471 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-20 17:03:21.478 +01:00 [DBG] Disposing transaction.
2022-09-20 17:03:21.486 +01:00 [DBG] An entity of type 'RefreshToken' tracked by 'PostgresContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-20 17:03:21.488 +01:00 [DBG] An entity of type 'User' tracked by 'PostgresContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-20 17:03:21.492 +01:00 [DBG] SaveChanges completed for 'PostgresContext' with 2 entities written to the database.
2022-09-20 17:03:21.501 +01:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2022-09-20 17:03:21.508 +01:00 [DBG] Attempting to select an output formatter based on Accept header '["text/plain"]'.
2022-09-20 17:03:21.510 +01:00 [DBG] Could not find an output formatter based on content negotiation. Accepted types were (["text/plain"])
2022-09-20 17:03:21.512 +01:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2022-09-20 17:03:21.513 +01:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2022-09-20 17:03:21.516 +01:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2022-09-20 17:03:21.518 +01:00 [INF] Executing OkObjectResult, writing value of type 'APIBank.Models.Users.Responses.LoginResponse'.
2022-09-20 17:03:21.527 +01:00 [INF] Executed action APIBank.Controllers.UsersController.Login (APIBank) in 4635.2552ms
2022-09-20 17:03:21.529 +01:00 [INF] Executed endpoint 'APIBank.Controllers.UsersController.Login (APIBank)'
2022-09-20 17:03:21.537 +01:00 [DBG] 'PostgresContext' disposed.
2022-09-20 17:03:21.544 +01:00 [INF] Request finished HTTP/2 POST https://localhost:7036/api/Users/Login application/json 58 - 200 - application/json;+charset=utf-8 4695.8553ms
2022-09-20 17:03:42.535 +01:00 [INF] Request starting HTTP/2 POST https://localhost:7036/api/Accounts/Create application/json 39
2022-09-20 17:03:42.547 +01:00 [DBG] 1 candidate(s) found for the request path '/api/Accounts/Create'
2022-09-20 17:03:42.550 +01:00 [DBG] Endpoint 'APIBank.Controllers.AccountsController.Create (APIBank)' with route pattern 'api/Accounts/Create' is valid for the request path '/api/Accounts/Create'
2022-09-20 17:03:42.552 +01:00 [DBG] Request matched endpoint 'APIBank.Controllers.AccountsController.Create (APIBank)'
2022-09-20 17:03:42.553 +01:00 [DBG] Static files was skipped as the request already matched an endpoint.
2022-09-20 17:03:42.677 +01:00 [INF] Entity Framework Core 6.0.9 initialized 'PostgresContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:6.0.7+5b98e4b74de93b590b44aef8dd7967c03acc433c' with options: None
2022-09-20 17:03:42.695 +01:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .FirstOrDefault(e => EF.Property<int>(e, "Id") == __p_0)'
2022-09-20 17:03:42.704 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<User>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: User.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: User.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 1], [Property: User.Email (string) Required Index MaxLength(254), 2], [Property: User.FullName (string) Required MaxLength(100), 3], [Property: User.PasswordChangedAt (DateTime) Required ValueGenerated.OnAdd, 4], [Property: User.PasswordHash (string) Required MaxLength(200), 5], [Property: User.Username (string) Required Index MaxLength(50), 6] }
        SELECT TOP(1) u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
        FROM users AS u
        WHERE u.id == @__p_0), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, User>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)
    .SingleOrDefault()'
2022-09-20 17:03:42.708 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-20 17:03:42.709 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2022-09-20 17:03:42.710 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-20 17:03:42.710 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-20 17:03:42.712 +01:00 [DBG] Executing DbCommand [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.id = @__p_0
LIMIT 1
2022-09-20 17:03:42.717 +01:00 [INF] Executed DbCommand (5ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.id = @__p_0
LIMIT 1
2022-09-20 17:03:42.722 +01:00 [DBG] Context 'PostgresContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-20 17:03:42.723 +01:00 [DBG] A data reader was disposed.
2022-09-20 17:03:42.724 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-20 17:03:42.724 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-20 17:03:42.725 +01:00 [INF] Executing endpoint 'APIBank.Controllers.AccountsController.Create (APIBank)'
2022-09-20 17:03:42.726 +01:00 [INF] Route matched with {action = "Create", controller = "Accounts"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult Create(APIBank.Models.Accounts.Requests.CreateAccountRequest, System.String) on controller APIBank.Controllers.AccountsController (APIBank).
2022-09-20 17:03:42.728 +01:00 [DBG] Execution plan of authorization filters (in the following order): ["APIBank.Authorization.AuthorizeAttribute"]
2022-09-20 17:03:42.731 +01:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2022-09-20 17:03:42.732 +01:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2022-09-20 17:03:42.736 +01:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2022-09-20 17:03:42.738 +01:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2022-09-20 17:03:42.740 +01:00 [DBG] Executing controller factory for controller APIBank.Controllers.AccountsController (APIBank)
2022-09-20 17:03:42.741 +01:00 [DBG] Executed controller factory for controller APIBank.Controllers.AccountsController (APIBank)
2022-09-20 17:03:42.742 +01:00 [DBG] Attempting to bind parameter 'model' of type 'APIBank.Models.Accounts.Requests.CreateAccountRequest' ...
2022-09-20 17:03:42.744 +01:00 [DBG] Attempting to bind parameter 'model' of type 'APIBank.Models.Accounts.Requests.CreateAccountRequest' using the name '' in request data ...
2022-09-20 17:03:42.745 +01:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2022-09-20 17:03:42.752 +01:00 [DBG] Connection id "0HMKR465O8PB0", Request id "0HMKR465O8PB0:0000000D": started reading request body.
2022-09-20 17:03:42.753 +01:00 [DBG] Connection id "0HMKR465O8PB0", Request id "0HMKR465O8PB0:0000000D": done reading request body.
2022-09-20 17:03:42.759 +01:00 [DBG] JSON input formatter succeeded, deserializing to type 'APIBank.Models.Accounts.Requests.CreateAccountRequest'
2022-09-20 17:03:42.760 +01:00 [DBG] Done attempting to bind parameter 'model' of type 'APIBank.Models.Accounts.Requests.CreateAccountRequest'.
2022-09-20 17:03:42.761 +01:00 [DBG] Done attempting to bind parameter 'model' of type 'APIBank.Models.Accounts.Requests.CreateAccountRequest'.
2022-09-20 17:03:42.763 +01:00 [DBG] Attempting to validate the bound parameter 'model' of type 'APIBank.Models.Accounts.Requests.CreateAccountRequest' ...
2022-09-20 17:03:42.770 +01:00 [DBG] Done attempting to validate the bound parameter 'model' of type 'APIBank.Models.Accounts.Requests.CreateAccountRequest'.
2022-09-20 17:03:42.772 +01:00 [DBG] Attempting to bind parameter 'token' of type 'System.String' ...
2022-09-20 17:03:42.774 +01:00 [DBG] Attempting to bind parameter 'token' of type 'System.String' using the name '' in request data ...
2022-09-20 17:03:42.777 +01:00 [DBG] Attempting to bind parameter 'token' of type 'System.String' using the name '' in request data ...
2022-09-20 17:03:42.782 +01:00 [DBG] Done attempting to bind parameter 'token' of type 'System.String'.
2022-09-20 17:03:42.785 +01:00 [DBG] Done attempting to bind parameter 'token' of type 'System.String'.
2022-09-20 17:03:42.786 +01:00 [DBG] Done attempting to bind parameter 'token' of type 'System.String'.
2022-09-20 17:03:42.788 +01:00 [DBG] Attempting to validate the bound parameter 'token' of type 'System.String' ...
2022-09-20 17:03:42.789 +01:00 [DBG] Done attempting to validate the bound parameter 'token' of type 'System.String'.
2022-09-20 17:03:42.795 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-20 17:03:42.798 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-20 17:03:42.800 +01:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2022-09-20 17:03:42.801 +01:00 [DBG] Began transaction with isolation level 'ReadCommitted'.
2022-09-20 17:03:42.805 +01:00 [DBG] 'PostgresContext' generated a temporary value for the property 'Id.Account'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-20 17:03:42.827 +01:00 [DBG] Context 'PostgresContext' started tracking 'Account' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-20 17:03:42.829 +01:00 [DBG] SaveChanges starting for 'PostgresContext'.
2022-09-20 17:03:42.831 +01:00 [DBG] DetectChanges starting for 'PostgresContext'.
2022-09-20 17:03:42.843 +01:00 [DBG] DetectChanges completed for 'PostgresContext'.
2022-09-20 17:03:42.850 +01:00 [DBG] Creating transaction savepoint.
2022-09-20 17:03:42.858 +01:00 [DBG] Created transaction savepoint.
2022-09-20 17:03:42.860 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-20 17:03:42.861 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2022-09-20 17:03:42.865 +01:00 [DBG] Executing DbCommand [Parameters=[@p0='?' (DbType = Decimal), @p1='?', @p2='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO accounts (balance, currency, user_id)
VALUES (@p0, @p1, @p2)
RETURNING id, created_at;
2022-09-20 17:03:42.889 +01:00 [INF] Executed DbCommand (24ms) [Parameters=[@p0='?' (DbType = Decimal), @p1='?', @p2='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO accounts (balance, currency, user_id)
VALUES (@p0, @p1, @p2)
RETURNING id, created_at;
2022-09-20 17:03:42.895 +01:00 [DBG] The foreign key property 'Account.Id' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2022-09-20 17:03:42.901 +01:00 [DBG] A data reader was disposed.
2022-09-20 17:03:42.908 +01:00 [DBG] Releasing transaction savepoint.
2022-09-20 17:03:42.914 +01:00 [DBG] Released transaction savepoint.
2022-09-20 17:03:42.924 +01:00 [DBG] An entity of type 'Account' tracked by 'PostgresContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-20 17:03:42.926 +01:00 [DBG] SaveChanges completed for 'PostgresContext' with 1 entities written to the database.
2022-09-20 17:03:42.931 +01:00 [DBG] 'PostgresContext' generated a temporary value for the property 'Id.Transaction'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-20 17:03:42.950 +01:00 [DBG] Context 'PostgresContext' started tracking 'Transaction' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-20 17:03:42.952 +01:00 [DBG] SaveChanges starting for 'PostgresContext'.
2022-09-20 17:03:42.954 +01:00 [DBG] DetectChanges starting for 'PostgresContext'.
2022-09-20 17:03:42.957 +01:00 [DBG] DetectChanges completed for 'PostgresContext'.
2022-09-20 17:03:42.958 +01:00 [DBG] Creating transaction savepoint.
2022-09-20 17:03:42.959 +01:00 [DBG] Created transaction savepoint.
2022-09-20 17:03:42.960 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-20 17:03:42.960 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2022-09-20 17:03:42.962 +01:00 [DBG] Executing DbCommand [Parameters=[@p0='?' (DbType = Int32), @p1='?' (DbType = Decimal), @p2='?' (DbType = Decimal)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO transactions (account_id, amount, balance)
VALUES (@p0, @p1, @p2)
RETURNING id, created_at;
2022-09-20 17:03:42.969 +01:00 [INF] Executed DbCommand (7ms) [Parameters=[@p0='?' (DbType = Int32), @p1='?' (DbType = Decimal), @p2='?' (DbType = Decimal)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO transactions (account_id, amount, balance)
VALUES (@p0, @p1, @p2)
RETURNING id, created_at;
2022-09-20 17:03:42.974 +01:00 [DBG] The foreign key property 'Transaction.Id' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2022-09-20 17:03:42.975 +01:00 [DBG] A data reader was disposed.
2022-09-20 17:03:42.976 +01:00 [DBG] Releasing transaction savepoint.
2022-09-20 17:03:42.977 +01:00 [DBG] Released transaction savepoint.
2022-09-20 17:03:42.981 +01:00 [DBG] An entity of type 'Transaction' tracked by 'PostgresContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-20 17:03:42.984 +01:00 [DBG] SaveChanges completed for 'PostgresContext' with 1 entities written to the database.
2022-09-20 17:03:42.985 +01:00 [DBG] Committing transaction.
2022-09-20 17:03:42.986 +01:00 [DBG] Committed transaction.
2022-09-20 17:03:42.987 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-20 17:03:42.988 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-20 17:03:42.989 +01:00 [DBG] Disposing transaction.
2022-09-20 17:03:42.990 +01:00 [INF] Account Created
2022-09-20 17:03:42.991 +01:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2022-09-20 17:03:42.993 +01:00 [DBG] Attempting to select an output formatter based on Accept header '["text/plain"]'.
2022-09-20 17:03:42.994 +01:00 [DBG] Could not find an output formatter based on content negotiation. Accepted types were (["text/plain"])
2022-09-20 17:03:42.996 +01:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2022-09-20 17:03:43.000 +01:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2022-09-20 17:03:43.001 +01:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2022-09-20 17:03:43.002 +01:00 [INF] Executing CreatedResult, writing value of type '<>f__AnonymousType0`1[[System.String, System.Private.CoreLib, Version=6.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2022-09-20 17:03:43.005 +01:00 [INF] Executed action APIBank.Controllers.AccountsController.Create (APIBank) in 265.7545ms
2022-09-20 17:03:43.007 +01:00 [INF] Executed endpoint 'APIBank.Controllers.AccountsController.Create (APIBank)'
2022-09-20 17:03:43.013 +01:00 [DBG] 'PostgresContext' disposed.
2022-09-20 17:03:43.015 +01:00 [INF] Request finished HTTP/2 POST https://localhost:7036/api/Accounts/Create application/json 39 - 201 - application/json;+charset=utf-8 481.2088ms
2022-09-20 17:03:57.531 +01:00 [INF] Request starting HTTP/2 POST https://localhost:7036/api/Accounts/Create application/json 41
2022-09-20 17:03:57.535 +01:00 [DBG] 1 candidate(s) found for the request path '/api/Accounts/Create'
2022-09-20 17:03:57.540 +01:00 [DBG] Endpoint 'APIBank.Controllers.AccountsController.Create (APIBank)' with route pattern 'api/Accounts/Create' is valid for the request path '/api/Accounts/Create'
2022-09-20 17:03:57.545 +01:00 [DBG] Request matched endpoint 'APIBank.Controllers.AccountsController.Create (APIBank)'
2022-09-20 17:03:57.546 +01:00 [DBG] Static files was skipped as the request already matched an endpoint.
2022-09-20 17:03:57.602 +01:00 [INF] Entity Framework Core 6.0.9 initialized 'PostgresContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:6.0.7+5b98e4b74de93b590b44aef8dd7967c03acc433c' with options: None
2022-09-20 17:03:57.609 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-20 17:03:57.610 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2022-09-20 17:03:57.611 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-20 17:03:57.612 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-20 17:03:57.614 +01:00 [DBG] Executing DbCommand [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.id = @__p_0
LIMIT 1
2022-09-20 17:03:57.619 +01:00 [INF] Executed DbCommand (5ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.id = @__p_0
LIMIT 1
2022-09-20 17:03:57.623 +01:00 [DBG] Context 'PostgresContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-20 17:03:57.624 +01:00 [DBG] A data reader was disposed.
2022-09-20 17:03:57.625 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-20 17:03:57.626 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-20 17:03:57.627 +01:00 [INF] Executing endpoint 'APIBank.Controllers.AccountsController.Create (APIBank)'
2022-09-20 17:03:57.630 +01:00 [INF] Route matched with {action = "Create", controller = "Accounts"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult Create(APIBank.Models.Accounts.Requests.CreateAccountRequest, System.String) on controller APIBank.Controllers.AccountsController (APIBank).
2022-09-20 17:03:57.631 +01:00 [DBG] Execution plan of authorization filters (in the following order): ["APIBank.Authorization.AuthorizeAttribute"]
2022-09-20 17:03:57.632 +01:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2022-09-20 17:03:57.635 +01:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2022-09-20 17:03:57.638 +01:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2022-09-20 17:03:57.639 +01:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2022-09-20 17:03:57.640 +01:00 [DBG] Executing controller factory for controller APIBank.Controllers.AccountsController (APIBank)
2022-09-20 17:03:57.641 +01:00 [DBG] Executed controller factory for controller APIBank.Controllers.AccountsController (APIBank)
2022-09-20 17:03:57.642 +01:00 [DBG] Attempting to bind parameter 'model' of type 'APIBank.Models.Accounts.Requests.CreateAccountRequest' ...
2022-09-20 17:03:57.644 +01:00 [DBG] Attempting to bind parameter 'model' of type 'APIBank.Models.Accounts.Requests.CreateAccountRequest' using the name '' in request data ...
2022-09-20 17:03:57.646 +01:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2022-09-20 17:03:57.647 +01:00 [DBG] Connection id "0HMKR465O8PB0", Request id "0HMKR465O8PB0:0000000F": started reading request body.
2022-09-20 17:03:57.648 +01:00 [DBG] Connection id "0HMKR465O8PB0", Request id "0HMKR465O8PB0:0000000F": done reading request body.
2022-09-20 17:03:57.649 +01:00 [DBG] JSON input formatter succeeded, deserializing to type 'APIBank.Models.Accounts.Requests.CreateAccountRequest'
2022-09-20 17:03:57.651 +01:00 [DBG] Done attempting to bind parameter 'model' of type 'APIBank.Models.Accounts.Requests.CreateAccountRequest'.
2022-09-20 17:03:57.652 +01:00 [DBG] Done attempting to bind parameter 'model' of type 'APIBank.Models.Accounts.Requests.CreateAccountRequest'.
2022-09-20 17:03:57.653 +01:00 [DBG] Attempting to validate the bound parameter 'model' of type 'APIBank.Models.Accounts.Requests.CreateAccountRequest' ...
2022-09-20 17:03:57.655 +01:00 [DBG] Done attempting to validate the bound parameter 'model' of type 'APIBank.Models.Accounts.Requests.CreateAccountRequest'.
2022-09-20 17:03:57.656 +01:00 [DBG] Attempting to bind parameter 'token' of type 'System.String' ...
2022-09-20 17:03:57.657 +01:00 [DBG] Attempting to bind parameter 'token' of type 'System.String' using the name '' in request data ...
2022-09-20 17:03:57.660 +01:00 [DBG] Could not find a value in the request with name '' for binding parameter 'token' of type 'System.String'.
2022-09-20 17:03:57.661 +01:00 [DBG] Attempting to bind parameter 'token' of type 'System.String' using the name '' in request data ...
2022-09-20 17:03:57.663 +01:00 [DBG] Could not find a value in the request with name '' for binding parameter 'token' of type 'System.String'.
2022-09-20 17:03:57.664 +01:00 [DBG] Done attempting to bind parameter 'token' of type 'System.String'.
2022-09-20 17:03:57.665 +01:00 [DBG] Done attempting to bind parameter 'token' of type 'System.String'.
2022-09-20 17:03:57.667 +01:00 [DBG] Done attempting to bind parameter 'token' of type 'System.String'.
2022-09-20 17:03:57.669 +01:00 [DBG] Attempting to validate the bound parameter 'token' of type 'System.String' ...
2022-09-20 17:03:57.671 +01:00 [DBG] Done attempting to validate the bound parameter 'token' of type 'System.String'.
2022-09-20 17:03:57.672 +01:00 [DBG] The request has model state errors, returning an error response.
2022-09-20 17:03:57.674 +01:00 [DBG] Request was short circuited at action filter 'Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter'.
2022-09-20 17:03:57.675 +01:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2022-09-20 17:03:57.677 +01:00 [DBG] Attempting to select an output formatter based on Accept header '["text/plain"]' and explicitly specified content types '["application/problem+json","application/problem+xml","application/problem+json","application/problem+xml"]'. The content types in the accept header must be a subset of the explicitly set content types.
2022-09-20 17:03:57.680 +01:00 [DBG] Could not find an output formatter based on content negotiation. Accepted types were (["text/plain"])
2022-09-20 17:03:57.681 +01:00 [DBG] Attempting to select the first output formatter in the output formatters list which supports a content type from the explicitly specified content types '["application/problem+json","application/problem+xml","application/problem+json","application/problem+xml"]'.
2022-09-20 17:03:57.684 +01:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/problem+json' to write the response.
2022-09-20 17:03:57.686 +01:00 [INF] Executing BadRequestObjectResult, writing value of type 'Microsoft.AspNetCore.Mvc.ValidationProblemDetails'.
2022-09-20 17:03:57.691 +01:00 [INF] Executed action APIBank.Controllers.AccountsController.Create (APIBank) in 50.7486ms
2022-09-20 17:03:57.692 +01:00 [INF] Executed endpoint 'APIBank.Controllers.AccountsController.Create (APIBank)'
2022-09-20 17:03:57.693 +01:00 [DBG] 'PostgresContext' disposed.
2022-09-20 17:03:57.695 +01:00 [INF] Request finished HTTP/2 POST https://localhost:7036/api/Accounts/Create application/json 41 - 400 - application/problem+json;+charset=utf-8 163.7751ms
2022-09-20 17:05:23.090 +01:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2022-09-20 17:05:23.212 +01:00 [DBG] Hosting starting
2022-09-20 17:05:23.385 +01:00 [DBG] Using development certificate: CN=localhost (Thumbprint: 9CC642E9838495A6C3C202DECA6A8AD300396DD2)
2022-09-20 17:05:23.434 +01:00 [INF] Now listening on: https://localhost:7036
2022-09-20 17:05:23.436 +01:00 [INF] Now listening on: http://localhost:5036
2022-09-20 17:05:23.436 +01:00 [DBG] Loaded hosting startup assembly APIBank
2022-09-20 17:05:23.437 +01:00 [DBG] Loaded hosting startup assembly Microsoft.AspNetCore.Watch.BrowserRefresh
2022-09-20 17:05:23.438 +01:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.BrowserLink.Net
2022-09-20 17:05:23.439 +01:00 [INF] Application started. Press Ctrl+C to shut down.
2022-09-20 17:05:23.439 +01:00 [INF] Hosting environment: Development
2022-09-20 17:05:23.440 +01:00 [INF] Content root path: C:\Users\mguedesa\OneDrive - NTT DATA EMEAL\Documentos\GitHub\OpenBankAPI-NTT\APIBank\APIBank\
2022-09-20 17:05:23.440 +01:00 [DBG] Hosting started
2022-09-20 17:05:23.798 +01:00 [DBG] Connection id "0HMKR47MF7UNF" received FIN.
2022-09-20 17:05:23.798 +01:00 [DBG] Connection id "0HMKR47MF7UNE" received FIN.
2022-09-20 17:05:23.815 +01:00 [DBG] Connection id "0HMKR47MF7UNE" accepted.
2022-09-20 17:05:23.815 +01:00 [DBG] Connection id "0HMKR47MF7UNF" accepted.
2022-09-20 17:05:23.818 +01:00 [DBG] Connection id "0HMKR47MF7UNE" started.
2022-09-20 17:05:23.818 +01:00 [DBG] Connection id "0HMKR47MF7UNF" started.
2022-09-20 17:05:23.843 +01:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException:  Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveBlobAsync[TIOAdapter](TIOAdapter adapter)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](TIOAdapter adapter, Boolean receiveFirst, Byte[] reAuthenticationData, Boolean isApm)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2022-09-20 17:05:23.843 +01:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException:  Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveBlobAsync[TIOAdapter](TIOAdapter adapter)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](TIOAdapter adapter, Boolean receiveFirst, Byte[] reAuthenticationData, Boolean isApm)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2022-09-20 17:05:23.914 +01:00 [DBG] Connection id "0HMKR47MF7UNE" stopped.
2022-09-20 17:05:23.915 +01:00 [DBG] Connection id "0HMKR47MF7UNF" stopped.
2022-09-20 17:05:23.936 +01:00 [DBG] Connection id "0HMKR47MF7UNE" sending FIN because: "The Socket transport's send loop completed gracefully."
2022-09-20 17:05:23.937 +01:00 [DBG] Connection id "0HMKR47MF7UNF" sending FIN because: "The Socket transport's send loop completed gracefully."
2022-09-20 17:05:24.002 +01:00 [DBG] Connection id "0HMKR47MF7UNG" accepted.
2022-09-20 17:05:24.004 +01:00 [DBG] Connection id "0HMKR47MF7UNG" started.
2022-09-20 17:05:24.065 +01:00 [DBG] Connection 0HMKR47MF7UNG established using the following protocol: "Tls12"
2022-09-20 17:05:24.159 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/swagger/index.html - -
2022-09-20 17:05:24.206 +01:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2022-09-20 17:05:24.227 +01:00 [DBG] No candidates found for the request path '/swagger/index.html'
2022-09-20 17:05:24.228 +01:00 [DBG] Request did not match any endpoints
2022-09-20 17:05:24.331 +01:00 [DBG] Response markup is scheduled to include browser refresh script injection.
2022-09-20 17:05:24.495 +01:00 [DBG] Response markup was updated to include browser refresh script injection.
2022-09-20 17:05:24.503 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/swagger/index.html - - - 200 - text/html;charset=utf-8 350.8386ms
2022-09-20 17:05:24.529 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/_vs/browserLink - -
2022-09-20 17:05:24.529 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/_framework/aspnetcore-browser-refresh.js - -
2022-09-20 17:05:24.543 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/_framework/aspnetcore-browser-refresh.js - - - 200 11984 application/javascript;+charset=utf-8 13.7791ms
2022-09-20 17:05:24.553 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/_vs/browserLink - - - 200 - text/javascript;+charset=UTF-8 23.6162ms
2022-09-20 17:05:24.656 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/swagger/v1/swagger.json - -
2022-09-20 17:05:24.658 +01:00 [DBG] No candidates found for the request path '/swagger/v1/swagger.json'
2022-09-20 17:05:24.659 +01:00 [DBG] Request did not match any endpoints
2022-09-20 17:05:24.839 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/swagger/v1/swagger.json - - - 200 - application/json;charset=utf-8 182.6382ms
2022-09-20 17:05:38.223 +01:00 [INF] Request starting HTTP/2 POST https://localhost:7036/api/Users/Login application/json 56
2022-09-20 17:05:38.238 +01:00 [DBG] 1 candidate(s) found for the request path '/api/Users/Login'
2022-09-20 17:05:38.244 +01:00 [DBG] Endpoint 'APIBank.Controllers.UsersController.Login (APIBank)' with route pattern 'api/Users/Login' is valid for the request path '/api/Users/Login'
2022-09-20 17:05:38.248 +01:00 [DBG] Request matched endpoint 'APIBank.Controllers.UsersController.Login (APIBank)'
2022-09-20 17:05:38.253 +01:00 [DBG] Static files was skipped as the request already matched an endpoint.
2022-09-20 17:05:38.722 +01:00 [INF] Executing endpoint 'APIBank.Controllers.UsersController.Login (APIBank)'
2022-09-20 17:05:38.758 +01:00 [INF] Route matched with {action = "Login", controller = "Users"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult Login(APIBank.Models.Requests.LoginRequest) on controller APIBank.Controllers.UsersController (APIBank).
2022-09-20 17:05:38.764 +01:00 [DBG] Execution plan of authorization filters (in the following order): ["APIBank.Authorization.AuthorizeAttribute"]
2022-09-20 17:05:38.767 +01:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2022-09-20 17:05:38.770 +01:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2022-09-20 17:05:38.772 +01:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2022-09-20 17:05:38.773 +01:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2022-09-20 17:05:38.776 +01:00 [DBG] Executing controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-20 17:05:38.778 +01:00 [DBG] Executed controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-20 17:05:38.798 +01:00 [DBG] Attempting to bind parameter 'model' of type 'APIBank.Models.Requests.LoginRequest' ...
2022-09-20 17:05:38.803 +01:00 [DBG] Attempting to bind parameter 'model' of type 'APIBank.Models.Requests.LoginRequest' using the name '' in request data ...
2022-09-20 17:05:38.806 +01:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2022-09-20 17:05:38.814 +01:00 [DBG] Connection id "0HMKR47MF7UNG", Request id "0HMKR47MF7UNG:00000009": started reading request body.
2022-09-20 17:05:38.817 +01:00 [DBG] Connection id "0HMKR47MF7UNG", Request id "0HMKR47MF7UNG:00000009": done reading request body.
2022-09-20 17:05:38.825 +01:00 [DBG] JSON input formatter succeeded, deserializing to type 'APIBank.Models.Requests.LoginRequest'
2022-09-20 17:05:38.830 +01:00 [DBG] Done attempting to bind parameter 'model' of type 'APIBank.Models.Requests.LoginRequest'.
2022-09-20 17:05:38.833 +01:00 [DBG] Done attempting to bind parameter 'model' of type 'APIBank.Models.Requests.LoginRequest'.
2022-09-20 17:05:38.834 +01:00 [DBG] Attempting to validate the bound parameter 'model' of type 'APIBank.Models.Requests.LoginRequest' ...
2022-09-20 17:05:38.851 +01:00 [DBG] Done attempting to validate the bound parameter 'model' of type 'APIBank.Models.Requests.LoginRequest'.
2022-09-20 17:05:39.004 +01:00 [DBG] An additional 'IServiceProvider' was created for internal use by Entity Framework. An existing service provider was not used due to the following configuration changes: configuration changed for 'Core:ConfigureWarnings', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:UseAdminDatabase', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:SetPostgresVersion', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:UseRedshift', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:ReverseNullOrdering', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:RemoteCertificateValidationCallback', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:ProvideClientCertificatesCallback', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:ProvidePasswordCallback'.
2022-09-20 17:05:40.565 +01:00 [INF] Entity Framework Core 6.0.9 initialized 'PostgresContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:6.0.7+5b98e4b74de93b590b44aef8dd7967c03acc433c' with options: None
2022-09-20 17:05:40.655 +01:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .SingleOrDefault(x => x.Username == __model_Username_0)'
2022-09-20 17:05:41.244 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<User>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: User.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: User.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 1], [Property: User.Email (string) Required Index MaxLength(254), 2], [Property: User.FullName (string) Required MaxLength(100), 3], [Property: User.PasswordChangedAt (DateTime) Required ValueGenerated.OnAdd, 4], [Property: User.PasswordHash (string) Required MaxLength(200), 5], [Property: User.Username (string) Required Index MaxLength(50), 6] }
        SELECT TOP(2) u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
        FROM users AS u
        WHERE u.username == @__model_Username_0), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, User>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)
    .SingleOrDefault()'
2022-09-20 17:05:41.306 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-20 17:05:41.420 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (111ms).
2022-09-20 17:05:41.433 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-20 17:05:41.769 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-20 17:05:41.803 +01:00 [DBG] Executing DbCommand [Parameters=[@__model_Username_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.username = @__model_Username_0
LIMIT 2
2022-09-20 17:05:41.980 +01:00 [INF] Executed DbCommand (178ms) [Parameters=[@__model_Username_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.username = @__model_Username_0
LIMIT 2
2022-09-20 17:05:42.007 +01:00 [DBG] A data reader was disposed.
2022-09-20 17:05:42.016 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-20 17:05:42.028 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-20 17:05:48.591 +01:00 [INF] Executed action APIBank.Controllers.UsersController.Login (APIBank) in 9808.6403ms
2022-09-20 17:05:48.596 +01:00 [INF] Executed endpoint 'APIBank.Controllers.UsersController.Login (APIBank)'
2022-09-20 17:05:48.646 +01:00 [DBG] 'PostgresContext' disposed.
2022-09-20 17:05:48.657 +01:00 [INF] Request finished HTTP/2 POST https://localhost:7036/api/Users/Login application/json 56 - 400 - application/json 10434.3781ms
2022-09-20 17:05:57.309 +01:00 [INF] Request starting HTTP/2 POST https://localhost:7036/api/Users/Login application/json 58
2022-09-20 17:05:57.314 +01:00 [DBG] 1 candidate(s) found for the request path '/api/Users/Login'
2022-09-20 17:05:57.317 +01:00 [DBG] Endpoint 'APIBank.Controllers.UsersController.Login (APIBank)' with route pattern 'api/Users/Login' is valid for the request path '/api/Users/Login'
2022-09-20 17:05:57.320 +01:00 [DBG] Request matched endpoint 'APIBank.Controllers.UsersController.Login (APIBank)'
2022-09-20 17:05:57.324 +01:00 [DBG] Static files was skipped as the request already matched an endpoint.
2022-09-20 17:05:57.344 +01:00 [INF] Executing endpoint 'APIBank.Controllers.UsersController.Login (APIBank)'
2022-09-20 17:05:57.347 +01:00 [INF] Route matched with {action = "Login", controller = "Users"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult Login(APIBank.Models.Requests.LoginRequest) on controller APIBank.Controllers.UsersController (APIBank).
2022-09-20 17:05:57.352 +01:00 [DBG] Execution plan of authorization filters (in the following order): ["APIBank.Authorization.AuthorizeAttribute"]
2022-09-20 17:05:57.355 +01:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2022-09-20 17:05:57.356 +01:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2022-09-20 17:05:57.358 +01:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2022-09-20 17:05:57.358 +01:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2022-09-20 17:05:57.360 +01:00 [DBG] Executing controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-20 17:05:57.361 +01:00 [DBG] Executed controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-20 17:05:57.362 +01:00 [DBG] Attempting to bind parameter 'model' of type 'APIBank.Models.Requests.LoginRequest' ...
2022-09-20 17:05:57.364 +01:00 [DBG] Attempting to bind parameter 'model' of type 'APIBank.Models.Requests.LoginRequest' using the name '' in request data ...
2022-09-20 17:05:57.367 +01:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2022-09-20 17:05:57.370 +01:00 [DBG] Connection id "0HMKR47MF7UNG", Request id "0HMKR47MF7UNG:0000000B": started reading request body.
2022-09-20 17:05:57.371 +01:00 [DBG] Connection id "0HMKR47MF7UNG", Request id "0HMKR47MF7UNG:0000000B": done reading request body.
2022-09-20 17:05:57.372 +01:00 [DBG] JSON input formatter succeeded, deserializing to type 'APIBank.Models.Requests.LoginRequest'
2022-09-20 17:05:57.373 +01:00 [DBG] Done attempting to bind parameter 'model' of type 'APIBank.Models.Requests.LoginRequest'.
2022-09-20 17:05:57.374 +01:00 [DBG] Done attempting to bind parameter 'model' of type 'APIBank.Models.Requests.LoginRequest'.
2022-09-20 17:05:57.375 +01:00 [DBG] Attempting to validate the bound parameter 'model' of type 'APIBank.Models.Requests.LoginRequest' ...
2022-09-20 17:05:57.376 +01:00 [DBG] Done attempting to validate the bound parameter 'model' of type 'APIBank.Models.Requests.LoginRequest'.
2022-09-20 17:05:57.387 +01:00 [INF] Entity Framework Core 6.0.9 initialized 'PostgresContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:6.0.7+5b98e4b74de93b590b44aef8dd7967c03acc433c' with options: None
2022-09-20 17:05:57.394 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-20 17:05:57.395 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2022-09-20 17:05:57.397 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-20 17:05:57.399 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-20 17:05:57.403 +01:00 [DBG] Executing DbCommand [Parameters=[@__model_Username_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.username = @__model_Username_0
LIMIT 2
2022-09-20 17:05:57.407 +01:00 [INF] Executed DbCommand (4ms) [Parameters=[@__model_Username_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.username = @__model_Username_0
LIMIT 2
2022-09-20 17:05:57.483 +01:00 [DBG] Context 'PostgresContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-20 17:05:57.567 +01:00 [DBG] A data reader was disposed.
2022-09-20 17:05:57.573 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-20 17:05:57.574 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-20 17:05:58.086 +01:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .Any(user => user.RefreshTokenCollection
        .Any(reftoken => reftoken.RefToken == __token_0))'
2022-09-20 17:05:58.253 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<bool>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            EmptyProjectionMember -> 0
        SELECT EXISTS (
            SELECT 1
            FROM users AS u
            WHERE EXISTS (
                SELECT 1
                FROM refresh_token AS r
                WHERE ((u.id != NULL) && (u.id == r.user_id)) && (r.token == @__token_0)))), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, bool>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)
    .Single()'
2022-09-20 17:05:58.272 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-20 17:05:58.274 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2022-09-20 17:05:58.276 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-20 17:05:58.278 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-20 17:05:58.280 +01:00 [DBG] Executing DbCommand [Parameters=[@__token_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM users AS u
    WHERE EXISTS (
        SELECT 1
        FROM refresh_token AS r
        WHERE (u.id = r.user_id) AND (r.token = @__token_0)))
2022-09-20 17:05:58.285 +01:00 [INF] Executed DbCommand (5ms) [Parameters=[@__token_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM users AS u
    WHERE EXISTS (
        SELECT 1
        FROM refresh_token AS r
        WHERE (u.id = r.user_id) AND (r.token = @__token_0)))
2022-09-20 17:05:58.293 +01:00 [DBG] A data reader was disposed.
2022-09-20 17:05:58.294 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-20 17:05:58.297 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-20 17:05:58.331 +01:00 [DBG] An entity of type 'User' tracked by 'PostgresContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-20 17:05:58.340 +01:00 [DBG] SaveChanges starting for 'PostgresContext'.
2022-09-20 17:05:58.343 +01:00 [DBG] DetectChanges starting for 'PostgresContext'.
2022-09-20 17:05:58.389 +01:00 [DBG] 1 entities were added and 0 entities were removed from navigation 'User.RefreshTokenCollection'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-20 17:05:58.453 +01:00 [DBG] 'PostgresContext' generated a temporary value for the property 'Id.RefreshToken'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-20 17:05:58.556 +01:00 [DBG] Context 'PostgresContext' started tracking 'RefreshToken' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-20 17:05:58.571 +01:00 [DBG] DetectChanges completed for 'PostgresContext'.
2022-09-20 17:05:58.595 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-20 17:05:58.598 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-20 17:05:58.606 +01:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2022-09-20 17:05:58.623 +01:00 [DBG] Began transaction with isolation level 'ReadCommitted'.
2022-09-20 17:05:58.741 +01:00 [DBG] Executing 2 update commands as a batch.
2022-09-20 17:05:58.793 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-20 17:05:58.796 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (2ms).
2022-09-20 17:05:58.803 +01:00 [DBG] Executing DbCommand [Parameters=[@p0='?' (DbType = DateTime), @p1='?', @p2='?' (DbType = DateTime), @p3='?' (DbType = Boolean), @p4='?' (DbType = Boolean), @p5='?' (DbType = Boolean), @p6='?', @p7='?', @p8='?', @p9='?' (DbType = DateTime), @p10='?', @p11='?' (DbType = Int32), @p18='?' (DbType = Int32), @p12='?' (DbType = DateTime), @p13='?', @p14='?', @p15='?' (DbType = DateTime), @p16='?', @p17='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO refresh_token (created, created_by_ip, expires, is_active, is_expired, is_revoked, reason_revoked, token, replaced_by_token, revoked, revoked_by_ip, user_id)
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11)
RETURNING id;
UPDATE users SET created_at = @p12, email = @p13, full_name = @p14, password_changed_at = @p15, password_hash = @p16, username = @p17
WHERE id = @p18;
2022-09-20 17:05:58.836 +01:00 [INF] Executed DbCommand (33ms) [Parameters=[@p0='?' (DbType = DateTime), @p1='?', @p2='?' (DbType = DateTime), @p3='?' (DbType = Boolean), @p4='?' (DbType = Boolean), @p5='?' (DbType = Boolean), @p6='?', @p7='?', @p8='?', @p9='?' (DbType = DateTime), @p10='?', @p11='?' (DbType = Int32), @p18='?' (DbType = Int32), @p12='?' (DbType = DateTime), @p13='?', @p14='?', @p15='?' (DbType = DateTime), @p16='?', @p17='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO refresh_token (created, created_by_ip, expires, is_active, is_expired, is_revoked, reason_revoked, token, replaced_by_token, revoked, revoked_by_ip, user_id)
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11)
RETURNING id;
UPDATE users SET created_at = @p12, email = @p13, full_name = @p14, password_changed_at = @p15, password_hash = @p16, username = @p17
WHERE id = @p18;
2022-09-20 17:05:58.865 +01:00 [DBG] The foreign key property 'RefreshToken.Id' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2022-09-20 17:05:58.880 +01:00 [DBG] A data reader was disposed.
2022-09-20 17:05:58.887 +01:00 [DBG] Committing transaction.
2022-09-20 17:05:58.900 +01:00 [DBG] Committed transaction.
2022-09-20 17:05:58.902 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-20 17:05:58.904 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-20 17:05:58.910 +01:00 [DBG] Disposing transaction.
2022-09-20 17:05:58.919 +01:00 [DBG] An entity of type 'RefreshToken' tracked by 'PostgresContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-20 17:05:58.923 +01:00 [DBG] An entity of type 'User' tracked by 'PostgresContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-20 17:05:58.927 +01:00 [DBG] SaveChanges completed for 'PostgresContext' with 2 entities written to the database.
2022-09-20 17:05:58.934 +01:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2022-09-20 17:05:58.939 +01:00 [DBG] Attempting to select an output formatter based on Accept header '["text/plain"]'.
2022-09-20 17:05:58.941 +01:00 [DBG] Could not find an output formatter based on content negotiation. Accepted types were (["text/plain"])
2022-09-20 17:05:58.942 +01:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2022-09-20 17:05:58.943 +01:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2022-09-20 17:05:58.946 +01:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2022-09-20 17:05:58.947 +01:00 [INF] Executing OkObjectResult, writing value of type 'APIBank.Models.Users.Responses.LoginResponse'.
2022-09-20 17:05:58.957 +01:00 [INF] Executed action APIBank.Controllers.UsersController.Login (APIBank) in 1597.6517ms
2022-09-20 17:05:58.959 +01:00 [INF] Executed endpoint 'APIBank.Controllers.UsersController.Login (APIBank)'
2022-09-20 17:05:58.961 +01:00 [DBG] 'PostgresContext' disposed.
2022-09-20 17:05:58.963 +01:00 [INF] Request finished HTTP/2 POST https://localhost:7036/api/Users/Login application/json 58 - 200 - application/json;+charset=utf-8 1653.5618ms
2022-09-20 17:06:13.817 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/api/Accounts/GetAll - -
2022-09-20 17:06:13.820 +01:00 [DBG] 1 candidate(s) found for the request path '/api/Accounts/GetAll'
2022-09-20 17:06:13.823 +01:00 [DBG] Endpoint 'APIBank.Controllers.AccountsController.GetAllFromUser (APIBank)' with route pattern 'api/Accounts/GetAll' is valid for the request path '/api/Accounts/GetAll'
2022-09-20 17:06:13.827 +01:00 [DBG] Request matched endpoint 'APIBank.Controllers.AccountsController.GetAllFromUser (APIBank)'
2022-09-20 17:06:13.833 +01:00 [DBG] Static files was skipped as the request already matched an endpoint.
2022-09-20 17:06:14.021 +01:00 [INF] Entity Framework Core 6.0.9 initialized 'PostgresContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:6.0.7+5b98e4b74de93b590b44aef8dd7967c03acc433c' with options: None
2022-09-20 17:06:14.039 +01:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .FirstOrDefault(e => EF.Property<int>(e, "Id") == __p_0)'
2022-09-20 17:06:14.049 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<User>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: User.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: User.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 1], [Property: User.Email (string) Required Index MaxLength(254), 2], [Property: User.FullName (string) Required MaxLength(100), 3], [Property: User.PasswordChangedAt (DateTime) Required ValueGenerated.OnAdd, 4], [Property: User.PasswordHash (string) Required MaxLength(200), 5], [Property: User.Username (string) Required Index MaxLength(50), 6] }
        SELECT TOP(1) u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
        FROM users AS u
        WHERE u.id == @__p_0), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, User>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)
    .SingleOrDefault()'
2022-09-20 17:06:14.053 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-20 17:06:14.054 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2022-09-20 17:06:14.056 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-20 17:06:14.057 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-20 17:06:14.059 +01:00 [DBG] Executing DbCommand [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.id = @__p_0
LIMIT 1
2022-09-20 17:06:14.066 +01:00 [INF] Executed DbCommand (6ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.id = @__p_0
LIMIT 1
2022-09-20 17:06:14.070 +01:00 [DBG] Context 'PostgresContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-20 17:06:14.072 +01:00 [DBG] A data reader was disposed.
2022-09-20 17:06:14.073 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-20 17:06:14.076 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-20 17:06:14.078 +01:00 [INF] Executing endpoint 'APIBank.Controllers.AccountsController.GetAllFromUser (APIBank)'
2022-09-20 17:06:14.084 +01:00 [INF] Route matched with {action = "GetAllFromUser", controller = "Accounts"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult GetAllFromUser() on controller APIBank.Controllers.AccountsController (APIBank).
2022-09-20 17:06:14.087 +01:00 [DBG] Execution plan of authorization filters (in the following order): ["APIBank.Authorization.AuthorizeAttribute"]
2022-09-20 17:06:14.089 +01:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2022-09-20 17:06:14.091 +01:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2022-09-20 17:06:14.093 +01:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2022-09-20 17:06:14.094 +01:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2022-09-20 17:06:14.096 +01:00 [DBG] Executing controller factory for controller APIBank.Controllers.AccountsController (APIBank)
2022-09-20 17:06:14.100 +01:00 [DBG] Executed controller factory for controller APIBank.Controllers.AccountsController (APIBank)
2022-09-20 17:06:14.111 +01:00 [DBG] Compiling query expression: 
'DbSet<Account>()
    .Where(u => u.UserId == __userId_0)
    .Select(u => new AccountRe{ 
        Balance = u.Balance, 
        CreatedAt = u.CreatedAt, 
        Currency = u.Currency, 
        Id = u.Id 
    }
    )'
2022-09-20 17:06:14.142 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<AccountRe>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            Balance -> 0
            CreatedAt -> 1
            Currency -> 2
            Id -> 3
        SELECT a.balance AS Balance, a.created_at AS CreatedAt, a.currency AS Currency, a.id AS Id
        FROM accounts AS a
        WHERE a.user_id == @__userId_0), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, AccountRe>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)'
2022-09-20 17:06:14.145 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-20 17:06:14.147 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2022-09-20 17:06:14.149 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-20 17:06:14.150 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-20 17:06:14.152 +01:00 [DBG] Executing DbCommand [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a.balance AS "Balance", a.created_at AS "CreatedAt", a.currency AS "Currency", a.id AS "Id"
FROM accounts AS a
WHERE a.user_id = @__userId_0
2022-09-20 17:06:14.156 +01:00 [INF] Executed DbCommand (4ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a.balance AS "Balance", a.created_at AS "CreatedAt", a.currency AS "Currency", a.id AS "Id"
FROM accounts AS a
WHERE a.user_id = @__userId_0
2022-09-20 17:06:14.170 +01:00 [DBG] A data reader was disposed.
2022-09-20 17:06:14.171 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-20 17:06:14.173 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-20 17:06:14.173 +01:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2022-09-20 17:06:14.176 +01:00 [DBG] Attempting to select an output formatter based on Accept header '["text/plain"]'.
2022-09-20 17:06:14.176 +01:00 [DBG] Could not find an output formatter based on content negotiation. Accepted types were (["text/plain"])
2022-09-20 17:06:14.177 +01:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2022-09-20 17:06:14.178 +01:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2022-09-20 17:06:14.179 +01:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2022-09-20 17:06:14.180 +01:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[APIBank.Models.Accounts.AccountRe, APIBank, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2022-09-20 17:06:14.191 +01:00 [INF] Executed action APIBank.Controllers.AccountsController.GetAllFromUser (APIBank) in 94.7576ms
2022-09-20 17:06:14.195 +01:00 [INF] Executed endpoint 'APIBank.Controllers.AccountsController.GetAllFromUser (APIBank)'
2022-09-20 17:06:14.196 +01:00 [DBG] 'PostgresContext' disposed.
2022-09-20 17:06:14.198 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/api/Accounts/GetAll - - - 200 - application/json;+charset=utf-8 380.8908ms
2022-09-20 17:10:03.462 +01:00 [INF] Request starting HTTP/2 POST https://localhost:7036/api/Accounts/Create application/json 40
2022-09-20 17:10:03.468 +01:00 [DBG] 1 candidate(s) found for the request path '/api/Accounts/Create'
2022-09-20 17:10:03.470 +01:00 [DBG] Endpoint 'APIBank.Controllers.AccountsController.Create (APIBank)' with route pattern 'api/Accounts/Create' is valid for the request path '/api/Accounts/Create'
2022-09-20 17:10:03.475 +01:00 [DBG] Request matched endpoint 'APIBank.Controllers.AccountsController.Create (APIBank)'
2022-09-20 17:10:03.476 +01:00 [DBG] Static files was skipped as the request already matched an endpoint.
2022-09-20 17:10:03.479 +01:00 [INF] Entity Framework Core 6.0.9 initialized 'PostgresContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:6.0.7+5b98e4b74de93b590b44aef8dd7967c03acc433c' with options: None
2022-09-20 17:10:03.485 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-20 17:10:03.486 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2022-09-20 17:10:03.487 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-20 17:10:03.487 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-20 17:10:03.488 +01:00 [DBG] Executing DbCommand [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.id = @__p_0
LIMIT 1
2022-09-20 17:10:03.491 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.id = @__p_0
LIMIT 1
2022-09-20 17:10:03.493 +01:00 [DBG] Context 'PostgresContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-20 17:10:03.494 +01:00 [DBG] A data reader was disposed.
2022-09-20 17:10:03.494 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-20 17:10:03.496 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-20 17:10:03.498 +01:00 [INF] Executing endpoint 'APIBank.Controllers.AccountsController.Create (APIBank)'
2022-09-20 17:10:03.501 +01:00 [INF] Route matched with {action = "Create", controller = "Accounts"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult Create(APIBank.Models.Accounts.Requests.CreateAccountRequest) on controller APIBank.Controllers.AccountsController (APIBank).
2022-09-20 17:10:03.502 +01:00 [DBG] Execution plan of authorization filters (in the following order): ["APIBank.Authorization.AuthorizeAttribute"]
2022-09-20 17:10:03.506 +01:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2022-09-20 17:10:03.507 +01:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2022-09-20 17:10:03.509 +01:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2022-09-20 17:10:03.510 +01:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2022-09-20 17:10:03.512 +01:00 [DBG] Executing controller factory for controller APIBank.Controllers.AccountsController (APIBank)
2022-09-20 17:10:03.513 +01:00 [DBG] Executed controller factory for controller APIBank.Controllers.AccountsController (APIBank)
2022-09-20 17:10:03.515 +01:00 [DBG] Attempting to bind parameter 'model' of type 'APIBank.Models.Accounts.Requests.CreateAccountRequest' ...
2022-09-20 17:10:03.516 +01:00 [DBG] Attempting to bind parameter 'model' of type 'APIBank.Models.Accounts.Requests.CreateAccountRequest' using the name '' in request data ...
2022-09-20 17:10:03.519 +01:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2022-09-20 17:10:03.520 +01:00 [DBG] Connection id "0HMKR47MF7UNG", Request id "0HMKR47MF7UNG:0000000F": started reading request body.
2022-09-20 17:10:03.521 +01:00 [DBG] Connection id "0HMKR47MF7UNG", Request id "0HMKR47MF7UNG:0000000F": done reading request body.
2022-09-20 17:10:03.525 +01:00 [DBG] JSON input formatter succeeded, deserializing to type 'APIBank.Models.Accounts.Requests.CreateAccountRequest'
2022-09-20 17:10:03.527 +01:00 [DBG] Done attempting to bind parameter 'model' of type 'APIBank.Models.Accounts.Requests.CreateAccountRequest'.
2022-09-20 17:10:03.529 +01:00 [DBG] Done attempting to bind parameter 'model' of type 'APIBank.Models.Accounts.Requests.CreateAccountRequest'.
2022-09-20 17:10:03.530 +01:00 [DBG] Attempting to validate the bound parameter 'model' of type 'APIBank.Models.Accounts.Requests.CreateAccountRequest' ...
2022-09-20 17:10:03.540 +01:00 [DBG] Done attempting to validate the bound parameter 'model' of type 'APIBank.Models.Accounts.Requests.CreateAccountRequest'.
2022-09-20 17:10:03.547 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-20 17:10:03.549 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-20 17:10:03.550 +01:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2022-09-20 17:10:03.551 +01:00 [DBG] Began transaction with isolation level 'ReadCommitted'.
2022-09-20 17:10:03.557 +01:00 [DBG] 'PostgresContext' generated a temporary value for the property 'Id.Account'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-20 17:10:03.586 +01:00 [DBG] Context 'PostgresContext' started tracking 'Account' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-20 17:10:03.590 +01:00 [DBG] SaveChanges starting for 'PostgresContext'.
2022-09-20 17:10:03.593 +01:00 [DBG] DetectChanges starting for 'PostgresContext'.
2022-09-20 17:10:03.606 +01:00 [DBG] DetectChanges completed for 'PostgresContext'.
2022-09-20 17:10:03.613 +01:00 [DBG] Creating transaction savepoint.
2022-09-20 17:10:03.625 +01:00 [DBG] Created transaction savepoint.
2022-09-20 17:10:03.629 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-20 17:10:03.633 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (3ms).
2022-09-20 17:10:03.635 +01:00 [DBG] Executing DbCommand [Parameters=[@p0='?' (DbType = Decimal), @p1='?', @p2='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO accounts (balance, currency, user_id)
VALUES (@p0, @p1, @p2)
RETURNING id, created_at;
2022-09-20 17:10:03.657 +01:00 [INF] Executed DbCommand (22ms) [Parameters=[@p0='?' (DbType = Decimal), @p1='?', @p2='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO accounts (balance, currency, user_id)
VALUES (@p0, @p1, @p2)
RETURNING id, created_at;
2022-09-20 17:10:03.661 +01:00 [DBG] The foreign key property 'Account.Id' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2022-09-20 17:10:03.665 +01:00 [DBG] A data reader was disposed.
2022-09-20 17:10:03.674 +01:00 [DBG] Releasing transaction savepoint.
2022-09-20 17:10:03.679 +01:00 [DBG] Released transaction savepoint.
2022-09-20 17:10:03.690 +01:00 [DBG] An entity of type 'Account' tracked by 'PostgresContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-20 17:10:03.693 +01:00 [DBG] SaveChanges completed for 'PostgresContext' with 1 entities written to the database.
2022-09-20 17:10:03.698 +01:00 [DBG] 'PostgresContext' generated a temporary value for the property 'Id.Transaction'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-20 17:10:03.715 +01:00 [DBG] Context 'PostgresContext' started tracking 'Transaction' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-20 17:10:03.718 +01:00 [DBG] SaveChanges starting for 'PostgresContext'.
2022-09-20 17:10:03.719 +01:00 [DBG] DetectChanges starting for 'PostgresContext'.
2022-09-20 17:10:03.726 +01:00 [DBG] DetectChanges completed for 'PostgresContext'.
2022-09-20 17:10:03.728 +01:00 [DBG] Creating transaction savepoint.
2022-09-20 17:10:03.728 +01:00 [DBG] Created transaction savepoint.
2022-09-20 17:10:03.731 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-20 17:10:03.732 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2022-09-20 17:10:03.734 +01:00 [DBG] Executing DbCommand [Parameters=[@p0='?' (DbType = Int32), @p1='?' (DbType = Decimal), @p2='?' (DbType = Decimal)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO transactions (account_id, amount, balance)
VALUES (@p0, @p1, @p2)
RETURNING id, created_at;
2022-09-20 17:10:03.739 +01:00 [INF] Executed DbCommand (6ms) [Parameters=[@p0='?' (DbType = Int32), @p1='?' (DbType = Decimal), @p2='?' (DbType = Decimal)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO transactions (account_id, amount, balance)
VALUES (@p0, @p1, @p2)
RETURNING id, created_at;
2022-09-20 17:10:03.743 +01:00 [DBG] The foreign key property 'Transaction.Id' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2022-09-20 17:10:03.744 +01:00 [DBG] A data reader was disposed.
2022-09-20 17:10:03.744 +01:00 [DBG] Releasing transaction savepoint.
2022-09-20 17:10:03.746 +01:00 [DBG] Released transaction savepoint.
2022-09-20 17:10:03.749 +01:00 [DBG] An entity of type 'Transaction' tracked by 'PostgresContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-20 17:10:03.751 +01:00 [DBG] SaveChanges completed for 'PostgresContext' with 1 entities written to the database.
2022-09-20 17:10:03.753 +01:00 [DBG] Committing transaction.
2022-09-20 17:10:03.757 +01:00 [DBG] Committed transaction.
2022-09-20 17:10:03.758 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-20 17:10:03.759 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-20 17:10:03.761 +01:00 [DBG] Disposing transaction.
2022-09-20 17:10:03.762 +01:00 [INF] Account Created
2022-09-20 17:10:03.763 +01:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2022-09-20 17:10:03.765 +01:00 [DBG] Attempting to select an output formatter based on Accept header '["text/plain"]'.
2022-09-20 17:10:03.766 +01:00 [DBG] Could not find an output formatter based on content negotiation. Accepted types were (["text/plain"])
2022-09-20 17:10:03.767 +01:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2022-09-20 17:10:03.768 +01:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2022-09-20 17:10:03.769 +01:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2022-09-20 17:10:03.771 +01:00 [INF] Executing CreatedResult, writing value of type '<>f__AnonymousType0`1[[System.String, System.Private.CoreLib, Version=6.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2022-09-20 17:10:03.773 +01:00 [INF] Executed action APIBank.Controllers.AccountsController.Create (APIBank) in 261.1338ms
2022-09-20 17:10:03.774 +01:00 [INF] Executed endpoint 'APIBank.Controllers.AccountsController.Create (APIBank)'
2022-09-20 17:10:03.776 +01:00 [DBG] 'PostgresContext' disposed.
2022-09-20 17:10:03.777 +01:00 [INF] Request finished HTTP/2 POST https://localhost:7036/api/Accounts/Create application/json 40 - 201 - application/json;+charset=utf-8 319.6334ms
2022-09-20 17:10:50.781 +01:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2022-09-20 17:10:51.267 +01:00 [DBG] Hosting starting
2022-09-20 17:10:51.477 +01:00 [DBG] Using development certificate: CN=localhost (Thumbprint: 9CC642E9838495A6C3C202DECA6A8AD300396DD2)
2022-09-20 17:10:51.549 +01:00 [INF] Now listening on: https://localhost:7036
2022-09-20 17:10:51.551 +01:00 [INF] Now listening on: http://localhost:5036
2022-09-20 17:10:51.552 +01:00 [DBG] Loaded hosting startup assembly APIBank
2022-09-20 17:10:51.554 +01:00 [DBG] Loaded hosting startup assembly Microsoft.AspNetCore.Watch.BrowserRefresh
2022-09-20 17:10:51.556 +01:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.BrowserLink.Net
2022-09-20 17:10:51.557 +01:00 [INF] Application started. Press Ctrl+C to shut down.
2022-09-20 17:10:51.560 +01:00 [INF] Hosting environment: Development
2022-09-20 17:10:51.561 +01:00 [INF] Content root path: C:\Users\mguedesa\OneDrive - NTT DATA EMEAL\Documentos\GitHub\OpenBankAPI-NTT\APIBank\APIBank\
2022-09-20 17:10:51.561 +01:00 [DBG] Hosting started
2022-09-20 17:10:51.873 +01:00 [DBG] Connection id "0HMKR4AO80GII" received FIN.
2022-09-20 17:10:51.873 +01:00 [DBG] Connection id "0HMKR4AO80GIH" received FIN.
2022-09-20 17:10:51.880 +01:00 [DBG] Connection id "0HMKR4AO80GIH" accepted.
2022-09-20 17:10:51.880 +01:00 [DBG] Connection id "0HMKR4AO80GII" accepted.
2022-09-20 17:10:51.882 +01:00 [DBG] Connection id "0HMKR4AO80GII" started.
2022-09-20 17:10:51.882 +01:00 [DBG] Connection id "0HMKR4AO80GIH" started.
2022-09-20 17:10:51.907 +01:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException:  Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveBlobAsync[TIOAdapter](TIOAdapter adapter)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](TIOAdapter adapter, Boolean receiveFirst, Byte[] reAuthenticationData, Boolean isApm)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2022-09-20 17:10:51.907 +01:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException:  Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveBlobAsync[TIOAdapter](TIOAdapter adapter)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](TIOAdapter adapter, Boolean receiveFirst, Byte[] reAuthenticationData, Boolean isApm)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2022-09-20 17:10:51.979 +01:00 [DBG] Connection id "0HMKR4AO80GIH" stopped.
2022-09-20 17:10:51.979 +01:00 [DBG] Connection id "0HMKR4AO80GII" stopped.
2022-09-20 17:10:51.986 +01:00 [DBG] Connection id "0HMKR4AO80GII" sending FIN because: "The Socket transport's send loop completed gracefully."
2022-09-20 17:10:51.986 +01:00 [DBG] Connection id "0HMKR4AO80GIH" sending FIN because: "The Socket transport's send loop completed gracefully."
2022-09-20 17:10:52.142 +01:00 [DBG] Connection id "0HMKR4AO80GIJ" accepted.
2022-09-20 17:10:52.148 +01:00 [DBG] Connection id "0HMKR4AO80GIJ" started.
2022-09-20 17:10:52.340 +01:00 [DBG] Connection 0HMKR4AO80GIJ established using the following protocol: "Tls12"
2022-09-20 17:10:52.448 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/swagger/index.html - -
2022-09-20 17:10:52.498 +01:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2022-09-20 17:10:52.533 +01:00 [DBG] No candidates found for the request path '/swagger/index.html'
2022-09-20 17:10:52.534 +01:00 [DBG] Request did not match any endpoints
2022-09-20 17:10:52.671 +01:00 [DBG] Response markup is scheduled to include browser refresh script injection.
2022-09-20 17:10:52.831 +01:00 [DBG] Response markup was updated to include browser refresh script injection.
2022-09-20 17:10:52.838 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/swagger/index.html - - - 200 - text/html;charset=utf-8 392.5908ms
2022-09-20 17:10:52.869 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/_vs/browserLink - -
2022-09-20 17:10:52.869 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/_framework/aspnetcore-browser-refresh.js - -
2022-09-20 17:10:52.885 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/_framework/aspnetcore-browser-refresh.js - - - 200 11984 application/javascript;+charset=utf-8 15.9429ms
2022-09-20 17:10:52.894 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/_vs/browserLink - - - 200 - text/javascript;+charset=UTF-8 25.7166ms
2022-09-20 17:10:52.982 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/swagger/v1/swagger.json - -
2022-09-20 17:10:52.983 +01:00 [DBG] No candidates found for the request path '/swagger/v1/swagger.json'
2022-09-20 17:10:52.984 +01:00 [DBG] Request did not match any endpoints
2022-09-20 17:10:53.166 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/swagger/v1/swagger.json - - - 200 - application/json;charset=utf-8 184.0164ms
2022-09-20 17:11:05.986 +01:00 [INF] Request starting HTTP/2 POST https://localhost:7036/api/Users/Login application/json 58
2022-09-20 17:11:06.017 +01:00 [DBG] 1 candidate(s) found for the request path '/api/Users/Login'
2022-09-20 17:11:06.022 +01:00 [DBG] Endpoint 'APIBank.Controllers.UsersController.Login (APIBank)' with route pattern 'api/Users/Login' is valid for the request path '/api/Users/Login'
2022-09-20 17:11:06.027 +01:00 [DBG] Request matched endpoint 'APIBank.Controllers.UsersController.Login (APIBank)'
2022-09-20 17:11:06.032 +01:00 [DBG] Static files was skipped as the request already matched an endpoint.
2022-09-20 17:11:06.448 +01:00 [INF] Executing endpoint 'APIBank.Controllers.UsersController.Login (APIBank)'
2022-09-20 17:11:06.478 +01:00 [INF] Route matched with {action = "Login", controller = "Users"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult Login(APIBank.Models.Requests.LoginRequest) on controller APIBank.Controllers.UsersController (APIBank).
2022-09-20 17:11:06.482 +01:00 [DBG] Execution plan of authorization filters (in the following order): ["APIBank.Authorization.AuthorizeAttribute"]
2022-09-20 17:11:06.484 +01:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2022-09-20 17:11:06.485 +01:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2022-09-20 17:11:06.487 +01:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2022-09-20 17:11:06.488 +01:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2022-09-20 17:11:06.491 +01:00 [DBG] Executing controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-20 17:11:06.494 +01:00 [DBG] Executed controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-20 17:11:06.516 +01:00 [DBG] Attempting to bind parameter 'model' of type 'APIBank.Models.Requests.LoginRequest' ...
2022-09-20 17:11:06.519 +01:00 [DBG] Attempting to bind parameter 'model' of type 'APIBank.Models.Requests.LoginRequest' using the name '' in request data ...
2022-09-20 17:11:06.522 +01:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2022-09-20 17:11:06.530 +01:00 [DBG] Connection id "0HMKR4AO80GIJ", Request id "0HMKR4AO80GIJ:00000009": started reading request body.
2022-09-20 17:11:06.535 +01:00 [DBG] Connection id "0HMKR4AO80GIJ", Request id "0HMKR4AO80GIJ:00000009": done reading request body.
2022-09-20 17:11:06.546 +01:00 [DBG] JSON input formatter succeeded, deserializing to type 'APIBank.Models.Requests.LoginRequest'
2022-09-20 17:11:06.547 +01:00 [DBG] Done attempting to bind parameter 'model' of type 'APIBank.Models.Requests.LoginRequest'.
2022-09-20 17:11:06.550 +01:00 [DBG] Done attempting to bind parameter 'model' of type 'APIBank.Models.Requests.LoginRequest'.
2022-09-20 17:11:06.551 +01:00 [DBG] Attempting to validate the bound parameter 'model' of type 'APIBank.Models.Requests.LoginRequest' ...
2022-09-20 17:11:06.565 +01:00 [DBG] Done attempting to validate the bound parameter 'model' of type 'APIBank.Models.Requests.LoginRequest'.
2022-09-20 17:11:06.728 +01:00 [DBG] An additional 'IServiceProvider' was created for internal use by Entity Framework. An existing service provider was not used due to the following configuration changes: configuration changed for 'Core:ConfigureWarnings', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:UseAdminDatabase', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:SetPostgresVersion', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:UseRedshift', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:ReverseNullOrdering', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:RemoteCertificateValidationCallback', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:ProvideClientCertificatesCallback', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:ProvidePasswordCallback'.
2022-09-20 17:11:08.223 +01:00 [INF] Entity Framework Core 6.0.9 initialized 'PostgresContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:6.0.7+5b98e4b74de93b590b44aef8dd7967c03acc433c' with options: None
2022-09-20 17:11:08.286 +01:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .SingleOrDefault(x => x.Username == __model_Username_0)'
2022-09-20 17:11:08.786 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<User>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: User.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: User.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 1], [Property: User.Email (string) Required Index MaxLength(254), 2], [Property: User.FullName (string) Required MaxLength(100), 3], [Property: User.PasswordChangedAt (DateTime) Required ValueGenerated.OnAdd, 4], [Property: User.PasswordHash (string) Required MaxLength(200), 5], [Property: User.Username (string) Required Index MaxLength(50), 6] }
        SELECT TOP(2) u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
        FROM users AS u
        WHERE u.username == @__model_Username_0), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, User>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)
    .SingleOrDefault()'
2022-09-20 17:11:08.869 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-20 17:11:09.004 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (133ms).
2022-09-20 17:11:09.020 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-20 17:11:09.421 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-20 17:11:09.451 +01:00 [DBG] Executing DbCommand [Parameters=[@__model_Username_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.username = @__model_Username_0
LIMIT 2
2022-09-20 17:11:09.626 +01:00 [INF] Executed DbCommand (186ms) [Parameters=[@__model_Username_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.username = @__model_Username_0
LIMIT 2
2022-09-20 17:11:09.715 +01:00 [DBG] Context 'PostgresContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-20 17:11:09.801 +01:00 [DBG] A data reader was disposed.
2022-09-20 17:11:09.816 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-20 17:11:09.833 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-20 17:11:10.331 +01:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .Any(user => user.RefreshTokenCollection
        .Any(reftoken => reftoken.RefToken == __token_0))'
2022-09-20 17:11:10.492 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<bool>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            EmptyProjectionMember -> 0
        SELECT EXISTS (
            SELECT 1
            FROM users AS u
            WHERE EXISTS (
                SELECT 1
                FROM refresh_token AS r
                WHERE ((u.id != NULL) && (u.id == r.user_id)) && (r.token == @__token_0)))), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, bool>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)
    .Single()'
2022-09-20 17:11:10.509 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-20 17:11:10.511 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2022-09-20 17:11:10.513 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-20 17:11:10.514 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-20 17:11:10.516 +01:00 [DBG] Executing DbCommand [Parameters=[@__token_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM users AS u
    WHERE EXISTS (
        SELECT 1
        FROM refresh_token AS r
        WHERE (u.id = r.user_id) AND (r.token = @__token_0)))
2022-09-20 17:11:10.520 +01:00 [INF] Executed DbCommand (4ms) [Parameters=[@__token_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM users AS u
    WHERE EXISTS (
        SELECT 1
        FROM refresh_token AS r
        WHERE (u.id = r.user_id) AND (r.token = @__token_0)))
2022-09-20 17:11:10.528 +01:00 [DBG] A data reader was disposed.
2022-09-20 17:11:10.529 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-20 17:11:10.530 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-20 17:11:10.566 +01:00 [DBG] An entity of type 'User' tracked by 'PostgresContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-20 17:11:10.577 +01:00 [DBG] SaveChanges starting for 'PostgresContext'.
2022-09-20 17:11:10.581 +01:00 [DBG] DetectChanges starting for 'PostgresContext'.
2022-09-20 17:11:10.627 +01:00 [DBG] 1 entities were added and 0 entities were removed from navigation 'User.RefreshTokenCollection'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-20 17:11:10.672 +01:00 [DBG] 'PostgresContext' generated a temporary value for the property 'Id.RefreshToken'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-20 17:11:10.748 +01:00 [DBG] Context 'PostgresContext' started tracking 'RefreshToken' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-20 17:11:10.757 +01:00 [DBG] DetectChanges completed for 'PostgresContext'.
2022-09-20 17:11:10.775 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-20 17:11:10.777 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-20 17:11:10.780 +01:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2022-09-20 17:11:10.791 +01:00 [DBG] Began transaction with isolation level 'ReadCommitted'.
2022-09-20 17:11:10.886 +01:00 [DBG] Executing 2 update commands as a batch.
2022-09-20 17:11:10.932 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-20 17:11:10.936 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (4ms).
2022-09-20 17:11:10.942 +01:00 [DBG] Executing DbCommand [Parameters=[@p0='?' (DbType = DateTime), @p1='?', @p2='?' (DbType = DateTime), @p3='?' (DbType = Boolean), @p4='?' (DbType = Boolean), @p5='?' (DbType = Boolean), @p6='?', @p7='?', @p8='?', @p9='?' (DbType = DateTime), @p10='?', @p11='?' (DbType = Int32), @p18='?' (DbType = Int32), @p12='?' (DbType = DateTime), @p13='?', @p14='?', @p15='?' (DbType = DateTime), @p16='?', @p17='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO refresh_token (created, created_by_ip, expires, is_active, is_expired, is_revoked, reason_revoked, token, replaced_by_token, revoked, revoked_by_ip, user_id)
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11)
RETURNING id;
UPDATE users SET created_at = @p12, email = @p13, full_name = @p14, password_changed_at = @p15, password_hash = @p16, username = @p17
WHERE id = @p18;
2022-09-20 17:11:10.975 +01:00 [INF] Executed DbCommand (33ms) [Parameters=[@p0='?' (DbType = DateTime), @p1='?', @p2='?' (DbType = DateTime), @p3='?' (DbType = Boolean), @p4='?' (DbType = Boolean), @p5='?' (DbType = Boolean), @p6='?', @p7='?', @p8='?', @p9='?' (DbType = DateTime), @p10='?', @p11='?' (DbType = Int32), @p18='?' (DbType = Int32), @p12='?' (DbType = DateTime), @p13='?', @p14='?', @p15='?' (DbType = DateTime), @p16='?', @p17='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO refresh_token (created, created_by_ip, expires, is_active, is_expired, is_revoked, reason_revoked, token, replaced_by_token, revoked, revoked_by_ip, user_id)
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11)
RETURNING id;
UPDATE users SET created_at = @p12, email = @p13, full_name = @p14, password_changed_at = @p15, password_hash = @p16, username = @p17
WHERE id = @p18;
2022-09-20 17:11:11.026 +01:00 [DBG] The foreign key property 'RefreshToken.Id' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2022-09-20 17:11:11.040 +01:00 [DBG] A data reader was disposed.
2022-09-20 17:11:11.046 +01:00 [DBG] Committing transaction.
2022-09-20 17:11:11.066 +01:00 [DBG] Committed transaction.
2022-09-20 17:11:11.069 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-20 17:11:11.073 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-20 17:11:11.080 +01:00 [DBG] Disposing transaction.
2022-09-20 17:11:11.086 +01:00 [DBG] An entity of type 'RefreshToken' tracked by 'PostgresContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-20 17:11:11.090 +01:00 [DBG] An entity of type 'User' tracked by 'PostgresContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-20 17:11:11.094 +01:00 [DBG] SaveChanges completed for 'PostgresContext' with 2 entities written to the database.
2022-09-20 17:11:11.100 +01:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2022-09-20 17:11:11.110 +01:00 [DBG] Attempting to select an output formatter based on Accept header '["text/plain"]'.
2022-09-20 17:11:11.111 +01:00 [DBG] Could not find an output formatter based on content negotiation. Accepted types were (["text/plain"])
2022-09-20 17:11:11.116 +01:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2022-09-20 17:11:11.117 +01:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2022-09-20 17:11:11.118 +01:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2022-09-20 17:11:11.120 +01:00 [INF] Executing OkObjectResult, writing value of type 'APIBank.Models.Users.Responses.LoginResponse'.
2022-09-20 17:11:11.142 +01:00 [INF] Executed action APIBank.Controllers.UsersController.Login (APIBank) in 4643.5859ms
2022-09-20 17:11:11.146 +01:00 [INF] Executed endpoint 'APIBank.Controllers.UsersController.Login (APIBank)'
2022-09-20 17:11:11.153 +01:00 [DBG] 'PostgresContext' disposed.
2022-09-20 17:11:11.165 +01:00 [INF] Request finished HTTP/2 POST https://localhost:7036/api/Users/Login application/json 58 - 200 - application/json;+charset=utf-8 5178.7403ms
2022-09-20 17:11:24.117 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/api/Accounts/GetAll - -
2022-09-20 17:11:24.123 +01:00 [DBG] 1 candidate(s) found for the request path '/api/Accounts/GetAll'
2022-09-20 17:11:24.127 +01:00 [DBG] Endpoint 'APIBank.Controllers.AccountsController.GetAllFromUser (APIBank)' with route pattern 'api/Accounts/GetAll' is valid for the request path '/api/Accounts/GetAll'
2022-09-20 17:11:24.130 +01:00 [DBG] Request matched endpoint 'APIBank.Controllers.AccountsController.GetAllFromUser (APIBank)'
2022-09-20 17:11:24.133 +01:00 [DBG] Static files was skipped as the request already matched an endpoint.
2022-09-20 17:11:24.254 +01:00 [INF] Entity Framework Core 6.0.9 initialized 'PostgresContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:6.0.7+5b98e4b74de93b590b44aef8dd7967c03acc433c' with options: None
2022-09-20 17:11:24.276 +01:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .FirstOrDefault(e => EF.Property<int>(e, "Id") == __p_0)'
2022-09-20 17:11:24.285 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<User>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: User.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: User.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 1], [Property: User.Email (string) Required Index MaxLength(254), 2], [Property: User.FullName (string) Required MaxLength(100), 3], [Property: User.PasswordChangedAt (DateTime) Required ValueGenerated.OnAdd, 4], [Property: User.PasswordHash (string) Required MaxLength(200), 5], [Property: User.Username (string) Required Index MaxLength(50), 6] }
        SELECT TOP(1) u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
        FROM users AS u
        WHERE u.id == @__p_0), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, User>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)
    .SingleOrDefault()'
2022-09-20 17:11:24.289 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-20 17:11:24.290 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2022-09-20 17:11:24.291 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-20 17:11:24.292 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-20 17:11:24.293 +01:00 [DBG] Executing DbCommand [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.id = @__p_0
LIMIT 1
2022-09-20 17:11:24.296 +01:00 [INF] Executed DbCommand (4ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.id = @__p_0
LIMIT 1
2022-09-20 17:11:24.298 +01:00 [DBG] Context 'PostgresContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-20 17:11:24.299 +01:00 [DBG] A data reader was disposed.
2022-09-20 17:11:24.300 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-20 17:11:24.300 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-20 17:11:24.303 +01:00 [INF] Executing endpoint 'APIBank.Controllers.AccountsController.GetAllFromUser (APIBank)'
2022-09-20 17:11:24.307 +01:00 [INF] Route matched with {action = "GetAllFromUser", controller = "Accounts"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult GetAllFromUser() on controller APIBank.Controllers.AccountsController (APIBank).
2022-09-20 17:11:24.308 +01:00 [DBG] Execution plan of authorization filters (in the following order): ["APIBank.Authorization.AuthorizeAttribute"]
2022-09-20 17:11:24.310 +01:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2022-09-20 17:11:24.312 +01:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2022-09-20 17:11:24.313 +01:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2022-09-20 17:11:24.314 +01:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2022-09-20 17:11:24.316 +01:00 [DBG] Executing controller factory for controller APIBank.Controllers.AccountsController (APIBank)
2022-09-20 17:11:24.318 +01:00 [DBG] Executed controller factory for controller APIBank.Controllers.AccountsController (APIBank)
2022-09-20 17:11:24.326 +01:00 [DBG] Compiling query expression: 
'DbSet<Account>()
    .Where(u => u.UserId == __userId_0)
    .Select(u => new AccountRe{ 
        Balance = u.Balance, 
        CreatedAt = u.CreatedAt, 
        Currency = u.Currency, 
        Id = u.Id 
    }
    )'
2022-09-20 17:11:24.351 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<AccountRe>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            Balance -> 0
            CreatedAt -> 1
            Currency -> 2
            Id -> 3
        SELECT a.balance AS Balance, a.created_at AS CreatedAt, a.currency AS Currency, a.id AS Id
        FROM accounts AS a
        WHERE a.user_id == @__userId_0), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, AccountRe>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)'
2022-09-20 17:11:24.354 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-20 17:11:24.355 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2022-09-20 17:11:24.355 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-20 17:11:24.357 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-20 17:11:24.358 +01:00 [DBG] Executing DbCommand [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a.balance AS "Balance", a.created_at AS "CreatedAt", a.currency AS "Currency", a.id AS "Id"
FROM accounts AS a
WHERE a.user_id = @__userId_0
2022-09-20 17:11:24.363 +01:00 [INF] Executed DbCommand (5ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a.balance AS "Balance", a.created_at AS "CreatedAt", a.currency AS "Currency", a.id AS "Id"
FROM accounts AS a
WHERE a.user_id = @__userId_0
2022-09-20 17:11:24.375 +01:00 [DBG] A data reader was disposed.
2022-09-20 17:11:24.376 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-20 17:11:24.380 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-20 17:11:24.383 +01:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2022-09-20 17:11:24.385 +01:00 [DBG] Attempting to select an output formatter based on Accept header '["text/plain"]'.
2022-09-20 17:11:24.386 +01:00 [DBG] Could not find an output formatter based on content negotiation. Accepted types were (["text/plain"])
2022-09-20 17:11:24.387 +01:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2022-09-20 17:11:24.388 +01:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2022-09-20 17:11:24.388 +01:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2022-09-20 17:11:24.389 +01:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[APIBank.Models.Accounts.AccountRe, APIBank, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2022-09-20 17:11:24.399 +01:00 [INF] Executed action APIBank.Controllers.AccountsController.GetAllFromUser (APIBank) in 83.4246ms
2022-09-20 17:11:24.401 +01:00 [INF] Executed endpoint 'APIBank.Controllers.AccountsController.GetAllFromUser (APIBank)'
2022-09-20 17:11:24.402 +01:00 [DBG] 'PostgresContext' disposed.
2022-09-20 17:11:24.403 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/api/Accounts/GetAll - - - 200 - application/json;+charset=utf-8 286.4514ms
2022-09-20 17:11:59.651 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/api/Accounts/GetById/100000000 - -
2022-09-20 17:11:59.675 +01:00 [DBG] 1 candidate(s) found for the request path '/api/Accounts/GetById/100000000'
2022-09-20 17:11:59.680 +01:00 [DBG] Endpoint 'APIBank.Controllers.AccountsController.GetById (APIBank)' with route pattern 'api/Accounts/GetById/{accountId}' is valid for the request path '/api/Accounts/GetById/100000000'
2022-09-20 17:11:59.685 +01:00 [DBG] Request matched endpoint 'APIBank.Controllers.AccountsController.GetById (APIBank)'
2022-09-20 17:11:59.687 +01:00 [DBG] Static files was skipped as the request already matched an endpoint.
2022-09-20 17:11:59.752 +01:00 [INF] Entity Framework Core 6.0.9 initialized 'PostgresContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:6.0.7+5b98e4b74de93b590b44aef8dd7967c03acc433c' with options: None
2022-09-20 17:11:59.759 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-20 17:11:59.761 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2022-09-20 17:11:59.762 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-20 17:11:59.763 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-20 17:11:59.764 +01:00 [DBG] Executing DbCommand [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.id = @__p_0
LIMIT 1
2022-09-20 17:11:59.768 +01:00 [INF] Executed DbCommand (4ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.id = @__p_0
LIMIT 1
2022-09-20 17:11:59.770 +01:00 [DBG] Context 'PostgresContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-20 17:11:59.772 +01:00 [DBG] A data reader was disposed.
2022-09-20 17:11:59.773 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-20 17:11:59.774 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-20 17:11:59.775 +01:00 [INF] Executing endpoint 'APIBank.Controllers.AccountsController.GetById (APIBank)'
2022-09-20 17:11:59.777 +01:00 [INF] Route matched with {action = "GetById", controller = "Accounts"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult GetById(Int32) on controller APIBank.Controllers.AccountsController (APIBank).
2022-09-20 17:11:59.779 +01:00 [DBG] Execution plan of authorization filters (in the following order): ["APIBank.Authorization.AuthorizeAttribute"]
2022-09-20 17:11:59.781 +01:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2022-09-20 17:11:59.782 +01:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2022-09-20 17:11:59.784 +01:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2022-09-20 17:11:59.786 +01:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2022-09-20 17:11:59.788 +01:00 [DBG] Executing controller factory for controller APIBank.Controllers.AccountsController (APIBank)
2022-09-20 17:11:59.789 +01:00 [DBG] Executed controller factory for controller APIBank.Controllers.AccountsController (APIBank)
2022-09-20 17:11:59.790 +01:00 [DBG] Attempting to bind parameter 'accountId' of type 'System.Int32' ...
2022-09-20 17:11:59.792 +01:00 [DBG] Attempting to bind parameter 'accountId' of type 'System.Int32' using the name 'accountId' in request data ...
2022-09-20 17:11:59.794 +01:00 [DBG] Done attempting to bind parameter 'accountId' of type 'System.Int32'.
2022-09-20 17:11:59.796 +01:00 [DBG] Done attempting to bind parameter 'accountId' of type 'System.Int32'.
2022-09-20 17:11:59.797 +01:00 [DBG] Attempting to validate the bound parameter 'accountId' of type 'System.Int32' ...
2022-09-20 17:11:59.800 +01:00 [DBG] Done attempting to validate the bound parameter 'accountId' of type 'System.Int32'.
2022-09-20 17:11:59.820 +01:00 [DBG] Compiling query expression: 
'DbSet<Account>()
    .Include(a => a.Transactions)
    .Where(a => a.Id == __accountId_0 && a.UserId == __userId_1)
    .Select(a => new AccountMovims{ 
        Account = new AccountRe{ 
            Balance = a.Balance, 
            Currency = a.Currency, 
            CreatedAt = a.CreatedAt, 
            Id = a.Id 
        }
        , 
        Movims = a.Transactions
            .Select(b => new Movim{ 
                Amount = b.Amount, 
                CreatedAt = b.CreatedAt 
            }
            )
            .ToArray() 
    }
    )
    .SingleOrDefault()'
2022-09-20 17:11:59.965 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<AccountMovims>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Client Projections:
            0 -> 0
            1 -> 1
            2 -> 2
            3 -> 3
            4 -> 4
            5 -> 5
            6 -> 6
        SELECT t.balance, t.currency, t.created_at, t.id, t0.amount, t0.created_at, t0.id
        FROM 
        (
            SELECT TOP(2) a.balance, a.currency, a.created_at, a.id
            FROM accounts AS a
            WHERE (a.id == @__accountId_0) && (a.user_id == @__userId_1)
        ) AS t
        LEFT JOIN transactions AS t0 ON t.id == t0.account_id
        ORDER BY t.id ASC), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, AccountMovims>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)
    .SingleOrDefault()'
2022-09-20 17:11:59.975 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-20 17:11:59.976 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2022-09-20 17:11:59.977 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-20 17:11:59.977 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-20 17:11:59.979 +01:00 [DBG] Executing DbCommand [Parameters=[@__accountId_0='?' (DbType = Int32), @__userId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT t.balance, t.currency, t.created_at, t.id, t0.amount, t0.created_at, t0.id
FROM (
    SELECT a.balance, a.currency, a.created_at, a.id
    FROM accounts AS a
    WHERE (a.id = @__accountId_0) AND (a.user_id = @__userId_1)
    LIMIT 2
) AS t
LEFT JOIN transactions AS t0 ON t.id = t0.account_id
ORDER BY t.id
2022-09-20 17:11:59.985 +01:00 [INF] Executed DbCommand (6ms) [Parameters=[@__accountId_0='?' (DbType = Int32), @__userId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT t.balance, t.currency, t.created_at, t.id, t0.amount, t0.created_at, t0.id
FROM (
    SELECT a.balance, a.currency, a.created_at, a.id
    FROM accounts AS a
    WHERE (a.id = @__accountId_0) AND (a.user_id = @__userId_1)
    LIMIT 2
) AS t
LEFT JOIN transactions AS t0 ON t.id = t0.account_id
ORDER BY t.id
2022-09-20 17:11:59.990 +01:00 [DBG] A data reader was disposed.
2022-09-20 17:11:59.991 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-20 17:11:59.993 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-20 17:11:59.994 +01:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2022-09-20 17:11:59.996 +01:00 [DBG] Attempting to select an output formatter based on Accept header '["text/plain"]'.
2022-09-20 17:11:59.997 +01:00 [DBG] Could not find an output formatter based on content negotiation. Accepted types were (["text/plain"])
2022-09-20 17:12:00.000 +01:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2022-09-20 17:12:00.002 +01:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2022-09-20 17:12:00.002 +01:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2022-09-20 17:12:00.003 +01:00 [INF] Executing OkObjectResult, writing value of type 'APIBank.Models.AccountMovims'.
2022-09-20 17:12:00.007 +01:00 [INF] Executed action APIBank.Controllers.AccountsController.GetById (APIBank) in 219.0055ms
2022-09-20 17:12:00.008 +01:00 [INF] Executed endpoint 'APIBank.Controllers.AccountsController.GetById (APIBank)'
2022-09-20 17:12:00.010 +01:00 [DBG] 'PostgresContext' disposed.
2022-09-20 17:12:00.011 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/api/Accounts/GetById/100000000 - - - 200 - application/json;+charset=utf-8 360.0231ms
2022-09-20 17:12:39.673 +01:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2022-09-20 17:12:39.785 +01:00 [DBG] Hosting starting
2022-09-20 17:12:39.987 +01:00 [DBG] Using development certificate: CN=localhost (Thumbprint: 9CC642E9838495A6C3C202DECA6A8AD300396DD2)
2022-09-20 17:12:40.081 +01:00 [INF] Now listening on: https://localhost:7036
2022-09-20 17:12:40.126 +01:00 [INF] Now listening on: http://localhost:5036
2022-09-20 17:12:40.131 +01:00 [DBG] Connection id "0HMKR4BOGE7JB" received FIN.
2022-09-20 17:12:40.131 +01:00 [DBG] Connection id "0HMKR4BOGE7JC" received FIN.
2022-09-20 17:12:40.142 +01:00 [DBG] Loaded hosting startup assembly APIBank
2022-09-20 17:12:40.147 +01:00 [DBG] Loaded hosting startup assembly Microsoft.AspNetCore.Watch.BrowserRefresh
2022-09-20 17:12:40.149 +01:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.BrowserLink.Net
2022-09-20 17:12:40.155 +01:00 [INF] Application started. Press Ctrl+C to shut down.
2022-09-20 17:12:40.156 +01:00 [INF] Hosting environment: Development
2022-09-20 17:12:40.157 +01:00 [INF] Content root path: C:\Users\mguedesa\OneDrive - NTT DATA EMEAL\Documentos\GitHub\OpenBankAPI-NTT\APIBank\APIBank\
2022-09-20 17:12:40.158 +01:00 [DBG] Hosting started
2022-09-20 17:12:40.166 +01:00 [DBG] Connection id "0HMKR4BOGE7JC" accepted.
2022-09-20 17:12:40.166 +01:00 [DBG] Connection id "0HMKR4BOGE7JB" accepted.
2022-09-20 17:12:40.170 +01:00 [DBG] Connection id "0HMKR4BOGE7JC" started.
2022-09-20 17:12:40.170 +01:00 [DBG] Connection id "0HMKR4BOGE7JB" started.
2022-09-20 17:12:40.253 +01:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException:  Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveBlobAsync[TIOAdapter](TIOAdapter adapter)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](TIOAdapter adapter, Boolean receiveFirst, Byte[] reAuthenticationData, Boolean isApm)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2022-09-20 17:12:40.253 +01:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException:  Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveBlobAsync[TIOAdapter](TIOAdapter adapter)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](TIOAdapter adapter, Boolean receiveFirst, Byte[] reAuthenticationData, Boolean isApm)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2022-09-20 17:12:40.579 +01:00 [DBG] Connection id "0HMKR4BOGE7JB" stopped.
2022-09-20 17:12:40.591 +01:00 [DBG] Connection id "0HMKR4BOGE7JD" accepted.
2022-09-20 17:12:40.601 +01:00 [DBG] Connection id "0HMKR4BOGE7JC" stopped.
2022-09-20 17:12:40.607 +01:00 [DBG] Connection id "0HMKR4BOGE7JB" sending FIN because: "The Socket transport's send loop completed gracefully."
2022-09-20 17:12:40.608 +01:00 [DBG] Connection id "0HMKR4BOGE7JD" started.
2022-09-20 17:12:40.615 +01:00 [DBG] Connection id "0HMKR4BOGE7JC" sending FIN because: "The Socket transport's send loop completed gracefully."
2022-09-20 17:12:40.756 +01:00 [DBG] Connection 0HMKR4BOGE7JD established using the following protocol: "Tls12"
2022-09-20 17:12:40.887 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/swagger/index.html - -
2022-09-20 17:12:40.950 +01:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2022-09-20 17:12:40.988 +01:00 [DBG] No candidates found for the request path '/swagger/index.html'
2022-09-20 17:12:40.991 +01:00 [DBG] Request did not match any endpoints
2022-09-20 17:12:41.119 +01:00 [DBG] Response markup is scheduled to include browser refresh script injection.
2022-09-20 17:12:41.317 +01:00 [DBG] Response markup was updated to include browser refresh script injection.
2022-09-20 17:12:41.330 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/swagger/index.html - - - 200 - text/html;charset=utf-8 459.3829ms
2022-09-20 17:12:41.342 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/_framework/aspnetcore-browser-refresh.js - -
2022-09-20 17:12:41.348 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/_vs/browserLink - -
2022-09-20 17:12:41.381 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/_framework/aspnetcore-browser-refresh.js - - - 200 11984 application/javascript;+charset=utf-8 34.6321ms
2022-09-20 17:12:41.433 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/_vs/browserLink - - - 200 - text/javascript;+charset=UTF-8 85.1846ms
2022-09-20 17:12:41.534 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/swagger/v1/swagger.json - -
2022-09-20 17:12:41.536 +01:00 [DBG] No candidates found for the request path '/swagger/v1/swagger.json'
2022-09-20 17:12:41.537 +01:00 [DBG] Request did not match any endpoints
2022-09-20 17:12:41.744 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/swagger/v1/swagger.json - - - 200 - application/json;charset=utf-8 209.6967ms
2022-09-20 17:13:33.944 +01:00 [INF] Request starting HTTP/2 POST https://localhost:7036/api/Users/Login application/json 58
2022-09-20 17:13:33.974 +01:00 [DBG] 1 candidate(s) found for the request path '/api/Users/Login'
2022-09-20 17:13:33.981 +01:00 [DBG] Endpoint 'APIBank.Controllers.UsersController.Login (APIBank)' with route pattern 'api/Users/Login' is valid for the request path '/api/Users/Login'
2022-09-20 17:13:33.986 +01:00 [DBG] Request matched endpoint 'APIBank.Controllers.UsersController.Login (APIBank)'
2022-09-20 17:13:33.989 +01:00 [DBG] Static files was skipped as the request already matched an endpoint.
2022-09-20 17:13:34.455 +01:00 [INF] Executing endpoint 'APIBank.Controllers.UsersController.Login (APIBank)'
2022-09-20 17:13:34.487 +01:00 [INF] Route matched with {action = "Login", controller = "Users"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult Login(APIBank.Models.Requests.LoginRequest) on controller APIBank.Controllers.UsersController (APIBank).
2022-09-20 17:13:34.493 +01:00 [DBG] Execution plan of authorization filters (in the following order): ["APIBank.Authorization.AuthorizeAttribute"]
2022-09-20 17:13:34.495 +01:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2022-09-20 17:13:34.500 +01:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2022-09-20 17:13:34.503 +01:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2022-09-20 17:13:34.505 +01:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2022-09-20 17:13:34.510 +01:00 [DBG] Executing controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-20 17:13:34.515 +01:00 [DBG] Executed controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-20 17:13:34.534 +01:00 [DBG] Attempting to bind parameter 'model' of type 'APIBank.Models.Requests.LoginRequest' ...
2022-09-20 17:13:34.538 +01:00 [DBG] Attempting to bind parameter 'model' of type 'APIBank.Models.Requests.LoginRequest' using the name '' in request data ...
2022-09-20 17:13:34.540 +01:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2022-09-20 17:13:34.550 +01:00 [DBG] Connection id "0HMKR4BOGE7JD", Request id "0HMKR4BOGE7JD:00000009": started reading request body.
2022-09-20 17:13:34.552 +01:00 [DBG] Connection id "0HMKR4BOGE7JD", Request id "0HMKR4BOGE7JD:00000009": done reading request body.
2022-09-20 17:13:34.561 +01:00 [DBG] JSON input formatter succeeded, deserializing to type 'APIBank.Models.Requests.LoginRequest'
2022-09-20 17:13:34.565 +01:00 [DBG] Done attempting to bind parameter 'model' of type 'APIBank.Models.Requests.LoginRequest'.
2022-09-20 17:13:34.566 +01:00 [DBG] Done attempting to bind parameter 'model' of type 'APIBank.Models.Requests.LoginRequest'.
2022-09-20 17:13:34.567 +01:00 [DBG] Attempting to validate the bound parameter 'model' of type 'APIBank.Models.Requests.LoginRequest' ...
2022-09-20 17:13:34.576 +01:00 [DBG] Done attempting to validate the bound parameter 'model' of type 'APIBank.Models.Requests.LoginRequest'.
2022-09-20 17:13:34.737 +01:00 [DBG] An additional 'IServiceProvider' was created for internal use by Entity Framework. An existing service provider was not used due to the following configuration changes: configuration changed for 'Core:ConfigureWarnings', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:UseAdminDatabase', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:SetPostgresVersion', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:UseRedshift', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:ReverseNullOrdering', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:RemoteCertificateValidationCallback', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:ProvideClientCertificatesCallback', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:ProvidePasswordCallback'.
2022-09-20 17:13:36.331 +01:00 [INF] Entity Framework Core 6.0.9 initialized 'PostgresContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:6.0.7+5b98e4b74de93b590b44aef8dd7967c03acc433c' with options: None
2022-09-20 17:13:36.453 +01:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .SingleOrDefault(x => x.Username == __model_Username_0)'
2022-09-20 17:13:37.070 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<User>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: User.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: User.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 1], [Property: User.Email (string) Required Index MaxLength(254), 2], [Property: User.FullName (string) Required MaxLength(100), 3], [Property: User.PasswordChangedAt (DateTime) Required ValueGenerated.OnAdd, 4], [Property: User.PasswordHash (string) Required MaxLength(200), 5], [Property: User.Username (string) Required Index MaxLength(50), 6] }
        SELECT TOP(2) u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
        FROM users AS u
        WHERE u.username == @__model_Username_0), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, User>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)
    .SingleOrDefault()'
2022-09-20 17:13:37.173 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-20 17:13:37.299 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (124ms).
2022-09-20 17:13:37.317 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-20 17:13:37.652 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-20 17:13:37.680 +01:00 [DBG] Executing DbCommand [Parameters=[@__model_Username_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.username = @__model_Username_0
LIMIT 2
2022-09-20 17:13:37.817 +01:00 [INF] Executed DbCommand (141ms) [Parameters=[@__model_Username_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.username = @__model_Username_0
LIMIT 2
2022-09-20 17:13:37.913 +01:00 [DBG] Context 'PostgresContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-20 17:13:37.996 +01:00 [DBG] A data reader was disposed.
2022-09-20 17:13:38.005 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-20 17:13:38.017 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-20 17:13:38.424 +01:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .Any(user => user.RefreshTokenCollection
        .Any(reftoken => reftoken.RefToken == __token_0))'
2022-09-20 17:13:38.553 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<bool>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            EmptyProjectionMember -> 0
        SELECT EXISTS (
            SELECT 1
            FROM users AS u
            WHERE EXISTS (
                SELECT 1
                FROM refresh_token AS r
                WHERE ((u.id != NULL) && (u.id == r.user_id)) && (r.token == @__token_0)))), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, bool>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)
    .Single()'
2022-09-20 17:13:38.570 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-20 17:13:38.571 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2022-09-20 17:13:38.574 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-20 17:13:38.575 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-20 17:13:38.578 +01:00 [DBG] Executing DbCommand [Parameters=[@__token_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM users AS u
    WHERE EXISTS (
        SELECT 1
        FROM refresh_token AS r
        WHERE (u.id = r.user_id) AND (r.token = @__token_0)))
2022-09-20 17:13:38.583 +01:00 [INF] Executed DbCommand (4ms) [Parameters=[@__token_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM users AS u
    WHERE EXISTS (
        SELECT 1
        FROM refresh_token AS r
        WHERE (u.id = r.user_id) AND (r.token = @__token_0)))
2022-09-20 17:13:38.589 +01:00 [DBG] A data reader was disposed.
2022-09-20 17:13:38.590 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-20 17:13:38.593 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-20 17:13:38.609 +01:00 [DBG] An entity of type 'User' tracked by 'PostgresContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-20 17:13:38.616 +01:00 [DBG] SaveChanges starting for 'PostgresContext'.
2022-09-20 17:13:38.619 +01:00 [DBG] DetectChanges starting for 'PostgresContext'.
2022-09-20 17:13:38.648 +01:00 [DBG] 1 entities were added and 0 entities were removed from navigation 'User.RefreshTokenCollection'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-20 17:13:38.696 +01:00 [DBG] 'PostgresContext' generated a temporary value for the property 'Id.RefreshToken'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-20 17:13:38.751 +01:00 [DBG] Context 'PostgresContext' started tracking 'RefreshToken' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-20 17:13:38.757 +01:00 [DBG] DetectChanges completed for 'PostgresContext'.
2022-09-20 17:13:38.770 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-20 17:13:38.773 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-20 17:13:38.779 +01:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2022-09-20 17:13:38.788 +01:00 [DBG] Began transaction with isolation level 'ReadCommitted'.
2022-09-20 17:13:38.851 +01:00 [DBG] Executing 2 update commands as a batch.
2022-09-20 17:13:38.886 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-20 17:13:38.889 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (2ms).
2022-09-20 17:13:38.892 +01:00 [DBG] Executing DbCommand [Parameters=[@p0='?' (DbType = DateTime), @p1='?', @p2='?' (DbType = DateTime), @p3='?' (DbType = Boolean), @p4='?' (DbType = Boolean), @p5='?' (DbType = Boolean), @p6='?', @p7='?', @p8='?', @p9='?' (DbType = DateTime), @p10='?', @p11='?' (DbType = Int32), @p18='?' (DbType = Int32), @p12='?' (DbType = DateTime), @p13='?', @p14='?', @p15='?' (DbType = DateTime), @p16='?', @p17='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO refresh_token (created, created_by_ip, expires, is_active, is_expired, is_revoked, reason_revoked, token, replaced_by_token, revoked, revoked_by_ip, user_id)
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11)
RETURNING id;
UPDATE users SET created_at = @p12, email = @p13, full_name = @p14, password_changed_at = @p15, password_hash = @p16, username = @p17
WHERE id = @p18;
2022-09-20 17:13:38.918 +01:00 [INF] Executed DbCommand (25ms) [Parameters=[@p0='?' (DbType = DateTime), @p1='?', @p2='?' (DbType = DateTime), @p3='?' (DbType = Boolean), @p4='?' (DbType = Boolean), @p5='?' (DbType = Boolean), @p6='?', @p7='?', @p8='?', @p9='?' (DbType = DateTime), @p10='?', @p11='?' (DbType = Int32), @p18='?' (DbType = Int32), @p12='?' (DbType = DateTime), @p13='?', @p14='?', @p15='?' (DbType = DateTime), @p16='?', @p17='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO refresh_token (created, created_by_ip, expires, is_active, is_expired, is_revoked, reason_revoked, token, replaced_by_token, revoked, revoked_by_ip, user_id)
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11)
RETURNING id;
UPDATE users SET created_at = @p12, email = @p13, full_name = @p14, password_changed_at = @p15, password_hash = @p16, username = @p17
WHERE id = @p18;
2022-09-20 17:13:38.941 +01:00 [DBG] The foreign key property 'RefreshToken.Id' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2022-09-20 17:13:38.951 +01:00 [DBG] A data reader was disposed.
2022-09-20 17:13:38.956 +01:00 [DBG] Committing transaction.
2022-09-20 17:13:38.973 +01:00 [DBG] Committed transaction.
2022-09-20 17:13:38.976 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-20 17:13:38.979 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-20 17:13:38.982 +01:00 [DBG] Disposing transaction.
2022-09-20 17:13:38.985 +01:00 [DBG] An entity of type 'RefreshToken' tracked by 'PostgresContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-20 17:13:38.987 +01:00 [DBG] An entity of type 'User' tracked by 'PostgresContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-20 17:13:38.990 +01:00 [DBG] SaveChanges completed for 'PostgresContext' with 2 entities written to the database.
2022-09-20 17:13:38.998 +01:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2022-09-20 17:13:39.004 +01:00 [DBG] Attempting to select an output formatter based on Accept header '["text/plain"]'.
2022-09-20 17:13:39.006 +01:00 [DBG] Could not find an output formatter based on content negotiation. Accepted types were (["text/plain"])
2022-09-20 17:13:39.007 +01:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2022-09-20 17:13:39.008 +01:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2022-09-20 17:13:39.011 +01:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2022-09-20 17:13:39.012 +01:00 [INF] Executing OkObjectResult, writing value of type 'APIBank.Models.Users.Responses.LoginResponse'.
2022-09-20 17:13:39.035 +01:00 [INF] Executed action APIBank.Controllers.UsersController.Login (APIBank) in 4517.5049ms
2022-09-20 17:13:39.037 +01:00 [INF] Executed endpoint 'APIBank.Controllers.UsersController.Login (APIBank)'
2022-09-20 17:13:39.044 +01:00 [DBG] 'PostgresContext' disposed.
2022-09-20 17:13:39.052 +01:00 [INF] Request finished HTTP/2 POST https://localhost:7036/api/Users/Login application/json 58 - 200 - application/json;+charset=utf-8 5108.4320ms
2022-09-20 17:47:54.101 +01:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2022-09-20 17:47:54.227 +01:00 [DBG] Hosting starting
2022-09-20 17:47:54.447 +01:00 [DBG] Using development certificate: CN=localhost (Thumbprint: 9CC642E9838495A6C3C202DECA6A8AD300396DD2)
2022-09-20 17:47:54.555 +01:00 [INF] Now listening on: https://localhost:7036
2022-09-20 17:47:54.557 +01:00 [INF] Now listening on: http://localhost:5036
2022-09-20 17:47:54.558 +01:00 [DBG] Loaded hosting startup assembly APIBank
2022-09-20 17:47:54.559 +01:00 [DBG] Loaded hosting startup assembly Microsoft.AspNetCore.Watch.BrowserRefresh
2022-09-20 17:47:54.560 +01:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.BrowserLink.Net
2022-09-20 17:47:54.562 +01:00 [INF] Application started. Press Ctrl+C to shut down.
2022-09-20 17:47:54.563 +01:00 [INF] Hosting environment: Development
2022-09-20 17:47:54.565 +01:00 [INF] Content root path: C:\Users\mguedesa\OneDrive - NTT DATA EMEAL\Documentos\GitHub\OpenBankAPI-NTT\APIBank\APIBank\
2022-09-20 17:47:54.566 +01:00 [DBG] Hosting started
2022-09-20 17:47:54.911 +01:00 [DBG] Connection id "0HMKR4VEOFK1G" accepted.
2022-09-20 17:47:54.911 +01:00 [DBG] Connection id "0HMKR4VEOFK1G" received FIN.
2022-09-20 17:47:54.911 +01:00 [DBG] Connection id "0HMKR4VEOFK1F" accepted.
2022-09-20 17:47:54.911 +01:00 [DBG] Connection id "0HMKR4VEOFK1F" received FIN.
2022-09-20 17:47:54.914 +01:00 [DBG] Connection id "0HMKR4VEOFK1G" started.
2022-09-20 17:47:54.922 +01:00 [DBG] Connection id "0HMKR4VEOFK1F" started.
2022-09-20 17:47:54.985 +01:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException:  Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveBlobAsync[TIOAdapter](TIOAdapter adapter)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](TIOAdapter adapter, Boolean receiveFirst, Byte[] reAuthenticationData, Boolean isApm)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2022-09-20 17:47:54.985 +01:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException:  Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveBlobAsync[TIOAdapter](TIOAdapter adapter)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](TIOAdapter adapter, Boolean receiveFirst, Byte[] reAuthenticationData, Boolean isApm)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2022-09-20 17:47:55.054 +01:00 [DBG] Connection id "0HMKR4VEOFK1G" stopped.
2022-09-20 17:47:55.054 +01:00 [DBG] Connection id "0HMKR4VEOFK1F" stopped.
2022-09-20 17:47:55.063 +01:00 [DBG] Connection id "0HMKR4VEOFK1G" sending FIN because: "The Socket transport's send loop completed gracefully."
2022-09-20 17:47:55.063 +01:00 [DBG] Connection id "0HMKR4VEOFK1F" sending FIN because: "The Socket transport's send loop completed gracefully."
2022-09-20 17:47:55.621 +01:00 [DBG] Connection id "0HMKR4VEOFK1H" accepted.
2022-09-20 17:47:55.625 +01:00 [DBG] Connection id "0HMKR4VEOFK1H" started.
2022-09-20 17:47:55.744 +01:00 [DBG] Connection 0HMKR4VEOFK1H established using the following protocol: "Tls12"
2022-09-20 17:47:55.869 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/swagger/index.html - -
2022-09-20 17:47:55.950 +01:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2022-09-20 17:47:55.995 +01:00 [DBG] No candidates found for the request path '/swagger/index.html'
2022-09-20 17:47:55.998 +01:00 [DBG] Request did not match any endpoints
2022-09-20 17:47:56.191 +01:00 [DBG] Response markup is scheduled to include browser refresh script injection.
2022-09-20 17:47:56.585 +01:00 [DBG] Response markup was updated to include browser refresh script injection.
2022-09-20 17:47:56.628 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/_framework/aspnetcore-browser-refresh.js - -
2022-09-20 17:47:56.628 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/_vs/browserLink - -
2022-09-20 17:47:56.648 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/swagger/index.html - - - 200 - text/html;charset=utf-8 785.4675ms
2022-09-20 17:47:56.649 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/_framework/aspnetcore-browser-refresh.js - - - 200 11984 application/javascript;+charset=utf-8 20.7491ms
2022-09-20 17:47:56.995 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/_vs/browserLink - - - 200 - text/javascript;+charset=UTF-8 366.6254ms
2022-09-20 17:47:57.153 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/swagger/v1/swagger.json - -
2022-09-20 17:47:57.156 +01:00 [DBG] No candidates found for the request path '/swagger/v1/swagger.json'
2022-09-20 17:47:57.157 +01:00 [DBG] Request did not match any endpoints
2022-09-20 17:47:57.559 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/swagger/v1/swagger.json - - - 200 - application/json;charset=utf-8 405.7691ms
2022-09-20 17:48:59.896 +01:00 [INF] Request starting HTTP/2 POST https://localhost:7036/api/Users/Login application/json 58
2022-09-20 17:48:59.904 +01:00 [DBG] 1 candidate(s) found for the request path '/api/Users/Login'
2022-09-20 17:48:59.909 +01:00 [DBG] Endpoint 'APIBank.Controllers.UsersController.Login (APIBank)' with route pattern 'api/Users/Login' is valid for the request path '/api/Users/Login'
2022-09-20 17:48:59.913 +01:00 [DBG] Request matched endpoint 'APIBank.Controllers.UsersController.Login (APIBank)'
2022-09-20 17:48:59.915 +01:00 [DBG] Static files was skipped as the request already matched an endpoint.
2022-09-20 17:49:00.370 +01:00 [INF] Executing endpoint 'APIBank.Controllers.UsersController.Login (APIBank)'
2022-09-20 17:49:00.407 +01:00 [INF] Route matched with {action = "Login", controller = "Users"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult Login(APIBank.Models.Requests.LoginRequest) on controller APIBank.Controllers.UsersController (APIBank).
2022-09-20 17:49:00.419 +01:00 [DBG] Execution plan of authorization filters (in the following order): ["APIBank.Authorization.AuthorizeAttribute"]
2022-09-20 17:49:00.420 +01:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2022-09-20 17:49:00.422 +01:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2022-09-20 17:49:00.423 +01:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2022-09-20 17:49:00.426 +01:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2022-09-20 17:49:00.434 +01:00 [DBG] Executing controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-20 17:49:00.436 +01:00 [DBG] Executed controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-20 17:49:00.460 +01:00 [DBG] Attempting to bind parameter 'model' of type 'APIBank.Models.Requests.LoginRequest' ...
2022-09-20 17:49:00.467 +01:00 [DBG] Attempting to bind parameter 'model' of type 'APIBank.Models.Requests.LoginRequest' using the name '' in request data ...
2022-09-20 17:49:00.469 +01:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2022-09-20 17:49:00.478 +01:00 [DBG] Connection id "0HMKR4VEOFK1H", Request id "0HMKR4VEOFK1H:00000009": started reading request body.
2022-09-20 17:49:00.480 +01:00 [DBG] Connection id "0HMKR4VEOFK1H", Request id "0HMKR4VEOFK1H:00000009": done reading request body.
2022-09-20 17:49:00.488 +01:00 [DBG] JSON input formatter succeeded, deserializing to type 'APIBank.Models.Requests.LoginRequest'
2022-09-20 17:49:00.491 +01:00 [DBG] Done attempting to bind parameter 'model' of type 'APIBank.Models.Requests.LoginRequest'.
2022-09-20 17:49:00.495 +01:00 [DBG] Done attempting to bind parameter 'model' of type 'APIBank.Models.Requests.LoginRequest'.
2022-09-20 17:49:00.496 +01:00 [DBG] Attempting to validate the bound parameter 'model' of type 'APIBank.Models.Requests.LoginRequest' ...
2022-09-20 17:49:00.504 +01:00 [DBG] Done attempting to validate the bound parameter 'model' of type 'APIBank.Models.Requests.LoginRequest'.
2022-09-20 17:49:00.649 +01:00 [DBG] An additional 'IServiceProvider' was created for internal use by Entity Framework. An existing service provider was not used due to the following configuration changes: configuration changed for 'Core:ConfigureWarnings', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:UseAdminDatabase', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:SetPostgresVersion', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:UseRedshift', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:ReverseNullOrdering', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:RemoteCertificateValidationCallback', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:ProvideClientCertificatesCallback', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:ProvidePasswordCallback'.
2022-09-20 17:49:02.129 +01:00 [INF] Entity Framework Core 6.0.9 initialized 'PostgresContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:6.0.7+5b98e4b74de93b590b44aef8dd7967c03acc433c' with options: None
2022-09-20 17:49:02.201 +01:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .SingleOrDefault(x => x.Username == __model_Username_0)'
2022-09-20 17:49:02.638 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<User>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: User.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: User.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 1], [Property: User.Email (string) Required Index MaxLength(254), 2], [Property: User.FullName (string) Required MaxLength(100), 3], [Property: User.PasswordChangedAt (DateTime) Required ValueGenerated.OnAdd, 4], [Property: User.PasswordHash (string) Required MaxLength(200), 5], [Property: User.Username (string) Required Index MaxLength(50), 6] }
        SELECT TOP(2) u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
        FROM users AS u
        WHERE u.username == @__model_Username_0), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, User>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)
    .SingleOrDefault()'
2022-09-20 17:49:02.721 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-20 17:49:02.862 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (134ms).
2022-09-20 17:49:02.875 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-20 17:49:03.184 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-20 17:49:03.212 +01:00 [DBG] Executing DbCommand [Parameters=[@__model_Username_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.username = @__model_Username_0
LIMIT 2
2022-09-20 17:49:03.358 +01:00 [INF] Executed DbCommand (156ms) [Parameters=[@__model_Username_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.username = @__model_Username_0
LIMIT 2
2022-09-20 17:49:03.419 +01:00 [DBG] Context 'PostgresContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-20 17:49:03.488 +01:00 [DBG] A data reader was disposed.
2022-09-20 17:49:03.497 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-20 17:49:03.508 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-20 17:49:03.934 +01:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .Any(user => user.RefreshTokenCollection
        .Any(reftoken => reftoken.RefToken == __token_0))'
2022-09-20 17:49:04.054 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<bool>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            EmptyProjectionMember -> 0
        SELECT EXISTS (
            SELECT 1
            FROM users AS u
            WHERE EXISTS (
                SELECT 1
                FROM refresh_token AS r
                WHERE ((u.id != NULL) && (u.id == r.user_id)) && (r.token == @__token_0)))), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, bool>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)
    .Single()'
2022-09-20 17:49:04.068 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-20 17:49:04.069 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2022-09-20 17:49:04.070 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-20 17:49:04.071 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-20 17:49:04.074 +01:00 [DBG] Executing DbCommand [Parameters=[@__token_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM users AS u
    WHERE EXISTS (
        SELECT 1
        FROM refresh_token AS r
        WHERE (u.id = r.user_id) AND (r.token = @__token_0)))
2022-09-20 17:49:04.078 +01:00 [INF] Executed DbCommand (4ms) [Parameters=[@__token_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM users AS u
    WHERE EXISTS (
        SELECT 1
        FROM refresh_token AS r
        WHERE (u.id = r.user_id) AND (r.token = @__token_0)))
2022-09-20 17:49:04.086 +01:00 [DBG] A data reader was disposed.
2022-09-20 17:49:04.087 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-20 17:49:04.088 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-20 17:49:04.108 +01:00 [DBG] An entity of type 'User' tracked by 'PostgresContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-20 17:49:04.115 +01:00 [DBG] SaveChanges starting for 'PostgresContext'.
2022-09-20 17:49:04.119 +01:00 [DBG] DetectChanges starting for 'PostgresContext'.
2022-09-20 17:49:04.143 +01:00 [DBG] 1 entities were added and 0 entities were removed from navigation 'User.RefreshTokenCollection'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-20 17:49:04.185 +01:00 [DBG] 'PostgresContext' generated a temporary value for the property 'Id.RefreshToken'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-20 17:49:04.246 +01:00 [DBG] Context 'PostgresContext' started tracking 'RefreshToken' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-20 17:49:04.254 +01:00 [DBG] DetectChanges completed for 'PostgresContext'.
2022-09-20 17:49:04.270 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-20 17:49:04.273 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-20 17:49:04.278 +01:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2022-09-20 17:49:04.287 +01:00 [DBG] Began transaction with isolation level 'ReadCommitted'.
2022-09-20 17:49:04.357 +01:00 [DBG] Executing 2 update commands as a batch.
2022-09-20 17:49:04.385 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-20 17:49:04.386 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2022-09-20 17:49:04.392 +01:00 [DBG] Executing DbCommand [Parameters=[@p0='?' (DbType = DateTime), @p1='?', @p2='?' (DbType = DateTime), @p3='?' (DbType = Boolean), @p4='?' (DbType = Boolean), @p5='?' (DbType = Boolean), @p6='?', @p7='?', @p8='?', @p9='?' (DbType = DateTime), @p10='?', @p11='?' (DbType = Int32), @p18='?' (DbType = Int32), @p12='?' (DbType = DateTime), @p13='?', @p14='?', @p15='?' (DbType = DateTime), @p16='?', @p17='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO refresh_token (created, created_by_ip, expires, is_active, is_expired, is_revoked, reason_revoked, token, replaced_by_token, revoked, revoked_by_ip, user_id)
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11)
RETURNING id;
UPDATE users SET created_at = @p12, email = @p13, full_name = @p14, password_changed_at = @p15, password_hash = @p16, username = @p17
WHERE id = @p18;
2022-09-20 17:49:04.418 +01:00 [INF] Executed DbCommand (26ms) [Parameters=[@p0='?' (DbType = DateTime), @p1='?', @p2='?' (DbType = DateTime), @p3='?' (DbType = Boolean), @p4='?' (DbType = Boolean), @p5='?' (DbType = Boolean), @p6='?', @p7='?', @p8='?', @p9='?' (DbType = DateTime), @p10='?', @p11='?' (DbType = Int32), @p18='?' (DbType = Int32), @p12='?' (DbType = DateTime), @p13='?', @p14='?', @p15='?' (DbType = DateTime), @p16='?', @p17='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO refresh_token (created, created_by_ip, expires, is_active, is_expired, is_revoked, reason_revoked, token, replaced_by_token, revoked, revoked_by_ip, user_id)
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11)
RETURNING id;
UPDATE users SET created_at = @p12, email = @p13, full_name = @p14, password_changed_at = @p15, password_hash = @p16, username = @p17
WHERE id = @p18;
2022-09-20 17:49:04.446 +01:00 [DBG] The foreign key property 'RefreshToken.Id' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2022-09-20 17:49:04.458 +01:00 [DBG] A data reader was disposed.
2022-09-20 17:49:04.462 +01:00 [DBG] Committing transaction.
2022-09-20 17:49:04.474 +01:00 [DBG] Committed transaction.
2022-09-20 17:49:04.476 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-20 17:49:04.478 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-20 17:49:04.482 +01:00 [DBG] Disposing transaction.
2022-09-20 17:49:04.486 +01:00 [DBG] An entity of type 'RefreshToken' tracked by 'PostgresContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-20 17:49:04.490 +01:00 [DBG] An entity of type 'User' tracked by 'PostgresContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-20 17:49:04.493 +01:00 [DBG] SaveChanges completed for 'PostgresContext' with 2 entities written to the database.
2022-09-20 17:49:04.499 +01:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2022-09-20 17:49:04.508 +01:00 [DBG] Attempting to select an output formatter based on Accept header '["text/plain"]'.
2022-09-20 17:49:04.510 +01:00 [DBG] Could not find an output formatter based on content negotiation. Accepted types were (["text/plain"])
2022-09-20 17:49:04.511 +01:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2022-09-20 17:49:04.512 +01:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2022-09-20 17:49:04.513 +01:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2022-09-20 17:49:04.515 +01:00 [INF] Executing OkObjectResult, writing value of type 'APIBank.Models.Users.Responses.LoginResponse'.
2022-09-20 17:49:04.537 +01:00 [INF] Executed action APIBank.Controllers.UsersController.Login (APIBank) in 4098.9639ms
2022-09-20 17:49:04.541 +01:00 [INF] Executed endpoint 'APIBank.Controllers.UsersController.Login (APIBank)'
2022-09-20 17:49:04.548 +01:00 [DBG] 'PostgresContext' disposed.
2022-09-20 17:49:04.556 +01:00 [INF] Request finished HTTP/2 POST https://localhost:7036/api/Users/Login application/json 58 - 200 - application/json;+charset=utf-8 4660.5403ms
2022-09-20 17:50:48.603 +01:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2022-09-20 17:50:48.790 +01:00 [DBG] Hosting starting
2022-09-20 17:50:49.202 +01:00 [DBG] Using development certificate: CN=localhost (Thumbprint: 9CC642E9838495A6C3C202DECA6A8AD300396DD2)
2022-09-20 17:50:49.977 +01:00 [INF] Now listening on: https://localhost:7036
2022-09-20 17:50:49.979 +01:00 [INF] Now listening on: http://localhost:5036
2022-09-20 17:50:49.983 +01:00 [DBG] Loaded hosting startup assembly APIBank
2022-09-20 17:50:49.984 +01:00 [DBG] Loaded hosting startup assembly Microsoft.AspNetCore.Watch.BrowserRefresh
2022-09-20 17:50:49.985 +01:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.BrowserLink.Net
2022-09-20 17:50:49.987 +01:00 [INF] Application started. Press Ctrl+C to shut down.
2022-09-20 17:50:49.988 +01:00 [INF] Hosting environment: Development
2022-09-20 17:50:49.989 +01:00 [INF] Content root path: C:\Users\mguedesa\OneDrive - NTT DATA EMEAL\Documentos\GitHub\OpenBankAPI-NTT\APIBank\APIBank\
2022-09-20 17:50:49.990 +01:00 [DBG] Hosting started
2022-09-20 17:50:50.415 +01:00 [DBG] Connection id "0HMKR51327QSS" accepted.
2022-09-20 17:50:50.415 +01:00 [DBG] Connection id "0HMKR51327QSR" accepted.
2022-09-20 17:50:50.427 +01:00 [DBG] Connection id "0HMKR51327QSR" started.
2022-09-20 17:50:50.427 +01:00 [DBG] Connection id "0HMKR51327QSS" started.
2022-09-20 17:50:50.430 +01:00 [DBG] Connection id "0HMKR51327QSS" received FIN.
2022-09-20 17:50:50.430 +01:00 [DBG] Connection id "0HMKR51327QSR" received FIN.
2022-09-20 17:50:50.471 +01:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException:  Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveBlobAsync[TIOAdapter](TIOAdapter adapter)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](TIOAdapter adapter, Boolean receiveFirst, Byte[] reAuthenticationData, Boolean isApm)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2022-09-20 17:50:50.471 +01:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException:  Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveBlobAsync[TIOAdapter](TIOAdapter adapter)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](TIOAdapter adapter, Boolean receiveFirst, Byte[] reAuthenticationData, Boolean isApm)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2022-09-20 17:50:50.553 +01:00 [DBG] Connection id "0HMKR51327QSS" stopped.
2022-09-20 17:50:50.554 +01:00 [DBG] Connection id "0HMKR51327QSR" stopped.
2022-09-20 17:50:50.568 +01:00 [DBG] Connection id "0HMKR51327QSR" sending FIN because: "The Socket transport's send loop completed gracefully."
2022-09-20 17:50:50.568 +01:00 [DBG] Connection id "0HMKR51327QSS" sending FIN because: "The Socket transport's send loop completed gracefully."
2022-09-20 17:50:50.761 +01:00 [DBG] Connection id "0HMKR51327QST" accepted.
2022-09-20 17:50:50.765 +01:00 [DBG] Connection id "0HMKR51327QST" started.
2022-09-20 17:50:50.883 +01:00 [DBG] Connection 0HMKR51327QST established using the following protocol: "Tls12"
2022-09-20 17:50:51.068 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/swagger/index.html - -
2022-09-20 17:50:51.186 +01:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2022-09-20 17:50:51.237 +01:00 [DBG] No candidates found for the request path '/swagger/index.html'
2022-09-20 17:50:51.241 +01:00 [DBG] Request did not match any endpoints
2022-09-20 17:50:51.435 +01:00 [DBG] Response markup is scheduled to include browser refresh script injection.
2022-09-20 17:50:51.645 +01:00 [DBG] Response markup was updated to include browser refresh script injection.
2022-09-20 17:50:51.655 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/swagger/index.html - - - 200 - text/html;charset=utf-8 596.0888ms
2022-09-20 17:50:51.687 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/_vs/browserLink - -
2022-09-20 17:50:51.687 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/_framework/aspnetcore-browser-refresh.js - -
2022-09-20 17:50:51.710 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/_framework/aspnetcore-browser-refresh.js - - - 200 11984 application/javascript;+charset=utf-8 22.6777ms
2022-09-20 17:50:51.807 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/_vs/browserLink - - - 200 - text/javascript;+charset=UTF-8 120.2497ms
2022-09-20 17:50:51.920 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/swagger/v1/swagger.json - -
2022-09-20 17:50:51.922 +01:00 [DBG] No candidates found for the request path '/swagger/v1/swagger.json'
2022-09-20 17:50:51.923 +01:00 [DBG] Request did not match any endpoints
2022-09-20 17:50:52.158 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/swagger/v1/swagger.json - - - 200 - application/json;charset=utf-8 238.4576ms
2022-09-20 17:51:05.493 +01:00 [INF] Request starting HTTP/2 POST https://localhost:7036/api/Users/Login application/json 58
2022-09-20 17:51:05.510 +01:00 [DBG] 1 candidate(s) found for the request path '/api/Users/Login'
2022-09-20 17:51:05.518 +01:00 [DBG] Endpoint 'APIBank.Controllers.UsersController.Login (APIBank)' with route pattern 'api/Users/Login' is valid for the request path '/api/Users/Login'
2022-09-20 17:51:05.522 +01:00 [DBG] Request matched endpoint 'APIBank.Controllers.UsersController.Login (APIBank)'
2022-09-20 17:51:05.526 +01:00 [DBG] Static files was skipped as the request already matched an endpoint.
2022-09-20 17:51:06.080 +01:00 [INF] Executing endpoint 'APIBank.Controllers.UsersController.Login (APIBank)'
2022-09-20 17:51:06.117 +01:00 [INF] Route matched with {action = "Login", controller = "Users"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult Login(APIBank.Models.Requests.LoginRequest) on controller APIBank.Controllers.UsersController (APIBank).
2022-09-20 17:51:06.121 +01:00 [DBG] Execution plan of authorization filters (in the following order): ["APIBank.Authorization.AuthorizeAttribute"]
2022-09-20 17:51:06.123 +01:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2022-09-20 17:51:06.125 +01:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2022-09-20 17:51:06.127 +01:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2022-09-20 17:51:06.128 +01:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2022-09-20 17:51:06.131 +01:00 [DBG] Executing controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-20 17:51:06.134 +01:00 [DBG] Executed controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-20 17:51:06.156 +01:00 [DBG] Attempting to bind parameter 'model' of type 'APIBank.Models.Requests.LoginRequest' ...
2022-09-20 17:51:06.160 +01:00 [DBG] Attempting to bind parameter 'model' of type 'APIBank.Models.Requests.LoginRequest' using the name '' in request data ...
2022-09-20 17:51:06.162 +01:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2022-09-20 17:51:06.170 +01:00 [DBG] Connection id "0HMKR51327QST", Request id "0HMKR51327QST:00000009": started reading request body.
2022-09-20 17:51:06.171 +01:00 [DBG] Connection id "0HMKR51327QST", Request id "0HMKR51327QST:00000009": done reading request body.
2022-09-20 17:51:06.180 +01:00 [DBG] JSON input formatter succeeded, deserializing to type 'APIBank.Models.Requests.LoginRequest'
2022-09-20 17:51:06.184 +01:00 [DBG] Done attempting to bind parameter 'model' of type 'APIBank.Models.Requests.LoginRequest'.
2022-09-20 17:51:06.186 +01:00 [DBG] Done attempting to bind parameter 'model' of type 'APIBank.Models.Requests.LoginRequest'.
2022-09-20 17:51:06.187 +01:00 [DBG] Attempting to validate the bound parameter 'model' of type 'APIBank.Models.Requests.LoginRequest' ...
2022-09-20 17:51:06.195 +01:00 [DBG] Done attempting to validate the bound parameter 'model' of type 'APIBank.Models.Requests.LoginRequest'.
2022-09-20 17:51:06.353 +01:00 [DBG] An additional 'IServiceProvider' was created for internal use by Entity Framework. An existing service provider was not used due to the following configuration changes: configuration changed for 'Core:ConfigureWarnings', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:UseAdminDatabase', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:SetPostgresVersion', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:UseRedshift', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:ReverseNullOrdering', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:RemoteCertificateValidationCallback', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:ProvideClientCertificatesCallback', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:ProvidePasswordCallback'.
2022-09-20 17:51:08.058 +01:00 [INF] Entity Framework Core 6.0.9 initialized 'PostgresContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:6.0.7+5b98e4b74de93b590b44aef8dd7967c03acc433c' with options: None
2022-09-20 17:51:08.172 +01:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .SingleOrDefault(x => x.Username == __model_Username_0)'
2022-09-20 17:51:08.732 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<User>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: User.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: User.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 1], [Property: User.Email (string) Required Index MaxLength(254), 2], [Property: User.FullName (string) Required MaxLength(100), 3], [Property: User.PasswordChangedAt (DateTime) Required ValueGenerated.OnAdd, 4], [Property: User.PasswordHash (string) Required MaxLength(200), 5], [Property: User.Username (string) Required Index MaxLength(50), 6] }
        SELECT TOP(2) u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
        FROM users AS u
        WHERE u.username == @__model_Username_0), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, User>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)
    .SingleOrDefault()'
2022-09-20 17:51:08.821 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-20 17:51:08.958 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (125ms).
2022-09-20 17:51:08.975 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-20 17:51:09.328 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-20 17:51:09.356 +01:00 [DBG] Executing DbCommand [Parameters=[@__model_Username_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.username = @__model_Username_0
LIMIT 2
2022-09-20 17:51:09.526 +01:00 [INF] Executed DbCommand (175ms) [Parameters=[@__model_Username_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.username = @__model_Username_0
LIMIT 2
2022-09-20 17:51:09.606 +01:00 [DBG] Context 'PostgresContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-20 17:51:09.680 +01:00 [DBG] A data reader was disposed.
2022-09-20 17:51:09.693 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-20 17:51:09.707 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-20 17:51:10.222 +01:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .Any(user => user.RefreshTokenCollection
        .Any(reftoken => reftoken.RefToken == __token_0))'
2022-09-20 17:51:10.369 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<bool>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            EmptyProjectionMember -> 0
        SELECT EXISTS (
            SELECT 1
            FROM users AS u
            WHERE EXISTS (
                SELECT 1
                FROM refresh_token AS r
                WHERE ((u.id != NULL) && (u.id == r.user_id)) && (r.token == @__token_0)))), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, bool>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)
    .Single()'
2022-09-20 17:51:10.389 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-20 17:51:10.391 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (2ms).
2022-09-20 17:51:10.393 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-20 17:51:10.394 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-20 17:51:10.396 +01:00 [DBG] Executing DbCommand [Parameters=[@__token_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM users AS u
    WHERE EXISTS (
        SELECT 1
        FROM refresh_token AS r
        WHERE (u.id = r.user_id) AND (r.token = @__token_0)))
2022-09-20 17:51:10.402 +01:00 [INF] Executed DbCommand (6ms) [Parameters=[@__token_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM users AS u
    WHERE EXISTS (
        SELECT 1
        FROM refresh_token AS r
        WHERE (u.id = r.user_id) AND (r.token = @__token_0)))
2022-09-20 17:51:10.411 +01:00 [DBG] A data reader was disposed.
2022-09-20 17:51:10.413 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-20 17:51:10.414 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-20 17:51:10.432 +01:00 [DBG] An entity of type 'User' tracked by 'PostgresContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-20 17:51:10.440 +01:00 [DBG] SaveChanges starting for 'PostgresContext'.
2022-09-20 17:51:10.447 +01:00 [DBG] DetectChanges starting for 'PostgresContext'.
2022-09-20 17:51:10.485 +01:00 [DBG] 1 entities were added and 0 entities were removed from navigation 'User.RefreshTokenCollection'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-20 17:51:10.556 +01:00 [DBG] 'PostgresContext' generated a temporary value for the property 'Id.RefreshToken'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-20 17:51:10.638 +01:00 [DBG] Context 'PostgresContext' started tracking 'RefreshToken' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-20 17:51:10.648 +01:00 [DBG] DetectChanges completed for 'PostgresContext'.
2022-09-20 17:51:10.671 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-20 17:51:10.672 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-20 17:51:10.679 +01:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2022-09-20 17:51:10.697 +01:00 [DBG] Began transaction with isolation level 'ReadCommitted'.
2022-09-20 17:51:10.815 +01:00 [DBG] Executing 2 update commands as a batch.
2022-09-20 17:51:10.870 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-20 17:51:10.871 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2022-09-20 17:51:10.873 +01:00 [DBG] Executing DbCommand [Parameters=[@p0='?' (DbType = DateTime), @p1='?', @p2='?' (DbType = DateTime), @p3='?' (DbType = Boolean), @p4='?' (DbType = Boolean), @p5='?' (DbType = Boolean), @p6='?', @p7='?', @p8='?', @p9='?' (DbType = DateTime), @p10='?', @p11='?' (DbType = Int32), @p18='?' (DbType = Int32), @p12='?' (DbType = DateTime), @p13='?', @p14='?', @p15='?' (DbType = DateTime), @p16='?', @p17='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO refresh_token (created, created_by_ip, expires, is_active, is_expired, is_revoked, reason_revoked, token, replaced_by_token, revoked, revoked_by_ip, user_id)
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11)
RETURNING id;
UPDATE users SET created_at = @p12, email = @p13, full_name = @p14, password_changed_at = @p15, password_hash = @p16, username = @p17
WHERE id = @p18;
2022-09-20 17:51:10.898 +01:00 [INF] Executed DbCommand (25ms) [Parameters=[@p0='?' (DbType = DateTime), @p1='?', @p2='?' (DbType = DateTime), @p3='?' (DbType = Boolean), @p4='?' (DbType = Boolean), @p5='?' (DbType = Boolean), @p6='?', @p7='?', @p8='?', @p9='?' (DbType = DateTime), @p10='?', @p11='?' (DbType = Int32), @p18='?' (DbType = Int32), @p12='?' (DbType = DateTime), @p13='?', @p14='?', @p15='?' (DbType = DateTime), @p16='?', @p17='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO refresh_token (created, created_by_ip, expires, is_active, is_expired, is_revoked, reason_revoked, token, replaced_by_token, revoked, revoked_by_ip, user_id)
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11)
RETURNING id;
UPDATE users SET created_at = @p12, email = @p13, full_name = @p14, password_changed_at = @p15, password_hash = @p16, username = @p17
WHERE id = @p18;
2022-09-20 17:51:10.933 +01:00 [DBG] The foreign key property 'RefreshToken.Id' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2022-09-20 17:51:10.946 +01:00 [DBG] A data reader was disposed.
2022-09-20 17:51:10.951 +01:00 [DBG] Committing transaction.
2022-09-20 17:51:10.966 +01:00 [DBG] Committed transaction.
2022-09-20 17:51:10.968 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-20 17:51:10.969 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-20 17:51:10.972 +01:00 [DBG] Disposing transaction.
2022-09-20 17:51:10.976 +01:00 [DBG] An entity of type 'RefreshToken' tracked by 'PostgresContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-20 17:51:10.978 +01:00 [DBG] An entity of type 'User' tracked by 'PostgresContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-20 17:51:10.984 +01:00 [DBG] SaveChanges completed for 'PostgresContext' with 2 entities written to the database.
2022-09-20 17:51:10.991 +01:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2022-09-20 17:51:10.998 +01:00 [DBG] Attempting to select an output formatter based on Accept header '["text/plain"]'.
2022-09-20 17:51:11.000 +01:00 [DBG] Could not find an output formatter based on content negotiation. Accepted types were (["text/plain"])
2022-09-20 17:51:11.001 +01:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2022-09-20 17:51:11.002 +01:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2022-09-20 17:51:11.003 +01:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2022-09-20 17:51:11.004 +01:00 [INF] Executing OkObjectResult, writing value of type 'APIBank.Models.Users.Responses.LoginResponse'.
2022-09-20 17:51:11.024 +01:00 [INF] Executed action APIBank.Controllers.UsersController.Login (APIBank) in 4889.3307ms
2022-09-20 17:51:11.026 +01:00 [INF] Executed endpoint 'APIBank.Controllers.UsersController.Login (APIBank)'
2022-09-20 17:51:11.034 +01:00 [DBG] 'PostgresContext' disposed.
2022-09-20 17:51:11.042 +01:00 [INF] Request finished HTTP/2 POST https://localhost:7036/api/Users/Login application/json 58 - 200 - application/json;+charset=utf-8 5548.6218ms
2022-09-20 17:51:29.730 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/api/Users/1/refresh-tokens - -
2022-09-20 17:51:29.737 +01:00 [DBG] 1 candidate(s) found for the request path '/api/Users/1/refresh-tokens'
2022-09-20 17:51:29.738 +01:00 [DBG] Endpoint 'APIBank.Controllers.UsersController.GetRefreshTokens (APIBank)' with route pattern 'api/Users/{id}/refresh-tokens' is valid for the request path '/api/Users/1/refresh-tokens'
2022-09-20 17:51:29.739 +01:00 [DBG] Request matched endpoint 'APIBank.Controllers.UsersController.GetRefreshTokens (APIBank)'
2022-09-20 17:51:29.740 +01:00 [DBG] Static files was skipped as the request already matched an endpoint.
2022-09-20 17:51:29.917 +01:00 [INF] Entity Framework Core 6.0.9 initialized 'PostgresContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:6.0.7+5b98e4b74de93b590b44aef8dd7967c03acc433c' with options: None
2022-09-20 17:51:29.937 +01:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .FirstOrDefault(e => EF.Property<int>(e, "Id") == __p_0)'
2022-09-20 17:51:29.942 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<User>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: User.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: User.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 1], [Property: User.Email (string) Required Index MaxLength(254), 2], [Property: User.FullName (string) Required MaxLength(100), 3], [Property: User.PasswordChangedAt (DateTime) Required ValueGenerated.OnAdd, 4], [Property: User.PasswordHash (string) Required MaxLength(200), 5], [Property: User.Username (string) Required Index MaxLength(50), 6] }
        SELECT TOP(1) u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
        FROM users AS u
        WHERE u.id == @__p_0), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, User>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)
    .SingleOrDefault()'
2022-09-20 17:51:29.944 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-20 17:51:29.946 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (2ms).
2022-09-20 17:51:29.948 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-20 17:51:29.949 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-20 17:51:29.950 +01:00 [DBG] Executing DbCommand [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.id = @__p_0
LIMIT 1
2022-09-20 17:51:29.954 +01:00 [INF] Executed DbCommand (4ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.id = @__p_0
LIMIT 1
2022-09-20 17:51:29.956 +01:00 [DBG] Context 'PostgresContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-20 17:51:29.957 +01:00 [DBG] A data reader was disposed.
2022-09-20 17:51:29.958 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-20 17:51:29.959 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-20 17:51:29.960 +01:00 [INF] Executing endpoint 'APIBank.Controllers.UsersController.GetRefreshTokens (APIBank)'
2022-09-20 17:51:29.966 +01:00 [INF] Route matched with {action = "GetRefreshTokens", controller = "Users"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult GetRefreshTokens(Int32) on controller APIBank.Controllers.UsersController (APIBank).
2022-09-20 17:51:29.969 +01:00 [DBG] Execution plan of authorization filters (in the following order): ["APIBank.Authorization.AuthorizeAttribute"]
2022-09-20 17:51:29.971 +01:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2022-09-20 17:51:29.972 +01:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2022-09-20 17:51:29.973 +01:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2022-09-20 17:51:29.974 +01:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2022-09-20 17:51:29.976 +01:00 [DBG] Executing controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-20 17:51:29.977 +01:00 [DBG] Executed controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-20 17:51:29.980 +01:00 [DBG] Attempting to bind parameter 'id' of type 'System.Int32' ...
2022-09-20 17:51:29.985 +01:00 [DBG] Attempting to bind parameter 'id' of type 'System.Int32' using the name 'id' in request data ...
2022-09-20 17:51:29.987 +01:00 [DBG] Done attempting to bind parameter 'id' of type 'System.Int32'.
2022-09-20 17:51:29.988 +01:00 [DBG] Done attempting to bind parameter 'id' of type 'System.Int32'.
2022-09-20 17:51:29.989 +01:00 [DBG] Attempting to validate the bound parameter 'id' of type 'System.Int32' ...
2022-09-20 17:51:29.990 +01:00 [DBG] Done attempting to validate the bound parameter 'id' of type 'System.Int32'.
2022-09-20 17:51:30.005 +01:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2022-09-20 17:51:30.008 +01:00 [DBG] No information found on request to perform content negotiation.
2022-09-20 17:51:30.008 +01:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2022-09-20 17:51:30.009 +01:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2022-09-20 17:51:30.010 +01:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2022-09-20 17:51:30.012 +01:00 [INF] Executing OkObjectResult, writing value of type 'Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryable`1[[APIBank.ModelEntities.RefreshToken, APIBank, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2022-09-20 17:51:30.026 +01:00 [DBG] Compiling query expression: 
'DbSet<RefreshToken>()
    .Where(rt => rt.UserId == __id_0)
    .AsNoTracking()
    .Select(rt => new RefreshToken{ 
        Id = rt.Id, 
        UserId = rt.UserId, 
        RefToken = rt.RefToken, 
        Expires = rt.Expires, 
        Created = rt.Created, 
        CreatedByIp = rt.CreatedByIp, 
        Revoked = rt.Revoked, 
        RevokedByIp = rt.RevokedByIp, 
        ReplacedByToken = rt.ReplacedByToken, 
        ReasonRevoked = rt.ReasonRevoked, 
        IsExpired = rt.IsExpired, 
        IsRevoked = rt.IsRevoked, 
        IsActive = rt.IsActive 
    }
    )'
2022-09-20 17:51:30.077 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<RefreshToken>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            Id -> 0
            UserId -> 1
            RefToken -> 2
            Expires -> 3
            Created -> 4
            CreatedByIp -> 5
            Revoked -> 6
            RevokedByIp -> 7
            ReplacedByToken -> 8
            ReasonRevoked -> 9
            IsExpired -> 10
            IsRevoked -> 11
            IsActive -> 12
        SELECT r.id AS Id, r.user_id AS UserId, r.token AS RefToken, r.expires AS Expires, r.created AS Created, r.created_by_ip AS CreatedByIp, r.revoked AS Revoked, r.revoked_by_ip AS RevokedByIp, r.replaced_by_token AS ReplacedByToken, r.reason_revoked AS ReasonRevoked, r.is_expired AS IsExpired, r.is_revoked AS IsRevoked, r.is_active AS IsActive
        FROM refresh_token AS r
        WHERE r.user_id == @__id_0), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, RefreshToken>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)'
2022-09-20 17:51:30.117 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-20 17:51:30.119 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2022-09-20 17:51:30.135 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-20 17:51:30.138 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-20 17:51:30.141 +01:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.user_id AS "UserId", r.token AS "RefToken", r.expires AS "Expires", r.created AS "Created", r.created_by_ip AS "CreatedByIp", r.revoked AS "Revoked", r.revoked_by_ip AS "RevokedByIp", r.replaced_by_token AS "ReplacedByToken", r.reason_revoked AS "ReasonRevoked", r.is_expired AS "IsExpired", r.is_revoked AS "IsRevoked", r.is_active AS "IsActive"
FROM refresh_token AS r
WHERE r.user_id = @__id_0
2022-09-20 17:51:30.150 +01:00 [INF] Executed DbCommand (9ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.user_id AS "UserId", r.token AS "RefToken", r.expires AS "Expires", r.created AS "Created", r.created_by_ip AS "CreatedByIp", r.revoked AS "Revoked", r.revoked_by_ip AS "RevokedByIp", r.replaced_by_token AS "ReplacedByToken", r.reason_revoked AS "ReasonRevoked", r.is_expired AS "IsExpired", r.is_revoked AS "IsRevoked", r.is_active AS "IsActive"
FROM refresh_token AS r
WHERE r.user_id = @__id_0
2022-09-20 17:51:30.180 +01:00 [DBG] A data reader was disposed.
2022-09-20 17:51:30.192 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-20 17:51:30.198 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-20 17:51:30.201 +01:00 [INF] Executed action APIBank.Controllers.UsersController.GetRefreshTokens (APIBank) in 225.1628ms
2022-09-20 17:51:30.202 +01:00 [INF] Executed endpoint 'APIBank.Controllers.UsersController.GetRefreshTokens (APIBank)'
2022-09-20 17:51:30.203 +01:00 [DBG] 'PostgresContext' disposed.
2022-09-20 17:51:30.204 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/api/Users/1/refresh-tokens - - - 200 - application/json;+charset=utf-8 474.2970ms
2022-09-20 17:51:52.269 +01:00 [INF] Request starting HTTP/2 POST https://localhost:7036/api/Users/revoke-token application/json 105
2022-09-20 17:51:52.272 +01:00 [DBG] 1 candidate(s) found for the request path '/api/Users/revoke-token'
2022-09-20 17:51:52.274 +01:00 [DBG] Endpoint 'APIBank.Controllers.UsersController.RevokeToken (APIBank)' with route pattern 'api/Users/revoke-token' is valid for the request path '/api/Users/revoke-token'
2022-09-20 17:51:52.277 +01:00 [DBG] Request matched endpoint 'APIBank.Controllers.UsersController.RevokeToken (APIBank)'
2022-09-20 17:51:52.280 +01:00 [DBG] Static files was skipped as the request already matched an endpoint.
2022-09-20 17:51:52.357 +01:00 [INF] Entity Framework Core 6.0.9 initialized 'PostgresContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:6.0.7+5b98e4b74de93b590b44aef8dd7967c03acc433c' with options: None
2022-09-20 17:51:52.366 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-20 17:51:52.367 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2022-09-20 17:51:52.368 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-20 17:51:52.370 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-20 17:51:52.373 +01:00 [DBG] Executing DbCommand [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.id = @__p_0
LIMIT 1
2022-09-20 17:51:52.377 +01:00 [INF] Executed DbCommand (4ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.id = @__p_0
LIMIT 1
2022-09-20 17:51:52.379 +01:00 [DBG] Context 'PostgresContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-20 17:51:52.380 +01:00 [DBG] A data reader was disposed.
2022-09-20 17:51:52.381 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-20 17:51:52.382 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-20 17:51:52.383 +01:00 [INF] Executing endpoint 'APIBank.Controllers.UsersController.RevokeToken (APIBank)'
2022-09-20 17:51:52.385 +01:00 [INF] Route matched with {action = "RevokeToken", controller = "Users"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult RevokeToken(APIBank.Models.Users.Requests.RevokeTokenRequest) on controller APIBank.Controllers.UsersController (APIBank).
2022-09-20 17:51:52.388 +01:00 [DBG] Execution plan of authorization filters (in the following order): ["APIBank.Authorization.AuthorizeAttribute"]
2022-09-20 17:51:52.389 +01:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2022-09-20 17:51:52.390 +01:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2022-09-20 17:51:52.393 +01:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2022-09-20 17:51:52.394 +01:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2022-09-20 17:51:52.396 +01:00 [DBG] Executing controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-20 17:51:52.397 +01:00 [DBG] Executed controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-20 17:51:52.398 +01:00 [DBG] Attempting to bind parameter 'model' of type 'APIBank.Models.Users.Requests.RevokeTokenRequest' ...
2022-09-20 17:51:52.399 +01:00 [DBG] Attempting to bind parameter 'model' of type 'APIBank.Models.Users.Requests.RevokeTokenRequest' using the name '' in request data ...
2022-09-20 17:51:52.400 +01:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2022-09-20 17:51:52.403 +01:00 [DBG] Connection id "0HMKR51327QST", Request id "0HMKR51327QST:0000000D": started reading request body.
2022-09-20 17:51:52.404 +01:00 [DBG] Connection id "0HMKR51327QST", Request id "0HMKR51327QST:0000000D": done reading request body.
2022-09-20 17:51:52.405 +01:00 [DBG] JSON input formatter succeeded, deserializing to type 'APIBank.Models.Users.Requests.RevokeTokenRequest'
2022-09-20 17:51:52.407 +01:00 [DBG] Done attempting to bind parameter 'model' of type 'APIBank.Models.Users.Requests.RevokeTokenRequest'.
2022-09-20 17:51:52.408 +01:00 [DBG] Done attempting to bind parameter 'model' of type 'APIBank.Models.Users.Requests.RevokeTokenRequest'.
2022-09-20 17:51:52.409 +01:00 [DBG] Attempting to validate the bound parameter 'model' of type 'APIBank.Models.Users.Requests.RevokeTokenRequest' ...
2022-09-20 17:51:52.414 +01:00 [DBG] Done attempting to validate the bound parameter 'model' of type 'APIBank.Models.Users.Requests.RevokeTokenRequest'.
2022-09-20 17:51:52.417 +01:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .SingleOrDefault(userQuery => userQuery.RefreshTokenCollection
        .Any(refTokenQuery => refTokenQuery.RefToken == __refToken_0))'
2022-09-20 17:51:52.426 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<User>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: User.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: User.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 1], [Property: User.Email (string) Required Index MaxLength(254), 2], [Property: User.FullName (string) Required MaxLength(100), 3], [Property: User.PasswordChangedAt (DateTime) Required ValueGenerated.OnAdd, 4], [Property: User.PasswordHash (string) Required MaxLength(200), 5], [Property: User.Username (string) Required Index MaxLength(50), 6] }
        SELECT TOP(2) u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
        FROM users AS u
        WHERE EXISTS (
            SELECT 1
            FROM refresh_token AS r
            WHERE ((u.id != NULL) && (u.id == r.user_id)) && (r.token == @__refToken_0))), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, User>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)
    .SingleOrDefault()'
2022-09-20 17:51:52.429 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-20 17:51:52.429 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2022-09-20 17:51:52.430 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-20 17:51:52.432 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-20 17:51:52.433 +01:00 [DBG] Executing DbCommand [Parameters=[@__refToken_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE EXISTS (
    SELECT 1
    FROM refresh_token AS r
    WHERE (u.id = r.user_id) AND (r.token = @__refToken_0))
LIMIT 2
2022-09-20 17:51:52.435 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[@__refToken_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE EXISTS (
    SELECT 1
    FROM refresh_token AS r
    WHERE (u.id = r.user_id) AND (r.token = @__refToken_0))
LIMIT 2
2022-09-20 17:51:52.437 +01:00 [DBG] A data reader was disposed.
2022-09-20 17:51:52.437 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-20 17:51:52.438 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-20 18:00:44.080 +01:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2022-09-20 18:00:44.237 +01:00 [DBG] Hosting starting
2022-09-20 18:00:44.568 +01:00 [DBG] Using development certificate: CN=localhost (Thumbprint: 9CC642E9838495A6C3C202DECA6A8AD300396DD2)
2022-09-20 18:00:44.840 +01:00 [INF] Now listening on: https://localhost:7036
2022-09-20 18:00:44.899 +01:00 [DBG] Connection id "0HMKR56K7J23N" received FIN.
2022-09-20 18:00:44.886 +01:00 [DBG] Connection id "0HMKR56K7J23M" received FIN.
2022-09-20 18:00:45.069 +01:00 [INF] Now listening on: http://localhost:5036
2022-09-20 18:00:45.090 +01:00 [DBG] Connection id "0HMKR56K7J23N" accepted.
2022-09-20 18:00:45.314 +01:00 [DBG] Connection id "0HMKR56K7J23M" accepted.
2022-09-20 18:00:45.685 +01:00 [DBG] Loaded hosting startup assembly APIBank
2022-09-20 18:00:45.722 +01:00 [DBG] Connection id "0HMKR56K7J23M" started.
2022-09-20 18:00:45.691 +01:00 [DBG] Connection id "0HMKR56K7J23N" started.
2022-09-20 18:00:45.730 +01:00 [DBG] Connection id "0HMKR56K7J23O" accepted.
2022-09-20 18:00:45.740 +01:00 [DBG] Loaded hosting startup assembly Microsoft.AspNetCore.Watch.BrowserRefresh
2022-09-20 18:00:45.752 +01:00 [DBG] Connection id "0HMKR56K7J23O" started.
2022-09-20 18:00:45.771 +01:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.BrowserLink.Net
2022-09-20 18:00:45.775 +01:00 [INF] Application started. Press Ctrl+C to shut down.
2022-09-20 18:00:45.785 +01:00 [INF] Hosting environment: Development
2022-09-20 18:00:45.791 +01:00 [INF] Content root path: C:\Users\mguedesa\OneDrive - NTT DATA EMEAL\Documentos\GitHub\OpenBankAPI-NTT\APIBank\APIBank\
2022-09-20 18:00:45.798 +01:00 [DBG] Hosting started
2022-09-20 18:00:45.801 +01:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException:  Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveBlobAsync[TIOAdapter](TIOAdapter adapter)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](TIOAdapter adapter, Boolean receiveFirst, Byte[] reAuthenticationData, Boolean isApm)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2022-09-20 18:00:45.801 +01:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException:  Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveBlobAsync[TIOAdapter](TIOAdapter adapter)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](TIOAdapter adapter, Boolean receiveFirst, Byte[] reAuthenticationData, Boolean isApm)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2022-09-20 18:00:46.020 +01:00 [DBG] Connection id "0HMKR56K7J23M" stopped.
2022-09-20 18:00:46.020 +01:00 [DBG] Connection id "0HMKR56K7J23N" stopped.
2022-09-20 18:00:46.024 +01:00 [DBG] Connection id "0HMKR56K7J23N" sending FIN because: "The Socket transport's send loop completed gracefully."
2022-09-20 18:00:46.024 +01:00 [DBG] Connection id "0HMKR56K7J23M" sending FIN because: "The Socket transport's send loop completed gracefully."
2022-09-20 18:00:46.036 +01:00 [DBG] Connection 0HMKR56K7J23O established using the following protocol: "Tls12"
2022-09-20 18:00:46.182 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/swagger/index.html - -
2022-09-20 18:00:46.282 +01:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2022-09-20 18:00:46.357 +01:00 [DBG] No candidates found for the request path '/swagger/index.html'
2022-09-20 18:00:46.365 +01:00 [DBG] Request did not match any endpoints
2022-09-20 18:00:46.683 +01:00 [DBG] Response markup is scheduled to include browser refresh script injection.
2022-09-20 18:00:47.064 +01:00 [DBG] Response markup was updated to include browser refresh script injection.
2022-09-20 18:00:47.095 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/swagger/index.html - - - 200 - text/html;charset=utf-8 922.2053ms
2022-09-20 18:00:47.106 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/_framework/aspnetcore-browser-refresh.js - -
2022-09-20 18:00:47.117 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/_vs/browserLink - -
2022-09-20 18:00:47.123 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/_framework/aspnetcore-browser-refresh.js - - - 200 11984 application/javascript;+charset=utf-8 17.7038ms
2022-09-20 18:00:47.174 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/_vs/browserLink - - - 200 - text/javascript;+charset=UTF-8 57.4310ms
2022-09-20 18:00:47.316 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/swagger/v1/swagger.json - -
2022-09-20 18:00:47.318 +01:00 [DBG] No candidates found for the request path '/swagger/v1/swagger.json'
2022-09-20 18:00:47.319 +01:00 [DBG] Request did not match any endpoints
2022-09-20 18:00:47.590 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/swagger/v1/swagger.json - - - 200 - application/json;charset=utf-8 273.5117ms
2022-09-20 18:01:09.178 +01:00 [INF] Request starting HTTP/2 POST https://localhost:7036/api/Users/Login application/json 58
2022-09-20 18:01:09.198 +01:00 [DBG] 1 candidate(s) found for the request path '/api/Users/Login'
2022-09-20 18:01:09.208 +01:00 [DBG] Endpoint 'APIBank.Controllers.UsersController.Login (APIBank)' with route pattern 'api/Users/Login' is valid for the request path '/api/Users/Login'
2022-09-20 18:01:09.213 +01:00 [DBG] Request matched endpoint 'APIBank.Controllers.UsersController.Login (APIBank)'
2022-09-20 18:01:09.216 +01:00 [DBG] Static files was skipped as the request already matched an endpoint.
2022-09-20 18:01:09.765 +01:00 [INF] Executing endpoint 'APIBank.Controllers.UsersController.Login (APIBank)'
2022-09-20 18:01:09.811 +01:00 [INF] Route matched with {action = "Login", controller = "Users"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult Login(APIBank.Models.Requests.LoginRequest) on controller APIBank.Controllers.UsersController (APIBank).
2022-09-20 18:01:09.815 +01:00 [DBG] Execution plan of authorization filters (in the following order): ["APIBank.Authorization.AuthorizeAttribute"]
2022-09-20 18:01:09.817 +01:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2022-09-20 18:01:09.818 +01:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2022-09-20 18:01:09.820 +01:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2022-09-20 18:01:09.821 +01:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2022-09-20 18:01:09.827 +01:00 [DBG] Executing controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-20 18:01:09.829 +01:00 [DBG] Executed controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-20 18:01:09.854 +01:00 [DBG] Attempting to bind parameter 'model' of type 'APIBank.Models.Requests.LoginRequest' ...
2022-09-20 18:01:09.862 +01:00 [DBG] Attempting to bind parameter 'model' of type 'APIBank.Models.Requests.LoginRequest' using the name '' in request data ...
2022-09-20 18:01:09.864 +01:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2022-09-20 18:01:09.875 +01:00 [DBG] Connection id "0HMKR56K7J23O", Request id "0HMKR56K7J23O:00000009": started reading request body.
2022-09-20 18:01:09.877 +01:00 [DBG] Connection id "0HMKR56K7J23O", Request id "0HMKR56K7J23O:00000009": done reading request body.
2022-09-20 18:01:09.885 +01:00 [DBG] JSON input formatter succeeded, deserializing to type 'APIBank.Models.Requests.LoginRequest'
2022-09-20 18:01:09.887 +01:00 [DBG] Done attempting to bind parameter 'model' of type 'APIBank.Models.Requests.LoginRequest'.
2022-09-20 18:01:09.891 +01:00 [DBG] Done attempting to bind parameter 'model' of type 'APIBank.Models.Requests.LoginRequest'.
2022-09-20 18:01:09.893 +01:00 [DBG] Attempting to validate the bound parameter 'model' of type 'APIBank.Models.Requests.LoginRequest' ...
2022-09-20 18:01:09.908 +01:00 [DBG] Done attempting to validate the bound parameter 'model' of type 'APIBank.Models.Requests.LoginRequest'.
2022-09-20 18:01:10.085 +01:00 [DBG] An additional 'IServiceProvider' was created for internal use by Entity Framework. An existing service provider was not used due to the following configuration changes: configuration changed for 'Core:ConfigureWarnings', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:UseAdminDatabase', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:SetPostgresVersion', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:UseRedshift', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:ReverseNullOrdering', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:RemoteCertificateValidationCallback', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:ProvideClientCertificatesCallback', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:ProvidePasswordCallback'.
2022-09-20 18:01:11.973 +01:00 [INF] Entity Framework Core 6.0.9 initialized 'PostgresContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:6.0.7+5b98e4b74de93b590b44aef8dd7967c03acc433c' with options: None
2022-09-20 18:01:12.083 +01:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .SingleOrDefault(x => x.Username == __model_Username_0)'
2022-09-20 18:01:12.705 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<User>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: User.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: User.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 1], [Property: User.Email (string) Required Index MaxLength(254), 2], [Property: User.FullName (string) Required MaxLength(100), 3], [Property: User.PasswordChangedAt (DateTime) Required ValueGenerated.OnAdd, 4], [Property: User.PasswordHash (string) Required MaxLength(200), 5], [Property: User.Username (string) Required Index MaxLength(50), 6] }
        SELECT TOP(2) u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
        FROM users AS u
        WHERE u.username == @__model_Username_0), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, User>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)
    .SingleOrDefault()'
2022-09-20 18:01:12.788 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-20 18:01:12.926 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (125ms).
2022-09-20 18:01:12.941 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-20 18:01:13.329 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-20 18:01:13.359 +01:00 [DBG] Executing DbCommand [Parameters=[@__model_Username_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.username = @__model_Username_0
LIMIT 2
2022-09-20 18:01:13.542 +01:00 [INF] Executed DbCommand (192ms) [Parameters=[@__model_Username_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.username = @__model_Username_0
LIMIT 2
2022-09-20 18:01:13.628 +01:00 [DBG] Context 'PostgresContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-20 18:01:13.716 +01:00 [DBG] A data reader was disposed.
2022-09-20 18:01:13.726 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-20 18:01:13.740 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-20 18:01:14.291 +01:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .Any(user => user.RefreshTokenCollection
        .Any(reftoken => reftoken.RefToken == __token_0))'
2022-09-20 18:01:14.483 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<bool>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            EmptyProjectionMember -> 0
        SELECT EXISTS (
            SELECT 1
            FROM users AS u
            WHERE EXISTS (
                SELECT 1
                FROM refresh_token AS r
                WHERE ((u.id != NULL) && (u.id == r.user_id)) && (r.token == @__token_0)))), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, bool>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)
    .Single()'
2022-09-20 18:01:14.505 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-20 18:01:14.506 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2022-09-20 18:01:14.507 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-20 18:01:14.508 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-20 18:01:14.509 +01:00 [DBG] Executing DbCommand [Parameters=[@__token_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM users AS u
    WHERE EXISTS (
        SELECT 1
        FROM refresh_token AS r
        WHERE (u.id = r.user_id) AND (r.token = @__token_0)))
2022-09-20 18:01:14.512 +01:00 [INF] Executed DbCommand (3ms) [Parameters=[@__token_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM users AS u
    WHERE EXISTS (
        SELECT 1
        FROM refresh_token AS r
        WHERE (u.id = r.user_id) AND (r.token = @__token_0)))
2022-09-20 18:01:14.521 +01:00 [DBG] A data reader was disposed.
2022-09-20 18:01:14.522 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-20 18:01:14.524 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-20 18:01:14.569 +01:00 [DBG] An entity of type 'User' tracked by 'PostgresContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-20 18:01:14.576 +01:00 [DBG] SaveChanges starting for 'PostgresContext'.
2022-09-20 18:01:14.580 +01:00 [DBG] DetectChanges starting for 'PostgresContext'.
2022-09-20 18:01:14.624 +01:00 [DBG] 1 entities were added and 0 entities were removed from navigation 'User.RefreshTokenCollection'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-20 18:01:14.694 +01:00 [DBG] 'PostgresContext' generated a temporary value for the property 'Id.RefreshToken'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-20 18:01:14.791 +01:00 [DBG] Context 'PostgresContext' started tracking 'RefreshToken' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-20 18:01:14.799 +01:00 [DBG] DetectChanges completed for 'PostgresContext'.
2022-09-20 18:01:14.828 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-20 18:01:14.829 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-20 18:01:14.838 +01:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2022-09-20 18:01:14.855 +01:00 [DBG] Began transaction with isolation level 'ReadCommitted'.
2022-09-20 18:01:14.954 +01:00 [DBG] Executing 2 update commands as a batch.
2022-09-20 18:01:15.001 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-20 18:01:15.005 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (4ms).
2022-09-20 18:01:15.007 +01:00 [DBG] Executing DbCommand [Parameters=[@p0='?' (DbType = DateTime), @p1='?', @p2='?' (DbType = DateTime), @p3='?' (DbType = Boolean), @p4='?' (DbType = Boolean), @p5='?' (DbType = Boolean), @p6='?', @p7='?', @p8='?', @p9='?' (DbType = DateTime), @p10='?', @p11='?' (DbType = Int32), @p18='?' (DbType = Int32), @p12='?' (DbType = DateTime), @p13='?', @p14='?', @p15='?' (DbType = DateTime), @p16='?', @p17='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO refresh_token (created, created_by_ip, expires, is_active, is_expired, is_revoked, reason_revoked, token, replaced_by_token, revoked, revoked_by_ip, user_id)
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11)
RETURNING id;
UPDATE users SET created_at = @p12, email = @p13, full_name = @p14, password_changed_at = @p15, password_hash = @p16, username = @p17
WHERE id = @p18;
2022-09-20 18:01:15.045 +01:00 [INF] Executed DbCommand (38ms) [Parameters=[@p0='?' (DbType = DateTime), @p1='?', @p2='?' (DbType = DateTime), @p3='?' (DbType = Boolean), @p4='?' (DbType = Boolean), @p5='?' (DbType = Boolean), @p6='?', @p7='?', @p8='?', @p9='?' (DbType = DateTime), @p10='?', @p11='?' (DbType = Int32), @p18='?' (DbType = Int32), @p12='?' (DbType = DateTime), @p13='?', @p14='?', @p15='?' (DbType = DateTime), @p16='?', @p17='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO refresh_token (created, created_by_ip, expires, is_active, is_expired, is_revoked, reason_revoked, token, replaced_by_token, revoked, revoked_by_ip, user_id)
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11)
RETURNING id;
UPDATE users SET created_at = @p12, email = @p13, full_name = @p14, password_changed_at = @p15, password_hash = @p16, username = @p17
WHERE id = @p18;
2022-09-20 18:01:15.080 +01:00 [DBG] The foreign key property 'RefreshToken.Id' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2022-09-20 18:01:15.093 +01:00 [DBG] A data reader was disposed.
2022-09-20 18:01:15.098 +01:00 [DBG] Committing transaction.
2022-09-20 18:01:15.110 +01:00 [DBG] Committed transaction.
2022-09-20 18:01:15.112 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-20 18:01:15.114 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-20 18:01:15.119 +01:00 [DBG] Disposing transaction.
2022-09-20 18:01:15.124 +01:00 [DBG] An entity of type 'RefreshToken' tracked by 'PostgresContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-20 18:01:15.127 +01:00 [DBG] An entity of type 'User' tracked by 'PostgresContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-20 18:01:15.130 +01:00 [DBG] SaveChanges completed for 'PostgresContext' with 2 entities written to the database.
2022-09-20 18:01:15.140 +01:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2022-09-20 18:01:15.147 +01:00 [DBG] Attempting to select an output formatter based on Accept header '["text/plain"]'.
2022-09-20 18:01:15.149 +01:00 [DBG] Could not find an output formatter based on content negotiation. Accepted types were (["text/plain"])
2022-09-20 18:01:15.150 +01:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2022-09-20 18:01:15.152 +01:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2022-09-20 18:01:15.154 +01:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2022-09-20 18:01:15.155 +01:00 [INF] Executing OkObjectResult, writing value of type 'APIBank.Models.Users.Responses.LoginResponse'.
2022-09-20 18:01:15.180 +01:00 [INF] Executed action APIBank.Controllers.UsersController.Login (APIBank) in 5346.9806ms
2022-09-20 18:01:15.183 +01:00 [INF] Executed endpoint 'APIBank.Controllers.UsersController.Login (APIBank)'
2022-09-20 18:01:15.195 +01:00 [DBG] 'PostgresContext' disposed.
2022-09-20 18:01:15.207 +01:00 [INF] Request finished HTTP/2 POST https://localhost:7036/api/Users/Login application/json 58 - 200 - application/json;+charset=utf-8 6029.0001ms
2022-09-20 18:01:32.490 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/api/Users/1/refresh-tokens - -
2022-09-20 18:01:32.496 +01:00 [DBG] 1 candidate(s) found for the request path '/api/Users/1/refresh-tokens'
2022-09-20 18:01:32.499 +01:00 [DBG] Endpoint 'APIBank.Controllers.UsersController.GetRefreshTokens (APIBank)' with route pattern 'api/Users/{id}/refresh-tokens' is valid for the request path '/api/Users/1/refresh-tokens'
2022-09-20 18:01:32.507 +01:00 [DBG] Request matched endpoint 'APIBank.Controllers.UsersController.GetRefreshTokens (APIBank)'
2022-09-20 18:01:32.510 +01:00 [DBG] Static files was skipped as the request already matched an endpoint.
2022-09-20 18:01:32.666 +01:00 [INF] Entity Framework Core 6.0.9 initialized 'PostgresContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:6.0.7+5b98e4b74de93b590b44aef8dd7967c03acc433c' with options: None
2022-09-20 18:01:32.687 +01:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .FirstOrDefault(e => EF.Property<int>(e, "Id") == __p_0)'
2022-09-20 18:01:32.696 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<User>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: User.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: User.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 1], [Property: User.Email (string) Required Index MaxLength(254), 2], [Property: User.FullName (string) Required MaxLength(100), 3], [Property: User.PasswordChangedAt (DateTime) Required ValueGenerated.OnAdd, 4], [Property: User.PasswordHash (string) Required MaxLength(200), 5], [Property: User.Username (string) Required Index MaxLength(50), 6] }
        SELECT TOP(1) u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
        FROM users AS u
        WHERE u.id == @__p_0), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, User>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)
    .SingleOrDefault()'
2022-09-20 18:01:32.700 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-20 18:01:32.703 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (2ms).
2022-09-20 18:01:32.708 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-20 18:01:32.710 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-20 18:01:32.711 +01:00 [DBG] Executing DbCommand [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.id = @__p_0
LIMIT 1
2022-09-20 18:01:32.715 +01:00 [INF] Executed DbCommand (3ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.id = @__p_0
LIMIT 1
2022-09-20 18:01:32.717 +01:00 [DBG] Context 'PostgresContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-20 18:01:32.720 +01:00 [DBG] A data reader was disposed.
2022-09-20 18:01:32.723 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-20 18:01:32.724 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-20 18:01:32.726 +01:00 [INF] Executing endpoint 'APIBank.Controllers.UsersController.GetRefreshTokens (APIBank)'
2022-09-20 18:01:32.730 +01:00 [INF] Route matched with {action = "GetRefreshTokens", controller = "Users"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult GetRefreshTokens(Int32) on controller APIBank.Controllers.UsersController (APIBank).
2022-09-20 18:01:32.732 +01:00 [DBG] Execution plan of authorization filters (in the following order): ["APIBank.Authorization.AuthorizeAttribute"]
2022-09-20 18:01:32.733 +01:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2022-09-20 18:01:32.734 +01:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2022-09-20 18:01:32.741 +01:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2022-09-20 18:01:32.742 +01:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2022-09-20 18:01:32.744 +01:00 [DBG] Executing controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-20 18:01:32.745 +01:00 [DBG] Executed controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-20 18:01:32.746 +01:00 [DBG] Attempting to bind parameter 'id' of type 'System.Int32' ...
2022-09-20 18:01:32.748 +01:00 [DBG] Attempting to bind parameter 'id' of type 'System.Int32' using the name 'id' in request data ...
2022-09-20 18:01:32.751 +01:00 [DBG] Done attempting to bind parameter 'id' of type 'System.Int32'.
2022-09-20 18:01:32.756 +01:00 [DBG] Done attempting to bind parameter 'id' of type 'System.Int32'.
2022-09-20 18:01:32.757 +01:00 [DBG] Attempting to validate the bound parameter 'id' of type 'System.Int32' ...
2022-09-20 18:01:32.759 +01:00 [DBG] Done attempting to validate the bound parameter 'id' of type 'System.Int32'.
2022-09-20 18:01:32.772 +01:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2022-09-20 18:01:32.775 +01:00 [DBG] No information found on request to perform content negotiation.
2022-09-20 18:01:32.776 +01:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2022-09-20 18:01:32.777 +01:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2022-09-20 18:01:32.777 +01:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2022-09-20 18:01:32.779 +01:00 [INF] Executing OkObjectResult, writing value of type 'Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryable`1[[APIBank.ModelEntities.RefreshToken, APIBank, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2022-09-20 18:01:32.796 +01:00 [DBG] Compiling query expression: 
'DbSet<RefreshToken>()
    .Where(rt => rt.UserId == __id_0)
    .AsNoTracking()
    .Select(rt => new RefreshToken{ 
        Id = rt.Id, 
        UserId = rt.UserId, 
        RefToken = rt.RefToken, 
        Expires = rt.Expires, 
        Created = rt.Created, 
        CreatedByIp = rt.CreatedByIp, 
        Revoked = rt.Revoked, 
        RevokedByIp = rt.RevokedByIp, 
        ReplacedByToken = rt.ReplacedByToken, 
        ReasonRevoked = rt.ReasonRevoked, 
        IsExpired = rt.IsExpired, 
        IsRevoked = rt.IsRevoked, 
        IsActive = rt.IsActive 
    }
    )'
2022-09-20 18:01:32.836 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<RefreshToken>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            Id -> 0
            UserId -> 1
            RefToken -> 2
            Expires -> 3
            Created -> 4
            CreatedByIp -> 5
            Revoked -> 6
            RevokedByIp -> 7
            ReplacedByToken -> 8
            ReasonRevoked -> 9
            IsExpired -> 10
            IsRevoked -> 11
            IsActive -> 12
        SELECT r.id AS Id, r.user_id AS UserId, r.token AS RefToken, r.expires AS Expires, r.created AS Created, r.created_by_ip AS CreatedByIp, r.revoked AS Revoked, r.revoked_by_ip AS RevokedByIp, r.replaced_by_token AS ReplacedByToken, r.reason_revoked AS ReasonRevoked, r.is_expired AS IsExpired, r.is_revoked AS IsRevoked, r.is_active AS IsActive
        FROM refresh_token AS r
        WHERE r.user_id == @__id_0), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, RefreshToken>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)'
2022-09-20 18:01:32.871 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-20 18:01:32.873 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2022-09-20 18:01:32.884 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-20 18:01:32.889 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-20 18:01:32.892 +01:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.user_id AS "UserId", r.token AS "RefToken", r.expires AS "Expires", r.created AS "Created", r.created_by_ip AS "CreatedByIp", r.revoked AS "Revoked", r.revoked_by_ip AS "RevokedByIp", r.replaced_by_token AS "ReplacedByToken", r.reason_revoked AS "ReasonRevoked", r.is_expired AS "IsExpired", r.is_revoked AS "IsRevoked", r.is_active AS "IsActive"
FROM refresh_token AS r
WHERE r.user_id = @__id_0
2022-09-20 18:01:32.898 +01:00 [INF] Executed DbCommand (6ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.user_id AS "UserId", r.token AS "RefToken", r.expires AS "Expires", r.created AS "Created", r.created_by_ip AS "CreatedByIp", r.revoked AS "Revoked", r.revoked_by_ip AS "RevokedByIp", r.replaced_by_token AS "ReplacedByToken", r.reason_revoked AS "ReasonRevoked", r.is_expired AS "IsExpired", r.is_revoked AS "IsRevoked", r.is_active AS "IsActive"
FROM refresh_token AS r
WHERE r.user_id = @__id_0
2022-09-20 18:01:32.928 +01:00 [DBG] A data reader was disposed.
2022-09-20 18:01:32.946 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-20 18:01:32.948 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-20 18:01:32.950 +01:00 [INF] Executed action APIBank.Controllers.UsersController.GetRefreshTokens (APIBank) in 206.4763ms
2022-09-20 18:01:32.955 +01:00 [INF] Executed endpoint 'APIBank.Controllers.UsersController.GetRefreshTokens (APIBank)'
2022-09-20 18:01:32.956 +01:00 [DBG] 'PostgresContext' disposed.
2022-09-20 18:01:32.958 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/api/Users/1/refresh-tokens - - - 200 - application/json;+charset=utf-8 467.5214ms
2022-09-20 18:01:54.607 +01:00 [INF] Request starting HTTP/2 POST https://localhost:7036/api/Users/revoke-token application/json 105
2022-09-20 18:01:54.610 +01:00 [DBG] 1 candidate(s) found for the request path '/api/Users/revoke-token'
2022-09-20 18:01:54.612 +01:00 [DBG] Endpoint 'APIBank.Controllers.UsersController.RevokeToken (APIBank)' with route pattern 'api/Users/revoke-token' is valid for the request path '/api/Users/revoke-token'
2022-09-20 18:01:54.616 +01:00 [DBG] Request matched endpoint 'APIBank.Controllers.UsersController.RevokeToken (APIBank)'
2022-09-20 18:01:54.620 +01:00 [DBG] Static files was skipped as the request already matched an endpoint.
2022-09-20 18:01:54.684 +01:00 [INF] Entity Framework Core 6.0.9 initialized 'PostgresContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:6.0.7+5b98e4b74de93b590b44aef8dd7967c03acc433c' with options: None
2022-09-20 18:01:54.694 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-20 18:01:54.696 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (2ms).
2022-09-20 18:01:54.697 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-20 18:01:54.699 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-20 18:01:54.701 +01:00 [DBG] Executing DbCommand [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.id = @__p_0
LIMIT 1
2022-09-20 18:01:54.706 +01:00 [INF] Executed DbCommand (4ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.id = @__p_0
LIMIT 1
2022-09-20 18:01:54.707 +01:00 [DBG] Context 'PostgresContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-20 18:01:54.708 +01:00 [DBG] A data reader was disposed.
2022-09-20 18:01:54.709 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-20 18:01:54.710 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-20 18:01:54.710 +01:00 [INF] Executing endpoint 'APIBank.Controllers.UsersController.RevokeToken (APIBank)'
2022-09-20 18:01:54.712 +01:00 [INF] Route matched with {action = "RevokeToken", controller = "Users"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult RevokeToken(APIBank.Models.Users.Requests.RevokeTokenRequest) on controller APIBank.Controllers.UsersController (APIBank).
2022-09-20 18:01:54.714 +01:00 [DBG] Execution plan of authorization filters (in the following order): ["APIBank.Authorization.AuthorizeAttribute"]
2022-09-20 18:01:54.717 +01:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2022-09-20 18:01:54.719 +01:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2022-09-20 18:01:54.723 +01:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2022-09-20 18:01:54.724 +01:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2022-09-20 18:01:54.726 +01:00 [DBG] Executing controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-20 18:01:54.727 +01:00 [DBG] Executed controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-20 18:01:54.728 +01:00 [DBG] Attempting to bind parameter 'model' of type 'APIBank.Models.Users.Requests.RevokeTokenRequest' ...
2022-09-20 18:01:54.730 +01:00 [DBG] Attempting to bind parameter 'model' of type 'APIBank.Models.Users.Requests.RevokeTokenRequest' using the name '' in request data ...
2022-09-20 18:01:54.732 +01:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2022-09-20 18:01:54.738 +01:00 [DBG] Connection id "0HMKR56K7J23O", Request id "0HMKR56K7J23O:0000000D": started reading request body.
2022-09-20 18:01:54.740 +01:00 [DBG] Connection id "0HMKR56K7J23O", Request id "0HMKR56K7J23O:0000000D": done reading request body.
2022-09-20 18:01:54.742 +01:00 [DBG] JSON input formatter succeeded, deserializing to type 'APIBank.Models.Users.Requests.RevokeTokenRequest'
2022-09-20 18:01:54.743 +01:00 [DBG] Done attempting to bind parameter 'model' of type 'APIBank.Models.Users.Requests.RevokeTokenRequest'.
2022-09-20 18:01:54.745 +01:00 [DBG] Done attempting to bind parameter 'model' of type 'APIBank.Models.Users.Requests.RevokeTokenRequest'.
2022-09-20 18:01:54.746 +01:00 [DBG] Attempting to validate the bound parameter 'model' of type 'APIBank.Models.Users.Requests.RevokeTokenRequest' ...
2022-09-20 18:01:54.749 +01:00 [DBG] Done attempting to validate the bound parameter 'model' of type 'APIBank.Models.Users.Requests.RevokeTokenRequest'.
2022-09-20 18:01:54.755 +01:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .SingleOrDefault(userQuery => userQuery.RefreshTokenCollection
        .Any(refTokenQuery => refTokenQuery.RefToken == __refToken_0))'
2022-09-20 18:01:54.762 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<User>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: User.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: User.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 1], [Property: User.Email (string) Required Index MaxLength(254), 2], [Property: User.FullName (string) Required MaxLength(100), 3], [Property: User.PasswordChangedAt (DateTime) Required ValueGenerated.OnAdd, 4], [Property: User.PasswordHash (string) Required MaxLength(200), 5], [Property: User.Username (string) Required Index MaxLength(50), 6] }
        SELECT TOP(2) u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
        FROM users AS u
        WHERE EXISTS (
            SELECT 1
            FROM refresh_token AS r
            WHERE ((u.id != NULL) && (u.id == r.user_id)) && (r.token == @__refToken_0))), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, User>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)
    .SingleOrDefault()'
2022-09-20 18:01:54.764 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-20 18:01:54.765 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2022-09-20 18:01:54.770 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-20 18:01:54.771 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-20 18:01:54.772 +01:00 [DBG] Executing DbCommand [Parameters=[@__refToken_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE EXISTS (
    SELECT 1
    FROM refresh_token AS r
    WHERE (u.id = r.user_id) AND (r.token = @__refToken_0))
LIMIT 2
2022-09-20 18:01:54.776 +01:00 [INF] Executed DbCommand (4ms) [Parameters=[@__refToken_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE EXISTS (
    SELECT 1
    FROM refresh_token AS r
    WHERE (u.id = r.user_id) AND (r.token = @__refToken_0))
LIMIT 2
2022-09-20 18:01:54.779 +01:00 [DBG] A data reader was disposed.
2022-09-20 18:01:54.779 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-20 18:01:54.780 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-20 18:01:54.782 +01:00 [DBG] Compiling query expression: 
'DbSet<RefreshToken>()
    .Where(rt => rt.UserId == __id_0)
    .AsNoTracking()
    .Select(rt => new RefreshToken{ 
        Id = rt.Id, 
        UserId = rt.UserId, 
        RefToken = rt.RefToken, 
        Expires = rt.Expires, 
        Created = rt.Created, 
        CreatedByIp = rt.CreatedByIp, 
        Revoked = rt.Revoked, 
        RevokedByIp = rt.RevokedByIp, 
        ReplacedByToken = rt.ReplacedByToken, 
        ReasonRevoked = rt.ReasonRevoked, 
        IsExpired = rt.IsExpired, 
        IsRevoked = rt.IsRevoked, 
        IsActive = rt.IsActive 
    }
    )
    .Single(refTokenQuerii => refTokenQuerii.RefToken == __refToken_1)'
2022-09-20 18:01:54.790 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<RefreshToken>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            Id -> 0
            UserId -> 1
            RefToken -> 2
            Expires -> 3
            Created -> 4
            CreatedByIp -> 5
            Revoked -> 6
            RevokedByIp -> 7
            ReplacedByToken -> 8
            ReasonRevoked -> 9
            IsExpired -> 10
            IsRevoked -> 11
            IsActive -> 12
        SELECT TOP(2) r.id AS Id, r.user_id AS UserId, r.token AS RefToken, r.expires AS Expires, r.created AS Created, r.created_by_ip AS CreatedByIp, r.revoked AS Revoked, r.revoked_by_ip AS RevokedByIp, r.replaced_by_token AS ReplacedByToken, r.reason_revoked AS ReasonRevoked, r.is_expired AS IsExpired, r.is_revoked AS IsRevoked, r.is_active AS IsActive
        FROM refresh_token AS r
        WHERE (r.user_id == @__id_0) && (r.token == @__refToken_1)), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, RefreshToken>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)
    .Single()'
2022-09-20 18:01:54.794 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-20 18:01:54.794 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2022-09-20 18:01:54.795 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-20 18:01:54.796 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-20 18:01:54.797 +01:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Int32), @__refToken_1='?'], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.user_id AS "UserId", r.token AS "RefToken", r.expires AS "Expires", r.created AS "Created", r.created_by_ip AS "CreatedByIp", r.revoked AS "Revoked", r.revoked_by_ip AS "RevokedByIp", r.replaced_by_token AS "ReplacedByToken", r.reason_revoked AS "ReasonRevoked", r.is_expired AS "IsExpired", r.is_revoked AS "IsRevoked", r.is_active AS "IsActive"
FROM refresh_token AS r
WHERE (r.user_id = @__id_0) AND (r.token = @__refToken_1)
LIMIT 2
2022-09-20 18:01:54.802 +01:00 [INF] Executed DbCommand (5ms) [Parameters=[@__id_0='?' (DbType = Int32), @__refToken_1='?'], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.user_id AS "UserId", r.token AS "RefToken", r.expires AS "Expires", r.created AS "Created", r.created_by_ip AS "CreatedByIp", r.revoked AS "Revoked", r.revoked_by_ip AS "RevokedByIp", r.replaced_by_token AS "ReplacedByToken", r.reason_revoked AS "ReasonRevoked", r.is_expired AS "IsExpired", r.is_revoked AS "IsRevoked", r.is_active AS "IsActive"
FROM refresh_token AS r
WHERE (r.user_id = @__id_0) AND (r.token = @__refToken_1)
LIMIT 2
2022-09-20 18:01:54.805 +01:00 [DBG] A data reader was disposed.
2022-09-20 18:01:54.807 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-20 18:01:54.808 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-20 18:01:54.809 +01:00 [DBG] An entity of type 'User' tracked by 'PostgresContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-20 18:01:54.811 +01:00 [DBG] SaveChanges starting for 'PostgresContext'.
2022-09-20 18:01:54.811 +01:00 [DBG] DetectChanges starting for 'PostgresContext'.
2022-09-20 18:01:54.812 +01:00 [DBG] DetectChanges completed for 'PostgresContext'.
2022-09-20 18:01:54.813 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-20 18:01:54.815 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-20 18:01:54.816 +01:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2022-09-20 18:01:54.817 +01:00 [DBG] Began transaction with isolation level 'ReadCommitted'.
2022-09-20 18:01:54.819 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-20 18:01:54.820 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2022-09-20 18:01:54.822 +01:00 [DBG] Executing DbCommand [Parameters=[@p6='?' (DbType = Int32), @p0='?' (DbType = DateTime), @p1='?', @p2='?', @p3='?' (DbType = DateTime), @p4='?', @p5='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE users SET created_at = @p0, email = @p1, full_name = @p2, password_changed_at = @p3, password_hash = @p4, username = @p5
WHERE id = @p6;
2022-09-20 18:01:54.825 +01:00 [INF] Executed DbCommand (3ms) [Parameters=[@p6='?' (DbType = Int32), @p0='?' (DbType = DateTime), @p1='?', @p2='?', @p3='?' (DbType = DateTime), @p4='?', @p5='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE users SET created_at = @p0, email = @p1, full_name = @p2, password_changed_at = @p3, password_hash = @p4, username = @p5
WHERE id = @p6;
2022-09-20 18:01:54.826 +01:00 [DBG] A data reader was disposed.
2022-09-20 18:01:54.827 +01:00 [DBG] Committing transaction.
2022-09-20 18:01:54.828 +01:00 [DBG] Committed transaction.
2022-09-20 18:01:54.828 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-20 18:01:54.831 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-20 18:01:54.832 +01:00 [DBG] Disposing transaction.
2022-09-20 18:01:54.834 +01:00 [DBG] An entity of type 'User' tracked by 'PostgresContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-20 18:01:54.836 +01:00 [DBG] SaveChanges completed for 'PostgresContext' with 1 entities written to the database.
2022-09-20 18:01:54.837 +01:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2022-09-20 18:01:54.840 +01:00 [DBG] No information found on request to perform content negotiation.
2022-09-20 18:01:54.841 +01:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2022-09-20 18:01:54.842 +01:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2022-09-20 18:01:54.843 +01:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2022-09-20 18:01:54.845 +01:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType0`1[[System.String, System.Private.CoreLib, Version=6.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2022-09-20 18:01:54.847 +01:00 [INF] Executed action APIBank.Controllers.UsersController.RevokeToken (APIBank) in 121.9737ms
2022-09-20 18:01:54.849 +01:00 [INF] Executed endpoint 'APIBank.Controllers.UsersController.RevokeToken (APIBank)'
2022-09-20 18:01:54.851 +01:00 [DBG] 'PostgresContext' disposed.
2022-09-20 18:01:54.857 +01:00 [INF] Request finished HTTP/2 POST https://localhost:7036/api/Users/revoke-token application/json 105 - 200 - application/json;+charset=utf-8 250.7626ms
2022-09-20 18:02:00.255 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/api/Users/1/refresh-tokens - -
2022-09-20 18:02:00.260 +01:00 [DBG] 1 candidate(s) found for the request path '/api/Users/1/refresh-tokens'
2022-09-20 18:02:00.264 +01:00 [DBG] Endpoint 'APIBank.Controllers.UsersController.GetRefreshTokens (APIBank)' with route pattern 'api/Users/{id}/refresh-tokens' is valid for the request path '/api/Users/1/refresh-tokens'
2022-09-20 18:02:00.267 +01:00 [DBG] Request matched endpoint 'APIBank.Controllers.UsersController.GetRefreshTokens (APIBank)'
2022-09-20 18:02:00.269 +01:00 [DBG] Static files was skipped as the request already matched an endpoint.
2022-09-20 18:02:00.276 +01:00 [INF] Entity Framework Core 6.0.9 initialized 'PostgresContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:6.0.7+5b98e4b74de93b590b44aef8dd7967c03acc433c' with options: None
2022-09-20 18:02:00.282 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-20 18:02:00.284 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2022-09-20 18:02:00.286 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-20 18:02:00.288 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-20 18:02:00.292 +01:00 [DBG] Executing DbCommand [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.id = @__p_0
LIMIT 1
2022-09-20 18:02:00.300 +01:00 [INF] Executed DbCommand (8ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.id = @__p_0
LIMIT 1
2022-09-20 18:02:00.303 +01:00 [DBG] Context 'PostgresContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-20 18:02:00.306 +01:00 [DBG] A data reader was disposed.
2022-09-20 18:02:00.307 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-20 18:02:00.308 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-20 18:02:00.309 +01:00 [INF] Executing endpoint 'APIBank.Controllers.UsersController.GetRefreshTokens (APIBank)'
2022-09-20 18:02:00.314 +01:00 [INF] Route matched with {action = "GetRefreshTokens", controller = "Users"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult GetRefreshTokens(Int32) on controller APIBank.Controllers.UsersController (APIBank).
2022-09-20 18:02:00.317 +01:00 [DBG] Execution plan of authorization filters (in the following order): ["APIBank.Authorization.AuthorizeAttribute"]
2022-09-20 18:02:00.321 +01:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2022-09-20 18:02:00.322 +01:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2022-09-20 18:02:00.325 +01:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2022-09-20 18:02:00.326 +01:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2022-09-20 18:02:00.327 +01:00 [DBG] Executing controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-20 18:02:00.329 +01:00 [DBG] Executed controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-20 18:02:00.331 +01:00 [DBG] Attempting to bind parameter 'id' of type 'System.Int32' ...
2022-09-20 18:02:00.334 +01:00 [DBG] Attempting to bind parameter 'id' of type 'System.Int32' using the name 'id' in request data ...
2022-09-20 18:02:00.336 +01:00 [DBG] Done attempting to bind parameter 'id' of type 'System.Int32'.
2022-09-20 18:02:00.337 +01:00 [DBG] Done attempting to bind parameter 'id' of type 'System.Int32'.
2022-09-20 18:02:00.338 +01:00 [DBG] Attempting to validate the bound parameter 'id' of type 'System.Int32' ...
2022-09-20 18:02:00.339 +01:00 [DBG] Done attempting to validate the bound parameter 'id' of type 'System.Int32'.
2022-09-20 18:02:00.341 +01:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2022-09-20 18:02:00.343 +01:00 [DBG] No information found on request to perform content negotiation.
2022-09-20 18:02:00.345 +01:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2022-09-20 18:02:00.346 +01:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2022-09-20 18:02:00.347 +01:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2022-09-20 18:02:00.349 +01:00 [INF] Executing OkObjectResult, writing value of type 'Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryable`1[[APIBank.ModelEntities.RefreshToken, APIBank, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2022-09-20 18:02:00.354 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-20 18:02:00.355 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2022-09-20 18:02:00.356 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-20 18:02:00.357 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-20 18:02:00.358 +01:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.user_id AS "UserId", r.token AS "RefToken", r.expires AS "Expires", r.created AS "Created", r.created_by_ip AS "CreatedByIp", r.revoked AS "Revoked", r.revoked_by_ip AS "RevokedByIp", r.replaced_by_token AS "ReplacedByToken", r.reason_revoked AS "ReasonRevoked", r.is_expired AS "IsExpired", r.is_revoked AS "IsRevoked", r.is_active AS "IsActive"
FROM refresh_token AS r
WHERE r.user_id = @__id_0
2022-09-20 18:02:00.373 +01:00 [INF] Executed DbCommand (15ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.user_id AS "UserId", r.token AS "RefToken", r.expires AS "Expires", r.created AS "Created", r.created_by_ip AS "CreatedByIp", r.revoked AS "Revoked", r.revoked_by_ip AS "RevokedByIp", r.replaced_by_token AS "ReplacedByToken", r.reason_revoked AS "ReasonRevoked", r.is_expired AS "IsExpired", r.is_revoked AS "IsRevoked", r.is_active AS "IsActive"
FROM refresh_token AS r
WHERE r.user_id = @__id_0
2022-09-20 18:02:00.385 +01:00 [DBG] A data reader was disposed.
2022-09-20 18:02:00.386 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-20 18:02:00.392 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-20 18:02:00.403 +01:00 [INF] Executed action APIBank.Controllers.UsersController.GetRefreshTokens (APIBank) in 76.5032ms
2022-09-20 18:02:00.406 +01:00 [INF] Executed endpoint 'APIBank.Controllers.UsersController.GetRefreshTokens (APIBank)'
2022-09-20 18:02:00.413 +01:00 [DBG] 'PostgresContext' disposed.
2022-09-20 18:02:00.416 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/api/Users/1/refresh-tokens - - - 200 - application/json;+charset=utf-8 160.2407ms
2022-09-20 18:10:32.584 +01:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2022-09-20 18:10:32.710 +01:00 [DBG] Hosting starting
2022-09-20 18:10:32.878 +01:00 [DBG] Using development certificate: CN=localhost (Thumbprint: 9CC642E9838495A6C3C202DECA6A8AD300396DD2)
2022-09-20 18:10:32.948 +01:00 [INF] Now listening on: https://localhost:7036
2022-09-20 18:10:32.951 +01:00 [INF] Now listening on: http://localhost:5036
2022-09-20 18:10:32.952 +01:00 [DBG] Loaded hosting startup assembly APIBank
2022-09-20 18:10:32.954 +01:00 [DBG] Loaded hosting startup assembly Microsoft.AspNetCore.Watch.BrowserRefresh
2022-09-20 18:10:32.955 +01:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.BrowserLink.Net
2022-09-20 18:10:32.956 +01:00 [INF] Application started. Press Ctrl+C to shut down.
2022-09-20 18:10:32.957 +01:00 [INF] Hosting environment: Development
2022-09-20 18:10:32.958 +01:00 [INF] Content root path: C:\Users\mguedesa\OneDrive - NTT DATA EMEAL\Documentos\GitHub\OpenBankAPI-NTT\APIBank\APIBank\
2022-09-20 18:10:32.959 +01:00 [DBG] Hosting started
2022-09-20 18:10:33.376 +01:00 [DBG] Connection id "0HMKR5C3JSGT6" received FIN.
2022-09-20 18:10:33.387 +01:00 [DBG] Connection id "0HMKR5C3JSGT6" accepted.
2022-09-20 18:10:33.389 +01:00 [DBG] Connection id "0HMKR5C3JSGT6" started.
2022-09-20 18:10:33.417 +01:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException:  Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveBlobAsync[TIOAdapter](TIOAdapter adapter)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](TIOAdapter adapter, Boolean receiveFirst, Byte[] reAuthenticationData, Boolean isApm)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2022-09-20 18:10:33.474 +01:00 [DBG] Connection id "0HMKR5C3JSGT6" stopped.
2022-09-20 18:10:33.483 +01:00 [DBG] Connection id "0HMKR5C3JSGT6" sending FIN because: "The Socket transport's send loop completed gracefully."
2022-09-20 18:10:33.533 +01:00 [DBG] Connection id "0HMKR5C3JSGT7" accepted.
2022-09-20 18:10:33.534 +01:00 [DBG] Connection id "0HMKR5C3JSGT7" started.
2022-09-20 18:10:33.584 +01:00 [DBG] Connection 0HMKR5C3JSGT7 established using the following protocol: "Tls12"
2022-09-20 18:10:33.703 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/swagger/index.html - -
2022-09-20 18:10:33.750 +01:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2022-09-20 18:10:33.775 +01:00 [DBG] No candidates found for the request path '/swagger/index.html'
2022-09-20 18:10:33.776 +01:00 [DBG] Request did not match any endpoints
2022-09-20 18:10:33.884 +01:00 [DBG] Response markup is scheduled to include browser refresh script injection.
2022-09-20 18:10:34.033 +01:00 [DBG] Response markup was updated to include browser refresh script injection.
2022-09-20 18:10:34.048 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/swagger/index.html - - - 200 - text/html;charset=utf-8 351.3408ms
2022-09-20 18:10:34.081 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/_vs/browserLink - -
2022-09-20 18:10:34.081 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/_framework/aspnetcore-browser-refresh.js - -
2022-09-20 18:10:34.107 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/_framework/aspnetcore-browser-refresh.js - - - 200 11984 application/javascript;+charset=utf-8 25.4003ms
2022-09-20 18:10:34.140 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/_vs/browserLink - - - 200 - text/javascript;+charset=UTF-8 59.4529ms
2022-09-20 18:10:34.203 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/swagger/v1/swagger.json - -
2022-09-20 18:10:34.205 +01:00 [DBG] No candidates found for the request path '/swagger/v1/swagger.json'
2022-09-20 18:10:34.205 +01:00 [DBG] Request did not match any endpoints
2022-09-20 18:10:34.406 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/swagger/v1/swagger.json - - - 200 - application/json;charset=utf-8 203.4610ms
2022-09-20 18:10:46.854 +01:00 [INF] Request starting HTTP/2 POST https://localhost:7036/api/Users/Login application/json 58
2022-09-20 18:10:46.875 +01:00 [DBG] 1 candidate(s) found for the request path '/api/Users/Login'
2022-09-20 18:10:46.882 +01:00 [DBG] Endpoint 'APIBank.Controllers.UsersController.Login (APIBank)' with route pattern 'api/Users/Login' is valid for the request path '/api/Users/Login'
2022-09-20 18:10:46.886 +01:00 [DBG] Request matched endpoint 'APIBank.Controllers.UsersController.Login (APIBank)'
2022-09-20 18:10:46.892 +01:00 [DBG] Static files was skipped as the request already matched an endpoint.
2022-09-20 18:10:47.359 +01:00 [INF] Executing endpoint 'APIBank.Controllers.UsersController.Login (APIBank)'
2022-09-20 18:10:47.384 +01:00 [INF] Route matched with {action = "Login", controller = "Users"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult Login(APIBank.Models.Requests.LoginRequest) on controller APIBank.Controllers.UsersController (APIBank).
2022-09-20 18:10:47.389 +01:00 [DBG] Execution plan of authorization filters (in the following order): ["APIBank.Authorization.AuthorizeAttribute"]
2022-09-20 18:10:47.391 +01:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2022-09-20 18:10:47.392 +01:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2022-09-20 18:10:47.393 +01:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2022-09-20 18:10:47.394 +01:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2022-09-20 18:10:47.396 +01:00 [DBG] Executing controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-20 18:10:47.397 +01:00 [DBG] Executed controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-20 18:10:47.412 +01:00 [DBG] Attempting to bind parameter 'model' of type 'APIBank.Models.Requests.LoginRequest' ...
2022-09-20 18:10:47.415 +01:00 [DBG] Attempting to bind parameter 'model' of type 'APIBank.Models.Requests.LoginRequest' using the name '' in request data ...
2022-09-20 18:10:47.416 +01:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2022-09-20 18:10:47.423 +01:00 [DBG] Connection id "0HMKR5C3JSGT7", Request id "0HMKR5C3JSGT7:00000009": started reading request body.
2022-09-20 18:10:47.424 +01:00 [DBG] Connection id "0HMKR5C3JSGT7", Request id "0HMKR5C3JSGT7:00000009": done reading request body.
2022-09-20 18:10:47.430 +01:00 [DBG] JSON input formatter succeeded, deserializing to type 'APIBank.Models.Requests.LoginRequest'
2022-09-20 18:10:47.430 +01:00 [DBG] Done attempting to bind parameter 'model' of type 'APIBank.Models.Requests.LoginRequest'.
2022-09-20 18:10:47.431 +01:00 [DBG] Done attempting to bind parameter 'model' of type 'APIBank.Models.Requests.LoginRequest'.
2022-09-20 18:10:47.432 +01:00 [DBG] Attempting to validate the bound parameter 'model' of type 'APIBank.Models.Requests.LoginRequest' ...
2022-09-20 18:10:47.442 +01:00 [DBG] Done attempting to validate the bound parameter 'model' of type 'APIBank.Models.Requests.LoginRequest'.
2022-09-20 18:10:47.568 +01:00 [DBG] An additional 'IServiceProvider' was created for internal use by Entity Framework. An existing service provider was not used due to the following configuration changes: configuration changed for 'Core:ConfigureWarnings', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:UseAdminDatabase', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:SetPostgresVersion', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:UseRedshift', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:ReverseNullOrdering', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:RemoteCertificateValidationCallback', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:ProvideClientCertificatesCallback', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:ProvidePasswordCallback'.
2022-09-20 18:10:49.036 +01:00 [INF] Entity Framework Core 6.0.9 initialized 'PostgresContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:6.0.7+5b98e4b74de93b590b44aef8dd7967c03acc433c' with options: None
2022-09-20 18:10:49.104 +01:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .SingleOrDefault(x => x.Username == __model_Username_0)'
2022-09-20 18:10:49.595 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<User>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: User.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: User.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 1], [Property: User.Email (string) Required Index MaxLength(254), 2], [Property: User.FullName (string) Required MaxLength(100), 3], [Property: User.PasswordChangedAt (DateTime) Required ValueGenerated.OnAdd, 4], [Property: User.PasswordHash (string) Required MaxLength(200), 5], [Property: User.Username (string) Required Index MaxLength(50), 6] }
        SELECT TOP(2) u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
        FROM users AS u
        WHERE u.username == @__model_Username_0), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, User>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)
    .SingleOrDefault()'
2022-09-20 18:10:49.689 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-20 18:10:49.803 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (113ms).
2022-09-20 18:10:49.820 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-20 18:10:50.156 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-20 18:10:50.191 +01:00 [DBG] Executing DbCommand [Parameters=[@__model_Username_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.username = @__model_Username_0
LIMIT 2
2022-09-20 18:10:50.349 +01:00 [INF] Executed DbCommand (164ms) [Parameters=[@__model_Username_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.username = @__model_Username_0
LIMIT 2
2022-09-20 18:10:50.437 +01:00 [DBG] Context 'PostgresContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-20 18:10:50.500 +01:00 [DBG] A data reader was disposed.
2022-09-20 18:10:50.509 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-20 18:10:50.522 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-20 18:10:51.060 +01:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .Any(user => user.RefreshTokenCollection
        .Any(reftoken => reftoken.RefToken == __token_0))'
2022-09-20 18:10:51.223 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<bool>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            EmptyProjectionMember -> 0
        SELECT EXISTS (
            SELECT 1
            FROM users AS u
            WHERE EXISTS (
                SELECT 1
                FROM refresh_token AS r
                WHERE ((u.id != NULL) && (u.id == r.user_id)) && (r.token == @__token_0)))), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, bool>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)
    .Single()'
2022-09-20 18:10:51.246 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-20 18:10:51.247 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2022-09-20 18:10:51.250 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-20 18:10:51.252 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-20 18:10:51.253 +01:00 [DBG] Executing DbCommand [Parameters=[@__token_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM users AS u
    WHERE EXISTS (
        SELECT 1
        FROM refresh_token AS r
        WHERE (u.id = r.user_id) AND (r.token = @__token_0)))
2022-09-20 18:10:51.259 +01:00 [INF] Executed DbCommand (5ms) [Parameters=[@__token_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM users AS u
    WHERE EXISTS (
        SELECT 1
        FROM refresh_token AS r
        WHERE (u.id = r.user_id) AND (r.token = @__token_0)))
2022-09-20 18:10:51.271 +01:00 [DBG] A data reader was disposed.
2022-09-20 18:10:51.271 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-20 18:10:51.272 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-20 18:10:51.285 +01:00 [DBG] Compiling query expression: 
'DbSet<RefreshToken>()
    .Where(rt => rt.UserId == __id_0)
    .AsNoTracking()
    .Select(rt => new RefreshToken{ 
        Id = rt.Id, 
        UserId = rt.UserId, 
        RefToken = rt.RefToken, 
        Expires = rt.Expires, 
        Created = rt.Created, 
        CreatedByIp = rt.CreatedByIp, 
        Revoked = rt.Revoked, 
        RevokedByIp = rt.RevokedByIp, 
        ReplacedByToken = rt.ReplacedByToken, 
        ReasonRevoked = rt.ReasonRevoked, 
        IsExpired = rt.IsExpired, 
        IsRevoked = rt.IsRevoked, 
        IsActive = rt.IsActive 
    }
    )'
2022-09-20 18:10:51.308 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<RefreshToken>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            Id -> 0
            UserId -> 1
            RefToken -> 2
            Expires -> 3
            Created -> 4
            CreatedByIp -> 5
            Revoked -> 6
            RevokedByIp -> 7
            ReplacedByToken -> 8
            ReasonRevoked -> 9
            IsExpired -> 10
            IsRevoked -> 11
            IsActive -> 12
        SELECT r.id AS Id, r.user_id AS UserId, r.token AS RefToken, r.expires AS Expires, r.created AS Created, r.created_by_ip AS CreatedByIp, r.revoked AS Revoked, r.revoked_by_ip AS RevokedByIp, r.replaced_by_token AS ReplacedByToken, r.reason_revoked AS ReasonRevoked, r.is_expired AS IsExpired, r.is_revoked AS IsRevoked, r.is_active AS IsActive
        FROM refresh_token AS r
        WHERE r.user_id == @__id_0), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, RefreshToken>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)'
2022-09-20 18:10:51.311 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-20 18:10:51.311 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2022-09-20 18:10:51.312 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-20 18:10:51.313 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-20 18:10:51.314 +01:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.user_id AS "UserId", r.token AS "RefToken", r.expires AS "Expires", r.created AS "Created", r.created_by_ip AS "CreatedByIp", r.revoked AS "Revoked", r.revoked_by_ip AS "RevokedByIp", r.replaced_by_token AS "ReplacedByToken", r.reason_revoked AS "ReasonRevoked", r.is_expired AS "IsExpired", r.is_revoked AS "IsRevoked", r.is_active AS "IsActive"
FROM refresh_token AS r
WHERE r.user_id = @__id_0
2022-09-20 18:10:51.323 +01:00 [INF] Executed DbCommand (9ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.user_id AS "UserId", r.token AS "RefToken", r.expires AS "Expires", r.created AS "Created", r.created_by_ip AS "CreatedByIp", r.revoked AS "Revoked", r.revoked_by_ip AS "RevokedByIp", r.replaced_by_token AS "ReplacedByToken", r.reason_revoked AS "ReasonRevoked", r.is_expired AS "IsExpired", r.is_revoked AS "IsRevoked", r.is_active AS "IsActive"
FROM refresh_token AS r
WHERE r.user_id = @__id_0
2022-09-20 18:10:51.327 +01:00 [DBG] A data reader was disposed.
2022-09-20 18:10:51.327 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-20 18:10:51.328 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-20 18:10:51.344 +01:00 [DBG] An entity of type 'User' tracked by 'PostgresContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-20 18:10:51.350 +01:00 [DBG] SaveChanges starting for 'PostgresContext'.
2022-09-20 18:10:51.354 +01:00 [DBG] DetectChanges starting for 'PostgresContext'.
2022-09-20 18:10:51.383 +01:00 [DBG] 1 entities were added and 0 entities were removed from navigation 'User.RefreshTokenCollection'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-20 18:10:51.442 +01:00 [DBG] 'PostgresContext' generated a temporary value for the property 'Id.RefreshToken'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-20 18:10:51.515 +01:00 [DBG] Context 'PostgresContext' started tracking 'RefreshToken' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-20 18:10:51.521 +01:00 [DBG] DetectChanges completed for 'PostgresContext'.
2022-09-20 18:10:51.537 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-20 18:10:51.541 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-20 18:10:51.546 +01:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2022-09-20 18:10:51.559 +01:00 [DBG] Began transaction with isolation level 'ReadCommitted'.
2022-09-20 18:10:51.645 +01:00 [DBG] Executing 2 update commands as a batch.
2022-09-20 18:10:51.686 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-20 18:10:51.690 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (3ms).
2022-09-20 18:10:51.692 +01:00 [DBG] Executing DbCommand [Parameters=[@p0='?' (DbType = DateTime), @p1='?', @p2='?' (DbType = DateTime), @p3='?' (DbType = Boolean), @p4='?' (DbType = Boolean), @p5='?' (DbType = Boolean), @p6='?', @p7='?', @p8='?', @p9='?' (DbType = DateTime), @p10='?', @p11='?' (DbType = Int32), @p18='?' (DbType = Int32), @p12='?' (DbType = DateTime), @p13='?', @p14='?', @p15='?' (DbType = DateTime), @p16='?', @p17='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO refresh_token (created, created_by_ip, expires, is_active, is_expired, is_revoked, reason_revoked, token, replaced_by_token, revoked, revoked_by_ip, user_id)
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11)
RETURNING id;
UPDATE users SET created_at = @p12, email = @p13, full_name = @p14, password_changed_at = @p15, password_hash = @p16, username = @p17
WHERE id = @p18;
2022-09-20 18:10:51.706 +01:00 [INF] Executed DbCommand (14ms) [Parameters=[@p0='?' (DbType = DateTime), @p1='?', @p2='?' (DbType = DateTime), @p3='?' (DbType = Boolean), @p4='?' (DbType = Boolean), @p5='?' (DbType = Boolean), @p6='?', @p7='?', @p8='?', @p9='?' (DbType = DateTime), @p10='?', @p11='?' (DbType = Int32), @p18='?' (DbType = Int32), @p12='?' (DbType = DateTime), @p13='?', @p14='?', @p15='?' (DbType = DateTime), @p16='?', @p17='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO refresh_token (created, created_by_ip, expires, is_active, is_expired, is_revoked, reason_revoked, token, replaced_by_token, revoked, revoked_by_ip, user_id)
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11)
RETURNING id;
UPDATE users SET created_at = @p12, email = @p13, full_name = @p14, password_changed_at = @p15, password_hash = @p16, username = @p17
WHERE id = @p18;
2022-09-20 18:10:51.736 +01:00 [DBG] The foreign key property 'RefreshToken.Id' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2022-09-20 18:10:51.746 +01:00 [DBG] A data reader was disposed.
2022-09-20 18:10:51.754 +01:00 [DBG] Committing transaction.
2022-09-20 18:10:51.768 +01:00 [DBG] Committed transaction.
2022-09-20 18:10:51.773 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-20 18:10:51.776 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-20 18:10:51.778 +01:00 [DBG] Disposing transaction.
2022-09-20 18:10:51.782 +01:00 [DBG] An entity of type 'RefreshToken' tracked by 'PostgresContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-20 18:10:51.785 +01:00 [DBG] An entity of type 'User' tracked by 'PostgresContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-20 18:10:51.788 +01:00 [DBG] SaveChanges completed for 'PostgresContext' with 2 entities written to the database.
2022-09-20 18:10:51.797 +01:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2022-09-20 18:10:51.805 +01:00 [DBG] Attempting to select an output formatter based on Accept header '["text/plain"]'.
2022-09-20 18:10:51.806 +01:00 [DBG] Could not find an output formatter based on content negotiation. Accepted types were (["text/plain"])
2022-09-20 18:10:51.808 +01:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2022-09-20 18:10:51.809 +01:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2022-09-20 18:10:51.810 +01:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2022-09-20 18:10:51.812 +01:00 [INF] Executing OkObjectResult, writing value of type 'APIBank.Models.Users.Responses.LoginResponse'.
2022-09-20 18:10:51.831 +01:00 [INF] Executed action APIBank.Controllers.UsersController.Login (APIBank) in 4429.8743ms
2022-09-20 18:10:51.836 +01:00 [INF] Executed endpoint 'APIBank.Controllers.UsersController.Login (APIBank)'
2022-09-20 18:10:51.843 +01:00 [DBG] 'PostgresContext' disposed.
2022-09-20 18:10:51.850 +01:00 [INF] Request finished HTTP/2 POST https://localhost:7036/api/Users/Login application/json 58 - 200 - application/json;+charset=utf-8 4996.2240ms
2022-09-20 18:11:12.837 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/api/Users/1/refresh-tokens - -
2022-09-20 18:11:12.855 +01:00 [DBG] 1 candidate(s) found for the request path '/api/Users/1/refresh-tokens'
2022-09-20 18:11:12.856 +01:00 [DBG] Endpoint 'APIBank.Controllers.UsersController.GetRefreshTokens (APIBank)' with route pattern 'api/Users/{id}/refresh-tokens' is valid for the request path '/api/Users/1/refresh-tokens'
2022-09-20 18:11:12.857 +01:00 [DBG] Request matched endpoint 'APIBank.Controllers.UsersController.GetRefreshTokens (APIBank)'
2022-09-20 18:11:12.859 +01:00 [DBG] Static files was skipped as the request already matched an endpoint.
2022-09-20 18:11:13.015 +01:00 [INF] Entity Framework Core 6.0.9 initialized 'PostgresContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:6.0.7+5b98e4b74de93b590b44aef8dd7967c03acc433c' with options: None
2022-09-20 18:11:13.027 +01:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .FirstOrDefault(e => EF.Property<int>(e, "Id") == __p_0)'
2022-09-20 18:11:13.037 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<User>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: User.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: User.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 1], [Property: User.Email (string) Required Index MaxLength(254), 2], [Property: User.FullName (string) Required MaxLength(100), 3], [Property: User.PasswordChangedAt (DateTime) Required ValueGenerated.OnAdd, 4], [Property: User.PasswordHash (string) Required MaxLength(200), 5], [Property: User.Username (string) Required Index MaxLength(50), 6] }
        SELECT TOP(1) u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
        FROM users AS u
        WHERE u.id == @__p_0), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, User>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)
    .SingleOrDefault()'
2022-09-20 18:11:13.041 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-20 18:11:13.041 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2022-09-20 18:11:13.042 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-20 18:11:13.043 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-20 18:11:13.044 +01:00 [DBG] Executing DbCommand [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.id = @__p_0
LIMIT 1
2022-09-20 18:11:13.049 +01:00 [INF] Executed DbCommand (4ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.id = @__p_0
LIMIT 1
2022-09-20 18:11:13.053 +01:00 [DBG] Context 'PostgresContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-20 18:11:13.054 +01:00 [DBG] A data reader was disposed.
2022-09-20 18:11:13.054 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-20 18:11:13.055 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-20 18:11:13.056 +01:00 [INF] Executing endpoint 'APIBank.Controllers.UsersController.GetRefreshTokens (APIBank)'
2022-09-20 18:11:13.058 +01:00 [INF] Route matched with {action = "GetRefreshTokens", controller = "Users"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult GetRefreshTokens(Int32) on controller APIBank.Controllers.UsersController (APIBank).
2022-09-20 18:11:13.061 +01:00 [DBG] Execution plan of authorization filters (in the following order): ["APIBank.Authorization.AuthorizeAttribute"]
2022-09-20 18:11:13.062 +01:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2022-09-20 18:11:13.064 +01:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2022-09-20 18:11:13.066 +01:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2022-09-20 18:11:13.067 +01:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2022-09-20 18:11:13.069 +01:00 [DBG] Executing controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-20 18:11:13.070 +01:00 [DBG] Executed controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-20 18:11:13.071 +01:00 [DBG] Attempting to bind parameter 'id' of type 'System.Int32' ...
2022-09-20 18:11:13.072 +01:00 [DBG] Attempting to bind parameter 'id' of type 'System.Int32' using the name 'id' in request data ...
2022-09-20 18:11:13.074 +01:00 [DBG] Done attempting to bind parameter 'id' of type 'System.Int32'.
2022-09-20 18:11:13.075 +01:00 [DBG] Done attempting to bind parameter 'id' of type 'System.Int32'.
2022-09-20 18:11:13.076 +01:00 [DBG] Attempting to validate the bound parameter 'id' of type 'System.Int32' ...
2022-09-20 18:11:13.077 +01:00 [DBG] Done attempting to validate the bound parameter 'id' of type 'System.Int32'.
2022-09-20 18:11:13.079 +01:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2022-09-20 18:11:13.082 +01:00 [DBG] No information found on request to perform content negotiation.
2022-09-20 18:11:13.083 +01:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2022-09-20 18:11:13.084 +01:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2022-09-20 18:11:13.085 +01:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2022-09-20 18:11:13.086 +01:00 [INF] Executing OkObjectResult, writing value of type 'Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryable`1[[APIBank.ModelEntities.RefreshToken, APIBank, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2022-09-20 18:11:13.093 +01:00 [DBG] Compiling query expression: 
'DbSet<RefreshToken>()
    .Where(rt => rt.UserId == __id_0)
    .AsNoTracking()
    .Select(rt => new RefreshToken{ 
        Id = rt.Id, 
        UserId = rt.UserId, 
        RefToken = rt.RefToken, 
        Expires = rt.Expires, 
        Created = rt.Created, 
        CreatedByIp = rt.CreatedByIp, 
        Revoked = rt.Revoked, 
        RevokedByIp = rt.RevokedByIp, 
        ReplacedByToken = rt.ReplacedByToken, 
        ReasonRevoked = rt.ReasonRevoked, 
        IsExpired = rt.IsExpired, 
        IsRevoked = rt.IsRevoked, 
        IsActive = rt.IsActive 
    }
    )'
2022-09-20 18:11:13.101 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<RefreshToken>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            Id -> 0
            UserId -> 1
            RefToken -> 2
            Expires -> 3
            Created -> 4
            CreatedByIp -> 5
            Revoked -> 6
            RevokedByIp -> 7
            ReplacedByToken -> 8
            ReasonRevoked -> 9
            IsExpired -> 10
            IsRevoked -> 11
            IsActive -> 12
        SELECT r.id AS Id, r.user_id AS UserId, r.token AS RefToken, r.expires AS Expires, r.created AS Created, r.created_by_ip AS CreatedByIp, r.revoked AS Revoked, r.revoked_by_ip AS RevokedByIp, r.replaced_by_token AS ReplacedByToken, r.reason_revoked AS ReasonRevoked, r.is_expired AS IsExpired, r.is_revoked AS IsRevoked, r.is_active AS IsActive
        FROM refresh_token AS r
        WHERE r.user_id == @__id_0), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, RefreshToken>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)'
2022-09-20 18:11:13.123 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-20 18:11:13.125 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2022-09-20 18:11:13.136 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-20 18:11:13.139 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-20 18:11:13.141 +01:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.user_id AS "UserId", r.token AS "RefToken", r.expires AS "Expires", r.created AS "Created", r.created_by_ip AS "CreatedByIp", r.revoked AS "Revoked", r.revoked_by_ip AS "RevokedByIp", r.replaced_by_token AS "ReplacedByToken", r.reason_revoked AS "ReasonRevoked", r.is_expired AS "IsExpired", r.is_revoked AS "IsRevoked", r.is_active AS "IsActive"
FROM refresh_token AS r
WHERE r.user_id = @__id_0
2022-09-20 18:11:13.149 +01:00 [INF] Executed DbCommand (7ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.user_id AS "UserId", r.token AS "RefToken", r.expires AS "Expires", r.created AS "Created", r.created_by_ip AS "CreatedByIp", r.revoked AS "Revoked", r.revoked_by_ip AS "RevokedByIp", r.replaced_by_token AS "ReplacedByToken", r.reason_revoked AS "ReasonRevoked", r.is_expired AS "IsExpired", r.is_revoked AS "IsRevoked", r.is_active AS "IsActive"
FROM refresh_token AS r
WHERE r.user_id = @__id_0
2022-09-20 18:11:13.174 +01:00 [DBG] A data reader was disposed.
2022-09-20 18:11:13.190 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-20 18:11:13.193 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-20 18:11:13.194 +01:00 [INF] Executed action APIBank.Controllers.UsersController.GetRefreshTokens (APIBank) in 125.6194ms
2022-09-20 18:11:13.197 +01:00 [INF] Executed endpoint 'APIBank.Controllers.UsersController.GetRefreshTokens (APIBank)'
2022-09-20 18:11:13.200 +01:00 [DBG] 'PostgresContext' disposed.
2022-09-20 18:11:13.202 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/api/Users/1/refresh-tokens - - - 200 - application/json;+charset=utf-8 365.4423ms
2022-09-20 18:11:23.995 +01:00 [INF] Request starting HTTP/2 POST https://localhost:7036/api/Users/revoke-token application/json 105
2022-09-20 18:11:23.999 +01:00 [DBG] 1 candidate(s) found for the request path '/api/Users/revoke-token'
2022-09-20 18:11:24.001 +01:00 [DBG] Endpoint 'APIBank.Controllers.UsersController.RevokeToken (APIBank)' with route pattern 'api/Users/revoke-token' is valid for the request path '/api/Users/revoke-token'
2022-09-20 18:11:24.004 +01:00 [DBG] Request matched endpoint 'APIBank.Controllers.UsersController.RevokeToken (APIBank)'
2022-09-20 18:11:24.008 +01:00 [DBG] Static files was skipped as the request already matched an endpoint.
2022-09-20 18:11:24.077 +01:00 [INF] Entity Framework Core 6.0.9 initialized 'PostgresContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:6.0.7+5b98e4b74de93b590b44aef8dd7967c03acc433c' with options: None
2022-09-20 18:11:24.086 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-20 18:11:24.088 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2022-09-20 18:11:24.092 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-20 18:11:24.094 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-20 18:11:24.095 +01:00 [DBG] Executing DbCommand [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.id = @__p_0
LIMIT 1
2022-09-20 18:11:24.097 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.id = @__p_0
LIMIT 1
2022-09-20 18:11:24.104 +01:00 [DBG] Context 'PostgresContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-20 18:11:24.107 +01:00 [DBG] A data reader was disposed.
2022-09-20 18:11:24.109 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-20 18:11:24.112 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-20 18:11:24.114 +01:00 [INF] Executing endpoint 'APIBank.Controllers.UsersController.RevokeToken (APIBank)'
2022-09-20 18:11:24.117 +01:00 [INF] Route matched with {action = "RevokeToken", controller = "Users"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult RevokeToken(APIBank.Models.Users.Requests.RevokeTokenRequest) on controller APIBank.Controllers.UsersController (APIBank).
2022-09-20 18:11:24.119 +01:00 [DBG] Execution plan of authorization filters (in the following order): ["APIBank.Authorization.AuthorizeAttribute"]
2022-09-20 18:11:24.121 +01:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2022-09-20 18:11:24.124 +01:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2022-09-20 18:11:24.127 +01:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2022-09-20 18:11:24.128 +01:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2022-09-20 18:11:24.132 +01:00 [DBG] Executing controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-20 18:11:24.133 +01:00 [DBG] Executed controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-20 18:11:24.134 +01:00 [DBG] Attempting to bind parameter 'model' of type 'APIBank.Models.Users.Requests.RevokeTokenRequest' ...
2022-09-20 18:11:24.135 +01:00 [DBG] Attempting to bind parameter 'model' of type 'APIBank.Models.Users.Requests.RevokeTokenRequest' using the name '' in request data ...
2022-09-20 18:11:24.137 +01:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2022-09-20 18:11:24.139 +01:00 [DBG] Connection id "0HMKR5C3JSGT7", Request id "0HMKR5C3JSGT7:0000000D": started reading request body.
2022-09-20 18:11:24.140 +01:00 [DBG] Connection id "0HMKR5C3JSGT7", Request id "0HMKR5C3JSGT7:0000000D": done reading request body.
2022-09-20 18:11:24.145 +01:00 [DBG] JSON input formatter succeeded, deserializing to type 'APIBank.Models.Users.Requests.RevokeTokenRequest'
2022-09-20 18:11:24.145 +01:00 [DBG] Done attempting to bind parameter 'model' of type 'APIBank.Models.Users.Requests.RevokeTokenRequest'.
2022-09-20 18:11:24.146 +01:00 [DBG] Done attempting to bind parameter 'model' of type 'APIBank.Models.Users.Requests.RevokeTokenRequest'.
2022-09-20 18:11:24.147 +01:00 [DBG] Attempting to validate the bound parameter 'model' of type 'APIBank.Models.Users.Requests.RevokeTokenRequest' ...
2022-09-20 18:11:24.149 +01:00 [DBG] Done attempting to validate the bound parameter 'model' of type 'APIBank.Models.Users.Requests.RevokeTokenRequest'.
2022-09-20 18:11:24.151 +01:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .SingleOrDefault(userQuery => userQuery.RefreshTokenCollection
        .Any(refTokenQuery => refTokenQuery.RefToken == __refToken_0))'
2022-09-20 18:11:24.157 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<User>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: User.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: User.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 1], [Property: User.Email (string) Required Index MaxLength(254), 2], [Property: User.FullName (string) Required MaxLength(100), 3], [Property: User.PasswordChangedAt (DateTime) Required ValueGenerated.OnAdd, 4], [Property: User.PasswordHash (string) Required MaxLength(200), 5], [Property: User.Username (string) Required Index MaxLength(50), 6] }
        SELECT TOP(2) u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
        FROM users AS u
        WHERE EXISTS (
            SELECT 1
            FROM refresh_token AS r
            WHERE ((u.id != NULL) && (u.id == r.user_id)) && (r.token == @__refToken_0))), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, User>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)
    .SingleOrDefault()'
2022-09-20 18:11:24.163 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-20 18:11:24.165 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (2ms).
2022-09-20 18:11:24.165 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-20 18:11:24.166 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-20 18:11:24.167 +01:00 [DBG] Executing DbCommand [Parameters=[@__refToken_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE EXISTS (
    SELECT 1
    FROM refresh_token AS r
    WHERE (u.id = r.user_id) AND (r.token = @__refToken_0))
LIMIT 2
2022-09-20 18:11:24.169 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[@__refToken_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE EXISTS (
    SELECT 1
    FROM refresh_token AS r
    WHERE (u.id = r.user_id) AND (r.token = @__refToken_0))
LIMIT 2
2022-09-20 18:11:24.172 +01:00 [DBG] A data reader was disposed.
2022-09-20 18:11:24.172 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-20 18:11:24.173 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-20 18:11:24.178 +01:00 [DBG] Compiling query expression: 
'DbSet<RefreshToken>()
    .Where(rt => rt.UserId == __id_0)
    .AsNoTracking()
    .Select(rt => new RefreshToken{ 
        Id = rt.Id, 
        UserId = rt.UserId, 
        RefToken = rt.RefToken, 
        Expires = rt.Expires, 
        Created = rt.Created, 
        CreatedByIp = rt.CreatedByIp, 
        Revoked = rt.Revoked, 
        RevokedByIp = rt.RevokedByIp, 
        ReplacedByToken = rt.ReplacedByToken, 
        ReasonRevoked = rt.ReasonRevoked, 
        IsExpired = rt.IsExpired, 
        IsRevoked = rt.IsRevoked, 
        IsActive = rt.IsActive 
    }
    )
    .Single(refTokenQuery => refTokenQuery.RefToken == __refToken_1)'
2022-09-20 18:11:24.182 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<RefreshToken>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            Id -> 0
            UserId -> 1
            RefToken -> 2
            Expires -> 3
            Created -> 4
            CreatedByIp -> 5
            Revoked -> 6
            RevokedByIp -> 7
            ReplacedByToken -> 8
            ReasonRevoked -> 9
            IsExpired -> 10
            IsRevoked -> 11
            IsActive -> 12
        SELECT TOP(2) r.id AS Id, r.user_id AS UserId, r.token AS RefToken, r.expires AS Expires, r.created AS Created, r.created_by_ip AS CreatedByIp, r.revoked AS Revoked, r.revoked_by_ip AS RevokedByIp, r.replaced_by_token AS ReplacedByToken, r.reason_revoked AS ReasonRevoked, r.is_expired AS IsExpired, r.is_revoked AS IsRevoked, r.is_active AS IsActive
        FROM refresh_token AS r
        WHERE (r.user_id == @__id_0) && (r.token == @__refToken_1)), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, RefreshToken>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)
    .Single()'
2022-09-20 18:11:24.185 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-20 18:11:24.186 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2022-09-20 18:11:24.187 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-20 18:11:24.187 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-20 18:11:24.189 +01:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Int32), @__refToken_1='?'], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.user_id AS "UserId", r.token AS "RefToken", r.expires AS "Expires", r.created AS "Created", r.created_by_ip AS "CreatedByIp", r.revoked AS "Revoked", r.revoked_by_ip AS "RevokedByIp", r.replaced_by_token AS "ReplacedByToken", r.reason_revoked AS "ReasonRevoked", r.is_expired AS "IsExpired", r.is_revoked AS "IsRevoked", r.is_active AS "IsActive"
FROM refresh_token AS r
WHERE (r.user_id = @__id_0) AND (r.token = @__refToken_1)
LIMIT 2
2022-09-20 18:11:24.194 +01:00 [INF] Executed DbCommand (5ms) [Parameters=[@__id_0='?' (DbType = Int32), @__refToken_1='?'], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.user_id AS "UserId", r.token AS "RefToken", r.expires AS "Expires", r.created AS "Created", r.created_by_ip AS "CreatedByIp", r.revoked AS "Revoked", r.revoked_by_ip AS "RevokedByIp", r.replaced_by_token AS "ReplacedByToken", r.reason_revoked AS "ReasonRevoked", r.is_expired AS "IsExpired", r.is_revoked AS "IsRevoked", r.is_active AS "IsActive"
FROM refresh_token AS r
WHERE (r.user_id = @__id_0) AND (r.token = @__refToken_1)
LIMIT 2
2022-09-20 18:11:24.196 +01:00 [DBG] A data reader was disposed.
2022-09-20 18:11:24.196 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-20 18:11:24.197 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-20 18:11:24.198 +01:00 [DBG] An entity of type 'User' tracked by 'PostgresContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-20 18:11:24.199 +01:00 [DBG] SaveChanges starting for 'PostgresContext'.
2022-09-20 18:11:24.200 +01:00 [DBG] DetectChanges starting for 'PostgresContext'.
2022-09-20 18:11:24.201 +01:00 [DBG] DetectChanges completed for 'PostgresContext'.
2022-09-20 18:11:24.201 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-20 18:11:24.202 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-20 18:11:24.203 +01:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2022-09-20 18:11:24.204 +01:00 [DBG] Began transaction with isolation level 'ReadCommitted'.
2022-09-20 18:11:24.205 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-20 18:11:24.206 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2022-09-20 18:11:24.210 +01:00 [DBG] Executing DbCommand [Parameters=[@p6='?' (DbType = Int32), @p0='?' (DbType = DateTime), @p1='?', @p2='?', @p3='?' (DbType = DateTime), @p4='?', @p5='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE users SET created_at = @p0, email = @p1, full_name = @p2, password_changed_at = @p3, password_hash = @p4, username = @p5
WHERE id = @p6;
2022-09-20 18:11:24.212 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[@p6='?' (DbType = Int32), @p0='?' (DbType = DateTime), @p1='?', @p2='?', @p3='?' (DbType = DateTime), @p4='?', @p5='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE users SET created_at = @p0, email = @p1, full_name = @p2, password_changed_at = @p3, password_hash = @p4, username = @p5
WHERE id = @p6;
2022-09-20 18:11:24.213 +01:00 [DBG] A data reader was disposed.
2022-09-20 18:11:24.213 +01:00 [DBG] Committing transaction.
2022-09-20 18:11:24.214 +01:00 [DBG] Committed transaction.
2022-09-20 18:11:24.215 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-20 18:11:24.216 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-20 18:11:24.216 +01:00 [DBG] Disposing transaction.
2022-09-20 18:11:24.217 +01:00 [DBG] An entity of type 'User' tracked by 'PostgresContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-20 18:11:24.218 +01:00 [DBG] SaveChanges completed for 'PostgresContext' with 1 entities written to the database.
2022-09-20 18:11:24.219 +01:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2022-09-20 18:11:24.221 +01:00 [DBG] No information found on request to perform content negotiation.
2022-09-20 18:11:24.222 +01:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2022-09-20 18:11:24.225 +01:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2022-09-20 18:11:24.226 +01:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2022-09-20 18:11:24.227 +01:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType0`1[[System.String, System.Private.CoreLib, Version=6.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2022-09-20 18:11:24.229 +01:00 [INF] Executed action APIBank.Controllers.UsersController.RevokeToken (APIBank) in 97.117ms
2022-09-20 18:11:24.230 +01:00 [INF] Executed endpoint 'APIBank.Controllers.UsersController.RevokeToken (APIBank)'
2022-09-20 18:11:24.231 +01:00 [DBG] 'PostgresContext' disposed.
2022-09-20 18:11:24.232 +01:00 [INF] Request finished HTTP/2 POST https://localhost:7036/api/Users/revoke-token application/json 105 - 200 - application/json;+charset=utf-8 236.9991ms
2022-09-20 18:11:28.781 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/api/Users/1/refresh-tokens - -
2022-09-20 18:11:28.783 +01:00 [DBG] 1 candidate(s) found for the request path '/api/Users/1/refresh-tokens'
2022-09-20 18:11:28.789 +01:00 [DBG] Endpoint 'APIBank.Controllers.UsersController.GetRefreshTokens (APIBank)' with route pattern 'api/Users/{id}/refresh-tokens' is valid for the request path '/api/Users/1/refresh-tokens'
2022-09-20 18:11:28.794 +01:00 [DBG] Request matched endpoint 'APIBank.Controllers.UsersController.GetRefreshTokens (APIBank)'
2022-09-20 18:11:28.797 +01:00 [DBG] Static files was skipped as the request already matched an endpoint.
2022-09-20 18:11:28.799 +01:00 [INF] Entity Framework Core 6.0.9 initialized 'PostgresContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:6.0.7+5b98e4b74de93b590b44aef8dd7967c03acc433c' with options: None
2022-09-20 18:11:28.806 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-20 18:11:28.808 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2022-09-20 18:11:28.809 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-20 18:11:28.811 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-20 18:11:28.812 +01:00 [DBG] Executing DbCommand [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.id = @__p_0
LIMIT 1
2022-09-20 18:11:28.814 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.id = @__p_0
LIMIT 1
2022-09-20 18:11:28.816 +01:00 [DBG] Context 'PostgresContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-20 18:11:28.823 +01:00 [DBG] A data reader was disposed.
2022-09-20 18:11:28.824 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-20 18:11:28.826 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-20 18:11:28.828 +01:00 [INF] Executing endpoint 'APIBank.Controllers.UsersController.GetRefreshTokens (APIBank)'
2022-09-20 18:11:28.829 +01:00 [INF] Route matched with {action = "GetRefreshTokens", controller = "Users"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult GetRefreshTokens(Int32) on controller APIBank.Controllers.UsersController (APIBank).
2022-09-20 18:11:28.832 +01:00 [DBG] Execution plan of authorization filters (in the following order): ["APIBank.Authorization.AuthorizeAttribute"]
2022-09-20 18:11:28.838 +01:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2022-09-20 18:11:28.840 +01:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2022-09-20 18:11:28.843 +01:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2022-09-20 18:11:28.845 +01:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2022-09-20 18:11:28.848 +01:00 [DBG] Executing controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-20 18:11:28.850 +01:00 [DBG] Executed controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-20 18:11:28.852 +01:00 [DBG] Attempting to bind parameter 'id' of type 'System.Int32' ...
2022-09-20 18:11:28.855 +01:00 [DBG] Attempting to bind parameter 'id' of type 'System.Int32' using the name 'id' in request data ...
2022-09-20 18:11:28.856 +01:00 [DBG] Done attempting to bind parameter 'id' of type 'System.Int32'.
2022-09-20 18:11:28.857 +01:00 [DBG] Done attempting to bind parameter 'id' of type 'System.Int32'.
2022-09-20 18:11:28.858 +01:00 [DBG] Attempting to validate the bound parameter 'id' of type 'System.Int32' ...
2022-09-20 18:11:28.859 +01:00 [DBG] Done attempting to validate the bound parameter 'id' of type 'System.Int32'.
2022-09-20 18:11:28.860 +01:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2022-09-20 18:11:28.861 +01:00 [DBG] No information found on request to perform content negotiation.
2022-09-20 18:11:28.862 +01:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2022-09-20 18:11:28.866 +01:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2022-09-20 18:11:28.870 +01:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2022-09-20 18:11:28.872 +01:00 [INF] Executing OkObjectResult, writing value of type 'Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryable`1[[APIBank.ModelEntities.RefreshToken, APIBank, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2022-09-20 18:11:28.876 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-20 18:11:28.877 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2022-09-20 18:11:28.878 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-20 18:11:28.879 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-20 18:11:28.880 +01:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.user_id AS "UserId", r.token AS "RefToken", r.expires AS "Expires", r.created AS "Created", r.created_by_ip AS "CreatedByIp", r.revoked AS "Revoked", r.revoked_by_ip AS "RevokedByIp", r.replaced_by_token AS "ReplacedByToken", r.reason_revoked AS "ReasonRevoked", r.is_expired AS "IsExpired", r.is_revoked AS "IsRevoked", r.is_active AS "IsActive"
FROM refresh_token AS r
WHERE r.user_id = @__id_0
2022-09-20 18:11:28.899 +01:00 [INF] Executed DbCommand (19ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.user_id AS "UserId", r.token AS "RefToken", r.expires AS "Expires", r.created AS "Created", r.created_by_ip AS "CreatedByIp", r.revoked AS "Revoked", r.revoked_by_ip AS "RevokedByIp", r.replaced_by_token AS "ReplacedByToken", r.reason_revoked AS "ReasonRevoked", r.is_expired AS "IsExpired", r.is_revoked AS "IsRevoked", r.is_active AS "IsActive"
FROM refresh_token AS r
WHERE r.user_id = @__id_0
2022-09-20 18:11:28.911 +01:00 [DBG] A data reader was disposed.
2022-09-20 18:11:28.912 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-20 18:11:28.913 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-20 18:11:28.923 +01:00 [INF] Executed action APIBank.Controllers.UsersController.GetRefreshTokens (APIBank) in 75.4924ms
2022-09-20 18:11:28.926 +01:00 [INF] Executed endpoint 'APIBank.Controllers.UsersController.GetRefreshTokens (APIBank)'
2022-09-20 18:11:28.930 +01:00 [DBG] 'PostgresContext' disposed.
2022-09-20 18:11:28.931 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/api/Users/1/refresh-tokens - - - 200 - application/json;+charset=utf-8 149.8756ms
2022-09-20 18:18:45.964 +01:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2022-09-20 18:18:46.358 +01:00 [DBG] Hosting starting
2022-09-20 18:18:46.531 +01:00 [DBG] Using development certificate: CN=localhost (Thumbprint: 9CC642E9838495A6C3C202DECA6A8AD300396DD2)
2022-09-20 18:18:46.598 +01:00 [INF] Now listening on: https://localhost:7036
2022-09-20 18:18:46.600 +01:00 [INF] Now listening on: http://localhost:5036
2022-09-20 18:18:46.601 +01:00 [DBG] Loaded hosting startup assembly APIBank
2022-09-20 18:18:46.602 +01:00 [DBG] Loaded hosting startup assembly Microsoft.AspNetCore.Watch.BrowserRefresh
2022-09-20 18:18:46.603 +01:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.BrowserLink.Net
2022-09-20 18:18:46.604 +01:00 [INF] Application started. Press Ctrl+C to shut down.
2022-09-20 18:18:46.605 +01:00 [INF] Hosting environment: Development
2022-09-20 18:18:46.606 +01:00 [INF] Content root path: C:\Users\mguedesa\OneDrive - NTT DATA EMEAL\Documentos\GitHub\OpenBankAPI-NTT\APIBank\APIBank\
2022-09-20 18:18:46.606 +01:00 [DBG] Hosting started
2022-09-20 18:18:46.961 +01:00 [DBG] Connection id "0HMKR5GMN1PC5" accepted.
2022-09-20 18:18:46.983 +01:00 [DBG] Connection id "0HMKR5GMN1PC6" received FIN.
2022-09-20 18:18:46.963 +01:00 [DBG] Connection id "0HMKR5GMN1PC6" accepted.
2022-09-20 18:18:46.983 +01:00 [DBG] Connection id "0HMKR5GMN1PC5" received FIN.
2022-09-20 18:18:46.991 +01:00 [DBG] Connection id "0HMKR5GMN1PC5" started.
2022-09-20 18:18:46.991 +01:00 [DBG] Connection id "0HMKR5GMN1PC6" started.
2022-09-20 18:18:47.030 +01:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException:  Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveBlobAsync[TIOAdapter](TIOAdapter adapter)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](TIOAdapter adapter, Boolean receiveFirst, Byte[] reAuthenticationData, Boolean isApm)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2022-09-20 18:18:47.030 +01:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException:  Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveBlobAsync[TIOAdapter](TIOAdapter adapter)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](TIOAdapter adapter, Boolean receiveFirst, Byte[] reAuthenticationData, Boolean isApm)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2022-09-20 18:18:47.119 +01:00 [DBG] Connection id "0HMKR5GMN1PC6" stopped.
2022-09-20 18:18:47.119 +01:00 [DBG] Connection id "0HMKR5GMN1PC5" stopped.
2022-09-20 18:18:47.123 +01:00 [DBG] Connection id "0HMKR5GMN1PC6" sending FIN because: "The Socket transport's send loop completed gracefully."
2022-09-20 18:18:47.123 +01:00 [DBG] Connection id "0HMKR5GMN1PC5" sending FIN because: "The Socket transport's send loop completed gracefully."
2022-09-20 18:18:47.237 +01:00 [DBG] Connection id "0HMKR5GMN1PC7" accepted.
2022-09-20 18:18:47.242 +01:00 [DBG] Connection id "0HMKR5GMN1PC7" started.
2022-09-20 18:18:47.305 +01:00 [DBG] Connection 0HMKR5GMN1PC7 established using the following protocol: "Tls12"
2022-09-20 18:18:47.409 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/swagger/index.html - -
2022-09-20 18:18:47.456 +01:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2022-09-20 18:18:47.481 +01:00 [DBG] No candidates found for the request path '/swagger/index.html'
2022-09-20 18:18:47.483 +01:00 [DBG] Request did not match any endpoints
2022-09-20 18:18:47.590 +01:00 [DBG] Response markup is scheduled to include browser refresh script injection.
2022-09-20 18:18:47.747 +01:00 [DBG] Response markup was updated to include browser refresh script injection.
2022-09-20 18:18:47.756 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/swagger/index.html - - - 200 - text/html;charset=utf-8 350.8541ms
2022-09-20 18:18:47.785 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/_vs/browserLink - -
2022-09-20 18:18:47.785 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/_framework/aspnetcore-browser-refresh.js - -
2022-09-20 18:18:47.814 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/_framework/aspnetcore-browser-refresh.js - - - 200 11984 application/javascript;+charset=utf-8 28.4186ms
2022-09-20 18:18:47.855 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/_vs/browserLink - - - 200 - text/javascript;+charset=UTF-8 70.3085ms
2022-09-20 18:18:47.905 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/swagger/v1/swagger.json - -
2022-09-20 18:18:47.906 +01:00 [DBG] No candidates found for the request path '/swagger/v1/swagger.json'
2022-09-20 18:18:47.907 +01:00 [DBG] Request did not match any endpoints
2022-09-20 18:18:48.090 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/swagger/v1/swagger.json - - - 200 - application/json;charset=utf-8 185.6552ms
2022-09-20 18:19:15.890 +01:00 [INF] Request starting HTTP/2 POST https://localhost:7036/api/Users/Login application/json 58
2022-09-20 18:19:15.921 +01:00 [DBG] 1 candidate(s) found for the request path '/api/Users/Login'
2022-09-20 18:19:15.927 +01:00 [DBG] Endpoint 'APIBank.Controllers.UsersController.Login (APIBank)' with route pattern 'api/Users/Login' is valid for the request path '/api/Users/Login'
2022-09-20 18:19:15.933 +01:00 [DBG] Request matched endpoint 'APIBank.Controllers.UsersController.Login (APIBank)'
2022-09-20 18:19:15.935 +01:00 [DBG] Static files was skipped as the request already matched an endpoint.
2022-09-20 18:19:16.418 +01:00 [INF] Executing endpoint 'APIBank.Controllers.UsersController.Login (APIBank)'
2022-09-20 18:19:16.451 +01:00 [INF] Route matched with {action = "Login", controller = "Users"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult Login(APIBank.Models.Requests.LoginRequest) on controller APIBank.Controllers.UsersController (APIBank).
2022-09-20 18:19:16.456 +01:00 [DBG] Execution plan of authorization filters (in the following order): ["APIBank.Authorization.AuthorizeAttribute"]
2022-09-20 18:19:16.458 +01:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2022-09-20 18:19:16.460 +01:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2022-09-20 18:19:16.463 +01:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2022-09-20 18:19:16.464 +01:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2022-09-20 18:19:16.466 +01:00 [DBG] Executing controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-20 18:19:16.469 +01:00 [DBG] Executed controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-20 18:19:16.487 +01:00 [DBG] Attempting to bind parameter 'model' of type 'APIBank.Models.Requests.LoginRequest' ...
2022-09-20 18:19:16.492 +01:00 [DBG] Attempting to bind parameter 'model' of type 'APIBank.Models.Requests.LoginRequest' using the name '' in request data ...
2022-09-20 18:19:16.495 +01:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2022-09-20 18:19:16.501 +01:00 [DBG] Connection id "0HMKR5GMN1PC7", Request id "0HMKR5GMN1PC7:00000009": started reading request body.
2022-09-20 18:19:16.503 +01:00 [DBG] Connection id "0HMKR5GMN1PC7", Request id "0HMKR5GMN1PC7:00000009": done reading request body.
2022-09-20 18:19:16.513 +01:00 [DBG] JSON input formatter succeeded, deserializing to type 'APIBank.Models.Requests.LoginRequest'
2022-09-20 18:19:16.515 +01:00 [DBG] Done attempting to bind parameter 'model' of type 'APIBank.Models.Requests.LoginRequest'.
2022-09-20 18:19:16.517 +01:00 [DBG] Done attempting to bind parameter 'model' of type 'APIBank.Models.Requests.LoginRequest'.
2022-09-20 18:19:16.518 +01:00 [DBG] Attempting to validate the bound parameter 'model' of type 'APIBank.Models.Requests.LoginRequest' ...
2022-09-20 18:19:16.528 +01:00 [DBG] Done attempting to validate the bound parameter 'model' of type 'APIBank.Models.Requests.LoginRequest'.
2022-09-20 18:19:16.683 +01:00 [DBG] An additional 'IServiceProvider' was created for internal use by Entity Framework. An existing service provider was not used due to the following configuration changes: configuration changed for 'Core:ConfigureWarnings', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:UseAdminDatabase', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:SetPostgresVersion', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:UseRedshift', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:ReverseNullOrdering', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:RemoteCertificateValidationCallback', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:ProvideClientCertificatesCallback', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:ProvidePasswordCallback'.
2022-09-20 18:19:18.481 +01:00 [INF] Entity Framework Core 6.0.9 initialized 'PostgresContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:6.0.7+5b98e4b74de93b590b44aef8dd7967c03acc433c' with options: None
2022-09-20 18:19:18.584 +01:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .SingleOrDefault(x => x.Username == __model_Username_0)'
2022-09-20 18:19:19.192 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<User>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: User.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: User.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 1], [Property: User.Email (string) Required Index MaxLength(254), 2], [Property: User.FullName (string) Required MaxLength(100), 3], [Property: User.PasswordChangedAt (DateTime) Required ValueGenerated.OnAdd, 4], [Property: User.PasswordHash (string) Required MaxLength(200), 5], [Property: User.Username (string) Required Index MaxLength(50), 6] }
        SELECT TOP(2) u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
        FROM users AS u
        WHERE u.username == @__model_Username_0), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, User>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)
    .SingleOrDefault()'
2022-09-20 18:19:19.273 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-20 18:19:19.394 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (117ms).
2022-09-20 18:19:19.411 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-20 18:19:19.741 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-20 18:19:19.765 +01:00 [DBG] Executing DbCommand [Parameters=[@__model_Username_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.username = @__model_Username_0
LIMIT 2
2022-09-20 18:19:19.902 +01:00 [INF] Executed DbCommand (140ms) [Parameters=[@__model_Username_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.username = @__model_Username_0
LIMIT 2
2022-09-20 18:19:19.994 +01:00 [DBG] Context 'PostgresContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-20 18:19:20.081 +01:00 [DBG] A data reader was disposed.
2022-09-20 18:19:20.089 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-20 18:19:20.097 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-20 18:19:20.588 +01:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .Any(user => user.RefreshTokenCollection
        .Any(reftoken => reftoken.RefToken == __token_0))'
2022-09-20 18:19:20.743 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<bool>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            EmptyProjectionMember -> 0
        SELECT EXISTS (
            SELECT 1
            FROM users AS u
            WHERE EXISTS (
                SELECT 1
                FROM refresh_token AS r
                WHERE ((u.id != NULL) && (u.id == r.user_id)) && (r.token == @__token_0)))), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, bool>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)
    .Single()'
2022-09-20 18:19:20.761 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-20 18:19:20.763 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (2ms).
2022-09-20 18:19:20.764 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-20 18:19:20.764 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-20 18:19:20.765 +01:00 [DBG] Executing DbCommand [Parameters=[@__token_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM users AS u
    WHERE EXISTS (
        SELECT 1
        FROM refresh_token AS r
        WHERE (u.id = r.user_id) AND (r.token = @__token_0)))
2022-09-20 18:19:20.768 +01:00 [INF] Executed DbCommand (3ms) [Parameters=[@__token_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM users AS u
    WHERE EXISTS (
        SELECT 1
        FROM refresh_token AS r
        WHERE (u.id = r.user_id) AND (r.token = @__token_0)))
2022-09-20 18:19:20.775 +01:00 [DBG] A data reader was disposed.
2022-09-20 18:19:20.776 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-20 18:19:20.777 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-20 18:19:20.789 +01:00 [DBG] Compiling query expression: 
'DbSet<RefreshToken>()
    .Where(rt => rt.UserId == __id_0)
    .AsNoTracking()
    .Select(rt => new RefreshToken{ 
        Id = rt.Id, 
        UserId = rt.UserId, 
        RefToken = rt.RefToken, 
        Expires = rt.Expires, 
        Created = rt.Created, 
        CreatedByIp = rt.CreatedByIp, 
        Revoked = rt.Revoked, 
        RevokedByIp = rt.RevokedByIp, 
        ReplacedByToken = rt.ReplacedByToken, 
        ReasonRevoked = rt.ReasonRevoked, 
        IsExpired = rt.IsExpired, 
        IsRevoked = rt.IsRevoked, 
        IsActive = rt.IsActive 
    }
    )'
2022-09-20 18:19:20.816 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<RefreshToken>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            Id -> 0
            UserId -> 1
            RefToken -> 2
            Expires -> 3
            Created -> 4
            CreatedByIp -> 5
            Revoked -> 6
            RevokedByIp -> 7
            ReplacedByToken -> 8
            ReasonRevoked -> 9
            IsExpired -> 10
            IsRevoked -> 11
            IsActive -> 12
        SELECT r.id AS Id, r.user_id AS UserId, r.token AS RefToken, r.expires AS Expires, r.created AS Created, r.created_by_ip AS CreatedByIp, r.revoked AS Revoked, r.revoked_by_ip AS RevokedByIp, r.replaced_by_token AS ReplacedByToken, r.reason_revoked AS ReasonRevoked, r.is_expired AS IsExpired, r.is_revoked AS IsRevoked, r.is_active AS IsActive
        FROM refresh_token AS r
        WHERE r.user_id == @__id_0), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, RefreshToken>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)'
2022-09-20 18:19:20.819 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-20 18:19:20.821 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2022-09-20 18:19:20.822 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-20 18:19:20.824 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-20 18:19:20.825 +01:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.user_id AS "UserId", r.token AS "RefToken", r.expires AS "Expires", r.created AS "Created", r.created_by_ip AS "CreatedByIp", r.revoked AS "Revoked", r.revoked_by_ip AS "RevokedByIp", r.replaced_by_token AS "ReplacedByToken", r.reason_revoked AS "ReasonRevoked", r.is_expired AS "IsExpired", r.is_revoked AS "IsRevoked", r.is_active AS "IsActive"
FROM refresh_token AS r
WHERE r.user_id = @__id_0
2022-09-20 18:19:20.834 +01:00 [INF] Executed DbCommand (9ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.user_id AS "UserId", r.token AS "RefToken", r.expires AS "Expires", r.created AS "Created", r.created_by_ip AS "CreatedByIp", r.revoked AS "Revoked", r.revoked_by_ip AS "RevokedByIp", r.replaced_by_token AS "ReplacedByToken", r.reason_revoked AS "ReasonRevoked", r.is_expired AS "IsExpired", r.is_revoked AS "IsRevoked", r.is_active AS "IsActive"
FROM refresh_token AS r
WHERE r.user_id = @__id_0
2022-09-20 18:19:20.838 +01:00 [DBG] A data reader was disposed.
2022-09-20 18:19:20.839 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-20 18:19:20.841 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-20 18:19:20.860 +01:00 [DBG] An entity of type 'User' tracked by 'PostgresContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-20 18:19:20.866 +01:00 [DBG] SaveChanges starting for 'PostgresContext'.
2022-09-20 18:19:20.869 +01:00 [DBG] DetectChanges starting for 'PostgresContext'.
2022-09-20 18:19:20.899 +01:00 [DBG] 1 entities were added and 0 entities were removed from navigation 'User.RefreshTokenCollection'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-20 18:19:20.944 +01:00 [DBG] 'PostgresContext' generated a temporary value for the property 'Id.RefreshToken'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-20 18:19:21.023 +01:00 [DBG] Context 'PostgresContext' started tracking 'RefreshToken' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-20 18:19:21.028 +01:00 [DBG] DetectChanges completed for 'PostgresContext'.
2022-09-20 18:19:21.046 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-20 18:19:21.049 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-20 18:19:21.055 +01:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2022-09-20 18:19:21.068 +01:00 [DBG] Began transaction with isolation level 'ReadCommitted'.
2022-09-20 18:19:21.149 +01:00 [DBG] Executing 2 update commands as a batch.
2022-09-20 18:19:21.190 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-20 18:19:21.193 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (2ms).
2022-09-20 18:19:21.195 +01:00 [DBG] Executing DbCommand [Parameters=[@p0='?' (DbType = DateTime), @p1='?', @p2='?' (DbType = DateTime), @p3='?' (DbType = Boolean), @p4='?' (DbType = Boolean), @p5='?' (DbType = Boolean), @p6='?', @p7='?', @p8='?', @p9='?' (DbType = DateTime), @p10='?', @p11='?' (DbType = Int32), @p18='?' (DbType = Int32), @p12='?' (DbType = DateTime), @p13='?', @p14='?', @p15='?' (DbType = DateTime), @p16='?', @p17='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO refresh_token (created, created_by_ip, expires, is_active, is_expired, is_revoked, reason_revoked, token, replaced_by_token, revoked, revoked_by_ip, user_id)
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11)
RETURNING id;
UPDATE users SET created_at = @p12, email = @p13, full_name = @p14, password_changed_at = @p15, password_hash = @p16, username = @p17
WHERE id = @p18;
2022-09-20 18:19:21.209 +01:00 [INF] Executed DbCommand (14ms) [Parameters=[@p0='?' (DbType = DateTime), @p1='?', @p2='?' (DbType = DateTime), @p3='?' (DbType = Boolean), @p4='?' (DbType = Boolean), @p5='?' (DbType = Boolean), @p6='?', @p7='?', @p8='?', @p9='?' (DbType = DateTime), @p10='?', @p11='?' (DbType = Int32), @p18='?' (DbType = Int32), @p12='?' (DbType = DateTime), @p13='?', @p14='?', @p15='?' (DbType = DateTime), @p16='?', @p17='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO refresh_token (created, created_by_ip, expires, is_active, is_expired, is_revoked, reason_revoked, token, replaced_by_token, revoked, revoked_by_ip, user_id)
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11)
RETURNING id;
UPDATE users SET created_at = @p12, email = @p13, full_name = @p14, password_changed_at = @p15, password_hash = @p16, username = @p17
WHERE id = @p18;
2022-09-20 18:19:21.231 +01:00 [DBG] The foreign key property 'RefreshToken.Id' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2022-09-20 18:19:21.240 +01:00 [DBG] A data reader was disposed.
2022-09-20 18:19:21.247 +01:00 [DBG] Committing transaction.
2022-09-20 18:19:21.259 +01:00 [DBG] Committed transaction.
2022-09-20 18:19:21.261 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-20 18:19:21.263 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-20 18:19:21.269 +01:00 [DBG] Disposing transaction.
2022-09-20 18:19:21.276 +01:00 [DBG] An entity of type 'RefreshToken' tracked by 'PostgresContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-20 18:19:21.278 +01:00 [DBG] An entity of type 'User' tracked by 'PostgresContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-20 18:19:21.283 +01:00 [DBG] SaveChanges completed for 'PostgresContext' with 2 entities written to the database.
2022-09-20 18:19:21.289 +01:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2022-09-20 18:19:21.295 +01:00 [DBG] Attempting to select an output formatter based on Accept header '["text/plain"]'.
2022-09-20 18:19:21.297 +01:00 [DBG] Could not find an output formatter based on content negotiation. Accepted types were (["text/plain"])
2022-09-20 18:19:21.298 +01:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2022-09-20 18:19:21.298 +01:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2022-09-20 18:19:21.299 +01:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2022-09-20 18:19:21.300 +01:00 [INF] Executing OkObjectResult, writing value of type 'APIBank.Models.Users.Responses.LoginResponse'.
2022-09-20 18:19:21.318 +01:00 [INF] Executed action APIBank.Controllers.UsersController.Login (APIBank) in 4848.4827ms
2022-09-20 18:19:21.320 +01:00 [INF] Executed endpoint 'APIBank.Controllers.UsersController.Login (APIBank)'
2022-09-20 18:19:21.328 +01:00 [DBG] 'PostgresContext' disposed.
2022-09-20 18:19:21.334 +01:00 [INF] Request finished HTTP/2 POST https://localhost:7036/api/Users/Login application/json 58 - 200 - application/json;+charset=utf-8 5443.7028ms
2022-09-20 18:19:37.336 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/api/Users/1/refresh-tokens - -
2022-09-20 18:19:37.343 +01:00 [DBG] 1 candidate(s) found for the request path '/api/Users/1/refresh-tokens'
2022-09-20 18:19:37.345 +01:00 [DBG] Endpoint 'APIBank.Controllers.UsersController.GetRefreshTokens (APIBank)' with route pattern 'api/Users/{id}/refresh-tokens' is valid for the request path '/api/Users/1/refresh-tokens'
2022-09-20 18:19:37.347 +01:00 [DBG] Request matched endpoint 'APIBank.Controllers.UsersController.GetRefreshTokens (APIBank)'
2022-09-20 18:19:37.348 +01:00 [DBG] Static files was skipped as the request already matched an endpoint.
2022-09-20 18:19:37.498 +01:00 [INF] Entity Framework Core 6.0.9 initialized 'PostgresContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:6.0.7+5b98e4b74de93b590b44aef8dd7967c03acc433c' with options: None
2022-09-20 18:19:37.530 +01:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .FirstOrDefault(e => EF.Property<int>(e, "Id") == __p_0)'
2022-09-20 18:19:37.537 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<User>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: User.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: User.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 1], [Property: User.Email (string) Required Index MaxLength(254), 2], [Property: User.FullName (string) Required MaxLength(100), 3], [Property: User.PasswordChangedAt (DateTime) Required ValueGenerated.OnAdd, 4], [Property: User.PasswordHash (string) Required MaxLength(200), 5], [Property: User.Username (string) Required Index MaxLength(50), 6] }
        SELECT TOP(1) u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
        FROM users AS u
        WHERE u.id == @__p_0), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, User>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)
    .SingleOrDefault()'
2022-09-20 18:19:37.541 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-20 18:19:37.543 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2022-09-20 18:19:37.544 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-20 18:19:37.545 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-20 18:19:37.546 +01:00 [DBG] Executing DbCommand [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.id = @__p_0
LIMIT 1
2022-09-20 18:19:37.548 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.id = @__p_0
LIMIT 1
2022-09-20 18:19:37.551 +01:00 [DBG] Context 'PostgresContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-20 18:19:37.552 +01:00 [DBG] A data reader was disposed.
2022-09-20 18:19:37.552 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-20 18:19:37.554 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-20 18:19:37.556 +01:00 [INF] Executing endpoint 'APIBank.Controllers.UsersController.GetRefreshTokens (APIBank)'
2022-09-20 18:19:37.561 +01:00 [INF] Route matched with {action = "GetRefreshTokens", controller = "Users"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult GetRefreshTokens(Int32) on controller APIBank.Controllers.UsersController (APIBank).
2022-09-20 18:19:37.563 +01:00 [DBG] Execution plan of authorization filters (in the following order): ["APIBank.Authorization.AuthorizeAttribute"]
2022-09-20 18:19:37.565 +01:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2022-09-20 18:19:37.566 +01:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2022-09-20 18:19:37.568 +01:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2022-09-20 18:19:37.570 +01:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2022-09-20 18:19:37.571 +01:00 [DBG] Executing controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-20 18:19:37.572 +01:00 [DBG] Executed controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-20 18:19:37.575 +01:00 [DBG] Attempting to bind parameter 'id' of type 'System.Int32' ...
2022-09-20 18:19:37.578 +01:00 [DBG] Attempting to bind parameter 'id' of type 'System.Int32' using the name 'id' in request data ...
2022-09-20 18:19:37.580 +01:00 [DBG] Done attempting to bind parameter 'id' of type 'System.Int32'.
2022-09-20 18:19:37.581 +01:00 [DBG] Done attempting to bind parameter 'id' of type 'System.Int32'.
2022-09-20 18:19:37.582 +01:00 [DBG] Attempting to validate the bound parameter 'id' of type 'System.Int32' ...
2022-09-20 18:19:37.584 +01:00 [DBG] Done attempting to validate the bound parameter 'id' of type 'System.Int32'.
2022-09-20 18:19:37.587 +01:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2022-09-20 18:19:37.592 +01:00 [DBG] No information found on request to perform content negotiation.
2022-09-20 18:19:37.593 +01:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2022-09-20 18:19:37.594 +01:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2022-09-20 18:19:37.596 +01:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2022-09-20 18:19:37.598 +01:00 [INF] Executing OkObjectResult, writing value of type 'Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryable`1[[APIBank.ModelEntities.RefreshToken, APIBank, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2022-09-20 18:19:37.615 +01:00 [DBG] Compiling query expression: 
'DbSet<RefreshToken>()
    .Where(rt => rt.UserId == __id_0)
    .AsNoTracking()
    .Select(rt => new RefreshToken{ 
        Id = rt.Id, 
        UserId = rt.UserId, 
        RefToken = rt.RefToken, 
        Expires = rt.Expires, 
        Created = rt.Created, 
        CreatedByIp = rt.CreatedByIp, 
        Revoked = rt.Revoked, 
        RevokedByIp = rt.RevokedByIp, 
        ReplacedByToken = rt.ReplacedByToken, 
        ReasonRevoked = rt.ReasonRevoked, 
        IsExpired = rt.IsExpired, 
        IsRevoked = rt.IsRevoked, 
        IsActive = rt.IsActive 
    }
    )'
2022-09-20 18:19:37.626 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<RefreshToken>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            Id -> 0
            UserId -> 1
            RefToken -> 2
            Expires -> 3
            Created -> 4
            CreatedByIp -> 5
            Revoked -> 6
            RevokedByIp -> 7
            ReplacedByToken -> 8
            ReasonRevoked -> 9
            IsExpired -> 10
            IsRevoked -> 11
            IsActive -> 12
        SELECT r.id AS Id, r.user_id AS UserId, r.token AS RefToken, r.expires AS Expires, r.created AS Created, r.created_by_ip AS CreatedByIp, r.revoked AS Revoked, r.revoked_by_ip AS RevokedByIp, r.replaced_by_token AS ReplacedByToken, r.reason_revoked AS ReasonRevoked, r.is_expired AS IsExpired, r.is_revoked AS IsRevoked, r.is_active AS IsActive
        FROM refresh_token AS r
        WHERE r.user_id == @__id_0), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, RefreshToken>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)'
2022-09-20 18:19:37.658 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-20 18:19:37.660 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2022-09-20 18:19:37.677 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-20 18:19:37.682 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-20 18:19:37.689 +01:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.user_id AS "UserId", r.token AS "RefToken", r.expires AS "Expires", r.created AS "Created", r.created_by_ip AS "CreatedByIp", r.revoked AS "Revoked", r.revoked_by_ip AS "RevokedByIp", r.replaced_by_token AS "ReplacedByToken", r.reason_revoked AS "ReasonRevoked", r.is_expired AS "IsExpired", r.is_revoked AS "IsRevoked", r.is_active AS "IsActive"
FROM refresh_token AS r
WHERE r.user_id = @__id_0
2022-09-20 18:19:37.705 +01:00 [INF] Executed DbCommand (17ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.user_id AS "UserId", r.token AS "RefToken", r.expires AS "Expires", r.created AS "Created", r.created_by_ip AS "CreatedByIp", r.revoked AS "Revoked", r.revoked_by_ip AS "RevokedByIp", r.replaced_by_token AS "ReplacedByToken", r.reason_revoked AS "ReasonRevoked", r.is_expired AS "IsExpired", r.is_revoked AS "IsRevoked", r.is_active AS "IsActive"
FROM refresh_token AS r
WHERE r.user_id = @__id_0
2022-09-20 18:19:37.721 +01:00 [DBG] A data reader was disposed.
2022-09-20 18:19:37.735 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-20 18:19:37.738 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-20 18:19:37.741 +01:00 [INF] Executed action APIBank.Controllers.UsersController.GetRefreshTokens (APIBank) in 170.3227ms
2022-09-20 18:19:37.743 +01:00 [INF] Executed endpoint 'APIBank.Controllers.UsersController.GetRefreshTokens (APIBank)'
2022-09-20 18:19:37.744 +01:00 [DBG] 'PostgresContext' disposed.
2022-09-20 18:19:37.745 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/api/Users/1/refresh-tokens - - - 200 - application/json;+charset=utf-8 409.4116ms
2022-09-20 18:20:40.247 +01:00 [INF] Request starting HTTP/2 POST https://localhost:7036/api/Users/revoke-token application/json 105
2022-09-20 18:20:40.262 +01:00 [DBG] 1 candidate(s) found for the request path '/api/Users/revoke-token'
2022-09-20 18:20:40.265 +01:00 [DBG] Endpoint 'APIBank.Controllers.UsersController.RevokeToken (APIBank)' with route pattern 'api/Users/revoke-token' is valid for the request path '/api/Users/revoke-token'
2022-09-20 18:20:40.266 +01:00 [DBG] Request matched endpoint 'APIBank.Controllers.UsersController.RevokeToken (APIBank)'
2022-09-20 18:20:40.266 +01:00 [DBG] Static files was skipped as the request already matched an endpoint.
2022-09-20 18:20:40.320 +01:00 [INF] Entity Framework Core 6.0.9 initialized 'PostgresContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:6.0.7+5b98e4b74de93b590b44aef8dd7967c03acc433c' with options: None
2022-09-20 18:20:40.333 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-20 18:20:40.335 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2022-09-20 18:20:40.339 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-20 18:20:40.341 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-20 18:20:40.345 +01:00 [DBG] Executing DbCommand [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.id = @__p_0
LIMIT 1
2022-09-20 18:20:40.350 +01:00 [INF] Executed DbCommand (5ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.id = @__p_0
LIMIT 1
2022-09-20 18:20:40.355 +01:00 [DBG] Context 'PostgresContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-20 18:20:40.358 +01:00 [DBG] A data reader was disposed.
2022-09-20 18:20:40.361 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-20 18:20:40.363 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-20 18:20:40.365 +01:00 [INF] Executing endpoint 'APIBank.Controllers.UsersController.RevokeToken (APIBank)'
2022-09-20 18:20:40.368 +01:00 [INF] Route matched with {action = "RevokeToken", controller = "Users"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult RevokeToken(APIBank.Models.Users.Requests.RevokeTokenRequest) on controller APIBank.Controllers.UsersController (APIBank).
2022-09-20 18:20:40.371 +01:00 [DBG] Execution plan of authorization filters (in the following order): ["APIBank.Authorization.AuthorizeAttribute"]
2022-09-20 18:20:40.373 +01:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2022-09-20 18:20:40.377 +01:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2022-09-20 18:20:40.378 +01:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2022-09-20 18:20:40.379 +01:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2022-09-20 18:20:40.380 +01:00 [DBG] Executing controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-20 18:20:40.381 +01:00 [DBG] Executed controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-20 18:20:40.382 +01:00 [DBG] Attempting to bind parameter 'model' of type 'APIBank.Models.Users.Requests.RevokeTokenRequest' ...
2022-09-20 18:20:40.384 +01:00 [DBG] Attempting to bind parameter 'model' of type 'APIBank.Models.Users.Requests.RevokeTokenRequest' using the name '' in request data ...
2022-09-20 18:20:40.386 +01:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2022-09-20 18:20:40.388 +01:00 [DBG] Connection id "0HMKR5GMN1PC7", Request id "0HMKR5GMN1PC7:0000000D": started reading request body.
2022-09-20 18:20:40.390 +01:00 [DBG] Connection id "0HMKR5GMN1PC7", Request id "0HMKR5GMN1PC7:0000000D": done reading request body.
2022-09-20 18:20:40.393 +01:00 [DBG] JSON input formatter succeeded, deserializing to type 'APIBank.Models.Users.Requests.RevokeTokenRequest'
2022-09-20 18:20:40.394 +01:00 [DBG] Done attempting to bind parameter 'model' of type 'APIBank.Models.Users.Requests.RevokeTokenRequest'.
2022-09-20 18:20:40.395 +01:00 [DBG] Done attempting to bind parameter 'model' of type 'APIBank.Models.Users.Requests.RevokeTokenRequest'.
2022-09-20 18:20:40.396 +01:00 [DBG] Attempting to validate the bound parameter 'model' of type 'APIBank.Models.Users.Requests.RevokeTokenRequest' ...
2022-09-20 18:20:40.397 +01:00 [DBG] Done attempting to validate the bound parameter 'model' of type 'APIBank.Models.Users.Requests.RevokeTokenRequest'.
2022-09-20 18:20:40.399 +01:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .SingleOrDefault(userQuery => userQuery.RefreshTokenCollection
        .Any(refTokenQuery => refTokenQuery.RefToken == __refToken_0))'
2022-09-20 18:20:40.405 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<User>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: User.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: User.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 1], [Property: User.Email (string) Required Index MaxLength(254), 2], [Property: User.FullName (string) Required MaxLength(100), 3], [Property: User.PasswordChangedAt (DateTime) Required ValueGenerated.OnAdd, 4], [Property: User.PasswordHash (string) Required MaxLength(200), 5], [Property: User.Username (string) Required Index MaxLength(50), 6] }
        SELECT TOP(2) u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
        FROM users AS u
        WHERE EXISTS (
            SELECT 1
            FROM refresh_token AS r
            WHERE ((u.id != NULL) && (u.id == r.user_id)) && (r.token == @__refToken_0))), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, User>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)
    .SingleOrDefault()'
2022-09-20 18:20:40.409 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-20 18:20:40.410 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2022-09-20 18:20:40.411 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-20 18:20:40.411 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-20 18:20:40.412 +01:00 [DBG] Executing DbCommand [Parameters=[@__refToken_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE EXISTS (
    SELECT 1
    FROM refresh_token AS r
    WHERE (u.id = r.user_id) AND (r.token = @__refToken_0))
LIMIT 2
2022-09-20 18:20:40.414 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[@__refToken_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE EXISTS (
    SELECT 1
    FROM refresh_token AS r
    WHERE (u.id = r.user_id) AND (r.token = @__refToken_0))
LIMIT 2
2022-09-20 18:20:40.416 +01:00 [DBG] A data reader was disposed.
2022-09-20 18:20:40.417 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-20 18:20:40.418 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-20 18:20:40.422 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-20 18:20:40.424 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2022-09-20 18:20:40.426 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-20 18:20:40.427 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-20 18:20:40.428 +01:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.user_id AS "UserId", r.token AS "RefToken", r.expires AS "Expires", r.created AS "Created", r.created_by_ip AS "CreatedByIp", r.revoked AS "Revoked", r.revoked_by_ip AS "RevokedByIp", r.replaced_by_token AS "ReplacedByToken", r.reason_revoked AS "ReasonRevoked", r.is_expired AS "IsExpired", r.is_revoked AS "IsRevoked", r.is_active AS "IsActive"
FROM refresh_token AS r
WHERE r.user_id = @__id_0
2022-09-20 18:20:40.430 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.user_id AS "UserId", r.token AS "RefToken", r.expires AS "Expires", r.created AS "Created", r.created_by_ip AS "CreatedByIp", r.revoked AS "Revoked", r.revoked_by_ip AS "RevokedByIp", r.replaced_by_token AS "ReplacedByToken", r.reason_revoked AS "ReasonRevoked", r.is_expired AS "IsExpired", r.is_revoked AS "IsRevoked", r.is_active AS "IsActive"
FROM refresh_token AS r
WHERE r.user_id = @__id_0
2022-09-20 18:20:40.432 +01:00 [DBG] A data reader was disposed.
2022-09-20 18:20:40.433 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-20 18:20:40.434 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-20 18:20:40.436 +01:00 [DBG] An entity of type 'User' tracked by 'PostgresContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-20 18:20:40.438 +01:00 [DBG] SaveChanges starting for 'PostgresContext'.
2022-09-20 18:20:40.440 +01:00 [DBG] DetectChanges starting for 'PostgresContext'.
2022-09-20 18:20:40.442 +01:00 [DBG] DetectChanges completed for 'PostgresContext'.
2022-09-20 18:20:40.443 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-20 18:20:40.444 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-20 18:20:40.445 +01:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2022-09-20 18:20:40.446 +01:00 [DBG] Began transaction with isolation level 'ReadCommitted'.
2022-09-20 18:20:40.447 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-20 18:20:40.448 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2022-09-20 18:20:40.449 +01:00 [DBG] Executing DbCommand [Parameters=[@p6='?' (DbType = Int32), @p0='?' (DbType = DateTime), @p1='?', @p2='?', @p3='?' (DbType = DateTime), @p4='?', @p5='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE users SET created_at = @p0, email = @p1, full_name = @p2, password_changed_at = @p3, password_hash = @p4, username = @p5
WHERE id = @p6;
2022-09-20 18:20:40.452 +01:00 [INF] Executed DbCommand (3ms) [Parameters=[@p6='?' (DbType = Int32), @p0='?' (DbType = DateTime), @p1='?', @p2='?', @p3='?' (DbType = DateTime), @p4='?', @p5='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE users SET created_at = @p0, email = @p1, full_name = @p2, password_changed_at = @p3, password_hash = @p4, username = @p5
WHERE id = @p6;
2022-09-20 18:20:40.454 +01:00 [DBG] A data reader was disposed.
2022-09-20 18:20:40.455 +01:00 [DBG] Committing transaction.
2022-09-20 18:20:40.460 +01:00 [DBG] Committed transaction.
2022-09-20 18:20:40.461 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-20 18:20:40.462 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-20 18:20:40.463 +01:00 [DBG] Disposing transaction.
2022-09-20 18:20:40.464 +01:00 [DBG] An entity of type 'User' tracked by 'PostgresContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-20 18:20:40.466 +01:00 [DBG] SaveChanges completed for 'PostgresContext' with 1 entities written to the database.
2022-09-20 18:20:40.467 +01:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2022-09-20 18:20:40.469 +01:00 [DBG] No information found on request to perform content negotiation.
2022-09-20 18:20:40.470 +01:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2022-09-20 18:20:40.471 +01:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2022-09-20 18:20:40.473 +01:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2022-09-20 18:20:40.475 +01:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType0`1[[System.String, System.Private.CoreLib, Version=6.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2022-09-20 18:20:40.478 +01:00 [INF] Executed action APIBank.Controllers.UsersController.RevokeToken (APIBank) in 97.3964ms
2022-09-20 18:20:40.479 +01:00 [INF] Executed endpoint 'APIBank.Controllers.UsersController.RevokeToken (APIBank)'
2022-09-20 18:20:40.480 +01:00 [DBG] 'PostgresContext' disposed.
2022-09-20 18:20:40.481 +01:00 [INF] Request finished HTTP/2 POST https://localhost:7036/api/Users/revoke-token application/json 105 - 200 - application/json;+charset=utf-8 234.4198ms
2022-09-20 18:20:45.410 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/api/Users/1/refresh-tokens - -
2022-09-20 18:20:45.412 +01:00 [DBG] 1 candidate(s) found for the request path '/api/Users/1/refresh-tokens'
2022-09-20 18:20:45.413 +01:00 [DBG] Endpoint 'APIBank.Controllers.UsersController.GetRefreshTokens (APIBank)' with route pattern 'api/Users/{id}/refresh-tokens' is valid for the request path '/api/Users/1/refresh-tokens'
2022-09-20 18:20:45.415 +01:00 [DBG] Request matched endpoint 'APIBank.Controllers.UsersController.GetRefreshTokens (APIBank)'
2022-09-20 18:20:45.416 +01:00 [DBG] Static files was skipped as the request already matched an endpoint.
2022-09-20 18:20:45.418 +01:00 [INF] Entity Framework Core 6.0.9 initialized 'PostgresContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:6.0.7+5b98e4b74de93b590b44aef8dd7967c03acc433c' with options: None
2022-09-20 18:20:45.422 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-20 18:20:45.426 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (3ms).
2022-09-20 18:20:45.427 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-20 18:20:45.429 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-20 18:20:45.430 +01:00 [DBG] Executing DbCommand [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.id = @__p_0
LIMIT 1
2022-09-20 18:20:45.437 +01:00 [INF] Executed DbCommand (7ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.id = @__p_0
LIMIT 1
2022-09-20 18:20:45.439 +01:00 [DBG] Context 'PostgresContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-20 18:20:45.441 +01:00 [DBG] A data reader was disposed.
2022-09-20 18:20:45.441 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-20 18:20:45.442 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-20 18:20:45.443 +01:00 [INF] Executing endpoint 'APIBank.Controllers.UsersController.GetRefreshTokens (APIBank)'
2022-09-20 18:20:45.444 +01:00 [INF] Route matched with {action = "GetRefreshTokens", controller = "Users"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult GetRefreshTokens(Int32) on controller APIBank.Controllers.UsersController (APIBank).
2022-09-20 18:20:45.446 +01:00 [DBG] Execution plan of authorization filters (in the following order): ["APIBank.Authorization.AuthorizeAttribute"]
2022-09-20 18:20:45.448 +01:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2022-09-20 18:20:45.451 +01:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2022-09-20 18:20:45.455 +01:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2022-09-20 18:20:45.457 +01:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2022-09-20 18:20:45.458 +01:00 [DBG] Executing controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-20 18:20:45.459 +01:00 [DBG] Executed controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-20 18:20:45.460 +01:00 [DBG] Attempting to bind parameter 'id' of type 'System.Int32' ...
2022-09-20 18:20:45.461 +01:00 [DBG] Attempting to bind parameter 'id' of type 'System.Int32' using the name 'id' in request data ...
2022-09-20 18:20:45.463 +01:00 [DBG] Done attempting to bind parameter 'id' of type 'System.Int32'.
2022-09-20 18:20:45.470 +01:00 [DBG] Done attempting to bind parameter 'id' of type 'System.Int32'.
2022-09-20 18:20:45.472 +01:00 [DBG] Attempting to validate the bound parameter 'id' of type 'System.Int32' ...
2022-09-20 18:20:45.473 +01:00 [DBG] Done attempting to validate the bound parameter 'id' of type 'System.Int32'.
2022-09-20 18:20:45.475 +01:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2022-09-20 18:20:45.478 +01:00 [DBG] No information found on request to perform content negotiation.
2022-09-20 18:20:45.479 +01:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2022-09-20 18:20:45.480 +01:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2022-09-20 18:20:45.482 +01:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2022-09-20 18:20:45.486 +01:00 [INF] Executing OkObjectResult, writing value of type 'Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryable`1[[APIBank.ModelEntities.RefreshToken, APIBank, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2022-09-20 18:20:45.488 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-20 18:20:45.489 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2022-09-20 18:20:45.490 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-20 18:20:45.491 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-20 18:20:45.492 +01:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.user_id AS "UserId", r.token AS "RefToken", r.expires AS "Expires", r.created AS "Created", r.created_by_ip AS "CreatedByIp", r.revoked AS "Revoked", r.revoked_by_ip AS "RevokedByIp", r.replaced_by_token AS "ReplacedByToken", r.reason_revoked AS "ReasonRevoked", r.is_expired AS "IsExpired", r.is_revoked AS "IsRevoked", r.is_active AS "IsActive"
FROM refresh_token AS r
WHERE r.user_id = @__id_0
2022-09-20 18:20:45.508 +01:00 [INF] Executed DbCommand (16ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.user_id AS "UserId", r.token AS "RefToken", r.expires AS "Expires", r.created AS "Created", r.created_by_ip AS "CreatedByIp", r.revoked AS "Revoked", r.revoked_by_ip AS "RevokedByIp", r.replaced_by_token AS "ReplacedByToken", r.reason_revoked AS "ReasonRevoked", r.is_expired AS "IsExpired", r.is_revoked AS "IsRevoked", r.is_active AS "IsActive"
FROM refresh_token AS r
WHERE r.user_id = @__id_0
2022-09-20 18:20:45.518 +01:00 [DBG] A data reader was disposed.
2022-09-20 18:20:45.519 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-20 18:20:45.525 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-20 18:20:45.533 +01:00 [INF] Executed action APIBank.Controllers.UsersController.GetRefreshTokens (APIBank) in 74.7654ms
2022-09-20 18:20:45.537 +01:00 [INF] Executed endpoint 'APIBank.Controllers.UsersController.GetRefreshTokens (APIBank)'
2022-09-20 18:20:45.541 +01:00 [DBG] 'PostgresContext' disposed.
2022-09-20 18:20:45.542 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/api/Users/1/refresh-tokens - - - 200 - application/json;+charset=utf-8 131.9204ms
2022-09-20 18:27:10.473 +01:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2022-09-20 18:27:10.685 +01:00 [DBG] Hosting starting
2022-09-20 18:27:11.055 +01:00 [DBG] Using development certificate: CN=localhost (Thumbprint: 9CC642E9838495A6C3C202DECA6A8AD300396DD2)
2022-09-20 18:27:11.175 +01:00 [INF] Now listening on: https://localhost:7036
2022-09-20 18:27:11.261 +01:00 [INF] Now listening on: http://localhost:5036
2022-09-20 18:27:11.262 +01:00 [DBG] Loaded hosting startup assembly APIBank
2022-09-20 18:27:11.263 +01:00 [DBG] Loaded hosting startup assembly Microsoft.AspNetCore.Watch.BrowserRefresh
2022-09-20 18:27:11.264 +01:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.BrowserLink.Net
2022-09-20 18:27:11.269 +01:00 [INF] Application started. Press Ctrl+C to shut down.
2022-09-20 18:27:11.271 +01:00 [INF] Hosting environment: Development
2022-09-20 18:27:11.272 +01:00 [INF] Content root path: C:\Users\mguedesa\OneDrive - NTT DATA EMEAL\Documentos\GitHub\OpenBankAPI-NTT\APIBank\APIBank\
2022-09-20 18:27:11.273 +01:00 [DBG] Hosting started
2022-09-20 18:27:11.625 +01:00 [DBG] Connection id "0HMKR5LD3SG62" accepted.
2022-09-20 18:27:11.625 +01:00 [DBG] Connection id "0HMKR5LD3SG63" accepted.
2022-09-20 18:27:11.631 +01:00 [DBG] Connection id "0HMKR5LD3SG62" started.
2022-09-20 18:27:11.631 +01:00 [DBG] Connection id "0HMKR5LD3SG63" started.
2022-09-20 18:27:11.635 +01:00 [DBG] Connection id "0HMKR5LD3SG63" received FIN.
2022-09-20 18:27:11.635 +01:00 [DBG] Connection id "0HMKR5LD3SG62" received FIN.
2022-09-20 18:27:11.662 +01:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException:  Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveBlobAsync[TIOAdapter](TIOAdapter adapter)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](TIOAdapter adapter, Boolean receiveFirst, Byte[] reAuthenticationData, Boolean isApm)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2022-09-20 18:27:11.662 +01:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException:  Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveBlobAsync[TIOAdapter](TIOAdapter adapter)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](TIOAdapter adapter, Boolean receiveFirst, Byte[] reAuthenticationData, Boolean isApm)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2022-09-20 18:27:11.713 +01:00 [DBG] Connection id "0HMKR5LD3SG62" stopped.
2022-09-20 18:27:11.713 +01:00 [DBG] Connection id "0HMKR5LD3SG63" stopped.
2022-09-20 18:27:11.716 +01:00 [DBG] Connection id "0HMKR5LD3SG62" sending FIN because: "The Socket transport's send loop completed gracefully."
2022-09-20 18:27:11.716 +01:00 [DBG] Connection id "0HMKR5LD3SG63" sending FIN because: "The Socket transport's send loop completed gracefully."
2022-09-20 18:27:12.224 +01:00 [DBG] Connection id "0HMKR5LD3SG64" accepted.
2022-09-20 18:27:12.229 +01:00 [DBG] Connection id "0HMKR5LD3SG64" started.
2022-09-20 18:27:12.337 +01:00 [DBG] Connection 0HMKR5LD3SG64 established using the following protocol: "Tls12"
2022-09-20 18:27:12.499 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/swagger/index.html - -
2022-09-20 18:27:12.566 +01:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2022-09-20 18:27:12.596 +01:00 [DBG] No candidates found for the request path '/swagger/index.html'
2022-09-20 18:27:12.598 +01:00 [DBG] Request did not match any endpoints
2022-09-20 18:27:12.747 +01:00 [DBG] Response markup is scheduled to include browser refresh script injection.
2022-09-20 18:27:12.919 +01:00 [DBG] Response markup was updated to include browser refresh script injection.
2022-09-20 18:27:12.931 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/swagger/index.html - - - 200 - text/html;charset=utf-8 437.9588ms
2022-09-20 18:27:12.957 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/_vs/browserLink - -
2022-09-20 18:27:12.957 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/_framework/aspnetcore-browser-refresh.js - -
2022-09-20 18:27:12.968 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/_framework/aspnetcore-browser-refresh.js - - - 200 11984 application/javascript;+charset=utf-8 10.5897ms
2022-09-20 18:27:12.984 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/_vs/browserLink - - - 200 - text/javascript;+charset=UTF-8 27.0645ms
2022-09-20 18:27:13.076 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/swagger/v1/swagger.json - -
2022-09-20 18:27:13.078 +01:00 [DBG] No candidates found for the request path '/swagger/v1/swagger.json'
2022-09-20 18:27:13.079 +01:00 [DBG] Request did not match any endpoints
2022-09-20 18:27:13.273 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/swagger/v1/swagger.json - - - 200 - application/json;charset=utf-8 196.4747ms
2022-09-20 18:27:26.486 +01:00 [INF] Request starting HTTP/2 POST https://localhost:7036/api/Users/Login application/json 58
2022-09-20 18:27:26.509 +01:00 [DBG] 1 candidate(s) found for the request path '/api/Users/Login'
2022-09-20 18:27:26.516 +01:00 [DBG] Endpoint 'APIBank.Controllers.UsersController.Login (APIBank)' with route pattern 'api/Users/Login' is valid for the request path '/api/Users/Login'
2022-09-20 18:27:26.521 +01:00 [DBG] Request matched endpoint 'APIBank.Controllers.UsersController.Login (APIBank)'
2022-09-20 18:27:26.525 +01:00 [DBG] Static files was skipped as the request already matched an endpoint.
2022-09-20 18:27:27.107 +01:00 [INF] Executing endpoint 'APIBank.Controllers.UsersController.Login (APIBank)'
2022-09-20 18:27:27.142 +01:00 [INF] Route matched with {action = "Login", controller = "Users"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult Login(APIBank.Models.Requests.LoginRequest) on controller APIBank.Controllers.UsersController (APIBank).
2022-09-20 18:27:27.145 +01:00 [DBG] Execution plan of authorization filters (in the following order): ["APIBank.Authorization.AuthorizeAttribute"]
2022-09-20 18:27:27.148 +01:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2022-09-20 18:27:27.150 +01:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2022-09-20 18:27:27.152 +01:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2022-09-20 18:27:27.153 +01:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2022-09-20 18:27:27.156 +01:00 [DBG] Executing controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-20 18:27:27.158 +01:00 [DBG] Executed controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-20 18:27:27.174 +01:00 [DBG] Attempting to bind parameter 'model' of type 'APIBank.Models.Requests.LoginRequest' ...
2022-09-20 18:27:27.178 +01:00 [DBG] Attempting to bind parameter 'model' of type 'APIBank.Models.Requests.LoginRequest' using the name '' in request data ...
2022-09-20 18:27:27.182 +01:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2022-09-20 18:27:27.190 +01:00 [DBG] Connection id "0HMKR5LD3SG64", Request id "0HMKR5LD3SG64:00000009": started reading request body.
2022-09-20 18:27:27.192 +01:00 [DBG] Connection id "0HMKR5LD3SG64", Request id "0HMKR5LD3SG64:00000009": done reading request body.
2022-09-20 18:27:27.203 +01:00 [DBG] JSON input formatter succeeded, deserializing to type 'APIBank.Models.Requests.LoginRequest'
2022-09-20 18:27:27.205 +01:00 [DBG] Done attempting to bind parameter 'model' of type 'APIBank.Models.Requests.LoginRequest'.
2022-09-20 18:27:27.207 +01:00 [DBG] Done attempting to bind parameter 'model' of type 'APIBank.Models.Requests.LoginRequest'.
2022-09-20 18:27:27.208 +01:00 [DBG] Attempting to validate the bound parameter 'model' of type 'APIBank.Models.Requests.LoginRequest' ...
2022-09-20 18:27:27.225 +01:00 [DBG] Done attempting to validate the bound parameter 'model' of type 'APIBank.Models.Requests.LoginRequest'.
2022-09-20 18:27:27.363 +01:00 [DBG] An additional 'IServiceProvider' was created for internal use by Entity Framework. An existing service provider was not used due to the following configuration changes: configuration changed for 'Core:ConfigureWarnings', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:UseAdminDatabase', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:SetPostgresVersion', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:UseRedshift', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:ReverseNullOrdering', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:RemoteCertificateValidationCallback', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:ProvideClientCertificatesCallback', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:ProvidePasswordCallback'.
2022-09-20 18:27:29.151 +01:00 [INF] Entity Framework Core 6.0.9 initialized 'PostgresContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:6.0.7+5b98e4b74de93b590b44aef8dd7967c03acc433c' with options: None
2022-09-20 18:27:29.242 +01:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .SingleOrDefault(x => x.Username == __model_Username_0)'
2022-09-20 18:27:29.863 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<User>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: User.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: User.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 1], [Property: User.Email (string) Required Index MaxLength(254), 2], [Property: User.FullName (string) Required MaxLength(100), 3], [Property: User.PasswordChangedAt (DateTime) Required ValueGenerated.OnAdd, 4], [Property: User.PasswordHash (string) Required MaxLength(200), 5], [Property: User.Username (string) Required Index MaxLength(50), 6] }
        SELECT TOP(2) u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
        FROM users AS u
        WHERE u.username == @__model_Username_0), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, User>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)
    .SingleOrDefault()'
2022-09-20 18:27:29.962 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-20 18:27:30.149 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (171ms).
2022-09-20 18:27:30.166 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-20 18:27:30.590 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-20 18:27:30.621 +01:00 [DBG] Executing DbCommand [Parameters=[@__model_Username_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.username = @__model_Username_0
LIMIT 2
2022-09-20 18:27:30.780 +01:00 [INF] Executed DbCommand (169ms) [Parameters=[@__model_Username_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.username = @__model_Username_0
LIMIT 2
2022-09-20 18:27:30.864 +01:00 [DBG] Context 'PostgresContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-20 18:27:30.935 +01:00 [DBG] A data reader was disposed.
2022-09-20 18:27:30.943 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-20 18:27:30.956 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-20 18:27:31.462 +01:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .Any(user => user.RefreshTokenCollection
        .Any(reftoken => reftoken.RefToken == __token_0))'
2022-09-20 18:27:31.704 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<bool>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            EmptyProjectionMember -> 0
        SELECT EXISTS (
            SELECT 1
            FROM users AS u
            WHERE EXISTS (
                SELECT 1
                FROM refresh_token AS r
                WHERE ((u.id != NULL) && (u.id == r.user_id)) && (r.token == @__token_0)))), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, bool>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)
    .Single()'
2022-09-20 18:27:31.720 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-20 18:27:31.723 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (2ms).
2022-09-20 18:27:31.724 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-20 18:27:31.725 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-20 18:27:31.727 +01:00 [DBG] Executing DbCommand [Parameters=[@__token_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM users AS u
    WHERE EXISTS (
        SELECT 1
        FROM refresh_token AS r
        WHERE (u.id = r.user_id) AND (r.token = @__token_0)))
2022-09-20 18:27:31.730 +01:00 [INF] Executed DbCommand (3ms) [Parameters=[@__token_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM users AS u
    WHERE EXISTS (
        SELECT 1
        FROM refresh_token AS r
        WHERE (u.id = r.user_id) AND (r.token = @__token_0)))
2022-09-20 18:27:31.736 +01:00 [DBG] A data reader was disposed.
2022-09-20 18:27:31.737 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-20 18:27:31.738 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-20 18:27:31.752 +01:00 [DBG] Compiling query expression: 
'DbSet<RefreshToken>()
    .Where(rt => rt.UserId == __id_0)
    .AsNoTracking()
    .Select(rt => new RefreshToken{ 
        Id = rt.Id, 
        UserId = rt.UserId, 
        RefToken = rt.RefToken, 
        Expires = rt.Expires, 
        Created = rt.Created, 
        CreatedByIp = rt.CreatedByIp, 
        Revoked = rt.Revoked, 
        RevokedByIp = rt.RevokedByIp, 
        ReplacedByToken = rt.ReplacedByToken, 
        ReasonRevoked = rt.ReasonRevoked, 
        IsExpired = rt.IsExpired, 
        IsRevoked = rt.IsRevoked, 
        IsActive = rt.IsActive 
    }
    )'
2022-09-20 18:27:31.789 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<RefreshToken>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            Id -> 0
            UserId -> 1
            RefToken -> 2
            Expires -> 3
            Created -> 4
            CreatedByIp -> 5
            Revoked -> 6
            RevokedByIp -> 7
            ReplacedByToken -> 8
            ReasonRevoked -> 9
            IsExpired -> 10
            IsRevoked -> 11
            IsActive -> 12
        SELECT r.id AS Id, r.user_id AS UserId, r.token AS RefToken, r.expires AS Expires, r.created AS Created, r.created_by_ip AS CreatedByIp, r.revoked AS Revoked, r.revoked_by_ip AS RevokedByIp, r.replaced_by_token AS ReplacedByToken, r.reason_revoked AS ReasonRevoked, r.is_expired AS IsExpired, r.is_revoked AS IsRevoked, r.is_active AS IsActive
        FROM refresh_token AS r
        WHERE r.user_id == @__id_0), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, RefreshToken>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)'
2022-09-20 18:27:31.795 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-20 18:27:31.798 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (2ms).
2022-09-20 18:27:31.801 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-20 18:27:31.802 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-20 18:27:31.803 +01:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.user_id AS "UserId", r.token AS "RefToken", r.expires AS "Expires", r.created AS "Created", r.created_by_ip AS "CreatedByIp", r.revoked AS "Revoked", r.revoked_by_ip AS "RevokedByIp", r.replaced_by_token AS "ReplacedByToken", r.reason_revoked AS "ReasonRevoked", r.is_expired AS "IsExpired", r.is_revoked AS "IsRevoked", r.is_active AS "IsActive"
FROM refresh_token AS r
WHERE r.user_id = @__id_0
2022-09-20 18:27:31.813 +01:00 [INF] Executed DbCommand (10ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.user_id AS "UserId", r.token AS "RefToken", r.expires AS "Expires", r.created AS "Created", r.created_by_ip AS "CreatedByIp", r.revoked AS "Revoked", r.revoked_by_ip AS "RevokedByIp", r.replaced_by_token AS "ReplacedByToken", r.reason_revoked AS "ReasonRevoked", r.is_expired AS "IsExpired", r.is_revoked AS "IsRevoked", r.is_active AS "IsActive"
FROM refresh_token AS r
WHERE r.user_id = @__id_0
2022-09-20 18:27:31.816 +01:00 [DBG] A data reader was disposed.
2022-09-20 18:27:31.817 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-20 18:27:31.818 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-20 18:27:31.838 +01:00 [DBG] An entity of type 'User' tracked by 'PostgresContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-20 18:27:31.894 +01:00 [DBG] 'PostgresContext' generated a temporary value for the property 'Id.RefreshToken'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-20 18:27:31.953 +01:00 [DBG] Context 'PostgresContext' started tracking 'RefreshToken' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-20 18:27:31.962 +01:00 [DBG] SaveChanges starting for 'PostgresContext'.
2022-09-20 18:27:31.968 +01:00 [DBG] DetectChanges starting for 'PostgresContext'.
2022-09-20 18:27:32.022 +01:00 [DBG] 1 entities were added and 0 entities were removed from navigation 'User.RefreshTokenCollection'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-20 18:27:32.041 +01:00 [DBG] The foreign key property 'RefreshToken.UserId' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2022-09-20 18:27:32.088 +01:00 [DBG] DetectChanges completed for 'PostgresContext'.
2022-09-20 18:27:32.114 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-20 18:27:32.115 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-20 18:27:32.124 +01:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2022-09-20 18:27:32.147 +01:00 [DBG] Began transaction with isolation level 'ReadCommitted'.
2022-09-20 18:27:32.240 +01:00 [DBG] Executing 2 update commands as a batch.
2022-09-20 18:27:32.267 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-20 18:27:32.269 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2022-09-20 18:27:32.270 +01:00 [DBG] Executing DbCommand [Parameters=[@p0='?' (DbType = DateTime), @p1='?', @p2='?' (DbType = DateTime), @p3='?' (DbType = Boolean), @p4='?' (DbType = Boolean), @p5='?' (DbType = Boolean), @p6='?', @p7='?', @p8='?', @p9='?' (DbType = DateTime), @p10='?', @p11='?' (DbType = Int32), @p18='?' (DbType = Int32), @p12='?' (DbType = DateTime), @p13='?', @p14='?', @p15='?' (DbType = DateTime), @p16='?', @p17='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO refresh_token (created, created_by_ip, expires, is_active, is_expired, is_revoked, reason_revoked, token, replaced_by_token, revoked, revoked_by_ip, user_id)
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11)
RETURNING id;
UPDATE users SET created_at = @p12, email = @p13, full_name = @p14, password_changed_at = @p15, password_hash = @p16, username = @p17
WHERE id = @p18;
2022-09-20 18:27:32.287 +01:00 [INF] Executed DbCommand (16ms) [Parameters=[@p0='?' (DbType = DateTime), @p1='?', @p2='?' (DbType = DateTime), @p3='?' (DbType = Boolean), @p4='?' (DbType = Boolean), @p5='?' (DbType = Boolean), @p6='?', @p7='?', @p8='?', @p9='?' (DbType = DateTime), @p10='?', @p11='?' (DbType = Int32), @p18='?' (DbType = Int32), @p12='?' (DbType = DateTime), @p13='?', @p14='?', @p15='?' (DbType = DateTime), @p16='?', @p17='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO refresh_token (created, created_by_ip, expires, is_active, is_expired, is_revoked, reason_revoked, token, replaced_by_token, revoked, revoked_by_ip, user_id)
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11)
RETURNING id;
UPDATE users SET created_at = @p12, email = @p13, full_name = @p14, password_changed_at = @p15, password_hash = @p16, username = @p17
WHERE id = @p18;
2022-09-20 18:27:32.311 +01:00 [DBG] The foreign key property 'RefreshToken.Id' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2022-09-20 18:27:32.315 +01:00 [DBG] A data reader was disposed.
2022-09-20 18:27:32.321 +01:00 [DBG] Committing transaction.
2022-09-20 18:27:32.338 +01:00 [DBG] Committed transaction.
2022-09-20 18:27:32.343 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-20 18:27:32.345 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-20 18:27:32.353 +01:00 [DBG] Disposing transaction.
2022-09-20 18:27:32.360 +01:00 [DBG] An entity of type 'RefreshToken' tracked by 'PostgresContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-20 18:27:32.362 +01:00 [DBG] An entity of type 'User' tracked by 'PostgresContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-20 18:27:32.365 +01:00 [DBG] SaveChanges completed for 'PostgresContext' with 2 entities written to the database.
2022-09-20 18:27:32.371 +01:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2022-09-20 18:27:32.381 +01:00 [DBG] Attempting to select an output formatter based on Accept header '["text/plain"]'.
2022-09-20 18:27:32.383 +01:00 [DBG] Could not find an output formatter based on content negotiation. Accepted types were (["text/plain"])
2022-09-20 18:27:32.385 +01:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2022-09-20 18:27:32.386 +01:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2022-09-20 18:27:32.390 +01:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2022-09-20 18:27:32.393 +01:00 [INF] Executing OkObjectResult, writing value of type 'APIBank.Models.Users.Responses.LoginResponse'.
2022-09-20 18:27:32.424 +01:00 [INF] Executed action APIBank.Controllers.UsersController.Login (APIBank) in 5260.0639ms
2022-09-20 18:27:32.429 +01:00 [INF] Executed endpoint 'APIBank.Controllers.UsersController.Login (APIBank)'
2022-09-20 18:27:32.436 +01:00 [DBG] 'PostgresContext' disposed.
2022-09-20 18:27:32.446 +01:00 [INF] Request finished HTTP/2 POST https://localhost:7036/api/Users/Login application/json 58 - 200 - application/json;+charset=utf-8 5959.8804ms
2022-09-20 18:27:48.839 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/api/Users/1/refresh-tokens - -
2022-09-20 18:27:48.848 +01:00 [DBG] 1 candidate(s) found for the request path '/api/Users/1/refresh-tokens'
2022-09-20 18:27:48.851 +01:00 [DBG] Endpoint 'APIBank.Controllers.UsersController.GetRefreshTokens (APIBank)' with route pattern 'api/Users/{id}/refresh-tokens' is valid for the request path '/api/Users/1/refresh-tokens'
2022-09-20 18:27:48.853 +01:00 [DBG] Request matched endpoint 'APIBank.Controllers.UsersController.GetRefreshTokens (APIBank)'
2022-09-20 18:27:48.854 +01:00 [DBG] Static files was skipped as the request already matched an endpoint.
2022-09-20 18:27:49.002 +01:00 [INF] Entity Framework Core 6.0.9 initialized 'PostgresContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:6.0.7+5b98e4b74de93b590b44aef8dd7967c03acc433c' with options: None
2022-09-20 18:27:49.016 +01:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .FirstOrDefault(e => EF.Property<int>(e, "Id") == __p_0)'
2022-09-20 18:27:49.022 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<User>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: User.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: User.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 1], [Property: User.Email (string) Required Index MaxLength(254), 2], [Property: User.FullName (string) Required MaxLength(100), 3], [Property: User.PasswordChangedAt (DateTime) Required ValueGenerated.OnAdd, 4], [Property: User.PasswordHash (string) Required MaxLength(200), 5], [Property: User.Username (string) Required Index MaxLength(50), 6] }
        SELECT TOP(1) u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
        FROM users AS u
        WHERE u.id == @__p_0), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, User>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)
    .SingleOrDefault()'
2022-09-20 18:27:49.025 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-20 18:27:49.026 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2022-09-20 18:27:49.030 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-20 18:27:49.031 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-20 18:27:49.033 +01:00 [DBG] Executing DbCommand [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.id = @__p_0
LIMIT 1
2022-09-20 18:27:49.038 +01:00 [INF] Executed DbCommand (5ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.id = @__p_0
LIMIT 1
2022-09-20 18:27:49.039 +01:00 [DBG] Context 'PostgresContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-20 18:27:49.040 +01:00 [DBG] A data reader was disposed.
2022-09-20 18:27:49.041 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-20 18:27:49.041 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-20 18:27:49.042 +01:00 [INF] Executing endpoint 'APIBank.Controllers.UsersController.GetRefreshTokens (APIBank)'
2022-09-20 18:27:49.047 +01:00 [INF] Route matched with {action = "GetRefreshTokens", controller = "Users"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult GetRefreshTokens(Int32) on controller APIBank.Controllers.UsersController (APIBank).
2022-09-20 18:27:49.049 +01:00 [DBG] Execution plan of authorization filters (in the following order): ["APIBank.Authorization.AuthorizeAttribute"]
2022-09-20 18:27:49.054 +01:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2022-09-20 18:27:49.056 +01:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2022-09-20 18:27:49.058 +01:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2022-09-20 18:27:49.059 +01:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2022-09-20 18:27:49.063 +01:00 [DBG] Executing controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-20 18:27:49.066 +01:00 [DBG] Executed controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-20 18:27:49.068 +01:00 [DBG] Attempting to bind parameter 'id' of type 'System.Int32' ...
2022-09-20 18:27:49.070 +01:00 [DBG] Attempting to bind parameter 'id' of type 'System.Int32' using the name 'id' in request data ...
2022-09-20 18:27:49.073 +01:00 [DBG] Done attempting to bind parameter 'id' of type 'System.Int32'.
2022-09-20 18:27:49.074 +01:00 [DBG] Done attempting to bind parameter 'id' of type 'System.Int32'.
2022-09-20 18:27:49.076 +01:00 [DBG] Attempting to validate the bound parameter 'id' of type 'System.Int32' ...
2022-09-20 18:27:49.080 +01:00 [DBG] Done attempting to validate the bound parameter 'id' of type 'System.Int32'.
2022-09-20 18:27:49.085 +01:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2022-09-20 18:27:49.087 +01:00 [DBG] No information found on request to perform content negotiation.
2022-09-20 18:27:49.087 +01:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2022-09-20 18:27:49.088 +01:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2022-09-20 18:27:49.089 +01:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2022-09-20 18:27:49.090 +01:00 [INF] Executing OkObjectResult, writing value of type 'Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryable`1[[APIBank.ModelEntities.RefreshToken, APIBank, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2022-09-20 18:27:49.101 +01:00 [DBG] Compiling query expression: 
'DbSet<RefreshToken>()
    .Where(rt => rt.UserId == __id_0)
    .AsNoTracking()
    .Select(rt => new RefreshToken{ 
        Id = rt.Id, 
        UserId = rt.UserId, 
        RefToken = rt.RefToken, 
        Expires = rt.Expires, 
        Created = rt.Created, 
        CreatedByIp = rt.CreatedByIp, 
        Revoked = rt.Revoked, 
        RevokedByIp = rt.RevokedByIp, 
        ReplacedByToken = rt.ReplacedByToken, 
        ReasonRevoked = rt.ReasonRevoked, 
        IsExpired = rt.IsExpired, 
        IsRevoked = rt.IsRevoked, 
        IsActive = rt.IsActive 
    }
    )'
2022-09-20 18:27:49.107 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<RefreshToken>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            Id -> 0
            UserId -> 1
            RefToken -> 2
            Expires -> 3
            Created -> 4
            CreatedByIp -> 5
            Revoked -> 6
            RevokedByIp -> 7
            ReplacedByToken -> 8
            ReasonRevoked -> 9
            IsExpired -> 10
            IsRevoked -> 11
            IsActive -> 12
        SELECT r.id AS Id, r.user_id AS UserId, r.token AS RefToken, r.expires AS Expires, r.created AS Created, r.created_by_ip AS CreatedByIp, r.revoked AS Revoked, r.revoked_by_ip AS RevokedByIp, r.replaced_by_token AS ReplacedByToken, r.reason_revoked AS ReasonRevoked, r.is_expired AS IsExpired, r.is_revoked AS IsRevoked, r.is_active AS IsActive
        FROM refresh_token AS r
        WHERE r.user_id == @__id_0), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, RefreshToken>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)'
2022-09-20 18:27:49.136 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-20 18:27:49.138 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (2ms).
2022-09-20 18:27:49.148 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-20 18:27:49.151 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-20 18:27:49.154 +01:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.user_id AS "UserId", r.token AS "RefToken", r.expires AS "Expires", r.created AS "Created", r.created_by_ip AS "CreatedByIp", r.revoked AS "Revoked", r.revoked_by_ip AS "RevokedByIp", r.replaced_by_token AS "ReplacedByToken", r.reason_revoked AS "ReasonRevoked", r.is_expired AS "IsExpired", r.is_revoked AS "IsRevoked", r.is_active AS "IsActive"
FROM refresh_token AS r
WHERE r.user_id = @__id_0
2022-09-20 18:27:49.164 +01:00 [INF] Executed DbCommand (7ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.user_id AS "UserId", r.token AS "RefToken", r.expires AS "Expires", r.created AS "Created", r.created_by_ip AS "CreatedByIp", r.revoked AS "Revoked", r.revoked_by_ip AS "RevokedByIp", r.replaced_by_token AS "ReplacedByToken", r.reason_revoked AS "ReasonRevoked", r.is_expired AS "IsExpired", r.is_revoked AS "IsRevoked", r.is_active AS "IsActive"
FROM refresh_token AS r
WHERE r.user_id = @__id_0
2022-09-20 18:27:49.186 +01:00 [DBG] A data reader was disposed.
2022-09-20 18:27:49.197 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-20 18:27:49.200 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-20 18:27:49.201 +01:00 [INF] Executed action APIBank.Controllers.UsersController.GetRefreshTokens (APIBank) in 138.1923ms
2022-09-20 18:27:49.202 +01:00 [INF] Executed endpoint 'APIBank.Controllers.UsersController.GetRefreshTokens (APIBank)'
2022-09-20 18:27:49.203 +01:00 [DBG] 'PostgresContext' disposed.
2022-09-20 18:27:49.203 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/api/Users/1/refresh-tokens - - - 200 - application/json;+charset=utf-8 364.8025ms
2022-09-20 18:28:03.328 +01:00 [INF] Request starting HTTP/2 POST https://localhost:7036/api/Users/revoke-token application/json 105
2022-09-20 18:28:03.331 +01:00 [DBG] 1 candidate(s) found for the request path '/api/Users/revoke-token'
2022-09-20 18:28:03.333 +01:00 [DBG] Endpoint 'APIBank.Controllers.UsersController.RevokeToken (APIBank)' with route pattern 'api/Users/revoke-token' is valid for the request path '/api/Users/revoke-token'
2022-09-20 18:28:03.335 +01:00 [DBG] Request matched endpoint 'APIBank.Controllers.UsersController.RevokeToken (APIBank)'
2022-09-20 18:28:03.336 +01:00 [DBG] Static files was skipped as the request already matched an endpoint.
2022-09-20 18:28:03.395 +01:00 [INF] Entity Framework Core 6.0.9 initialized 'PostgresContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:6.0.7+5b98e4b74de93b590b44aef8dd7967c03acc433c' with options: None
2022-09-20 18:28:03.408 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-20 18:28:03.410 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (2ms).
2022-09-20 18:28:03.411 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-20 18:28:03.412 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-20 18:28:03.412 +01:00 [DBG] Executing DbCommand [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.id = @__p_0
LIMIT 1
2022-09-20 18:28:03.415 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.id = @__p_0
LIMIT 1
2022-09-20 18:28:03.419 +01:00 [DBG] Context 'PostgresContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-20 18:28:03.423 +01:00 [DBG] A data reader was disposed.
2022-09-20 18:28:03.424 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-20 18:28:03.424 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-20 18:28:03.425 +01:00 [INF] Executing endpoint 'APIBank.Controllers.UsersController.RevokeToken (APIBank)'
2022-09-20 18:28:03.427 +01:00 [INF] Route matched with {action = "RevokeToken", controller = "Users"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult RevokeToken(APIBank.Models.Users.Requests.RevokeTokenRequest) on controller APIBank.Controllers.UsersController (APIBank).
2022-09-20 18:28:03.428 +01:00 [DBG] Execution plan of authorization filters (in the following order): ["APIBank.Authorization.AuthorizeAttribute"]
2022-09-20 18:28:03.429 +01:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2022-09-20 18:28:03.430 +01:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2022-09-20 18:28:03.433 +01:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2022-09-20 18:28:03.435 +01:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2022-09-20 18:28:03.438 +01:00 [DBG] Executing controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-20 18:28:03.440 +01:00 [DBG] Executed controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-20 18:28:03.441 +01:00 [DBG] Attempting to bind parameter 'model' of type 'APIBank.Models.Users.Requests.RevokeTokenRequest' ...
2022-09-20 18:28:03.442 +01:00 [DBG] Attempting to bind parameter 'model' of type 'APIBank.Models.Users.Requests.RevokeTokenRequest' using the name '' in request data ...
2022-09-20 18:28:03.443 +01:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2022-09-20 18:28:03.444 +01:00 [DBG] Connection id "0HMKR5LD3SG64", Request id "0HMKR5LD3SG64:0000000D": started reading request body.
2022-09-20 18:28:03.445 +01:00 [DBG] Connection id "0HMKR5LD3SG64", Request id "0HMKR5LD3SG64:0000000D": done reading request body.
2022-09-20 18:28:03.446 +01:00 [DBG] JSON input formatter succeeded, deserializing to type 'APIBank.Models.Users.Requests.RevokeTokenRequest'
2022-09-20 18:28:03.449 +01:00 [DBG] Done attempting to bind parameter 'model' of type 'APIBank.Models.Users.Requests.RevokeTokenRequest'.
2022-09-20 18:28:03.450 +01:00 [DBG] Done attempting to bind parameter 'model' of type 'APIBank.Models.Users.Requests.RevokeTokenRequest'.
2022-09-20 18:28:03.453 +01:00 [DBG] Attempting to validate the bound parameter 'model' of type 'APIBank.Models.Users.Requests.RevokeTokenRequest' ...
2022-09-20 18:28:03.458 +01:00 [DBG] Done attempting to validate the bound parameter 'model' of type 'APIBank.Models.Users.Requests.RevokeTokenRequest'.
2022-09-20 18:28:03.460 +01:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .SingleOrDefault(userQuery => userQuery.RefreshTokenCollection
        .Any(refTokenQuery => refTokenQuery.RefToken == __refToken_0))'
2022-09-20 18:28:03.467 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<User>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: User.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: User.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 1], [Property: User.Email (string) Required Index MaxLength(254), 2], [Property: User.FullName (string) Required MaxLength(100), 3], [Property: User.PasswordChangedAt (DateTime) Required ValueGenerated.OnAdd, 4], [Property: User.PasswordHash (string) Required MaxLength(200), 5], [Property: User.Username (string) Required Index MaxLength(50), 6] }
        SELECT TOP(2) u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
        FROM users AS u
        WHERE EXISTS (
            SELECT 1
            FROM refresh_token AS r
            WHERE ((u.id != NULL) && (u.id == r.user_id)) && (r.token == @__refToken_0))), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, User>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)
    .SingleOrDefault()'
2022-09-20 18:28:03.470 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-20 18:28:03.472 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2022-09-20 18:28:03.473 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-20 18:28:03.474 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-20 18:28:03.475 +01:00 [DBG] Executing DbCommand [Parameters=[@__refToken_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE EXISTS (
    SELECT 1
    FROM refresh_token AS r
    WHERE (u.id = r.user_id) AND (r.token = @__refToken_0))
LIMIT 2
2022-09-20 18:28:03.477 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[@__refToken_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE EXISTS (
    SELECT 1
    FROM refresh_token AS r
    WHERE (u.id = r.user_id) AND (r.token = @__refToken_0))
LIMIT 2
2022-09-20 18:28:03.478 +01:00 [DBG] A data reader was disposed.
2022-09-20 18:28:03.479 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-20 18:28:03.480 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-20 18:28:03.486 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-20 18:28:03.488 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2022-09-20 18:28:03.489 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-20 18:28:03.490 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-20 18:28:03.491 +01:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.user_id AS "UserId", r.token AS "RefToken", r.expires AS "Expires", r.created AS "Created", r.created_by_ip AS "CreatedByIp", r.revoked AS "Revoked", r.revoked_by_ip AS "RevokedByIp", r.replaced_by_token AS "ReplacedByToken", r.reason_revoked AS "ReasonRevoked", r.is_expired AS "IsExpired", r.is_revoked AS "IsRevoked", r.is_active AS "IsActive"
FROM refresh_token AS r
WHERE r.user_id = @__id_0
2022-09-20 18:28:03.493 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.user_id AS "UserId", r.token AS "RefToken", r.expires AS "Expires", r.created AS "Created", r.created_by_ip AS "CreatedByIp", r.revoked AS "Revoked", r.revoked_by_ip AS "RevokedByIp", r.replaced_by_token AS "ReplacedByToken", r.reason_revoked AS "ReasonRevoked", r.is_expired AS "IsExpired", r.is_revoked AS "IsRevoked", r.is_active AS "IsActive"
FROM refresh_token AS r
WHERE r.user_id = @__id_0
2022-09-20 18:28:03.495 +01:00 [DBG] A data reader was disposed.
2022-09-20 18:28:03.495 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-20 18:28:03.496 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-20 18:28:03.498 +01:00 [DBG] An entity of type 'User' tracked by 'PostgresContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-20 18:28:03.504 +01:00 [DBG] Context 'PostgresContext' started tracking 'RefreshToken' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-20 18:28:03.507 +01:00 [DBG] SaveChanges starting for 'PostgresContext'.
2022-09-20 18:28:03.508 +01:00 [DBG] DetectChanges starting for 'PostgresContext'.
2022-09-20 18:28:03.509 +01:00 [DBG] DetectChanges completed for 'PostgresContext'.
2022-09-20 18:28:03.510 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-20 18:28:03.511 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-20 18:28:03.511 +01:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2022-09-20 18:28:03.512 +01:00 [DBG] Began transaction with isolation level 'ReadCommitted'.
2022-09-20 18:28:03.520 +01:00 [DBG] Executing 2 update commands as a batch.
2022-09-20 18:28:03.523 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-20 18:28:03.524 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2022-09-20 18:28:03.525 +01:00 [DBG] Executing DbCommand [Parameters=[@p12='?' (DbType = Int32), @p0='?' (DbType = DateTime), @p1='?', @p2='?' (DbType = DateTime), @p3='?' (DbType = Boolean), @p4='?' (DbType = Boolean), @p5='?' (DbType = Boolean), @p6='?', @p7='?', @p8='?', @p9='?' (DbType = DateTime), @p10='?', @p11='?' (DbType = Int32), @p19='?' (DbType = Int32), @p13='?' (DbType = DateTime), @p14='?', @p15='?', @p16='?' (DbType = DateTime), @p17='?', @p18='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE refresh_token SET created = @p0, created_by_ip = @p1, expires = @p2, is_active = @p3, is_expired = @p4, is_revoked = @p5, reason_revoked = @p6, token = @p7, replaced_by_token = @p8, revoked = @p9, revoked_by_ip = @p10, user_id = @p11
WHERE id = @p12;
UPDATE users SET created_at = @p13, email = @p14, full_name = @p15, password_changed_at = @p16, password_hash = @p17, username = @p18
WHERE id = @p19;
2022-09-20 18:28:03.527 +01:00 [INF] Executed DbCommand (3ms) [Parameters=[@p12='?' (DbType = Int32), @p0='?' (DbType = DateTime), @p1='?', @p2='?' (DbType = DateTime), @p3='?' (DbType = Boolean), @p4='?' (DbType = Boolean), @p5='?' (DbType = Boolean), @p6='?', @p7='?', @p8='?', @p9='?' (DbType = DateTime), @p10='?', @p11='?' (DbType = Int32), @p19='?' (DbType = Int32), @p13='?' (DbType = DateTime), @p14='?', @p15='?', @p16='?' (DbType = DateTime), @p17='?', @p18='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE refresh_token SET created = @p0, created_by_ip = @p1, expires = @p2, is_active = @p3, is_expired = @p4, is_revoked = @p5, reason_revoked = @p6, token = @p7, replaced_by_token = @p8, revoked = @p9, revoked_by_ip = @p10, user_id = @p11
WHERE id = @p12;
UPDATE users SET created_at = @p13, email = @p14, full_name = @p15, password_changed_at = @p16, password_hash = @p17, username = @p18
WHERE id = @p19;
2022-09-20 18:28:03.529 +01:00 [DBG] A data reader was disposed.
2022-09-20 18:28:03.530 +01:00 [DBG] Committing transaction.
2022-09-20 18:28:03.534 +01:00 [DBG] Committed transaction.
2022-09-20 18:28:03.534 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-20 18:28:03.536 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-20 18:28:03.537 +01:00 [DBG] Disposing transaction.
2022-09-20 18:28:03.539 +01:00 [DBG] An entity of type 'User' tracked by 'PostgresContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-20 18:28:03.540 +01:00 [DBG] An entity of type 'RefreshToken' tracked by 'PostgresContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-20 18:28:03.541 +01:00 [DBG] SaveChanges completed for 'PostgresContext' with 2 entities written to the database.
2022-09-20 18:28:03.542 +01:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2022-09-20 18:28:03.544 +01:00 [DBG] No information found on request to perform content negotiation.
2022-09-20 18:28:03.544 +01:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2022-09-20 18:28:03.546 +01:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2022-09-20 18:28:03.546 +01:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2022-09-20 18:28:03.548 +01:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType0`1[[System.String, System.Private.CoreLib, Version=6.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2022-09-20 18:28:03.553 +01:00 [INF] Executed action APIBank.Controllers.UsersController.RevokeToken (APIBank) in 114.5069ms
2022-09-20 18:28:03.554 +01:00 [INF] Executed endpoint 'APIBank.Controllers.UsersController.RevokeToken (APIBank)'
2022-09-20 18:28:03.556 +01:00 [DBG] 'PostgresContext' disposed.
2022-09-20 18:28:03.557 +01:00 [INF] Request finished HTTP/2 POST https://localhost:7036/api/Users/revoke-token application/json 105 - 200 - application/json;+charset=utf-8 228.3494ms
2022-09-20 18:28:08.421 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/api/Users/1/refresh-tokens - -
2022-09-20 18:28:08.423 +01:00 [DBG] 1 candidate(s) found for the request path '/api/Users/1/refresh-tokens'
2022-09-20 18:28:08.424 +01:00 [DBG] Endpoint 'APIBank.Controllers.UsersController.GetRefreshTokens (APIBank)' with route pattern 'api/Users/{id}/refresh-tokens' is valid for the request path '/api/Users/1/refresh-tokens'
2022-09-20 18:28:08.425 +01:00 [DBG] Request matched endpoint 'APIBank.Controllers.UsersController.GetRefreshTokens (APIBank)'
2022-09-20 18:28:08.427 +01:00 [DBG] Static files was skipped as the request already matched an endpoint.
2022-09-20 18:28:08.430 +01:00 [INF] Entity Framework Core 6.0.9 initialized 'PostgresContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:6.0.7+5b98e4b74de93b590b44aef8dd7967c03acc433c' with options: None
2022-09-20 18:28:08.436 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-20 18:28:08.437 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2022-09-20 18:28:08.438 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-20 18:28:08.439 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-20 18:28:08.440 +01:00 [DBG] Executing DbCommand [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.id = @__p_0
LIMIT 1
2022-09-20 18:28:08.443 +01:00 [INF] Executed DbCommand (3ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.id = @__p_0
LIMIT 1
2022-09-20 18:28:08.451 +01:00 [DBG] Context 'PostgresContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-20 18:28:08.452 +01:00 [DBG] A data reader was disposed.
2022-09-20 18:28:08.453 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-20 18:28:08.454 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-20 18:28:08.456 +01:00 [INF] Executing endpoint 'APIBank.Controllers.UsersController.GetRefreshTokens (APIBank)'
2022-09-20 18:28:08.457 +01:00 [INF] Route matched with {action = "GetRefreshTokens", controller = "Users"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult GetRefreshTokens(Int32) on controller APIBank.Controllers.UsersController (APIBank).
2022-09-20 18:28:08.459 +01:00 [DBG] Execution plan of authorization filters (in the following order): ["APIBank.Authorization.AuthorizeAttribute"]
2022-09-20 18:28:08.464 +01:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2022-09-20 18:28:08.465 +01:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2022-09-20 18:28:08.467 +01:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2022-09-20 18:28:08.468 +01:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2022-09-20 18:28:08.470 +01:00 [DBG] Executing controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-20 18:28:08.471 +01:00 [DBG] Executed controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-20 18:28:08.471 +01:00 [DBG] Attempting to bind parameter 'id' of type 'System.Int32' ...
2022-09-20 18:28:08.472 +01:00 [DBG] Attempting to bind parameter 'id' of type 'System.Int32' using the name 'id' in request data ...
2022-09-20 18:28:08.474 +01:00 [DBG] Done attempting to bind parameter 'id' of type 'System.Int32'.
2022-09-20 18:28:08.476 +01:00 [DBG] Done attempting to bind parameter 'id' of type 'System.Int32'.
2022-09-20 18:28:08.479 +01:00 [DBG] Attempting to validate the bound parameter 'id' of type 'System.Int32' ...
2022-09-20 18:28:08.482 +01:00 [DBG] Done attempting to validate the bound parameter 'id' of type 'System.Int32'.
2022-09-20 18:28:08.483 +01:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2022-09-20 18:28:08.487 +01:00 [DBG] No information found on request to perform content negotiation.
2022-09-20 18:28:08.487 +01:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2022-09-20 18:28:08.491 +01:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2022-09-20 18:28:08.492 +01:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2022-09-20 18:28:08.497 +01:00 [INF] Executing OkObjectResult, writing value of type 'Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryable`1[[APIBank.ModelEntities.RefreshToken, APIBank, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2022-09-20 18:28:08.501 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-20 18:28:08.503 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2022-09-20 18:28:08.505 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-20 18:28:08.506 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-20 18:28:08.507 +01:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.user_id AS "UserId", r.token AS "RefToken", r.expires AS "Expires", r.created AS "Created", r.created_by_ip AS "CreatedByIp", r.revoked AS "Revoked", r.revoked_by_ip AS "RevokedByIp", r.replaced_by_token AS "ReplacedByToken", r.reason_revoked AS "ReasonRevoked", r.is_expired AS "IsExpired", r.is_revoked AS "IsRevoked", r.is_active AS "IsActive"
FROM refresh_token AS r
WHERE r.user_id = @__id_0
2022-09-20 18:28:08.528 +01:00 [INF] Executed DbCommand (20ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.user_id AS "UserId", r.token AS "RefToken", r.expires AS "Expires", r.created AS "Created", r.created_by_ip AS "CreatedByIp", r.revoked AS "Revoked", r.revoked_by_ip AS "RevokedByIp", r.replaced_by_token AS "ReplacedByToken", r.reason_revoked AS "ReasonRevoked", r.is_expired AS "IsExpired", r.is_revoked AS "IsRevoked", r.is_active AS "IsActive"
FROM refresh_token AS r
WHERE r.user_id = @__id_0
2022-09-20 18:28:08.542 +01:00 [DBG] A data reader was disposed.
2022-09-20 18:28:08.548 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-20 18:28:08.550 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-20 18:28:08.557 +01:00 [INF] Executed action APIBank.Controllers.UsersController.GetRefreshTokens (APIBank) in 87.3918ms
2022-09-20 18:28:08.562 +01:00 [INF] Executed endpoint 'APIBank.Controllers.UsersController.GetRefreshTokens (APIBank)'
2022-09-20 18:28:08.566 +01:00 [DBG] 'PostgresContext' disposed.
2022-09-20 18:28:08.569 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/api/Users/1/refresh-tokens - - - 200 - application/json;+charset=utf-8 148.1438ms
2022-09-20 18:29:24.558 +01:00 [INF] Request starting HTTP/2 POST https://localhost:7036/api/Users/refreshToken - 0
2022-09-20 18:29:24.575 +01:00 [DBG] 1 candidate(s) found for the request path '/api/Users/refreshToken'
2022-09-20 18:29:24.575 +01:00 [DBG] Endpoint 'APIBank.Controllers.UsersController.RefreshToken (APIBank)' with route pattern 'api/Users/refreshToken' is valid for the request path '/api/Users/refreshToken'
2022-09-20 18:29:24.577 +01:00 [DBG] Request matched endpoint 'APIBank.Controllers.UsersController.RefreshToken (APIBank)'
2022-09-20 18:29:24.578 +01:00 [DBG] Static files was skipped as the request already matched an endpoint.
2022-09-20 18:29:24.582 +01:00 [INF] Entity Framework Core 6.0.9 initialized 'PostgresContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:6.0.7+5b98e4b74de93b590b44aef8dd7967c03acc433c' with options: None
2022-09-20 18:29:24.585 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-20 18:29:24.586 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2022-09-20 18:29:24.587 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-20 18:29:24.587 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-20 18:29:24.588 +01:00 [DBG] Executing DbCommand [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.id = @__p_0
LIMIT 1
2022-09-20 18:29:24.591 +01:00 [INF] Executed DbCommand (3ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.id = @__p_0
LIMIT 1
2022-09-20 18:29:24.593 +01:00 [DBG] Context 'PostgresContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-20 18:29:24.595 +01:00 [DBG] A data reader was disposed.
2022-09-20 18:29:24.596 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-20 18:29:24.597 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-20 18:29:24.598 +01:00 [INF] Executing endpoint 'APIBank.Controllers.UsersController.RefreshToken (APIBank)'
2022-09-20 18:29:24.600 +01:00 [INF] Route matched with {action = "RefreshToken", controller = "Users"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult RefreshToken() on controller APIBank.Controllers.UsersController (APIBank).
2022-09-20 18:29:24.601 +01:00 [DBG] Execution plan of authorization filters (in the following order): ["APIBank.Authorization.AuthorizeAttribute"]
2022-09-20 18:29:24.602 +01:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2022-09-20 18:29:24.603 +01:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2022-09-20 18:29:24.605 +01:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2022-09-20 18:29:24.607 +01:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2022-09-20 18:29:24.608 +01:00 [DBG] Executing controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-20 18:29:24.609 +01:00 [DBG] Executed controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-20 18:29:24.616 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-20 18:29:24.617 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2022-09-20 18:29:24.618 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-20 18:29:24.618 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-20 18:29:24.619 +01:00 [DBG] Executing DbCommand [Parameters=[@__refToken_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE EXISTS (
    SELECT 1
    FROM refresh_token AS r
    WHERE (u.id = r.user_id) AND (r.token = @__refToken_0))
LIMIT 2
2022-09-20 18:29:24.622 +01:00 [INF] Executed DbCommand (3ms) [Parameters=[@__refToken_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE EXISTS (
    SELECT 1
    FROM refresh_token AS r
    WHERE (u.id = r.user_id) AND (r.token = @__refToken_0))
LIMIT 2
2022-09-20 18:29:24.624 +01:00 [DBG] A data reader was disposed.
2022-09-20 18:29:24.624 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-20 18:29:24.625 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-20 18:29:24.626 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-20 18:29:24.628 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2022-09-20 18:29:24.630 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-20 18:29:24.630 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-20 18:29:24.631 +01:00 [DBG] Executing DbCommand [Parameters=[@__token_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM users AS u
    WHERE EXISTS (
        SELECT 1
        FROM refresh_token AS r
        WHERE (u.id = r.user_id) AND (r.token = @__token_0)))
2022-09-20 18:29:24.633 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[@__token_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM users AS u
    WHERE EXISTS (
        SELECT 1
        FROM refresh_token AS r
        WHERE (u.id = r.user_id) AND (r.token = @__token_0)))
2022-09-20 18:29:24.634 +01:00 [DBG] A data reader was disposed.
2022-09-20 18:29:24.635 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-20 18:29:24.635 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-20 18:29:24.636 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-20 18:29:24.638 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2022-09-20 18:29:24.639 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-20 18:29:24.640 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-20 18:29:24.641 +01:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.user_id AS "UserId", r.token AS "RefToken", r.expires AS "Expires", r.created AS "Created", r.created_by_ip AS "CreatedByIp", r.revoked AS "Revoked", r.revoked_by_ip AS "RevokedByIp", r.replaced_by_token AS "ReplacedByToken", r.reason_revoked AS "ReasonRevoked", r.is_expired AS "IsExpired", r.is_revoked AS "IsRevoked", r.is_active AS "IsActive"
FROM refresh_token AS r
WHERE r.user_id = @__id_0
2022-09-20 18:29:24.642 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.user_id AS "UserId", r.token AS "RefToken", r.expires AS "Expires", r.created AS "Created", r.created_by_ip AS "CreatedByIp", r.revoked AS "Revoked", r.revoked_by_ip AS "RevokedByIp", r.replaced_by_token AS "ReplacedByToken", r.reason_revoked AS "ReasonRevoked", r.is_expired AS "IsExpired", r.is_revoked AS "IsRevoked", r.is_active AS "IsActive"
FROM refresh_token AS r
WHERE r.user_id = @__id_0
2022-09-20 18:29:24.645 +01:00 [DBG] A data reader was disposed.
2022-09-20 18:29:24.647 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-20 18:29:24.647 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-20 18:29:24.648 +01:00 [DBG] An entity of type 'User' tracked by 'PostgresContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-20 18:30:06.936 +01:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2022-09-20 18:30:07.654 +01:00 [DBG] Hosting starting
2022-09-20 18:30:07.921 +01:00 [DBG] Using development certificate: CN=localhost (Thumbprint: 9CC642E9838495A6C3C202DECA6A8AD300396DD2)
2022-09-20 18:30:07.966 +01:00 [INF] Now listening on: https://localhost:7036
2022-09-20 18:30:07.968 +01:00 [INF] Now listening on: http://localhost:5036
2022-09-20 18:30:07.968 +01:00 [DBG] Loaded hosting startup assembly APIBank
2022-09-20 18:30:07.969 +01:00 [DBG] Loaded hosting startup assembly Microsoft.AspNetCore.Watch.BrowserRefresh
2022-09-20 18:30:07.970 +01:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.BrowserLink.Net
2022-09-20 18:30:07.970 +01:00 [INF] Application started. Press Ctrl+C to shut down.
2022-09-20 18:30:07.971 +01:00 [INF] Hosting environment: Development
2022-09-20 18:30:07.973 +01:00 [INF] Content root path: C:\Users\mguedesa\OneDrive - NTT DATA EMEAL\Documentos\GitHub\OpenBankAPI-NTT\APIBank\APIBank\
2022-09-20 18:30:07.974 +01:00 [DBG] Hosting started
2022-09-20 18:30:07.979 +01:00 [DBG] Connection id "0HMKR5N1LOLSO" received FIN.
2022-09-20 18:30:07.979 +01:00 [DBG] Connection id "0HMKR5N1LOLSP" received FIN.
2022-09-20 18:30:07.992 +01:00 [DBG] Connection id "0HMKR5N1LOLSO" accepted.
2022-09-20 18:30:07.992 +01:00 [DBG] Connection id "0HMKR5N1LOLSP" accepted.
2022-09-20 18:30:07.997 +01:00 [DBG] Connection id "0HMKR5N1LOLSP" started.
2022-09-20 18:30:07.997 +01:00 [DBG] Connection id "0HMKR5N1LOLSO" started.
2022-09-20 18:30:08.028 +01:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException:  Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveBlobAsync[TIOAdapter](TIOAdapter adapter)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](TIOAdapter adapter, Boolean receiveFirst, Byte[] reAuthenticationData, Boolean isApm)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2022-09-20 18:30:08.028 +01:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException:  Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveBlobAsync[TIOAdapter](TIOAdapter adapter)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](TIOAdapter adapter, Boolean receiveFirst, Byte[] reAuthenticationData, Boolean isApm)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2022-09-20 18:30:08.098 +01:00 [DBG] Connection id "0HMKR5N1LOLSO" stopped.
2022-09-20 18:30:08.098 +01:00 [DBG] Connection id "0HMKR5N1LOLSP" stopped.
2022-09-20 18:30:08.113 +01:00 [DBG] Connection id "0HMKR5N1LOLSO" sending FIN because: "The Socket transport's send loop completed gracefully."
2022-09-20 18:30:08.131 +01:00 [DBG] Connection id "0HMKR5N1LOLSP" sending FIN because: "The Socket transport's send loop completed gracefully."
2022-09-20 18:30:08.407 +01:00 [DBG] Connection id "0HMKR5N1LOLSQ" accepted.
2022-09-20 18:30:08.410 +01:00 [DBG] Connection id "0HMKR5N1LOLSQ" started.
2022-09-20 18:30:08.486 +01:00 [DBG] Connection 0HMKR5N1LOLSQ established using the following protocol: "Tls12"
2022-09-20 18:30:08.654 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/swagger/index.html - -
2022-09-20 18:30:08.765 +01:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2022-09-20 18:30:08.822 +01:00 [DBG] No candidates found for the request path '/swagger/index.html'
2022-09-20 18:30:08.825 +01:00 [DBG] Request did not match any endpoints
2022-09-20 18:30:08.993 +01:00 [DBG] Response markup is scheduled to include browser refresh script injection.
2022-09-20 18:30:09.166 +01:00 [DBG] Response markup was updated to include browser refresh script injection.
2022-09-20 18:30:09.176 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/swagger/index.html - - - 200 - text/html;charset=utf-8 529.9293ms
2022-09-20 18:30:09.207 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/_vs/browserLink - -
2022-09-20 18:30:09.207 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/_framework/aspnetcore-browser-refresh.js - -
2022-09-20 18:30:09.222 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/_framework/aspnetcore-browser-refresh.js - - - 200 11984 application/javascript;+charset=utf-8 14.9387ms
2022-09-20 18:30:09.272 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/_vs/browserLink - - - 200 - text/javascript;+charset=UTF-8 64.8837ms
2022-09-20 18:30:09.340 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/swagger/v1/swagger.json - -
2022-09-20 18:30:09.342 +01:00 [DBG] No candidates found for the request path '/swagger/v1/swagger.json'
2022-09-20 18:30:09.343 +01:00 [DBG] Request did not match any endpoints
2022-09-20 18:30:09.585 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/swagger/v1/swagger.json - - - 200 - application/json;charset=utf-8 244.2214ms
2022-09-20 18:30:43.668 +01:00 [INF] Request starting HTTP/2 POST https://localhost:7036/api/Users/Login application/json 56
2022-09-20 18:30:43.681 +01:00 [DBG] 1 candidate(s) found for the request path '/api/Users/Login'
2022-09-20 18:30:43.687 +01:00 [DBG] Endpoint 'APIBank.Controllers.UsersController.Login (APIBank)' with route pattern 'api/Users/Login' is valid for the request path '/api/Users/Login'
2022-09-20 18:30:43.689 +01:00 [DBG] Request matched endpoint 'APIBank.Controllers.UsersController.Login (APIBank)'
2022-09-20 18:30:43.694 +01:00 [DBG] Static files was skipped as the request already matched an endpoint.
2022-09-20 18:30:44.172 +01:00 [INF] Executing endpoint 'APIBank.Controllers.UsersController.Login (APIBank)'
2022-09-20 18:30:44.208 +01:00 [INF] Route matched with {action = "Login", controller = "Users"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult Login(APIBank.Models.Requests.LoginRequest) on controller APIBank.Controllers.UsersController (APIBank).
2022-09-20 18:30:44.215 +01:00 [DBG] Execution plan of authorization filters (in the following order): ["APIBank.Authorization.AuthorizeAttribute"]
2022-09-20 18:30:44.218 +01:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2022-09-20 18:30:44.219 +01:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2022-09-20 18:30:44.222 +01:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2022-09-20 18:30:44.223 +01:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2022-09-20 18:30:44.228 +01:00 [DBG] Executing controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-20 18:30:44.229 +01:00 [DBG] Executed controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-20 18:30:44.247 +01:00 [DBG] Attempting to bind parameter 'model' of type 'APIBank.Models.Requests.LoginRequest' ...
2022-09-20 18:30:44.251 +01:00 [DBG] Attempting to bind parameter 'model' of type 'APIBank.Models.Requests.LoginRequest' using the name '' in request data ...
2022-09-20 18:30:44.253 +01:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2022-09-20 18:30:44.261 +01:00 [DBG] Connection id "0HMKR5N1LOLSQ", Request id "0HMKR5N1LOLSQ:00000009": started reading request body.
2022-09-20 18:30:44.262 +01:00 [DBG] Connection id "0HMKR5N1LOLSQ", Request id "0HMKR5N1LOLSQ:00000009": done reading request body.
2022-09-20 18:30:44.268 +01:00 [DBG] JSON input formatter succeeded, deserializing to type 'APIBank.Models.Requests.LoginRequest'
2022-09-20 18:30:44.269 +01:00 [DBG] Done attempting to bind parameter 'model' of type 'APIBank.Models.Requests.LoginRequest'.
2022-09-20 18:30:44.270 +01:00 [DBG] Done attempting to bind parameter 'model' of type 'APIBank.Models.Requests.LoginRequest'.
2022-09-20 18:30:44.271 +01:00 [DBG] Attempting to validate the bound parameter 'model' of type 'APIBank.Models.Requests.LoginRequest' ...
2022-09-20 18:30:44.281 +01:00 [DBG] Done attempting to validate the bound parameter 'model' of type 'APIBank.Models.Requests.LoginRequest'.
2022-09-20 18:30:44.399 +01:00 [DBG] An additional 'IServiceProvider' was created for internal use by Entity Framework. An existing service provider was not used due to the following configuration changes: configuration changed for 'Core:ConfigureWarnings', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:UseAdminDatabase', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:SetPostgresVersion', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:UseRedshift', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:ReverseNullOrdering', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:RemoteCertificateValidationCallback', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:ProvideClientCertificatesCallback', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:ProvidePasswordCallback'.
2022-09-20 18:30:45.962 +01:00 [INF] Entity Framework Core 6.0.9 initialized 'PostgresContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:6.0.7+5b98e4b74de93b590b44aef8dd7967c03acc433c' with options: None
2022-09-20 18:30:46.069 +01:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .SingleOrDefault(x => x.Username == __model_Username_0)'
2022-09-20 18:30:46.599 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<User>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: User.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: User.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 1], [Property: User.Email (string) Required Index MaxLength(254), 2], [Property: User.FullName (string) Required MaxLength(100), 3], [Property: User.PasswordChangedAt (DateTime) Required ValueGenerated.OnAdd, 4], [Property: User.PasswordHash (string) Required MaxLength(200), 5], [Property: User.Username (string) Required Index MaxLength(50), 6] }
        SELECT TOP(2) u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
        FROM users AS u
        WHERE u.username == @__model_Username_0), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, User>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)
    .SingleOrDefault()'
2022-09-20 18:30:46.668 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-20 18:30:46.828 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (152ms).
2022-09-20 18:30:46.845 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-20 18:30:47.185 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-20 18:30:47.209 +01:00 [DBG] Executing DbCommand [Parameters=[@__model_Username_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.username = @__model_Username_0
LIMIT 2
2022-09-20 18:30:47.349 +01:00 [INF] Executed DbCommand (148ms) [Parameters=[@__model_Username_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.username = @__model_Username_0
LIMIT 2
2022-09-20 18:30:47.377 +01:00 [DBG] A data reader was disposed.
2022-09-20 18:30:47.383 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-20 18:30:47.397 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-20 18:30:55.368 +01:00 [INF] Executed action APIBank.Controllers.UsersController.Login (APIBank) in 11137.7958ms
2022-09-20 18:30:55.373 +01:00 [INF] Executed endpoint 'APIBank.Controllers.UsersController.Login (APIBank)'
2022-09-20 18:30:55.432 +01:00 [DBG] 'PostgresContext' disposed.
2022-09-20 18:30:55.442 +01:00 [INF] Request finished HTTP/2 POST https://localhost:7036/api/Users/Login application/json 56 - 400 - application/json 11780.6218ms
2022-09-20 18:30:57.848 +01:00 [INF] Request starting HTTP/2 POST https://localhost:7036/api/Users/Login application/json 58
2022-09-20 18:30:57.853 +01:00 [DBG] 1 candidate(s) found for the request path '/api/Users/Login'
2022-09-20 18:30:57.855 +01:00 [DBG] Endpoint 'APIBank.Controllers.UsersController.Login (APIBank)' with route pattern 'api/Users/Login' is valid for the request path '/api/Users/Login'
2022-09-20 18:30:57.857 +01:00 [DBG] Request matched endpoint 'APIBank.Controllers.UsersController.Login (APIBank)'
2022-09-20 18:30:57.857 +01:00 [DBG] Static files was skipped as the request already matched an endpoint.
2022-09-20 18:30:57.873 +01:00 [INF] Executing endpoint 'APIBank.Controllers.UsersController.Login (APIBank)'
2022-09-20 18:30:57.875 +01:00 [INF] Route matched with {action = "Login", controller = "Users"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult Login(APIBank.Models.Requests.LoginRequest) on controller APIBank.Controllers.UsersController (APIBank).
2022-09-20 18:30:57.877 +01:00 [DBG] Execution plan of authorization filters (in the following order): ["APIBank.Authorization.AuthorizeAttribute"]
2022-09-20 18:30:57.880 +01:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2022-09-20 18:30:57.882 +01:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2022-09-20 18:30:57.884 +01:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2022-09-20 18:30:57.886 +01:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2022-09-20 18:30:57.887 +01:00 [DBG] Executing controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-20 18:30:57.889 +01:00 [DBG] Executed controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-20 18:30:57.890 +01:00 [DBG] Attempting to bind parameter 'model' of type 'APIBank.Models.Requests.LoginRequest' ...
2022-09-20 18:30:57.891 +01:00 [DBG] Attempting to bind parameter 'model' of type 'APIBank.Models.Requests.LoginRequest' using the name '' in request data ...
2022-09-20 18:30:57.892 +01:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2022-09-20 18:30:57.893 +01:00 [DBG] Connection id "0HMKR5N1LOLSQ", Request id "0HMKR5N1LOLSQ:0000000B": started reading request body.
2022-09-20 18:30:57.894 +01:00 [DBG] Connection id "0HMKR5N1LOLSQ", Request id "0HMKR5N1LOLSQ:0000000B": done reading request body.
2022-09-20 18:30:57.896 +01:00 [DBG] JSON input formatter succeeded, deserializing to type 'APIBank.Models.Requests.LoginRequest'
2022-09-20 18:30:57.897 +01:00 [DBG] Done attempting to bind parameter 'model' of type 'APIBank.Models.Requests.LoginRequest'.
2022-09-20 18:30:57.899 +01:00 [DBG] Done attempting to bind parameter 'model' of type 'APIBank.Models.Requests.LoginRequest'.
2022-09-20 18:30:57.900 +01:00 [DBG] Attempting to validate the bound parameter 'model' of type 'APIBank.Models.Requests.LoginRequest' ...
2022-09-20 18:30:57.901 +01:00 [DBG] Done attempting to validate the bound parameter 'model' of type 'APIBank.Models.Requests.LoginRequest'.
2022-09-20 18:30:57.908 +01:00 [INF] Entity Framework Core 6.0.9 initialized 'PostgresContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:6.0.7+5b98e4b74de93b590b44aef8dd7967c03acc433c' with options: None
2022-09-20 18:30:57.918 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-20 18:30:57.919 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2022-09-20 18:30:57.920 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-20 18:30:57.921 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-20 18:30:57.922 +01:00 [DBG] Executing DbCommand [Parameters=[@__model_Username_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.username = @__model_Username_0
LIMIT 2
2022-09-20 18:30:57.925 +01:00 [INF] Executed DbCommand (3ms) [Parameters=[@__model_Username_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.username = @__model_Username_0
LIMIT 2
2022-09-20 18:30:57.977 +01:00 [DBG] Context 'PostgresContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-20 18:30:58.035 +01:00 [DBG] A data reader was disposed.
2022-09-20 18:30:58.037 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-20 18:30:58.039 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-20 18:30:58.509 +01:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .Any(user => user.RefreshTokenCollection
        .Any(reftoken => reftoken.RefToken == __token_0))'
2022-09-20 18:30:58.650 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<bool>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            EmptyProjectionMember -> 0
        SELECT EXISTS (
            SELECT 1
            FROM users AS u
            WHERE EXISTS (
                SELECT 1
                FROM refresh_token AS r
                WHERE ((u.id != NULL) && (u.id == r.user_id)) && (r.token == @__token_0)))), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, bool>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)
    .Single()'
2022-09-20 18:30:58.673 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-20 18:30:58.677 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (3ms).
2022-09-20 18:30:58.678 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-20 18:30:58.681 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-20 18:30:58.683 +01:00 [DBG] Executing DbCommand [Parameters=[@__token_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM users AS u
    WHERE EXISTS (
        SELECT 1
        FROM refresh_token AS r
        WHERE (u.id = r.user_id) AND (r.token = @__token_0)))
2022-09-20 18:30:58.689 +01:00 [INF] Executed DbCommand (6ms) [Parameters=[@__token_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM users AS u
    WHERE EXISTS (
        SELECT 1
        FROM refresh_token AS r
        WHERE (u.id = r.user_id) AND (r.token = @__token_0)))
2022-09-20 18:30:58.697 +01:00 [DBG] A data reader was disposed.
2022-09-20 18:30:58.699 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-20 18:30:58.700 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-20 18:30:58.719 +01:00 [DBG] Compiling query expression: 
'DbSet<RefreshToken>()
    .Where(rt => rt.UserId == __id_0)
    .AsNoTracking()
    .Select(rt => new RefreshToken{ 
        Id = rt.Id, 
        UserId = rt.UserId, 
        RefToken = rt.RefToken, 
        Expires = rt.Expires, 
        Created = rt.Created, 
        CreatedByIp = rt.CreatedByIp, 
        Revoked = rt.Revoked, 
        RevokedByIp = rt.RevokedByIp, 
        ReplacedByToken = rt.ReplacedByToken, 
        ReasonRevoked = rt.ReasonRevoked, 
        IsExpired = rt.IsExpired, 
        IsRevoked = rt.IsRevoked, 
        IsActive = rt.IsActive 
    }
    )'
2022-09-20 18:30:58.755 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<RefreshToken>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            Id -> 0
            UserId -> 1
            RefToken -> 2
            Expires -> 3
            Created -> 4
            CreatedByIp -> 5
            Revoked -> 6
            RevokedByIp -> 7
            ReplacedByToken -> 8
            ReasonRevoked -> 9
            IsExpired -> 10
            IsRevoked -> 11
            IsActive -> 12
        SELECT r.id AS Id, r.user_id AS UserId, r.token AS RefToken, r.expires AS Expires, r.created AS Created, r.created_by_ip AS CreatedByIp, r.revoked AS Revoked, r.revoked_by_ip AS RevokedByIp, r.replaced_by_token AS ReplacedByToken, r.reason_revoked AS ReasonRevoked, r.is_expired AS IsExpired, r.is_revoked AS IsRevoked, r.is_active AS IsActive
        FROM refresh_token AS r
        WHERE r.user_id == @__id_0), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, RefreshToken>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)'
2022-09-20 18:30:58.760 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-20 18:30:58.762 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2022-09-20 18:30:58.764 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-20 18:30:58.765 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-20 18:30:58.766 +01:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.user_id AS "UserId", r.token AS "RefToken", r.expires AS "Expires", r.created AS "Created", r.created_by_ip AS "CreatedByIp", r.revoked AS "Revoked", r.revoked_by_ip AS "RevokedByIp", r.replaced_by_token AS "ReplacedByToken", r.reason_revoked AS "ReasonRevoked", r.is_expired AS "IsExpired", r.is_revoked AS "IsRevoked", r.is_active AS "IsActive"
FROM refresh_token AS r
WHERE r.user_id = @__id_0
2022-09-20 18:30:58.774 +01:00 [INF] Executed DbCommand (8ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.user_id AS "UserId", r.token AS "RefToken", r.expires AS "Expires", r.created AS "Created", r.created_by_ip AS "CreatedByIp", r.revoked AS "Revoked", r.revoked_by_ip AS "RevokedByIp", r.replaced_by_token AS "ReplacedByToken", r.reason_revoked AS "ReasonRevoked", r.is_expired AS "IsExpired", r.is_revoked AS "IsRevoked", r.is_active AS "IsActive"
FROM refresh_token AS r
WHERE r.user_id = @__id_0
2022-09-20 18:30:58.776 +01:00 [DBG] A data reader was disposed.
2022-09-20 18:30:58.777 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-20 18:30:58.778 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-20 18:30:58.797 +01:00 [DBG] An entity of type 'User' tracked by 'PostgresContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-20 18:30:58.850 +01:00 [DBG] 'PostgresContext' generated a temporary value for the property 'Id.RefreshToken'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-20 18:30:58.904 +01:00 [DBG] Context 'PostgresContext' started tracking 'RefreshToken' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-20 18:30:58.914 +01:00 [DBG] SaveChanges starting for 'PostgresContext'.
2022-09-20 18:30:58.918 +01:00 [DBG] DetectChanges starting for 'PostgresContext'.
2022-09-20 18:30:58.960 +01:00 [DBG] 1 entities were added and 0 entities were removed from navigation 'User.RefreshTokenCollection'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-20 18:30:58.986 +01:00 [DBG] The foreign key property 'RefreshToken.UserId' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2022-09-20 18:30:59.018 +01:00 [DBG] DetectChanges completed for 'PostgresContext'.
2022-09-20 18:30:59.032 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-20 18:30:59.035 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-20 18:30:59.039 +01:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2022-09-20 18:30:59.052 +01:00 [DBG] Began transaction with isolation level 'ReadCommitted'.
2022-09-20 18:30:59.138 +01:00 [DBG] Executing 2 update commands as a batch.
2022-09-20 18:30:59.156 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-20 18:30:59.158 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (2ms).
2022-09-20 18:30:59.161 +01:00 [DBG] Executing DbCommand [Parameters=[@p0='?' (DbType = DateTime), @p1='?', @p2='?' (DbType = DateTime), @p3='?' (DbType = Boolean), @p4='?' (DbType = Boolean), @p5='?' (DbType = Boolean), @p6='?', @p7='?', @p8='?', @p9='?' (DbType = DateTime), @p10='?', @p11='?' (DbType = Int32), @p18='?' (DbType = Int32), @p12='?' (DbType = DateTime), @p13='?', @p14='?', @p15='?' (DbType = DateTime), @p16='?', @p17='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO refresh_token (created, created_by_ip, expires, is_active, is_expired, is_revoked, reason_revoked, token, replaced_by_token, revoked, revoked_by_ip, user_id)
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11)
RETURNING id;
UPDATE users SET created_at = @p12, email = @p13, full_name = @p14, password_changed_at = @p15, password_hash = @p16, username = @p17
WHERE id = @p18;
2022-09-20 18:30:59.174 +01:00 [INF] Executed DbCommand (13ms) [Parameters=[@p0='?' (DbType = DateTime), @p1='?', @p2='?' (DbType = DateTime), @p3='?' (DbType = Boolean), @p4='?' (DbType = Boolean), @p5='?' (DbType = Boolean), @p6='?', @p7='?', @p8='?', @p9='?' (DbType = DateTime), @p10='?', @p11='?' (DbType = Int32), @p18='?' (DbType = Int32), @p12='?' (DbType = DateTime), @p13='?', @p14='?', @p15='?' (DbType = DateTime), @p16='?', @p17='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO refresh_token (created, created_by_ip, expires, is_active, is_expired, is_revoked, reason_revoked, token, replaced_by_token, revoked, revoked_by_ip, user_id)
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11)
RETURNING id;
UPDATE users SET created_at = @p12, email = @p13, full_name = @p14, password_changed_at = @p15, password_hash = @p16, username = @p17
WHERE id = @p18;
2022-09-20 18:30:59.195 +01:00 [DBG] The foreign key property 'RefreshToken.Id' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2022-09-20 18:30:59.199 +01:00 [DBG] A data reader was disposed.
2022-09-20 18:30:59.204 +01:00 [DBG] Committing transaction.
2022-09-20 18:30:59.218 +01:00 [DBG] Committed transaction.
2022-09-20 18:30:59.221 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-20 18:30:59.222 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-20 18:30:59.225 +01:00 [DBG] Disposing transaction.
2022-09-20 18:30:59.230 +01:00 [DBG] An entity of type 'RefreshToken' tracked by 'PostgresContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-20 18:30:59.232 +01:00 [DBG] An entity of type 'User' tracked by 'PostgresContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-20 18:30:59.235 +01:00 [DBG] SaveChanges completed for 'PostgresContext' with 2 entities written to the database.
2022-09-20 18:30:59.242 +01:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2022-09-20 18:30:59.250 +01:00 [DBG] Attempting to select an output formatter based on Accept header '["text/plain"]'.
2022-09-20 18:30:59.252 +01:00 [DBG] Could not find an output formatter based on content negotiation. Accepted types were (["text/plain"])
2022-09-20 18:30:59.253 +01:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2022-09-20 18:30:59.254 +01:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2022-09-20 18:30:59.255 +01:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2022-09-20 18:30:59.256 +01:00 [INF] Executing OkObjectResult, writing value of type 'APIBank.Models.Users.Responses.LoginResponse'.
2022-09-20 18:30:59.268 +01:00 [INF] Executed action APIBank.Controllers.UsersController.Login (APIBank) in 1380.8961ms
2022-09-20 18:30:59.270 +01:00 [INF] Executed endpoint 'APIBank.Controllers.UsersController.Login (APIBank)'
2022-09-20 18:30:59.270 +01:00 [DBG] 'PostgresContext' disposed.
2022-09-20 18:30:59.271 +01:00 [INF] Request finished HTTP/2 POST https://localhost:7036/api/Users/Login application/json 58 - 200 - application/json;+charset=utf-8 1423.4220ms
2022-09-20 18:31:13.160 +01:00 [INF] Request starting HTTP/2 POST https://localhost:7036/api/Users/refreshToken - 0
2022-09-20 18:31:13.163 +01:00 [DBG] 1 candidate(s) found for the request path '/api/Users/refreshToken'
2022-09-20 18:31:13.165 +01:00 [DBG] Endpoint 'APIBank.Controllers.UsersController.RefreshToken (APIBank)' with route pattern 'api/Users/refreshToken' is valid for the request path '/api/Users/refreshToken'
2022-09-20 18:31:13.168 +01:00 [DBG] Request matched endpoint 'APIBank.Controllers.UsersController.RefreshToken (APIBank)'
2022-09-20 18:31:13.171 +01:00 [DBG] Static files was skipped as the request already matched an endpoint.
2022-09-20 18:31:13.320 +01:00 [INF] Entity Framework Core 6.0.9 initialized 'PostgresContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:6.0.7+5b98e4b74de93b590b44aef8dd7967c03acc433c' with options: None
2022-09-20 18:31:13.338 +01:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .FirstOrDefault(e => EF.Property<int>(e, "Id") == __p_0)'
2022-09-20 18:31:13.345 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<User>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: User.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: User.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 1], [Property: User.Email (string) Required Index MaxLength(254), 2], [Property: User.FullName (string) Required MaxLength(100), 3], [Property: User.PasswordChangedAt (DateTime) Required ValueGenerated.OnAdd, 4], [Property: User.PasswordHash (string) Required MaxLength(200), 5], [Property: User.Username (string) Required Index MaxLength(50), 6] }
        SELECT TOP(1) u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
        FROM users AS u
        WHERE u.id == @__p_0), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, User>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)
    .SingleOrDefault()'
2022-09-20 18:31:13.349 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-20 18:31:13.351 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (2ms).
2022-09-20 18:31:13.353 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-20 18:31:13.354 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-20 18:31:13.354 +01:00 [DBG] Executing DbCommand [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.id = @__p_0
LIMIT 1
2022-09-20 18:31:13.356 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.id = @__p_0
LIMIT 1
2022-09-20 18:31:13.358 +01:00 [DBG] Context 'PostgresContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-20 18:31:13.359 +01:00 [DBG] A data reader was disposed.
2022-09-20 18:31:13.360 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-20 18:31:13.361 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-20 18:31:13.362 +01:00 [INF] Executing endpoint 'APIBank.Controllers.UsersController.RefreshToken (APIBank)'
2022-09-20 18:31:13.364 +01:00 [INF] Route matched with {action = "RefreshToken", controller = "Users"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult RefreshToken() on controller APIBank.Controllers.UsersController (APIBank).
2022-09-20 18:31:13.368 +01:00 [DBG] Execution plan of authorization filters (in the following order): ["APIBank.Authorization.AuthorizeAttribute"]
2022-09-20 18:31:13.371 +01:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2022-09-20 18:31:13.372 +01:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2022-09-20 18:31:13.373 +01:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2022-09-20 18:31:13.374 +01:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2022-09-20 18:31:13.375 +01:00 [DBG] Executing controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-20 18:31:13.376 +01:00 [DBG] Executed controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-20 18:31:13.381 +01:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .SingleOrDefault(userQuery => userQuery.RefreshTokenCollection
        .Any(refTokenQuery => refTokenQuery.RefToken == __refToken_0))'
2022-09-20 18:31:13.387 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<User>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: User.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: User.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 1], [Property: User.Email (string) Required Index MaxLength(254), 2], [Property: User.FullName (string) Required MaxLength(100), 3], [Property: User.PasswordChangedAt (DateTime) Required ValueGenerated.OnAdd, 4], [Property: User.PasswordHash (string) Required MaxLength(200), 5], [Property: User.Username (string) Required Index MaxLength(50), 6] }
        SELECT TOP(2) u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
        FROM users AS u
        WHERE EXISTS (
            SELECT 1
            FROM refresh_token AS r
            WHERE ((u.id != NULL) && (u.id == r.user_id)) && (r.token == @__refToken_0))), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, User>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)
    .SingleOrDefault()'
2022-09-20 18:31:13.389 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-20 18:31:13.390 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2022-09-20 18:31:13.391 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-20 18:31:13.391 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-20 18:31:13.392 +01:00 [DBG] Executing DbCommand [Parameters=[@__refToken_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE EXISTS (
    SELECT 1
    FROM refresh_token AS r
    WHERE (u.id = r.user_id) AND (r.token = @__refToken_0))
LIMIT 2
2022-09-20 18:31:13.396 +01:00 [INF] Executed DbCommand (4ms) [Parameters=[@__refToken_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE EXISTS (
    SELECT 1
    FROM refresh_token AS r
    WHERE (u.id = r.user_id) AND (r.token = @__refToken_0))
LIMIT 2
2022-09-20 18:31:13.397 +01:00 [DBG] A data reader was disposed.
2022-09-20 18:31:13.398 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-20 18:31:13.400 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-20 18:31:13.402 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-20 18:31:13.403 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2022-09-20 18:31:13.404 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-20 18:31:13.404 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-20 18:31:13.405 +01:00 [DBG] Executing DbCommand [Parameters=[@__token_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM users AS u
    WHERE EXISTS (
        SELECT 1
        FROM refresh_token AS r
        WHERE (u.id = r.user_id) AND (r.token = @__token_0)))
2022-09-20 18:31:13.407 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[@__token_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM users AS u
    WHERE EXISTS (
        SELECT 1
        FROM refresh_token AS r
        WHERE (u.id = r.user_id) AND (r.token = @__token_0)))
2022-09-20 18:31:13.409 +01:00 [DBG] A data reader was disposed.
2022-09-20 18:31:13.411 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-20 18:31:13.412 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-20 18:31:13.416 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-20 18:31:13.418 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2022-09-20 18:31:13.419 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-20 18:31:13.420 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-20 18:31:13.421 +01:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.user_id AS "UserId", r.token AS "RefToken", r.expires AS "Expires", r.created AS "Created", r.created_by_ip AS "CreatedByIp", r.revoked AS "Revoked", r.revoked_by_ip AS "RevokedByIp", r.replaced_by_token AS "ReplacedByToken", r.reason_revoked AS "ReasonRevoked", r.is_expired AS "IsExpired", r.is_revoked AS "IsRevoked", r.is_active AS "IsActive"
FROM refresh_token AS r
WHERE r.user_id = @__id_0
2022-09-20 18:31:13.423 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.user_id AS "UserId", r.token AS "RefToken", r.expires AS "Expires", r.created AS "Created", r.created_by_ip AS "CreatedByIp", r.revoked AS "Revoked", r.revoked_by_ip AS "RevokedByIp", r.replaced_by_token AS "ReplacedByToken", r.reason_revoked AS "ReasonRevoked", r.is_expired AS "IsExpired", r.is_revoked AS "IsRevoked", r.is_active AS "IsActive"
FROM refresh_token AS r
WHERE r.user_id = @__id_0
2022-09-20 18:31:13.424 +01:00 [DBG] A data reader was disposed.
2022-09-20 18:31:13.425 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-20 18:31:13.429 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-20 18:31:13.430 +01:00 [DBG] An entity of type 'User' tracked by 'PostgresContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-20 18:31:13.431 +01:00 [DBG] SaveChanges starting for 'PostgresContext'.
2022-09-20 18:31:13.433 +01:00 [DBG] DetectChanges starting for 'PostgresContext'.
2022-09-20 18:31:13.435 +01:00 [DBG] 1 entities were added and 0 entities were removed from navigation 'User.RefreshTokenCollection'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-20 18:31:13.438 +01:00 [DBG] 'PostgresContext' generated a temporary value for the property 'Id.RefreshToken'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-20 18:31:13.441 +01:00 [DBG] Context 'PostgresContext' started tracking 'RefreshToken' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-20 18:31:13.443 +01:00 [DBG] DetectChanges completed for 'PostgresContext'.
2022-09-20 18:31:13.444 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-20 18:31:13.445 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-20 18:31:13.445 +01:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2022-09-20 18:31:13.446 +01:00 [DBG] Began transaction with isolation level 'ReadCommitted'.
2022-09-20 18:31:13.447 +01:00 [DBG] Executing 2 update commands as a batch.
2022-09-20 18:31:13.449 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-20 18:31:13.451 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2022-09-20 18:31:13.453 +01:00 [DBG] Executing DbCommand [Parameters=[@p0='?' (DbType = DateTime), @p1='?', @p2='?' (DbType = DateTime), @p3='?' (DbType = Boolean), @p4='?' (DbType = Boolean), @p5='?' (DbType = Boolean), @p6='?', @p7='?', @p8='?', @p9='?' (DbType = DateTime), @p10='?', @p11='?' (DbType = Int32), @p18='?' (DbType = Int32), @p12='?' (DbType = DateTime), @p13='?', @p14='?', @p15='?' (DbType = DateTime), @p16='?', @p17='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO refresh_token (created, created_by_ip, expires, is_active, is_expired, is_revoked, reason_revoked, token, replaced_by_token, revoked, revoked_by_ip, user_id)
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11)
RETURNING id;
UPDATE users SET created_at = @p12, email = @p13, full_name = @p14, password_changed_at = @p15, password_hash = @p16, username = @p17
WHERE id = @p18;
2022-09-20 18:31:13.455 +01:00 [INF] Executed DbCommand (3ms) [Parameters=[@p0='?' (DbType = DateTime), @p1='?', @p2='?' (DbType = DateTime), @p3='?' (DbType = Boolean), @p4='?' (DbType = Boolean), @p5='?' (DbType = Boolean), @p6='?', @p7='?', @p8='?', @p9='?' (DbType = DateTime), @p10='?', @p11='?' (DbType = Int32), @p18='?' (DbType = Int32), @p12='?' (DbType = DateTime), @p13='?', @p14='?', @p15='?' (DbType = DateTime), @p16='?', @p17='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO refresh_token (created, created_by_ip, expires, is_active, is_expired, is_revoked, reason_revoked, token, replaced_by_token, revoked, revoked_by_ip, user_id)
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11)
RETURNING id;
UPDATE users SET created_at = @p12, email = @p13, full_name = @p14, password_changed_at = @p15, password_hash = @p16, username = @p17
WHERE id = @p18;
2022-09-20 18:31:13.460 +01:00 [DBG] The foreign key property 'RefreshToken.Id' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2022-09-20 18:31:13.461 +01:00 [DBG] A data reader was disposed.
2022-09-20 18:31:13.462 +01:00 [DBG] Committing transaction.
2022-09-20 18:31:13.465 +01:00 [DBG] Committed transaction.
2022-09-20 18:31:13.468 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-20 18:31:13.469 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-20 18:31:13.470 +01:00 [DBG] Disposing transaction.
2022-09-20 18:31:13.472 +01:00 [DBG] An entity of type 'RefreshToken' tracked by 'PostgresContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-20 18:31:13.474 +01:00 [DBG] An entity of type 'User' tracked by 'PostgresContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-20 18:31:13.476 +01:00 [DBG] SaveChanges completed for 'PostgresContext' with 2 entities written to the database.
2022-09-20 18:31:13.477 +01:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2022-09-20 18:31:13.479 +01:00 [DBG] Attempting to select an output formatter based on Accept header '["text/plain"]'.
2022-09-20 18:31:13.480 +01:00 [DBG] Could not find an output formatter based on content negotiation. Accepted types were (["text/plain"])
2022-09-20 18:31:13.481 +01:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2022-09-20 18:31:13.482 +01:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2022-09-20 18:31:13.484 +01:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2022-09-20 18:31:13.485 +01:00 [INF] Executing OkObjectResult, writing value of type 'APIBank.Models.Users.Responses.LoginResponse'.
2022-09-20 18:31:13.489 +01:00 [INF] Executed action APIBank.Controllers.UsersController.RefreshToken (APIBank) in 114.4132ms
2022-09-20 18:31:13.491 +01:00 [INF] Executed endpoint 'APIBank.Controllers.UsersController.RefreshToken (APIBank)'
2022-09-20 18:31:13.496 +01:00 [DBG] 'PostgresContext' disposed.
2022-09-20 18:31:13.497 +01:00 [INF] Request finished HTTP/2 POST https://localhost:7036/api/Users/refreshToken - 0 - 200 - application/json;+charset=utf-8 337.3842ms
2022-09-20 18:31:20.527 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/api/Accounts/GetAll - -
2022-09-20 18:31:20.531 +01:00 [DBG] 1 candidate(s) found for the request path '/api/Accounts/GetAll'
2022-09-20 18:31:20.532 +01:00 [DBG] Endpoint 'APIBank.Controllers.AccountsController.GetAllFromUser (APIBank)' with route pattern 'api/Accounts/GetAll' is valid for the request path '/api/Accounts/GetAll'
2022-09-20 18:31:20.535 +01:00 [DBG] Request matched endpoint 'APIBank.Controllers.AccountsController.GetAllFromUser (APIBank)'
2022-09-20 18:31:20.536 +01:00 [DBG] Static files was skipped as the request already matched an endpoint.
2022-09-20 18:31:20.541 +01:00 [INF] Entity Framework Core 6.0.9 initialized 'PostgresContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:6.0.7+5b98e4b74de93b590b44aef8dd7967c03acc433c' with options: None
2022-09-20 18:31:20.545 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-20 18:31:20.549 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (3ms).
2022-09-20 18:31:20.550 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-20 18:31:20.551 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-20 18:31:20.551 +01:00 [DBG] Executing DbCommand [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.id = @__p_0
LIMIT 1
2022-09-20 18:31:20.553 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.id = @__p_0
LIMIT 1
2022-09-20 18:31:20.555 +01:00 [DBG] Context 'PostgresContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-20 18:31:20.556 +01:00 [DBG] A data reader was disposed.
2022-09-20 18:31:20.556 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-20 18:31:20.557 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-20 18:31:20.558 +01:00 [INF] Executing endpoint 'APIBank.Controllers.AccountsController.GetAllFromUser (APIBank)'
2022-09-20 18:31:20.560 +01:00 [INF] Route matched with {action = "GetAllFromUser", controller = "Accounts"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult GetAllFromUser() on controller APIBank.Controllers.AccountsController (APIBank).
2022-09-20 18:31:20.564 +01:00 [DBG] Execution plan of authorization filters (in the following order): ["APIBank.Authorization.AuthorizeAttribute"]
2022-09-20 18:31:20.567 +01:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2022-09-20 18:31:20.568 +01:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2022-09-20 18:31:20.569 +01:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2022-09-20 18:31:20.570 +01:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2022-09-20 18:31:20.571 +01:00 [DBG] Executing controller factory for controller APIBank.Controllers.AccountsController (APIBank)
2022-09-20 18:31:20.572 +01:00 [DBG] Executed controller factory for controller APIBank.Controllers.AccountsController (APIBank)
2022-09-20 18:31:20.577 +01:00 [DBG] Compiling query expression: 
'DbSet<Account>()
    .Where(u => u.UserId == __userId_0)
    .Select(u => new AccountRe{ 
        Balance = u.Balance, 
        CreatedAt = u.CreatedAt, 
        Currency = u.Currency, 
        Id = u.Id 
    }
    )'
2022-09-20 18:31:20.583 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<AccountRe>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            Balance -> 0
            CreatedAt -> 1
            Currency -> 2
            Id -> 3
        SELECT a.balance AS Balance, a.created_at AS CreatedAt, a.currency AS Currency, a.id AS Id
        FROM accounts AS a
        WHERE a.user_id == @__userId_0), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, AccountRe>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)'
2022-09-20 18:31:20.584 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-20 18:31:20.585 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2022-09-20 18:31:20.586 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-20 18:31:20.587 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-20 18:31:20.588 +01:00 [DBG] Executing DbCommand [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a.balance AS "Balance", a.created_at AS "CreatedAt", a.currency AS "Currency", a.id AS "Id"
FROM accounts AS a
WHERE a.user_id = @__userId_0
2022-09-20 18:31:20.591 +01:00 [INF] Executed DbCommand (3ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a.balance AS "Balance", a.created_at AS "CreatedAt", a.currency AS "Currency", a.id AS "Id"
FROM accounts AS a
WHERE a.user_id = @__userId_0
2022-09-20 18:31:20.605 +01:00 [DBG] A data reader was disposed.
2022-09-20 18:31:20.607 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-20 18:31:20.607 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-20 18:31:20.608 +01:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2022-09-20 18:31:20.611 +01:00 [DBG] Attempting to select an output formatter based on Accept header '["text/plain"]'.
2022-09-20 18:31:20.613 +01:00 [DBG] Could not find an output formatter based on content negotiation. Accepted types were (["text/plain"])
2022-09-20 18:31:20.614 +01:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2022-09-20 18:31:20.614 +01:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2022-09-20 18:31:20.615 +01:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2022-09-20 18:31:20.615 +01:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[APIBank.Models.Accounts.AccountRe, APIBank, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2022-09-20 18:31:20.623 +01:00 [INF] Executed action APIBank.Controllers.AccountsController.GetAllFromUser (APIBank) in 52.0494ms
2022-09-20 18:31:20.624 +01:00 [INF] Executed endpoint 'APIBank.Controllers.AccountsController.GetAllFromUser (APIBank)'
2022-09-20 18:31:20.625 +01:00 [DBG] 'PostgresContext' disposed.
2022-09-20 18:31:20.626 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/api/Accounts/GetAll - - - 200 - application/json;+charset=utf-8 98.8882ms
2022-09-20 18:31:51.124 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/api/Users/1/refresh-tokens - -
2022-09-20 18:31:51.145 +01:00 [DBG] 1 candidate(s) found for the request path '/api/Users/1/refresh-tokens'
2022-09-20 18:31:51.148 +01:00 [DBG] Endpoint 'APIBank.Controllers.UsersController.GetRefreshTokens (APIBank)' with route pattern 'api/Users/{id}/refresh-tokens' is valid for the request path '/api/Users/1/refresh-tokens'
2022-09-20 18:31:51.150 +01:00 [DBG] Request matched endpoint 'APIBank.Controllers.UsersController.GetRefreshTokens (APIBank)'
2022-09-20 18:31:51.153 +01:00 [DBG] Static files was skipped as the request already matched an endpoint.
2022-09-20 18:31:51.156 +01:00 [INF] Entity Framework Core 6.0.9 initialized 'PostgresContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:6.0.7+5b98e4b74de93b590b44aef8dd7967c03acc433c' with options: None
2022-09-20 18:31:51.160 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-20 18:31:51.161 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2022-09-20 18:31:51.163 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-20 18:31:51.164 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-20 18:31:51.167 +01:00 [DBG] Executing DbCommand [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.id = @__p_0
LIMIT 1
2022-09-20 18:31:51.173 +01:00 [INF] Executed DbCommand (6ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.id = @__p_0
LIMIT 1
2022-09-20 18:31:51.175 +01:00 [DBG] Context 'PostgresContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-20 18:31:51.176 +01:00 [DBG] A data reader was disposed.
2022-09-20 18:31:51.177 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-20 18:31:51.178 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-20 18:31:51.179 +01:00 [INF] Executing endpoint 'APIBank.Controllers.UsersController.GetRefreshTokens (APIBank)'
2022-09-20 18:31:51.181 +01:00 [INF] Route matched with {action = "GetRefreshTokens", controller = "Users"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult GetRefreshTokens(Int32) on controller APIBank.Controllers.UsersController (APIBank).
2022-09-20 18:31:51.183 +01:00 [DBG] Execution plan of authorization filters (in the following order): ["APIBank.Authorization.AuthorizeAttribute"]
2022-09-20 18:31:51.185 +01:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2022-09-20 18:31:51.187 +01:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2022-09-20 18:31:51.190 +01:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2022-09-20 18:31:51.192 +01:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2022-09-20 18:31:51.194 +01:00 [DBG] Executing controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-20 18:31:51.196 +01:00 [DBG] Executed controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-20 18:31:51.196 +01:00 [DBG] Attempting to bind parameter 'id' of type 'System.Int32' ...
2022-09-20 18:31:51.198 +01:00 [DBG] Attempting to bind parameter 'id' of type 'System.Int32' using the name 'id' in request data ...
2022-09-20 18:31:51.200 +01:00 [DBG] Done attempting to bind parameter 'id' of type 'System.Int32'.
2022-09-20 18:31:51.205 +01:00 [DBG] Done attempting to bind parameter 'id' of type 'System.Int32'.
2022-09-20 18:31:51.206 +01:00 [DBG] Attempting to validate the bound parameter 'id' of type 'System.Int32' ...
2022-09-20 18:31:51.207 +01:00 [DBG] Done attempting to validate the bound parameter 'id' of type 'System.Int32'.
2022-09-20 18:31:51.208 +01:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2022-09-20 18:31:51.210 +01:00 [DBG] No information found on request to perform content negotiation.
2022-09-20 18:31:51.211 +01:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2022-09-20 18:31:51.211 +01:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2022-09-20 18:31:51.212 +01:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2022-09-20 18:31:51.213 +01:00 [INF] Executing OkObjectResult, writing value of type 'Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryable`1[[APIBank.ModelEntities.RefreshToken, APIBank, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2022-09-20 18:31:51.224 +01:00 [DBG] Compiling query expression: 
'DbSet<RefreshToken>()
    .Where(rt => rt.UserId == __id_0)
    .AsNoTracking()
    .Select(rt => new RefreshToken{ 
        Id = rt.Id, 
        UserId = rt.UserId, 
        RefToken = rt.RefToken, 
        Expires = rt.Expires, 
        Created = rt.Created, 
        CreatedByIp = rt.CreatedByIp, 
        Revoked = rt.Revoked, 
        RevokedByIp = rt.RevokedByIp, 
        ReplacedByToken = rt.ReplacedByToken, 
        ReasonRevoked = rt.ReasonRevoked, 
        IsExpired = rt.IsExpired, 
        IsRevoked = rt.IsRevoked, 
        IsActive = rt.IsActive 
    }
    )'
2022-09-20 18:31:51.229 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<RefreshToken>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            Id -> 0
            UserId -> 1
            RefToken -> 2
            Expires -> 3
            Created -> 4
            CreatedByIp -> 5
            Revoked -> 6
            RevokedByIp -> 7
            ReplacedByToken -> 8
            ReasonRevoked -> 9
            IsExpired -> 10
            IsRevoked -> 11
            IsActive -> 12
        SELECT r.id AS Id, r.user_id AS UserId, r.token AS RefToken, r.expires AS Expires, r.created AS Created, r.created_by_ip AS CreatedByIp, r.revoked AS Revoked, r.revoked_by_ip AS RevokedByIp, r.replaced_by_token AS ReplacedByToken, r.reason_revoked AS ReasonRevoked, r.is_expired AS IsExpired, r.is_revoked AS IsRevoked, r.is_active AS IsActive
        FROM refresh_token AS r
        WHERE r.user_id == @__id_0), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, RefreshToken>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)'
2022-09-20 18:31:51.254 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-20 18:31:51.256 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2022-09-20 18:31:51.265 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-20 18:31:51.269 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-20 18:31:51.271 +01:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.user_id AS "UserId", r.token AS "RefToken", r.expires AS "Expires", r.created AS "Created", r.created_by_ip AS "CreatedByIp", r.revoked AS "Revoked", r.revoked_by_ip AS "RevokedByIp", r.replaced_by_token AS "ReplacedByToken", r.reason_revoked AS "ReasonRevoked", r.is_expired AS "IsExpired", r.is_revoked AS "IsRevoked", r.is_active AS "IsActive"
FROM refresh_token AS r
WHERE r.user_id = @__id_0
2022-09-20 18:31:51.277 +01:00 [INF] Executed DbCommand (6ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.user_id AS "UserId", r.token AS "RefToken", r.expires AS "Expires", r.created AS "Created", r.created_by_ip AS "CreatedByIp", r.revoked AS "Revoked", r.revoked_by_ip AS "RevokedByIp", r.replaced_by_token AS "ReplacedByToken", r.reason_revoked AS "ReasonRevoked", r.is_expired AS "IsExpired", r.is_revoked AS "IsRevoked", r.is_active AS "IsActive"
FROM refresh_token AS r
WHERE r.user_id = @__id_0
2022-09-20 18:31:51.292 +01:00 [DBG] A data reader was disposed.
2022-09-20 18:31:51.299 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-20 18:31:51.303 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-20 18:31:51.304 +01:00 [INF] Executed action APIBank.Controllers.UsersController.GetRefreshTokens (APIBank) in 109.9172ms
2022-09-20 18:31:51.305 +01:00 [INF] Executed endpoint 'APIBank.Controllers.UsersController.GetRefreshTokens (APIBank)'
2022-09-20 18:31:51.306 +01:00 [DBG] 'PostgresContext' disposed.
2022-09-20 18:31:51.306 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/api/Users/1/refresh-tokens - - - 200 - application/json;+charset=utf-8 182.6710ms
2022-09-20 18:32:54.176 +01:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2022-09-20 18:32:54.375 +01:00 [DBG] Hosting starting
2022-09-20 18:32:54.572 +01:00 [DBG] Using development certificate: CN=localhost (Thumbprint: 9CC642E9838495A6C3C202DECA6A8AD300396DD2)
2022-09-20 18:32:54.630 +01:00 [INF] Now listening on: https://localhost:7036
2022-09-20 18:32:54.632 +01:00 [INF] Now listening on: http://localhost:5036
2022-09-20 18:32:54.632 +01:00 [DBG] Loaded hosting startup assembly APIBank
2022-09-20 18:32:54.633 +01:00 [DBG] Loaded hosting startup assembly Microsoft.AspNetCore.Watch.BrowserRefresh
2022-09-20 18:32:54.634 +01:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.BrowserLink.Net
2022-09-20 18:32:54.634 +01:00 [INF] Application started. Press Ctrl+C to shut down.
2022-09-20 18:32:54.635 +01:00 [INF] Hosting environment: Development
2022-09-20 18:32:54.636 +01:00 [INF] Content root path: C:\Users\mguedesa\OneDrive - NTT DATA EMEAL\Documentos\GitHub\OpenBankAPI-NTT\APIBank\APIBank\
2022-09-20 18:32:54.637 +01:00 [DBG] Hosting started
2022-09-20 18:32:54.674 +01:00 [DBG] Connection id "0HMKR5OJBDUGP" received FIN.
2022-09-20 18:32:54.674 +01:00 [DBG] Connection id "0HMKR5OJBDUGQ" received FIN.
2022-09-20 18:32:54.675 +01:00 [DBG] Connection id "0HMKR5OJBDUGP" accepted.
2022-09-20 18:32:54.675 +01:00 [DBG] Connection id "0HMKR5OJBDUGQ" accepted.
2022-09-20 18:32:54.678 +01:00 [DBG] Connection id "0HMKR5OJBDUGP" started.
2022-09-20 18:32:54.678 +01:00 [DBG] Connection id "0HMKR5OJBDUGQ" started.
2022-09-20 18:32:54.696 +01:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException:  Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveBlobAsync[TIOAdapter](TIOAdapter adapter)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](TIOAdapter adapter, Boolean receiveFirst, Byte[] reAuthenticationData, Boolean isApm)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2022-09-20 18:32:54.696 +01:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException:  Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveBlobAsync[TIOAdapter](TIOAdapter adapter)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](TIOAdapter adapter, Boolean receiveFirst, Byte[] reAuthenticationData, Boolean isApm)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2022-09-20 18:32:54.736 +01:00 [DBG] Connection id "0HMKR5OJBDUGQ" stopped.
2022-09-20 18:32:54.736 +01:00 [DBG] Connection id "0HMKR5OJBDUGP" stopped.
2022-09-20 18:32:54.739 +01:00 [DBG] Connection id "0HMKR5OJBDUGQ" sending FIN because: "The Socket transport's send loop completed gracefully."
2022-09-20 18:32:54.739 +01:00 [DBG] Connection id "0HMKR5OJBDUGP" sending FIN because: "The Socket transport's send loop completed gracefully."
2022-09-20 18:32:54.935 +01:00 [DBG] Connection id "0HMKR5OJBDUGR" accepted.
2022-09-20 18:32:54.939 +01:00 [DBG] Connection id "0HMKR5OJBDUGR" started.
2022-09-20 18:32:55.070 +01:00 [DBG] Connection 0HMKR5OJBDUGR established using the following protocol: "Tls12"
2022-09-20 18:32:55.225 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/swagger/index.html - -
2022-09-20 18:32:55.320 +01:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2022-09-20 18:32:55.363 +01:00 [DBG] No candidates found for the request path '/swagger/index.html'
2022-09-20 18:32:55.365 +01:00 [DBG] Request did not match any endpoints
2022-09-20 18:32:55.500 +01:00 [DBG] Response markup is scheduled to include browser refresh script injection.
2022-09-20 18:32:55.654 +01:00 [DBG] Response markup was updated to include browser refresh script injection.
2022-09-20 18:32:55.662 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/swagger/index.html - - - 200 - text/html;charset=utf-8 442.1004ms
2022-09-20 18:32:55.679 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/_framework/aspnetcore-browser-refresh.js - -
2022-09-20 18:32:55.685 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/_vs/browserLink - -
2022-09-20 18:32:55.690 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/_framework/aspnetcore-browser-refresh.js - - - 200 11984 application/javascript;+charset=utf-8 11.0647ms
2022-09-20 18:32:55.733 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/_vs/browserLink - - - 200 - text/javascript;+charset=UTF-8 47.4693ms
2022-09-20 18:32:55.800 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/swagger/v1/swagger.json - -
2022-09-20 18:32:55.801 +01:00 [DBG] No candidates found for the request path '/swagger/v1/swagger.json'
2022-09-20 18:32:55.802 +01:00 [DBG] Request did not match any endpoints
2022-09-20 18:32:56.002 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/swagger/v1/swagger.json - - - 200 - application/json;charset=utf-8 202.5118ms
2022-09-20 18:33:10.237 +01:00 [INF] Request starting HTTP/2 POST https://localhost:7036/api/Users/Login application/json 58
2022-09-20 18:33:10.256 +01:00 [DBG] 1 candidate(s) found for the request path '/api/Users/Login'
2022-09-20 18:33:10.262 +01:00 [DBG] Endpoint 'APIBank.Controllers.UsersController.Login (APIBank)' with route pattern 'api/Users/Login' is valid for the request path '/api/Users/Login'
2022-09-20 18:33:10.270 +01:00 [DBG] Request matched endpoint 'APIBank.Controllers.UsersController.Login (APIBank)'
2022-09-20 18:33:10.275 +01:00 [DBG] Static files was skipped as the request already matched an endpoint.
2022-09-20 18:33:10.756 +01:00 [INF] Executing endpoint 'APIBank.Controllers.UsersController.Login (APIBank)'
2022-09-20 18:33:10.788 +01:00 [INF] Route matched with {action = "Login", controller = "Users"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult Login(APIBank.Models.Requests.LoginRequest) on controller APIBank.Controllers.UsersController (APIBank).
2022-09-20 18:33:10.794 +01:00 [DBG] Execution plan of authorization filters (in the following order): ["APIBank.Authorization.AuthorizeAttribute"]
2022-09-20 18:33:10.795 +01:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2022-09-20 18:33:10.797 +01:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2022-09-20 18:33:10.800 +01:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2022-09-20 18:33:10.802 +01:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2022-09-20 18:33:10.804 +01:00 [DBG] Executing controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-20 18:33:10.805 +01:00 [DBG] Executed controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-20 18:33:10.824 +01:00 [DBG] Attempting to bind parameter 'model' of type 'APIBank.Models.Requests.LoginRequest' ...
2022-09-20 18:33:10.831 +01:00 [DBG] Attempting to bind parameter 'model' of type 'APIBank.Models.Requests.LoginRequest' using the name '' in request data ...
2022-09-20 18:33:10.835 +01:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2022-09-20 18:33:10.844 +01:00 [DBG] Connection id "0HMKR5OJBDUGR", Request id "0HMKR5OJBDUGR:00000009": started reading request body.
2022-09-20 18:33:10.846 +01:00 [DBG] Connection id "0HMKR5OJBDUGR", Request id "0HMKR5OJBDUGR:00000009": done reading request body.
2022-09-20 18:33:10.855 +01:00 [DBG] JSON input formatter succeeded, deserializing to type 'APIBank.Models.Requests.LoginRequest'
2022-09-20 18:33:10.856 +01:00 [DBG] Done attempting to bind parameter 'model' of type 'APIBank.Models.Requests.LoginRequest'.
2022-09-20 18:33:10.857 +01:00 [DBG] Done attempting to bind parameter 'model' of type 'APIBank.Models.Requests.LoginRequest'.
2022-09-20 18:33:10.858 +01:00 [DBG] Attempting to validate the bound parameter 'model' of type 'APIBank.Models.Requests.LoginRequest' ...
2022-09-20 18:33:10.868 +01:00 [DBG] Done attempting to validate the bound parameter 'model' of type 'APIBank.Models.Requests.LoginRequest'.
2022-09-20 18:33:20.116 +01:00 [DBG] An additional 'IServiceProvider' was created for internal use by Entity Framework. An existing service provider was not used due to the following configuration changes: configuration changed for 'Core:ConfigureWarnings', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:UseAdminDatabase', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:SetPostgresVersion', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:UseRedshift', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:ReverseNullOrdering', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:RemoteCertificateValidationCallback', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:ProvideClientCertificatesCallback', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:ProvidePasswordCallback'.
2022-09-20 18:33:21.947 +01:00 [INF] Entity Framework Core 6.0.9 initialized 'PostgresContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:6.0.7+5b98e4b74de93b590b44aef8dd7967c03acc433c' with options: None
2022-09-20 18:33:22.047 +01:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .SingleOrDefault(x => x.Username == __model_Username_0)'
2022-09-20 18:33:22.645 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<User>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: User.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: User.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 1], [Property: User.Email (string) Required Index MaxLength(254), 2], [Property: User.FullName (string) Required MaxLength(100), 3], [Property: User.PasswordChangedAt (DateTime) Required ValueGenerated.OnAdd, 4], [Property: User.PasswordHash (string) Required MaxLength(200), 5], [Property: User.Username (string) Required Index MaxLength(50), 6] }
        SELECT TOP(2) u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
        FROM users AS u
        WHERE u.username == @__model_Username_0), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, User>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)
    .SingleOrDefault()'
2022-09-20 18:33:22.718 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-20 18:33:22.857 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (127ms).
2022-09-20 18:33:22.873 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-20 18:33:23.340 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-20 18:33:23.370 +01:00 [DBG] Executing DbCommand [Parameters=[@__model_Username_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.username = @__model_Username_0
LIMIT 2
2022-09-20 18:33:23.559 +01:00 [INF] Executed DbCommand (201ms) [Parameters=[@__model_Username_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.username = @__model_Username_0
LIMIT 2
2022-09-20 18:33:23.647 +01:00 [DBG] Context 'PostgresContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-20 18:33:23.743 +01:00 [DBG] A data reader was disposed.
2022-09-20 18:33:23.754 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-20 18:33:23.767 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-20 18:33:24.346 +01:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .Any(user => user.RefreshTokenCollection
        .Any(reftoken => reftoken.RefToken == __token_0))'
2022-09-20 18:33:24.545 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<bool>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            EmptyProjectionMember -> 0
        SELECT EXISTS (
            SELECT 1
            FROM users AS u
            WHERE EXISTS (
                SELECT 1
                FROM refresh_token AS r
                WHERE ((u.id != NULL) && (u.id == r.user_id)) && (r.token == @__token_0)))), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, bool>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)
    .Single()'
2022-09-20 18:33:24.563 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-20 18:33:24.571 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (7ms).
2022-09-20 18:33:24.574 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-20 18:33:24.575 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-20 18:33:24.577 +01:00 [DBG] Executing DbCommand [Parameters=[@__token_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM users AS u
    WHERE EXISTS (
        SELECT 1
        FROM refresh_token AS r
        WHERE (u.id = r.user_id) AND (r.token = @__token_0)))
2022-09-20 18:33:24.580 +01:00 [INF] Executed DbCommand (3ms) [Parameters=[@__token_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM users AS u
    WHERE EXISTS (
        SELECT 1
        FROM refresh_token AS r
        WHERE (u.id = r.user_id) AND (r.token = @__token_0)))
2022-09-20 18:33:24.587 +01:00 [DBG] A data reader was disposed.
2022-09-20 18:33:24.588 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-20 18:33:24.589 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-20 18:33:24.600 +01:00 [DBG] Compiling query expression: 
'DbSet<RefreshToken>()
    .Where(rt => rt.UserId == __id_0)
    .AsNoTracking()
    .Select(rt => new RefreshToken{ 
        Id = rt.Id, 
        UserId = rt.UserId, 
        RefToken = rt.RefToken, 
        Expires = rt.Expires, 
        Created = rt.Created, 
        CreatedByIp = rt.CreatedByIp, 
        Revoked = rt.Revoked, 
        RevokedByIp = rt.RevokedByIp, 
        ReplacedByToken = rt.ReplacedByToken, 
        ReasonRevoked = rt.ReasonRevoked, 
        IsExpired = rt.IsExpired, 
        IsRevoked = rt.IsRevoked, 
        IsActive = rt.IsActive 
    }
    )'
2022-09-20 18:33:24.639 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<RefreshToken>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            Id -> 0
            UserId -> 1
            RefToken -> 2
            Expires -> 3
            Created -> 4
            CreatedByIp -> 5
            Revoked -> 6
            RevokedByIp -> 7
            ReplacedByToken -> 8
            ReasonRevoked -> 9
            IsExpired -> 10
            IsRevoked -> 11
            IsActive -> 12
        SELECT r.id AS Id, r.user_id AS UserId, r.token AS RefToken, r.expires AS Expires, r.created AS Created, r.created_by_ip AS CreatedByIp, r.revoked AS Revoked, r.revoked_by_ip AS RevokedByIp, r.replaced_by_token AS ReplacedByToken, r.reason_revoked AS ReasonRevoked, r.is_expired AS IsExpired, r.is_revoked AS IsRevoked, r.is_active AS IsActive
        FROM refresh_token AS r
        WHERE r.user_id == @__id_0), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, RefreshToken>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)'
2022-09-20 18:33:24.645 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-20 18:33:24.646 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2022-09-20 18:33:24.647 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-20 18:33:24.648 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-20 18:33:24.648 +01:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.user_id AS "UserId", r.token AS "RefToken", r.expires AS "Expires", r.created AS "Created", r.created_by_ip AS "CreatedByIp", r.revoked AS "Revoked", r.revoked_by_ip AS "RevokedByIp", r.replaced_by_token AS "ReplacedByToken", r.reason_revoked AS "ReasonRevoked", r.is_expired AS "IsExpired", r.is_revoked AS "IsRevoked", r.is_active AS "IsActive"
FROM refresh_token AS r
WHERE r.user_id = @__id_0
2022-09-20 18:33:24.657 +01:00 [INF] Executed DbCommand (9ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.user_id AS "UserId", r.token AS "RefToken", r.expires AS "Expires", r.created AS "Created", r.created_by_ip AS "CreatedByIp", r.revoked AS "Revoked", r.revoked_by_ip AS "RevokedByIp", r.replaced_by_token AS "ReplacedByToken", r.reason_revoked AS "ReasonRevoked", r.is_expired AS "IsExpired", r.is_revoked AS "IsRevoked", r.is_active AS "IsActive"
FROM refresh_token AS r
WHERE r.user_id = @__id_0
2022-09-20 18:33:24.660 +01:00 [DBG] A data reader was disposed.
2022-09-20 18:33:24.660 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-20 18:33:24.661 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-20 18:33:24.688 +01:00 [DBG] An entity of type 'User' tracked by 'PostgresContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-20 18:33:24.738 +01:00 [DBG] 'PostgresContext' generated a temporary value for the property 'Id.RefreshToken'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-20 18:33:24.804 +01:00 [DBG] Context 'PostgresContext' started tracking 'RefreshToken' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-20 18:33:24.813 +01:00 [DBG] SaveChanges starting for 'PostgresContext'.
2022-09-20 18:33:24.821 +01:00 [DBG] DetectChanges starting for 'PostgresContext'.
2022-09-20 18:33:24.864 +01:00 [DBG] 1 entities were added and 0 entities were removed from navigation 'User.RefreshTokenCollection'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-20 18:33:24.891 +01:00 [DBG] The foreign key property 'RefreshToken.UserId' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2022-09-20 18:33:24.918 +01:00 [DBG] DetectChanges completed for 'PostgresContext'.
2022-09-20 18:33:24.934 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-20 18:33:24.937 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-20 18:33:24.942 +01:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2022-09-20 18:33:24.952 +01:00 [DBG] Began transaction with isolation level 'ReadCommitted'.
2022-09-20 18:33:25.053 +01:00 [DBG] Executing 2 update commands as a batch.
2022-09-20 18:33:25.075 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-20 18:33:25.077 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (2ms).
2022-09-20 18:33:25.079 +01:00 [DBG] Executing DbCommand [Parameters=[@p0='?' (DbType = DateTime), @p1='?', @p2='?' (DbType = DateTime), @p3='?' (DbType = Boolean), @p4='?' (DbType = Boolean), @p5='?' (DbType = Boolean), @p6='?', @p7='?', @p8='?', @p9='?' (DbType = DateTime), @p10='?', @p11='?' (DbType = Int32), @p18='?' (DbType = Int32), @p12='?' (DbType = DateTime), @p13='?', @p14='?', @p15='?' (DbType = DateTime), @p16='?', @p17='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO refresh_token (created, created_by_ip, expires, is_active, is_expired, is_revoked, reason_revoked, token, replaced_by_token, revoked, revoked_by_ip, user_id)
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11)
RETURNING id;
UPDATE users SET created_at = @p12, email = @p13, full_name = @p14, password_changed_at = @p15, password_hash = @p16, username = @p17
WHERE id = @p18;
2022-09-20 18:33:25.093 +01:00 [INF] Executed DbCommand (14ms) [Parameters=[@p0='?' (DbType = DateTime), @p1='?', @p2='?' (DbType = DateTime), @p3='?' (DbType = Boolean), @p4='?' (DbType = Boolean), @p5='?' (DbType = Boolean), @p6='?', @p7='?', @p8='?', @p9='?' (DbType = DateTime), @p10='?', @p11='?' (DbType = Int32), @p18='?' (DbType = Int32), @p12='?' (DbType = DateTime), @p13='?', @p14='?', @p15='?' (DbType = DateTime), @p16='?', @p17='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO refresh_token (created, created_by_ip, expires, is_active, is_expired, is_revoked, reason_revoked, token, replaced_by_token, revoked, revoked_by_ip, user_id)
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11)
RETURNING id;
UPDATE users SET created_at = @p12, email = @p13, full_name = @p14, password_changed_at = @p15, password_hash = @p16, username = @p17
WHERE id = @p18;
2022-09-20 18:33:25.112 +01:00 [DBG] The foreign key property 'RefreshToken.Id' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2022-09-20 18:33:25.119 +01:00 [DBG] A data reader was disposed.
2022-09-20 18:33:25.123 +01:00 [DBG] Committing transaction.
2022-09-20 18:33:25.133 +01:00 [DBG] Committed transaction.
2022-09-20 18:33:25.137 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-20 18:33:25.139 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-20 18:33:25.142 +01:00 [DBG] Disposing transaction.
2022-09-20 18:33:25.146 +01:00 [DBG] An entity of type 'RefreshToken' tracked by 'PostgresContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-20 18:33:25.148 +01:00 [DBG] An entity of type 'User' tracked by 'PostgresContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-20 18:33:25.153 +01:00 [DBG] SaveChanges completed for 'PostgresContext' with 2 entities written to the database.
2022-09-20 18:34:17.308 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-20 18:34:17.313 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (4ms).
2022-09-20 18:34:17.315 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-20 18:34:17.316 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-20 18:34:17.317 +01:00 [DBG] Executing DbCommand [Parameters=[@__model_Username_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.username = @__model_Username_0
LIMIT 2
2022-09-20 18:34:17.320 +01:00 [INF] Executed DbCommand (3ms) [Parameters=[@__model_Username_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.username = @__model_Username_0
LIMIT 2
2022-09-20 18:34:17.324 +01:00 [DBG] A data reader was disposed.
2022-09-20 18:34:17.326 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-20 18:34:17.327 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-20 18:35:02.659 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-20 18:35:02.662 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (3ms).
2022-09-20 18:35:02.664 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-20 18:35:02.667 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-20 18:35:02.670 +01:00 [DBG] Executing DbCommand [Parameters=[@__token_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM users AS u
    WHERE EXISTS (
        SELECT 1
        FROM refresh_token AS r
        WHERE (u.id = r.user_id) AND (r.token = @__token_0)))
2022-09-20 18:35:02.672 +01:00 [INF] Executed DbCommand (3ms) [Parameters=[@__token_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM users AS u
    WHERE EXISTS (
        SELECT 1
        FROM refresh_token AS r
        WHERE (u.id = r.user_id) AND (r.token = @__token_0)))
2022-09-20 18:35:02.675 +01:00 [DBG] A data reader was disposed.
2022-09-20 18:35:02.675 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-20 18:35:02.676 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-20 18:35:43.023 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-20 18:35:43.026 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (2ms).
2022-09-20 18:35:43.028 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-20 18:35:43.028 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-20 18:35:43.029 +01:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.user_id AS "UserId", r.token AS "RefToken", r.expires AS "Expires", r.created AS "Created", r.created_by_ip AS "CreatedByIp", r.revoked AS "Revoked", r.revoked_by_ip AS "RevokedByIp", r.replaced_by_token AS "ReplacedByToken", r.reason_revoked AS "ReasonRevoked", r.is_expired AS "IsExpired", r.is_revoked AS "IsRevoked", r.is_active AS "IsActive"
FROM refresh_token AS r
WHERE r.user_id = @__id_0
2022-09-20 18:35:43.033 +01:00 [INF] Executed DbCommand (4ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.user_id AS "UserId", r.token AS "RefToken", r.expires AS "Expires", r.created AS "Created", r.created_by_ip AS "CreatedByIp", r.revoked AS "Revoked", r.revoked_by_ip AS "RevokedByIp", r.replaced_by_token AS "ReplacedByToken", r.reason_revoked AS "ReasonRevoked", r.is_expired AS "IsExpired", r.is_revoked AS "IsRevoked", r.is_active AS "IsActive"
FROM refresh_token AS r
WHERE r.user_id = @__id_0
2022-09-20 18:35:43.034 +01:00 [DBG] A data reader was disposed.
2022-09-20 18:35:43.035 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-20 18:35:43.036 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-20 18:36:01.480 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-20 18:36:01.485 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (5ms).
2022-09-20 18:36:01.486 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-20 18:36:01.487 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-20 18:36:01.488 +01:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.user_id AS "UserId", r.token AS "RefToken", r.expires AS "Expires", r.created AS "Created", r.created_by_ip AS "CreatedByIp", r.revoked AS "Revoked", r.revoked_by_ip AS "RevokedByIp", r.replaced_by_token AS "ReplacedByToken", r.reason_revoked AS "ReasonRevoked", r.is_expired AS "IsExpired", r.is_revoked AS "IsRevoked", r.is_active AS "IsActive"
FROM refresh_token AS r
WHERE r.user_id = @__id_0
2022-09-20 18:36:01.490 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.user_id AS "UserId", r.token AS "RefToken", r.expires AS "Expires", r.created AS "Created", r.created_by_ip AS "CreatedByIp", r.revoked AS "Revoked", r.revoked_by_ip AS "RevokedByIp", r.replaced_by_token AS "ReplacedByToken", r.reason_revoked AS "ReasonRevoked", r.is_expired AS "IsExpired", r.is_revoked AS "IsRevoked", r.is_active AS "IsActive"
FROM refresh_token AS r
WHERE r.user_id = @__id_0
2022-09-20 18:36:01.517 +01:00 [DBG] A data reader was disposed.
2022-09-20 18:36:01.520 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-20 18:36:01.521 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-20 18:38:38.680 +01:00 [DBG] An entity of type 'User' tracked by 'PostgresContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-20 18:39:06.709 +01:00 [DBG] 'PostgresContext' generated a temporary value for the property 'Id.RefreshToken'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-20 18:39:06.740 +01:00 [DBG] Context 'PostgresContext' started tracking 'RefreshToken' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-20 18:39:07.961 +01:00 [DBG] SaveChanges starting for 'PostgresContext'.
2022-09-20 18:39:07.962 +01:00 [DBG] DetectChanges starting for 'PostgresContext'.
2022-09-20 18:39:07.980 +01:00 [DBG] 1 entities were added and 0 entities were removed from navigation 'User.RefreshTokenCollection'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-20 18:39:07.987 +01:00 [DBG] The foreign key property 'RefreshToken.UserId' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2022-09-20 18:39:07.990 +01:00 [DBG] DetectChanges completed for 'PostgresContext'.
2022-09-20 18:39:07.991 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-20 18:39:07.992 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-20 18:39:07.993 +01:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2022-09-20 18:39:07.993 +01:00 [DBG] Began transaction with isolation level 'ReadCommitted'.
2022-09-20 18:39:07.994 +01:00 [DBG] Executing 2 update commands as a batch.
2022-09-20 18:39:07.995 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-20 18:39:07.996 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2022-09-20 18:39:07.997 +01:00 [DBG] Executing DbCommand [Parameters=[@p0='?' (DbType = DateTime), @p1='?', @p2='?' (DbType = DateTime), @p3='?' (DbType = Boolean), @p4='?' (DbType = Boolean), @p5='?' (DbType = Boolean), @p6='?', @p7='?', @p8='?', @p9='?' (DbType = DateTime), @p10='?', @p11='?' (DbType = Int32), @p18='?' (DbType = Int32), @p12='?' (DbType = DateTime), @p13='?', @p14='?', @p15='?' (DbType = DateTime), @p16='?', @p17='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO refresh_token (created, created_by_ip, expires, is_active, is_expired, is_revoked, reason_revoked, token, replaced_by_token, revoked, revoked_by_ip, user_id)
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11)
RETURNING id;
UPDATE users SET created_at = @p12, email = @p13, full_name = @p14, password_changed_at = @p15, password_hash = @p16, username = @p17
WHERE id = @p18;
2022-09-20 18:39:07.999 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[@p0='?' (DbType = DateTime), @p1='?', @p2='?' (DbType = DateTime), @p3='?' (DbType = Boolean), @p4='?' (DbType = Boolean), @p5='?' (DbType = Boolean), @p6='?', @p7='?', @p8='?', @p9='?' (DbType = DateTime), @p10='?', @p11='?' (DbType = Int32), @p18='?' (DbType = Int32), @p12='?' (DbType = DateTime), @p13='?', @p14='?', @p15='?' (DbType = DateTime), @p16='?', @p17='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO refresh_token (created, created_by_ip, expires, is_active, is_expired, is_revoked, reason_revoked, token, replaced_by_token, revoked, revoked_by_ip, user_id)
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11)
RETURNING id;
UPDATE users SET created_at = @p12, email = @p13, full_name = @p14, password_changed_at = @p15, password_hash = @p16, username = @p17
WHERE id = @p18;
2022-09-20 18:39:08.004 +01:00 [DBG] The foreign key property 'RefreshToken.Id' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2022-09-20 18:39:08.006 +01:00 [DBG] A data reader was disposed.
2022-09-20 18:39:08.006 +01:00 [DBG] Committing transaction.
2022-09-20 18:39:08.007 +01:00 [DBG] Committed transaction.
2022-09-20 18:39:08.008 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-20 18:39:08.009 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-20 18:39:08.009 +01:00 [DBG] Disposing transaction.
2022-09-20 18:39:08.010 +01:00 [DBG] An entity of type 'RefreshToken' tracked by 'PostgresContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-20 18:39:08.011 +01:00 [DBG] An entity of type 'User' tracked by 'PostgresContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-20 18:39:08.012 +01:00 [DBG] SaveChanges completed for 'PostgresContext' with 2 entities written to the database.
2022-09-20 18:39:57.223 +01:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2022-09-20 18:39:57.233 +01:00 [DBG] Attempting to select an output formatter based on Accept header '["text/plain"]'.
2022-09-20 18:39:57.236 +01:00 [DBG] Could not find an output formatter based on content negotiation. Accepted types were (["text/plain"])
2022-09-20 18:39:57.237 +01:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2022-09-20 18:39:57.238 +01:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2022-09-20 18:39:57.239 +01:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2022-09-20 18:39:57.240 +01:00 [INF] Executing OkObjectResult, writing value of type 'APIBank.Models.Users.Responses.LoginResponse'.
2022-09-20 18:39:57.332 +01:00 [INF] Executed action APIBank.Controllers.UsersController.Login (APIBank) in 406516.2583ms
2022-09-20 18:39:57.334 +01:00 [INF] Executed endpoint 'APIBank.Controllers.UsersController.Login (APIBank)'
2022-09-20 18:40:26.207 +01:00 [DBG] 'PostgresContext' disposed.
2022-09-20 18:40:26.220 +01:00 [INF] Request finished HTTP/2 POST https://localhost:7036/api/Users/Login application/json 58 - 200 - application/json;+charset=utf-8 435983.7238ms
