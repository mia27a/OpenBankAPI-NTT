2022-09-23 10:59:45.887 +01:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2022-09-23 10:59:45.978 +01:00 [DBG] Hosting starting
2022-09-23 10:59:46.099 +01:00 [DBG] Using development certificate: CN=localhost (Thumbprint: 9CC642E9838495A6C3C202DECA6A8AD300396DD2)
2022-09-23 10:59:46.153 +01:00 [INF] Now listening on: https://localhost:7036
2022-09-23 10:59:46.155 +01:00 [INF] Now listening on: http://localhost:5036
2022-09-23 10:59:46.156 +01:00 [DBG] Loaded hosting startup assembly APIBank
2022-09-23 10:59:46.156 +01:00 [DBG] Loaded hosting startup assembly Microsoft.AspNetCore.Watch.BrowserRefresh
2022-09-23 10:59:46.157 +01:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.BrowserLink.Net
2022-09-23 10:59:46.158 +01:00 [INF] Application started. Press Ctrl+C to shut down.
2022-09-23 10:59:46.159 +01:00 [INF] Hosting environment: Development
2022-09-23 10:59:46.160 +01:00 [INF] Content root path: C:\Users\mguedesa\OneDrive - NTT DATA EMEAL\Documentos\GitHub\OpenBankAPI-NTT\APIBank\APIBank\
2022-09-23 10:59:46.160 +01:00 [DBG] Hosting started
2022-09-23 10:59:46.625 +01:00 [DBG] Connection id "0HMKT99C9SJG0" received FIN.
2022-09-23 10:59:46.636 +01:00 [DBG] Connection id "0HMKT99C9SJG0" accepted.
2022-09-23 10:59:46.638 +01:00 [DBG] Connection id "0HMKT99C9SJG0" started.
2022-09-23 10:59:46.669 +01:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException:  Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveBlobAsync[TIOAdapter](TIOAdapter adapter)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](TIOAdapter adapter, Boolean receiveFirst, Byte[] reAuthenticationData, Boolean isApm)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2022-09-23 10:59:46.708 +01:00 [DBG] Connection id "0HMKT99C9SJG0" stopped.
2022-09-23 10:59:46.712 +01:00 [DBG] Connection id "0HMKT99C9SJG0" sending FIN because: "The Socket transport's send loop completed gracefully."
2022-09-23 10:59:47.455 +01:00 [DBG] Connection id "0HMKT99C9SJG1" accepted.
2022-09-23 10:59:47.457 +01:00 [DBG] Connection id "0HMKT99C9SJG1" started.
2022-09-23 10:59:47.614 +01:00 [DBG] Connection 0HMKT99C9SJG1 established using the following protocol: "Tls12"
2022-09-23 10:59:47.703 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/swagger/index.html - -
2022-09-23 10:59:47.741 +01:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2022-09-23 10:59:47.767 +01:00 [DBG] No candidates found for the request path '/swagger/index.html'
2022-09-23 10:59:47.770 +01:00 [DBG] Request did not match any endpoints
2022-09-23 10:59:47.873 +01:00 [DBG] Response markup is scheduled to include browser refresh script injection.
2022-09-23 10:59:48.005 +01:00 [DBG] Response markup was updated to include browser refresh script injection.
2022-09-23 10:59:48.010 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/swagger/index.html - - - 200 - text/html;charset=utf-8 309.9568ms
2022-09-23 10:59:48.043 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/_framework/aspnetcore-browser-refresh.js - -
2022-09-23 10:59:48.044 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/_vs/browserLink - -
2022-09-23 10:59:48.052 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/_framework/aspnetcore-browser-refresh.js - - - 200 11984 application/javascript;+charset=utf-8 9.6402ms
2022-09-23 10:59:48.082 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/_vs/browserLink - - - 200 - text/javascript;+charset=UTF-8 36.8496ms
2022-09-23 10:59:48.204 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/swagger/v1/swagger.json - -
2022-09-23 10:59:48.207 +01:00 [DBG] No candidates found for the request path '/swagger/v1/swagger.json'
2022-09-23 10:59:48.207 +01:00 [DBG] Request did not match any endpoints
2022-09-23 10:59:48.393 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/swagger/v1/swagger.json - - - 200 - application/json;charset=utf-8 189.1407ms
2022-09-23 10:59:52.910 +01:00 [DBG] Connection id "0HMKT99C9SJG1" received FIN.
2022-09-23 10:59:52.916 +01:00 [DBG] Connection id "0HMKT99C9SJG1" is closed. The last processed stream ID was 7.
2022-09-23 10:59:52.919 +01:00 [DBG] Connection id "0HMKT99C9SJG1" sending FIN because: "The client closed the connection."
2022-09-23 10:59:52.924 +01:00 [DBG] Connection id "0HMKT99C9SJG1" stopped.
2022-09-23 11:00:14.400 +01:00 [DBG] Connection id "0HMKT99C9SJG2" accepted.
2022-09-23 11:00:14.405 +01:00 [DBG] Connection id "0HMKT99C9SJG2" started.
2022-09-23 11:00:14.411 +01:00 [DBG] Connection 0HMKT99C9SJG2 established using the following protocol: "Tls12"
2022-09-23 11:00:14.418 +01:00 [INF] Request starting HTTP/2 POST https://localhost:7036/api/Users/Login application/json 58
2022-09-23 11:00:14.428 +01:00 [DBG] 1 candidate(s) found for the request path '/api/Users/Login'
2022-09-23 11:00:14.433 +01:00 [DBG] Endpoint 'APIBank.Controllers.UsersController.Login (APIBank)' with route pattern 'api/Users/Login' is valid for the request path '/api/Users/Login'
2022-09-23 11:00:14.437 +01:00 [DBG] Request matched endpoint 'APIBank.Controllers.UsersController.Login (APIBank)'
2022-09-23 11:00:14.443 +01:00 [DBG] Static files was skipped as the request already matched an endpoint.
2022-09-23 11:00:14.743 +01:00 [INF] Executing endpoint 'APIBank.Controllers.UsersController.Login (APIBank)'
2022-09-23 11:00:14.776 +01:00 [INF] Route matched with {action = "Login", controller = "Users"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult Login(APIBank.Models.Requests.UserLoginRequest) on controller APIBank.Controllers.UsersController (APIBank).
2022-09-23 11:00:14.779 +01:00 [DBG] Execution plan of authorization filters (in the following order): ["APIBank.Authorization.AuthorizeAttribute"]
2022-09-23 11:00:14.780 +01:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2022-09-23 11:00:14.782 +01:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2022-09-23 11:00:14.785 +01:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2022-09-23 11:00:14.788 +01:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2022-09-23 11:00:14.792 +01:00 [DBG] Executing controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-23 11:00:14.793 +01:00 [DBG] Executed controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-23 11:00:14.805 +01:00 [DBG] Attempting to bind parameter 'model' of type 'APIBank.Models.Requests.UserLoginRequest' ...
2022-09-23 11:00:14.809 +01:00 [DBG] Attempting to bind parameter 'model' of type 'APIBank.Models.Requests.UserLoginRequest' using the name '' in request data ...
2022-09-23 11:00:14.810 +01:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2022-09-23 11:00:14.813 +01:00 [DBG] Connection id "0HMKT99C9SJG2", Request id "0HMKT99C9SJG2:00000001": started reading request body.
2022-09-23 11:00:14.814 +01:00 [DBG] Connection id "0HMKT99C9SJG2", Request id "0HMKT99C9SJG2:00000001": done reading request body.
2022-09-23 11:00:14.823 +01:00 [DBG] JSON input formatter succeeded, deserializing to type 'APIBank.Models.Requests.UserLoginRequest'
2022-09-23 11:00:14.824 +01:00 [DBG] Done attempting to bind parameter 'model' of type 'APIBank.Models.Requests.UserLoginRequest'.
2022-09-23 11:00:14.825 +01:00 [DBG] Done attempting to bind parameter 'model' of type 'APIBank.Models.Requests.UserLoginRequest'.
2022-09-23 11:00:14.826 +01:00 [DBG] Attempting to validate the bound parameter 'model' of type 'APIBank.Models.Requests.UserLoginRequest' ...
2022-09-23 11:00:14.835 +01:00 [DBG] Done attempting to validate the bound parameter 'model' of type 'APIBank.Models.Requests.UserLoginRequest'.
2022-09-23 11:00:14.914 +01:00 [DBG] An additional 'IServiceProvider' was created for internal use by Entity Framework. An existing service provider was not used due to the following configuration changes: configuration changed for 'Core:ConfigureWarnings', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:UseAdminDatabase', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:SetPostgresVersion', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:UseRedshift', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:ReverseNullOrdering', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:RemoteCertificateValidationCallback', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:ProvideClientCertificatesCallback', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:ProvidePasswordCallback'.
2022-09-23 11:00:15.723 +01:00 [INF] Entity Framework Core 6.0.9 initialized 'PostgresContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:6.0.7+5b98e4b74de93b590b44aef8dd7967c03acc433c' with options: None
2022-09-23 11:00:15.763 +01:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .SingleOrDefault(x => x.Username == __model_Username_0)'
2022-09-23 11:00:15.975 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<User>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: User.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: User.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 1], [Property: User.Email (string) Required Index MaxLength(254), 2], [Property: User.FullName (string) Required MaxLength(100), 3], [Property: User.PasswordChangedAt (DateTime) Required ValueGenerated.OnAdd, 4], [Property: User.PasswordHash (string) Required MaxLength(200), 5], [Property: User.Username (string) Required Index MaxLength(50), 6] }
        SELECT TOP(2) u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
        FROM users AS u
        WHERE u.username == @__model_Username_0), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, User>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)
    .SingleOrDefault()'
2022-09-23 11:00:16.013 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 11:00:16.050 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (36ms).
2022-09-23 11:00:16.058 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 11:00:16.304 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 11:00:16.316 +01:00 [DBG] Executing DbCommand [Parameters=[@__model_Username_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.username = @__model_Username_0
LIMIT 2
2022-09-23 11:00:16.395 +01:00 [INF] Executed DbCommand (83ms) [Parameters=[@__model_Username_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.username = @__model_Username_0
LIMIT 2
2022-09-23 11:00:16.429 +01:00 [DBG] Context 'PostgresContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 11:00:16.472 +01:00 [DBG] A data reader was disposed.
2022-09-23 11:00:16.475 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 11:00:16.478 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 11:00:16.646 +01:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .Any(user => user.RefreshTokenCollection
        .Any(reftoken => reftoken.RefToken == __token_0))'
2022-09-23 11:00:16.706 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<bool>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            EmptyProjectionMember -> 0
        SELECT EXISTS (
            SELECT 1
            FROM users AS u
            WHERE EXISTS (
                SELECT 1
                FROM refresh_token AS r
                WHERE ((u.id != NULL) && (u.id == r.user_id)) && (r.token == @__token_0)))), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, bool>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)
    .Single()'
2022-09-23 11:00:16.720 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 11:00:16.722 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2022-09-23 11:00:16.723 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 11:00:16.724 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 11:00:16.725 +01:00 [DBG] Executing DbCommand [Parameters=[@__token_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM users AS u
    WHERE EXISTS (
        SELECT 1
        FROM refresh_token AS r
        WHERE (u.id = r.user_id) AND (r.token = @__token_0)))
2022-09-23 11:00:16.729 +01:00 [INF] Executed DbCommand (4ms) [Parameters=[@__token_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM users AS u
    WHERE EXISTS (
        SELECT 1
        FROM refresh_token AS r
        WHERE (u.id = r.user_id) AND (r.token = @__token_0)))
2022-09-23 11:00:16.734 +01:00 [DBG] A data reader was disposed.
2022-09-23 11:00:16.736 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 11:00:16.737 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 11:00:16.860 +01:00 [DBG] Compiling query expression: 
'DbSet<RefreshToken>()
    .Where(rt => rt.UserId == __id_0)
    .AsNoTracking()
    .Select(rt => new RefreshToken{ 
        Id = rt.Id, 
        UserId = rt.UserId, 
        RefToken = rt.RefToken, 
        Expires = rt.Expires, 
        Created = rt.Created, 
        CreatedByIp = rt.CreatedByIp, 
        Revoked = rt.Revoked, 
        RevokedByIp = rt.RevokedByIp, 
        ReplacedByToken = rt.ReplacedByToken, 
        ReasonRevoked = rt.ReasonRevoked, 
        IsExpired = rt.IsExpired, 
        IsRevoked = rt.IsRevoked, 
        IsActive = rt.IsActive 
    }
    )'
2022-09-23 11:00:16.882 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<RefreshToken>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            Id -> 0
            UserId -> 1
            RefToken -> 2
            Expires -> 3
            Created -> 4
            CreatedByIp -> 5
            Revoked -> 6
            RevokedByIp -> 7
            ReplacedByToken -> 8
            ReasonRevoked -> 9
            IsExpired -> 10
            IsRevoked -> 11
            IsActive -> 12
        SELECT r.id AS Id, r.user_id AS UserId, r.token AS RefToken, r.expires AS Expires, r.created AS Created, r.created_by_ip AS CreatedByIp, r.revoked AS Revoked, r.revoked_by_ip AS RevokedByIp, r.replaced_by_token AS ReplacedByToken, r.reason_revoked AS ReasonRevoked, r.is_expired AS IsExpired, r.is_revoked AS IsRevoked, r.is_active AS IsActive
        FROM refresh_token AS r
        WHERE r.user_id == @__id_0), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, RefreshToken>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)'
2022-09-23 11:00:16.888 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 11:00:16.890 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2022-09-23 11:00:16.891 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 11:00:16.891 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 11:00:16.892 +01:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.user_id AS "UserId", r.token AS "RefToken", r.expires AS "Expires", r.created AS "Created", r.created_by_ip AS "CreatedByIp", r.revoked AS "Revoked", r.revoked_by_ip AS "RevokedByIp", r.replaced_by_token AS "ReplacedByToken", r.reason_revoked AS "ReasonRevoked", r.is_expired AS "IsExpired", r.is_revoked AS "IsRevoked", r.is_active AS "IsActive"
FROM refresh_token AS r
WHERE r.user_id = @__id_0
2022-09-23 11:00:16.896 +01:00 [INF] Executed DbCommand (4ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.user_id AS "UserId", r.token AS "RefToken", r.expires AS "Expires", r.created AS "Created", r.created_by_ip AS "CreatedByIp", r.revoked AS "Revoked", r.revoked_by_ip AS "RevokedByIp", r.replaced_by_token AS "ReplacedByToken", r.reason_revoked AS "ReasonRevoked", r.is_expired AS "IsExpired", r.is_revoked AS "IsRevoked", r.is_active AS "IsActive"
FROM refresh_token AS r
WHERE r.user_id = @__id_0
2022-09-23 11:00:16.901 +01:00 [DBG] A data reader was disposed.
2022-09-23 11:00:16.903 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 11:00:16.905 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 11:00:16.917 +01:00 [DBG] An entity of type 'User' tracked by 'PostgresContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 11:00:16.943 +01:00 [DBG] 'PostgresContext' generated a temporary value for the property 'Id.RefreshToken'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 11:00:16.978 +01:00 [DBG] Context 'PostgresContext' started tracking 'RefreshToken' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 11:00:16.985 +01:00 [DBG] SaveChanges starting for 'PostgresContext'.
2022-09-23 11:00:16.989 +01:00 [DBG] DetectChanges starting for 'PostgresContext'.
2022-09-23 11:00:17.015 +01:00 [DBG] 1 entities were added and 0 entities were removed from navigation 'User.RefreshTokenCollection'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 11:00:17.027 +01:00 [DBG] The foreign key property 'RefreshToken.UserId' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2022-09-23 11:00:17.045 +01:00 [DBG] DetectChanges completed for 'PostgresContext'.
2022-09-23 11:00:17.057 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 11:00:17.059 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 11:00:17.061 +01:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2022-09-23 11:00:17.070 +01:00 [DBG] Began transaction with isolation level 'ReadCommitted'.
2022-09-23 11:00:17.122 +01:00 [DBG] Executing 2 update commands as a batch.
2022-09-23 11:00:17.137 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 11:00:17.140 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (2ms).
2022-09-23 11:00:17.141 +01:00 [DBG] Executing DbCommand [Parameters=[@p0='?' (DbType = DateTime), @p1='?', @p2='?' (DbType = DateTime), @p3='?' (DbType = Boolean), @p4='?' (DbType = Boolean), @p5='?' (DbType = Boolean), @p6='?', @p7='?', @p8='?', @p9='?' (DbType = DateTime), @p10='?', @p11='?' (DbType = Int32), @p18='?' (DbType = Int32), @p12='?' (DbType = DateTime), @p13='?', @p14='?', @p15='?' (DbType = DateTime), @p16='?', @p17='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO refresh_token (created, created_by_ip, expires, is_active, is_expired, is_revoked, reason_revoked, token, replaced_by_token, revoked, revoked_by_ip, user_id)
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11)
RETURNING id;
UPDATE users SET created_at = @p12, email = @p13, full_name = @p14, password_changed_at = @p15, password_hash = @p16, username = @p17
WHERE id = @p18;
2022-09-23 11:00:17.154 +01:00 [INF] Executed DbCommand (13ms) [Parameters=[@p0='?' (DbType = DateTime), @p1='?', @p2='?' (DbType = DateTime), @p3='?' (DbType = Boolean), @p4='?' (DbType = Boolean), @p5='?' (DbType = Boolean), @p6='?', @p7='?', @p8='?', @p9='?' (DbType = DateTime), @p10='?', @p11='?' (DbType = Int32), @p18='?' (DbType = Int32), @p12='?' (DbType = DateTime), @p13='?', @p14='?', @p15='?' (DbType = DateTime), @p16='?', @p17='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO refresh_token (created, created_by_ip, expires, is_active, is_expired, is_revoked, reason_revoked, token, replaced_by_token, revoked, revoked_by_ip, user_id)
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11)
RETURNING id;
UPDATE users SET created_at = @p12, email = @p13, full_name = @p14, password_changed_at = @p15, password_hash = @p16, username = @p17
WHERE id = @p18;
2022-09-23 11:00:17.168 +01:00 [DBG] The foreign key property 'RefreshToken.Id' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2022-09-23 11:00:17.172 +01:00 [DBG] A data reader was disposed.
2022-09-23 11:00:17.174 +01:00 [DBG] Committing transaction.
2022-09-23 11:00:17.178 +01:00 [DBG] Committed transaction.
2022-09-23 11:00:17.179 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 11:00:17.183 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 11:00:17.187 +01:00 [DBG] Disposing transaction.
2022-09-23 11:00:17.191 +01:00 [DBG] An entity of type 'RefreshToken' tracked by 'PostgresContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 11:00:17.192 +01:00 [DBG] An entity of type 'User' tracked by 'PostgresContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 11:00:17.194 +01:00 [DBG] SaveChanges completed for 'PostgresContext' with 2 entities written to the database.
2022-09-23 11:00:17.203 +01:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2022-09-23 11:00:17.206 +01:00 [DBG] Attempting to select an output formatter based on Accept header '["text/plain"]'.
2022-09-23 11:00:17.207 +01:00 [DBG] Could not find an output formatter based on content negotiation. Accepted types were (["text/plain"])
2022-09-23 11:00:17.209 +01:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2022-09-23 11:00:17.209 +01:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2022-09-23 11:00:17.212 +01:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2022-09-23 11:00:17.215 +01:00 [INF] Executing OkObjectResult, writing value of type 'APIBank.Models.MyRequestResponses.LoginResponse'.
2022-09-23 11:00:17.228 +01:00 [INF] Executed action APIBank.Controllers.UsersController.Login (APIBank) in 2433.2415ms
2022-09-23 11:00:17.229 +01:00 [INF] Executed endpoint 'APIBank.Controllers.UsersController.Login (APIBank)'
2022-09-23 11:00:17.233 +01:00 [DBG] 'PostgresContext' disposed.
2022-09-23 11:00:17.238 +01:00 [INF] Request finished HTTP/2 POST https://localhost:7036/api/Users/Login application/json 58 - 200 - application/json;+charset=utf-8 2820.5497ms
2022-09-23 11:00:22.945 +01:00 [DBG] Connection id "0HMKT99C9SJG2" received FIN.
2022-09-23 11:00:22.949 +01:00 [DBG] Connection id "0HMKT99C9SJG2" is closed. The last processed stream ID was 1.
2022-09-23 11:00:22.949 +01:00 [DBG] Connection id "0HMKT99C9SJG2" sending FIN because: "The client closed the connection."
2022-09-23 11:00:22.952 +01:00 [DBG] Connection id "0HMKT99C9SJG2" stopped.
2022-09-23 13:06:36.935 +01:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2022-09-23 13:06:37.028 +01:00 [DBG] Hosting starting
2022-09-23 13:06:37.112 +01:00 [DBG] Using development certificate: CN=localhost (Thumbprint: 9CC642E9838495A6C3C202DECA6A8AD300396DD2)
2022-09-23 13:06:37.155 +01:00 [INF] Now listening on: https://localhost:7036
2022-09-23 13:06:37.157 +01:00 [INF] Now listening on: http://localhost:5036
2022-09-23 13:06:37.158 +01:00 [DBG] Loaded hosting startup assembly APIBank
2022-09-23 13:06:37.158 +01:00 [DBG] Loaded hosting startup assembly Microsoft.AspNetCore.Watch.BrowserRefresh
2022-09-23 13:06:37.159 +01:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.BrowserLink.Net
2022-09-23 13:06:37.159 +01:00 [INF] Application started. Press Ctrl+C to shut down.
2022-09-23 13:06:37.160 +01:00 [INF] Hosting environment: Development
2022-09-23 13:06:37.160 +01:00 [INF] Content root path: C:\Users\mguedesa\OneDrive - NTT DATA EMEAL\Documentos\GitHub\OpenBankAPI-NTT\APIBank\APIBank\
2022-09-23 13:06:37.161 +01:00 [DBG] Hosting started
2022-09-23 13:06:37.172 +01:00 [DBG] Connection id "0HMKTBG8DMKI9" accepted.
2022-09-23 13:06:37.172 +01:00 [DBG] Connection id "0HMKTBG8DMKIA" accepted.
2022-09-23 13:06:37.175 +01:00 [DBG] Connection id "0HMKTBG8DMKI9" started.
2022-09-23 13:06:37.175 +01:00 [DBG] Connection id "0HMKTBG8DMKIA" started.
2022-09-23 13:06:37.188 +01:00 [DBG] Connection id "0HMKTBG8DMKIA" received FIN.
2022-09-23 13:06:37.188 +01:00 [DBG] Connection id "0HMKTBG8DMKI9" received FIN.
2022-09-23 13:06:37.195 +01:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException:  Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.<FillHandshakeBufferAsync>g__InternalFillHandshakeBufferAsync|189_0[TIOAdapter](TIOAdapter adap, ValueTask`1 task, Int32 minSize)
   at System.Net.Security.SslStream.ReceiveBlobAsync[TIOAdapter](TIOAdapter adapter)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](TIOAdapter adapter, Boolean receiveFirst, Byte[] reAuthenticationData, Boolean isApm)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2022-09-23 13:06:37.195 +01:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException:  Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveBlobAsync[TIOAdapter](TIOAdapter adapter)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](TIOAdapter adapter, Boolean receiveFirst, Byte[] reAuthenticationData, Boolean isApm)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2022-09-23 13:06:37.224 +01:00 [DBG] Connection id "0HMKTBG8DMKIA" stopped.
2022-09-23 13:06:37.224 +01:00 [DBG] Connection id "0HMKTBG8DMKI9" stopped.
2022-09-23 13:06:37.226 +01:00 [DBG] Connection id "0HMKTBG8DMKI9" sending FIN because: "The Socket transport's send loop completed gracefully."
2022-09-23 13:06:37.226 +01:00 [DBG] Connection id "0HMKTBG8DMKIA" sending FIN because: "The Socket transport's send loop completed gracefully."
2022-09-23 13:06:37.346 +01:00 [DBG] Connection id "0HMKTBG8DMKIB" accepted.
2022-09-23 13:06:37.349 +01:00 [DBG] Connection id "0HMKTBG8DMKIB" started.
2022-09-23 13:06:37.396 +01:00 [DBG] Connection 0HMKTBG8DMKIB established using the following protocol: "Tls12"
2022-09-23 13:06:37.445 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/swagger/index.html - -
2022-09-23 13:06:37.475 +01:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2022-09-23 13:06:37.498 +01:00 [DBG] No candidates found for the request path '/swagger/index.html'
2022-09-23 13:06:37.499 +01:00 [DBG] Request did not match any endpoints
2022-09-23 13:06:37.586 +01:00 [DBG] Response markup is scheduled to include browser refresh script injection.
2022-09-23 13:06:37.686 +01:00 [DBG] Response markup was updated to include browser refresh script injection.
2022-09-23 13:06:37.691 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/swagger/index.html - - - 200 - text/html;charset=utf-8 247.9475ms
2022-09-23 13:06:37.740 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/_framework/aspnetcore-browser-refresh.js - -
2022-09-23 13:06:37.740 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/_vs/browserLink - -
2022-09-23 13:06:37.746 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/_framework/aspnetcore-browser-refresh.js - - - 200 11984 application/javascript;+charset=utf-8 5.4610ms
2022-09-23 13:06:37.779 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/_vs/browserLink - - - 200 - text/javascript;+charset=UTF-8 38.3531ms
2022-09-23 13:06:38.021 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/swagger/v1/swagger.json - -
2022-09-23 13:06:38.022 +01:00 [DBG] No candidates found for the request path '/swagger/v1/swagger.json'
2022-09-23 13:06:38.023 +01:00 [DBG] Request did not match any endpoints
2022-09-23 13:06:38.150 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/swagger/v1/swagger.json - - - 200 - application/json;charset=utf-8 129.1540ms
2022-09-23 13:08:50.536 +01:00 [DBG] Connection id "0HMKTBG8DMKIB" is closing.
2022-09-23 13:08:50.545 +01:00 [DBG] Connection id "0HMKTBG8DMKIB" is closed. The last processed stream ID was 7.
2022-09-23 13:08:50.547 +01:00 [DBG] Connection id "0HMKTBG8DMKIB" received FIN.
2022-09-23 13:08:50.549 +01:00 [DBG] Connection id "0HMKTBG8DMKIB" sending FIN because: "The client closed the connection."
2022-09-23 13:08:50.553 +01:00 [DBG] Connection id "0HMKTBG8DMKIB" stopped.
2022-09-23 13:10:05.873 +01:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2022-09-23 13:10:05.977 +01:00 [DBG] Hosting starting
2022-09-23 13:10:06.069 +01:00 [DBG] Using development certificate: CN=localhost (Thumbprint: 9CC642E9838495A6C3C202DECA6A8AD300396DD2)
2022-09-23 13:10:06.115 +01:00 [INF] Now listening on: https://localhost:7036
2022-09-23 13:10:06.117 +01:00 [INF] Now listening on: http://localhost:5036
2022-09-23 13:10:06.119 +01:00 [DBG] Loaded hosting startup assembly APIBank
2022-09-23 13:10:06.120 +01:00 [DBG] Loaded hosting startup assembly Microsoft.AspNetCore.Watch.BrowserRefresh
2022-09-23 13:10:06.121 +01:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.BrowserLink.Net
2022-09-23 13:10:06.121 +01:00 [INF] Application started. Press Ctrl+C to shut down.
2022-09-23 13:10:06.122 +01:00 [INF] Hosting environment: Development
2022-09-23 13:10:06.123 +01:00 [INF] Content root path: C:\Users\mguedesa\OneDrive - NTT DATA EMEAL\Documentos\GitHub\OpenBankAPI-NTT\APIBank\APIBank\
2022-09-23 13:10:06.123 +01:00 [DBG] Hosting started
2022-09-23 13:10:06.589 +01:00 [DBG] Connection id "0HMKTBI6QS6EA" received FIN.
2022-09-23 13:10:06.589 +01:00 [DBG] Connection id "0HMKTBI6QS6E9" received FIN.
2022-09-23 13:10:06.596 +01:00 [DBG] Connection id "0HMKTBI6QS6E9" accepted.
2022-09-23 13:10:06.596 +01:00 [DBG] Connection id "0HMKTBI6QS6EA" accepted.
2022-09-23 13:10:06.598 +01:00 [DBG] Connection id "0HMKTBI6QS6E9" started.
2022-09-23 13:10:06.598 +01:00 [DBG] Connection id "0HMKTBI6QS6EA" started.
2022-09-23 13:10:06.613 +01:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException:  Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveBlobAsync[TIOAdapter](TIOAdapter adapter)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](TIOAdapter adapter, Boolean receiveFirst, Byte[] reAuthenticationData, Boolean isApm)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2022-09-23 13:10:06.613 +01:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException:  Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveBlobAsync[TIOAdapter](TIOAdapter adapter)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](TIOAdapter adapter, Boolean receiveFirst, Byte[] reAuthenticationData, Boolean isApm)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2022-09-23 13:10:06.638 +01:00 [DBG] Connection id "0HMKTBI6QS6EA" stopped.
2022-09-23 13:10:06.638 +01:00 [DBG] Connection id "0HMKTBI6QS6E9" stopped.
2022-09-23 13:10:06.641 +01:00 [DBG] Connection id "0HMKTBI6QS6EA" sending FIN because: "The Socket transport's send loop completed gracefully."
2022-09-23 13:10:06.641 +01:00 [DBG] Connection id "0HMKTBI6QS6E9" sending FIN because: "The Socket transport's send loop completed gracefully."
2022-09-23 13:10:06.694 +01:00 [DBG] Connection id "0HMKTBI6QS6EB" accepted.
2022-09-23 13:10:06.696 +01:00 [DBG] Connection id "0HMKTBI6QS6EB" started.
2022-09-23 13:10:06.730 +01:00 [DBG] Connection 0HMKTBI6QS6EB established using the following protocol: "Tls12"
2022-09-23 13:10:06.764 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/swagger/index.html - -
2022-09-23 13:10:06.792 +01:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2022-09-23 13:10:06.811 +01:00 [DBG] No candidates found for the request path '/swagger/index.html'
2022-09-23 13:10:06.815 +01:00 [DBG] Request did not match any endpoints
2022-09-23 13:10:06.895 +01:00 [DBG] Response markup is scheduled to include browser refresh script injection.
2022-09-23 13:10:06.988 +01:00 [DBG] Response markup was updated to include browser refresh script injection.
2022-09-23 13:10:06.993 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/swagger/index.html - - - 200 - text/html;charset=utf-8 231.4472ms
2022-09-23 13:10:07.019 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/_framework/aspnetcore-browser-refresh.js - -
2022-09-23 13:10:07.019 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/_vs/browserLink - -
2022-09-23 13:10:07.024 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/_framework/aspnetcore-browser-refresh.js - - - 200 11984 application/javascript;+charset=utf-8 4.7630ms
2022-09-23 13:10:07.050 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/_vs/browserLink - - - 200 - text/javascript;+charset=UTF-8 31.5196ms
2022-09-23 13:10:07.190 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/swagger/v1/swagger.json - -
2022-09-23 13:10:07.192 +01:00 [DBG] No candidates found for the request path '/swagger/v1/swagger.json'
2022-09-23 13:10:07.193 +01:00 [DBG] Request did not match any endpoints
2022-09-23 13:10:07.319 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/swagger/v1/swagger.json - - - 200 - application/json;charset=utf-8 128.7200ms
2022-09-23 13:10:27.700 +01:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2022-09-23 13:10:27.842 +01:00 [DBG] Hosting starting
2022-09-23 13:10:27.934 +01:00 [DBG] Loaded hosting startup assembly APIBank
2022-09-23 13:10:27.934 +01:00 [DBG] Loaded hosting startup assembly Microsoft.AspNetCore.Watch.BrowserRefresh
2022-09-23 13:10:27.934 +01:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.BrowserLink.Net
2022-09-23 13:10:27.935 +01:00 [INF] Application started. Press Ctrl+C to shut down.
2022-09-23 13:10:27.935 +01:00 [INF] Hosting environment: Development
2022-09-23 13:10:27.935 +01:00 [INF] Content root path: C:\Users\mguedesa\OneDrive - NTT DATA EMEAL\Documentos\GitHub\OpenBankAPI-NTT\APIBank\APIBank\
2022-09-23 13:10:27.935 +01:00 [DBG] Hosting started
2022-09-23 13:10:27.990 +01:00 [INF] Request starting HTTP/2 GET https://localhost:44312/swagger/index.html - -
2022-09-23 13:10:28.040 +01:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2022-09-23 13:10:28.065 +01:00 [DBG] No candidates found for the request path '/swagger/index.html'
2022-09-23 13:10:28.066 +01:00 [DBG] Request did not match any endpoints
2022-09-23 13:10:28.198 +01:00 [DBG] Response markup is scheduled to include browser refresh script injection.
2022-09-23 13:10:28.422 +01:00 [DBG] Response markup was updated to include browser refresh script injection.
2022-09-23 13:10:28.430 +01:00 [DBG] Connection ID "17942340947119440225" disconnecting.
2022-09-23 13:10:28.433 +01:00 [INF] Request finished HTTP/2 GET https://localhost:44312/swagger/index.html - - - 200 - text/html;charset=utf-8 444.5284ms
2022-09-23 13:10:28.457 +01:00 [INF] Request starting HTTP/2 GET https://localhost:44312/_framework/aspnetcore-browser-refresh.js - -
2022-09-23 13:10:28.459 +01:00 [INF] Request starting HTTP/2 GET https://localhost:44312/_vs/browserLink - -
2022-09-23 13:10:28.492 +01:00 [INF] Request finished HTTP/2 GET https://localhost:44312/_framework/aspnetcore-browser-refresh.js - - - 200 11984 application/javascript;+charset=utf-8 34.6272ms
2022-09-23 13:10:28.499 +01:00 [DBG] Connection ID "18374686494167138978" disconnecting.
2022-09-23 13:10:28.529 +01:00 [DBG] Connection ID "18158513707758387908" disconnecting.
2022-09-23 13:10:28.530 +01:00 [INF] Request finished HTTP/2 GET https://localhost:44312/_vs/browserLink - - - 200 - text/javascript;+charset=UTF-8 70.8776ms
2022-09-23 13:10:28.678 +01:00 [INF] Request starting HTTP/2 GET https://localhost:44312/swagger/v1/swagger.json - -
2022-09-23 13:10:28.679 +01:00 [DBG] No candidates found for the request path '/swagger/v1/swagger.json'
2022-09-23 13:10:28.679 +01:00 [DBG] Request did not match any endpoints
2022-09-23 13:10:28.870 +01:00 [INF] Request finished HTTP/2 GET https://localhost:44312/swagger/v1/swagger.json - - - 200 - application/json;charset=utf-8 191.7710ms
2022-09-23 13:10:28.870 +01:00 [DBG] Connection ID "18158513707758387910" disconnecting.
2022-09-23 13:11:45.313 +01:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2022-09-23 13:11:45.385 +01:00 [DBG] Hosting starting
2022-09-23 13:11:45.468 +01:00 [DBG] Using development certificate: CN=localhost (Thumbprint: 9CC642E9838495A6C3C202DECA6A8AD300396DD2)
2022-09-23 13:11:45.509 +01:00 [INF] Now listening on: https://localhost:7036
2022-09-23 13:11:45.512 +01:00 [INF] Now listening on: http://localhost:5036
2022-09-23 13:11:45.514 +01:00 [DBG] Loaded hosting startup assembly APIBank
2022-09-23 13:11:45.515 +01:00 [DBG] Loaded hosting startup assembly Microsoft.AspNetCore.Watch.BrowserRefresh
2022-09-23 13:11:45.515 +01:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.BrowserLink.Net
2022-09-23 13:11:45.516 +01:00 [INF] Application started. Press Ctrl+C to shut down.
2022-09-23 13:11:45.516 +01:00 [INF] Hosting environment: Development
2022-09-23 13:11:45.517 +01:00 [INF] Content root path: C:\Users\mguedesa\OneDrive - NTT DATA EMEAL\Documentos\GitHub\OpenBankAPI-NTT\APIBank\APIBank\
2022-09-23 13:11:45.518 +01:00 [DBG] Hosting started
2022-09-23 13:11:45.621 +01:00 [DBG] Connection id "0HMKTBJ4B9SGI" accepted.
2022-09-23 13:11:45.621 +01:00 [DBG] Connection id "0HMKTBJ4B9SGJ" accepted.
2022-09-23 13:11:45.624 +01:00 [DBG] Connection id "0HMKTBJ4B9SGI" started.
2022-09-23 13:11:45.624 +01:00 [DBG] Connection id "0HMKTBJ4B9SGJ" started.
2022-09-23 13:11:45.628 +01:00 [DBG] Connection id "0HMKTBJ4B9SGI" received FIN.
2022-09-23 13:11:45.628 +01:00 [DBG] Connection id "0HMKTBJ4B9SGJ" received FIN.
2022-09-23 13:11:45.639 +01:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException:  Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveBlobAsync[TIOAdapter](TIOAdapter adapter)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](TIOAdapter adapter, Boolean receiveFirst, Byte[] reAuthenticationData, Boolean isApm)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2022-09-23 13:11:45.639 +01:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException:  Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveBlobAsync[TIOAdapter](TIOAdapter adapter)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](TIOAdapter adapter, Boolean receiveFirst, Byte[] reAuthenticationData, Boolean isApm)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2022-09-23 13:11:45.663 +01:00 [DBG] Connection id "0HMKTBJ4B9SGJ" stopped.
2022-09-23 13:11:45.663 +01:00 [DBG] Connection id "0HMKTBJ4B9SGI" stopped.
2022-09-23 13:11:45.665 +01:00 [DBG] Connection id "0HMKTBJ4B9SGJ" sending FIN because: "The Socket transport's send loop completed gracefully."
2022-09-23 13:11:45.665 +01:00 [DBG] Connection id "0HMKTBJ4B9SGI" sending FIN because: "The Socket transport's send loop completed gracefully."
2022-09-23 13:11:45.848 +01:00 [DBG] Connection id "0HMKTBJ4B9SGK" accepted.
2022-09-23 13:11:45.851 +01:00 [DBG] Connection id "0HMKTBJ4B9SGK" started.
2022-09-23 13:11:45.931 +01:00 [DBG] Connection 0HMKTBJ4B9SGK established using the following protocol: "Tls12"
2022-09-23 13:11:46.021 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/swagger/index.html - -
2022-09-23 13:11:46.057 +01:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2022-09-23 13:11:46.085 +01:00 [DBG] No candidates found for the request path '/swagger/index.html'
2022-09-23 13:11:46.087 +01:00 [DBG] Request did not match any endpoints
2022-09-23 13:11:46.182 +01:00 [DBG] Response markup is scheduled to include browser refresh script injection.
2022-09-23 13:11:46.292 +01:00 [DBG] Response markup was updated to include browser refresh script injection.
2022-09-23 13:11:46.307 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/swagger/index.html - - - 200 - text/html;charset=utf-8 292.7107ms
2022-09-23 13:11:46.348 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/_framework/aspnetcore-browser-refresh.js - -
2022-09-23 13:11:46.356 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/_framework/aspnetcore-browser-refresh.js - - - 200 11984 application/javascript;+charset=utf-8 8.0719ms
2022-09-23 13:11:46.360 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/_vs/browserLink - -
2022-09-23 13:11:46.397 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/_vs/browserLink - - - 200 - text/javascript;+charset=UTF-8 36.7956ms
2022-09-23 13:11:46.523 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/swagger/v1/swagger.json - -
2022-09-23 13:11:46.526 +01:00 [DBG] No candidates found for the request path '/swagger/v1/swagger.json'
2022-09-23 13:11:46.528 +01:00 [DBG] Request did not match any endpoints
2022-09-23 13:11:46.699 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/swagger/v1/swagger.json - - - 200 - application/json;charset=utf-8 176.2284ms
2022-09-23 13:11:56.089 +01:00 [INF] Request starting HTTP/2 POST https://localhost:7036/api/Users/Login application/json 58
2022-09-23 13:11:56.113 +01:00 [DBG] 1 candidate(s) found for the request path '/api/Users/Login'
2022-09-23 13:11:56.118 +01:00 [DBG] Endpoint 'APIBank.Controllers.UsersController.Login (APIBank)' with route pattern 'api/Users/Login' is valid for the request path '/api/Users/Login'
2022-09-23 13:11:56.120 +01:00 [DBG] Request matched endpoint 'APIBank.Controllers.UsersController.Login (APIBank)'
2022-09-23 13:11:56.126 +01:00 [DBG] Static files was skipped as the request already matched an endpoint.
2022-09-23 13:11:56.405 +01:00 [INF] Executing endpoint 'APIBank.Controllers.UsersController.Login (APIBank)'
2022-09-23 13:11:56.432 +01:00 [INF] Route matched with {action = "Login", controller = "Users"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult Login(APIBank.Models.Requests.UserLoginRequest) on controller APIBank.Controllers.UsersController (APIBank).
2022-09-23 13:11:56.436 +01:00 [DBG] Execution plan of authorization filters (in the following order): ["APIBank.Authorization.AuthorizeAttribute"]
2022-09-23 13:11:56.437 +01:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2022-09-23 13:11:56.438 +01:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2022-09-23 13:11:56.439 +01:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2022-09-23 13:11:56.444 +01:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2022-09-23 13:11:56.448 +01:00 [DBG] Executing controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-23 13:11:56.450 +01:00 [DBG] Executed controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-23 13:11:56.459 +01:00 [DBG] Attempting to bind parameter 'model' of type 'APIBank.Models.Requests.UserLoginRequest' ...
2022-09-23 13:11:56.464 +01:00 [DBG] Attempting to bind parameter 'model' of type 'APIBank.Models.Requests.UserLoginRequest' using the name '' in request data ...
2022-09-23 13:11:56.466 +01:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2022-09-23 13:11:56.471 +01:00 [DBG] Connection id "0HMKTBJ4B9SGK", Request id "0HMKTBJ4B9SGK:00000009": started reading request body.
2022-09-23 13:11:56.473 +01:00 [DBG] Connection id "0HMKTBJ4B9SGK", Request id "0HMKTBJ4B9SGK:00000009": done reading request body.
2022-09-23 13:11:56.483 +01:00 [DBG] JSON input formatter succeeded, deserializing to type 'APIBank.Models.Requests.UserLoginRequest'
2022-09-23 13:11:56.484 +01:00 [DBG] Done attempting to bind parameter 'model' of type 'APIBank.Models.Requests.UserLoginRequest'.
2022-09-23 13:11:56.485 +01:00 [DBG] Done attempting to bind parameter 'model' of type 'APIBank.Models.Requests.UserLoginRequest'.
2022-09-23 13:11:56.486 +01:00 [DBG] Attempting to validate the bound parameter 'model' of type 'APIBank.Models.Requests.UserLoginRequest' ...
2022-09-23 13:11:56.500 +01:00 [DBG] Done attempting to validate the bound parameter 'model' of type 'APIBank.Models.Requests.UserLoginRequest'.
2022-09-23 13:11:56.594 +01:00 [DBG] An additional 'IServiceProvider' was created for internal use by Entity Framework. An existing service provider was not used due to the following configuration changes: configuration changed for 'Core:ConfigureWarnings', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:UseAdminDatabase', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:SetPostgresVersion', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:UseRedshift', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:ReverseNullOrdering', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:RemoteCertificateValidationCallback', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:ProvideClientCertificatesCallback', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:ProvidePasswordCallback'.
2022-09-23 13:11:57.456 +01:00 [INF] Entity Framework Core 6.0.9 initialized 'PostgresContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:6.0.7+5b98e4b74de93b590b44aef8dd7967c03acc433c' with options: None
2022-09-23 13:11:57.490 +01:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .SingleOrDefault(x => x.Username == __model_Username_0)'
2022-09-23 13:11:57.700 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<User>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: User.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: User.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 1], [Property: User.Email (string) Required Index MaxLength(254), 2], [Property: User.FullName (string) Required MaxLength(100), 3], [Property: User.PasswordChangedAt (DateTime) Required ValueGenerated.OnAdd, 4], [Property: User.PasswordHash (string) Required MaxLength(200), 5], [Property: User.Username (string) Required Index MaxLength(50), 6] }
        SELECT TOP(2) u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
        FROM users AS u
        WHERE u.username == @__model_Username_0), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, User>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)
    .SingleOrDefault()'
2022-09-23 13:11:57.731 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 13:11:57.765 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (32ms).
2022-09-23 13:11:57.770 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 13:11:58.102 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 13:11:58.114 +01:00 [DBG] Executing DbCommand [Parameters=[@__model_Username_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.username = @__model_Username_0
LIMIT 2
2022-09-23 13:11:58.183 +01:00 [INF] Executed DbCommand (74ms) [Parameters=[@__model_Username_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.username = @__model_Username_0
LIMIT 2
2022-09-23 13:11:58.225 +01:00 [DBG] Context 'PostgresContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 13:11:58.265 +01:00 [DBG] A data reader was disposed.
2022-09-23 13:11:58.268 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 13:11:58.272 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 13:11:58.443 +01:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .Any(user => user.RefreshTokenCollection
        .Any(reftoken => reftoken.RefToken == __token_0))'
2022-09-23 13:11:58.497 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<bool>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            EmptyProjectionMember -> 0
        SELECT EXISTS (
            SELECT 1
            FROM users AS u
            WHERE EXISTS (
                SELECT 1
                FROM refresh_token AS r
                WHERE ((u.id != NULL) && (u.id == r.user_id)) && (r.token == @__token_0)))), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, bool>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)
    .Single()'
2022-09-23 13:11:58.505 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 13:11:58.508 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (2ms).
2022-09-23 13:11:58.510 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 13:11:58.511 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 13:11:58.512 +01:00 [DBG] Executing DbCommand [Parameters=[@__token_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM users AS u
    WHERE EXISTS (
        SELECT 1
        FROM refresh_token AS r
        WHERE (u.id = r.user_id) AND (r.token = @__token_0)))
2022-09-23 13:11:58.515 +01:00 [INF] Executed DbCommand (3ms) [Parameters=[@__token_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM users AS u
    WHERE EXISTS (
        SELECT 1
        FROM refresh_token AS r
        WHERE (u.id = r.user_id) AND (r.token = @__token_0)))
2022-09-23 13:11:58.517 +01:00 [DBG] A data reader was disposed.
2022-09-23 13:11:58.518 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 13:11:58.519 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 13:11:58.645 +01:00 [DBG] Compiling query expression: 
'DbSet<RefreshToken>()
    .Where(rt => rt.UserId == __id_0)
    .AsNoTracking()
    .Select(rt => new RefreshToken{ 
        Id = rt.Id, 
        UserId = rt.UserId, 
        RefToken = rt.RefToken, 
        Expires = rt.Expires, 
        Created = rt.Created, 
        CreatedByIp = rt.CreatedByIp, 
        Revoked = rt.Revoked, 
        RevokedByIp = rt.RevokedByIp, 
        ReplacedByToken = rt.ReplacedByToken, 
        ReasonRevoked = rt.ReasonRevoked, 
        IsExpired = rt.IsExpired, 
        IsRevoked = rt.IsRevoked, 
        IsActive = rt.IsActive 
    }
    )'
2022-09-23 13:11:58.665 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<RefreshToken>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            Id -> 0
            UserId -> 1
            RefToken -> 2
            Expires -> 3
            Created -> 4
            CreatedByIp -> 5
            Revoked -> 6
            RevokedByIp -> 7
            ReplacedByToken -> 8
            ReasonRevoked -> 9
            IsExpired -> 10
            IsRevoked -> 11
            IsActive -> 12
        SELECT r.id AS Id, r.user_id AS UserId, r.token AS RefToken, r.expires AS Expires, r.created AS Created, r.created_by_ip AS CreatedByIp, r.revoked AS Revoked, r.revoked_by_ip AS RevokedByIp, r.replaced_by_token AS ReplacedByToken, r.reason_revoked AS ReasonRevoked, r.is_expired AS IsExpired, r.is_revoked AS IsRevoked, r.is_active AS IsActive
        FROM refresh_token AS r
        WHERE r.user_id == @__id_0), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, RefreshToken>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)'
2022-09-23 13:11:58.668 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 13:11:58.669 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2022-09-23 13:11:58.670 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 13:11:58.672 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 13:11:58.676 +01:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.user_id AS "UserId", r.token AS "RefToken", r.expires AS "Expires", r.created AS "Created", r.created_by_ip AS "CreatedByIp", r.revoked AS "Revoked", r.revoked_by_ip AS "RevokedByIp", r.replaced_by_token AS "ReplacedByToken", r.reason_revoked AS "ReasonRevoked", r.is_expired AS "IsExpired", r.is_revoked AS "IsRevoked", r.is_active AS "IsActive"
FROM refresh_token AS r
WHERE r.user_id = @__id_0
2022-09-23 13:11:58.681 +01:00 [INF] Executed DbCommand (5ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.user_id AS "UserId", r.token AS "RefToken", r.expires AS "Expires", r.created AS "Created", r.created_by_ip AS "CreatedByIp", r.revoked AS "Revoked", r.revoked_by_ip AS "RevokedByIp", r.replaced_by_token AS "ReplacedByToken", r.reason_revoked AS "ReasonRevoked", r.is_expired AS "IsExpired", r.is_revoked AS "IsRevoked", r.is_active AS "IsActive"
FROM refresh_token AS r
WHERE r.user_id = @__id_0
2022-09-23 13:11:58.683 +01:00 [DBG] A data reader was disposed.
2022-09-23 13:11:58.683 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 13:11:58.684 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 13:11:58.697 +01:00 [DBG] An entity of type 'User' tracked by 'PostgresContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 13:11:58.717 +01:00 [DBG] 'PostgresContext' generated a temporary value for the property 'Id.RefreshToken'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 13:11:58.746 +01:00 [DBG] Context 'PostgresContext' started tracking 'RefreshToken' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 13:11:58.749 +01:00 [DBG] SaveChanges starting for 'PostgresContext'.
2022-09-23 13:11:58.752 +01:00 [DBG] DetectChanges starting for 'PostgresContext'.
2022-09-23 13:11:58.779 +01:00 [DBG] 1 entities were added and 0 entities were removed from navigation 'User.RefreshTokenCollection'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 13:11:58.793 +01:00 [DBG] The foreign key property 'RefreshToken.UserId' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2022-09-23 13:11:58.807 +01:00 [DBG] DetectChanges completed for 'PostgresContext'.
2022-09-23 13:11:58.816 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 13:11:58.818 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 13:11:58.820 +01:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2022-09-23 13:11:58.828 +01:00 [DBG] Began transaction with isolation level 'ReadCommitted'.
2022-09-23 13:11:58.882 +01:00 [DBG] Executing 2 update commands as a batch.
2022-09-23 13:11:58.896 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 13:11:58.897 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2022-09-23 13:11:58.899 +01:00 [DBG] Executing DbCommand [Parameters=[@p0='?' (DbType = DateTime), @p1='?', @p2='?' (DbType = DateTime), @p3='?' (DbType = Boolean), @p4='?' (DbType = Boolean), @p5='?' (DbType = Boolean), @p6='?', @p7='?', @p8='?', @p9='?' (DbType = DateTime), @p10='?', @p11='?' (DbType = Int32), @p18='?' (DbType = Int32), @p12='?' (DbType = DateTime), @p13='?', @p14='?', @p15='?' (DbType = DateTime), @p16='?', @p17='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO refresh_token (created, created_by_ip, expires, is_active, is_expired, is_revoked, reason_revoked, token, replaced_by_token, revoked, revoked_by_ip, user_id)
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11)
RETURNING id;
UPDATE users SET created_at = @p12, email = @p13, full_name = @p14, password_changed_at = @p15, password_hash = @p16, username = @p17
WHERE id = @p18;
2022-09-23 13:11:58.912 +01:00 [INF] Executed DbCommand (13ms) [Parameters=[@p0='?' (DbType = DateTime), @p1='?', @p2='?' (DbType = DateTime), @p3='?' (DbType = Boolean), @p4='?' (DbType = Boolean), @p5='?' (DbType = Boolean), @p6='?', @p7='?', @p8='?', @p9='?' (DbType = DateTime), @p10='?', @p11='?' (DbType = Int32), @p18='?' (DbType = Int32), @p12='?' (DbType = DateTime), @p13='?', @p14='?', @p15='?' (DbType = DateTime), @p16='?', @p17='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO refresh_token (created, created_by_ip, expires, is_active, is_expired, is_revoked, reason_revoked, token, replaced_by_token, revoked, revoked_by_ip, user_id)
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11)
RETURNING id;
UPDATE users SET created_at = @p12, email = @p13, full_name = @p14, password_changed_at = @p15, password_hash = @p16, username = @p17
WHERE id = @p18;
2022-09-23 13:11:58.928 +01:00 [DBG] The foreign key property 'RefreshToken.Id' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2022-09-23 13:11:58.931 +01:00 [DBG] A data reader was disposed.
2022-09-23 13:11:58.933 +01:00 [DBG] Committing transaction.
2022-09-23 13:11:58.938 +01:00 [DBG] Committed transaction.
2022-09-23 13:11:58.942 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 13:11:58.943 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 13:11:58.945 +01:00 [DBG] Disposing transaction.
2022-09-23 13:11:58.949 +01:00 [DBG] An entity of type 'RefreshToken' tracked by 'PostgresContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 13:11:58.950 +01:00 [DBG] An entity of type 'User' tracked by 'PostgresContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 13:11:58.952 +01:00 [DBG] SaveChanges completed for 'PostgresContext' with 2 entities written to the database.
2022-09-23 13:11:58.961 +01:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2022-09-23 13:11:58.966 +01:00 [DBG] Attempting to select an output formatter based on Accept header '["text/plain"]'.
2022-09-23 13:11:58.967 +01:00 [DBG] Could not find an output formatter based on content negotiation. Accepted types were (["text/plain"])
2022-09-23 13:11:58.968 +01:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2022-09-23 13:11:58.969 +01:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2022-09-23 13:11:58.974 +01:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2022-09-23 13:11:58.976 +01:00 [INF] Executing OkObjectResult, writing value of type 'APIBank.Models.MyRequestResponses.LoginResponse'.
2022-09-23 13:11:58.992 +01:00 [INF] Executed action APIBank.Controllers.UsersController.Login (APIBank) in 2539.5884ms
2022-09-23 13:11:58.993 +01:00 [INF] Executed endpoint 'APIBank.Controllers.UsersController.Login (APIBank)'
2022-09-23 13:11:58.996 +01:00 [DBG] 'PostgresContext' disposed.
2022-09-23 13:11:59.000 +01:00 [INF] Request finished HTTP/2 POST https://localhost:7036/api/Users/Login application/json 58 - 200 - application/json;+charset=utf-8 2910.3332ms
2022-09-23 13:12:28.464 +01:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2022-09-23 13:12:28.542 +01:00 [DBG] Hosting starting
2022-09-23 13:12:28.634 +01:00 [DBG] Using development certificate: CN=localhost (Thumbprint: 9CC642E9838495A6C3C202DECA6A8AD300396DD2)
2022-09-23 13:12:28.693 +01:00 [INF] Now listening on: https://localhost:7036
2022-09-23 13:12:28.696 +01:00 [INF] Now listening on: http://localhost:5036
2022-09-23 13:12:28.698 +01:00 [DBG] Loaded hosting startup assembly APIBank
2022-09-23 13:12:28.699 +01:00 [DBG] Loaded hosting startup assembly Microsoft.AspNetCore.Watch.BrowserRefresh
2022-09-23 13:12:28.700 +01:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.BrowserLink.Net
2022-09-23 13:12:28.702 +01:00 [INF] Application started. Press Ctrl+C to shut down.
2022-09-23 13:12:28.702 +01:00 [INF] Hosting environment: Development
2022-09-23 13:12:28.703 +01:00 [INF] Content root path: C:\Users\mguedesa\OneDrive - NTT DATA EMEAL\Documentos\GitHub\OpenBankAPI-NTT\APIBank\APIBank\
2022-09-23 13:12:28.704 +01:00 [DBG] Hosting started
2022-09-23 13:12:29.109 +01:00 [DBG] Connection id "0HMKTBJHA1M21" received FIN.
2022-09-23 13:12:29.109 +01:00 [DBG] Connection id "0HMKTBJHA1M22" received FIN.
2022-09-23 13:12:29.118 +01:00 [DBG] Connection id "0HMKTBJHA1M21" accepted.
2022-09-23 13:12:29.118 +01:00 [DBG] Connection id "0HMKTBJHA1M22" accepted.
2022-09-23 13:12:29.121 +01:00 [DBG] Connection id "0HMKTBJHA1M21" started.
2022-09-23 13:12:29.121 +01:00 [DBG] Connection id "0HMKTBJHA1M22" started.
2022-09-23 13:12:29.142 +01:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException:  Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveBlobAsync[TIOAdapter](TIOAdapter adapter)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](TIOAdapter adapter, Boolean receiveFirst, Byte[] reAuthenticationData, Boolean isApm)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2022-09-23 13:12:29.142 +01:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException:  Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveBlobAsync[TIOAdapter](TIOAdapter adapter)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](TIOAdapter adapter, Boolean receiveFirst, Byte[] reAuthenticationData, Boolean isApm)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2022-09-23 13:12:29.176 +01:00 [DBG] Connection id "0HMKTBJHA1M23" accepted.
2022-09-23 13:12:29.183 +01:00 [DBG] Connection id "0HMKTBJHA1M22" stopped.
2022-09-23 13:12:29.183 +01:00 [DBG] Connection id "0HMKTBJHA1M21" stopped.
2022-09-23 13:12:29.183 +01:00 [DBG] Connection id "0HMKTBJHA1M23" started.
2022-09-23 13:12:29.191 +01:00 [DBG] Connection id "0HMKTBJHA1M21" sending FIN because: "The Socket transport's send loop completed gracefully."
2022-09-23 13:12:29.191 +01:00 [DBG] Connection id "0HMKTBJHA1M22" sending FIN because: "The Socket transport's send loop completed gracefully."
2022-09-23 13:12:29.235 +01:00 [DBG] Connection 0HMKTBJHA1M23 established using the following protocol: "Tls12"
2022-09-23 13:12:29.279 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/swagger/index.html - -
2022-09-23 13:12:29.306 +01:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2022-09-23 13:12:29.326 +01:00 [DBG] No candidates found for the request path '/swagger/index.html'
2022-09-23 13:12:29.327 +01:00 [DBG] Request did not match any endpoints
2022-09-23 13:12:29.411 +01:00 [DBG] Response markup is scheduled to include browser refresh script injection.
2022-09-23 13:12:29.500 +01:00 [DBG] Response markup was updated to include browser refresh script injection.
2022-09-23 13:12:29.506 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/swagger/index.html - - - 200 - text/html;charset=utf-8 229.2289ms
2022-09-23 13:12:29.538 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/_vs/browserLink - -
2022-09-23 13:12:29.538 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/_framework/aspnetcore-browser-refresh.js - -
2022-09-23 13:12:29.544 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/_framework/aspnetcore-browser-refresh.js - - - 200 11984 application/javascript;+charset=utf-8 6.6641ms
2022-09-23 13:12:29.560 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/_vs/browserLink - - - 200 - text/javascript;+charset=UTF-8 23.0203ms
2022-09-23 13:12:29.656 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/swagger/v1/swagger.json - -
2022-09-23 13:12:29.658 +01:00 [DBG] No candidates found for the request path '/swagger/v1/swagger.json'
2022-09-23 13:12:29.659 +01:00 [DBG] Request did not match any endpoints
2022-09-23 13:12:29.837 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/swagger/v1/swagger.json - - - 200 - application/json;charset=utf-8 180.6956ms
2022-09-23 13:12:38.184 +01:00 [INF] Request starting HTTP/2 POST https://localhost:7036/api/Users/Login application/json 58
2022-09-23 13:12:38.198 +01:00 [DBG] 1 candidate(s) found for the request path '/api/Users/Login'
2022-09-23 13:12:38.206 +01:00 [DBG] Endpoint 'APIBank.Controllers.UsersController.Login (APIBank)' with route pattern 'api/Users/Login' is valid for the request path '/api/Users/Login'
2022-09-23 13:12:38.211 +01:00 [DBG] Request matched endpoint 'APIBank.Controllers.UsersController.Login (APIBank)'
2022-09-23 13:12:38.216 +01:00 [DBG] Static files was skipped as the request already matched an endpoint.
2022-09-23 13:12:38.503 +01:00 [INF] Executing endpoint 'APIBank.Controllers.UsersController.Login (APIBank)'
2022-09-23 13:12:38.527 +01:00 [INF] Route matched with {action = "Login", controller = "Users"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult Login(APIBank.Models.Requests.UserLoginRequest) on controller APIBank.Controllers.UsersController (APIBank).
2022-09-23 13:12:38.532 +01:00 [DBG] Execution plan of authorization filters (in the following order): ["APIBank.Authorization.AuthorizeAttribute"]
2022-09-23 13:12:38.534 +01:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2022-09-23 13:12:38.536 +01:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2022-09-23 13:12:38.538 +01:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2022-09-23 13:12:38.539 +01:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2022-09-23 13:12:38.542 +01:00 [DBG] Executing controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-23 13:12:38.543 +01:00 [DBG] Executed controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-23 13:12:38.554 +01:00 [DBG] Attempting to bind parameter 'model' of type 'APIBank.Models.Requests.UserLoginRequest' ...
2022-09-23 13:12:38.557 +01:00 [DBG] Attempting to bind parameter 'model' of type 'APIBank.Models.Requests.UserLoginRequest' using the name '' in request data ...
2022-09-23 13:12:38.559 +01:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2022-09-23 13:12:38.565 +01:00 [DBG] Connection id "0HMKTBJHA1M23", Request id "0HMKTBJHA1M23:00000009": started reading request body.
2022-09-23 13:12:38.567 +01:00 [DBG] Connection id "0HMKTBJHA1M23", Request id "0HMKTBJHA1M23:00000009": done reading request body.
2022-09-23 13:12:38.573 +01:00 [DBG] JSON input formatter succeeded, deserializing to type 'APIBank.Models.Requests.UserLoginRequest'
2022-09-23 13:12:38.574 +01:00 [DBG] Done attempting to bind parameter 'model' of type 'APIBank.Models.Requests.UserLoginRequest'.
2022-09-23 13:12:38.575 +01:00 [DBG] Done attempting to bind parameter 'model' of type 'APIBank.Models.Requests.UserLoginRequest'.
2022-09-23 13:12:38.576 +01:00 [DBG] Attempting to validate the bound parameter 'model' of type 'APIBank.Models.Requests.UserLoginRequest' ...
2022-09-23 13:12:38.590 +01:00 [DBG] Done attempting to validate the bound parameter 'model' of type 'APIBank.Models.Requests.UserLoginRequest'.
2022-09-23 13:12:38.650 +01:00 [DBG] An additional 'IServiceProvider' was created for internal use by Entity Framework. An existing service provider was not used due to the following configuration changes: configuration changed for 'Core:ConfigureWarnings', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:UseAdminDatabase', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:SetPostgresVersion', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:UseRedshift', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:ReverseNullOrdering', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:RemoteCertificateValidationCallback', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:ProvideClientCertificatesCallback', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:ProvidePasswordCallback'.
2022-09-23 13:12:39.653 +01:00 [INF] Entity Framework Core 6.0.9 initialized 'PostgresContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:6.0.7+5b98e4b74de93b590b44aef8dd7967c03acc433c' with options: None
2022-09-23 13:12:39.694 +01:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .SingleOrDefault(x => x.Username == __model_Username_0)'
2022-09-23 13:12:39.937 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<User>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: User.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: User.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 1], [Property: User.Email (string) Required Index MaxLength(254), 2], [Property: User.FullName (string) Required MaxLength(100), 3], [Property: User.PasswordChangedAt (DateTime) Required ValueGenerated.OnAdd, 4], [Property: User.PasswordHash (string) Required MaxLength(200), 5], [Property: User.Username (string) Required Index MaxLength(50), 6] }
        SELECT TOP(2) u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
        FROM users AS u
        WHERE u.username == @__model_Username_0), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, User>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)
    .SingleOrDefault()'
2022-09-23 13:12:39.980 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 13:12:40.019 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (34ms).
2022-09-23 13:12:40.030 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 13:12:40.257 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 13:12:40.271 +01:00 [DBG] Executing DbCommand [Parameters=[@__model_Username_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.username = @__model_Username_0
LIMIT 2
2022-09-23 13:12:40.353 +01:00 [INF] Executed DbCommand (87ms) [Parameters=[@__model_Username_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.username = @__model_Username_0
LIMIT 2
2022-09-23 13:12:40.392 +01:00 [DBG] Context 'PostgresContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 13:12:40.436 +01:00 [DBG] A data reader was disposed.
2022-09-23 13:12:40.440 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 13:12:40.447 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 13:12:40.685 +01:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .Any(user => user.RefreshTokenCollection
        .Any(reftoken => reftoken.RefToken == __token_0))'
2022-09-23 13:12:40.763 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<bool>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            EmptyProjectionMember -> 0
        SELECT EXISTS (
            SELECT 1
            FROM users AS u
            WHERE EXISTS (
                SELECT 1
                FROM refresh_token AS r
                WHERE ((u.id != NULL) && (u.id == r.user_id)) && (r.token == @__token_0)))), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, bool>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)
    .Single()'
2022-09-23 13:12:40.780 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 13:12:40.782 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2022-09-23 13:12:40.783 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 13:12:40.784 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 13:12:40.785 +01:00 [DBG] Executing DbCommand [Parameters=[@__token_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM users AS u
    WHERE EXISTS (
        SELECT 1
        FROM refresh_token AS r
        WHERE (u.id = r.user_id) AND (r.token = @__token_0)))
2022-09-23 13:12:40.789 +01:00 [INF] Executed DbCommand (4ms) [Parameters=[@__token_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM users AS u
    WHERE EXISTS (
        SELECT 1
        FROM refresh_token AS r
        WHERE (u.id = r.user_id) AND (r.token = @__token_0)))
2022-09-23 13:12:40.792 +01:00 [DBG] A data reader was disposed.
2022-09-23 13:12:40.793 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 13:12:40.795 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 13:12:40.948 +01:00 [DBG] Compiling query expression: 
'DbSet<RefreshToken>()
    .Where(rt => rt.UserId == __id_0)
    .AsNoTracking()
    .Select(rt => new RefreshToken{ 
        Id = rt.Id, 
        UserId = rt.UserId, 
        RefToken = rt.RefToken, 
        Expires = rt.Expires, 
        Created = rt.Created, 
        CreatedByIp = rt.CreatedByIp, 
        Revoked = rt.Revoked, 
        RevokedByIp = rt.RevokedByIp, 
        ReplacedByToken = rt.ReplacedByToken, 
        ReasonRevoked = rt.ReasonRevoked, 
        IsExpired = rt.IsExpired, 
        IsRevoked = rt.IsRevoked, 
        IsActive = rt.IsActive 
    }
    )'
2022-09-23 13:12:40.968 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<RefreshToken>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            Id -> 0
            UserId -> 1
            RefToken -> 2
            Expires -> 3
            Created -> 4
            CreatedByIp -> 5
            Revoked -> 6
            RevokedByIp -> 7
            ReplacedByToken -> 8
            ReasonRevoked -> 9
            IsExpired -> 10
            IsRevoked -> 11
            IsActive -> 12
        SELECT r.id AS Id, r.user_id AS UserId, r.token AS RefToken, r.expires AS Expires, r.created AS Created, r.created_by_ip AS CreatedByIp, r.revoked AS Revoked, r.revoked_by_ip AS RevokedByIp, r.replaced_by_token AS ReplacedByToken, r.reason_revoked AS ReasonRevoked, r.is_expired AS IsExpired, r.is_revoked AS IsRevoked, r.is_active AS IsActive
        FROM refresh_token AS r
        WHERE r.user_id == @__id_0), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, RefreshToken>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)'
2022-09-23 13:12:40.971 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 13:12:40.972 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2022-09-23 13:12:40.973 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 13:12:40.973 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 13:12:40.974 +01:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.user_id AS "UserId", r.token AS "RefToken", r.expires AS "Expires", r.created AS "Created", r.created_by_ip AS "CreatedByIp", r.revoked AS "Revoked", r.revoked_by_ip AS "RevokedByIp", r.replaced_by_token AS "ReplacedByToken", r.reason_revoked AS "ReasonRevoked", r.is_expired AS "IsExpired", r.is_revoked AS "IsRevoked", r.is_active AS "IsActive"
FROM refresh_token AS r
WHERE r.user_id = @__id_0
2022-09-23 13:12:40.979 +01:00 [INF] Executed DbCommand (4ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.user_id AS "UserId", r.token AS "RefToken", r.expires AS "Expires", r.created AS "Created", r.created_by_ip AS "CreatedByIp", r.revoked AS "Revoked", r.revoked_by_ip AS "RevokedByIp", r.replaced_by_token AS "ReplacedByToken", r.reason_revoked AS "ReasonRevoked", r.is_expired AS "IsExpired", r.is_revoked AS "IsRevoked", r.is_active AS "IsActive"
FROM refresh_token AS r
WHERE r.user_id = @__id_0
2022-09-23 13:12:40.981 +01:00 [DBG] A data reader was disposed.
2022-09-23 13:12:40.982 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 13:12:40.983 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 13:12:40.998 +01:00 [DBG] An entity of type 'User' tracked by 'PostgresContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 13:12:41.025 +01:00 [DBG] 'PostgresContext' generated a temporary value for the property 'Id.RefreshToken'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 13:12:41.064 +01:00 [DBG] Context 'PostgresContext' started tracking 'RefreshToken' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 13:12:41.069 +01:00 [DBG] SaveChanges starting for 'PostgresContext'.
2022-09-23 13:12:41.073 +01:00 [DBG] DetectChanges starting for 'PostgresContext'.
2022-09-23 13:12:41.102 +01:00 [DBG] 1 entities were added and 0 entities were removed from navigation 'User.RefreshTokenCollection'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 13:12:41.116 +01:00 [DBG] The foreign key property 'RefreshToken.UserId' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2022-09-23 13:12:41.137 +01:00 [DBG] DetectChanges completed for 'PostgresContext'.
2022-09-23 13:12:41.148 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 13:12:41.150 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 13:12:41.151 +01:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2022-09-23 13:12:41.158 +01:00 [DBG] Began transaction with isolation level 'ReadCommitted'.
2022-09-23 13:12:41.212 +01:00 [DBG] Executing 2 update commands as a batch.
2022-09-23 13:12:41.224 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 13:12:41.225 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2022-09-23 13:12:41.228 +01:00 [DBG] Executing DbCommand [Parameters=[@p0='?' (DbType = DateTime), @p1='?', @p2='?' (DbType = DateTime), @p3='?' (DbType = Boolean), @p4='?' (DbType = Boolean), @p5='?' (DbType = Boolean), @p6='?', @p7='?', @p8='?', @p9='?' (DbType = DateTime), @p10='?', @p11='?' (DbType = Int32), @p18='?' (DbType = Int32), @p12='?' (DbType = DateTime), @p13='?', @p14='?', @p15='?' (DbType = DateTime), @p16='?', @p17='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO refresh_token (created, created_by_ip, expires, is_active, is_expired, is_revoked, reason_revoked, token, replaced_by_token, revoked, revoked_by_ip, user_id)
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11)
RETURNING id;
UPDATE users SET created_at = @p12, email = @p13, full_name = @p14, password_changed_at = @p15, password_hash = @p16, username = @p17
WHERE id = @p18;
2022-09-23 13:12:41.238 +01:00 [INF] Executed DbCommand (10ms) [Parameters=[@p0='?' (DbType = DateTime), @p1='?', @p2='?' (DbType = DateTime), @p3='?' (DbType = Boolean), @p4='?' (DbType = Boolean), @p5='?' (DbType = Boolean), @p6='?', @p7='?', @p8='?', @p9='?' (DbType = DateTime), @p10='?', @p11='?' (DbType = Int32), @p18='?' (DbType = Int32), @p12='?' (DbType = DateTime), @p13='?', @p14='?', @p15='?' (DbType = DateTime), @p16='?', @p17='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO refresh_token (created, created_by_ip, expires, is_active, is_expired, is_revoked, reason_revoked, token, replaced_by_token, revoked, revoked_by_ip, user_id)
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11)
RETURNING id;
UPDATE users SET created_at = @p12, email = @p13, full_name = @p14, password_changed_at = @p15, password_hash = @p16, username = @p17
WHERE id = @p18;
2022-09-23 13:12:41.254 +01:00 [DBG] The foreign key property 'RefreshToken.Id' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2022-09-23 13:12:41.257 +01:00 [DBG] A data reader was disposed.
2022-09-23 13:12:41.259 +01:00 [DBG] Committing transaction.
2022-09-23 13:12:41.264 +01:00 [DBG] Committed transaction.
2022-09-23 13:12:41.266 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 13:12:41.268 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 13:12:41.270 +01:00 [DBG] Disposing transaction.
2022-09-23 13:12:41.273 +01:00 [DBG] An entity of type 'RefreshToken' tracked by 'PostgresContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 13:12:41.275 +01:00 [DBG] An entity of type 'User' tracked by 'PostgresContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 13:12:41.277 +01:00 [DBG] SaveChanges completed for 'PostgresContext' with 2 entities written to the database.
2022-09-23 13:12:41.282 +01:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2022-09-23 13:12:41.286 +01:00 [DBG] Attempting to select an output formatter based on Accept header '["text/plain"]'.
2022-09-23 13:12:41.287 +01:00 [DBG] Could not find an output formatter based on content negotiation. Accepted types were (["text/plain"])
2022-09-23 13:12:41.288 +01:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2022-09-23 13:12:41.288 +01:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2022-09-23 13:12:41.289 +01:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2022-09-23 13:12:41.290 +01:00 [INF] Executing OkObjectResult, writing value of type 'APIBank.Models.MyRequestResponses.LoginResponse'.
2022-09-23 13:12:41.303 +01:00 [INF] Executed action APIBank.Controllers.UsersController.Login (APIBank) in 2757.9637ms
2022-09-23 13:12:41.304 +01:00 [INF] Executed endpoint 'APIBank.Controllers.UsersController.Login (APIBank)'
2022-09-23 13:12:41.306 +01:00 [DBG] 'PostgresContext' disposed.
2022-09-23 13:12:41.311 +01:00 [INF] Request finished HTTP/2 POST https://localhost:7036/api/Users/Login application/json 58 - 200 - application/json;+charset=utf-8 3126.6361ms
2022-09-23 13:12:56.642 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/api/Accounts/GetAll - -
2022-09-23 13:12:56.646 +01:00 [DBG] 1 candidate(s) found for the request path '/api/Accounts/GetAll'
2022-09-23 13:12:56.648 +01:00 [DBG] Endpoint 'APIBank.Controllers.AccountsController.GetAllFromUser (APIBank)' with route pattern 'api/Accounts/GetAll' is valid for the request path '/api/Accounts/GetAll'
2022-09-23 13:12:56.656 +01:00 [DBG] Request matched endpoint 'APIBank.Controllers.AccountsController.GetAllFromUser (APIBank)'
2022-09-23 13:12:56.657 +01:00 [DBG] Static files was skipped as the request already matched an endpoint.
2022-09-23 13:12:56.742 +01:00 [INF] Entity Framework Core 6.0.9 initialized 'PostgresContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:6.0.7+5b98e4b74de93b590b44aef8dd7967c03acc433c' with options: None
2022-09-23 13:12:56.753 +01:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .FirstOrDefault(e => EF.Property<int>(e, "Id") == __p_0)'
2022-09-23 13:12:56.759 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<User>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: User.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: User.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 1], [Property: User.Email (string) Required Index MaxLength(254), 2], [Property: User.FullName (string) Required MaxLength(100), 3], [Property: User.PasswordChangedAt (DateTime) Required ValueGenerated.OnAdd, 4], [Property: User.PasswordHash (string) Required MaxLength(200), 5], [Property: User.Username (string) Required Index MaxLength(50), 6] }
        SELECT TOP(1) u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
        FROM users AS u
        WHERE u.id == @__p_0), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, User>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)
    .SingleOrDefault()'
2022-09-23 13:12:56.763 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 13:12:56.764 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2022-09-23 13:12:56.765 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 13:12:56.766 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 13:12:56.768 +01:00 [DBG] Executing DbCommand [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.id = @__p_0
LIMIT 1
2022-09-23 13:12:56.772 +01:00 [INF] Executed DbCommand (3ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.id = @__p_0
LIMIT 1
2022-09-23 13:12:56.774 +01:00 [DBG] Context 'PostgresContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 13:12:56.776 +01:00 [DBG] A data reader was disposed.
2022-09-23 13:12:56.777 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 13:12:56.778 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 13:12:56.779 +01:00 [INF] Executing endpoint 'APIBank.Controllers.AccountsController.GetAllFromUser (APIBank)'
2022-09-23 13:12:56.781 +01:00 [INF] Route matched with {action = "GetAllFromUser", controller = "Accounts"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult GetAllFromUser() on controller APIBank.Controllers.AccountsController (APIBank).
2022-09-23 13:12:56.784 +01:00 [DBG] Execution plan of authorization filters (in the following order): ["APIBank.Authorization.AuthorizeAttribute"]
2022-09-23 13:12:56.787 +01:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2022-09-23 13:12:56.788 +01:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2022-09-23 13:12:56.791 +01:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2022-09-23 13:12:56.792 +01:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2022-09-23 13:12:56.794 +01:00 [DBG] Executing controller factory for controller APIBank.Controllers.AccountsController (APIBank)
2022-09-23 13:12:56.795 +01:00 [DBG] Executed controller factory for controller APIBank.Controllers.AccountsController (APIBank)
2022-09-23 13:12:56.798 +01:00 [DBG] Compiling query expression: 
'DbSet<RefreshToken>()
    .FirstOrDefault(e => EF.Property<int>(e, "Id") == __p_0)'
2022-09-23 13:12:56.807 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<RefreshToken>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: RefreshToken.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: RefreshToken.Created (DateTime) Required, 1], [Property: RefreshToken.CreatedByIp (string) Required MaxLength(200), 2], [Property: RefreshToken.Expires (DateTime) Required, 3], [Property: RefreshToken.IsActive (no field, bool) Required, 4], [Property: RefreshToken.IsExpired (no field, bool) Required, 5], [Property: RefreshToken.IsRevoked (no field, bool) Required, 6], [Property: RefreshToken.ReasonRevoked (string) MaxLength(200), 7], [Property: RefreshToken.RefToken (string) Required MaxLength(254), 8], [Property: RefreshToken.ReplacedByToken (string) MaxLength(200), 9], [Property: RefreshToken.Revoked (DateTime?), 10], [Property: RefreshToken.RevokedByIp (string) MaxLength(200), 11], [Property: RefreshToken.UserId (int) Required FK Index, 12] }
        SELECT TOP(1) r.id, r.created, r.created_by_ip, r.expires, r.is_active, r.is_expired, r.is_revoked, r.reason_revoked, r.token, r.replaced_by_token, r.revoked, r.revoked_by_ip, r.user_id
        FROM refresh_token AS r
        WHERE r.id == @__p_0), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, RefreshToken>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)
    .SingleOrDefault()'
2022-09-23 13:12:56.810 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 13:12:56.811 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2022-09-23 13:12:56.812 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 13:12:56.812 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 13:12:56.813 +01:00 [DBG] Executing DbCommand [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id, r.created, r.created_by_ip, r.expires, r.is_active, r.is_expired, r.is_revoked, r.reason_revoked, r.token, r.replaced_by_token, r.revoked, r.revoked_by_ip, r.user_id
FROM refresh_token AS r
WHERE r.id = @__p_0
LIMIT 1
2022-09-23 13:12:56.815 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id, r.created, r.created_by_ip, r.expires, r.is_active, r.is_expired, r.is_revoked, r.reason_revoked, r.token, r.replaced_by_token, r.revoked, r.revoked_by_ip, r.user_id
FROM refresh_token AS r
WHERE r.id = @__p_0
LIMIT 1
2022-09-23 13:12:56.821 +01:00 [DBG] A data reader was disposed.
2022-09-23 13:12:56.823 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 13:12:56.825 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 13:12:56.827 +01:00 [INF] Executed action APIBank.Controllers.AccountsController.GetAllFromUser (APIBank) in 33.7637ms
2022-09-23 13:12:56.829 +01:00 [INF] Executed endpoint 'APIBank.Controllers.AccountsController.GetAllFromUser (APIBank)'
2022-09-23 13:12:56.830 +01:00 [INF] Global Error was found:
2022-09-23 13:12:56.832 +01:00 [DBG] 'PostgresContext' disposed.
2022-09-23 13:12:56.836 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/api/Accounts/GetAll - - - 404 - application/json 193.3459ms
2022-09-23 13:13:15.991 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/api/Accounts/GetById/100000000 - -
2022-09-23 13:13:15.996 +01:00 [DBG] 1 candidate(s) found for the request path '/api/Accounts/GetById/100000000'
2022-09-23 13:13:15.998 +01:00 [DBG] Endpoint 'APIBank.Controllers.AccountsController.GetById (APIBank)' with route pattern 'api/Accounts/GetById/{accountId}' is valid for the request path '/api/Accounts/GetById/100000000'
2022-09-23 13:13:16.002 +01:00 [DBG] Request matched endpoint 'APIBank.Controllers.AccountsController.GetById (APIBank)'
2022-09-23 13:13:16.004 +01:00 [DBG] Static files was skipped as the request already matched an endpoint.
2022-09-23 13:13:16.078 +01:00 [INF] Entity Framework Core 6.0.9 initialized 'PostgresContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:6.0.7+5b98e4b74de93b590b44aef8dd7967c03acc433c' with options: None
2022-09-23 13:13:16.085 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 13:13:16.086 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2022-09-23 13:13:16.087 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 13:13:16.090 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 13:13:16.091 +01:00 [DBG] Executing DbCommand [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.id = @__p_0
LIMIT 1
2022-09-23 13:13:16.093 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.id = @__p_0
LIMIT 1
2022-09-23 13:13:16.095 +01:00 [DBG] Context 'PostgresContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 13:13:16.096 +01:00 [DBG] A data reader was disposed.
2022-09-23 13:13:16.097 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 13:13:16.097 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 13:13:16.098 +01:00 [INF] Executing endpoint 'APIBank.Controllers.AccountsController.GetById (APIBank)'
2022-09-23 13:13:16.102 +01:00 [INF] Route matched with {action = "GetById", controller = "Accounts"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult GetById(Int32) on controller APIBank.Controllers.AccountsController (APIBank).
2022-09-23 13:13:16.106 +01:00 [DBG] Execution plan of authorization filters (in the following order): ["APIBank.Authorization.AuthorizeAttribute"]
2022-09-23 13:13:16.107 +01:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2022-09-23 13:13:16.109 +01:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2022-09-23 13:13:16.110 +01:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2022-09-23 13:13:16.111 +01:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2022-09-23 13:13:16.112 +01:00 [DBG] Executing controller factory for controller APIBank.Controllers.AccountsController (APIBank)
2022-09-23 13:13:16.113 +01:00 [DBG] Executed controller factory for controller APIBank.Controllers.AccountsController (APIBank)
2022-09-23 13:13:16.115 +01:00 [DBG] Attempting to bind parameter 'accountId' of type 'System.Int32' ...
2022-09-23 13:13:16.117 +01:00 [DBG] Attempting to bind parameter 'accountId' of type 'System.Int32' using the name 'accountId' in request data ...
2022-09-23 13:13:16.119 +01:00 [DBG] Done attempting to bind parameter 'accountId' of type 'System.Int32'.
2022-09-23 13:13:16.120 +01:00 [DBG] Done attempting to bind parameter 'accountId' of type 'System.Int32'.
2022-09-23 13:13:16.122 +01:00 [DBG] Attempting to validate the bound parameter 'accountId' of type 'System.Int32' ...
2022-09-23 13:13:16.124 +01:00 [DBG] Done attempting to validate the bound parameter 'accountId' of type 'System.Int32'.
2022-09-23 13:13:16.125 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 13:13:16.126 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2022-09-23 13:13:16.127 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 13:13:16.128 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 13:13:16.129 +01:00 [DBG] Executing DbCommand [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id, r.created, r.created_by_ip, r.expires, r.is_active, r.is_expired, r.is_revoked, r.reason_revoked, r.token, r.replaced_by_token, r.revoked, r.revoked_by_ip, r.user_id
FROM refresh_token AS r
WHERE r.id = @__p_0
LIMIT 1
2022-09-23 13:13:16.132 +01:00 [INF] Executed DbCommand (3ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id, r.created, r.created_by_ip, r.expires, r.is_active, r.is_expired, r.is_revoked, r.reason_revoked, r.token, r.replaced_by_token, r.revoked, r.revoked_by_ip, r.user_id
FROM refresh_token AS r
WHERE r.id = @__p_0
LIMIT 1
2022-09-23 13:13:16.134 +01:00 [DBG] A data reader was disposed.
2022-09-23 13:13:16.134 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 13:13:16.135 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 13:13:16.136 +01:00 [INF] Executed action APIBank.Controllers.AccountsController.GetById (APIBank) in 24.134ms
2022-09-23 13:13:16.138 +01:00 [INF] Executed endpoint 'APIBank.Controllers.AccountsController.GetById (APIBank)'
2022-09-23 13:13:16.140 +01:00 [INF] Global Error was found:
2022-09-23 13:13:16.141 +01:00 [DBG] 'PostgresContext' disposed.
2022-09-23 13:13:16.142 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/api/Accounts/GetById/100000000 - - - 404 - application/json 151.3869ms
2022-09-23 13:14:14.577 +01:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2022-09-23 13:14:14.673 +01:00 [DBG] Hosting starting
2022-09-23 13:14:14.762 +01:00 [DBG] Using development certificate: CN=localhost (Thumbprint: 9CC642E9838495A6C3C202DECA6A8AD300396DD2)
2022-09-23 13:14:14.817 +01:00 [INF] Now listening on: https://localhost:7036
2022-09-23 13:14:14.819 +01:00 [INF] Now listening on: http://localhost:5036
2022-09-23 13:14:14.820 +01:00 [DBG] Loaded hosting startup assembly APIBank
2022-09-23 13:14:14.821 +01:00 [DBG] Loaded hosting startup assembly Microsoft.AspNetCore.Watch.BrowserRefresh
2022-09-23 13:14:14.822 +01:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.BrowserLink.Net
2022-09-23 13:14:14.824 +01:00 [INF] Application started. Press Ctrl+C to shut down.
2022-09-23 13:14:14.825 +01:00 [INF] Hosting environment: Development
2022-09-23 13:14:14.826 +01:00 [INF] Content root path: C:\Users\mguedesa\OneDrive - NTT DATA EMEAL\Documentos\GitHub\OpenBankAPI-NTT\APIBank\APIBank\
2022-09-23 13:14:14.827 +01:00 [DBG] Hosting started
2022-09-23 13:14:15.269 +01:00 [DBG] Connection id "0HMKTBKGUF5GP" received FIN.
2022-09-23 13:14:15.269 +01:00 [DBG] Connection id "0HMKTBKGUF5GQ" received FIN.
2022-09-23 13:14:15.281 +01:00 [DBG] Connection id "0HMKTBKGUF5GQ" accepted.
2022-09-23 13:14:15.281 +01:00 [DBG] Connection id "0HMKTBKGUF5GP" accepted.
2022-09-23 13:14:15.284 +01:00 [DBG] Connection id "0HMKTBKGUF5GQ" started.
2022-09-23 13:14:15.286 +01:00 [DBG] Connection id "0HMKTBKGUF5GP" started.
2022-09-23 13:14:15.288 +01:00 [DBG] Connection id "0HMKTBKGUF5GR" accepted.
2022-09-23 13:14:15.295 +01:00 [DBG] Connection id "0HMKTBKGUF5GR" started.
2022-09-23 13:14:15.310 +01:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException:  Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveBlobAsync[TIOAdapter](TIOAdapter adapter)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](TIOAdapter adapter, Boolean receiveFirst, Byte[] reAuthenticationData, Boolean isApm)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2022-09-23 13:14:15.310 +01:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException:  Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveBlobAsync[TIOAdapter](TIOAdapter adapter)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](TIOAdapter adapter, Boolean receiveFirst, Byte[] reAuthenticationData, Boolean isApm)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2022-09-23 13:14:15.338 +01:00 [DBG] Connection id "0HMKTBKGUF5GQ" stopped.
2022-09-23 13:14:15.338 +01:00 [DBG] Connection id "0HMKTBKGUF5GP" stopped.
2022-09-23 13:14:15.341 +01:00 [DBG] Connection id "0HMKTBKGUF5GQ" sending FIN because: "The Socket transport's send loop completed gracefully."
2022-09-23 13:14:15.342 +01:00 [DBG] Connection id "0HMKTBKGUF5GP" sending FIN because: "The Socket transport's send loop completed gracefully."
2022-09-23 13:14:15.356 +01:00 [DBG] Connection 0HMKTBKGUF5GR established using the following protocol: "Tls12"
2022-09-23 13:14:15.407 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/swagger/index.html - -
2022-09-23 13:14:15.438 +01:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2022-09-23 13:14:15.458 +01:00 [DBG] No candidates found for the request path '/swagger/index.html'
2022-09-23 13:14:15.459 +01:00 [DBG] Request did not match any endpoints
2022-09-23 13:14:15.560 +01:00 [DBG] Response markup is scheduled to include browser refresh script injection.
2022-09-23 13:14:15.689 +01:00 [DBG] Response markup was updated to include browser refresh script injection.
2022-09-23 13:14:15.708 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/swagger/index.html - - - 200 - text/html;charset=utf-8 303.5578ms
2022-09-23 13:14:15.756 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/_vs/browserLink - -
2022-09-23 13:14:15.756 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/_framework/aspnetcore-browser-refresh.js - -
2022-09-23 13:14:15.764 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/_framework/aspnetcore-browser-refresh.js - - - 200 11984 application/javascript;+charset=utf-8 7.7024ms
2022-09-23 13:14:15.792 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/_vs/browserLink - - - 200 - text/javascript;+charset=UTF-8 37.6207ms
2022-09-23 13:14:15.901 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/swagger/v1/swagger.json - -
2022-09-23 13:14:15.903 +01:00 [DBG] No candidates found for the request path '/swagger/v1/swagger.json'
2022-09-23 13:14:15.904 +01:00 [DBG] Request did not match any endpoints
2022-09-23 13:14:16.105 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/swagger/v1/swagger.json - - - 200 - application/json;charset=utf-8 203.1866ms
2022-09-23 13:14:34.490 +01:00 [INF] Request starting HTTP/2 POST https://localhost:7036/api/Users/Login application/json 58
2022-09-23 13:14:34.500 +01:00 [DBG] 1 candidate(s) found for the request path '/api/Users/Login'
2022-09-23 13:14:34.508 +01:00 [DBG] Endpoint 'APIBank.Controllers.UsersController.Login (APIBank)' with route pattern 'api/Users/Login' is valid for the request path '/api/Users/Login'
2022-09-23 13:14:34.511 +01:00 [DBG] Request matched endpoint 'APIBank.Controllers.UsersController.Login (APIBank)'
2022-09-23 13:14:34.518 +01:00 [DBG] Static files was skipped as the request already matched an endpoint.
2022-09-23 13:14:34.799 +01:00 [INF] Executing endpoint 'APIBank.Controllers.UsersController.Login (APIBank)'
2022-09-23 13:14:34.824 +01:00 [INF] Route matched with {action = "Login", controller = "Users"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult Login(APIBank.Models.Requests.UserLoginRequest) on controller APIBank.Controllers.UsersController (APIBank).
2022-09-23 13:14:34.828 +01:00 [DBG] Execution plan of authorization filters (in the following order): ["APIBank.Authorization.AuthorizeAttribute"]
2022-09-23 13:14:34.830 +01:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2022-09-23 13:14:34.832 +01:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2022-09-23 13:14:34.835 +01:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2022-09-23 13:14:34.836 +01:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2022-09-23 13:14:34.839 +01:00 [DBG] Executing controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-23 13:14:34.841 +01:00 [DBG] Executed controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-23 13:14:34.851 +01:00 [DBG] Attempting to bind parameter 'model' of type 'APIBank.Models.Requests.UserLoginRequest' ...
2022-09-23 13:14:34.855 +01:00 [DBG] Attempting to bind parameter 'model' of type 'APIBank.Models.Requests.UserLoginRequest' using the name '' in request data ...
2022-09-23 13:14:34.859 +01:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2022-09-23 13:14:34.862 +01:00 [DBG] Connection id "0HMKTBKGUF5GR", Request id "0HMKTBKGUF5GR:00000009": started reading request body.
2022-09-23 13:14:34.866 +01:00 [DBG] Connection id "0HMKTBKGUF5GR", Request id "0HMKTBKGUF5GR:00000009": done reading request body.
2022-09-23 13:14:34.874 +01:00 [DBG] JSON input formatter succeeded, deserializing to type 'APIBank.Models.Requests.UserLoginRequest'
2022-09-23 13:14:34.875 +01:00 [DBG] Done attempting to bind parameter 'model' of type 'APIBank.Models.Requests.UserLoginRequest'.
2022-09-23 13:14:34.876 +01:00 [DBG] Done attempting to bind parameter 'model' of type 'APIBank.Models.Requests.UserLoginRequest'.
2022-09-23 13:14:34.877 +01:00 [DBG] Attempting to validate the bound parameter 'model' of type 'APIBank.Models.Requests.UserLoginRequest' ...
2022-09-23 13:14:34.889 +01:00 [DBG] Done attempting to validate the bound parameter 'model' of type 'APIBank.Models.Requests.UserLoginRequest'.
2022-09-23 13:14:34.955 +01:00 [DBG] An additional 'IServiceProvider' was created for internal use by Entity Framework. An existing service provider was not used due to the following configuration changes: configuration changed for 'Core:ConfigureWarnings', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:UseAdminDatabase', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:SetPostgresVersion', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:UseRedshift', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:ReverseNullOrdering', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:RemoteCertificateValidationCallback', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:ProvideClientCertificatesCallback', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:ProvidePasswordCallback'.
2022-09-23 13:14:36.005 +01:00 [INF] Entity Framework Core 6.0.9 initialized 'PostgresContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:6.0.7+5b98e4b74de93b590b44aef8dd7967c03acc433c' with options: None
2022-09-23 13:14:36.047 +01:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .SingleOrDefault(x => x.Username == __model_Username_0)'
2022-09-23 13:14:36.311 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<User>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: User.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: User.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 1], [Property: User.Email (string) Required Index MaxLength(254), 2], [Property: User.FullName (string) Required MaxLength(100), 3], [Property: User.PasswordChangedAt (DateTime) Required ValueGenerated.OnAdd, 4], [Property: User.PasswordHash (string) Required MaxLength(200), 5], [Property: User.Username (string) Required Index MaxLength(50), 6] }
        SELECT TOP(2) u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
        FROM users AS u
        WHERE u.username == @__model_Username_0), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, User>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)
    .SingleOrDefault()'
2022-09-23 13:14:36.355 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 13:14:36.401 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (42ms).
2022-09-23 13:14:36.407 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 13:14:36.641 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 13:14:36.657 +01:00 [DBG] Executing DbCommand [Parameters=[@__model_Username_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.username = @__model_Username_0
LIMIT 2
2022-09-23 13:14:36.760 +01:00 [INF] Executed DbCommand (110ms) [Parameters=[@__model_Username_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.username = @__model_Username_0
LIMIT 2
2022-09-23 13:14:36.805 +01:00 [DBG] Context 'PostgresContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 13:14:36.853 +01:00 [DBG] A data reader was disposed.
2022-09-23 13:14:36.857 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 13:14:36.865 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 13:14:37.067 +01:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .Any(user => user.RefreshTokenCollection
        .Any(reftoken => reftoken.RefToken == __token_0))'
2022-09-23 13:14:37.136 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<bool>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            EmptyProjectionMember -> 0
        SELECT EXISTS (
            SELECT 1
            FROM users AS u
            WHERE EXISTS (
                SELECT 1
                FROM refresh_token AS r
                WHERE ((u.id != NULL) && (u.id == r.user_id)) && (r.token == @__token_0)))), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, bool>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)
    .Single()'
2022-09-23 13:14:37.150 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 13:14:37.151 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2022-09-23 13:14:37.152 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 13:14:37.153 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 13:14:37.154 +01:00 [DBG] Executing DbCommand [Parameters=[@__token_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM users AS u
    WHERE EXISTS (
        SELECT 1
        FROM refresh_token AS r
        WHERE (u.id = r.user_id) AND (r.token = @__token_0)))
2022-09-23 13:14:37.157 +01:00 [INF] Executed DbCommand (3ms) [Parameters=[@__token_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM users AS u
    WHERE EXISTS (
        SELECT 1
        FROM refresh_token AS r
        WHERE (u.id = r.user_id) AND (r.token = @__token_0)))
2022-09-23 13:14:37.160 +01:00 [DBG] A data reader was disposed.
2022-09-23 13:14:37.162 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 13:14:37.165 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 13:14:37.302 +01:00 [DBG] Compiling query expression: 
'DbSet<RefreshToken>()
    .Where(rt => rt.UserId == __id_0)
    .AsNoTracking()
    .Select(rt => new RefreshToken{ 
        Id = rt.Id, 
        UserId = rt.UserId, 
        RefToken = rt.RefToken, 
        Expires = rt.Expires, 
        Created = rt.Created, 
        CreatedByIp = rt.CreatedByIp, 
        Revoked = rt.Revoked, 
        RevokedByIp = rt.RevokedByIp, 
        ReplacedByToken = rt.ReplacedByToken, 
        ReasonRevoked = rt.ReasonRevoked, 
        IsExpired = rt.IsExpired, 
        IsRevoked = rt.IsRevoked, 
        IsActive = rt.IsActive 
    }
    )'
2022-09-23 13:14:37.323 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<RefreshToken>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            Id -> 0
            UserId -> 1
            RefToken -> 2
            Expires -> 3
            Created -> 4
            CreatedByIp -> 5
            Revoked -> 6
            RevokedByIp -> 7
            ReplacedByToken -> 8
            ReasonRevoked -> 9
            IsExpired -> 10
            IsRevoked -> 11
            IsActive -> 12
        SELECT r.id AS Id, r.user_id AS UserId, r.token AS RefToken, r.expires AS Expires, r.created AS Created, r.created_by_ip AS CreatedByIp, r.revoked AS Revoked, r.revoked_by_ip AS RevokedByIp, r.replaced_by_token AS ReplacedByToken, r.reason_revoked AS ReasonRevoked, r.is_expired AS IsExpired, r.is_revoked AS IsRevoked, r.is_active AS IsActive
        FROM refresh_token AS r
        WHERE r.user_id == @__id_0), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, RefreshToken>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)'
2022-09-23 13:14:37.325 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 13:14:37.326 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2022-09-23 13:14:37.327 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 13:14:37.329 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 13:14:37.330 +01:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.user_id AS "UserId", r.token AS "RefToken", r.expires AS "Expires", r.created AS "Created", r.created_by_ip AS "CreatedByIp", r.revoked AS "Revoked", r.revoked_by_ip AS "RevokedByIp", r.replaced_by_token AS "ReplacedByToken", r.reason_revoked AS "ReasonRevoked", r.is_expired AS "IsExpired", r.is_revoked AS "IsRevoked", r.is_active AS "IsActive"
FROM refresh_token AS r
WHERE r.user_id = @__id_0
2022-09-23 13:14:37.335 +01:00 [INF] Executed DbCommand (5ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.user_id AS "UserId", r.token AS "RefToken", r.expires AS "Expires", r.created AS "Created", r.created_by_ip AS "CreatedByIp", r.revoked AS "Revoked", r.revoked_by_ip AS "RevokedByIp", r.replaced_by_token AS "ReplacedByToken", r.reason_revoked AS "ReasonRevoked", r.is_expired AS "IsExpired", r.is_revoked AS "IsRevoked", r.is_active AS "IsActive"
FROM refresh_token AS r
WHERE r.user_id = @__id_0
2022-09-23 13:14:37.338 +01:00 [DBG] A data reader was disposed.
2022-09-23 13:14:37.339 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 13:14:37.340 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 13:14:37.353 +01:00 [DBG] An entity of type 'User' tracked by 'PostgresContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 13:14:37.376 +01:00 [DBG] 'PostgresContext' generated a temporary value for the property 'Id.RefreshToken'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 13:14:37.407 +01:00 [DBG] Context 'PostgresContext' started tracking 'RefreshToken' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 13:14:37.412 +01:00 [DBG] SaveChanges starting for 'PostgresContext'.
2022-09-23 13:14:37.416 +01:00 [DBG] DetectChanges starting for 'PostgresContext'.
2022-09-23 13:14:37.437 +01:00 [DBG] 1 entities were added and 0 entities were removed from navigation 'User.RefreshTokenCollection'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 13:14:37.448 +01:00 [DBG] The foreign key property 'RefreshToken.UserId' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2022-09-23 13:14:37.466 +01:00 [DBG] DetectChanges completed for 'PostgresContext'.
2022-09-23 13:14:37.475 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 13:14:37.478 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 13:14:37.480 +01:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2022-09-23 13:14:37.486 +01:00 [DBG] Began transaction with isolation level 'ReadCommitted'.
2022-09-23 13:14:37.548 +01:00 [DBG] Executing 2 update commands as a batch.
2022-09-23 13:14:37.559 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 13:14:37.560 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2022-09-23 13:14:37.563 +01:00 [DBG] Executing DbCommand [Parameters=[@p0='?' (DbType = DateTime), @p1='?', @p2='?' (DbType = DateTime), @p3='?' (DbType = Boolean), @p4='?' (DbType = Boolean), @p5='?' (DbType = Boolean), @p6='?', @p7='?', @p8='?', @p9='?' (DbType = DateTime), @p10='?', @p11='?' (DbType = Int32), @p18='?' (DbType = Int32), @p12='?' (DbType = DateTime), @p13='?', @p14='?', @p15='?' (DbType = DateTime), @p16='?', @p17='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO refresh_token (created, created_by_ip, expires, is_active, is_expired, is_revoked, reason_revoked, token, replaced_by_token, revoked, revoked_by_ip, user_id)
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11)
RETURNING id;
UPDATE users SET created_at = @p12, email = @p13, full_name = @p14, password_changed_at = @p15, password_hash = @p16, username = @p17
WHERE id = @p18;
2022-09-23 13:14:37.572 +01:00 [INF] Executed DbCommand (9ms) [Parameters=[@p0='?' (DbType = DateTime), @p1='?', @p2='?' (DbType = DateTime), @p3='?' (DbType = Boolean), @p4='?' (DbType = Boolean), @p5='?' (DbType = Boolean), @p6='?', @p7='?', @p8='?', @p9='?' (DbType = DateTime), @p10='?', @p11='?' (DbType = Int32), @p18='?' (DbType = Int32), @p12='?' (DbType = DateTime), @p13='?', @p14='?', @p15='?' (DbType = DateTime), @p16='?', @p17='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO refresh_token (created, created_by_ip, expires, is_active, is_expired, is_revoked, reason_revoked, token, replaced_by_token, revoked, revoked_by_ip, user_id)
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11)
RETURNING id;
UPDATE users SET created_at = @p12, email = @p13, full_name = @p14, password_changed_at = @p15, password_hash = @p16, username = @p17
WHERE id = @p18;
2022-09-23 13:14:37.587 +01:00 [DBG] The foreign key property 'RefreshToken.Id' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2022-09-23 13:14:37.591 +01:00 [DBG] A data reader was disposed.
2022-09-23 13:14:37.592 +01:00 [DBG] Committing transaction.
2022-09-23 13:14:37.599 +01:00 [DBG] Committed transaction.
2022-09-23 13:14:37.600 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 13:14:37.602 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 13:14:37.604 +01:00 [DBG] Disposing transaction.
2022-09-23 13:14:37.608 +01:00 [DBG] An entity of type 'RefreshToken' tracked by 'PostgresContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 13:14:37.609 +01:00 [DBG] An entity of type 'User' tracked by 'PostgresContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 13:14:37.613 +01:00 [DBG] SaveChanges completed for 'PostgresContext' with 2 entities written to the database.
2022-09-23 13:14:37.619 +01:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2022-09-23 13:14:37.625 +01:00 [DBG] Attempting to select an output formatter based on Accept header '["text/plain"]'.
2022-09-23 13:14:37.629 +01:00 [DBG] Could not find an output formatter based on content negotiation. Accepted types were (["text/plain"])
2022-09-23 13:14:37.632 +01:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2022-09-23 13:14:37.634 +01:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2022-09-23 13:14:37.635 +01:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2022-09-23 13:14:37.637 +01:00 [INF] Executing OkObjectResult, writing value of type 'APIBank.Models.MyRequestResponses.LoginResponse'.
2022-09-23 13:14:37.652 +01:00 [INF] Executed action APIBank.Controllers.UsersController.Login (APIBank) in 2806.037ms
2022-09-23 13:14:37.654 +01:00 [INF] Executed endpoint 'APIBank.Controllers.UsersController.Login (APIBank)'
2022-09-23 13:14:37.656 +01:00 [DBG] 'PostgresContext' disposed.
2022-09-23 13:14:37.659 +01:00 [INF] Request finished HTTP/2 POST https://localhost:7036/api/Users/Login application/json 58 - 200 - application/json;+charset=utf-8 3169.0924ms
2022-09-23 13:14:47.538 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/api/Accounts/GetAll - -
2022-09-23 13:14:47.542 +01:00 [DBG] 1 candidate(s) found for the request path '/api/Accounts/GetAll'
2022-09-23 13:14:47.544 +01:00 [DBG] Endpoint 'APIBank.Controllers.AccountsController.GetAllFromUser (APIBank)' with route pattern 'api/Accounts/GetAll' is valid for the request path '/api/Accounts/GetAll'
2022-09-23 13:14:47.562 +01:00 [DBG] Request matched endpoint 'APIBank.Controllers.AccountsController.GetAllFromUser (APIBank)'
2022-09-23 13:14:47.564 +01:00 [DBG] Static files was skipped as the request already matched an endpoint.
2022-09-23 13:14:47.659 +01:00 [INF] Entity Framework Core 6.0.9 initialized 'PostgresContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:6.0.7+5b98e4b74de93b590b44aef8dd7967c03acc433c' with options: None
2022-09-23 13:14:47.667 +01:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .FirstOrDefault(e => EF.Property<int>(e, "Id") == __p_0)'
2022-09-23 13:14:47.678 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<User>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: User.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: User.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 1], [Property: User.Email (string) Required Index MaxLength(254), 2], [Property: User.FullName (string) Required MaxLength(100), 3], [Property: User.PasswordChangedAt (DateTime) Required ValueGenerated.OnAdd, 4], [Property: User.PasswordHash (string) Required MaxLength(200), 5], [Property: User.Username (string) Required Index MaxLength(50), 6] }
        SELECT TOP(1) u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
        FROM users AS u
        WHERE u.id == @__p_0), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, User>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)
    .SingleOrDefault()'
2022-09-23 13:14:47.680 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 13:14:47.681 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2022-09-23 13:14:47.682 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 13:14:47.683 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 13:14:47.684 +01:00 [DBG] Executing DbCommand [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.id = @__p_0
LIMIT 1
2022-09-23 13:14:47.689 +01:00 [INF] Executed DbCommand (5ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.id = @__p_0
LIMIT 1
2022-09-23 13:14:47.693 +01:00 [DBG] Context 'PostgresContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 13:14:47.695 +01:00 [DBG] A data reader was disposed.
2022-09-23 13:14:47.696 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 13:14:47.697 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 13:14:47.698 +01:00 [INF] Executing endpoint 'APIBank.Controllers.AccountsController.GetAllFromUser (APIBank)'
2022-09-23 13:14:47.700 +01:00 [INF] Route matched with {action = "GetAllFromUser", controller = "Accounts"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult GetAllFromUser() on controller APIBank.Controllers.AccountsController (APIBank).
2022-09-23 13:14:47.701 +01:00 [DBG] Execution plan of authorization filters (in the following order): ["APIBank.Authorization.AuthorizeAttribute"]
2022-09-23 13:14:47.703 +01:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2022-09-23 13:14:47.707 +01:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2022-09-23 13:14:47.709 +01:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2022-09-23 13:14:47.710 +01:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2022-09-23 13:14:47.712 +01:00 [DBG] Executing controller factory for controller APIBank.Controllers.AccountsController (APIBank)
2022-09-23 13:14:47.713 +01:00 [DBG] Executed controller factory for controller APIBank.Controllers.AccountsController (APIBank)
2022-09-23 13:14:47.718 +01:00 [DBG] Compiling query expression: 
'DbSet<RefreshToken>()
    .FirstOrDefault(e => EF.Property<int>(e, "Id") == __p_0)'
2022-09-23 13:14:47.726 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<RefreshToken>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: RefreshToken.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: RefreshToken.Created (DateTime) Required, 1], [Property: RefreshToken.CreatedByIp (string) Required MaxLength(200), 2], [Property: RefreshToken.Expires (DateTime) Required, 3], [Property: RefreshToken.IsActive (no field, bool) Required, 4], [Property: RefreshToken.IsExpired (no field, bool) Required, 5], [Property: RefreshToken.IsRevoked (no field, bool) Required, 6], [Property: RefreshToken.ReasonRevoked (string) MaxLength(200), 7], [Property: RefreshToken.RefToken (string) Required MaxLength(254), 8], [Property: RefreshToken.ReplacedByToken (string) MaxLength(200), 9], [Property: RefreshToken.Revoked (DateTime?), 10], [Property: RefreshToken.RevokedByIp (string) MaxLength(200), 11], [Property: RefreshToken.UserId (int) Required FK Index, 12] }
        SELECT TOP(1) r.id, r.created, r.created_by_ip, r.expires, r.is_active, r.is_expired, r.is_revoked, r.reason_revoked, r.token, r.replaced_by_token, r.revoked, r.revoked_by_ip, r.user_id
        FROM refresh_token AS r
        WHERE r.id == @__p_0), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, RefreshToken>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)
    .SingleOrDefault()'
2022-09-23 13:14:47.728 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 13:14:47.729 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2022-09-23 13:14:47.730 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 13:14:47.731 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 13:14:47.732 +01:00 [DBG] Executing DbCommand [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id, r.created, r.created_by_ip, r.expires, r.is_active, r.is_expired, r.is_revoked, r.reason_revoked, r.token, r.replaced_by_token, r.revoked, r.revoked_by_ip, r.user_id
FROM refresh_token AS r
WHERE r.id = @__p_0
LIMIT 1
2022-09-23 13:14:47.734 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id, r.created, r.created_by_ip, r.expires, r.is_active, r.is_expired, r.is_revoked, r.reason_revoked, r.token, r.replaced_by_token, r.revoked, r.revoked_by_ip, r.user_id
FROM refresh_token AS r
WHERE r.id = @__p_0
LIMIT 1
2022-09-23 13:14:47.738 +01:00 [DBG] A data reader was disposed.
2022-09-23 13:14:47.739 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 13:14:47.741 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 13:14:47.744 +01:00 [INF] Executed action APIBank.Controllers.AccountsController.GetAllFromUser (APIBank) in 32.0116ms
2022-09-23 13:14:47.745 +01:00 [INF] Executed endpoint 'APIBank.Controllers.AccountsController.GetAllFromUser (APIBank)'
2022-09-23 13:14:47.747 +01:00 [INF] Global Error was found:
2022-09-23 13:14:47.748 +01:00 [DBG] 'PostgresContext' disposed.
2022-09-23 13:14:47.749 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/api/Accounts/GetAll - - - 404 - application/json 211.5553ms
2022-09-23 13:14:56.005 +01:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2022-09-23 13:14:56.182 +01:00 [DBG] Hosting starting
2022-09-23 13:14:56.518 +01:00 [DBG] Using development certificate: CN=localhost (Thumbprint: 9CC642E9838495A6C3C202DECA6A8AD300396DD2)
2022-09-23 13:14:56.604 +01:00 [INF] Now listening on: https://localhost:7036
2022-09-23 13:14:56.606 +01:00 [INF] Now listening on: http://localhost:5036
2022-09-23 13:14:56.607 +01:00 [DBG] Loaded hosting startup assembly APIBank
2022-09-23 13:14:56.608 +01:00 [DBG] Loaded hosting startup assembly Microsoft.AspNetCore.Watch.BrowserRefresh
2022-09-23 13:14:56.609 +01:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.BrowserLink.Net
2022-09-23 13:14:56.611 +01:00 [INF] Application started. Press Ctrl+C to shut down.
2022-09-23 13:14:56.613 +01:00 [INF] Hosting environment: Development
2022-09-23 13:14:56.613 +01:00 [INF] Content root path: C:\Users\mguedesa\OneDrive - NTT DATA EMEAL\Documentos\GitHub\OpenBankAPI-NTT\APIBank\APIBank\
2022-09-23 13:14:56.614 +01:00 [DBG] Hosting started
2022-09-23 13:14:56.615 +01:00 [DBG] Connection id "0HMKTBKT8P128" received FIN.
2022-09-23 13:14:56.628 +01:00 [DBG] Connection id "0HMKTBKT8P128" accepted.
2022-09-23 13:14:56.630 +01:00 [DBG] Connection id "0HMKTBKT8P128" started.
2022-09-23 13:14:56.661 +01:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException:  Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveBlobAsync[TIOAdapter](TIOAdapter adapter)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](TIOAdapter adapter, Boolean receiveFirst, Byte[] reAuthenticationData, Boolean isApm)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2022-09-23 13:14:56.761 +01:00 [DBG] Connection id "0HMKTBKT8P128" stopped.
2022-09-23 13:14:56.766 +01:00 [DBG] Connection id "0HMKTBKT8P128" sending FIN because: "The Socket transport's send loop completed gracefully."
2022-09-23 13:14:56.966 +01:00 [DBG] Connection id "0HMKTBKT8P129" accepted.
2022-09-23 13:14:56.969 +01:00 [DBG] Connection id "0HMKTBKT8P129" started.
2022-09-23 13:14:57.028 +01:00 [DBG] Connection 0HMKTBKT8P129 established using the following protocol: "Tls12"
2022-09-23 13:14:57.123 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/swagger/index.html - -
2022-09-23 13:14:57.194 +01:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2022-09-23 13:14:57.225 +01:00 [DBG] No candidates found for the request path '/swagger/index.html'
2022-09-23 13:14:57.227 +01:00 [DBG] Request did not match any endpoints
2022-09-23 13:14:57.348 +01:00 [DBG] Response markup is scheduled to include browser refresh script injection.
2022-09-23 13:14:57.541 +01:00 [DBG] Response markup was updated to include browser refresh script injection.
2022-09-23 13:14:57.551 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/swagger/index.html - - - 200 - text/html;charset=utf-8 428.8641ms
2022-09-23 13:14:57.576 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/_vs/browserLink - -
2022-09-23 13:14:57.576 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/_framework/aspnetcore-browser-refresh.js - -
2022-09-23 13:14:57.595 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/_framework/aspnetcore-browser-refresh.js - - - 200 11984 application/javascript;+charset=utf-8 18.6385ms
2022-09-23 13:14:57.617 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/_vs/browserLink - - - 200 - text/javascript;+charset=UTF-8 40.7222ms
2022-09-23 13:14:57.691 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/swagger/v1/swagger.json - -
2022-09-23 13:14:57.692 +01:00 [DBG] No candidates found for the request path '/swagger/v1/swagger.json'
2022-09-23 13:14:57.693 +01:00 [DBG] Request did not match any endpoints
2022-09-23 13:14:57.917 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/swagger/v1/swagger.json - - - 200 - application/json;charset=utf-8 226.5200ms
2022-09-23 13:15:07.207 +01:00 [INF] Request starting HTTP/2 POST https://localhost:7036/api/Users/Login application/json 58
2022-09-23 13:15:07.240 +01:00 [DBG] 1 candidate(s) found for the request path '/api/Users/Login'
2022-09-23 13:15:07.249 +01:00 [DBG] Endpoint 'APIBank.Controllers.UsersController.Login (APIBank)' with route pattern 'api/Users/Login' is valid for the request path '/api/Users/Login'
2022-09-23 13:15:07.254 +01:00 [DBG] Request matched endpoint 'APIBank.Controllers.UsersController.Login (APIBank)'
2022-09-23 13:15:07.262 +01:00 [DBG] Static files was skipped as the request already matched an endpoint.
2022-09-23 13:15:07.741 +01:00 [INF] Executing endpoint 'APIBank.Controllers.UsersController.Login (APIBank)'
2022-09-23 13:15:07.770 +01:00 [INF] Route matched with {action = "Login", controller = "Users"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult Login(APIBank.Models.Requests.UserLoginRequest) on controller APIBank.Controllers.UsersController (APIBank).
2022-09-23 13:15:07.775 +01:00 [DBG] Execution plan of authorization filters (in the following order): ["APIBank.Authorization.AuthorizeAttribute"]
2022-09-23 13:15:07.776 +01:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2022-09-23 13:15:07.777 +01:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2022-09-23 13:15:07.778 +01:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2022-09-23 13:15:07.779 +01:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2022-09-23 13:15:07.782 +01:00 [DBG] Executing controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-23 13:15:07.784 +01:00 [DBG] Executed controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-23 13:15:07.800 +01:00 [DBG] Attempting to bind parameter 'model' of type 'APIBank.Models.Requests.UserLoginRequest' ...
2022-09-23 13:15:07.806 +01:00 [DBG] Attempting to bind parameter 'model' of type 'APIBank.Models.Requests.UserLoginRequest' using the name '' in request data ...
2022-09-23 13:15:07.809 +01:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2022-09-23 13:15:07.815 +01:00 [DBG] Connection id "0HMKTBKT8P129", Request id "0HMKTBKT8P129:00000009": started reading request body.
2022-09-23 13:15:07.817 +01:00 [DBG] Connection id "0HMKTBKT8P129", Request id "0HMKTBKT8P129:00000009": done reading request body.
2022-09-23 13:15:07.828 +01:00 [DBG] JSON input formatter succeeded, deserializing to type 'APIBank.Models.Requests.UserLoginRequest'
2022-09-23 13:15:07.830 +01:00 [DBG] Done attempting to bind parameter 'model' of type 'APIBank.Models.Requests.UserLoginRequest'.
2022-09-23 13:15:07.831 +01:00 [DBG] Done attempting to bind parameter 'model' of type 'APIBank.Models.Requests.UserLoginRequest'.
2022-09-23 13:15:07.832 +01:00 [DBG] Attempting to validate the bound parameter 'model' of type 'APIBank.Models.Requests.UserLoginRequest' ...
2022-09-23 13:15:07.843 +01:00 [DBG] Done attempting to validate the bound parameter 'model' of type 'APIBank.Models.Requests.UserLoginRequest'.
2022-09-23 13:15:08.029 +01:00 [DBG] An additional 'IServiceProvider' was created for internal use by Entity Framework. An existing service provider was not used due to the following configuration changes: configuration changed for 'Core:ConfigureWarnings', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:UseAdminDatabase', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:SetPostgresVersion', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:UseRedshift', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:ReverseNullOrdering', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:RemoteCertificateValidationCallback', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:ProvideClientCertificatesCallback', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:ProvidePasswordCallback'.
2022-09-23 13:15:09.577 +01:00 [INF] Entity Framework Core 6.0.9 initialized 'PostgresContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:6.0.7+5b98e4b74de93b590b44aef8dd7967c03acc433c' with options: None
2022-09-23 13:15:09.661 +01:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .SingleOrDefault(x => x.Username == __model_Username_0)'
2022-09-23 13:15:10.141 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<User>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: User.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: User.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 1], [Property: User.Email (string) Required Index MaxLength(254), 2], [Property: User.FullName (string) Required MaxLength(100), 3], [Property: User.PasswordChangedAt (DateTime) Required ValueGenerated.OnAdd, 4], [Property: User.PasswordHash (string) Required MaxLength(200), 5], [Property: User.Username (string) Required Index MaxLength(50), 6] }
        SELECT TOP(2) u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
        FROM users AS u
        WHERE u.username == @__model_Username_0), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, User>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)
    .SingleOrDefault()'
2022-09-23 13:15:10.211 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 13:15:10.329 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (117ms).
2022-09-23 13:15:10.343 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 13:15:10.728 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 13:15:10.751 +01:00 [DBG] Executing DbCommand [Parameters=[@__model_Username_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.username = @__model_Username_0
LIMIT 2
2022-09-23 13:15:10.885 +01:00 [INF] Executed DbCommand (139ms) [Parameters=[@__model_Username_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.username = @__model_Username_0
LIMIT 2
2022-09-23 13:15:10.960 +01:00 [DBG] Context 'PostgresContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 13:15:11.036 +01:00 [DBG] A data reader was disposed.
2022-09-23 13:15:11.046 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 13:15:11.058 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 13:15:11.285 +01:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .Any(user => user.RefreshTokenCollection
        .Any(reftoken => reftoken.RefToken == __token_0))'
2022-09-23 13:15:11.439 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<bool>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            EmptyProjectionMember -> 0
        SELECT EXISTS (
            SELECT 1
            FROM users AS u
            WHERE EXISTS (
                SELECT 1
                FROM refresh_token AS r
                WHERE ((u.id != NULL) && (u.id == r.user_id)) && (r.token == @__token_0)))), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, bool>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)
    .Single()'
2022-09-23 13:15:11.456 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 13:15:11.457 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2022-09-23 13:15:11.458 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 13:15:11.459 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 13:15:11.460 +01:00 [DBG] Executing DbCommand [Parameters=[@__token_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM users AS u
    WHERE EXISTS (
        SELECT 1
        FROM refresh_token AS r
        WHERE (u.id = r.user_id) AND (r.token = @__token_0)))
2022-09-23 13:15:11.463 +01:00 [INF] Executed DbCommand (4ms) [Parameters=[@__token_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM users AS u
    WHERE EXISTS (
        SELECT 1
        FROM refresh_token AS r
        WHERE (u.id = r.user_id) AND (r.token = @__token_0)))
2022-09-23 13:15:11.471 +01:00 [DBG] A data reader was disposed.
2022-09-23 13:15:11.472 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 13:15:11.473 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 13:15:11.729 +01:00 [DBG] Compiling query expression: 
'DbSet<RefreshToken>()
    .Where(rt => rt.UserId == __id_0)
    .AsNoTracking()
    .Select(rt => new RefreshToken{ 
        Id = rt.Id, 
        UserId = rt.UserId, 
        RefToken = rt.RefToken, 
        Expires = rt.Expires, 
        Created = rt.Created, 
        CreatedByIp = rt.CreatedByIp, 
        Revoked = rt.Revoked, 
        RevokedByIp = rt.RevokedByIp, 
        ReplacedByToken = rt.ReplacedByToken, 
        ReasonRevoked = rt.ReasonRevoked, 
        IsExpired = rt.IsExpired, 
        IsRevoked = rt.IsRevoked, 
        IsActive = rt.IsActive 
    }
    )'
2022-09-23 13:15:11.760 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<RefreshToken>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            Id -> 0
            UserId -> 1
            RefToken -> 2
            Expires -> 3
            Created -> 4
            CreatedByIp -> 5
            Revoked -> 6
            RevokedByIp -> 7
            ReplacedByToken -> 8
            ReasonRevoked -> 9
            IsExpired -> 10
            IsRevoked -> 11
            IsActive -> 12
        SELECT r.id AS Id, r.user_id AS UserId, r.token AS RefToken, r.expires AS Expires, r.created AS Created, r.created_by_ip AS CreatedByIp, r.revoked AS Revoked, r.revoked_by_ip AS RevokedByIp, r.replaced_by_token AS ReplacedByToken, r.reason_revoked AS ReasonRevoked, r.is_expired AS IsExpired, r.is_revoked AS IsRevoked, r.is_active AS IsActive
        FROM refresh_token AS r
        WHERE r.user_id == @__id_0), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, RefreshToken>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)'
2022-09-23 13:15:11.764 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 13:15:11.765 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2022-09-23 13:15:11.766 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 13:15:11.766 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 13:15:11.767 +01:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.user_id AS "UserId", r.token AS "RefToken", r.expires AS "Expires", r.created AS "Created", r.created_by_ip AS "CreatedByIp", r.revoked AS "Revoked", r.revoked_by_ip AS "RevokedByIp", r.replaced_by_token AS "ReplacedByToken", r.reason_revoked AS "ReasonRevoked", r.is_expired AS "IsExpired", r.is_revoked AS "IsRevoked", r.is_active AS "IsActive"
FROM refresh_token AS r
WHERE r.user_id = @__id_0
2022-09-23 13:15:11.776 +01:00 [INF] Executed DbCommand (9ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.user_id AS "UserId", r.token AS "RefToken", r.expires AS "Expires", r.created AS "Created", r.created_by_ip AS "CreatedByIp", r.revoked AS "Revoked", r.revoked_by_ip AS "RevokedByIp", r.replaced_by_token AS "ReplacedByToken", r.reason_revoked AS "ReasonRevoked", r.is_expired AS "IsExpired", r.is_revoked AS "IsRevoked", r.is_active AS "IsActive"
FROM refresh_token AS r
WHERE r.user_id = @__id_0
2022-09-23 13:15:11.779 +01:00 [DBG] A data reader was disposed.
2022-09-23 13:15:11.780 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 13:15:11.781 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 13:15:11.797 +01:00 [DBG] An entity of type 'User' tracked by 'PostgresContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 13:15:11.842 +01:00 [DBG] 'PostgresContext' generated a temporary value for the property 'Id.RefreshToken'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 13:15:11.894 +01:00 [DBG] Context 'PostgresContext' started tracking 'RefreshToken' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 13:15:11.904 +01:00 [DBG] SaveChanges starting for 'PostgresContext'.
2022-09-23 13:15:11.909 +01:00 [DBG] DetectChanges starting for 'PostgresContext'.
2022-09-23 13:15:11.955 +01:00 [DBG] 1 entities were added and 0 entities were removed from navigation 'User.RefreshTokenCollection'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 13:15:11.975 +01:00 [DBG] The foreign key property 'RefreshToken.UserId' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2022-09-23 13:15:12.000 +01:00 [DBG] DetectChanges completed for 'PostgresContext'.
2022-09-23 13:15:12.016 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 13:15:12.019 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 13:15:12.023 +01:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2022-09-23 13:15:12.036 +01:00 [DBG] Began transaction with isolation level 'ReadCommitted'.
2022-09-23 13:15:12.122 +01:00 [DBG] Executing 2 update commands as a batch.
2022-09-23 13:15:12.144 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 13:15:12.145 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2022-09-23 13:15:12.148 +01:00 [DBG] Executing DbCommand [Parameters=[@p0='?' (DbType = DateTime), @p1='?', @p2='?' (DbType = DateTime), @p3='?' (DbType = Boolean), @p4='?' (DbType = Boolean), @p5='?' (DbType = Boolean), @p6='?', @p7='?', @p8='?', @p9='?' (DbType = DateTime), @p10='?', @p11='?' (DbType = Int32), @p18='?' (DbType = Int32), @p12='?' (DbType = DateTime), @p13='?', @p14='?', @p15='?' (DbType = DateTime), @p16='?', @p17='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO refresh_token (created, created_by_ip, expires, is_active, is_expired, is_revoked, reason_revoked, token, replaced_by_token, revoked, revoked_by_ip, user_id)
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11)
RETURNING id;
UPDATE users SET created_at = @p12, email = @p13, full_name = @p14, password_changed_at = @p15, password_hash = @p16, username = @p17
WHERE id = @p18;
2022-09-23 13:15:12.162 +01:00 [INF] Executed DbCommand (15ms) [Parameters=[@p0='?' (DbType = DateTime), @p1='?', @p2='?' (DbType = DateTime), @p3='?' (DbType = Boolean), @p4='?' (DbType = Boolean), @p5='?' (DbType = Boolean), @p6='?', @p7='?', @p8='?', @p9='?' (DbType = DateTime), @p10='?', @p11='?' (DbType = Int32), @p18='?' (DbType = Int32), @p12='?' (DbType = DateTime), @p13='?', @p14='?', @p15='?' (DbType = DateTime), @p16='?', @p17='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO refresh_token (created, created_by_ip, expires, is_active, is_expired, is_revoked, reason_revoked, token, replaced_by_token, revoked, revoked_by_ip, user_id)
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11)
RETURNING id;
UPDATE users SET created_at = @p12, email = @p13, full_name = @p14, password_changed_at = @p15, password_hash = @p16, username = @p17
WHERE id = @p18;
2022-09-23 13:15:12.182 +01:00 [DBG] The foreign key property 'RefreshToken.Id' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2022-09-23 13:15:12.188 +01:00 [DBG] A data reader was disposed.
2022-09-23 13:15:12.193 +01:00 [DBG] Committing transaction.
2022-09-23 13:15:12.205 +01:00 [DBG] Committed transaction.
2022-09-23 13:15:12.207 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 13:15:12.209 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 13:15:12.213 +01:00 [DBG] Disposing transaction.
2022-09-23 13:15:12.217 +01:00 [DBG] An entity of type 'RefreshToken' tracked by 'PostgresContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 13:15:12.220 +01:00 [DBG] An entity of type 'User' tracked by 'PostgresContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 13:15:12.223 +01:00 [DBG] SaveChanges completed for 'PostgresContext' with 2 entities written to the database.
2022-09-23 13:15:12.230 +01:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2022-09-23 13:15:12.236 +01:00 [DBG] Attempting to select an output formatter based on Accept header '["text/plain"]'.
2022-09-23 13:15:12.238 +01:00 [DBG] Could not find an output formatter based on content negotiation. Accepted types were (["text/plain"])
2022-09-23 13:15:12.239 +01:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2022-09-23 13:15:12.241 +01:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2022-09-23 13:15:12.243 +01:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2022-09-23 13:15:12.244 +01:00 [INF] Executing OkObjectResult, writing value of type 'APIBank.Models.MyRequestResponses.LoginResponse'.
2022-09-23 13:15:12.263 +01:00 [INF] Executed action APIBank.Controllers.UsersController.Login (APIBank) in 4477.3133ms
2022-09-23 13:15:12.265 +01:00 [INF] Executed endpoint 'APIBank.Controllers.UsersController.Login (APIBank)'
2022-09-23 13:15:12.273 +01:00 [DBG] 'PostgresContext' disposed.
2022-09-23 13:15:12.279 +01:00 [INF] Request finished HTTP/2 POST https://localhost:7036/api/Users/Login application/json 58 - 200 - application/json;+charset=utf-8 5071.6338ms
2022-09-23 13:15:26.360 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/api/Accounts/GetAll - -
2022-09-23 13:15:26.364 +01:00 [DBG] 1 candidate(s) found for the request path '/api/Accounts/GetAll'
2022-09-23 13:15:26.366 +01:00 [DBG] Endpoint 'APIBank.Controllers.AccountsController.GetAllFromUser (APIBank)' with route pattern 'api/Accounts/GetAll' is valid for the request path '/api/Accounts/GetAll'
2022-09-23 13:15:26.368 +01:00 [DBG] Request matched endpoint 'APIBank.Controllers.AccountsController.GetAllFromUser (APIBank)'
2022-09-23 13:15:26.370 +01:00 [DBG] Static files was skipped as the request already matched an endpoint.
2022-09-23 13:15:26.502 +01:00 [INF] Entity Framework Core 6.0.9 initialized 'PostgresContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:6.0.7+5b98e4b74de93b590b44aef8dd7967c03acc433c' with options: None
2022-09-23 13:15:26.526 +01:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .FirstOrDefault(e => EF.Property<int>(e, "Id") == __p_0)'
2022-09-23 13:15:26.534 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<User>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: User.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: User.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 1], [Property: User.Email (string) Required Index MaxLength(254), 2], [Property: User.FullName (string) Required MaxLength(100), 3], [Property: User.PasswordChangedAt (DateTime) Required ValueGenerated.OnAdd, 4], [Property: User.PasswordHash (string) Required MaxLength(200), 5], [Property: User.Username (string) Required Index MaxLength(50), 6] }
        SELECT TOP(1) u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
        FROM users AS u
        WHERE u.id == @__p_0), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, User>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)
    .SingleOrDefault()'
2022-09-23 13:15:26.537 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 13:15:26.538 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2022-09-23 13:15:26.539 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 13:15:26.541 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 13:15:26.543 +01:00 [DBG] Executing DbCommand [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.id = @__p_0
LIMIT 1
2022-09-23 13:15:26.546 +01:00 [INF] Executed DbCommand (3ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.id = @__p_0
LIMIT 1
2022-09-23 13:15:26.551 +01:00 [DBG] Context 'PostgresContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 13:15:26.552 +01:00 [DBG] A data reader was disposed.
2022-09-23 13:15:26.553 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 13:15:26.554 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 13:15:26.555 +01:00 [INF] Executing endpoint 'APIBank.Controllers.AccountsController.GetAllFromUser (APIBank)'
2022-09-23 13:15:26.559 +01:00 [INF] Route matched with {action = "GetAllFromUser", controller = "Accounts"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult GetAllFromUser() on controller APIBank.Controllers.AccountsController (APIBank).
2022-09-23 13:15:26.561 +01:00 [DBG] Execution plan of authorization filters (in the following order): ["APIBank.Authorization.AuthorizeAttribute"]
2022-09-23 13:15:26.563 +01:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2022-09-23 13:15:26.564 +01:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2022-09-23 13:15:26.567 +01:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2022-09-23 13:15:26.568 +01:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2022-09-23 13:15:26.570 +01:00 [DBG] Executing controller factory for controller APIBank.Controllers.AccountsController (APIBank)
2022-09-23 13:15:26.571 +01:00 [DBG] Executed controller factory for controller APIBank.Controllers.AccountsController (APIBank)
2022-09-23 13:16:45.904 +01:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2022-09-23 13:16:46.102 +01:00 [DBG] Hosting starting
2022-09-23 13:16:46.299 +01:00 [DBG] Using development certificate: CN=localhost (Thumbprint: 9CC642E9838495A6C3C202DECA6A8AD300396DD2)
2022-09-23 13:16:46.390 +01:00 [INF] Now listening on: https://localhost:7036
2022-09-23 13:16:46.392 +01:00 [INF] Now listening on: http://localhost:5036
2022-09-23 13:16:46.394 +01:00 [DBG] Loaded hosting startup assembly APIBank
2022-09-23 13:16:46.395 +01:00 [DBG] Loaded hosting startup assembly Microsoft.AspNetCore.Watch.BrowserRefresh
2022-09-23 13:16:46.395 +01:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.BrowserLink.Net
2022-09-23 13:16:46.397 +01:00 [INF] Application started. Press Ctrl+C to shut down.
2022-09-23 13:16:46.398 +01:00 [INF] Hosting environment: Development
2022-09-23 13:16:46.399 +01:00 [INF] Content root path: C:\Users\mguedesa\OneDrive - NTT DATA EMEAL\Documentos\GitHub\OpenBankAPI-NTT\APIBank\APIBank\
2022-09-23 13:16:46.400 +01:00 [DBG] Hosting started
2022-09-23 13:16:46.654 +01:00 [DBG] Connection id "0HMKTBLU266K9" received FIN.
2022-09-23 13:16:46.654 +01:00 [DBG] Connection id "0HMKTBLU266KA" received FIN.
2022-09-23 13:16:46.659 +01:00 [DBG] Connection id "0HMKTBLU266K9" accepted.
2022-09-23 13:16:46.659 +01:00 [DBG] Connection id "0HMKTBLU266KA" accepted.
2022-09-23 13:16:46.667 +01:00 [DBG] Connection id "0HMKTBLU266K9" started.
2022-09-23 13:16:46.667 +01:00 [DBG] Connection id "0HMKTBLU266KA" started.
2022-09-23 13:16:46.702 +01:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException:  Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveBlobAsync[TIOAdapter](TIOAdapter adapter)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](TIOAdapter adapter, Boolean receiveFirst, Byte[] reAuthenticationData, Boolean isApm)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2022-09-23 13:16:46.702 +01:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException:  Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveBlobAsync[TIOAdapter](TIOAdapter adapter)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](TIOAdapter adapter, Boolean receiveFirst, Byte[] reAuthenticationData, Boolean isApm)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2022-09-23 13:16:46.789 +01:00 [DBG] Connection id "0HMKTBLU266K9" stopped.
2022-09-23 13:16:46.789 +01:00 [DBG] Connection id "0HMKTBLU266KA" stopped.
2022-09-23 13:16:46.797 +01:00 [DBG] Connection id "0HMKTBLU266KA" sending FIN because: "The Socket transport's send loop completed gracefully."
2022-09-23 13:16:46.797 +01:00 [DBG] Connection id "0HMKTBLU266K9" sending FIN because: "The Socket transport's send loop completed gracefully."
2022-09-23 13:16:46.943 +01:00 [DBG] Connection id "0HMKTBLU266KB" accepted.
2022-09-23 13:16:46.945 +01:00 [DBG] Connection id "0HMKTBLU266KB" started.
2022-09-23 13:16:47.007 +01:00 [DBG] Connection 0HMKTBLU266KB established using the following protocol: "Tls12"
2022-09-23 13:16:47.107 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/swagger/index.html - -
2022-09-23 13:16:47.153 +01:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2022-09-23 13:16:47.182 +01:00 [DBG] No candidates found for the request path '/swagger/index.html'
2022-09-23 13:16:47.183 +01:00 [DBG] Request did not match any endpoints
2022-09-23 13:16:47.306 +01:00 [DBG] Response markup is scheduled to include browser refresh script injection.
2022-09-23 13:16:47.505 +01:00 [DBG] Response markup was updated to include browser refresh script injection.
2022-09-23 13:16:47.516 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/swagger/index.html - - - 200 - text/html;charset=utf-8 412.2147ms
2022-09-23 13:16:47.544 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/_vs/browserLink - -
2022-09-23 13:16:47.545 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/_framework/aspnetcore-browser-refresh.js - -
2022-09-23 13:16:47.560 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/_framework/aspnetcore-browser-refresh.js - - - 200 11984 application/javascript;+charset=utf-8 15.1569ms
2022-09-23 13:16:47.601 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/_vs/browserLink - - - 200 - text/javascript;+charset=UTF-8 55.9595ms
2022-09-23 13:16:47.676 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/swagger/v1/swagger.json - -
2022-09-23 13:16:47.681 +01:00 [DBG] No candidates found for the request path '/swagger/v1/swagger.json'
2022-09-23 13:16:47.682 +01:00 [DBG] Request did not match any endpoints
2022-09-23 13:16:47.889 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/swagger/v1/swagger.json - - - 200 - application/json;charset=utf-8 213.3785ms
2022-09-23 13:16:56.881 +01:00 [INF] Request starting HTTP/2 POST https://localhost:7036/api/Users/Login application/json 58
2022-09-23 13:16:56.926 +01:00 [DBG] 1 candidate(s) found for the request path '/api/Users/Login'
2022-09-23 13:16:56.941 +01:00 [DBG] Endpoint 'APIBank.Controllers.UsersController.Login (APIBank)' with route pattern 'api/Users/Login' is valid for the request path '/api/Users/Login'
2022-09-23 13:16:56.945 +01:00 [DBG] Request matched endpoint 'APIBank.Controllers.UsersController.Login (APIBank)'
2022-09-23 13:16:56.948 +01:00 [DBG] Static files was skipped as the request already matched an endpoint.
2022-09-23 13:16:57.447 +01:00 [INF] Executing endpoint 'APIBank.Controllers.UsersController.Login (APIBank)'
2022-09-23 13:16:57.479 +01:00 [INF] Route matched with {action = "Login", controller = "Users"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult Login(APIBank.Models.Requests.UserLoginRequest) on controller APIBank.Controllers.UsersController (APIBank).
2022-09-23 13:16:57.485 +01:00 [DBG] Execution plan of authorization filters (in the following order): ["APIBank.Authorization.AuthorizeAttribute"]
2022-09-23 13:16:57.488 +01:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2022-09-23 13:16:57.489 +01:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2022-09-23 13:16:57.490 +01:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2022-09-23 13:16:57.491 +01:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2022-09-23 13:16:57.494 +01:00 [DBG] Executing controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-23 13:16:57.495 +01:00 [DBG] Executed controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-23 13:16:57.515 +01:00 [DBG] Attempting to bind parameter 'model' of type 'APIBank.Models.Requests.UserLoginRequest' ...
2022-09-23 13:16:57.521 +01:00 [DBG] Attempting to bind parameter 'model' of type 'APIBank.Models.Requests.UserLoginRequest' using the name '' in request data ...
2022-09-23 13:16:57.523 +01:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2022-09-23 13:16:57.529 +01:00 [DBG] Connection id "0HMKTBLU266KB", Request id "0HMKTBLU266KB:00000009": started reading request body.
2022-09-23 13:16:57.531 +01:00 [DBG] Connection id "0HMKTBLU266KB", Request id "0HMKTBLU266KB:00000009": done reading request body.
2022-09-23 13:16:57.540 +01:00 [DBG] JSON input formatter succeeded, deserializing to type 'APIBank.Models.Requests.UserLoginRequest'
2022-09-23 13:16:57.541 +01:00 [DBG] Done attempting to bind parameter 'model' of type 'APIBank.Models.Requests.UserLoginRequest'.
2022-09-23 13:16:57.543 +01:00 [DBG] Done attempting to bind parameter 'model' of type 'APIBank.Models.Requests.UserLoginRequest'.
2022-09-23 13:16:57.544 +01:00 [DBG] Attempting to validate the bound parameter 'model' of type 'APIBank.Models.Requests.UserLoginRequest' ...
2022-09-23 13:16:57.554 +01:00 [DBG] Done attempting to validate the bound parameter 'model' of type 'APIBank.Models.Requests.UserLoginRequest'.
2022-09-23 13:16:57.696 +01:00 [DBG] An additional 'IServiceProvider' was created for internal use by Entity Framework. An existing service provider was not used due to the following configuration changes: configuration changed for 'Core:ConfigureWarnings', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:UseAdminDatabase', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:SetPostgresVersion', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:UseRedshift', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:ReverseNullOrdering', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:RemoteCertificateValidationCallback', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:ProvideClientCertificatesCallback', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:ProvidePasswordCallback'.
2022-09-23 13:16:59.206 +01:00 [INF] Entity Framework Core 6.0.9 initialized 'PostgresContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:6.0.7+5b98e4b74de93b590b44aef8dd7967c03acc433c' with options: None
2022-09-23 13:16:59.314 +01:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .SingleOrDefault(x => x.Username == __model_Username_0)'
2022-09-23 13:16:59.833 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<User>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: User.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: User.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 1], [Property: User.Email (string) Required Index MaxLength(254), 2], [Property: User.FullName (string) Required MaxLength(100), 3], [Property: User.PasswordChangedAt (DateTime) Required ValueGenerated.OnAdd, 4], [Property: User.PasswordHash (string) Required MaxLength(200), 5], [Property: User.Username (string) Required Index MaxLength(50), 6] }
        SELECT TOP(2) u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
        FROM users AS u
        WHERE u.username == @__model_Username_0), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, User>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)
    .SingleOrDefault()'
2022-09-23 13:16:59.904 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 13:17:00.005 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (98ms).
2022-09-23 13:17:00.025 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 13:17:00.352 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 13:17:00.376 +01:00 [DBG] Executing DbCommand [Parameters=[@__model_Username_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.username = @__model_Username_0
LIMIT 2
2022-09-23 13:17:00.504 +01:00 [INF] Executed DbCommand (137ms) [Parameters=[@__model_Username_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.username = @__model_Username_0
LIMIT 2
2022-09-23 13:17:00.591 +01:00 [DBG] Context 'PostgresContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 13:17:00.661 +01:00 [DBG] A data reader was disposed.
2022-09-23 13:17:00.671 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 13:17:00.682 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 13:17:00.909 +01:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .Any(user => user.RefreshTokenCollection
        .Any(reftoken => reftoken.RefToken == __token_0))'
2022-09-23 13:17:01.068 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<bool>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            EmptyProjectionMember -> 0
        SELECT EXISTS (
            SELECT 1
            FROM users AS u
            WHERE EXISTS (
                SELECT 1
                FROM refresh_token AS r
                WHERE ((u.id != NULL) && (u.id == r.user_id)) && (r.token == @__token_0)))), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, bool>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)
    .Single()'
2022-09-23 13:17:01.081 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 13:17:01.083 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2022-09-23 13:17:01.086 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 13:17:01.087 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 13:17:01.087 +01:00 [DBG] Executing DbCommand [Parameters=[@__token_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM users AS u
    WHERE EXISTS (
        SELECT 1
        FROM refresh_token AS r
        WHERE (u.id = r.user_id) AND (r.token = @__token_0)))
2022-09-23 13:17:01.091 +01:00 [INF] Executed DbCommand (3ms) [Parameters=[@__token_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM users AS u
    WHERE EXISTS (
        SELECT 1
        FROM refresh_token AS r
        WHERE (u.id = r.user_id) AND (r.token = @__token_0)))
2022-09-23 13:17:01.098 +01:00 [DBG] A data reader was disposed.
2022-09-23 13:17:01.099 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 13:17:01.100 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 13:18:45.627 +01:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2022-09-23 13:18:45.775 +01:00 [DBG] Hosting starting
2022-09-23 13:18:46.065 +01:00 [DBG] Using development certificate: CN=localhost (Thumbprint: 9CC642E9838495A6C3C202DECA6A8AD300396DD2)
2022-09-23 13:18:46.176 +01:00 [INF] Now listening on: https://localhost:7036
2022-09-23 13:18:46.224 +01:00 [INF] Now listening on: http://localhost:5036
2022-09-23 13:18:46.225 +01:00 [DBG] Loaded hosting startup assembly APIBank
2022-09-23 13:18:46.228 +01:00 [DBG] Loaded hosting startup assembly Microsoft.AspNetCore.Watch.BrowserRefresh
2022-09-23 13:18:46.229 +01:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.BrowserLink.Net
2022-09-23 13:18:46.231 +01:00 [INF] Application started. Press Ctrl+C to shut down.
2022-09-23 13:18:46.232 +01:00 [INF] Hosting environment: Development
2022-09-23 13:18:46.234 +01:00 [INF] Content root path: C:\Users\mguedesa\OneDrive - NTT DATA EMEAL\Documentos\GitHub\OpenBankAPI-NTT\APIBank\APIBank\
2022-09-23 13:18:46.235 +01:00 [DBG] Hosting started
2022-09-23 13:18:46.458 +01:00 [DBG] Connection id "0HMKTBN1OMFK3" accepted.
2022-09-23 13:18:46.458 +01:00 [DBG] Connection id "0HMKTBN1OMFK2" accepted.
2022-09-23 13:18:46.461 +01:00 [DBG] Connection id "0HMKTBN1OMFK3" started.
2022-09-23 13:18:46.461 +01:00 [DBG] Connection id "0HMKTBN1OMFK2" started.
2022-09-23 13:18:46.467 +01:00 [DBG] Connection id "0HMKTBN1OMFK2" received FIN.
2022-09-23 13:18:46.467 +01:00 [DBG] Connection id "0HMKTBN1OMFK3" received FIN.
2022-09-23 13:18:46.485 +01:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException:  Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveBlobAsync[TIOAdapter](TIOAdapter adapter)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](TIOAdapter adapter, Boolean receiveFirst, Byte[] reAuthenticationData, Boolean isApm)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2022-09-23 13:18:46.485 +01:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException:  Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveBlobAsync[TIOAdapter](TIOAdapter adapter)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](TIOAdapter adapter, Boolean receiveFirst, Byte[] reAuthenticationData, Boolean isApm)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2022-09-23 13:18:46.530 +01:00 [DBG] Connection id "0HMKTBN1OMFK3" stopped.
2022-09-23 13:18:46.530 +01:00 [DBG] Connection id "0HMKTBN1OMFK2" stopped.
2022-09-23 13:18:46.533 +01:00 [DBG] Connection id "0HMKTBN1OMFK2" sending FIN because: "The Socket transport's send loop completed gracefully."
2022-09-23 13:18:46.533 +01:00 [DBG] Connection id "0HMKTBN1OMFK3" sending FIN because: "The Socket transport's send loop completed gracefully."
2022-09-23 13:18:46.898 +01:00 [DBG] Connection id "0HMKTBN1OMFK4" accepted.
2022-09-23 13:18:46.900 +01:00 [DBG] Connection id "0HMKTBN1OMFK4" started.
2022-09-23 13:18:46.964 +01:00 [DBG] Connection 0HMKTBN1OMFK4 established using the following protocol: "Tls12"
2022-09-23 13:18:47.047 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/swagger/index.html - -
2022-09-23 13:18:47.098 +01:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2022-09-23 13:18:47.129 +01:00 [DBG] No candidates found for the request path '/swagger/index.html'
2022-09-23 13:18:47.130 +01:00 [DBG] Request did not match any endpoints
2022-09-23 13:18:47.245 +01:00 [DBG] Response markup is scheduled to include browser refresh script injection.
2022-09-23 13:18:47.426 +01:00 [DBG] Response markup was updated to include browser refresh script injection.
2022-09-23 13:18:47.434 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/swagger/index.html - - - 200 - text/html;charset=utf-8 390.8689ms
2022-09-23 13:18:47.458 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/_vs/browserLink - -
2022-09-23 13:18:47.458 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/_framework/aspnetcore-browser-refresh.js - -
2022-09-23 13:18:47.468 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/_framework/aspnetcore-browser-refresh.js - - - 200 11984 application/javascript;+charset=utf-8 9.4354ms
2022-09-23 13:18:47.505 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/_vs/browserLink - - - 200 - text/javascript;+charset=UTF-8 46.8032ms
2022-09-23 13:18:47.580 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/swagger/v1/swagger.json - -
2022-09-23 13:18:47.582 +01:00 [DBG] No candidates found for the request path '/swagger/v1/swagger.json'
2022-09-23 13:18:47.583 +01:00 [DBG] Request did not match any endpoints
2022-09-23 13:18:47.817 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/swagger/v1/swagger.json - - - 200 - application/json;charset=utf-8 236.4839ms
2022-09-23 13:18:57.684 +01:00 [INF] Request starting HTTP/2 POST https://localhost:7036/api/Users/Login application/json 58
2022-09-23 13:18:57.701 +01:00 [DBG] 1 candidate(s) found for the request path '/api/Users/Login'
2022-09-23 13:18:57.706 +01:00 [DBG] Endpoint 'APIBank.Controllers.UsersController.Login (APIBank)' with route pattern 'api/Users/Login' is valid for the request path '/api/Users/Login'
2022-09-23 13:18:57.709 +01:00 [DBG] Request matched endpoint 'APIBank.Controllers.UsersController.Login (APIBank)'
2022-09-23 13:18:57.714 +01:00 [DBG] Static files was skipped as the request already matched an endpoint.
2022-09-23 13:18:58.183 +01:00 [INF] Executing endpoint 'APIBank.Controllers.UsersController.Login (APIBank)'
2022-09-23 13:18:58.215 +01:00 [INF] Route matched with {action = "Login", controller = "Users"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult Login(APIBank.Models.Requests.UserLoginRequest) on controller APIBank.Controllers.UsersController (APIBank).
2022-09-23 13:18:58.218 +01:00 [DBG] Execution plan of authorization filters (in the following order): ["APIBank.Authorization.AuthorizeAttribute"]
2022-09-23 13:18:58.220 +01:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2022-09-23 13:18:58.222 +01:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2022-09-23 13:18:58.225 +01:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2022-09-23 13:18:58.231 +01:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2022-09-23 13:18:58.235 +01:00 [DBG] Executing controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-23 13:18:58.237 +01:00 [DBG] Executed controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-23 13:18:58.266 +01:00 [DBG] Attempting to bind parameter 'model' of type 'APIBank.Models.Requests.UserLoginRequest' ...
2022-09-23 13:18:58.270 +01:00 [DBG] Attempting to bind parameter 'model' of type 'APIBank.Models.Requests.UserLoginRequest' using the name '' in request data ...
2022-09-23 13:18:58.272 +01:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2022-09-23 13:18:58.284 +01:00 [DBG] Connection id "0HMKTBN1OMFK4", Request id "0HMKTBN1OMFK4:00000009": started reading request body.
2022-09-23 13:18:58.286 +01:00 [DBG] Connection id "0HMKTBN1OMFK4", Request id "0HMKTBN1OMFK4:00000009": done reading request body.
2022-09-23 13:18:58.296 +01:00 [DBG] JSON input formatter succeeded, deserializing to type 'APIBank.Models.Requests.UserLoginRequest'
2022-09-23 13:18:58.299 +01:00 [DBG] Done attempting to bind parameter 'model' of type 'APIBank.Models.Requests.UserLoginRequest'.
2022-09-23 13:18:58.300 +01:00 [DBG] Done attempting to bind parameter 'model' of type 'APIBank.Models.Requests.UserLoginRequest'.
2022-09-23 13:18:58.301 +01:00 [DBG] Attempting to validate the bound parameter 'model' of type 'APIBank.Models.Requests.UserLoginRequest' ...
2022-09-23 13:18:58.312 +01:00 [DBG] Done attempting to validate the bound parameter 'model' of type 'APIBank.Models.Requests.UserLoginRequest'.
2022-09-23 13:18:58.467 +01:00 [DBG] An additional 'IServiceProvider' was created for internal use by Entity Framework. An existing service provider was not used due to the following configuration changes: configuration changed for 'Core:ConfigureWarnings', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:UseAdminDatabase', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:SetPostgresVersion', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:UseRedshift', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:ReverseNullOrdering', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:RemoteCertificateValidationCallback', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:ProvideClientCertificatesCallback', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:ProvidePasswordCallback'.
2022-09-23 13:19:00.132 +01:00 [INF] Entity Framework Core 6.0.9 initialized 'PostgresContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:6.0.7+5b98e4b74de93b590b44aef8dd7967c03acc433c' with options: None
2022-09-23 13:19:00.213 +01:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .SingleOrDefault(x => x.Username == __model_Username_0)'
2022-09-23 13:19:00.713 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<User>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: User.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: User.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 1], [Property: User.Email (string) Required Index MaxLength(254), 2], [Property: User.FullName (string) Required MaxLength(100), 3], [Property: User.PasswordChangedAt (DateTime) Required ValueGenerated.OnAdd, 4], [Property: User.PasswordHash (string) Required MaxLength(200), 5], [Property: User.Username (string) Required Index MaxLength(50), 6] }
        SELECT TOP(2) u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
        FROM users AS u
        WHERE u.username == @__model_Username_0), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, User>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)
    .SingleOrDefault()'
2022-09-23 13:19:00.789 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 13:19:00.893 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (97ms).
2022-09-23 13:19:00.908 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 13:19:01.243 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 13:19:01.261 +01:00 [DBG] Executing DbCommand [Parameters=[@__model_Username_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.username = @__model_Username_0
LIMIT 2
2022-09-23 13:19:01.399 +01:00 [INF] Executed DbCommand (137ms) [Parameters=[@__model_Username_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.username = @__model_Username_0
LIMIT 2
2022-09-23 13:19:01.479 +01:00 [DBG] Context 'PostgresContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 13:19:01.547 +01:00 [DBG] A data reader was disposed.
2022-09-23 13:19:01.555 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 13:19:01.568 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 13:19:24.330 +01:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .Any(user => user.RefreshTokenCollection
        .Any(reftoken => reftoken.RefToken == __token_0))'
2022-09-23 13:19:24.496 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<bool>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            EmptyProjectionMember -> 0
        SELECT EXISTS (
            SELECT 1
            FROM users AS u
            WHERE EXISTS (
                SELECT 1
                FROM refresh_token AS r
                WHERE ((u.id != NULL) && (u.id == r.user_id)) && (r.token == @__token_0)))), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, bool>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)
    .Single()'
2022-09-23 13:19:24.510 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 13:19:24.511 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2022-09-23 13:19:24.512 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 13:19:24.512 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 13:19:24.513 +01:00 [DBG] Executing DbCommand [Parameters=[@__token_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM users AS u
    WHERE EXISTS (
        SELECT 1
        FROM refresh_token AS r
        WHERE (u.id = r.user_id) AND (r.token = @__token_0)))
2022-09-23 13:19:24.516 +01:00 [INF] Executed DbCommand (3ms) [Parameters=[@__token_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM users AS u
    WHERE EXISTS (
        SELECT 1
        FROM refresh_token AS r
        WHERE (u.id = r.user_id) AND (r.token = @__token_0)))
2022-09-23 13:19:24.525 +01:00 [DBG] A data reader was disposed.
2022-09-23 13:19:24.526 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 13:19:24.527 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 13:19:41.065 +01:00 [DBG] SaveChanges starting for 'PostgresContext'.
2022-09-23 13:19:41.075 +01:00 [DBG] DetectChanges starting for 'PostgresContext'.
2022-09-23 13:19:41.117 +01:00 [DBG] 1 entities were added and 0 entities were removed from navigation 'User.RefreshTokenCollection'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 13:19:41.174 +01:00 [DBG] 'PostgresContext' generated a temporary value for the property 'Id.RefreshToken'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 13:19:41.258 +01:00 [DBG] Context 'PostgresContext' started tracking 'RefreshToken' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 13:19:41.263 +01:00 [DBG] DetectChanges completed for 'PostgresContext'.
2022-09-23 13:19:41.277 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 13:19:41.280 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 13:19:41.285 +01:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2022-09-23 13:19:41.311 +01:00 [DBG] Began transaction with isolation level 'ReadCommitted'.
2022-09-23 13:19:41.398 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 13:19:41.399 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2022-09-23 13:19:41.401 +01:00 [DBG] Executing DbCommand [Parameters=[@p0='?' (DbType = DateTime), @p1='?', @p2='?' (DbType = DateTime), @p3='?' (DbType = Boolean), @p4='?' (DbType = Boolean), @p5='?' (DbType = Boolean), @p6='?', @p7='?', @p8='?', @p9='?' (DbType = DateTime), @p10='?', @p11='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO refresh_token (created, created_by_ip, expires, is_active, is_expired, is_revoked, reason_revoked, token, replaced_by_token, revoked, revoked_by_ip, user_id)
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11)
RETURNING id;
2022-09-23 13:19:41.431 +01:00 [INF] Executed DbCommand (30ms) [Parameters=[@p0='?' (DbType = DateTime), @p1='?', @p2='?' (DbType = DateTime), @p3='?' (DbType = Boolean), @p4='?' (DbType = Boolean), @p5='?' (DbType = Boolean), @p6='?', @p7='?', @p8='?', @p9='?' (DbType = DateTime), @p10='?', @p11='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO refresh_token (created, created_by_ip, expires, is_active, is_expired, is_revoked, reason_revoked, token, replaced_by_token, revoked, revoked_by_ip, user_id)
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11)
RETURNING id;
2022-09-23 13:19:41.461 +01:00 [DBG] The foreign key property 'RefreshToken.Id' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2022-09-23 13:19:41.471 +01:00 [DBG] A data reader was disposed.
2022-09-23 13:19:41.479 +01:00 [DBG] Committing transaction.
2022-09-23 13:19:41.496 +01:00 [DBG] Committed transaction.
2022-09-23 13:19:41.499 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 13:19:41.502 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 13:19:41.507 +01:00 [DBG] Disposing transaction.
2022-09-23 13:19:41.526 +01:00 [DBG] An entity of type 'RefreshToken' tracked by 'PostgresContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 13:19:41.530 +01:00 [DBG] SaveChanges completed for 'PostgresContext' with 1 entities written to the database.
2022-09-23 13:20:02.719 +01:00 [DBG] Compiling query expression: 
'DbSet<RefreshToken>()
    .Where(rt => rt.UserId == __id_0)
    .AsNoTracking()
    .Select(rt => new RefreshToken{ 
        Id = rt.Id, 
        UserId = rt.UserId, 
        RefToken = rt.RefToken, 
        Expires = rt.Expires, 
        Created = rt.Created, 
        CreatedByIp = rt.CreatedByIp, 
        Revoked = rt.Revoked, 
        RevokedByIp = rt.RevokedByIp, 
        ReplacedByToken = rt.ReplacedByToken, 
        ReasonRevoked = rt.ReasonRevoked, 
        IsExpired = rt.IsExpired, 
        IsRevoked = rt.IsRevoked, 
        IsActive = rt.IsActive 
    }
    )'
2022-09-23 13:20:02.758 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<RefreshToken>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            Id -> 0
            UserId -> 1
            RefToken -> 2
            Expires -> 3
            Created -> 4
            CreatedByIp -> 5
            Revoked -> 6
            RevokedByIp -> 7
            ReplacedByToken -> 8
            ReasonRevoked -> 9
            IsExpired -> 10
            IsRevoked -> 11
            IsActive -> 12
        SELECT r.id AS Id, r.user_id AS UserId, r.token AS RefToken, r.expires AS Expires, r.created AS Created, r.created_by_ip AS CreatedByIp, r.revoked AS Revoked, r.revoked_by_ip AS RevokedByIp, r.replaced_by_token AS ReplacedByToken, r.reason_revoked AS ReasonRevoked, r.is_expired AS IsExpired, r.is_revoked AS IsRevoked, r.is_active AS IsActive
        FROM refresh_token AS r
        WHERE r.user_id == @__id_0), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, RefreshToken>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)'
2022-09-23 13:20:02.764 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 13:20:02.765 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2022-09-23 13:20:02.767 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 13:20:02.767 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 13:20:02.769 +01:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.user_id AS "UserId", r.token AS "RefToken", r.expires AS "Expires", r.created AS "Created", r.created_by_ip AS "CreatedByIp", r.revoked AS "Revoked", r.revoked_by_ip AS "RevokedByIp", r.replaced_by_token AS "ReplacedByToken", r.reason_revoked AS "ReasonRevoked", r.is_expired AS "IsExpired", r.is_revoked AS "IsRevoked", r.is_active AS "IsActive"
FROM refresh_token AS r
WHERE r.user_id = @__id_0
2022-09-23 13:20:02.771 +01:00 [INF] Executed DbCommand (3ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.user_id AS "UserId", r.token AS "RefToken", r.expires AS "Expires", r.created AS "Created", r.created_by_ip AS "CreatedByIp", r.revoked AS "Revoked", r.revoked_by_ip AS "RevokedByIp", r.replaced_by_token AS "ReplacedByToken", r.reason_revoked AS "ReasonRevoked", r.is_expired AS "IsExpired", r.is_revoked AS "IsRevoked", r.is_active AS "IsActive"
FROM refresh_token AS r
WHERE r.user_id = @__id_0
2022-09-23 13:20:02.801 +01:00 [DBG] A data reader was disposed.
2022-09-23 13:20:02.802 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 13:20:02.804 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 13:20:04.582 +01:00 [DBG] An entity of type 'User' tracked by 'PostgresContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 13:20:04.585 +01:00 [DBG] An entity of type 'RefreshToken' tracked by 'PostgresContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 13:20:04.589 +01:00 [DBG] SaveChanges starting for 'PostgresContext'.
2022-09-23 13:20:04.591 +01:00 [DBG] DetectChanges starting for 'PostgresContext'.
2022-09-23 13:20:04.592 +01:00 [DBG] DetectChanges completed for 'PostgresContext'.
2022-09-23 13:20:04.594 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 13:20:04.595 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 13:20:04.596 +01:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2022-09-23 13:20:04.597 +01:00 [DBG] Began transaction with isolation level 'ReadCommitted'.
2022-09-23 13:20:04.628 +01:00 [DBG] Executing 2 update commands as a batch.
2022-09-23 13:20:04.633 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 13:20:04.634 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2022-09-23 13:20:04.636 +01:00 [DBG] Executing DbCommand [Parameters=[@p12='?' (DbType = Int32), @p0='?' (DbType = DateTime), @p1='?', @p2='?' (DbType = DateTime), @p3='?' (DbType = Boolean), @p4='?' (DbType = Boolean), @p5='?' (DbType = Boolean), @p6='?', @p7='?', @p8='?', @p9='?' (DbType = DateTime), @p10='?', @p11='?' (DbType = Int32), @p19='?' (DbType = Int32), @p13='?' (DbType = DateTime), @p14='?', @p15='?', @p16='?' (DbType = DateTime), @p17='?', @p18='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE refresh_token SET created = @p0, created_by_ip = @p1, expires = @p2, is_active = @p3, is_expired = @p4, is_revoked = @p5, reason_revoked = @p6, token = @p7, replaced_by_token = @p8, revoked = @p9, revoked_by_ip = @p10, user_id = @p11
WHERE id = @p12;
UPDATE users SET created_at = @p13, email = @p14, full_name = @p15, password_changed_at = @p16, password_hash = @p17, username = @p18
WHERE id = @p19;
2022-09-23 13:20:04.645 +01:00 [INF] Executed DbCommand (9ms) [Parameters=[@p12='?' (DbType = Int32), @p0='?' (DbType = DateTime), @p1='?', @p2='?' (DbType = DateTime), @p3='?' (DbType = Boolean), @p4='?' (DbType = Boolean), @p5='?' (DbType = Boolean), @p6='?', @p7='?', @p8='?', @p9='?' (DbType = DateTime), @p10='?', @p11='?' (DbType = Int32), @p19='?' (DbType = Int32), @p13='?' (DbType = DateTime), @p14='?', @p15='?', @p16='?' (DbType = DateTime), @p17='?', @p18='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE refresh_token SET created = @p0, created_by_ip = @p1, expires = @p2, is_active = @p3, is_expired = @p4, is_revoked = @p5, reason_revoked = @p6, token = @p7, replaced_by_token = @p8, revoked = @p9, revoked_by_ip = @p10, user_id = @p11
WHERE id = @p12;
UPDATE users SET created_at = @p13, email = @p14, full_name = @p15, password_changed_at = @p16, password_hash = @p17, username = @p18
WHERE id = @p19;
2022-09-23 13:20:04.649 +01:00 [DBG] A data reader was disposed.
2022-09-23 13:20:04.650 +01:00 [DBG] Committing transaction.
2022-09-23 13:20:04.651 +01:00 [DBG] Committed transaction.
2022-09-23 13:20:04.652 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 13:20:04.653 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 13:20:04.655 +01:00 [DBG] Disposing transaction.
2022-09-23 13:20:04.657 +01:00 [DBG] An entity of type 'User' tracked by 'PostgresContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 13:20:04.662 +01:00 [DBG] An entity of type 'RefreshToken' tracked by 'PostgresContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 13:20:04.664 +01:00 [DBG] SaveChanges completed for 'PostgresContext' with 2 entities written to the database.
2022-09-23 13:20:04.675 +01:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2022-09-23 13:20:04.684 +01:00 [DBG] Attempting to select an output formatter based on Accept header '["text/plain"]'.
2022-09-23 13:20:04.687 +01:00 [DBG] Could not find an output formatter based on content negotiation. Accepted types were (["text/plain"])
2022-09-23 13:20:04.689 +01:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2022-09-23 13:20:04.691 +01:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2022-09-23 13:20:04.692 +01:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2022-09-23 13:20:04.694 +01:00 [INF] Executing OkObjectResult, writing value of type 'APIBank.Models.MyRequestResponses.LoginResponse'.
2022-09-23 13:20:04.715 +01:00 [INF] Executed action APIBank.Controllers.UsersController.Login (APIBank) in 66470.5195ms
2022-09-23 13:20:04.718 +01:00 [INF] Executed endpoint 'APIBank.Controllers.UsersController.Login (APIBank)'
2022-09-23 13:20:04.728 +01:00 [DBG] 'PostgresContext' disposed.
2022-09-23 13:20:04.741 +01:00 [INF] Request finished HTTP/2 POST https://localhost:7036/api/Users/Login application/json 58 - 200 - application/json;+charset=utf-8 67051.7533ms
2022-09-23 13:20:15.795 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/api/Accounts/GetAll - -
2022-09-23 13:20:15.803 +01:00 [DBG] 1 candidate(s) found for the request path '/api/Accounts/GetAll'
2022-09-23 13:20:15.805 +01:00 [DBG] Endpoint 'APIBank.Controllers.AccountsController.GetAllFromUser (APIBank)' with route pattern 'api/Accounts/GetAll' is valid for the request path '/api/Accounts/GetAll'
2022-09-23 13:20:15.809 +01:00 [DBG] Request matched endpoint 'APIBank.Controllers.AccountsController.GetAllFromUser (APIBank)'
2022-09-23 13:20:15.811 +01:00 [DBG] Static files was skipped as the request already matched an endpoint.
2022-09-23 13:20:15.952 +01:00 [INF] Entity Framework Core 6.0.9 initialized 'PostgresContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:6.0.7+5b98e4b74de93b590b44aef8dd7967c03acc433c' with options: None
2022-09-23 13:20:15.964 +01:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .FirstOrDefault(e => EF.Property<int>(e, "Id") == __p_0)'
2022-09-23 13:20:15.971 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<User>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: User.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: User.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 1], [Property: User.Email (string) Required Index MaxLength(254), 2], [Property: User.FullName (string) Required MaxLength(100), 3], [Property: User.PasswordChangedAt (DateTime) Required ValueGenerated.OnAdd, 4], [Property: User.PasswordHash (string) Required MaxLength(200), 5], [Property: User.Username (string) Required Index MaxLength(50), 6] }
        SELECT TOP(1) u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
        FROM users AS u
        WHERE u.id == @__p_0), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, User>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)
    .SingleOrDefault()'
2022-09-23 13:20:15.972 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 13:20:15.973 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2022-09-23 13:20:15.974 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 13:20:15.974 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 13:20:15.975 +01:00 [DBG] Executing DbCommand [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.id = @__p_0
LIMIT 1
2022-09-23 13:20:15.977 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.id = @__p_0
LIMIT 1
2022-09-23 13:20:15.979 +01:00 [DBG] Context 'PostgresContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 13:20:15.980 +01:00 [DBG] A data reader was disposed.
2022-09-23 13:20:15.981 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 13:20:15.982 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 13:20:15.985 +01:00 [INF] Executing endpoint 'APIBank.Controllers.AccountsController.GetAllFromUser (APIBank)'
2022-09-23 13:20:15.987 +01:00 [INF] Route matched with {action = "GetAllFromUser", controller = "Accounts"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult GetAllFromUser() on controller APIBank.Controllers.AccountsController (APIBank).
2022-09-23 13:20:15.988 +01:00 [DBG] Execution plan of authorization filters (in the following order): ["APIBank.Authorization.AuthorizeAttribute"]
2022-09-23 13:20:15.989 +01:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2022-09-23 13:20:15.990 +01:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2022-09-23 13:20:15.991 +01:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2022-09-23 13:20:15.992 +01:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2022-09-23 13:20:15.993 +01:00 [DBG] Executing controller factory for controller APIBank.Controllers.AccountsController (APIBank)
2022-09-23 13:20:15.994 +01:00 [DBG] Executed controller factory for controller APIBank.Controllers.AccountsController (APIBank)
2022-09-23 13:20:52.003 +01:00 [DBG] Compiling query expression: 
'DbSet<RefreshToken>()
    .FirstOrDefault(e => EF.Property<int>(e, "Id") == __p_0)'
2022-09-23 13:20:52.013 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<RefreshToken>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: RefreshToken.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: RefreshToken.Created (DateTime) Required, 1], [Property: RefreshToken.CreatedByIp (string) Required MaxLength(200), 2], [Property: RefreshToken.Expires (DateTime) Required, 3], [Property: RefreshToken.IsActive (no field, bool) Required, 4], [Property: RefreshToken.IsExpired (no field, bool) Required, 5], [Property: RefreshToken.IsRevoked (no field, bool) Required, 6], [Property: RefreshToken.ReasonRevoked (string) MaxLength(200), 7], [Property: RefreshToken.RefToken (string) Required MaxLength(254), 8], [Property: RefreshToken.ReplacedByToken (string) MaxLength(200), 9], [Property: RefreshToken.Revoked (DateTime?), 10], [Property: RefreshToken.RevokedByIp (string) MaxLength(200), 11], [Property: RefreshToken.UserId (int) Required FK Index, 12] }
        SELECT TOP(1) r.id, r.created, r.created_by_ip, r.expires, r.is_active, r.is_expired, r.is_revoked, r.reason_revoked, r.token, r.replaced_by_token, r.revoked, r.revoked_by_ip, r.user_id
        FROM refresh_token AS r
        WHERE r.id == @__p_0), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, RefreshToken>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)
    .SingleOrDefault()'
2022-09-23 13:20:52.017 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 13:20:52.019 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (2ms).
2022-09-23 13:20:52.021 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 13:20:52.022 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 13:20:52.024 +01:00 [DBG] Executing DbCommand [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id, r.created, r.created_by_ip, r.expires, r.is_active, r.is_expired, r.is_revoked, r.reason_revoked, r.token, r.replaced_by_token, r.revoked, r.revoked_by_ip, r.user_id
FROM refresh_token AS r
WHERE r.id = @__p_0
LIMIT 1
2022-09-23 13:20:52.026 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id, r.created, r.created_by_ip, r.expires, r.is_active, r.is_expired, r.is_revoked, r.reason_revoked, r.token, r.replaced_by_token, r.revoked, r.revoked_by_ip, r.user_id
FROM refresh_token AS r
WHERE r.id = @__p_0
LIMIT 1
2022-09-23 13:20:52.043 +01:00 [DBG] Context 'PostgresContext' started tracking 'RefreshToken' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 13:20:52.047 +01:00 [DBG] A data reader was disposed.
2022-09-23 13:20:52.049 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 13:20:52.051 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 13:21:04.467 +01:00 [DBG] Compiling query expression: 
'DbSet<Account>()
    .Where(u => u.UserId == __userId_0)
    .Select(u => new AccountRequestResponse{ 
        Balance = u.Balance, 
        CreatedAt = u.CreatedAt, 
        Currency = u.Currency, 
        Id = u.Id 
    }
    )'
2022-09-23 13:21:04.482 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<AccountRequestResponse>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            Balance -> 0
            CreatedAt -> 1
            Currency -> 2
            Id -> 3
        SELECT a.balance AS Balance, a.created_at AS CreatedAt, a.currency AS Currency, a.id AS Id
        FROM accounts AS a
        WHERE a.user_id == @__userId_0), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, AccountRequestResponse>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)'
2022-09-23 13:21:04.485 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 13:21:04.486 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2022-09-23 13:21:04.487 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 13:21:04.487 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 13:21:04.488 +01:00 [DBG] Executing DbCommand [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a.balance AS "Balance", a.created_at AS "CreatedAt", a.currency AS "Currency", a.id AS "Id"
FROM accounts AS a
WHERE a.user_id = @__userId_0
2022-09-23 13:21:04.496 +01:00 [INF] Executed DbCommand (8ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a.balance AS "Balance", a.created_at AS "CreatedAt", a.currency AS "Currency", a.id AS "Id"
FROM accounts AS a
WHERE a.user_id = @__userId_0
2022-09-23 13:21:04.513 +01:00 [DBG] A data reader was disposed.
2022-09-23 13:21:04.515 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 13:21:04.517 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 13:21:04.518 +01:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2022-09-23 13:21:04.519 +01:00 [DBG] Attempting to select an output formatter based on Accept header '["text/plain"]'.
2022-09-23 13:21:04.521 +01:00 [DBG] Could not find an output formatter based on content negotiation. Accepted types were (["text/plain"])
2022-09-23 13:21:04.522 +01:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2022-09-23 13:21:04.523 +01:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2022-09-23 13:21:04.524 +01:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2022-09-23 13:21:04.526 +01:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[APIBank.Models.Responses.AccountRequestResponse, APIBank, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2022-09-23 13:21:04.536 +01:00 [INF] Executed action APIBank.Controllers.AccountsController.GetAllFromUser (APIBank) in 48539.5748ms
2022-09-23 13:21:04.538 +01:00 [INF] Executed endpoint 'APIBank.Controllers.AccountsController.GetAllFromUser (APIBank)'
2022-09-23 13:21:04.541 +01:00 [DBG] 'PostgresContext' disposed.
2022-09-23 13:21:04.545 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/api/Accounts/GetAll - - - 200 - application/json;+charset=utf-8 48746.3472ms
2022-09-23 13:21:18.505 +01:00 [INF] Request starting HTTP/2 POST https://localhost:7036/api/Users/revoke-token application/json 20
2022-09-23 13:21:18.519 +01:00 [DBG] 1 candidate(s) found for the request path '/api/Users/revoke-token'
2022-09-23 13:21:18.522 +01:00 [DBG] Endpoint 'APIBank.Controllers.UsersController.RevokeToken (APIBank)' with route pattern 'api/Users/revoke-token' is valid for the request path '/api/Users/revoke-token'
2022-09-23 13:21:18.524 +01:00 [DBG] Request matched endpoint 'APIBank.Controllers.UsersController.RevokeToken (APIBank)'
2022-09-23 13:21:18.525 +01:00 [DBG] Static files was skipped as the request already matched an endpoint.
2022-09-23 13:21:18.602 +01:00 [INF] Entity Framework Core 6.0.9 initialized 'PostgresContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:6.0.7+5b98e4b74de93b590b44aef8dd7967c03acc433c' with options: None
2022-09-23 13:21:18.608 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 13:21:18.609 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2022-09-23 13:21:18.610 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 13:21:18.611 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 13:21:18.614 +01:00 [DBG] Executing DbCommand [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.id = @__p_0
LIMIT 1
2022-09-23 13:21:18.617 +01:00 [INF] Executed DbCommand (3ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.id = @__p_0
LIMIT 1
2022-09-23 13:21:18.619 +01:00 [DBG] Context 'PostgresContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 13:21:18.621 +01:00 [DBG] A data reader was disposed.
2022-09-23 13:21:18.621 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 13:21:18.622 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 13:21:18.625 +01:00 [INF] Executing endpoint 'APIBank.Controllers.UsersController.RevokeToken (APIBank)'
2022-09-23 13:21:18.627 +01:00 [INF] Route matched with {action = "RevokeToken", controller = "Users"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult RevokeToken(APIBank.Models.MyRequestResponses.UserRevokeTokenRequest) on controller APIBank.Controllers.UsersController (APIBank).
2022-09-23 13:21:18.630 +01:00 [DBG] Execution plan of authorization filters (in the following order): ["APIBank.Authorization.AuthorizeAttribute"]
2022-09-23 13:21:18.633 +01:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2022-09-23 13:21:18.634 +01:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2022-09-23 13:21:18.636 +01:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2022-09-23 13:21:18.637 +01:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2022-09-23 13:21:18.640 +01:00 [DBG] Executing controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-23 13:21:18.642 +01:00 [DBG] Executed controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-23 13:21:18.643 +01:00 [DBG] Attempting to bind parameter 'model' of type 'APIBank.Models.MyRequestResponses.UserRevokeTokenRequest' ...
2022-09-23 13:21:18.644 +01:00 [DBG] Attempting to bind parameter 'model' of type 'APIBank.Models.MyRequestResponses.UserRevokeTokenRequest' using the name '' in request data ...
2022-09-23 13:21:18.645 +01:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2022-09-23 13:21:18.648 +01:00 [DBG] Connection id "0HMKTBN1OMFK4", Request id "0HMKTBN1OMFK4:0000000D": started reading request body.
2022-09-23 13:21:18.650 +01:00 [DBG] Connection id "0HMKTBN1OMFK4", Request id "0HMKTBN1OMFK4:0000000D": done reading request body.
2022-09-23 13:21:18.652 +01:00 [DBG] JSON input formatter succeeded, deserializing to type 'APIBank.Models.MyRequestResponses.UserRevokeTokenRequest'
2022-09-23 13:21:18.654 +01:00 [DBG] Done attempting to bind parameter 'model' of type 'APIBank.Models.MyRequestResponses.UserRevokeTokenRequest'.
2022-09-23 13:21:18.656 +01:00 [DBG] Done attempting to bind parameter 'model' of type 'APIBank.Models.MyRequestResponses.UserRevokeTokenRequest'.
2022-09-23 13:21:18.657 +01:00 [DBG] Attempting to validate the bound parameter 'model' of type 'APIBank.Models.MyRequestResponses.UserRevokeTokenRequest' ...
2022-09-23 13:21:18.658 +01:00 [DBG] Done attempting to validate the bound parameter 'model' of type 'APIBank.Models.MyRequestResponses.UserRevokeTokenRequest'.
2022-09-23 13:21:24.820 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 13:21:24.823 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (2ms).
2022-09-23 13:21:24.825 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 13:21:24.828 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 13:21:24.830 +01:00 [DBG] Executing DbCommand [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id, r.created, r.created_by_ip, r.expires, r.is_active, r.is_expired, r.is_revoked, r.reason_revoked, r.token, r.replaced_by_token, r.revoked, r.revoked_by_ip, r.user_id
FROM refresh_token AS r
WHERE r.id = @__p_0
LIMIT 1
2022-09-23 13:21:24.832 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id, r.created, r.created_by_ip, r.expires, r.is_active, r.is_expired, r.is_revoked, r.reason_revoked, r.token, r.replaced_by_token, r.revoked, r.revoked_by_ip, r.user_id
FROM refresh_token AS r
WHERE r.id = @__p_0
LIMIT 1
2022-09-23 13:21:24.848 +01:00 [DBG] Context 'PostgresContext' started tracking 'RefreshToken' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 13:21:24.850 +01:00 [DBG] A data reader was disposed.
2022-09-23 13:21:24.850 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 13:21:24.851 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 13:21:40.424 +01:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .SingleOrDefault(userQuery => userQuery.RefreshTokenCollection
        .Any(refTokenQuery => refTokenQuery.RefToken == __refToken_0))'
2022-09-23 13:21:40.434 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<User>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: User.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: User.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 1], [Property: User.Email (string) Required Index MaxLength(254), 2], [Property: User.FullName (string) Required MaxLength(100), 3], [Property: User.PasswordChangedAt (DateTime) Required ValueGenerated.OnAdd, 4], [Property: User.PasswordHash (string) Required MaxLength(200), 5], [Property: User.Username (string) Required Index MaxLength(50), 6] }
        SELECT TOP(2) u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
        FROM users AS u
        WHERE EXISTS (
            SELECT 1
            FROM refresh_token AS r
            WHERE ((u.id != NULL) && (u.id == r.user_id)) && (r.token == @__refToken_0))), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, User>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)
    .SingleOrDefault()'
2022-09-23 13:21:40.436 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 13:21:40.438 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2022-09-23 13:21:40.439 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 13:21:40.441 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 13:21:40.442 +01:00 [DBG] Executing DbCommand [Parameters=[@__refToken_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE EXISTS (
    SELECT 1
    FROM refresh_token AS r
    WHERE (u.id = r.user_id) AND (r.token = @__refToken_0))
LIMIT 2
2022-09-23 13:21:40.447 +01:00 [INF] Executed DbCommand (5ms) [Parameters=[@__refToken_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE EXISTS (
    SELECT 1
    FROM refresh_token AS r
    WHERE (u.id = r.user_id) AND (r.token = @__refToken_0))
LIMIT 2
2022-09-23 13:21:40.449 +01:00 [DBG] A data reader was disposed.
2022-09-23 13:21:40.449 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 13:21:40.450 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 13:21:48.702 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 13:21:48.710 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (7ms).
2022-09-23 13:21:48.712 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 13:21:48.713 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 13:21:48.714 +01:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.user_id AS "UserId", r.token AS "RefToken", r.expires AS "Expires", r.created AS "Created", r.created_by_ip AS "CreatedByIp", r.revoked AS "Revoked", r.revoked_by_ip AS "RevokedByIp", r.replaced_by_token AS "ReplacedByToken", r.reason_revoked AS "ReasonRevoked", r.is_expired AS "IsExpired", r.is_revoked AS "IsRevoked", r.is_active AS "IsActive"
FROM refresh_token AS r
WHERE r.user_id = @__id_0
2022-09-23 13:21:48.716 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.user_id AS "UserId", r.token AS "RefToken", r.expires AS "Expires", r.created AS "Created", r.created_by_ip AS "CreatedByIp", r.revoked AS "Revoked", r.revoked_by_ip AS "RevokedByIp", r.replaced_by_token AS "ReplacedByToken", r.reason_revoked AS "ReasonRevoked", r.is_expired AS "IsExpired", r.is_revoked AS "IsRevoked", r.is_active AS "IsActive"
FROM refresh_token AS r
WHERE r.user_id = @__id_0
2022-09-23 13:21:48.732 +01:00 [DBG] A data reader was disposed.
2022-09-23 13:21:48.733 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 13:21:48.734 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 13:22:09.703 +01:00 [DBG] An entity of type 'User' tracked by 'PostgresContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 13:47:46.677 +01:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2022-09-23 13:47:46.926 +01:00 [DBG] Hosting starting
2022-09-23 13:47:47.434 +01:00 [DBG] Using development certificate: CN=localhost (Thumbprint: 9CC642E9838495A6C3C202DECA6A8AD300396DD2)
2022-09-23 13:47:47.653 +01:00 [INF] Now listening on: https://localhost:7036
2022-09-23 13:47:47.676 +01:00 [INF] Now listening on: http://localhost:5036
2022-09-23 13:47:47.678 +01:00 [DBG] Loaded hosting startup assembly APIBank
2022-09-23 13:47:47.680 +01:00 [DBG] Loaded hosting startup assembly Microsoft.AspNetCore.Watch.BrowserRefresh
2022-09-23 13:47:47.681 +01:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.BrowserLink.Net
2022-09-23 13:47:47.683 +01:00 [INF] Application started. Press Ctrl+C to shut down.
2022-09-23 13:47:47.689 +01:00 [INF] Hosting environment: Development
2022-09-23 13:47:47.691 +01:00 [INF] Content root path: C:\Users\mguedesa\OneDrive - NTT DATA EMEAL\Documentos\GitHub\OpenBankAPI-NTT\APIBank\APIBank\
2022-09-23 13:47:47.693 +01:00 [DBG] Hosting started
2022-09-23 13:47:48.138 +01:00 [DBG] Connection id "0HMKTC78QLDHS" received FIN.
2022-09-23 13:47:48.138 +01:00 [DBG] Connection id "0HMKTC78QLDHT" received FIN.
2022-09-23 13:47:48.142 +01:00 [DBG] Connection id "0HMKTC78QLDHT" accepted.
2022-09-23 13:47:48.142 +01:00 [DBG] Connection id "0HMKTC78QLDHS" accepted.
2022-09-23 13:47:48.147 +01:00 [DBG] Connection id "0HMKTC78QLDHS" started.
2022-09-23 13:47:48.147 +01:00 [DBG] Connection id "0HMKTC78QLDHT" started.
2022-09-23 13:47:48.206 +01:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException:  Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveBlobAsync[TIOAdapter](TIOAdapter adapter)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](TIOAdapter adapter, Boolean receiveFirst, Byte[] reAuthenticationData, Boolean isApm)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2022-09-23 13:47:48.206 +01:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException:  Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveBlobAsync[TIOAdapter](TIOAdapter adapter)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](TIOAdapter adapter, Boolean receiveFirst, Byte[] reAuthenticationData, Boolean isApm)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2022-09-23 13:47:48.317 +01:00 [DBG] Connection id "0HMKTC78QLDHT" stopped.
2022-09-23 13:47:48.317 +01:00 [DBG] Connection id "0HMKTC78QLDHS" stopped.
2022-09-23 13:47:48.333 +01:00 [DBG] Connection id "0HMKTC78QLDHT" sending FIN because: "The Socket transport's send loop completed gracefully."
2022-09-23 13:47:48.333 +01:00 [DBG] Connection id "0HMKTC78QLDHS" sending FIN because: "The Socket transport's send loop completed gracefully."
2022-09-23 13:47:48.892 +01:00 [DBG] Connection id "0HMKTC78QLDHU" accepted.
2022-09-23 13:47:48.962 +01:00 [DBG] Connection id "0HMKTC78QLDHU" started.
2022-09-23 13:47:49.117 +01:00 [DBG] Connection 0HMKTC78QLDHU established using the following protocol: "Tls12"
2022-09-23 13:47:49.365 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/swagger/index.html - -
2022-09-23 13:47:49.491 +01:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2022-09-23 13:47:49.580 +01:00 [DBG] No candidates found for the request path '/swagger/index.html'
2022-09-23 13:47:49.587 +01:00 [DBG] Request did not match any endpoints
2022-09-23 13:47:50.007 +01:00 [DBG] Response markup is scheduled to include browser refresh script injection.
2022-09-23 13:47:50.617 +01:00 [DBG] Response markup was updated to include browser refresh script injection.
2022-09-23 13:47:50.660 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/_vs/browserLink - -
2022-09-23 13:47:50.660 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/_framework/aspnetcore-browser-refresh.js - -
2022-09-23 13:47:50.723 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/swagger/index.html - - - 200 - text/html;charset=utf-8 1367.9039ms
2022-09-23 13:47:50.778 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/_framework/aspnetcore-browser-refresh.js - - - 200 11984 application/javascript;+charset=utf-8 117.8630ms
2022-09-23 13:47:50.889 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/_vs/browserLink - - - 200 - text/javascript;+charset=UTF-8 228.5834ms
2022-09-23 13:47:50.987 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/swagger/v1/swagger.json - -
2022-09-23 13:47:51.005 +01:00 [DBG] No candidates found for the request path '/swagger/v1/swagger.json'
2022-09-23 13:47:51.007 +01:00 [DBG] Request did not match any endpoints
2022-09-23 13:47:51.369 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/swagger/v1/swagger.json - - - 200 - application/json;charset=utf-8 382.1042ms
2022-09-23 13:47:59.163 +01:00 [DBG] Connection id "0HMKTC78QLDHU" received FIN.
2022-09-23 13:47:59.172 +01:00 [DBG] Connection id "0HMKTC78QLDHU" is closed. The last processed stream ID was 7.
2022-09-23 13:47:59.175 +01:00 [DBG] Connection id "0HMKTC78QLDHU" sending FIN because: "The client closed the connection."
2022-09-23 13:47:59.197 +01:00 [DBG] Connection id "0HMKTC78QLDHU" stopped.
2022-09-23 13:48:05.992 +01:00 [DBG] Connection id "0HMKTC78QLDHV" accepted.
2022-09-23 13:48:06.009 +01:00 [DBG] Connection id "0HMKTC78QLDHV" started.
2022-09-23 13:48:06.042 +01:00 [DBG] Connection 0HMKTC78QLDHV established using the following protocol: "Tls12"
2022-09-23 13:48:06.045 +01:00 [INF] Request starting HTTP/2 POST https://localhost:7036/api/Users/Login application/json 58
2022-09-23 13:48:06.064 +01:00 [DBG] 1 candidate(s) found for the request path '/api/Users/Login'
2022-09-23 13:48:06.070 +01:00 [DBG] Endpoint 'APIBank.Controllers.UsersController.Login (APIBank)' with route pattern 'api/Users/Login' is valid for the request path '/api/Users/Login'
2022-09-23 13:48:06.076 +01:00 [DBG] Request matched endpoint 'APIBank.Controllers.UsersController.Login (APIBank)'
2022-09-23 13:48:06.079 +01:00 [DBG] Static files was skipped as the request already matched an endpoint.
2022-09-23 13:48:06.927 +01:00 [INF] Executing endpoint 'APIBank.Controllers.UsersController.Login (APIBank)'
2022-09-23 13:48:06.969 +01:00 [INF] Route matched with {action = "Login", controller = "Users"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult Login(APIBank.Models.Requests.UserLoginRequest) on controller APIBank.Controllers.UsersController (APIBank).
2022-09-23 13:48:06.976 +01:00 [DBG] Execution plan of authorization filters (in the following order): ["APIBank.Authorization.AuthorizeAttribute"]
2022-09-23 13:48:06.978 +01:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2022-09-23 13:48:06.980 +01:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2022-09-23 13:48:06.981 +01:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2022-09-23 13:48:06.984 +01:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2022-09-23 13:48:06.990 +01:00 [DBG] Executing controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-23 13:48:06.993 +01:00 [DBG] Executed controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-23 13:48:07.027 +01:00 [DBG] Attempting to bind parameter 'model' of type 'APIBank.Models.Requests.UserLoginRequest' ...
2022-09-23 13:48:07.039 +01:00 [DBG] Attempting to bind parameter 'model' of type 'APIBank.Models.Requests.UserLoginRequest' using the name '' in request data ...
2022-09-23 13:48:07.042 +01:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2022-09-23 13:48:07.060 +01:00 [DBG] Connection id "0HMKTC78QLDHV", Request id "0HMKTC78QLDHV:00000001": started reading request body.
2022-09-23 13:48:07.062 +01:00 [DBG] Connection id "0HMKTC78QLDHV", Request id "0HMKTC78QLDHV:00000001": done reading request body.
2022-09-23 13:48:07.075 +01:00 [DBG] JSON input formatter succeeded, deserializing to type 'APIBank.Models.Requests.UserLoginRequest'
2022-09-23 13:48:07.077 +01:00 [DBG] Done attempting to bind parameter 'model' of type 'APIBank.Models.Requests.UserLoginRequest'.
2022-09-23 13:48:07.080 +01:00 [DBG] Done attempting to bind parameter 'model' of type 'APIBank.Models.Requests.UserLoginRequest'.
2022-09-23 13:48:07.084 +01:00 [DBG] Attempting to validate the bound parameter 'model' of type 'APIBank.Models.Requests.UserLoginRequest' ...
2022-09-23 13:48:07.101 +01:00 [DBG] Done attempting to validate the bound parameter 'model' of type 'APIBank.Models.Requests.UserLoginRequest'.
2022-09-23 13:48:07.292 +01:00 [DBG] An additional 'IServiceProvider' was created for internal use by Entity Framework. An existing service provider was not used due to the following configuration changes: configuration changed for 'Core:ConfigureWarnings', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:UseAdminDatabase', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:SetPostgresVersion', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:UseRedshift', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:ReverseNullOrdering', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:RemoteCertificateValidationCallback', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:ProvideClientCertificatesCallback', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:ProvidePasswordCallback'.
2022-09-23 13:48:09.755 +01:00 [INF] Entity Framework Core 6.0.9 initialized 'PostgresContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:6.0.7+5b98e4b74de93b590b44aef8dd7967c03acc433c' with options: None
2022-09-23 13:48:09.887 +01:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .SingleOrDefault(x => x.Username == __model_Username_0)'
2022-09-23 13:48:10.661 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<User>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: User.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: User.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 1], [Property: User.Email (string) Required Index MaxLength(254), 2], [Property: User.FullName (string) Required MaxLength(100), 3], [Property: User.PasswordChangedAt (DateTime) Required ValueGenerated.OnAdd, 4], [Property: User.PasswordHash (string) Required MaxLength(200), 5], [Property: User.Username (string) Required Index MaxLength(50), 6] }
        SELECT TOP(2) u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
        FROM users AS u
        WHERE u.username == @__model_Username_0), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, User>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)
    .SingleOrDefault()'
2022-09-23 13:48:10.790 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 13:48:11.014 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (231ms).
2022-09-23 13:48:11.040 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 13:48:11.667 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 13:48:11.708 +01:00 [DBG] Executing DbCommand [Parameters=[@__model_Username_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.username = @__model_Username_0
LIMIT 2
2022-09-23 13:48:11.901 +01:00 [INF] Executed DbCommand (202ms) [Parameters=[@__model_Username_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.username = @__model_Username_0
LIMIT 2
2022-09-23 13:48:12.024 +01:00 [DBG] Context 'PostgresContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 13:48:12.132 +01:00 [DBG] A data reader was disposed.
2022-09-23 13:48:12.144 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 13:48:12.171 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 13:48:23.832 +01:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .Any(user => user.RefreshTokenCollection
        .Any(reftoken => reftoken.RefToken == __token_0))'
2022-09-23 13:48:24.066 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<bool>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            EmptyProjectionMember -> 0
        SELECT EXISTS (
            SELECT 1
            FROM users AS u
            WHERE EXISTS (
                SELECT 1
                FROM refresh_token AS r
                WHERE ((u.id != NULL) && (u.id == r.user_id)) && (r.token == @__token_0)))), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, bool>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)
    .Single()'
2022-09-23 13:48:24.095 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 13:48:24.098 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (2ms).
2022-09-23 13:48:24.100 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 13:48:24.104 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 13:48:24.107 +01:00 [DBG] Executing DbCommand [Parameters=[@__token_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM users AS u
    WHERE EXISTS (
        SELECT 1
        FROM refresh_token AS r
        WHERE (u.id = r.user_id) AND (r.token = @__token_0)))
2022-09-23 13:48:24.116 +01:00 [INF] Executed DbCommand (9ms) [Parameters=[@__token_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM users AS u
    WHERE EXISTS (
        SELECT 1
        FROM refresh_token AS r
        WHERE (u.id = r.user_id) AND (r.token = @__token_0)))
2022-09-23 13:48:24.127 +01:00 [DBG] A data reader was disposed.
2022-09-23 13:48:24.130 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 13:48:24.131 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 13:48:24.144 +01:00 [DBG] SaveChanges starting for 'PostgresContext'.
2022-09-23 13:48:24.149 +01:00 [DBG] DetectChanges starting for 'PostgresContext'.
2022-09-23 13:48:24.229 +01:00 [DBG] 1 entities were added and 0 entities were removed from navigation 'User.RefreshTokenCollection'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 13:48:24.328 +01:00 [DBG] 'PostgresContext' generated a temporary value for the property 'Id.RefreshToken'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 13:48:24.449 +01:00 [DBG] Context 'PostgresContext' started tracking 'RefreshToken' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 13:48:24.462 +01:00 [DBG] DetectChanges completed for 'PostgresContext'.
2022-09-23 13:48:24.482 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 13:48:24.484 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 13:48:24.496 +01:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2022-09-23 13:48:24.517 +01:00 [DBG] Began transaction with isolation level 'ReadCommitted'.
2022-09-23 13:48:24.629 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 13:48:24.630 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2022-09-23 13:48:24.633 +01:00 [DBG] Executing DbCommand [Parameters=[@p0='?' (DbType = DateTime), @p1='?', @p2='?' (DbType = DateTime), @p3='?' (DbType = Boolean), @p4='?' (DbType = Boolean), @p5='?' (DbType = Boolean), @p6='?', @p7='?', @p8='?', @p9='?' (DbType = DateTime), @p10='?', @p11='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO refresh_token (created, created_by_ip, expires, is_active, is_expired, is_revoked, reason_revoked, token, replaced_by_token, revoked, revoked_by_ip, user_id)
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11)
RETURNING id;
2022-09-23 13:48:24.670 +01:00 [INF] Executed DbCommand (36ms) [Parameters=[@p0='?' (DbType = DateTime), @p1='?', @p2='?' (DbType = DateTime), @p3='?' (DbType = Boolean), @p4='?' (DbType = Boolean), @p5='?' (DbType = Boolean), @p6='?', @p7='?', @p8='?', @p9='?' (DbType = DateTime), @p10='?', @p11='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO refresh_token (created, created_by_ip, expires, is_active, is_expired, is_revoked, reason_revoked, token, replaced_by_token, revoked, revoked_by_ip, user_id)
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11)
RETURNING id;
2022-09-23 13:48:24.709 +01:00 [DBG] The foreign key property 'RefreshToken.Id' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2022-09-23 13:48:24.725 +01:00 [DBG] A data reader was disposed.
2022-09-23 13:48:24.730 +01:00 [DBG] Committing transaction.
2022-09-23 13:48:24.744 +01:00 [DBG] Committed transaction.
2022-09-23 13:48:24.749 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 13:48:24.751 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 13:48:24.758 +01:00 [DBG] Disposing transaction.
2022-09-23 13:48:24.776 +01:00 [DBG] An entity of type 'RefreshToken' tracked by 'PostgresContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 13:48:24.780 +01:00 [DBG] SaveChanges completed for 'PostgresContext' with 1 entities written to the database.
2022-09-23 13:48:29.069 +01:00 [DBG] Compiling query expression: 
'DbSet<RefreshToken>()
    .Where(rt => rt.UserId == __id_0)
    .AsNoTracking()
    .Select(rt => new RefreshToken{ 
        Id = rt.Id, 
        UserId = rt.UserId, 
        RefToken = rt.RefToken, 
        Expires = rt.Expires, 
        Created = rt.Created, 
        CreatedByIp = rt.CreatedByIp, 
        Revoked = rt.Revoked, 
        RevokedByIp = rt.RevokedByIp, 
        ReplacedByToken = rt.ReplacedByToken, 
        ReasonRevoked = rt.ReasonRevoked, 
        IsExpired = rt.IsExpired, 
        IsRevoked = rt.IsRevoked, 
        IsActive = rt.IsActive 
    }
    )'
2022-09-23 13:48:29.137 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<RefreshToken>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            Id -> 0
            UserId -> 1
            RefToken -> 2
            Expires -> 3
            Created -> 4
            CreatedByIp -> 5
            Revoked -> 6
            RevokedByIp -> 7
            ReplacedByToken -> 8
            ReasonRevoked -> 9
            IsExpired -> 10
            IsRevoked -> 11
            IsActive -> 12
        SELECT r.id AS Id, r.user_id AS UserId, r.token AS RefToken, r.expires AS Expires, r.created AS Created, r.created_by_ip AS CreatedByIp, r.revoked AS Revoked, r.revoked_by_ip AS RevokedByIp, r.replaced_by_token AS ReplacedByToken, r.reason_revoked AS ReasonRevoked, r.is_expired AS IsExpired, r.is_revoked AS IsRevoked, r.is_active AS IsActive
        FROM refresh_token AS r
        WHERE r.user_id == @__id_0), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, RefreshToken>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)'
2022-09-23 13:48:29.143 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 13:48:29.144 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2022-09-23 13:48:29.146 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 13:48:29.147 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 13:48:29.152 +01:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.user_id AS "UserId", r.token AS "RefToken", r.expires AS "Expires", r.created AS "Created", r.created_by_ip AS "CreatedByIp", r.revoked AS "Revoked", r.revoked_by_ip AS "RevokedByIp", r.replaced_by_token AS "ReplacedByToken", r.reason_revoked AS "ReasonRevoked", r.is_expired AS "IsExpired", r.is_revoked AS "IsRevoked", r.is_active AS "IsActive"
FROM refresh_token AS r
WHERE r.user_id = @__id_0
2022-09-23 13:48:29.160 +01:00 [INF] Executed DbCommand (7ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.user_id AS "UserId", r.token AS "RefToken", r.expires AS "Expires", r.created AS "Created", r.created_by_ip AS "CreatedByIp", r.revoked AS "Revoked", r.revoked_by_ip AS "RevokedByIp", r.replaced_by_token AS "ReplacedByToken", r.reason_revoked AS "ReasonRevoked", r.is_expired AS "IsExpired", r.is_revoked AS "IsRevoked", r.is_active AS "IsActive"
FROM refresh_token AS r
WHERE r.user_id = @__id_0
2022-09-23 13:48:29.166 +01:00 [DBG] A data reader was disposed.
2022-09-23 13:48:29.170 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 13:48:29.172 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 13:48:29.177 +01:00 [DBG] An entity of type 'User' tracked by 'PostgresContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 13:48:29.185 +01:00 [DBG] An entity of type 'RefreshToken' tracked by 'PostgresContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 13:48:29.187 +01:00 [DBG] SaveChanges starting for 'PostgresContext'.
2022-09-23 13:48:29.188 +01:00 [DBG] DetectChanges starting for 'PostgresContext'.
2022-09-23 13:48:29.191 +01:00 [DBG] DetectChanges completed for 'PostgresContext'.
2022-09-23 13:48:29.194 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 13:48:29.197 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 13:48:29.201 +01:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2022-09-23 13:48:29.203 +01:00 [DBG] Began transaction with isolation level 'ReadCommitted'.
2022-09-23 13:48:29.245 +01:00 [DBG] Executing 2 update commands as a batch.
2022-09-23 13:48:29.255 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 13:48:29.256 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2022-09-23 13:48:29.259 +01:00 [DBG] Executing DbCommand [Parameters=[@p12='?' (DbType = Int32), @p0='?' (DbType = DateTime), @p1='?', @p2='?' (DbType = DateTime), @p3='?' (DbType = Boolean), @p4='?' (DbType = Boolean), @p5='?' (DbType = Boolean), @p6='?', @p7='?', @p8='?', @p9='?' (DbType = DateTime), @p10='?', @p11='?' (DbType = Int32), @p19='?' (DbType = Int32), @p13='?' (DbType = DateTime), @p14='?', @p15='?', @p16='?' (DbType = DateTime), @p17='?', @p18='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE refresh_token SET created = @p0, created_by_ip = @p1, expires = @p2, is_active = @p3, is_expired = @p4, is_revoked = @p5, reason_revoked = @p6, token = @p7, replaced_by_token = @p8, revoked = @p9, revoked_by_ip = @p10, user_id = @p11
WHERE id = @p12;
UPDATE users SET created_at = @p13, email = @p14, full_name = @p15, password_changed_at = @p16, password_hash = @p17, username = @p18
WHERE id = @p19;
2022-09-23 13:48:29.273 +01:00 [INF] Executed DbCommand (12ms) [Parameters=[@p12='?' (DbType = Int32), @p0='?' (DbType = DateTime), @p1='?', @p2='?' (DbType = DateTime), @p3='?' (DbType = Boolean), @p4='?' (DbType = Boolean), @p5='?' (DbType = Boolean), @p6='?', @p7='?', @p8='?', @p9='?' (DbType = DateTime), @p10='?', @p11='?' (DbType = Int32), @p19='?' (DbType = Int32), @p13='?' (DbType = DateTime), @p14='?', @p15='?', @p16='?' (DbType = DateTime), @p17='?', @p18='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE refresh_token SET created = @p0, created_by_ip = @p1, expires = @p2, is_active = @p3, is_expired = @p4, is_revoked = @p5, reason_revoked = @p6, token = @p7, replaced_by_token = @p8, revoked = @p9, revoked_by_ip = @p10, user_id = @p11
WHERE id = @p12;
UPDATE users SET created_at = @p13, email = @p14, full_name = @p15, password_changed_at = @p16, password_hash = @p17, username = @p18
WHERE id = @p19;
2022-09-23 13:48:29.276 +01:00 [DBG] A data reader was disposed.
2022-09-23 13:48:29.278 +01:00 [DBG] Committing transaction.
2022-09-23 13:48:29.279 +01:00 [DBG] Committed transaction.
2022-09-23 13:48:29.280 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 13:48:29.283 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 13:48:29.284 +01:00 [DBG] Disposing transaction.
2022-09-23 13:48:29.286 +01:00 [DBG] An entity of type 'User' tracked by 'PostgresContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 13:48:29.290 +01:00 [DBG] An entity of type 'RefreshToken' tracked by 'PostgresContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 13:48:29.291 +01:00 [DBG] SaveChanges completed for 'PostgresContext' with 2 entities written to the database.
2022-09-23 13:48:29.307 +01:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2022-09-23 13:48:29.324 +01:00 [DBG] Attempting to select an output formatter based on Accept header '["text/plain"]'.
2022-09-23 13:48:29.327 +01:00 [DBG] Could not find an output formatter based on content negotiation. Accepted types were (["text/plain"])
2022-09-23 13:48:29.329 +01:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2022-09-23 13:48:29.332 +01:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2022-09-23 13:48:29.337 +01:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2022-09-23 13:48:29.339 +01:00 [INF] Executing OkObjectResult, writing value of type 'APIBank.Models.MyRequestResponses.LoginResponse'.
2022-09-23 13:48:29.389 +01:00 [INF] Executed action APIBank.Controllers.UsersController.Login (APIBank) in 22387.3769ms
2022-09-23 13:48:29.392 +01:00 [INF] Executed endpoint 'APIBank.Controllers.UsersController.Login (APIBank)'
2022-09-23 13:48:29.406 +01:00 [DBG] 'PostgresContext' disposed.
2022-09-23 13:48:29.425 +01:00 [INF] Request finished HTTP/2 POST https://localhost:7036/api/Users/Login application/json 58 - 200 - application/json;+charset=utf-8 23377.9993ms
2022-09-23 13:48:39.245 +01:00 [DBG] Connection id "0HMKTC78QLDHV" received FIN.
2022-09-23 13:48:39.248 +01:00 [DBG] Connection id "0HMKTC78QLDHV" is closed. The last processed stream ID was 1.
2022-09-23 13:48:39.249 +01:00 [DBG] Connection id "0HMKTC78QLDHV" sending FIN because: "The client closed the connection."
2022-09-23 13:48:39.254 +01:00 [DBG] Connection id "0HMKTC78QLDHV" stopped.
2022-09-23 13:49:07.882 +01:00 [DBG] Connection id "0HMKTC78QLDI0" accepted.
2022-09-23 13:49:07.884 +01:00 [DBG] Connection id "0HMKTC78QLDI0" started.
2022-09-23 13:49:07.895 +01:00 [DBG] Connection 0HMKTC78QLDI0 established using the following protocol: "Tls12"
2022-09-23 13:49:07.898 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/api/Accounts/GetAll - -
2022-09-23 13:49:07.915 +01:00 [DBG] 1 candidate(s) found for the request path '/api/Accounts/GetAll'
2022-09-23 13:49:07.921 +01:00 [DBG] Endpoint 'APIBank.Controllers.AccountsController.GetAllFromUser (APIBank)' with route pattern 'api/Accounts/GetAll' is valid for the request path '/api/Accounts/GetAll'
2022-09-23 13:49:07.924 +01:00 [DBG] Request matched endpoint 'APIBank.Controllers.AccountsController.GetAllFromUser (APIBank)'
2022-09-23 13:49:07.926 +01:00 [DBG] Static files was skipped as the request already matched an endpoint.
2022-09-23 13:49:08.089 +01:00 [INF] Entity Framework Core 6.0.9 initialized 'PostgresContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:6.0.7+5b98e4b74de93b590b44aef8dd7967c03acc433c' with options: None
2022-09-23 13:49:08.108 +01:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .FirstOrDefault(e => EF.Property<int>(e, "Id") == __p_0)'
2022-09-23 13:49:08.127 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<User>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: User.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: User.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 1], [Property: User.Email (string) Required Index MaxLength(254), 2], [Property: User.FullName (string) Required MaxLength(100), 3], [Property: User.PasswordChangedAt (DateTime) Required ValueGenerated.OnAdd, 4], [Property: User.PasswordHash (string) Required MaxLength(200), 5], [Property: User.Username (string) Required Index MaxLength(50), 6] }
        SELECT TOP(1) u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
        FROM users AS u
        WHERE u.id == @__p_0), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, User>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)
    .SingleOrDefault()'
2022-09-23 13:49:08.138 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 13:49:08.139 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2022-09-23 13:49:08.141 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 13:49:08.143 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 13:49:08.144 +01:00 [DBG] Executing DbCommand [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.id = @__p_0
LIMIT 1
2022-09-23 13:49:08.148 +01:00 [INF] Executed DbCommand (3ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.id = @__p_0
LIMIT 1
2022-09-23 13:49:08.168 +01:00 [DBG] Context 'PostgresContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 13:49:08.172 +01:00 [DBG] A data reader was disposed.
2022-09-23 13:49:08.174 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 13:49:08.175 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 13:49:08.177 +01:00 [INF] Executing endpoint 'APIBank.Controllers.AccountsController.GetAllFromUser (APIBank)'
2022-09-23 13:49:08.181 +01:00 [INF] Route matched with {action = "GetAllFromUser", controller = "Accounts"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult GetAllFromUser() on controller APIBank.Controllers.AccountsController (APIBank).
2022-09-23 13:49:08.184 +01:00 [DBG] Execution plan of authorization filters (in the following order): ["APIBank.Authorization.AuthorizeAttribute"]
2022-09-23 13:49:08.186 +01:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2022-09-23 13:49:08.189 +01:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2022-09-23 13:49:08.191 +01:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2022-09-23 13:49:08.192 +01:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2022-09-23 13:49:08.196 +01:00 [DBG] Executing controller factory for controller APIBank.Controllers.AccountsController (APIBank)
2022-09-23 13:49:08.198 +01:00 [DBG] Executed controller factory for controller APIBank.Controllers.AccountsController (APIBank)
2022-09-23 13:49:14.887 +01:00 [DBG] Compiling query expression: 
'DbSet<RefreshToken>()
    .FirstOrDefault(e => EF.Property<int>(e, "Id") == __p_0)'
2022-09-23 13:49:14.899 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<RefreshToken>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: RefreshToken.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: RefreshToken.Created (DateTime) Required, 1], [Property: RefreshToken.CreatedByIp (string) Required MaxLength(200), 2], [Property: RefreshToken.Expires (DateTime) Required, 3], [Property: RefreshToken.IsActive (no field, bool) Required, 4], [Property: RefreshToken.IsExpired (no field, bool) Required, 5], [Property: RefreshToken.IsRevoked (no field, bool) Required, 6], [Property: RefreshToken.ReasonRevoked (string) MaxLength(200), 7], [Property: RefreshToken.RefToken (string) Required MaxLength(254), 8], [Property: RefreshToken.ReplacedByToken (string) MaxLength(200), 9], [Property: RefreshToken.Revoked (DateTime?), 10], [Property: RefreshToken.RevokedByIp (string) MaxLength(200), 11], [Property: RefreshToken.UserId (int) Required FK Index, 12] }
        SELECT TOP(1) r.id, r.created, r.created_by_ip, r.expires, r.is_active, r.is_expired, r.is_revoked, r.reason_revoked, r.token, r.replaced_by_token, r.revoked, r.revoked_by_ip, r.user_id
        FROM refresh_token AS r
        WHERE r.id == @__p_0), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, RefreshToken>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)
    .SingleOrDefault()'
2022-09-23 13:49:14.903 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 13:49:14.904 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2022-09-23 13:49:14.905 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 13:49:14.906 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 13:49:14.907 +01:00 [DBG] Executing DbCommand [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id, r.created, r.created_by_ip, r.expires, r.is_active, r.is_expired, r.is_revoked, r.reason_revoked, r.token, r.replaced_by_token, r.revoked, r.revoked_by_ip, r.user_id
FROM refresh_token AS r
WHERE r.id = @__p_0
LIMIT 1
2022-09-23 13:49:14.909 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id, r.created, r.created_by_ip, r.expires, r.is_active, r.is_expired, r.is_revoked, r.reason_revoked, r.token, r.replaced_by_token, r.revoked, r.revoked_by_ip, r.user_id
FROM refresh_token AS r
WHERE r.id = @__p_0
LIMIT 1
2022-09-23 13:49:14.914 +01:00 [DBG] Context 'PostgresContext' started tracking 'RefreshToken' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 13:49:14.919 +01:00 [DBG] A data reader was disposed.
2022-09-23 13:49:14.920 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 13:49:14.921 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 13:49:14.925 +01:00 [DBG] Compiling query expression: 
'DbSet<Account>()
    .Where(u => u.UserId == __userId_0)
    .Select(u => new AccountRequestResponse{ 
        Balance = u.Balance, 
        CreatedAt = u.CreatedAt, 
        Currency = u.Currency, 
        Id = u.Id 
    }
    )'
2022-09-23 13:49:14.935 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<AccountRequestResponse>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            Balance -> 0
            CreatedAt -> 1
            Currency -> 2
            Id -> 3
        SELECT a.balance AS Balance, a.created_at AS CreatedAt, a.currency AS Currency, a.id AS Id
        FROM accounts AS a
        WHERE a.user_id == @__userId_0), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, AccountRequestResponse>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)'
2022-09-23 13:49:14.940 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 13:49:14.942 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2022-09-23 13:49:14.945 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 13:49:14.947 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 13:49:14.948 +01:00 [DBG] Executing DbCommand [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a.balance AS "Balance", a.created_at AS "CreatedAt", a.currency AS "Currency", a.id AS "Id"
FROM accounts AS a
WHERE a.user_id = @__userId_0
2022-09-23 13:49:14.954 +01:00 [INF] Executed DbCommand (6ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a.balance AS "Balance", a.created_at AS "CreatedAt", a.currency AS "Currency", a.id AS "Id"
FROM accounts AS a
WHERE a.user_id = @__userId_0
2022-09-23 13:49:14.971 +01:00 [DBG] A data reader was disposed.
2022-09-23 13:49:14.972 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 13:49:14.974 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 13:49:14.975 +01:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2022-09-23 13:49:14.978 +01:00 [DBG] Attempting to select an output formatter based on Accept header '["text/plain"]'.
2022-09-23 13:49:14.983 +01:00 [DBG] Could not find an output formatter based on content negotiation. Accepted types were (["text/plain"])
2022-09-23 13:49:14.985 +01:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2022-09-23 13:49:14.987 +01:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2022-09-23 13:49:14.988 +01:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2022-09-23 13:49:14.989 +01:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[APIBank.Models.Responses.AccountRequestResponse, APIBank, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2022-09-23 13:49:15.005 +01:00 [INF] Executed action APIBank.Controllers.AccountsController.GetAllFromUser (APIBank) in 6808.9875ms
2022-09-23 13:49:15.007 +01:00 [INF] Executed endpoint 'APIBank.Controllers.AccountsController.GetAllFromUser (APIBank)'
2022-09-23 13:49:15.009 +01:00 [DBG] 'PostgresContext' disposed.
2022-09-23 13:49:15.016 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/api/Accounts/GetAll - - - 200 - application/json;+charset=utf-8 7117.8671ms
2022-09-23 13:49:19.278 +01:00 [DBG] Connection id "0HMKTC78QLDI0" received FIN.
2022-09-23 13:49:19.280 +01:00 [DBG] Connection id "0HMKTC78QLDI0" is closed. The last processed stream ID was 1.
2022-09-23 13:49:19.281 +01:00 [DBG] Connection id "0HMKTC78QLDI0" sending FIN because: "The client closed the connection."
2022-09-23 13:49:19.295 +01:00 [DBG] Connection id "0HMKTC78QLDI0" stopped.
2022-09-23 13:50:03.152 +01:00 [DBG] Connection id "0HMKTC78QLDI1" accepted.
2022-09-23 13:50:03.155 +01:00 [DBG] Connection id "0HMKTC78QLDI1" started.
2022-09-23 13:50:03.170 +01:00 [DBG] Connection 0HMKTC78QLDI1 established using the following protocol: "Tls12"
2022-09-23 13:50:03.178 +01:00 [INF] Request starting HTTP/2 POST https://localhost:7036/api/Users/refreshToken - 0
2022-09-23 13:50:03.196 +01:00 [DBG] 1 candidate(s) found for the request path '/api/Users/refreshToken'
2022-09-23 13:50:03.197 +01:00 [DBG] Endpoint 'APIBank.Controllers.UsersController.RefreshToken (APIBank)' with route pattern 'api/Users/refreshToken' is valid for the request path '/api/Users/refreshToken'
2022-09-23 13:50:03.199 +01:00 [DBG] Request matched endpoint 'APIBank.Controllers.UsersController.RefreshToken (APIBank)'
2022-09-23 13:50:03.199 +01:00 [DBG] Static files was skipped as the request already matched an endpoint.
2022-09-23 13:50:03.258 +01:00 [INF] Entity Framework Core 6.0.9 initialized 'PostgresContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:6.0.7+5b98e4b74de93b590b44aef8dd7967c03acc433c' with options: None
2022-09-23 13:50:03.266 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 13:50:03.267 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2022-09-23 13:50:03.268 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 13:50:03.269 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 13:50:03.270 +01:00 [DBG] Executing DbCommand [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.id = @__p_0
LIMIT 1
2022-09-23 13:50:03.273 +01:00 [INF] Executed DbCommand (3ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.id = @__p_0
LIMIT 1
2022-09-23 13:50:03.276 +01:00 [DBG] Context 'PostgresContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 13:50:03.278 +01:00 [DBG] A data reader was disposed.
2022-09-23 13:50:03.278 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 13:50:03.280 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 13:50:03.282 +01:00 [INF] Executing endpoint 'APIBank.Controllers.UsersController.RefreshToken (APIBank)'
2022-09-23 13:50:03.284 +01:00 [INF] Route matched with {action = "RefreshToken", controller = "Users"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult RefreshToken() on controller APIBank.Controllers.UsersController (APIBank).
2022-09-23 13:50:03.285 +01:00 [DBG] Execution plan of authorization filters (in the following order): ["APIBank.Authorization.AuthorizeAttribute"]
2022-09-23 13:50:03.287 +01:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2022-09-23 13:50:03.290 +01:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2022-09-23 13:50:03.293 +01:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2022-09-23 13:50:03.300 +01:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2022-09-23 13:50:03.302 +01:00 [DBG] Executing controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-23 13:50:03.305 +01:00 [DBG] Executed controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-23 13:50:03.317 +01:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .SingleOrDefault(userQuery => userQuery.RefreshTokenCollection
        .Any(refTokenQuery => refTokenQuery.RefToken == __refToken_0))'
2022-09-23 13:50:03.331 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<User>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: User.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: User.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 1], [Property: User.Email (string) Required Index MaxLength(254), 2], [Property: User.FullName (string) Required MaxLength(100), 3], [Property: User.PasswordChangedAt (DateTime) Required ValueGenerated.OnAdd, 4], [Property: User.PasswordHash (string) Required MaxLength(200), 5], [Property: User.Username (string) Required Index MaxLength(50), 6] }
        SELECT TOP(2) u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
        FROM users AS u
        WHERE EXISTS (
            SELECT 1
            FROM refresh_token AS r
            WHERE ((u.id != NULL) && (u.id == r.user_id)) && (r.token == @__refToken_0))), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, User>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)
    .SingleOrDefault()'
2022-09-23 13:50:03.333 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 13:50:03.333 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2022-09-23 13:50:03.334 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 13:50:03.335 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 13:50:03.336 +01:00 [DBG] Executing DbCommand [Parameters=[@__refToken_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE EXISTS (
    SELECT 1
    FROM refresh_token AS r
    WHERE (u.id = r.user_id) AND (r.token = @__refToken_0))
LIMIT 2
2022-09-23 13:50:03.340 +01:00 [INF] Executed DbCommand (4ms) [Parameters=[@__refToken_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE EXISTS (
    SELECT 1
    FROM refresh_token AS r
    WHERE (u.id = r.user_id) AND (r.token = @__refToken_0))
LIMIT 2
2022-09-23 13:50:03.344 +01:00 [DBG] A data reader was disposed.
2022-09-23 13:50:03.344 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 13:50:03.345 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 13:50:03.349 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 13:50:03.350 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2022-09-23 13:50:03.351 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 13:50:03.352 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 13:50:03.352 +01:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.user_id AS "UserId", r.token AS "RefToken", r.expires AS "Expires", r.created AS "Created", r.created_by_ip AS "CreatedByIp", r.revoked AS "Revoked", r.revoked_by_ip AS "RevokedByIp", r.replaced_by_token AS "ReplacedByToken", r.reason_revoked AS "ReasonRevoked", r.is_expired AS "IsExpired", r.is_revoked AS "IsRevoked", r.is_active AS "IsActive"
FROM refresh_token AS r
WHERE r.user_id = @__id_0
2022-09-23 13:50:03.355 +01:00 [INF] Executed DbCommand (3ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.user_id AS "UserId", r.token AS "RefToken", r.expires AS "Expires", r.created AS "Created", r.created_by_ip AS "CreatedByIp", r.revoked AS "Revoked", r.revoked_by_ip AS "RevokedByIp", r.replaced_by_token AS "ReplacedByToken", r.reason_revoked AS "ReasonRevoked", r.is_expired AS "IsExpired", r.is_revoked AS "IsRevoked", r.is_active AS "IsActive"
FROM refresh_token AS r
WHERE r.user_id = @__id_0
2022-09-23 13:50:03.360 +01:00 [DBG] A data reader was disposed.
2022-09-23 13:50:03.361 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 13:50:03.361 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 13:50:03.363 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 13:50:03.364 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2022-09-23 13:50:03.365 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 13:50:03.366 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 13:50:03.367 +01:00 [DBG] Executing DbCommand [Parameters=[@__token_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM users AS u
    WHERE EXISTS (
        SELECT 1
        FROM refresh_token AS r
        WHERE (u.id = r.user_id) AND (r.token = @__token_0)))
2022-09-23 13:50:03.369 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[@__token_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM users AS u
    WHERE EXISTS (
        SELECT 1
        FROM refresh_token AS r
        WHERE (u.id = r.user_id) AND (r.token = @__token_0)))
2022-09-23 13:50:03.371 +01:00 [DBG] A data reader was disposed.
2022-09-23 13:50:03.374 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 13:50:03.376 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 13:50:03.378 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 13:50:03.379 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2022-09-23 13:50:03.379 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 13:50:03.380 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 13:50:03.381 +01:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.user_id AS "UserId", r.token AS "RefToken", r.expires AS "Expires", r.created AS "Created", r.created_by_ip AS "CreatedByIp", r.revoked AS "Revoked", r.revoked_by_ip AS "RevokedByIp", r.replaced_by_token AS "ReplacedByToken", r.reason_revoked AS "ReasonRevoked", r.is_expired AS "IsExpired", r.is_revoked AS "IsRevoked", r.is_active AS "IsActive"
FROM refresh_token AS r
WHERE r.user_id = @__id_0
2022-09-23 13:50:03.383 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.user_id AS "UserId", r.token AS "RefToken", r.expires AS "Expires", r.created AS "Created", r.created_by_ip AS "CreatedByIp", r.revoked AS "Revoked", r.revoked_by_ip AS "RevokedByIp", r.replaced_by_token AS "ReplacedByToken", r.reason_revoked AS "ReasonRevoked", r.is_expired AS "IsExpired", r.is_revoked AS "IsRevoked", r.is_active AS "IsActive"
FROM refresh_token AS r
WHERE r.user_id = @__id_0
2022-09-23 13:50:03.385 +01:00 [DBG] A data reader was disposed.
2022-09-23 13:50:03.385 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 13:50:03.388 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 13:50:03.389 +01:00 [DBG] An entity of type 'User' tracked by 'PostgresContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 13:50:03.391 +01:00 [DBG] SaveChanges starting for 'PostgresContext'.
2022-09-23 13:50:03.392 +01:00 [DBG] DetectChanges starting for 'PostgresContext'.
2022-09-23 13:50:03.393 +01:00 [DBG] 1 entities were added and 0 entities were removed from navigation 'User.RefreshTokenCollection'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 13:50:03.395 +01:00 [DBG] 'PostgresContext' generated a temporary value for the property 'Id.RefreshToken'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 13:50:03.396 +01:00 [DBG] Context 'PostgresContext' started tracking 'RefreshToken' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 13:50:03.397 +01:00 [DBG] DetectChanges completed for 'PostgresContext'.
2022-09-23 13:50:03.402 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 13:50:03.404 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 13:50:03.405 +01:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2022-09-23 13:50:03.406 +01:00 [DBG] Began transaction with isolation level 'ReadCommitted'.
2022-09-23 13:50:03.408 +01:00 [DBG] Executing 2 update commands as a batch.
2022-09-23 13:50:03.409 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 13:50:03.410 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2022-09-23 13:50:03.411 +01:00 [DBG] Executing DbCommand [Parameters=[@p0='?' (DbType = DateTime), @p1='?', @p2='?' (DbType = DateTime), @p3='?' (DbType = Boolean), @p4='?' (DbType = Boolean), @p5='?' (DbType = Boolean), @p6='?', @p7='?', @p8='?', @p9='?' (DbType = DateTime), @p10='?', @p11='?' (DbType = Int32), @p18='?' (DbType = Int32), @p12='?' (DbType = DateTime), @p13='?', @p14='?', @p15='?' (DbType = DateTime), @p16='?', @p17='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO refresh_token (created, created_by_ip, expires, is_active, is_expired, is_revoked, reason_revoked, token, replaced_by_token, revoked, revoked_by_ip, user_id)
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11)
RETURNING id;
UPDATE users SET created_at = @p12, email = @p13, full_name = @p14, password_changed_at = @p15, password_hash = @p16, username = @p17
WHERE id = @p18;
2022-09-23 13:50:03.413 +01:00 [INF] Executed DbCommand (3ms) [Parameters=[@p0='?' (DbType = DateTime), @p1='?', @p2='?' (DbType = DateTime), @p3='?' (DbType = Boolean), @p4='?' (DbType = Boolean), @p5='?' (DbType = Boolean), @p6='?', @p7='?', @p8='?', @p9='?' (DbType = DateTime), @p10='?', @p11='?' (DbType = Int32), @p18='?' (DbType = Int32), @p12='?' (DbType = DateTime), @p13='?', @p14='?', @p15='?' (DbType = DateTime), @p16='?', @p17='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO refresh_token (created, created_by_ip, expires, is_active, is_expired, is_revoked, reason_revoked, token, replaced_by_token, revoked, revoked_by_ip, user_id)
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11)
RETURNING id;
UPDATE users SET created_at = @p12, email = @p13, full_name = @p14, password_changed_at = @p15, password_hash = @p16, username = @p17
WHERE id = @p18;
2022-09-23 13:50:03.417 +01:00 [DBG] The foreign key property 'RefreshToken.Id' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2022-09-23 13:50:03.420 +01:00 [DBG] A data reader was disposed.
2022-09-23 13:50:03.421 +01:00 [DBG] Committing transaction.
2022-09-23 13:50:03.424 +01:00 [DBG] Committed transaction.
2022-09-23 13:50:03.425 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 13:50:03.426 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 13:50:03.427 +01:00 [DBG] Disposing transaction.
2022-09-23 13:50:03.428 +01:00 [DBG] An entity of type 'RefreshToken' tracked by 'PostgresContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 13:50:03.429 +01:00 [DBG] An entity of type 'User' tracked by 'PostgresContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 13:50:03.431 +01:00 [DBG] SaveChanges completed for 'PostgresContext' with 2 entities written to the database.
2022-09-23 13:50:09.344 +01:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2022-09-23 13:50:09.351 +01:00 [DBG] Attempting to select an output formatter based on Accept header '["text/plain"]'.
2022-09-23 13:50:09.353 +01:00 [DBG] Could not find an output formatter based on content negotiation. Accepted types were (["text/plain"])
2022-09-23 13:50:09.354 +01:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2022-09-23 13:50:09.355 +01:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2022-09-23 13:50:09.356 +01:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2022-09-23 13:50:09.357 +01:00 [INF] Executing OkObjectResult, writing value of type 'APIBank.Models.MyRequestResponses.LoginResponse'.
2022-09-23 13:50:09.358 +01:00 [INF] Executed action APIBank.Controllers.UsersController.RefreshToken (APIBank) in 6055.9337ms
2022-09-23 13:50:09.360 +01:00 [INF] Executed endpoint 'APIBank.Controllers.UsersController.RefreshToken (APIBank)'
2022-09-23 13:50:09.361 +01:00 [DBG] 'PostgresContext' disposed.
2022-09-23 13:50:09.362 +01:00 [INF] Request finished HTTP/2 POST https://localhost:7036/api/Users/refreshToken - 0 - 200 - application/json;+charset=utf-8 6184.3628ms
2022-09-23 13:50:09.383 +01:00 [DBG] Connection id "0HMKTC78QLDI1" received FIN.
2022-09-23 13:50:09.392 +01:00 [DBG] Connection id "0HMKTC78QLDI1" is closed. The last processed stream ID was 1.
2022-09-23 13:50:09.395 +01:00 [DBG] Connection id "0HMKTC78QLDI1" sending FIN because: "The client closed the connection."
2022-09-23 13:50:09.411 +01:00 [DBG] Connection id "0HMKTC78QLDI1" stopped.
2022-09-23 13:50:23.319 +01:00 [DBG] Connection id "0HMKTC78QLDI2" accepted.
2022-09-23 13:50:23.322 +01:00 [DBG] Connection id "0HMKTC78QLDI2" started.
2022-09-23 13:50:23.325 +01:00 [DBG] Connection 0HMKTC78QLDI2 established using the following protocol: "Tls12"
2022-09-23 13:50:23.329 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/api/Accounts/GetAll - -
2022-09-23 13:50:23.337 +01:00 [DBG] 1 candidate(s) found for the request path '/api/Accounts/GetAll'
2022-09-23 13:50:23.339 +01:00 [DBG] Endpoint 'APIBank.Controllers.AccountsController.GetAllFromUser (APIBank)' with route pattern 'api/Accounts/GetAll' is valid for the request path '/api/Accounts/GetAll'
2022-09-23 13:50:23.343 +01:00 [DBG] Request matched endpoint 'APIBank.Controllers.AccountsController.GetAllFromUser (APIBank)'
2022-09-23 13:50:23.344 +01:00 [DBG] Static files was skipped as the request already matched an endpoint.
2022-09-23 13:50:23.346 +01:00 [INF] Entity Framework Core 6.0.9 initialized 'PostgresContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:6.0.7+5b98e4b74de93b590b44aef8dd7967c03acc433c' with options: None
2022-09-23 13:50:23.349 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 13:50:23.350 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2022-09-23 13:50:23.351 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 13:50:23.352 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 13:50:23.353 +01:00 [DBG] Executing DbCommand [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.id = @__p_0
LIMIT 1
2022-09-23 13:50:23.358 +01:00 [INF] Executed DbCommand (5ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.id = @__p_0
LIMIT 1
2022-09-23 13:50:23.359 +01:00 [DBG] Context 'PostgresContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 13:50:23.360 +01:00 [DBG] A data reader was disposed.
2022-09-23 13:50:23.361 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 13:50:23.362 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 13:50:23.363 +01:00 [INF] Executing endpoint 'APIBank.Controllers.AccountsController.GetAllFromUser (APIBank)'
2022-09-23 13:50:23.364 +01:00 [INF] Route matched with {action = "GetAllFromUser", controller = "Accounts"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult GetAllFromUser() on controller APIBank.Controllers.AccountsController (APIBank).
2022-09-23 13:50:23.365 +01:00 [DBG] Execution plan of authorization filters (in the following order): ["APIBank.Authorization.AuthorizeAttribute"]
2022-09-23 13:50:23.366 +01:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2022-09-23 13:50:23.367 +01:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2022-09-23 13:50:23.369 +01:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2022-09-23 13:50:23.370 +01:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2022-09-23 13:50:23.375 +01:00 [DBG] Executing controller factory for controller APIBank.Controllers.AccountsController (APIBank)
2022-09-23 13:50:23.376 +01:00 [DBG] Executed controller factory for controller APIBank.Controllers.AccountsController (APIBank)
2022-09-23 13:50:35.337 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 13:50:35.340 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (2ms).
2022-09-23 13:50:35.341 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 13:50:35.343 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 13:50:35.345 +01:00 [DBG] Executing DbCommand [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id, r.created, r.created_by_ip, r.expires, r.is_active, r.is_expired, r.is_revoked, r.reason_revoked, r.token, r.replaced_by_token, r.revoked, r.revoked_by_ip, r.user_id
FROM refresh_token AS r
WHERE r.id = @__p_0
LIMIT 1
2022-09-23 13:50:35.351 +01:00 [INF] Executed DbCommand (7ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id, r.created, r.created_by_ip, r.expires, r.is_active, r.is_expired, r.is_revoked, r.reason_revoked, r.token, r.replaced_by_token, r.revoked, r.revoked_by_ip, r.user_id
FROM refresh_token AS r
WHERE r.id = @__p_0
LIMIT 1
2022-09-23 13:50:35.353 +01:00 [DBG] Context 'PostgresContext' started tracking 'RefreshToken' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 13:50:35.356 +01:00 [DBG] A data reader was disposed.
2022-09-23 13:50:35.357 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 13:50:35.358 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 13:50:35.359 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 13:50:35.360 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2022-09-23 13:50:35.366 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 13:50:35.367 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 13:50:35.368 +01:00 [DBG] Executing DbCommand [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a.balance AS "Balance", a.created_at AS "CreatedAt", a.currency AS "Currency", a.id AS "Id"
FROM accounts AS a
WHERE a.user_id = @__userId_0
2022-09-23 13:50:35.372 +01:00 [INF] Executed DbCommand (4ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a.balance AS "Balance", a.created_at AS "CreatedAt", a.currency AS "Currency", a.id AS "Id"
FROM accounts AS a
WHERE a.user_id = @__userId_0
2022-09-23 13:50:35.375 +01:00 [DBG] A data reader was disposed.
2022-09-23 13:50:35.375 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 13:50:35.376 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 13:50:35.378 +01:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2022-09-23 13:50:35.381 +01:00 [DBG] Attempting to select an output formatter based on Accept header '["text/plain"]'.
2022-09-23 13:50:35.384 +01:00 [DBG] Could not find an output formatter based on content negotiation. Accepted types were (["text/plain"])
2022-09-23 13:50:35.386 +01:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2022-09-23 13:50:35.387 +01:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2022-09-23 13:50:35.388 +01:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2022-09-23 13:50:35.389 +01:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[APIBank.Models.Responses.AccountRequestResponse, APIBank, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2022-09-23 13:50:35.390 +01:00 [INF] Executed action APIBank.Controllers.AccountsController.GetAllFromUser (APIBank) in 12014.1243ms
2022-09-23 13:50:35.391 +01:00 [INF] Executed endpoint 'APIBank.Controllers.AccountsController.GetAllFromUser (APIBank)'
2022-09-23 13:50:35.393 +01:00 [DBG] 'PostgresContext' disposed.
2022-09-23 13:50:35.395 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/api/Accounts/GetAll - - - 200 - application/json;+charset=utf-8 12066.1849ms
2022-09-23 13:50:39.419 +01:00 [DBG] Connection id "0HMKTC78QLDI2" received FIN.
2022-09-23 13:50:39.423 +01:00 [DBG] Connection id "0HMKTC78QLDI2" is closed. The last processed stream ID was 1.
2022-09-23 13:50:39.424 +01:00 [DBG] Connection id "0HMKTC78QLDI2" sending FIN because: "The client closed the connection."
2022-09-23 13:50:39.432 +01:00 [DBG] Connection id "0HMKTC78QLDI2" stopped.
2022-09-23 13:50:43.466 +01:00 [DBG] Connection id "0HMKTC78QLDI3" accepted.
2022-09-23 13:50:43.470 +01:00 [DBG] Connection id "0HMKTC78QLDI3" started.
2022-09-23 13:50:43.477 +01:00 [DBG] Connection 0HMKTC78QLDI3 established using the following protocol: "Tls12"
2022-09-23 13:50:43.481 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/api/Users/1/refresh-tokens - -
2022-09-23 13:50:43.483 +01:00 [DBG] 1 candidate(s) found for the request path '/api/Users/1/refresh-tokens'
2022-09-23 13:50:43.484 +01:00 [DBG] Endpoint 'APIBank.Controllers.UsersController.GetRefreshTokens (APIBank)' with route pattern 'api/Users/{id}/refresh-tokens' is valid for the request path '/api/Users/1/refresh-tokens'
2022-09-23 13:50:43.485 +01:00 [DBG] Request matched endpoint 'APIBank.Controllers.UsersController.GetRefreshTokens (APIBank)'
2022-09-23 13:50:43.486 +01:00 [DBG] Static files was skipped as the request already matched an endpoint.
2022-09-23 13:50:43.489 +01:00 [INF] Entity Framework Core 6.0.9 initialized 'PostgresContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:6.0.7+5b98e4b74de93b590b44aef8dd7967c03acc433c' with options: None
2022-09-23 13:50:43.493 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 13:50:43.494 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2022-09-23 13:50:43.495 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 13:50:43.496 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 13:50:43.498 +01:00 [DBG] Executing DbCommand [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.id = @__p_0
LIMIT 1
2022-09-23 13:50:43.501 +01:00 [INF] Executed DbCommand (3ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.id = @__p_0
LIMIT 1
2022-09-23 13:50:43.504 +01:00 [DBG] Context 'PostgresContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 13:50:43.506 +01:00 [DBG] A data reader was disposed.
2022-09-23 13:50:43.508 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 13:50:43.510 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 13:50:43.511 +01:00 [INF] Executing endpoint 'APIBank.Controllers.UsersController.GetRefreshTokens (APIBank)'
2022-09-23 13:50:43.518 +01:00 [INF] Route matched with {action = "GetRefreshTokens", controller = "Users"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult GetRefreshTokens(Int32) on controller APIBank.Controllers.UsersController (APIBank).
2022-09-23 13:50:43.519 +01:00 [DBG] Execution plan of authorization filters (in the following order): ["APIBank.Authorization.AuthorizeAttribute"]
2022-09-23 13:50:43.522 +01:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2022-09-23 13:50:43.525 +01:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2022-09-23 13:50:43.527 +01:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2022-09-23 13:50:43.530 +01:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2022-09-23 13:50:43.531 +01:00 [DBG] Executing controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-23 13:50:43.532 +01:00 [DBG] Executed controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-23 13:50:43.533 +01:00 [DBG] Attempting to bind parameter 'id' of type 'System.Int32' ...
2022-09-23 13:50:43.536 +01:00 [DBG] Attempting to bind parameter 'id' of type 'System.Int32' using the name 'id' in request data ...
2022-09-23 13:50:43.539 +01:00 [DBG] Done attempting to bind parameter 'id' of type 'System.Int32'.
2022-09-23 13:50:43.544 +01:00 [DBG] Done attempting to bind parameter 'id' of type 'System.Int32'.
2022-09-23 13:50:43.545 +01:00 [DBG] Attempting to validate the bound parameter 'id' of type 'System.Int32' ...
2022-09-23 13:50:43.547 +01:00 [DBG] Done attempting to validate the bound parameter 'id' of type 'System.Int32'.
2022-09-23 13:50:43.549 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 13:50:43.550 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2022-09-23 13:50:43.551 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 13:50:43.552 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 13:50:43.553 +01:00 [DBG] Executing DbCommand [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id, r.created, r.created_by_ip, r.expires, r.is_active, r.is_expired, r.is_revoked, r.reason_revoked, r.token, r.replaced_by_token, r.revoked, r.revoked_by_ip, r.user_id
FROM refresh_token AS r
WHERE r.id = @__p_0
LIMIT 1
2022-09-23 13:50:43.556 +01:00 [INF] Executed DbCommand (3ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id, r.created, r.created_by_ip, r.expires, r.is_active, r.is_expired, r.is_revoked, r.reason_revoked, r.token, r.replaced_by_token, r.revoked, r.revoked_by_ip, r.user_id
FROM refresh_token AS r
WHERE r.id = @__p_0
LIMIT 1
2022-09-23 13:50:43.558 +01:00 [DBG] Context 'PostgresContext' started tracking 'RefreshToken' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 13:50:43.563 +01:00 [DBG] A data reader was disposed.
2022-09-23 13:50:43.564 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 13:50:43.565 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 13:50:43.567 +01:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2022-09-23 13:50:43.570 +01:00 [DBG] No information found on request to perform content negotiation.
2022-09-23 13:50:43.572 +01:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2022-09-23 13:50:43.576 +01:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2022-09-23 13:50:43.579 +01:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2022-09-23 13:50:43.582 +01:00 [INF] Executing OkObjectResult, writing value of type 'Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryable`1[[APIBank.ModelEntities.RefreshToken, APIBank, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2022-09-23 13:50:43.597 +01:00 [DBG] Compiling query expression: 
'DbSet<RefreshToken>()
    .Where(rt => rt.UserId == __id_0)
    .AsNoTracking()
    .Select(rt => new RefreshToken{ 
        Id = rt.Id, 
        UserId = rt.UserId, 
        RefToken = rt.RefToken, 
        Expires = rt.Expires, 
        Created = rt.Created, 
        CreatedByIp = rt.CreatedByIp, 
        Revoked = rt.Revoked, 
        RevokedByIp = rt.RevokedByIp, 
        ReplacedByToken = rt.ReplacedByToken, 
        ReasonRevoked = rt.ReasonRevoked, 
        IsExpired = rt.IsExpired, 
        IsRevoked = rt.IsRevoked, 
        IsActive = rt.IsActive 
    }
    )'
2022-09-23 13:50:43.604 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<RefreshToken>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            Id -> 0
            UserId -> 1
            RefToken -> 2
            Expires -> 3
            Created -> 4
            CreatedByIp -> 5
            Revoked -> 6
            RevokedByIp -> 7
            ReplacedByToken -> 8
            ReasonRevoked -> 9
            IsExpired -> 10
            IsRevoked -> 11
            IsActive -> 12
        SELECT r.id AS Id, r.user_id AS UserId, r.token AS RefToken, r.expires AS Expires, r.created AS Created, r.created_by_ip AS CreatedByIp, r.revoked AS Revoked, r.revoked_by_ip AS RevokedByIp, r.replaced_by_token AS ReplacedByToken, r.reason_revoked AS ReasonRevoked, r.is_expired AS IsExpired, r.is_revoked AS IsRevoked, r.is_active AS IsActive
        FROM refresh_token AS r
        WHERE r.user_id == @__id_0), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, RefreshToken>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)'
2022-09-23 13:50:43.641 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 13:50:43.644 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (2ms).
2022-09-23 13:50:43.661 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 13:50:43.669 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 13:50:43.672 +01:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.user_id AS "UserId", r.token AS "RefToken", r.expires AS "Expires", r.created AS "Created", r.created_by_ip AS "CreatedByIp", r.revoked AS "Revoked", r.revoked_by_ip AS "RevokedByIp", r.replaced_by_token AS "ReplacedByToken", r.reason_revoked AS "ReasonRevoked", r.is_expired AS "IsExpired", r.is_revoked AS "IsRevoked", r.is_active AS "IsActive"
FROM refresh_token AS r
WHERE r.user_id = @__id_0
2022-09-23 13:50:43.683 +01:00 [INF] Executed DbCommand (11ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.user_id AS "UserId", r.token AS "RefToken", r.expires AS "Expires", r.created AS "Created", r.created_by_ip AS "CreatedByIp", r.revoked AS "Revoked", r.revoked_by_ip AS "RevokedByIp", r.replaced_by_token AS "ReplacedByToken", r.reason_revoked AS "ReasonRevoked", r.is_expired AS "IsExpired", r.is_revoked AS "IsRevoked", r.is_active AS "IsActive"
FROM refresh_token AS r
WHERE r.user_id = @__id_0
2022-09-23 13:50:43.707 +01:00 [DBG] A data reader was disposed.
2022-09-23 13:50:43.724 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 13:50:43.729 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 13:50:43.731 +01:00 [INF] Executed action APIBank.Controllers.UsersController.GetRefreshTokens (APIBank) in 200.0818ms
2022-09-23 13:50:43.732 +01:00 [INF] Executed endpoint 'APIBank.Controllers.UsersController.GetRefreshTokens (APIBank)'
2022-09-23 13:50:43.733 +01:00 [DBG] 'PostgresContext' disposed.
2022-09-23 13:50:43.735 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/api/Users/1/refresh-tokens - - - 200 - application/json;+charset=utf-8 254.3418ms
2022-09-23 13:50:49.424 +01:00 [DBG] Connection id "0HMKTC78QLDI3" received FIN.
2022-09-23 13:50:49.427 +01:00 [DBG] Connection id "0HMKTC78QLDI3" is closed. The last processed stream ID was 1.
2022-09-23 13:50:49.428 +01:00 [DBG] Connection id "0HMKTC78QLDI3" sending FIN because: "The client closed the connection."
2022-09-23 13:50:49.439 +01:00 [DBG] Connection id "0HMKTC78QLDI3" stopped.
2022-09-23 13:50:59.953 +01:00 [DBG] Connection id "0HMKTC78QLDI4" accepted.
2022-09-23 13:50:59.955 +01:00 [DBG] Connection id "0HMKTC78QLDI4" started.
2022-09-23 13:50:59.959 +01:00 [DBG] Connection 0HMKTC78QLDI4 established using the following protocol: "Tls12"
2022-09-23 13:50:59.961 +01:00 [INF] Request starting HTTP/2 POST https://localhost:7036/api/Users/revoke-token application/json 20
2022-09-23 13:50:59.968 +01:00 [DBG] 1 candidate(s) found for the request path '/api/Users/revoke-token'
2022-09-23 13:50:59.968 +01:00 [DBG] Endpoint 'APIBank.Controllers.UsersController.RevokeToken (APIBank)' with route pattern 'api/Users/revoke-token' is valid for the request path '/api/Users/revoke-token'
2022-09-23 13:50:59.969 +01:00 [DBG] Request matched endpoint 'APIBank.Controllers.UsersController.RevokeToken (APIBank)'
2022-09-23 13:50:59.970 +01:00 [DBG] Static files was skipped as the request already matched an endpoint.
2022-09-23 13:50:59.972 +01:00 [INF] Entity Framework Core 6.0.9 initialized 'PostgresContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:6.0.7+5b98e4b74de93b590b44aef8dd7967c03acc433c' with options: None
2022-09-23 13:50:59.975 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 13:50:59.977 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2022-09-23 13:50:59.979 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 13:50:59.982 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 13:50:59.983 +01:00 [DBG] Executing DbCommand [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.id = @__p_0
LIMIT 1
2022-09-23 13:50:59.986 +01:00 [INF] Executed DbCommand (3ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.id = @__p_0
LIMIT 1
2022-09-23 13:50:59.989 +01:00 [DBG] Context 'PostgresContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 13:50:59.992 +01:00 [DBG] A data reader was disposed.
2022-09-23 13:50:59.993 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 13:50:59.996 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 13:50:59.998 +01:00 [INF] Executing endpoint 'APIBank.Controllers.UsersController.RevokeToken (APIBank)'
2022-09-23 13:51:00.001 +01:00 [INF] Route matched with {action = "RevokeToken", controller = "Users"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult RevokeToken(APIBank.Models.MyRequestResponses.UserRevokeTokenRequest) on controller APIBank.Controllers.UsersController (APIBank).
2022-09-23 13:51:00.003 +01:00 [DBG] Execution plan of authorization filters (in the following order): ["APIBank.Authorization.AuthorizeAttribute"]
2022-09-23 13:51:00.005 +01:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2022-09-23 13:51:00.007 +01:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2022-09-23 13:51:00.017 +01:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2022-09-23 13:51:00.020 +01:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2022-09-23 13:51:00.029 +01:00 [DBG] Executing controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-23 13:51:00.032 +01:00 [DBG] Executed controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-23 13:51:00.033 +01:00 [DBG] Attempting to bind parameter 'model' of type 'APIBank.Models.MyRequestResponses.UserRevokeTokenRequest' ...
2022-09-23 13:51:00.035 +01:00 [DBG] Attempting to bind parameter 'model' of type 'APIBank.Models.MyRequestResponses.UserRevokeTokenRequest' using the name '' in request data ...
2022-09-23 13:51:00.036 +01:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2022-09-23 13:51:00.038 +01:00 [DBG] Connection id "0HMKTC78QLDI4", Request id "0HMKTC78QLDI4:00000001": started reading request body.
2022-09-23 13:51:00.044 +01:00 [DBG] Connection id "0HMKTC78QLDI4", Request id "0HMKTC78QLDI4:00000001": done reading request body.
2022-09-23 13:51:00.047 +01:00 [DBG] JSON input formatter succeeded, deserializing to type 'APIBank.Models.MyRequestResponses.UserRevokeTokenRequest'
2022-09-23 13:51:00.049 +01:00 [DBG] Done attempting to bind parameter 'model' of type 'APIBank.Models.MyRequestResponses.UserRevokeTokenRequest'.
2022-09-23 13:51:00.051 +01:00 [DBG] Done attempting to bind parameter 'model' of type 'APIBank.Models.MyRequestResponses.UserRevokeTokenRequest'.
2022-09-23 13:51:00.052 +01:00 [DBG] Attempting to validate the bound parameter 'model' of type 'APIBank.Models.MyRequestResponses.UserRevokeTokenRequest' ...
2022-09-23 13:51:00.054 +01:00 [DBG] Done attempting to validate the bound parameter 'model' of type 'APIBank.Models.MyRequestResponses.UserRevokeTokenRequest'.
2022-09-23 13:51:00.061 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 13:51:00.062 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2022-09-23 13:51:00.063 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 13:51:00.064 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 13:51:00.065 +01:00 [DBG] Executing DbCommand [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id, r.created, r.created_by_ip, r.expires, r.is_active, r.is_expired, r.is_revoked, r.reason_revoked, r.token, r.replaced_by_token, r.revoked, r.revoked_by_ip, r.user_id
FROM refresh_token AS r
WHERE r.id = @__p_0
LIMIT 1
2022-09-23 13:51:00.067 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id, r.created, r.created_by_ip, r.expires, r.is_active, r.is_expired, r.is_revoked, r.reason_revoked, r.token, r.replaced_by_token, r.revoked, r.revoked_by_ip, r.user_id
FROM refresh_token AS r
WHERE r.id = @__p_0
LIMIT 1
2022-09-23 13:51:00.069 +01:00 [DBG] Context 'PostgresContext' started tracking 'RefreshToken' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 13:51:00.070 +01:00 [DBG] A data reader was disposed.
2022-09-23 13:51:00.073 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 13:51:00.075 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 13:51:00.079 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 13:51:00.080 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2022-09-23 13:51:00.081 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 13:51:00.082 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 13:51:00.083 +01:00 [DBG] Executing DbCommand [Parameters=[@__refToken_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE EXISTS (
    SELECT 1
    FROM refresh_token AS r
    WHERE (u.id = r.user_id) AND (r.token = @__refToken_0))
LIMIT 2
2022-09-23 13:51:00.086 +01:00 [INF] Executed DbCommand (3ms) [Parameters=[@__refToken_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE EXISTS (
    SELECT 1
    FROM refresh_token AS r
    WHERE (u.id = r.user_id) AND (r.token = @__refToken_0))
LIMIT 2
2022-09-23 13:51:00.091 +01:00 [DBG] A data reader was disposed.
2022-09-23 13:51:00.092 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 13:51:00.094 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 13:51:00.095 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 13:51:00.097 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2022-09-23 13:51:00.098 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 13:51:00.099 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 13:51:00.101 +01:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.user_id AS "UserId", r.token AS "RefToken", r.expires AS "Expires", r.created AS "Created", r.created_by_ip AS "CreatedByIp", r.revoked AS "Revoked", r.revoked_by_ip AS "RevokedByIp", r.replaced_by_token AS "ReplacedByToken", r.reason_revoked AS "ReasonRevoked", r.is_expired AS "IsExpired", r.is_revoked AS "IsRevoked", r.is_active AS "IsActive"
FROM refresh_token AS r
WHERE r.user_id = @__id_0
2022-09-23 13:51:00.104 +01:00 [INF] Executed DbCommand (3ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.user_id AS "UserId", r.token AS "RefToken", r.expires AS "Expires", r.created AS "Created", r.created_by_ip AS "CreatedByIp", r.revoked AS "Revoked", r.revoked_by_ip AS "RevokedByIp", r.replaced_by_token AS "ReplacedByToken", r.reason_revoked AS "ReasonRevoked", r.is_expired AS "IsExpired", r.is_revoked AS "IsRevoked", r.is_active AS "IsActive"
FROM refresh_token AS r
WHERE r.user_id = @__id_0
2022-09-23 13:51:00.105 +01:00 [DBG] A data reader was disposed.
2022-09-23 13:51:00.106 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 13:51:00.108 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 13:51:00.110 +01:00 [DBG] An entity of type 'User' tracked by 'PostgresContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 13:51:00.111 +01:00 [DBG] SaveChanges starting for 'PostgresContext'.
2022-09-23 13:51:00.112 +01:00 [DBG] DetectChanges starting for 'PostgresContext'.
2022-09-23 13:51:00.115 +01:00 [DBG] DetectChanges completed for 'PostgresContext'.
2022-09-23 13:51:00.116 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 13:51:00.117 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 13:51:00.119 +01:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2022-09-23 13:51:00.120 +01:00 [DBG] Began transaction with isolation level 'ReadCommitted'.
2022-09-23 13:51:00.121 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 13:51:00.122 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2022-09-23 13:51:00.124 +01:00 [DBG] Executing DbCommand [Parameters=[@p6='?' (DbType = Int32), @p0='?' (DbType = DateTime), @p1='?', @p2='?', @p3='?' (DbType = DateTime), @p4='?', @p5='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE users SET created_at = @p0, email = @p1, full_name = @p2, password_changed_at = @p3, password_hash = @p4, username = @p5
WHERE id = @p6;
2022-09-23 13:51:00.128 +01:00 [INF] Executed DbCommand (5ms) [Parameters=[@p6='?' (DbType = Int32), @p0='?' (DbType = DateTime), @p1='?', @p2='?', @p3='?' (DbType = DateTime), @p4='?', @p5='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE users SET created_at = @p0, email = @p1, full_name = @p2, password_changed_at = @p3, password_hash = @p4, username = @p5
WHERE id = @p6;
2022-09-23 13:51:00.132 +01:00 [DBG] A data reader was disposed.
2022-09-23 13:51:00.133 +01:00 [DBG] Committing transaction.
2022-09-23 13:51:00.135 +01:00 [DBG] Committed transaction.
2022-09-23 13:51:00.136 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 13:51:00.137 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 13:51:00.138 +01:00 [DBG] Disposing transaction.
2022-09-23 13:51:00.139 +01:00 [DBG] An entity of type 'User' tracked by 'PostgresContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 13:51:00.142 +01:00 [DBG] SaveChanges completed for 'PostgresContext' with 1 entities written to the database.
2022-09-23 13:51:00.144 +01:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2022-09-23 13:51:00.146 +01:00 [DBG] No information found on request to perform content negotiation.
2022-09-23 13:51:00.147 +01:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2022-09-23 13:51:00.148 +01:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2022-09-23 13:51:00.149 +01:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2022-09-23 13:51:00.152 +01:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType0`1[[System.String, System.Private.CoreLib, Version=6.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2022-09-23 13:51:00.155 +01:00 [INF] Executed action APIBank.Controllers.UsersController.RevokeToken (APIBank) in 126.6139ms
2022-09-23 13:51:00.156 +01:00 [INF] Executed endpoint 'APIBank.Controllers.UsersController.RevokeToken (APIBank)'
2022-09-23 13:51:00.158 +01:00 [DBG] 'PostgresContext' disposed.
2022-09-23 13:51:00.160 +01:00 [INF] Request finished HTTP/2 POST https://localhost:7036/api/Users/revoke-token application/json 20 - 200 - application/json;+charset=utf-8 198.9395ms
2022-09-23 13:51:06.075 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/api/Accounts/GetAll - -
2022-09-23 13:51:06.078 +01:00 [DBG] 1 candidate(s) found for the request path '/api/Accounts/GetAll'
2022-09-23 13:51:06.078 +01:00 [DBG] Endpoint 'APIBank.Controllers.AccountsController.GetAllFromUser (APIBank)' with route pattern 'api/Accounts/GetAll' is valid for the request path '/api/Accounts/GetAll'
2022-09-23 13:51:06.082 +01:00 [DBG] Request matched endpoint 'APIBank.Controllers.AccountsController.GetAllFromUser (APIBank)'
2022-09-23 13:51:06.083 +01:00 [DBG] Static files was skipped as the request already matched an endpoint.
2022-09-23 13:51:06.089 +01:00 [INF] Entity Framework Core 6.0.9 initialized 'PostgresContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:6.0.7+5b98e4b74de93b590b44aef8dd7967c03acc433c' with options: None
2022-09-23 13:51:06.092 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 13:51:06.093 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2022-09-23 13:51:06.094 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 13:51:06.095 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 13:51:06.097 +01:00 [DBG] Executing DbCommand [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.id = @__p_0
LIMIT 1
2022-09-23 13:51:06.099 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.id = @__p_0
LIMIT 1
2022-09-23 13:51:06.102 +01:00 [DBG] Context 'PostgresContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 13:51:06.105 +01:00 [DBG] A data reader was disposed.
2022-09-23 13:51:06.107 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 13:51:06.109 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 13:51:06.110 +01:00 [INF] Executing endpoint 'APIBank.Controllers.AccountsController.GetAllFromUser (APIBank)'
2022-09-23 13:51:06.111 +01:00 [INF] Route matched with {action = "GetAllFromUser", controller = "Accounts"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult GetAllFromUser() on controller APIBank.Controllers.AccountsController (APIBank).
2022-09-23 13:51:06.114 +01:00 [DBG] Execution plan of authorization filters (in the following order): ["APIBank.Authorization.AuthorizeAttribute"]
2022-09-23 13:51:06.116 +01:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2022-09-23 13:51:06.117 +01:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2022-09-23 13:51:06.118 +01:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2022-09-23 13:51:06.120 +01:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2022-09-23 13:51:06.122 +01:00 [DBG] Executing controller factory for controller APIBank.Controllers.AccountsController (APIBank)
2022-09-23 13:51:06.124 +01:00 [DBG] Executed controller factory for controller APIBank.Controllers.AccountsController (APIBank)
2022-09-23 13:51:06.126 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 13:51:06.128 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (2ms).
2022-09-23 13:51:06.129 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 13:51:06.130 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 13:51:06.131 +01:00 [DBG] Executing DbCommand [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id, r.created, r.created_by_ip, r.expires, r.is_active, r.is_expired, r.is_revoked, r.reason_revoked, r.token, r.replaced_by_token, r.revoked, r.revoked_by_ip, r.user_id
FROM refresh_token AS r
WHERE r.id = @__p_0
LIMIT 1
2022-09-23 13:51:06.134 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id, r.created, r.created_by_ip, r.expires, r.is_active, r.is_expired, r.is_revoked, r.reason_revoked, r.token, r.replaced_by_token, r.revoked, r.revoked_by_ip, r.user_id
FROM refresh_token AS r
WHERE r.id = @__p_0
LIMIT 1
2022-09-23 13:51:06.137 +01:00 [DBG] Context 'PostgresContext' started tracking 'RefreshToken' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 13:51:06.139 +01:00 [DBG] A data reader was disposed.
2022-09-23 13:51:06.139 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 13:51:06.141 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 13:51:06.145 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 13:51:06.146 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2022-09-23 13:51:06.146 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 13:51:06.147 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 13:51:06.148 +01:00 [DBG] Executing DbCommand [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a.balance AS "Balance", a.created_at AS "CreatedAt", a.currency AS "Currency", a.id AS "Id"
FROM accounts AS a
WHERE a.user_id = @__userId_0
2022-09-23 13:51:06.150 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a.balance AS "Balance", a.created_at AS "CreatedAt", a.currency AS "Currency", a.id AS "Id"
FROM accounts AS a
WHERE a.user_id = @__userId_0
2022-09-23 13:51:06.152 +01:00 [DBG] A data reader was disposed.
2022-09-23 13:51:06.153 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 13:51:06.154 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 13:51:06.155 +01:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2022-09-23 13:51:06.157 +01:00 [DBG] Attempting to select an output formatter based on Accept header '["text/plain"]'.
2022-09-23 13:51:06.159 +01:00 [DBG] Could not find an output formatter based on content negotiation. Accepted types were (["text/plain"])
2022-09-23 13:51:06.160 +01:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2022-09-23 13:51:06.161 +01:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2022-09-23 13:51:06.162 +01:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2022-09-23 13:51:06.163 +01:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[APIBank.Models.Responses.AccountRequestResponse, APIBank, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2022-09-23 13:51:06.164 +01:00 [INF] Executed action APIBank.Controllers.AccountsController.GetAllFromUser (APIBank) in 42.1949ms
2022-09-23 13:51:06.165 +01:00 [INF] Executed endpoint 'APIBank.Controllers.AccountsController.GetAllFromUser (APIBank)'
2022-09-23 13:51:06.167 +01:00 [DBG] 'PostgresContext' disposed.
2022-09-23 13:51:06.168 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/api/Accounts/GetAll - - - 200 - application/json;+charset=utf-8 92.3785ms
2022-09-23 13:51:09.440 +01:00 [DBG] Connection id "0HMKTC78QLDI4" received FIN.
2022-09-23 13:51:09.442 +01:00 [DBG] Connection id "0HMKTC78QLDI4" is closed. The last processed stream ID was 3.
2022-09-23 13:51:09.443 +01:00 [DBG] Connection id "0HMKTC78QLDI4" sending FIN because: "The client closed the connection."
2022-09-23 13:51:09.452 +01:00 [DBG] Connection id "0HMKTC78QLDI4" stopped.
2022-09-23 13:51:11.145 +01:00 [DBG] Connection id "0HMKTC78QLDI5" accepted.
2022-09-23 13:51:11.149 +01:00 [DBG] Connection id "0HMKTC78QLDI5" started.
2022-09-23 13:51:11.152 +01:00 [DBG] Connection 0HMKTC78QLDI5 established using the following protocol: "Tls12"
2022-09-23 13:51:11.157 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/api/Accounts/GetAll - -
2022-09-23 13:51:11.160 +01:00 [DBG] 1 candidate(s) found for the request path '/api/Accounts/GetAll'
2022-09-23 13:51:11.164 +01:00 [DBG] Endpoint 'APIBank.Controllers.AccountsController.GetAllFromUser (APIBank)' with route pattern 'api/Accounts/GetAll' is valid for the request path '/api/Accounts/GetAll'
2022-09-23 13:51:11.171 +01:00 [DBG] Request matched endpoint 'APIBank.Controllers.AccountsController.GetAllFromUser (APIBank)'
2022-09-23 13:51:11.172 +01:00 [DBG] Static files was skipped as the request already matched an endpoint.
2022-09-23 13:51:11.177 +01:00 [INF] Entity Framework Core 6.0.9 initialized 'PostgresContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:6.0.7+5b98e4b74de93b590b44aef8dd7967c03acc433c' with options: None
2022-09-23 13:51:11.185 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 13:51:11.186 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2022-09-23 13:51:11.187 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 13:51:11.188 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 13:51:11.189 +01:00 [DBG] Executing DbCommand [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.id = @__p_0
LIMIT 1
2022-09-23 13:51:11.191 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.id = @__p_0
LIMIT 1
2022-09-23 13:51:11.196 +01:00 [DBG] Context 'PostgresContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 13:51:11.197 +01:00 [DBG] A data reader was disposed.
2022-09-23 13:51:11.198 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 13:51:11.200 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 13:51:11.202 +01:00 [INF] Executing endpoint 'APIBank.Controllers.AccountsController.GetAllFromUser (APIBank)'
2022-09-23 13:51:11.203 +01:00 [INF] Route matched with {action = "GetAllFromUser", controller = "Accounts"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult GetAllFromUser() on controller APIBank.Controllers.AccountsController (APIBank).
2022-09-23 13:51:11.205 +01:00 [DBG] Execution plan of authorization filters (in the following order): ["APIBank.Authorization.AuthorizeAttribute"]
2022-09-23 13:51:11.206 +01:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2022-09-23 13:51:11.207 +01:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2022-09-23 13:51:11.212 +01:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2022-09-23 13:51:11.213 +01:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2022-09-23 13:51:11.215 +01:00 [DBG] Executing controller factory for controller APIBank.Controllers.AccountsController (APIBank)
2022-09-23 13:51:11.217 +01:00 [DBG] Executed controller factory for controller APIBank.Controllers.AccountsController (APIBank)
2022-09-23 13:51:11.219 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 13:51:11.220 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2022-09-23 13:51:11.221 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 13:51:11.222 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 13:51:11.223 +01:00 [DBG] Executing DbCommand [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id, r.created, r.created_by_ip, r.expires, r.is_active, r.is_expired, r.is_revoked, r.reason_revoked, r.token, r.replaced_by_token, r.revoked, r.revoked_by_ip, r.user_id
FROM refresh_token AS r
WHERE r.id = @__p_0
LIMIT 1
2022-09-23 13:51:11.226 +01:00 [INF] Executed DbCommand (3ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id, r.created, r.created_by_ip, r.expires, r.is_active, r.is_expired, r.is_revoked, r.reason_revoked, r.token, r.replaced_by_token, r.revoked, r.revoked_by_ip, r.user_id
FROM refresh_token AS r
WHERE r.id = @__p_0
LIMIT 1
2022-09-23 13:51:11.228 +01:00 [DBG] Context 'PostgresContext' started tracking 'RefreshToken' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 13:51:11.229 +01:00 [DBG] A data reader was disposed.
2022-09-23 13:51:11.229 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 13:51:11.230 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 13:51:11.232 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 13:51:11.233 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2022-09-23 13:51:11.235 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 13:51:11.236 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 13:51:11.238 +01:00 [DBG] Executing DbCommand [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a.balance AS "Balance", a.created_at AS "CreatedAt", a.currency AS "Currency", a.id AS "Id"
FROM accounts AS a
WHERE a.user_id = @__userId_0
2022-09-23 13:51:11.241 +01:00 [INF] Executed DbCommand (4ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a.balance AS "Balance", a.created_at AS "CreatedAt", a.currency AS "Currency", a.id AS "Id"
FROM accounts AS a
WHERE a.user_id = @__userId_0
2022-09-23 13:51:11.243 +01:00 [DBG] A data reader was disposed.
2022-09-23 13:51:11.244 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 13:51:11.245 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 13:51:11.246 +01:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2022-09-23 13:51:11.248 +01:00 [DBG] Attempting to select an output formatter based on Accept header '["text/plain"]'.
2022-09-23 13:51:11.250 +01:00 [DBG] Could not find an output formatter based on content negotiation. Accepted types were (["text/plain"])
2022-09-23 13:51:11.252 +01:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2022-09-23 13:51:11.252 +01:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2022-09-23 13:51:11.253 +01:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2022-09-23 13:51:11.256 +01:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[APIBank.Models.Responses.AccountRequestResponse, APIBank, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2022-09-23 13:51:11.257 +01:00 [INF] Executed action APIBank.Controllers.AccountsController.GetAllFromUser (APIBank) in 41.906ms
2022-09-23 13:51:11.259 +01:00 [INF] Executed endpoint 'APIBank.Controllers.AccountsController.GetAllFromUser (APIBank)'
2022-09-23 13:51:11.260 +01:00 [DBG] 'PostgresContext' disposed.
2022-09-23 13:51:11.261 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/api/Accounts/GetAll - - - 200 - application/json;+charset=utf-8 103.9065ms
2022-09-23 13:51:19.445 +01:00 [DBG] Connection id "0HMKTC78QLDI5" received FIN.
2022-09-23 13:51:19.449 +01:00 [DBG] Connection id "0HMKTC78QLDI5" is closed. The last processed stream ID was 1.
2022-09-23 13:51:19.452 +01:00 [DBG] Connection id "0HMKTC78QLDI5" sending FIN because: "The client closed the connection."
2022-09-23 13:51:19.460 +01:00 [DBG] Connection id "0HMKTC78QLDI5" stopped.
2022-09-23 13:52:28.490 +01:00 [DBG] Connection id "0HMKTC78QLDI6" accepted.
2022-09-23 13:52:28.495 +01:00 [DBG] Connection id "0HMKTC78QLDI6" started.
2022-09-23 13:52:28.503 +01:00 [DBG] Connection 0HMKTC78QLDI6 established using the following protocol: "Tls12"
2022-09-23 13:52:28.509 +01:00 [INF] Request starting HTTP/2 POST https://localhost:7036/api/Users/revoke-token application/json 20
2022-09-23 13:52:28.521 +01:00 [DBG] 1 candidate(s) found for the request path '/api/Users/revoke-token'
2022-09-23 13:52:28.524 +01:00 [DBG] Endpoint 'APIBank.Controllers.UsersController.RevokeToken (APIBank)' with route pattern 'api/Users/revoke-token' is valid for the request path '/api/Users/revoke-token'
2022-09-23 13:52:28.526 +01:00 [DBG] Request matched endpoint 'APIBank.Controllers.UsersController.RevokeToken (APIBank)'
2022-09-23 13:52:28.527 +01:00 [DBG] Static files was skipped as the request already matched an endpoint.
2022-09-23 13:52:28.529 +01:00 [INF] Entity Framework Core 6.0.9 initialized 'PostgresContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:6.0.7+5b98e4b74de93b590b44aef8dd7967c03acc433c' with options: None
2022-09-23 13:52:28.531 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 13:52:28.532 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2022-09-23 13:52:28.533 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 13:52:28.535 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 13:52:28.537 +01:00 [DBG] Executing DbCommand [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.id = @__p_0
LIMIT 1
2022-09-23 13:52:28.541 +01:00 [INF] Executed DbCommand (4ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.id = @__p_0
LIMIT 1
2022-09-23 13:52:28.542 +01:00 [DBG] Context 'PostgresContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 13:52:28.543 +01:00 [DBG] A data reader was disposed.
2022-09-23 13:52:28.544 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 13:52:28.545 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 13:52:28.546 +01:00 [INF] Executing endpoint 'APIBank.Controllers.UsersController.RevokeToken (APIBank)'
2022-09-23 13:52:28.547 +01:00 [INF] Route matched with {action = "RevokeToken", controller = "Users"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult RevokeToken(APIBank.Models.MyRequestResponses.UserRevokeTokenRequest) on controller APIBank.Controllers.UsersController (APIBank).
2022-09-23 13:52:28.548 +01:00 [DBG] Execution plan of authorization filters (in the following order): ["APIBank.Authorization.AuthorizeAttribute"]
2022-09-23 13:52:28.549 +01:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2022-09-23 13:52:28.551 +01:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2022-09-23 13:52:28.553 +01:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2022-09-23 13:52:28.558 +01:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2022-09-23 13:52:28.560 +01:00 [DBG] Executing controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-23 13:52:28.562 +01:00 [DBG] Executed controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-23 13:52:28.563 +01:00 [DBG] Attempting to bind parameter 'model' of type 'APIBank.Models.MyRequestResponses.UserRevokeTokenRequest' ...
2022-09-23 13:52:28.564 +01:00 [DBG] Attempting to bind parameter 'model' of type 'APIBank.Models.MyRequestResponses.UserRevokeTokenRequest' using the name '' in request data ...
2022-09-23 13:52:28.565 +01:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2022-09-23 13:52:28.566 +01:00 [DBG] Connection id "0HMKTC78QLDI6", Request id "0HMKTC78QLDI6:00000001": started reading request body.
2022-09-23 13:52:28.567 +01:00 [DBG] Connection id "0HMKTC78QLDI6", Request id "0HMKTC78QLDI6:00000001": done reading request body.
2022-09-23 13:52:28.569 +01:00 [DBG] JSON input formatter succeeded, deserializing to type 'APIBank.Models.MyRequestResponses.UserRevokeTokenRequest'
2022-09-23 13:52:28.572 +01:00 [DBG] Done attempting to bind parameter 'model' of type 'APIBank.Models.MyRequestResponses.UserRevokeTokenRequest'.
2022-09-23 13:52:28.573 +01:00 [DBG] Done attempting to bind parameter 'model' of type 'APIBank.Models.MyRequestResponses.UserRevokeTokenRequest'.
2022-09-23 13:52:28.574 +01:00 [DBG] Attempting to validate the bound parameter 'model' of type 'APIBank.Models.MyRequestResponses.UserRevokeTokenRequest' ...
2022-09-23 13:52:28.575 +01:00 [DBG] Done attempting to validate the bound parameter 'model' of type 'APIBank.Models.MyRequestResponses.UserRevokeTokenRequest'.
2022-09-23 13:52:28.577 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 13:52:28.578 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2022-09-23 13:52:28.579 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 13:52:28.579 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 13:52:28.580 +01:00 [DBG] Executing DbCommand [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id, r.created, r.created_by_ip, r.expires, r.is_active, r.is_expired, r.is_revoked, r.reason_revoked, r.token, r.replaced_by_token, r.revoked, r.revoked_by_ip, r.user_id
FROM refresh_token AS r
WHERE r.id = @__p_0
LIMIT 1
2022-09-23 13:52:28.582 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id, r.created, r.created_by_ip, r.expires, r.is_active, r.is_expired, r.is_revoked, r.reason_revoked, r.token, r.replaced_by_token, r.revoked, r.revoked_by_ip, r.user_id
FROM refresh_token AS r
WHERE r.id = @__p_0
LIMIT 1
2022-09-23 13:52:28.586 +01:00 [DBG] Context 'PostgresContext' started tracking 'RefreshToken' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 13:52:28.588 +01:00 [DBG] A data reader was disposed.
2022-09-23 13:52:28.589 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 13:52:28.590 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 13:52:28.591 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 13:52:28.592 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2022-09-23 13:52:28.593 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 13:52:28.594 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 13:52:28.596 +01:00 [DBG] Executing DbCommand [Parameters=[@__refToken_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE EXISTS (
    SELECT 1
    FROM refresh_token AS r
    WHERE (u.id = r.user_id) AND (r.token = @__refToken_0))
LIMIT 2
2022-09-23 13:52:28.598 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[@__refToken_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE EXISTS (
    SELECT 1
    FROM refresh_token AS r
    WHERE (u.id = r.user_id) AND (r.token = @__refToken_0))
LIMIT 2
2022-09-23 13:52:28.604 +01:00 [DBG] A data reader was disposed.
2022-09-23 13:52:28.605 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 13:52:28.607 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 13:52:28.610 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 13:52:28.611 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2022-09-23 13:52:28.612 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 13:52:28.613 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 13:52:28.617 +01:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.user_id AS "UserId", r.token AS "RefToken", r.expires AS "Expires", r.created AS "Created", r.created_by_ip AS "CreatedByIp", r.revoked AS "Revoked", r.revoked_by_ip AS "RevokedByIp", r.replaced_by_token AS "ReplacedByToken", r.reason_revoked AS "ReasonRevoked", r.is_expired AS "IsExpired", r.is_revoked AS "IsRevoked", r.is_active AS "IsActive"
FROM refresh_token AS r
WHERE r.user_id = @__id_0
2022-09-23 13:52:28.624 +01:00 [INF] Executed DbCommand (7ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.user_id AS "UserId", r.token AS "RefToken", r.expires AS "Expires", r.created AS "Created", r.created_by_ip AS "CreatedByIp", r.revoked AS "Revoked", r.revoked_by_ip AS "RevokedByIp", r.replaced_by_token AS "ReplacedByToken", r.reason_revoked AS "ReasonRevoked", r.is_expired AS "IsExpired", r.is_revoked AS "IsRevoked", r.is_active AS "IsActive"
FROM refresh_token AS r
WHERE r.user_id = @__id_0
2022-09-23 13:52:28.627 +01:00 [DBG] A data reader was disposed.
2022-09-23 13:52:28.630 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 13:52:28.639 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 13:52:28.641 +01:00 [DBG] An entity of type 'User' tracked by 'PostgresContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 13:52:28.644 +01:00 [DBG] SaveChanges starting for 'PostgresContext'.
2022-09-23 13:52:28.645 +01:00 [DBG] DetectChanges starting for 'PostgresContext'.
2022-09-23 13:52:28.647 +01:00 [DBG] DetectChanges completed for 'PostgresContext'.
2022-09-23 13:52:28.648 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 13:52:28.650 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 13:52:28.654 +01:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2022-09-23 13:52:28.657 +01:00 [DBG] Began transaction with isolation level 'ReadCommitted'.
2022-09-23 13:52:28.658 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 13:52:28.660 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2022-09-23 13:52:28.663 +01:00 [DBG] Executing DbCommand [Parameters=[@p6='?' (DbType = Int32), @p0='?' (DbType = DateTime), @p1='?', @p2='?', @p3='?' (DbType = DateTime), @p4='?', @p5='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE users SET created_at = @p0, email = @p1, full_name = @p2, password_changed_at = @p3, password_hash = @p4, username = @p5
WHERE id = @p6;
2022-09-23 13:52:28.665 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[@p6='?' (DbType = Int32), @p0='?' (DbType = DateTime), @p1='?', @p2='?', @p3='?' (DbType = DateTime), @p4='?', @p5='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE users SET created_at = @p0, email = @p1, full_name = @p2, password_changed_at = @p3, password_hash = @p4, username = @p5
WHERE id = @p6;
2022-09-23 13:52:28.670 +01:00 [DBG] A data reader was disposed.
2022-09-23 13:52:28.672 +01:00 [DBG] Committing transaction.
2022-09-23 13:52:28.676 +01:00 [DBG] Committed transaction.
2022-09-23 13:52:28.680 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 13:52:28.681 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 13:52:28.682 +01:00 [DBG] Disposing transaction.
2022-09-23 13:52:28.683 +01:00 [DBG] An entity of type 'User' tracked by 'PostgresContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 13:52:28.686 +01:00 [DBG] SaveChanges completed for 'PostgresContext' with 1 entities written to the database.
2022-09-23 13:52:28.687 +01:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2022-09-23 13:52:28.690 +01:00 [DBG] No information found on request to perform content negotiation.
2022-09-23 13:52:28.691 +01:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2022-09-23 13:52:28.694 +01:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2022-09-23 13:52:28.695 +01:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2022-09-23 13:52:28.696 +01:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType0`1[[System.String, System.Private.CoreLib, Version=6.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2022-09-23 13:52:28.698 +01:00 [INF] Executed action APIBank.Controllers.UsersController.RevokeToken (APIBank) in 137.5891ms
2022-09-23 13:52:28.699 +01:00 [INF] Executed endpoint 'APIBank.Controllers.UsersController.RevokeToken (APIBank)'
2022-09-23 13:52:28.701 +01:00 [DBG] 'PostgresContext' disposed.
2022-09-23 13:52:28.703 +01:00 [INF] Request finished HTTP/2 POST https://localhost:7036/api/Users/revoke-token application/json 20 - 200 - application/json;+charset=utf-8 194.2382ms
2022-09-23 13:52:29.563 +01:00 [DBG] Connection id "0HMKTC78QLDI6" received FIN.
2022-09-23 13:52:29.565 +01:00 [DBG] Connection id "0HMKTC78QLDI6" is closed. The last processed stream ID was 1.
2022-09-23 13:52:29.566 +01:00 [DBG] Connection id "0HMKTC78QLDI6" sending FIN because: "The client closed the connection."
2022-09-23 13:52:29.577 +01:00 [DBG] Connection id "0HMKTC78QLDI6" stopped.
2022-09-23 13:52:34.258 +01:00 [DBG] Connection id "0HMKTC78QLDI7" accepted.
2022-09-23 13:52:34.261 +01:00 [DBG] Connection id "0HMKTC78QLDI7" started.
2022-09-23 13:52:34.265 +01:00 [DBG] Connection 0HMKTC78QLDI7 established using the following protocol: "Tls12"
2022-09-23 13:52:34.268 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/api/Accounts/GetAll - -
2022-09-23 13:52:34.276 +01:00 [DBG] 1 candidate(s) found for the request path '/api/Accounts/GetAll'
2022-09-23 13:52:34.277 +01:00 [DBG] Endpoint 'APIBank.Controllers.AccountsController.GetAllFromUser (APIBank)' with route pattern 'api/Accounts/GetAll' is valid for the request path '/api/Accounts/GetAll'
2022-09-23 13:52:34.278 +01:00 [DBG] Request matched endpoint 'APIBank.Controllers.AccountsController.GetAllFromUser (APIBank)'
2022-09-23 13:52:34.280 +01:00 [DBG] Static files was skipped as the request already matched an endpoint.
2022-09-23 13:52:34.286 +01:00 [INF] Entity Framework Core 6.0.9 initialized 'PostgresContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:6.0.7+5b98e4b74de93b590b44aef8dd7967c03acc433c' with options: None
2022-09-23 13:52:34.291 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 13:52:34.292 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2022-09-23 13:52:34.293 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 13:52:34.294 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 13:52:34.295 +01:00 [DBG] Executing DbCommand [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.id = @__p_0
LIMIT 1
2022-09-23 13:52:34.299 +01:00 [INF] Executed DbCommand (4ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.id = @__p_0
LIMIT 1
2022-09-23 13:52:34.301 +01:00 [DBG] Context 'PostgresContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 13:52:34.303 +01:00 [DBG] A data reader was disposed.
2022-09-23 13:52:34.303 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 13:52:34.306 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 13:52:34.308 +01:00 [INF] Executing endpoint 'APIBank.Controllers.AccountsController.GetAllFromUser (APIBank)'
2022-09-23 13:52:34.309 +01:00 [INF] Route matched with {action = "GetAllFromUser", controller = "Accounts"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult GetAllFromUser() on controller APIBank.Controllers.AccountsController (APIBank).
2022-09-23 13:52:34.310 +01:00 [DBG] Execution plan of authorization filters (in the following order): ["APIBank.Authorization.AuthorizeAttribute"]
2022-09-23 13:52:34.312 +01:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2022-09-23 13:52:34.313 +01:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2022-09-23 13:52:34.316 +01:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2022-09-23 13:52:34.318 +01:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2022-09-23 13:52:34.321 +01:00 [DBG] Executing controller factory for controller APIBank.Controllers.AccountsController (APIBank)
2022-09-23 13:52:34.322 +01:00 [DBG] Executed controller factory for controller APIBank.Controllers.AccountsController (APIBank)
2022-09-23 13:52:34.325 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 13:52:34.326 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2022-09-23 13:52:34.327 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 13:52:34.328 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 13:52:34.329 +01:00 [DBG] Executing DbCommand [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id, r.created, r.created_by_ip, r.expires, r.is_active, r.is_expired, r.is_revoked, r.reason_revoked, r.token, r.replaced_by_token, r.revoked, r.revoked_by_ip, r.user_id
FROM refresh_token AS r
WHERE r.id = @__p_0
LIMIT 1
2022-09-23 13:52:34.334 +01:00 [INF] Executed DbCommand (5ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id, r.created, r.created_by_ip, r.expires, r.is_active, r.is_expired, r.is_revoked, r.reason_revoked, r.token, r.replaced_by_token, r.revoked, r.revoked_by_ip, r.user_id
FROM refresh_token AS r
WHERE r.id = @__p_0
LIMIT 1
2022-09-23 13:52:34.339 +01:00 [DBG] Context 'PostgresContext' started tracking 'RefreshToken' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 13:52:34.341 +01:00 [DBG] A data reader was disposed.
2022-09-23 13:52:34.342 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 13:52:34.343 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 13:52:34.344 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 13:52:34.345 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2022-09-23 13:52:34.346 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 13:52:34.348 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 13:52:34.352 +01:00 [DBG] Executing DbCommand [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a.balance AS "Balance", a.created_at AS "CreatedAt", a.currency AS "Currency", a.id AS "Id"
FROM accounts AS a
WHERE a.user_id = @__userId_0
2022-09-23 13:52:34.355 +01:00 [INF] Executed DbCommand (3ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a.balance AS "Balance", a.created_at AS "CreatedAt", a.currency AS "Currency", a.id AS "Id"
FROM accounts AS a
WHERE a.user_id = @__userId_0
2022-09-23 13:52:34.359 +01:00 [DBG] A data reader was disposed.
2022-09-23 13:52:34.361 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 13:52:34.362 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 13:52:34.363 +01:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2022-09-23 13:52:34.365 +01:00 [DBG] Attempting to select an output formatter based on Accept header '["text/plain"]'.
2022-09-23 13:52:34.368 +01:00 [DBG] Could not find an output formatter based on content negotiation. Accepted types were (["text/plain"])
2022-09-23 13:52:34.369 +01:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2022-09-23 13:52:34.370 +01:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2022-09-23 13:52:34.371 +01:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2022-09-23 13:52:34.372 +01:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[APIBank.Models.Responses.AccountRequestResponse, APIBank, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2022-09-23 13:52:34.373 +01:00 [INF] Executed action APIBank.Controllers.AccountsController.GetAllFromUser (APIBank) in 52.4704ms
2022-09-23 13:52:34.374 +01:00 [INF] Executed endpoint 'APIBank.Controllers.AccountsController.GetAllFromUser (APIBank)'
2022-09-23 13:52:34.375 +01:00 [DBG] 'PostgresContext' disposed.
2022-09-23 13:52:34.376 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/api/Accounts/GetAll - - - 200 - application/json;+charset=utf-8 108.6037ms
2022-09-23 13:52:39.578 +01:00 [DBG] Connection id "0HMKTC78QLDI7" received FIN.
2022-09-23 13:52:39.584 +01:00 [DBG] Connection id "0HMKTC78QLDI7" is closed. The last processed stream ID was 1.
2022-09-23 13:52:39.586 +01:00 [DBG] Connection id "0HMKTC78QLDI7" sending FIN because: "The client closed the connection."
2022-09-23 13:52:39.590 +01:00 [DBG] Connection id "0HMKTC78QLDI7" stopped.
2022-09-23 13:52:51.988 +01:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2022-09-23 13:52:52.274 +01:00 [DBG] Hosting starting
2022-09-23 13:52:52.657 +01:00 [DBG] Using development certificate: CN=localhost (Thumbprint: 9CC642E9838495A6C3C202DECA6A8AD300396DD2)
2022-09-23 13:52:52.744 +01:00 [INF] Now listening on: https://localhost:7036
2022-09-23 13:52:52.746 +01:00 [INF] Now listening on: http://localhost:5036
2022-09-23 13:52:52.748 +01:00 [DBG] Loaded hosting startup assembly APIBank
2022-09-23 13:52:52.749 +01:00 [DBG] Loaded hosting startup assembly Microsoft.AspNetCore.Watch.BrowserRefresh
2022-09-23 13:52:52.750 +01:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.BrowserLink.Net
2022-09-23 13:52:52.751 +01:00 [INF] Application started. Press Ctrl+C to shut down.
2022-09-23 13:52:52.752 +01:00 [INF] Hosting environment: Development
2022-09-23 13:52:52.753 +01:00 [INF] Content root path: C:\Users\mguedesa\OneDrive - NTT DATA EMEAL\Documentos\GitHub\OpenBankAPI-NTT\APIBank\APIBank\
2022-09-23 13:52:52.754 +01:00 [DBG] Hosting started
2022-09-23 13:52:53.136 +01:00 [DBG] Connection id "0HMKTCA3NB5MD" accepted.
2022-09-23 13:52:53.143 +01:00 [DBG] Connection id "0HMKTCA3NB5MD" started.
2022-09-23 13:52:53.144 +01:00 [DBG] Connection id "0HMKTCA3NB5MD" received FIN.
2022-09-23 13:52:53.167 +01:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException:  Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveBlobAsync[TIOAdapter](TIOAdapter adapter)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](TIOAdapter adapter, Boolean receiveFirst, Byte[] reAuthenticationData, Boolean isApm)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2022-09-23 13:52:53.224 +01:00 [DBG] Connection id "0HMKTCA3NB5MD" stopped.
2022-09-23 13:52:53.227 +01:00 [DBG] Connection id "0HMKTCA3NB5MD" sending FIN because: "The Socket transport's send loop completed gracefully."
2022-09-23 13:52:53.489 +01:00 [DBG] Connection id "0HMKTCA3NB5ME" accepted.
2022-09-23 13:52:53.499 +01:00 [DBG] Connection id "0HMKTCA3NB5ME" started.
2022-09-23 13:52:53.593 +01:00 [DBG] Connection 0HMKTCA3NB5ME established using the following protocol: "Tls12"
2022-09-23 13:52:53.680 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/swagger/index.html - -
2022-09-23 13:52:53.779 +01:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2022-09-23 13:52:53.810 +01:00 [DBG] No candidates found for the request path '/swagger/index.html'
2022-09-23 13:52:53.813 +01:00 [DBG] Request did not match any endpoints
2022-09-23 13:52:54.010 +01:00 [DBG] Response markup is scheduled to include browser refresh script injection.
2022-09-23 13:52:54.220 +01:00 [DBG] Response markup was updated to include browser refresh script injection.
2022-09-23 13:52:54.232 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/swagger/index.html - - - 200 - text/html;charset=utf-8 555.0179ms
2022-09-23 13:52:54.262 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/_framework/aspnetcore-browser-refresh.js - -
2022-09-23 13:52:54.268 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/_vs/browserLink - -
2022-09-23 13:52:54.278 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/_framework/aspnetcore-browser-refresh.js - - - 200 11984 application/javascript;+charset=utf-8 15.8088ms
2022-09-23 13:52:54.428 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/_vs/browserLink - - - 200 - text/javascript;+charset=UTF-8 159.8431ms
2022-09-23 13:52:54.582 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/swagger/v1/swagger.json - -
2022-09-23 13:52:54.709 +01:00 [DBG] No candidates found for the request path '/swagger/v1/swagger.json'
2022-09-23 13:52:54.712 +01:00 [DBG] Request did not match any endpoints
2022-09-23 13:52:55.237 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/swagger/v1/swagger.json - - - 200 - application/json;charset=utf-8 654.7199ms
2022-09-23 13:52:59.623 +01:00 [DBG] Connection id "0HMKTCA3NB5ME" received FIN.
2022-09-23 13:52:59.635 +01:00 [DBG] Connection id "0HMKTCA3NB5ME" is closed. The last processed stream ID was 7.
2022-09-23 13:52:59.639 +01:00 [DBG] Connection id "0HMKTCA3NB5ME" sending FIN because: "The client closed the connection."
2022-09-23 13:52:59.654 +01:00 [DBG] Connection id "0HMKTCA3NB5ME" stopped.
2022-09-23 14:06:14.319 +01:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2022-09-23 14:06:14.912 +01:00 [DBG] Hosting starting
2022-09-23 14:06:15.357 +01:00 [DBG] Using development certificate: CN=localhost (Thumbprint: 9CC642E9838495A6C3C202DECA6A8AD300396DD2)
2022-09-23 14:06:15.544 +01:00 [INF] Now listening on: https://localhost:7036
2022-09-23 14:06:15.636 +01:00 [INF] Now listening on: http://localhost:5036
2022-09-23 14:06:15.650 +01:00 [DBG] Loaded hosting startup assembly APIBank
2022-09-23 14:06:15.652 +01:00 [DBG] Loaded hosting startup assembly Microsoft.AspNetCore.Watch.BrowserRefresh
2022-09-23 14:06:15.654 +01:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.BrowserLink.Net
2022-09-23 14:06:15.657 +01:00 [INF] Application started. Press Ctrl+C to shut down.
2022-09-23 14:06:15.660 +01:00 [INF] Hosting environment: Development
2022-09-23 14:06:15.662 +01:00 [INF] Content root path: C:\Users\mguedesa\OneDrive - NTT DATA EMEAL\Documentos\GitHub\OpenBankAPI-NTT\APIBank\APIBank\
2022-09-23 14:06:15.663 +01:00 [DBG] Hosting started
2022-09-23 14:06:15.806 +01:00 [DBG] Connection id "0HMKTCHIU5FRQ" accepted.
2022-09-23 14:06:15.807 +01:00 [DBG] Connection id "0HMKTCHIU5FRQ" received FIN.
2022-09-23 14:06:15.815 +01:00 [DBG] Connection id "0HMKTCHIU5FRQ" started.
2022-09-23 14:06:15.855 +01:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException:  Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveBlobAsync[TIOAdapter](TIOAdapter adapter)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](TIOAdapter adapter, Boolean receiveFirst, Byte[] reAuthenticationData, Boolean isApm)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2022-09-23 14:06:15.957 +01:00 [DBG] Connection id "0HMKTCHIU5FRQ" stopped.
2022-09-23 14:06:15.964 +01:00 [DBG] Connection id "0HMKTCHIU5FRQ" sending FIN because: "The Socket transport's send loop completed gracefully."
2022-09-23 14:06:16.352 +01:00 [DBG] Connection id "0HMKTCHIU5FRR" accepted.
2022-09-23 14:06:16.359 +01:00 [DBG] Connection id "0HMKTCHIU5FRR" started.
2022-09-23 14:06:16.476 +01:00 [DBG] Connection 0HMKTCHIU5FRR established using the following protocol: "Tls12"
2022-09-23 14:06:16.646 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/swagger/index.html - -
2022-09-23 14:06:16.734 +01:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2022-09-23 14:06:16.779 +01:00 [DBG] No candidates found for the request path '/swagger/index.html'
2022-09-23 14:06:16.781 +01:00 [DBG] Request did not match any endpoints
2022-09-23 14:06:16.909 +01:00 [DBG] Response markup is scheduled to include browser refresh script injection.
2022-09-23 14:06:17.106 +01:00 [DBG] Response markup was updated to include browser refresh script injection.
2022-09-23 14:06:17.113 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/swagger/index.html - - - 200 - text/html;charset=utf-8 472.9865ms
2022-09-23 14:06:17.141 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/_framework/aspnetcore-browser-refresh.js - -
2022-09-23 14:06:17.141 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/_vs/browserLink - -
2022-09-23 14:06:17.157 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/_framework/aspnetcore-browser-refresh.js - - - 200 11984 application/javascript;+charset=utf-8 16.3008ms
2022-09-23 14:06:17.210 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/_vs/browserLink - - - 200 - text/javascript;+charset=UTF-8 68.4826ms
2022-09-23 14:06:17.297 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/swagger/v1/swagger.json - -
2022-09-23 14:06:17.305 +01:00 [DBG] No candidates found for the request path '/swagger/v1/swagger.json'
2022-09-23 14:06:17.309 +01:00 [DBG] Request did not match any endpoints
2022-09-23 14:06:17.708 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/swagger/v1/swagger.json - - - 200 - application/json;charset=utf-8 411.1024ms
2022-09-23 14:06:32.755 +01:00 [INF] Request starting HTTP/2 POST https://localhost:7036/api/Users/Login application/json 58
2022-09-23 14:06:32.771 +01:00 [DBG] 1 candidate(s) found for the request path '/api/Users/Login'
2022-09-23 14:06:32.780 +01:00 [DBG] Endpoint 'APIBank.Controllers.UsersController.Login (APIBank)' with route pattern 'api/Users/Login' is valid for the request path '/api/Users/Login'
2022-09-23 14:06:32.783 +01:00 [DBG] Request matched endpoint 'APIBank.Controllers.UsersController.Login (APIBank)'
2022-09-23 14:06:32.787 +01:00 [DBG] Static files was skipped as the request already matched an endpoint.
2022-09-23 14:06:33.299 +01:00 [INF] Executing endpoint 'APIBank.Controllers.UsersController.Login (APIBank)'
2022-09-23 14:06:33.340 +01:00 [INF] Route matched with {action = "Login", controller = "Users"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult Login(APIBank.Models.Requests.UserLoginRequest) on controller APIBank.Controllers.UsersController (APIBank).
2022-09-23 14:06:33.349 +01:00 [DBG] Execution plan of authorization filters (in the following order): ["APIBank.Authorization.AuthorizeAttribute"]
2022-09-23 14:06:33.351 +01:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2022-09-23 14:06:33.353 +01:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2022-09-23 14:06:33.357 +01:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2022-09-23 14:06:33.359 +01:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2022-09-23 14:06:33.366 +01:00 [DBG] Executing controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-23 14:06:33.369 +01:00 [DBG] Executed controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-23 14:06:33.407 +01:00 [DBG] Attempting to bind parameter 'model' of type 'APIBank.Models.Requests.UserLoginRequest' ...
2022-09-23 14:06:33.411 +01:00 [DBG] Attempting to bind parameter 'model' of type 'APIBank.Models.Requests.UserLoginRequest' using the name '' in request data ...
2022-09-23 14:06:33.413 +01:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2022-09-23 14:06:33.426 +01:00 [DBG] Connection id "0HMKTCHIU5FRR", Request id "0HMKTCHIU5FRR:00000009": started reading request body.
2022-09-23 14:06:33.428 +01:00 [DBG] Connection id "0HMKTCHIU5FRR", Request id "0HMKTCHIU5FRR:00000009": done reading request body.
2022-09-23 14:06:33.439 +01:00 [DBG] JSON input formatter succeeded, deserializing to type 'APIBank.Models.Requests.UserLoginRequest'
2022-09-23 14:06:33.440 +01:00 [DBG] Done attempting to bind parameter 'model' of type 'APIBank.Models.Requests.UserLoginRequest'.
2022-09-23 14:06:33.442 +01:00 [DBG] Done attempting to bind parameter 'model' of type 'APIBank.Models.Requests.UserLoginRequest'.
2022-09-23 14:06:33.442 +01:00 [DBG] Attempting to validate the bound parameter 'model' of type 'APIBank.Models.Requests.UserLoginRequest' ...
2022-09-23 14:06:33.456 +01:00 [DBG] Done attempting to validate the bound parameter 'model' of type 'APIBank.Models.Requests.UserLoginRequest'.
2022-09-23 14:06:33.668 +01:00 [DBG] An additional 'IServiceProvider' was created for internal use by Entity Framework. An existing service provider was not used due to the following configuration changes: configuration changed for 'Core:ConfigureWarnings', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:UseAdminDatabase', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:SetPostgresVersion', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:UseRedshift', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:ReverseNullOrdering', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:RemoteCertificateValidationCallback', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:ProvideClientCertificatesCallback', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:ProvidePasswordCallback'.
2022-09-23 14:06:35.595 +01:00 [INF] Entity Framework Core 6.0.9 initialized 'PostgresContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:6.0.7+5b98e4b74de93b590b44aef8dd7967c03acc433c' with options: None
2022-09-23 14:06:35.709 +01:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .SingleOrDefault(x => x.Username == __model_Username_0)'
2022-09-23 14:06:36.360 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<User>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: User.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: User.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 1], [Property: User.Email (string) Required Index MaxLength(254), 2], [Property: User.FullName (string) Required MaxLength(100), 3], [Property: User.PasswordChangedAt (DateTime) Required ValueGenerated.OnAdd, 4], [Property: User.PasswordHash (string) Required MaxLength(200), 5], [Property: User.Username (string) Required Index MaxLength(50), 6] }
        SELECT TOP(2) u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
        FROM users AS u
        WHERE u.username == @__model_Username_0), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, User>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)
    .SingleOrDefault()'
2022-09-23 14:06:36.438 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 14:06:36.578 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (139ms).
2022-09-23 14:06:36.594 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 14:06:37.013 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 14:06:37.039 +01:00 [DBG] Executing DbCommand [Parameters=[@__model_Username_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.username = @__model_Username_0
LIMIT 2
2022-09-23 14:06:37.211 +01:00 [INF] Executed DbCommand (176ms) [Parameters=[@__model_Username_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.username = @__model_Username_0
LIMIT 2
2022-09-23 14:06:37.316 +01:00 [DBG] Context 'PostgresContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 14:06:37.426 +01:00 [DBG] A data reader was disposed.
2022-09-23 14:06:37.433 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 14:06:37.446 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 14:06:37.710 +01:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .Any(user => user.RefreshTokenCollection
        .Any(reftoken => reftoken.RefToken == __token_0))'
2022-09-23 14:06:37.881 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<bool>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            EmptyProjectionMember -> 0
        SELECT EXISTS (
            SELECT 1
            FROM users AS u
            WHERE EXISTS (
                SELECT 1
                FROM refresh_token AS r
                WHERE ((u.id != NULL) && (u.id == r.user_id)) && (r.token == @__token_0)))), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, bool>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)
    .Single()'
2022-09-23 14:06:37.904 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 14:06:37.905 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2022-09-23 14:06:37.906 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 14:06:37.907 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 14:06:37.908 +01:00 [DBG] Executing DbCommand [Parameters=[@__token_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM users AS u
    WHERE EXISTS (
        SELECT 1
        FROM refresh_token AS r
        WHERE (u.id = r.user_id) AND (r.token = @__token_0)))
2022-09-23 14:06:37.912 +01:00 [INF] Executed DbCommand (4ms) [Parameters=[@__token_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM users AS u
    WHERE EXISTS (
        SELECT 1
        FROM refresh_token AS r
        WHERE (u.id = r.user_id) AND (r.token = @__token_0)))
2022-09-23 14:06:37.922 +01:00 [DBG] A data reader was disposed.
2022-09-23 14:06:37.923 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 14:06:37.924 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 14:06:37.928 +01:00 [DBG] SaveChanges starting for 'PostgresContext'.
2022-09-23 14:06:37.933 +01:00 [DBG] DetectChanges starting for 'PostgresContext'.
2022-09-23 14:06:37.987 +01:00 [DBG] 1 entities were added and 0 entities were removed from navigation 'User.RefreshTokenCollection'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 14:06:38.043 +01:00 [DBG] 'PostgresContext' generated a temporary value for the property 'Id.RefreshToken'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 14:06:38.122 +01:00 [DBG] Context 'PostgresContext' started tracking 'RefreshToken' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 14:06:38.128 +01:00 [DBG] DetectChanges completed for 'PostgresContext'.
2022-09-23 14:06:38.142 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 14:06:38.143 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 14:06:38.148 +01:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2022-09-23 14:06:38.160 +01:00 [DBG] Began transaction with isolation level 'ReadCommitted'.
2022-09-23 14:06:38.263 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 14:06:38.264 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2022-09-23 14:06:38.267 +01:00 [DBG] Executing DbCommand [Parameters=[@p0='?' (DbType = DateTime), @p1='?', @p2='?' (DbType = DateTime), @p3='?' (DbType = Boolean), @p4='?' (DbType = Boolean), @p5='?' (DbType = Boolean), @p6='?', @p7='?', @p8='?', @p9='?' (DbType = DateTime), @p10='?', @p11='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO refresh_token (created, created_by_ip, expires, is_active, is_expired, is_revoked, reason_revoked, token, replaced_by_token, revoked, revoked_by_ip, user_id)
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11)
RETURNING id;
2022-09-23 14:06:38.289 +01:00 [INF] Executed DbCommand (22ms) [Parameters=[@p0='?' (DbType = DateTime), @p1='?', @p2='?' (DbType = DateTime), @p3='?' (DbType = Boolean), @p4='?' (DbType = Boolean), @p5='?' (DbType = Boolean), @p6='?', @p7='?', @p8='?', @p9='?' (DbType = DateTime), @p10='?', @p11='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO refresh_token (created, created_by_ip, expires, is_active, is_expired, is_revoked, reason_revoked, token, replaced_by_token, revoked, revoked_by_ip, user_id)
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11)
RETURNING id;
2022-09-23 14:06:38.320 +01:00 [DBG] The foreign key property 'RefreshToken.Id' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2022-09-23 14:06:38.328 +01:00 [DBG] A data reader was disposed.
2022-09-23 14:06:38.334 +01:00 [DBG] Committing transaction.
2022-09-23 14:06:38.353 +01:00 [DBG] Committed transaction.
2022-09-23 14:06:38.355 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 14:06:38.357 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 14:06:38.361 +01:00 [DBG] Disposing transaction.
2022-09-23 14:06:38.383 +01:00 [DBG] An entity of type 'RefreshToken' tracked by 'PostgresContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 14:06:38.390 +01:00 [DBG] SaveChanges completed for 'PostgresContext' with 1 entities written to the database.
2022-09-23 14:06:38.710 +01:00 [DBG] Compiling query expression: 
'DbSet<RefreshToken>()
    .Where(rt => rt.UserId == __id_0)
    .AsNoTracking()
    .Select(rt => new RefreshToken{ 
        Id = rt.Id, 
        UserId = rt.UserId, 
        RefToken = rt.RefToken, 
        Expires = rt.Expires, 
        Created = rt.Created, 
        CreatedByIp = rt.CreatedByIp, 
        Revoked = rt.Revoked, 
        RevokedByIp = rt.RevokedByIp, 
        ReplacedByToken = rt.ReplacedByToken, 
        ReasonRevoked = rt.ReasonRevoked, 
        IsExpired = rt.IsExpired, 
        IsRevoked = rt.IsRevoked, 
        IsActive = rt.IsActive 
    }
    )'
2022-09-23 14:06:38.745 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<RefreshToken>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            Id -> 0
            UserId -> 1
            RefToken -> 2
            Expires -> 3
            Created -> 4
            CreatedByIp -> 5
            Revoked -> 6
            RevokedByIp -> 7
            ReplacedByToken -> 8
            ReasonRevoked -> 9
            IsExpired -> 10
            IsRevoked -> 11
            IsActive -> 12
        SELECT r.id AS Id, r.user_id AS UserId, r.token AS RefToken, r.expires AS Expires, r.created AS Created, r.created_by_ip AS CreatedByIp, r.revoked AS Revoked, r.revoked_by_ip AS RevokedByIp, r.replaced_by_token AS ReplacedByToken, r.reason_revoked AS ReasonRevoked, r.is_expired AS IsExpired, r.is_revoked AS IsRevoked, r.is_active AS IsActive
        FROM refresh_token AS r
        WHERE r.user_id == @__id_0), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, RefreshToken>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)'
2022-09-23 14:06:38.751 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 14:06:38.754 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (3ms).
2022-09-23 14:06:38.757 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 14:06:38.759 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 14:06:38.761 +01:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.user_id AS "UserId", r.token AS "RefToken", r.expires AS "Expires", r.created AS "Created", r.created_by_ip AS "CreatedByIp", r.revoked AS "Revoked", r.revoked_by_ip AS "RevokedByIp", r.replaced_by_token AS "ReplacedByToken", r.reason_revoked AS "ReasonRevoked", r.is_expired AS "IsExpired", r.is_revoked AS "IsRevoked", r.is_active AS "IsActive"
FROM refresh_token AS r
WHERE r.user_id = @__id_0
2022-09-23 14:06:38.764 +01:00 [INF] Executed DbCommand (3ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.user_id AS "UserId", r.token AS "RefToken", r.expires AS "Expires", r.created AS "Created", r.created_by_ip AS "CreatedByIp", r.revoked AS "Revoked", r.revoked_by_ip AS "RevokedByIp", r.replaced_by_token AS "ReplacedByToken", r.reason_revoked AS "ReasonRevoked", r.is_expired AS "IsExpired", r.is_revoked AS "IsRevoked", r.is_active AS "IsActive"
FROM refresh_token AS r
WHERE r.user_id = @__id_0
2022-09-23 14:06:38.770 +01:00 [DBG] A data reader was disposed.
2022-09-23 14:06:38.771 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 14:06:38.772 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 14:06:38.777 +01:00 [DBG] An entity of type 'User' tracked by 'PostgresContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 14:06:38.786 +01:00 [DBG] An entity of type 'RefreshToken' tracked by 'PostgresContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 14:06:38.803 +01:00 [DBG] SaveChanges starting for 'PostgresContext'.
2022-09-23 14:06:38.805 +01:00 [DBG] DetectChanges starting for 'PostgresContext'.
2022-09-23 14:06:38.807 +01:00 [DBG] DetectChanges completed for 'PostgresContext'.
2022-09-23 14:06:38.810 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 14:06:38.817 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 14:06:38.819 +01:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2022-09-23 14:06:38.821 +01:00 [DBG] Began transaction with isolation level 'ReadCommitted'.
2022-09-23 14:06:38.873 +01:00 [DBG] Executing 2 update commands as a batch.
2022-09-23 14:06:38.891 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 14:06:38.892 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2022-09-23 14:06:38.894 +01:00 [DBG] Executing DbCommand [Parameters=[@p12='?' (DbType = Int32), @p0='?' (DbType = DateTime), @p1='?', @p2='?' (DbType = DateTime), @p3='?' (DbType = Boolean), @p4='?' (DbType = Boolean), @p5='?' (DbType = Boolean), @p6='?', @p7='?', @p8='?', @p9='?' (DbType = DateTime), @p10='?', @p11='?' (DbType = Int32), @p19='?' (DbType = Int32), @p13='?' (DbType = DateTime), @p14='?', @p15='?', @p16='?' (DbType = DateTime), @p17='?', @p18='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE refresh_token SET created = @p0, created_by_ip = @p1, expires = @p2, is_active = @p3, is_expired = @p4, is_revoked = @p5, reason_revoked = @p6, token = @p7, replaced_by_token = @p8, revoked = @p9, revoked_by_ip = @p10, user_id = @p11
WHERE id = @p12;
UPDATE users SET created_at = @p13, email = @p14, full_name = @p15, password_changed_at = @p16, password_hash = @p17, username = @p18
WHERE id = @p19;
2022-09-23 14:06:38.902 +01:00 [INF] Executed DbCommand (8ms) [Parameters=[@p12='?' (DbType = Int32), @p0='?' (DbType = DateTime), @p1='?', @p2='?' (DbType = DateTime), @p3='?' (DbType = Boolean), @p4='?' (DbType = Boolean), @p5='?' (DbType = Boolean), @p6='?', @p7='?', @p8='?', @p9='?' (DbType = DateTime), @p10='?', @p11='?' (DbType = Int32), @p19='?' (DbType = Int32), @p13='?' (DbType = DateTime), @p14='?', @p15='?', @p16='?' (DbType = DateTime), @p17='?', @p18='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE refresh_token SET created = @p0, created_by_ip = @p1, expires = @p2, is_active = @p3, is_expired = @p4, is_revoked = @p5, reason_revoked = @p6, token = @p7, replaced_by_token = @p8, revoked = @p9, revoked_by_ip = @p10, user_id = @p11
WHERE id = @p12;
UPDATE users SET created_at = @p13, email = @p14, full_name = @p15, password_changed_at = @p16, password_hash = @p17, username = @p18
WHERE id = @p19;
2022-09-23 14:06:38.905 +01:00 [DBG] A data reader was disposed.
2022-09-23 14:06:38.907 +01:00 [DBG] Committing transaction.
2022-09-23 14:06:38.909 +01:00 [DBG] Committed transaction.
2022-09-23 14:06:38.910 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 14:06:38.912 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 14:06:38.913 +01:00 [DBG] Disposing transaction.
2022-09-23 14:06:38.915 +01:00 [DBG] An entity of type 'User' tracked by 'PostgresContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 14:06:38.917 +01:00 [DBG] An entity of type 'RefreshToken' tracked by 'PostgresContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 14:06:38.918 +01:00 [DBG] SaveChanges completed for 'PostgresContext' with 2 entities written to the database.
2022-09-23 14:06:38.927 +01:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2022-09-23 14:06:38.934 +01:00 [DBG] Attempting to select an output formatter based on Accept header '["text/plain"]'.
2022-09-23 14:06:38.936 +01:00 [DBG] Could not find an output formatter based on content negotiation. Accepted types were (["text/plain"])
2022-09-23 14:06:38.939 +01:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2022-09-23 14:06:38.940 +01:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2022-09-23 14:06:38.942 +01:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2022-09-23 14:06:38.943 +01:00 [INF] Executing OkObjectResult, writing value of type 'APIBank.Models.MyRequestResponses.LoginResponse'.
2022-09-23 14:06:38.968 +01:00 [INF] Executed action APIBank.Controllers.UsersController.Login (APIBank) in 5597.3825ms
2022-09-23 14:06:38.971 +01:00 [INF] Executed endpoint 'APIBank.Controllers.UsersController.Login (APIBank)'
2022-09-23 14:06:38.981 +01:00 [DBG] 'PostgresContext' disposed.
2022-09-23 14:06:38.991 +01:00 [INF] Request finished HTTP/2 POST https://localhost:7036/api/Users/Login application/json 58 - 200 - application/json;+charset=utf-8 6236.2286ms
2022-09-23 14:06:53.776 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/api/Accounts/GetAll - -
2022-09-23 14:06:53.781 +01:00 [DBG] 1 candidate(s) found for the request path '/api/Accounts/GetAll'
2022-09-23 14:06:53.783 +01:00 [DBG] Endpoint 'APIBank.Controllers.AccountsController.GetAllFromUser (APIBank)' with route pattern 'api/Accounts/GetAll' is valid for the request path '/api/Accounts/GetAll'
2022-09-23 14:06:53.785 +01:00 [DBG] Request matched endpoint 'APIBank.Controllers.AccountsController.GetAllFromUser (APIBank)'
2022-09-23 14:06:53.788 +01:00 [DBG] Static files was skipped as the request already matched an endpoint.
2022-09-23 14:06:53.989 +01:00 [INF] Entity Framework Core 6.0.9 initialized 'PostgresContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:6.0.7+5b98e4b74de93b590b44aef8dd7967c03acc433c' with options: None
2022-09-23 14:06:54.020 +01:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .FirstOrDefault(e => EF.Property<int>(e, "Id") == __p_0)'
2022-09-23 14:06:54.027 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<User>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: User.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: User.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 1], [Property: User.Email (string) Required Index MaxLength(254), 2], [Property: User.FullName (string) Required MaxLength(100), 3], [Property: User.PasswordChangedAt (DateTime) Required ValueGenerated.OnAdd, 4], [Property: User.PasswordHash (string) Required MaxLength(200), 5], [Property: User.Username (string) Required Index MaxLength(50), 6] }
        SELECT TOP(1) u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
        FROM users AS u
        WHERE u.id == @__p_0), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, User>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)
    .SingleOrDefault()'
2022-09-23 14:06:54.030 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 14:06:54.031 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2022-09-23 14:06:54.032 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 14:06:54.033 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 14:06:54.034 +01:00 [DBG] Executing DbCommand [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.id = @__p_0
LIMIT 1
2022-09-23 14:06:54.039 +01:00 [INF] Executed DbCommand (5ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.id = @__p_0
LIMIT 1
2022-09-23 14:06:54.042 +01:00 [DBG] Context 'PostgresContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 14:06:54.044 +01:00 [DBG] A data reader was disposed.
2022-09-23 14:06:54.045 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 14:06:54.046 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 14:06:54.048 +01:00 [INF] Executing endpoint 'APIBank.Controllers.AccountsController.GetAllFromUser (APIBank)'
2022-09-23 14:06:54.052 +01:00 [INF] Route matched with {action = "GetAllFromUser", controller = "Accounts"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult GetAllFromUser() on controller APIBank.Controllers.AccountsController (APIBank).
2022-09-23 14:06:54.055 +01:00 [DBG] Execution plan of authorization filters (in the following order): ["APIBank.Authorization.AuthorizeAttribute"]
2022-09-23 14:06:54.056 +01:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2022-09-23 14:06:54.059 +01:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2022-09-23 14:06:54.062 +01:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2022-09-23 14:06:54.064 +01:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2022-09-23 14:06:54.065 +01:00 [DBG] Executing controller factory for controller APIBank.Controllers.AccountsController (APIBank)
2022-09-23 14:06:54.068 +01:00 [DBG] Executed controller factory for controller APIBank.Controllers.AccountsController (APIBank)
2022-09-23 14:06:54.079 +01:00 [DBG] Compiling query expression: 
'DbSet<RefreshToken>()
    .FirstOrDefault(e => EF.Property<int>(e, "Id") == __p_0)'
2022-09-23 14:06:54.088 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<RefreshToken>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: RefreshToken.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: RefreshToken.Created (DateTime) Required, 1], [Property: RefreshToken.CreatedByIp (string) Required MaxLength(200), 2], [Property: RefreshToken.Expires (DateTime) Required, 3], [Property: RefreshToken.IsActive (no field, bool) Required, 4], [Property: RefreshToken.IsExpired (no field, bool) Required, 5], [Property: RefreshToken.IsRevoked (no field, bool) Required, 6], [Property: RefreshToken.ReasonRevoked (string) MaxLength(200), 7], [Property: RefreshToken.RefToken (string) Required MaxLength(254), 8], [Property: RefreshToken.ReplacedByToken (string) MaxLength(200), 9], [Property: RefreshToken.Revoked (DateTime?), 10], [Property: RefreshToken.RevokedByIp (string) MaxLength(200), 11], [Property: RefreshToken.UserId (int) Required FK Index, 12] }
        SELECT TOP(1) r.id, r.created, r.created_by_ip, r.expires, r.is_active, r.is_expired, r.is_revoked, r.reason_revoked, r.token, r.replaced_by_token, r.revoked, r.revoked_by_ip, r.user_id
        FROM refresh_token AS r
        WHERE r.id == @__p_0), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, RefreshToken>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)
    .SingleOrDefault()'
2022-09-23 14:06:54.095 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 14:06:54.096 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2022-09-23 14:06:54.098 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 14:06:54.099 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 14:06:54.103 +01:00 [DBG] Executing DbCommand [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id, r.created, r.created_by_ip, r.expires, r.is_active, r.is_expired, r.is_revoked, r.reason_revoked, r.token, r.replaced_by_token, r.revoked, r.revoked_by_ip, r.user_id
FROM refresh_token AS r
WHERE r.id = @__p_0
LIMIT 1
2022-09-23 14:06:54.106 +01:00 [INF] Executed DbCommand (4ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id, r.created, r.created_by_ip, r.expires, r.is_active, r.is_expired, r.is_revoked, r.reason_revoked, r.token, r.replaced_by_token, r.revoked, r.revoked_by_ip, r.user_id
FROM refresh_token AS r
WHERE r.id = @__p_0
LIMIT 1
2022-09-23 14:06:54.109 +01:00 [DBG] Context 'PostgresContext' started tracking 'RefreshToken' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 14:06:54.111 +01:00 [DBG] A data reader was disposed.
2022-09-23 14:06:54.112 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 14:06:54.113 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 14:06:54.116 +01:00 [DBG] Compiling query expression: 
'DbSet<Account>()
    .Where(u => u.UserId == __userId_0)
    .Select(u => new AccountRequestResponse{ 
        Balance = u.Balance, 
        CreatedAt = u.CreatedAt, 
        Currency = u.Currency, 
        Id = u.Id 
    }
    )'
2022-09-23 14:06:54.127 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<AccountRequestResponse>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            Balance -> 0
            CreatedAt -> 1
            Currency -> 2
            Id -> 3
        SELECT a.balance AS Balance, a.created_at AS CreatedAt, a.currency AS Currency, a.id AS Id
        FROM accounts AS a
        WHERE a.user_id == @__userId_0), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, AccountRequestResponse>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)'
2022-09-23 14:06:54.130 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 14:06:54.131 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2022-09-23 14:06:54.132 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 14:06:54.133 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 14:06:54.134 +01:00 [DBG] Executing DbCommand [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a.balance AS "Balance", a.created_at AS "CreatedAt", a.currency AS "Currency", a.id AS "Id"
FROM accounts AS a
WHERE a.user_id = @__userId_0
2022-09-23 14:06:54.141 +01:00 [INF] Executed DbCommand (8ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a.balance AS "Balance", a.created_at AS "CreatedAt", a.currency AS "Currency", a.id AS "Id"
FROM accounts AS a
WHERE a.user_id = @__userId_0
2022-09-23 14:06:54.159 +01:00 [DBG] A data reader was disposed.
2022-09-23 14:06:54.160 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 14:06:54.162 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 14:06:54.164 +01:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2022-09-23 14:06:54.167 +01:00 [DBG] Attempting to select an output formatter based on Accept header '["text/plain"]'.
2022-09-23 14:06:54.170 +01:00 [DBG] Could not find an output formatter based on content negotiation. Accepted types were (["text/plain"])
2022-09-23 14:06:54.172 +01:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2022-09-23 14:06:54.173 +01:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2022-09-23 14:06:54.173 +01:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2022-09-23 14:06:54.174 +01:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[APIBank.Models.Responses.AccountRequestResponse, APIBank, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2022-09-23 14:06:54.183 +01:00 [INF] Executed action APIBank.Controllers.AccountsController.GetAllFromUser (APIBank) in 118.1135ms
2022-09-23 14:06:54.187 +01:00 [INF] Executed endpoint 'APIBank.Controllers.AccountsController.GetAllFromUser (APIBank)'
2022-09-23 14:06:54.189 +01:00 [DBG] 'PostgresContext' disposed.
2022-09-23 14:06:54.190 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/api/Accounts/GetAll - - - 200 - application/json;+charset=utf-8 414.0489ms
2022-09-23 14:07:03.362 +01:00 [INF] Request starting HTTP/2 POST https://localhost:7036/api/Users/revoke-token application/json 20
2022-09-23 14:07:03.369 +01:00 [DBG] 1 candidate(s) found for the request path '/api/Users/revoke-token'
2022-09-23 14:07:03.371 +01:00 [DBG] Endpoint 'APIBank.Controllers.UsersController.RevokeToken (APIBank)' with route pattern 'api/Users/revoke-token' is valid for the request path '/api/Users/revoke-token'
2022-09-23 14:07:03.373 +01:00 [DBG] Request matched endpoint 'APIBank.Controllers.UsersController.RevokeToken (APIBank)'
2022-09-23 14:07:03.374 +01:00 [DBG] Static files was skipped as the request already matched an endpoint.
2022-09-23 14:07:03.469 +01:00 [INF] Entity Framework Core 6.0.9 initialized 'PostgresContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:6.0.7+5b98e4b74de93b590b44aef8dd7967c03acc433c' with options: None
2022-09-23 14:07:03.482 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 14:07:03.485 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (2ms).
2022-09-23 14:07:03.486 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 14:07:03.487 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 14:07:03.488 +01:00 [DBG] Executing DbCommand [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.id = @__p_0
LIMIT 1
2022-09-23 14:07:03.490 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.id = @__p_0
LIMIT 1
2022-09-23 14:07:03.492 +01:00 [DBG] Context 'PostgresContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 14:07:03.498 +01:00 [DBG] A data reader was disposed.
2022-09-23 14:07:03.498 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 14:07:03.500 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 14:07:03.501 +01:00 [INF] Executing endpoint 'APIBank.Controllers.UsersController.RevokeToken (APIBank)'
2022-09-23 14:07:03.503 +01:00 [INF] Route matched with {action = "RevokeToken", controller = "Users"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult RevokeToken(APIBank.Models.MyRequestResponses.UserRevokeTokenRequest) on controller APIBank.Controllers.UsersController (APIBank).
2022-09-23 14:07:03.505 +01:00 [DBG] Execution plan of authorization filters (in the following order): ["APIBank.Authorization.AuthorizeAttribute"]
2022-09-23 14:07:03.506 +01:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2022-09-23 14:07:03.507 +01:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2022-09-23 14:07:03.510 +01:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2022-09-23 14:07:03.511 +01:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2022-09-23 14:07:03.513 +01:00 [DBG] Executing controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-23 14:07:03.514 +01:00 [DBG] Executed controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-23 14:07:03.516 +01:00 [DBG] Attempting to bind parameter 'model' of type 'APIBank.Models.MyRequestResponses.UserRevokeTokenRequest' ...
2022-09-23 14:07:03.518 +01:00 [DBG] Attempting to bind parameter 'model' of type 'APIBank.Models.MyRequestResponses.UserRevokeTokenRequest' using the name '' in request data ...
2022-09-23 14:07:03.519 +01:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2022-09-23 14:07:03.521 +01:00 [DBG] Connection id "0HMKTCHIU5FRR", Request id "0HMKTCHIU5FRR:0000000D": started reading request body.
2022-09-23 14:07:03.522 +01:00 [DBG] Connection id "0HMKTCHIU5FRR", Request id "0HMKTCHIU5FRR:0000000D": done reading request body.
2022-09-23 14:07:03.525 +01:00 [DBG] JSON input formatter succeeded, deserializing to type 'APIBank.Models.MyRequestResponses.UserRevokeTokenRequest'
2022-09-23 14:07:03.526 +01:00 [DBG] Done attempting to bind parameter 'model' of type 'APIBank.Models.MyRequestResponses.UserRevokeTokenRequest'.
2022-09-23 14:07:03.528 +01:00 [DBG] Done attempting to bind parameter 'model' of type 'APIBank.Models.MyRequestResponses.UserRevokeTokenRequest'.
2022-09-23 14:07:03.530 +01:00 [DBG] Attempting to validate the bound parameter 'model' of type 'APIBank.Models.MyRequestResponses.UserRevokeTokenRequest' ...
2022-09-23 14:07:03.532 +01:00 [DBG] Done attempting to validate the bound parameter 'model' of type 'APIBank.Models.MyRequestResponses.UserRevokeTokenRequest'.
2022-09-23 14:07:03.535 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 14:07:03.536 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2022-09-23 14:07:03.538 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 14:07:03.540 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 14:07:03.541 +01:00 [DBG] Executing DbCommand [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id, r.created, r.created_by_ip, r.expires, r.is_active, r.is_expired, r.is_revoked, r.reason_revoked, r.token, r.replaced_by_token, r.revoked, r.revoked_by_ip, r.user_id
FROM refresh_token AS r
WHERE r.id = @__p_0
LIMIT 1
2022-09-23 14:07:03.544 +01:00 [INF] Executed DbCommand (3ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id, r.created, r.created_by_ip, r.expires, r.is_active, r.is_expired, r.is_revoked, r.reason_revoked, r.token, r.replaced_by_token, r.revoked, r.revoked_by_ip, r.user_id
FROM refresh_token AS r
WHERE r.id = @__p_0
LIMIT 1
2022-09-23 14:07:03.547 +01:00 [DBG] Context 'PostgresContext' started tracking 'RefreshToken' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 14:07:03.549 +01:00 [DBG] A data reader was disposed.
2022-09-23 14:07:03.549 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 14:07:03.550 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 14:07:03.558 +01:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .SingleOrDefault(userQuery => userQuery.RefreshTokenCollection
        .Any(refTokenQuery => refTokenQuery.RefToken == __refToken_0))'
2022-09-23 14:07:03.565 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<User>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: User.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: User.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 1], [Property: User.Email (string) Required Index MaxLength(254), 2], [Property: User.FullName (string) Required MaxLength(100), 3], [Property: User.PasswordChangedAt (DateTime) Required ValueGenerated.OnAdd, 4], [Property: User.PasswordHash (string) Required MaxLength(200), 5], [Property: User.Username (string) Required Index MaxLength(50), 6] }
        SELECT TOP(2) u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
        FROM users AS u
        WHERE EXISTS (
            SELECT 1
            FROM refresh_token AS r
            WHERE ((u.id != NULL) && (u.id == r.user_id)) && (r.token == @__refToken_0))), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, User>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)
    .SingleOrDefault()'
2022-09-23 14:07:03.568 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 14:07:03.570 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (2ms).
2022-09-23 14:07:03.572 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 14:07:03.573 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 14:07:03.574 +01:00 [DBG] Executing DbCommand [Parameters=[@__refToken_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE EXISTS (
    SELECT 1
    FROM refresh_token AS r
    WHERE (u.id = r.user_id) AND (r.token = @__refToken_0))
LIMIT 2
2022-09-23 14:07:03.576 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[@__refToken_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE EXISTS (
    SELECT 1
    FROM refresh_token AS r
    WHERE (u.id = r.user_id) AND (r.token = @__refToken_0))
LIMIT 2
2022-09-23 14:07:03.580 +01:00 [DBG] A data reader was disposed.
2022-09-23 14:07:03.580 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 14:07:03.581 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 14:07:03.586 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 14:07:03.587 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2022-09-23 14:07:03.588 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 14:07:03.589 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 14:07:03.590 +01:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.user_id AS "UserId", r.token AS "RefToken", r.expires AS "Expires", r.created AS "Created", r.created_by_ip AS "CreatedByIp", r.revoked AS "Revoked", r.revoked_by_ip AS "RevokedByIp", r.replaced_by_token AS "ReplacedByToken", r.reason_revoked AS "ReasonRevoked", r.is_expired AS "IsExpired", r.is_revoked AS "IsRevoked", r.is_active AS "IsActive"
FROM refresh_token AS r
WHERE r.user_id = @__id_0
2022-09-23 14:07:03.593 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.user_id AS "UserId", r.token AS "RefToken", r.expires AS "Expires", r.created AS "Created", r.created_by_ip AS "CreatedByIp", r.revoked AS "Revoked", r.revoked_by_ip AS "RevokedByIp", r.replaced_by_token AS "ReplacedByToken", r.reason_revoked AS "ReasonRevoked", r.is_expired AS "IsExpired", r.is_revoked AS "IsRevoked", r.is_active AS "IsActive"
FROM refresh_token AS r
WHERE r.user_id = @__id_0
2022-09-23 14:07:03.597 +01:00 [DBG] A data reader was disposed.
2022-09-23 14:07:03.598 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 14:07:03.600 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 14:07:03.604 +01:00 [DBG] An entity of type 'User' tracked by 'PostgresContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 14:08:58.456 +01:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2022-09-23 14:08:59.459 +01:00 [DBG] Hosting starting
2022-09-23 14:08:59.860 +01:00 [DBG] Using development certificate: CN=localhost (Thumbprint: 9CC642E9838495A6C3C202DECA6A8AD300396DD2)
2022-09-23 14:08:59.955 +01:00 [INF] Now listening on: https://localhost:7036
2022-09-23 14:08:59.967 +01:00 [INF] Now listening on: http://localhost:5036
2022-09-23 14:08:59.974 +01:00 [DBG] Loaded hosting startup assembly APIBank
2022-09-23 14:08:59.976 +01:00 [DBG] Loaded hosting startup assembly Microsoft.AspNetCore.Watch.BrowserRefresh
2022-09-23 14:08:59.977 +01:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.BrowserLink.Net
2022-09-23 14:08:59.979 +01:00 [INF] Application started. Press Ctrl+C to shut down.
2022-09-23 14:08:59.982 +01:00 [INF] Hosting environment: Development
2022-09-23 14:08:59.982 +01:00 [INF] Content root path: C:\Users\mguedesa\OneDrive - NTT DATA EMEAL\Documentos\GitHub\OpenBankAPI-NTT\APIBank\APIBank\
2022-09-23 14:08:59.983 +01:00 [DBG] Hosting started
2022-09-23 14:09:00.258 +01:00 [DBG] Connection id "0HMKTCJ3UHOD2" received FIN.
2022-09-23 14:09:00.258 +01:00 [DBG] Connection id "0HMKTCJ3UHOD1" received FIN.
2022-09-23 14:09:00.289 +01:00 [DBG] Connection id "0HMKTCJ3UHOD2" accepted.
2022-09-23 14:09:00.293 +01:00 [DBG] Connection id "0HMKTCJ3UHOD1" accepted.
2022-09-23 14:09:00.299 +01:00 [DBG] Connection id "0HMKTCJ3UHOD2" started.
2022-09-23 14:09:00.407 +01:00 [DBG] Connection id "0HMKTCJ3UHOD1" started.
2022-09-23 14:09:00.510 +01:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException:  Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveBlobAsync[TIOAdapter](TIOAdapter adapter)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](TIOAdapter adapter, Boolean receiveFirst, Byte[] reAuthenticationData, Boolean isApm)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2022-09-23 14:09:00.510 +01:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException:  Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveBlobAsync[TIOAdapter](TIOAdapter adapter)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](TIOAdapter adapter, Boolean receiveFirst, Byte[] reAuthenticationData, Boolean isApm)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2022-09-23 14:09:00.840 +01:00 [DBG] Connection id "0HMKTCJ3UHOD2" stopped.
2022-09-23 14:09:00.850 +01:00 [DBG] Connection id "0HMKTCJ3UHOD1" stopped.
2022-09-23 14:09:00.878 +01:00 [DBG] Connection id "0HMKTCJ3UHOD3" accepted.
2022-09-23 14:09:01.054 +01:00 [DBG] Connection id "0HMKTCJ3UHOD1" sending FIN because: "The Socket transport's send loop completed gracefully."
2022-09-23 14:09:01.054 +01:00 [DBG] Connection id "0HMKTCJ3UHOD2" sending FIN because: "The Socket transport's send loop completed gracefully."
2022-09-23 14:09:01.059 +01:00 [DBG] Connection id "0HMKTCJ3UHOD3" started.
2022-09-23 14:09:01.155 +01:00 [DBG] Connection 0HMKTCJ3UHOD3 established using the following protocol: "Tls12"
2022-09-23 14:09:01.273 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/swagger/index.html - -
2022-09-23 14:09:01.337 +01:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2022-09-23 14:09:01.370 +01:00 [DBG] No candidates found for the request path '/swagger/index.html'
2022-09-23 14:09:01.371 +01:00 [DBG] Request did not match any endpoints
2022-09-23 14:09:01.553 +01:00 [DBG] Response markup is scheduled to include browser refresh script injection.
2022-09-23 14:09:01.772 +01:00 [DBG] Response markup was updated to include browser refresh script injection.
2022-09-23 14:09:01.785 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/swagger/index.html - - - 200 - text/html;charset=utf-8 520.5986ms
2022-09-23 14:09:01.807 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/_framework/aspnetcore-browser-refresh.js - -
2022-09-23 14:09:01.831 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/_vs/browserLink - -
2022-09-23 14:09:01.834 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/_framework/aspnetcore-browser-refresh.js - - - 200 11984 application/javascript;+charset=utf-8 26.6899ms
2022-09-23 14:09:01.876 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/_vs/browserLink - - - 200 - text/javascript;+charset=UTF-8 44.7008ms
2022-09-23 14:09:01.969 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/swagger/v1/swagger.json - -
2022-09-23 14:09:01.971 +01:00 [DBG] No candidates found for the request path '/swagger/v1/swagger.json'
2022-09-23 14:09:01.973 +01:00 [DBG] Request did not match any endpoints
2022-09-23 14:09:02.570 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/swagger/v1/swagger.json - - - 200 - application/json;charset=utf-8 601.3105ms
2022-09-23 14:09:11.000 +01:00 [DBG] Connection id "0HMKTCJ3UHOD3" received FIN.
2022-09-23 14:09:11.009 +01:00 [DBG] Connection id "0HMKTCJ3UHOD3" is closed. The last processed stream ID was 7.
2022-09-23 14:09:11.012 +01:00 [DBG] Connection id "0HMKTCJ3UHOD3" sending FIN because: "The client closed the connection."
2022-09-23 14:09:11.031 +01:00 [DBG] Connection id "0HMKTCJ3UHOD3" stopped.
2022-09-23 14:09:18.350 +01:00 [DBG] Connection id "0HMKTCJ3UHOD4" accepted.
2022-09-23 14:09:18.353 +01:00 [DBG] Connection id "0HMKTCJ3UHOD4" started.
2022-09-23 14:09:18.365 +01:00 [DBG] Connection 0HMKTCJ3UHOD4 established using the following protocol: "Tls12"
2022-09-23 14:09:18.374 +01:00 [INF] Request starting HTTP/2 POST https://localhost:7036/api/Users/Login application/json 58
2022-09-23 14:09:18.384 +01:00 [DBG] 1 candidate(s) found for the request path '/api/Users/Login'
2022-09-23 14:09:18.391 +01:00 [DBG] Endpoint 'APIBank.Controllers.UsersController.Login (APIBank)' with route pattern 'api/Users/Login' is valid for the request path '/api/Users/Login'
2022-09-23 14:09:18.394 +01:00 [DBG] Request matched endpoint 'APIBank.Controllers.UsersController.Login (APIBank)'
2022-09-23 14:09:18.397 +01:00 [DBG] Static files was skipped as the request already matched an endpoint.
2022-09-23 14:09:19.009 +01:00 [INF] Executing endpoint 'APIBank.Controllers.UsersController.Login (APIBank)'
2022-09-23 14:09:19.057 +01:00 [INF] Route matched with {action = "Login", controller = "Users"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult Login(APIBank.Models.Requests.UserLoginRequest) on controller APIBank.Controllers.UsersController (APIBank).
2022-09-23 14:09:19.061 +01:00 [DBG] Execution plan of authorization filters (in the following order): ["APIBank.Authorization.AuthorizeAttribute"]
2022-09-23 14:09:19.066 +01:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2022-09-23 14:09:19.070 +01:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2022-09-23 14:09:19.073 +01:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2022-09-23 14:09:19.075 +01:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2022-09-23 14:09:19.083 +01:00 [DBG] Executing controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-23 14:09:19.085 +01:00 [DBG] Executed controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-23 14:09:19.113 +01:00 [DBG] Attempting to bind parameter 'model' of type 'APIBank.Models.Requests.UserLoginRequest' ...
2022-09-23 14:09:19.121 +01:00 [DBG] Attempting to bind parameter 'model' of type 'APIBank.Models.Requests.UserLoginRequest' using the name '' in request data ...
2022-09-23 14:09:19.123 +01:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2022-09-23 14:09:19.136 +01:00 [DBG] Connection id "0HMKTCJ3UHOD4", Request id "0HMKTCJ3UHOD4:00000001": started reading request body.
2022-09-23 14:09:19.139 +01:00 [DBG] Connection id "0HMKTCJ3UHOD4", Request id "0HMKTCJ3UHOD4:00000001": done reading request body.
2022-09-23 14:09:19.151 +01:00 [DBG] JSON input formatter succeeded, deserializing to type 'APIBank.Models.Requests.UserLoginRequest'
2022-09-23 14:09:19.153 +01:00 [DBG] Done attempting to bind parameter 'model' of type 'APIBank.Models.Requests.UserLoginRequest'.
2022-09-23 14:09:19.154 +01:00 [DBG] Done attempting to bind parameter 'model' of type 'APIBank.Models.Requests.UserLoginRequest'.
2022-09-23 14:09:19.158 +01:00 [DBG] Attempting to validate the bound parameter 'model' of type 'APIBank.Models.Requests.UserLoginRequest' ...
2022-09-23 14:09:19.175 +01:00 [DBG] Done attempting to validate the bound parameter 'model' of type 'APIBank.Models.Requests.UserLoginRequest'.
2022-09-23 14:09:19.357 +01:00 [DBG] An additional 'IServiceProvider' was created for internal use by Entity Framework. An existing service provider was not used due to the following configuration changes: configuration changed for 'Core:ConfigureWarnings', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:UseAdminDatabase', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:SetPostgresVersion', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:UseRedshift', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:ReverseNullOrdering', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:RemoteCertificateValidationCallback', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:ProvideClientCertificatesCallback', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:ProvidePasswordCallback'.
2022-09-23 14:09:21.312 +01:00 [INF] Entity Framework Core 6.0.9 initialized 'PostgresContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:6.0.7+5b98e4b74de93b590b44aef8dd7967c03acc433c' with options: None
2022-09-23 14:09:21.399 +01:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .SingleOrDefault(x => x.Username == __model_Username_0)'
2022-09-23 14:09:22.030 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<User>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: User.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: User.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 1], [Property: User.Email (string) Required Index MaxLength(254), 2], [Property: User.FullName (string) Required MaxLength(100), 3], [Property: User.PasswordChangedAt (DateTime) Required ValueGenerated.OnAdd, 4], [Property: User.PasswordHash (string) Required MaxLength(200), 5], [Property: User.Username (string) Required Index MaxLength(50), 6] }
        SELECT TOP(2) u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
        FROM users AS u
        WHERE u.username == @__model_Username_0), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, User>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)
    .SingleOrDefault()'
2022-09-23 14:09:22.118 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 14:09:22.252 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (136ms).
2022-09-23 14:09:22.274 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 14:09:22.627 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 14:09:22.656 +01:00 [DBG] Executing DbCommand [Parameters=[@__model_Username_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.username = @__model_Username_0
LIMIT 2
2022-09-23 14:09:22.832 +01:00 [INF] Executed DbCommand (185ms) [Parameters=[@__model_Username_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.username = @__model_Username_0
LIMIT 2
2022-09-23 14:09:22.926 +01:00 [DBG] Context 'PostgresContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 14:09:23.009 +01:00 [DBG] A data reader was disposed.
2022-09-23 14:09:23.018 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 14:09:23.034 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 14:09:23.290 +01:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .Any(user => user.RefreshTokenCollection
        .Any(reftoken => reftoken.RefToken == __token_0))'
2022-09-23 14:09:23.474 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<bool>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            EmptyProjectionMember -> 0
        SELECT EXISTS (
            SELECT 1
            FROM users AS u
            WHERE EXISTS (
                SELECT 1
                FROM refresh_token AS r
                WHERE ((u.id != NULL) && (u.id == r.user_id)) && (r.token == @__token_0)))), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, bool>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)
    .Single()'
2022-09-23 14:09:23.500 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 14:09:23.501 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2022-09-23 14:09:23.506 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 14:09:23.508 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 14:09:23.511 +01:00 [DBG] Executing DbCommand [Parameters=[@__token_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM users AS u
    WHERE EXISTS (
        SELECT 1
        FROM refresh_token AS r
        WHERE (u.id = r.user_id) AND (r.token = @__token_0)))
2022-09-23 14:09:23.516 +01:00 [INF] Executed DbCommand (5ms) [Parameters=[@__token_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM users AS u
    WHERE EXISTS (
        SELECT 1
        FROM refresh_token AS r
        WHERE (u.id = r.user_id) AND (r.token = @__token_0)))
2022-09-23 14:09:23.526 +01:00 [DBG] A data reader was disposed.
2022-09-23 14:09:23.529 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 14:09:23.532 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 14:09:23.539 +01:00 [DBG] SaveChanges starting for 'PostgresContext'.
2022-09-23 14:09:23.544 +01:00 [DBG] DetectChanges starting for 'PostgresContext'.
2022-09-23 14:09:23.591 +01:00 [DBG] 1 entities were added and 0 entities were removed from navigation 'User.RefreshTokenCollection'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 14:09:23.650 +01:00 [DBG] 'PostgresContext' generated a temporary value for the property 'Id.RefreshToken'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 14:09:23.748 +01:00 [DBG] Context 'PostgresContext' started tracking 'RefreshToken' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 14:09:23.756 +01:00 [DBG] DetectChanges completed for 'PostgresContext'.
2022-09-23 14:09:23.777 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 14:09:23.779 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 14:09:23.785 +01:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2022-09-23 14:09:23.801 +01:00 [DBG] Began transaction with isolation level 'ReadCommitted'.
2022-09-23 14:09:23.891 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 14:09:23.893 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2022-09-23 14:09:23.898 +01:00 [DBG] Executing DbCommand [Parameters=[@p0='?' (DbType = DateTime), @p1='?', @p2='?' (DbType = DateTime), @p3='?' (DbType = Boolean), @p4='?' (DbType = Boolean), @p5='?' (DbType = Boolean), @p6='?', @p7='?', @p8='?', @p9='?' (DbType = DateTime), @p10='?', @p11='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO refresh_token (created, created_by_ip, expires, is_active, is_expired, is_revoked, reason_revoked, token, replaced_by_token, revoked, revoked_by_ip, user_id)
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11)
RETURNING id;
2022-09-23 14:09:23.930 +01:00 [INF] Executed DbCommand (32ms) [Parameters=[@p0='?' (DbType = DateTime), @p1='?', @p2='?' (DbType = DateTime), @p3='?' (DbType = Boolean), @p4='?' (DbType = Boolean), @p5='?' (DbType = Boolean), @p6='?', @p7='?', @p8='?', @p9='?' (DbType = DateTime), @p10='?', @p11='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO refresh_token (created, created_by_ip, expires, is_active, is_expired, is_revoked, reason_revoked, token, replaced_by_token, revoked, revoked_by_ip, user_id)
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11)
RETURNING id;
2022-09-23 14:09:23.974 +01:00 [DBG] The foreign key property 'RefreshToken.Id' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2022-09-23 14:09:23.986 +01:00 [DBG] A data reader was disposed.
2022-09-23 14:09:23.996 +01:00 [DBG] Committing transaction.
2022-09-23 14:09:24.023 +01:00 [DBG] Committed transaction.
2022-09-23 14:09:24.026 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 14:09:24.029 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 14:09:24.032 +01:00 [DBG] Disposing transaction.
2022-09-23 14:09:24.047 +01:00 [DBG] An entity of type 'RefreshToken' tracked by 'PostgresContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 14:09:24.053 +01:00 [DBG] SaveChanges completed for 'PostgresContext' with 1 entities written to the database.
2022-09-23 14:09:24.431 +01:00 [DBG] Compiling query expression: 
'DbSet<RefreshToken>()
    .Where(rt => rt.UserId == __id_0)
    .AsNoTracking()
    .Select(rt => new RefreshToken{ 
        Id = rt.Id, 
        UserId = rt.UserId, 
        RefToken = rt.RefToken, 
        Expires = rt.Expires, 
        Created = rt.Created, 
        CreatedByIp = rt.CreatedByIp, 
        Revoked = rt.Revoked, 
        RevokedByIp = rt.RevokedByIp, 
        ReplacedByToken = rt.ReplacedByToken, 
        ReasonRevoked = rt.ReasonRevoked, 
        IsExpired = rt.IsExpired, 
        IsRevoked = rt.IsRevoked, 
        IsActive = rt.IsActive 
    }
    )'
2022-09-23 14:09:24.473 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<RefreshToken>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            Id -> 0
            UserId -> 1
            RefToken -> 2
            Expires -> 3
            Created -> 4
            CreatedByIp -> 5
            Revoked -> 6
            RevokedByIp -> 7
            ReplacedByToken -> 8
            ReasonRevoked -> 9
            IsExpired -> 10
            IsRevoked -> 11
            IsActive -> 12
        SELECT r.id AS Id, r.user_id AS UserId, r.token AS RefToken, r.expires AS Expires, r.created AS Created, r.created_by_ip AS CreatedByIp, r.revoked AS Revoked, r.revoked_by_ip AS RevokedByIp, r.replaced_by_token AS ReplacedByToken, r.reason_revoked AS ReasonRevoked, r.is_expired AS IsExpired, r.is_revoked AS IsRevoked, r.is_active AS IsActive
        FROM refresh_token AS r
        WHERE r.user_id == @__id_0), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, RefreshToken>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)'
2022-09-23 14:09:24.478 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 14:09:24.480 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (2ms).
2022-09-23 14:09:24.482 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 14:09:24.483 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 14:09:24.486 +01:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.user_id AS "UserId", r.token AS "RefToken", r.expires AS "Expires", r.created AS "Created", r.created_by_ip AS "CreatedByIp", r.revoked AS "Revoked", r.revoked_by_ip AS "RevokedByIp", r.replaced_by_token AS "ReplacedByToken", r.reason_revoked AS "ReasonRevoked", r.is_expired AS "IsExpired", r.is_revoked AS "IsRevoked", r.is_active AS "IsActive"
FROM refresh_token AS r
WHERE r.user_id = @__id_0
2022-09-23 14:09:24.490 +01:00 [INF] Executed DbCommand (4ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.user_id AS "UserId", r.token AS "RefToken", r.expires AS "Expires", r.created AS "Created", r.created_by_ip AS "CreatedByIp", r.revoked AS "Revoked", r.revoked_by_ip AS "RevokedByIp", r.replaced_by_token AS "ReplacedByToken", r.reason_revoked AS "ReasonRevoked", r.is_expired AS "IsExpired", r.is_revoked AS "IsRevoked", r.is_active AS "IsActive"
FROM refresh_token AS r
WHERE r.user_id = @__id_0
2022-09-23 14:09:24.497 +01:00 [DBG] A data reader was disposed.
2022-09-23 14:09:24.498 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 14:09:24.500 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 14:09:24.504 +01:00 [DBG] An entity of type 'User' tracked by 'PostgresContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 14:09:24.507 +01:00 [DBG] An entity of type 'RefreshToken' tracked by 'PostgresContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 14:09:24.508 +01:00 [DBG] SaveChanges starting for 'PostgresContext'.
2022-09-23 14:09:24.509 +01:00 [DBG] DetectChanges starting for 'PostgresContext'.
2022-09-23 14:09:24.512 +01:00 [DBG] DetectChanges completed for 'PostgresContext'.
2022-09-23 14:09:24.514 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 14:09:24.517 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 14:09:24.519 +01:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2022-09-23 14:09:24.520 +01:00 [DBG] Began transaction with isolation level 'ReadCommitted'.
2022-09-23 14:09:24.566 +01:00 [DBG] Executing 2 update commands as a batch.
2022-09-23 14:09:24.580 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 14:09:24.582 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2022-09-23 14:09:24.585 +01:00 [DBG] Executing DbCommand [Parameters=[@p12='?' (DbType = Int32), @p0='?' (DbType = DateTime), @p1='?', @p2='?' (DbType = DateTime), @p3='?' (DbType = Boolean), @p4='?' (DbType = Boolean), @p5='?' (DbType = Boolean), @p6='?', @p7='?', @p8='?', @p9='?' (DbType = DateTime), @p10='?', @p11='?' (DbType = Int32), @p19='?' (DbType = Int32), @p13='?' (DbType = DateTime), @p14='?', @p15='?', @p16='?' (DbType = DateTime), @p17='?', @p18='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE refresh_token SET created = @p0, created_by_ip = @p1, expires = @p2, is_active = @p3, is_expired = @p4, is_revoked = @p5, reason_revoked = @p6, token = @p7, replaced_by_token = @p8, revoked = @p9, revoked_by_ip = @p10, user_id = @p11
WHERE id = @p12;
UPDATE users SET created_at = @p13, email = @p14, full_name = @p15, password_changed_at = @p16, password_hash = @p17, username = @p18
WHERE id = @p19;
2022-09-23 14:09:24.593 +01:00 [INF] Executed DbCommand (8ms) [Parameters=[@p12='?' (DbType = Int32), @p0='?' (DbType = DateTime), @p1='?', @p2='?' (DbType = DateTime), @p3='?' (DbType = Boolean), @p4='?' (DbType = Boolean), @p5='?' (DbType = Boolean), @p6='?', @p7='?', @p8='?', @p9='?' (DbType = DateTime), @p10='?', @p11='?' (DbType = Int32), @p19='?' (DbType = Int32), @p13='?' (DbType = DateTime), @p14='?', @p15='?', @p16='?' (DbType = DateTime), @p17='?', @p18='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE refresh_token SET created = @p0, created_by_ip = @p1, expires = @p2, is_active = @p3, is_expired = @p4, is_revoked = @p5, reason_revoked = @p6, token = @p7, replaced_by_token = @p8, revoked = @p9, revoked_by_ip = @p10, user_id = @p11
WHERE id = @p12;
UPDATE users SET created_at = @p13, email = @p14, full_name = @p15, password_changed_at = @p16, password_hash = @p17, username = @p18
WHERE id = @p19;
2022-09-23 14:09:24.598 +01:00 [DBG] A data reader was disposed.
2022-09-23 14:09:24.599 +01:00 [DBG] Committing transaction.
2022-09-23 14:09:24.600 +01:00 [DBG] Committed transaction.
2022-09-23 14:09:24.601 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 14:09:24.602 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 14:09:24.603 +01:00 [DBG] Disposing transaction.
2022-09-23 14:09:24.604 +01:00 [DBG] An entity of type 'User' tracked by 'PostgresContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 14:09:24.606 +01:00 [DBG] An entity of type 'RefreshToken' tracked by 'PostgresContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 14:09:24.614 +01:00 [DBG] SaveChanges completed for 'PostgresContext' with 2 entities written to the database.
2022-09-23 14:09:24.625 +01:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2022-09-23 14:09:24.635 +01:00 [DBG] Attempting to select an output formatter based on Accept header '["text/plain"]'.
2022-09-23 14:09:24.637 +01:00 [DBG] Could not find an output formatter based on content negotiation. Accepted types were (["text/plain"])
2022-09-23 14:09:24.638 +01:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2022-09-23 14:09:24.646 +01:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2022-09-23 14:09:24.651 +01:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2022-09-23 14:09:24.654 +01:00 [INF] Executing OkObjectResult, writing value of type 'APIBank.Models.MyRequestResponses.LoginResponse'.
2022-09-23 14:09:24.688 +01:00 [INF] Executed action APIBank.Controllers.UsersController.Login (APIBank) in 5598.6443ms
2022-09-23 14:09:24.690 +01:00 [INF] Executed endpoint 'APIBank.Controllers.UsersController.Login (APIBank)'
2022-09-23 14:09:24.702 +01:00 [DBG] 'PostgresContext' disposed.
2022-09-23 14:09:24.718 +01:00 [INF] Request finished HTTP/2 POST https://localhost:7036/api/Users/Login application/json 58 - 200 - application/json;+charset=utf-8 6344.0554ms
2022-09-23 14:09:31.035 +01:00 [DBG] Connection id "0HMKTCJ3UHOD4" received FIN.
2022-09-23 14:09:31.039 +01:00 [DBG] Connection id "0HMKTCJ3UHOD4" is closed. The last processed stream ID was 1.
2022-09-23 14:09:31.040 +01:00 [DBG] Connection id "0HMKTCJ3UHOD4" sending FIN because: "The client closed the connection."
2022-09-23 14:09:31.050 +01:00 [DBG] Connection id "0HMKTCJ3UHOD4" stopped.
2022-09-23 14:09:46.656 +01:00 [DBG] Connection id "0HMKTCJ3UHOD5" accepted.
2022-09-23 14:09:46.660 +01:00 [DBG] Connection id "0HMKTCJ3UHOD5" started.
2022-09-23 14:09:46.663 +01:00 [DBG] Connection 0HMKTCJ3UHOD5 established using the following protocol: "Tls12"
2022-09-23 14:09:46.665 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/api/Accounts/GetAll - -
2022-09-23 14:09:46.669 +01:00 [DBG] 1 candidate(s) found for the request path '/api/Accounts/GetAll'
2022-09-23 14:09:46.670 +01:00 [DBG] Endpoint 'APIBank.Controllers.AccountsController.GetAllFromUser (APIBank)' with route pattern 'api/Accounts/GetAll' is valid for the request path '/api/Accounts/GetAll'
2022-09-23 14:09:46.672 +01:00 [DBG] Request matched endpoint 'APIBank.Controllers.AccountsController.GetAllFromUser (APIBank)'
2022-09-23 14:09:46.673 +01:00 [DBG] Static files was skipped as the request already matched an endpoint.
2022-09-23 14:09:46.823 +01:00 [INF] Entity Framework Core 6.0.9 initialized 'PostgresContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:6.0.7+5b98e4b74de93b590b44aef8dd7967c03acc433c' with options: None
2022-09-23 14:09:46.848 +01:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .FirstOrDefault(e => EF.Property<int>(e, "Id") == __p_0)'
2022-09-23 14:09:46.855 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<User>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: User.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: User.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 1], [Property: User.Email (string) Required Index MaxLength(254), 2], [Property: User.FullName (string) Required MaxLength(100), 3], [Property: User.PasswordChangedAt (DateTime) Required ValueGenerated.OnAdd, 4], [Property: User.PasswordHash (string) Required MaxLength(200), 5], [Property: User.Username (string) Required Index MaxLength(50), 6] }
        SELECT TOP(1) u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
        FROM users AS u
        WHERE u.id == @__p_0), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, User>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)
    .SingleOrDefault()'
2022-09-23 14:09:46.857 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 14:09:46.858 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2022-09-23 14:09:46.859 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 14:09:46.860 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 14:09:46.862 +01:00 [DBG] Executing DbCommand [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.id = @__p_0
LIMIT 1
2022-09-23 14:09:46.865 +01:00 [INF] Executed DbCommand (3ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.id = @__p_0
LIMIT 1
2022-09-23 14:09:46.870 +01:00 [DBG] Context 'PostgresContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 14:09:46.871 +01:00 [DBG] A data reader was disposed.
2022-09-23 14:09:46.871 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 14:09:46.872 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 14:09:46.873 +01:00 [INF] Executing endpoint 'APIBank.Controllers.AccountsController.GetAllFromUser (APIBank)'
2022-09-23 14:09:46.877 +01:00 [INF] Route matched with {action = "GetAllFromUser", controller = "Accounts"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult GetAllFromUser() on controller APIBank.Controllers.AccountsController (APIBank).
2022-09-23 14:09:46.880 +01:00 [DBG] Execution plan of authorization filters (in the following order): ["APIBank.Authorization.AuthorizeAttribute"]
2022-09-23 14:09:46.882 +01:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2022-09-23 14:09:46.886 +01:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2022-09-23 14:09:46.887 +01:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2022-09-23 14:09:46.888 +01:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2022-09-23 14:09:46.890 +01:00 [DBG] Executing controller factory for controller APIBank.Controllers.AccountsController (APIBank)
2022-09-23 14:09:46.892 +01:00 [DBG] Executed controller factory for controller APIBank.Controllers.AccountsController (APIBank)
2022-09-23 14:09:46.900 +01:00 [DBG] Compiling query expression: 
'DbSet<RefreshToken>()
    .FirstOrDefault(e => EF.Property<int>(e, "Id") == __p_0)'
2022-09-23 14:09:46.906 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<RefreshToken>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: RefreshToken.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: RefreshToken.Created (DateTime) Required, 1], [Property: RefreshToken.CreatedByIp (string) Required MaxLength(200), 2], [Property: RefreshToken.Expires (DateTime) Required, 3], [Property: RefreshToken.IsActive (no field, bool) Required, 4], [Property: RefreshToken.IsExpired (no field, bool) Required, 5], [Property: RefreshToken.IsRevoked (no field, bool) Required, 6], [Property: RefreshToken.ReasonRevoked (string) MaxLength(200), 7], [Property: RefreshToken.RefToken (string) Required MaxLength(254), 8], [Property: RefreshToken.ReplacedByToken (string) MaxLength(200), 9], [Property: RefreshToken.Revoked (DateTime?), 10], [Property: RefreshToken.RevokedByIp (string) MaxLength(200), 11], [Property: RefreshToken.UserId (int) Required FK Index, 12] }
        SELECT TOP(1) r.id, r.created, r.created_by_ip, r.expires, r.is_active, r.is_expired, r.is_revoked, r.reason_revoked, r.token, r.replaced_by_token, r.revoked, r.revoked_by_ip, r.user_id
        FROM refresh_token AS r
        WHERE r.id == @__p_0), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, RefreshToken>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)
    .SingleOrDefault()'
2022-09-23 14:09:46.909 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 14:09:46.910 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2022-09-23 14:09:46.912 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 14:09:46.914 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 14:09:46.918 +01:00 [DBG] Executing DbCommand [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id, r.created, r.created_by_ip, r.expires, r.is_active, r.is_expired, r.is_revoked, r.reason_revoked, r.token, r.replaced_by_token, r.revoked, r.revoked_by_ip, r.user_id
FROM refresh_token AS r
WHERE r.id = @__p_0
LIMIT 1
2022-09-23 14:09:46.920 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id, r.created, r.created_by_ip, r.expires, r.is_active, r.is_expired, r.is_revoked, r.reason_revoked, r.token, r.replaced_by_token, r.revoked, r.revoked_by_ip, r.user_id
FROM refresh_token AS r
WHERE r.id = @__p_0
LIMIT 1
2022-09-23 14:09:46.922 +01:00 [DBG] Context 'PostgresContext' started tracking 'RefreshToken' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 14:09:46.925 +01:00 [DBG] A data reader was disposed.
2022-09-23 14:09:46.926 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 14:09:46.927 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 14:09:46.933 +01:00 [DBG] Compiling query expression: 
'DbSet<Account>()
    .Where(u => u.UserId == __userId_0)
    .Select(u => new AccountRequestResponse{ 
        Balance = u.Balance, 
        CreatedAt = u.CreatedAt, 
        Currency = u.Currency, 
        Id = u.Id 
    }
    )'
2022-09-23 14:09:46.937 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<AccountRequestResponse>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            Balance -> 0
            CreatedAt -> 1
            Currency -> 2
            Id -> 3
        SELECT a.balance AS Balance, a.created_at AS CreatedAt, a.currency AS Currency, a.id AS Id
        FROM accounts AS a
        WHERE a.user_id == @__userId_0), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, AccountRequestResponse>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)'
2022-09-23 14:09:46.941 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 14:09:46.942 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2022-09-23 14:09:46.944 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 14:09:46.946 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 14:09:46.949 +01:00 [DBG] Executing DbCommand [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a.balance AS "Balance", a.created_at AS "CreatedAt", a.currency AS "Currency", a.id AS "Id"
FROM accounts AS a
WHERE a.user_id = @__userId_0
2022-09-23 14:09:46.954 +01:00 [INF] Executed DbCommand (6ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a.balance AS "Balance", a.created_at AS "CreatedAt", a.currency AS "Currency", a.id AS "Id"
FROM accounts AS a
WHERE a.user_id = @__userId_0
2022-09-23 14:09:46.972 +01:00 [DBG] A data reader was disposed.
2022-09-23 14:09:46.973 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 14:09:46.976 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 14:09:46.978 +01:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2022-09-23 14:09:46.981 +01:00 [DBG] Attempting to select an output formatter based on Accept header '["text/plain"]'.
2022-09-23 14:09:46.982 +01:00 [DBG] Could not find an output formatter based on content negotiation. Accepted types were (["text/plain"])
2022-09-23 14:09:46.983 +01:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2022-09-23 14:09:46.984 +01:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2022-09-23 14:09:46.984 +01:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2022-09-23 14:09:46.985 +01:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[APIBank.Models.Responses.AccountRequestResponse, APIBank, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2022-09-23 14:09:46.997 +01:00 [INF] Executed action APIBank.Controllers.AccountsController.GetAllFromUser (APIBank) in 107.4462ms
2022-09-23 14:09:46.998 +01:00 [INF] Executed endpoint 'APIBank.Controllers.AccountsController.GetAllFromUser (APIBank)'
2022-09-23 14:09:47.000 +01:00 [DBG] 'PostgresContext' disposed.
2022-09-23 14:09:47.001 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/api/Accounts/GetAll - - - 200 - application/json;+charset=utf-8 336.0005ms
2022-09-23 14:09:51.050 +01:00 [DBG] Connection id "0HMKTCJ3UHOD5" received FIN.
2022-09-23 14:09:51.053 +01:00 [DBG] Connection id "0HMKTCJ3UHOD5" is closed. The last processed stream ID was 1.
2022-09-23 14:09:51.056 +01:00 [DBG] Connection id "0HMKTCJ3UHOD5" sending FIN because: "The client closed the connection."
2022-09-23 14:09:51.064 +01:00 [DBG] Connection id "0HMKTCJ3UHOD5" stopped.
2022-09-23 14:09:53.949 +01:00 [DBG] Connection id "0HMKTCJ3UHOD6" accepted.
2022-09-23 14:09:53.956 +01:00 [DBG] Connection id "0HMKTCJ3UHOD6" started.
2022-09-23 14:09:53.972 +01:00 [DBG] Connection 0HMKTCJ3UHOD6 established using the following protocol: "Tls12"
2022-09-23 14:09:53.975 +01:00 [INF] Request starting HTTP/2 POST https://localhost:7036/api/Users/revoke-token application/json 20
2022-09-23 14:09:53.979 +01:00 [DBG] 1 candidate(s) found for the request path '/api/Users/revoke-token'
2022-09-23 14:09:53.980 +01:00 [DBG] Endpoint 'APIBank.Controllers.UsersController.RevokeToken (APIBank)' with route pattern 'api/Users/revoke-token' is valid for the request path '/api/Users/revoke-token'
2022-09-23 14:09:53.982 +01:00 [DBG] Request matched endpoint 'APIBank.Controllers.UsersController.RevokeToken (APIBank)'
2022-09-23 14:09:53.984 +01:00 [DBG] Static files was skipped as the request already matched an endpoint.
2022-09-23 14:09:54.075 +01:00 [INF] Entity Framework Core 6.0.9 initialized 'PostgresContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:6.0.7+5b98e4b74de93b590b44aef8dd7967c03acc433c' with options: None
2022-09-23 14:09:54.086 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 14:09:54.088 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (2ms).
2022-09-23 14:09:54.090 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 14:09:54.091 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 14:09:54.092 +01:00 [DBG] Executing DbCommand [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.id = @__p_0
LIMIT 1
2022-09-23 14:09:54.094 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.id = @__p_0
LIMIT 1
2022-09-23 14:09:54.097 +01:00 [DBG] Context 'PostgresContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 14:09:54.101 +01:00 [DBG] A data reader was disposed.
2022-09-23 14:09:54.103 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 14:09:54.105 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 14:09:54.106 +01:00 [INF] Executing endpoint 'APIBank.Controllers.UsersController.RevokeToken (APIBank)'
2022-09-23 14:09:54.109 +01:00 [INF] Route matched with {action = "RevokeToken", controller = "Users"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult RevokeToken(APIBank.Models.MyRequestResponses.UserRevokeTokenRequest) on controller APIBank.Controllers.UsersController (APIBank).
2022-09-23 14:09:54.110 +01:00 [DBG] Execution plan of authorization filters (in the following order): ["APIBank.Authorization.AuthorizeAttribute"]
2022-09-23 14:09:54.112 +01:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2022-09-23 14:09:54.115 +01:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2022-09-23 14:09:54.117 +01:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2022-09-23 14:09:54.122 +01:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2022-09-23 14:09:54.124 +01:00 [DBG] Executing controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-23 14:09:54.125 +01:00 [DBG] Executed controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-23 14:09:54.127 +01:00 [DBG] Attempting to bind parameter 'model' of type 'APIBank.Models.MyRequestResponses.UserRevokeTokenRequest' ...
2022-09-23 14:09:54.129 +01:00 [DBG] Attempting to bind parameter 'model' of type 'APIBank.Models.MyRequestResponses.UserRevokeTokenRequest' using the name '' in request data ...
2022-09-23 14:09:54.132 +01:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2022-09-23 14:09:54.134 +01:00 [DBG] Connection id "0HMKTCJ3UHOD6", Request id "0HMKTCJ3UHOD6:00000001": started reading request body.
2022-09-23 14:09:54.139 +01:00 [DBG] Connection id "0HMKTCJ3UHOD6", Request id "0HMKTCJ3UHOD6:00000001": done reading request body.
2022-09-23 14:09:54.141 +01:00 [DBG] JSON input formatter succeeded, deserializing to type 'APIBank.Models.MyRequestResponses.UserRevokeTokenRequest'
2022-09-23 14:09:54.143 +01:00 [DBG] Done attempting to bind parameter 'model' of type 'APIBank.Models.MyRequestResponses.UserRevokeTokenRequest'.
2022-09-23 14:09:54.144 +01:00 [DBG] Done attempting to bind parameter 'model' of type 'APIBank.Models.MyRequestResponses.UserRevokeTokenRequest'.
2022-09-23 14:09:54.148 +01:00 [DBG] Attempting to validate the bound parameter 'model' of type 'APIBank.Models.MyRequestResponses.UserRevokeTokenRequest' ...
2022-09-23 14:09:54.151 +01:00 [DBG] Done attempting to validate the bound parameter 'model' of type 'APIBank.Models.MyRequestResponses.UserRevokeTokenRequest'.
2022-09-23 14:09:54.156 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 14:09:54.158 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2022-09-23 14:09:54.159 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 14:09:54.160 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 14:09:54.163 +01:00 [DBG] Executing DbCommand [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id, r.created, r.created_by_ip, r.expires, r.is_active, r.is_expired, r.is_revoked, r.reason_revoked, r.token, r.replaced_by_token, r.revoked, r.revoked_by_ip, r.user_id
FROM refresh_token AS r
WHERE r.id = @__p_0
LIMIT 1
2022-09-23 14:09:54.165 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id, r.created, r.created_by_ip, r.expires, r.is_active, r.is_expired, r.is_revoked, r.reason_revoked, r.token, r.replaced_by_token, r.revoked, r.revoked_by_ip, r.user_id
FROM refresh_token AS r
WHERE r.id = @__p_0
LIMIT 1
2022-09-23 14:09:54.168 +01:00 [DBG] Context 'PostgresContext' started tracking 'RefreshToken' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 14:09:54.174 +01:00 [DBG] A data reader was disposed.
2022-09-23 14:09:54.179 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 14:09:54.181 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 14:10:03.121 +01:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .SingleOrDefault(userQuery => userQuery.RefreshTokenCollection
        .Any(refTokenQuery => refTokenQuery.RefToken == __refToken_0))'
2022-09-23 14:10:03.134 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<User>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: User.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: User.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 1], [Property: User.Email (string) Required Index MaxLength(254), 2], [Property: User.FullName (string) Required MaxLength(100), 3], [Property: User.PasswordChangedAt (DateTime) Required ValueGenerated.OnAdd, 4], [Property: User.PasswordHash (string) Required MaxLength(200), 5], [Property: User.Username (string) Required Index MaxLength(50), 6] }
        SELECT TOP(2) u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
        FROM users AS u
        WHERE EXISTS (
            SELECT 1
            FROM refresh_token AS r
            WHERE ((u.id != NULL) && (u.id == r.user_id)) && (r.token == @__refToken_0))), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, User>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)
    .SingleOrDefault()'
2022-09-23 14:10:03.136 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 14:10:03.138 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (2ms).
2022-09-23 14:10:03.139 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 14:10:03.140 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 14:10:03.141 +01:00 [DBG] Executing DbCommand [Parameters=[@__refToken_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE EXISTS (
    SELECT 1
    FROM refresh_token AS r
    WHERE (u.id = r.user_id) AND (r.token = @__refToken_0))
LIMIT 2
2022-09-23 14:10:03.145 +01:00 [INF] Executed DbCommand (4ms) [Parameters=[@__refToken_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE EXISTS (
    SELECT 1
    FROM refresh_token AS r
    WHERE (u.id = r.user_id) AND (r.token = @__refToken_0))
LIMIT 2
2022-09-23 14:10:03.148 +01:00 [DBG] A data reader was disposed.
2022-09-23 14:10:03.149 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 14:10:03.151 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 14:10:05.567 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 14:10:05.570 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (2ms).
2022-09-23 14:10:05.572 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 14:10:05.573 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 14:10:05.575 +01:00 [DBG] Executing DbCommand [Parameters=[@__refToken_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE EXISTS (
    SELECT 1
    FROM refresh_token AS r
    WHERE (u.id = r.user_id) AND (r.token = @__refToken_0))
LIMIT 2
2022-09-23 14:10:05.580 +01:00 [INF] Executed DbCommand (5ms) [Parameters=[@__refToken_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE EXISTS (
    SELECT 1
    FROM refresh_token AS r
    WHERE (u.id = r.user_id) AND (r.token = @__refToken_0))
LIMIT 2
2022-09-23 14:10:05.583 +01:00 [DBG] A data reader was disposed.
2022-09-23 14:10:05.584 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 14:10:05.585 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 14:10:19.438 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 14:10:19.440 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (2ms).
2022-09-23 14:10:19.443 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 14:10:19.446 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 14:10:19.449 +01:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.user_id AS "UserId", r.token AS "RefToken", r.expires AS "Expires", r.created AS "Created", r.created_by_ip AS "CreatedByIp", r.revoked AS "Revoked", r.revoked_by_ip AS "RevokedByIp", r.replaced_by_token AS "ReplacedByToken", r.reason_revoked AS "ReasonRevoked", r.is_expired AS "IsExpired", r.is_revoked AS "IsRevoked", r.is_active AS "IsActive"
FROM refresh_token AS r
WHERE r.user_id = @__id_0
2022-09-23 14:10:19.452 +01:00 [INF] Executed DbCommand (3ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.user_id AS "UserId", r.token AS "RefToken", r.expires AS "Expires", r.created AS "Created", r.created_by_ip AS "CreatedByIp", r.revoked AS "Revoked", r.revoked_by_ip AS "RevokedByIp", r.replaced_by_token AS "ReplacedByToken", r.reason_revoked AS "ReasonRevoked", r.is_expired AS "IsExpired", r.is_revoked AS "IsRevoked", r.is_active AS "IsActive"
FROM refresh_token AS r
WHERE r.user_id = @__id_0
2022-09-23 14:10:19.489 +01:00 [DBG] A data reader was disposed.
2022-09-23 14:10:19.491 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 14:10:19.494 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 14:11:43.138 +01:00 [DBG] An entity of type 'User' tracked by 'PostgresContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 14:12:00.525 +01:00 [DBG] SaveChanges starting for 'PostgresContext'.
2022-09-23 14:12:00.528 +01:00 [DBG] DetectChanges starting for 'PostgresContext'.
2022-09-23 14:12:00.553 +01:00 [DBG] DetectChanges completed for 'PostgresContext'.
2022-09-23 14:12:00.555 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 14:12:00.556 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 14:12:00.558 +01:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2022-09-23 14:12:00.559 +01:00 [DBG] Began transaction with isolation level 'ReadCommitted'.
2022-09-23 14:12:00.560 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 14:12:00.561 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2022-09-23 14:12:00.562 +01:00 [DBG] Executing DbCommand [Parameters=[@p6='?' (DbType = Int32), @p0='?' (DbType = DateTime), @p1='?', @p2='?', @p3='?' (DbType = DateTime), @p4='?', @p5='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE users SET created_at = @p0, email = @p1, full_name = @p2, password_changed_at = @p3, password_hash = @p4, username = @p5
WHERE id = @p6;
2022-09-23 14:12:00.569 +01:00 [INF] Executed DbCommand (7ms) [Parameters=[@p6='?' (DbType = Int32), @p0='?' (DbType = DateTime), @p1='?', @p2='?', @p3='?' (DbType = DateTime), @p4='?', @p5='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE users SET created_at = @p0, email = @p1, full_name = @p2, password_changed_at = @p3, password_hash = @p4, username = @p5
WHERE id = @p6;
2022-09-23 14:12:00.572 +01:00 [DBG] A data reader was disposed.
2022-09-23 14:12:00.572 +01:00 [DBG] Committing transaction.
2022-09-23 14:12:00.574 +01:00 [DBG] Committed transaction.
2022-09-23 14:12:00.575 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 14:12:00.576 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 14:12:00.577 +01:00 [DBG] Disposing transaction.
2022-09-23 14:12:00.578 +01:00 [DBG] An entity of type 'User' tracked by 'PostgresContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 14:12:00.581 +01:00 [DBG] SaveChanges completed for 'PostgresContext' with 1 entities written to the database.
2022-09-23 14:12:39.883 +01:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2022-09-23 14:12:39.888 +01:00 [DBG] No information found on request to perform content negotiation.
2022-09-23 14:12:39.889 +01:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2022-09-23 14:12:39.890 +01:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2022-09-23 14:12:39.891 +01:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2022-09-23 14:12:39.892 +01:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType0`1[[System.String, System.Private.CoreLib, Version=6.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2022-09-23 14:12:39.935 +01:00 [INF] Executed action APIBank.Controllers.UsersController.RevokeToken (APIBank) in 165804.8948ms
2022-09-23 14:12:39.943 +01:00 [INF] Executed endpoint 'APIBank.Controllers.UsersController.RevokeToken (APIBank)'
2022-09-23 14:12:44.141 +01:00 [DBG] 'PostgresContext' disposed.
2022-09-23 14:12:44.144 +01:00 [INF] Request finished HTTP/2 POST https://localhost:7036/api/Users/revoke-token application/json 20 - 200 - application/json;+charset=utf-8 170162.4106ms
2022-09-23 14:12:46.306 +01:00 [DBG] Connection id "0HMKTCJ3UHOD6" received FIN.
2022-09-23 14:12:46.309 +01:00 [DBG] Connection id "0HMKTCJ3UHOD6" is closed. The last processed stream ID was 1.
2022-09-23 14:12:46.325 +01:00 [DBG] Connection id "0HMKTCJ3UHOD6" sending FIN because: "The client closed the connection."
2022-09-23 14:12:46.336 +01:00 [DBG] Connection id "0HMKTCJ3UHOD6" stopped.
2022-09-23 14:13:01.899 +01:00 [DBG] Connection id "0HMKTCJ3UHOD7" accepted.
2022-09-23 14:13:01.901 +01:00 [DBG] Connection id "0HMKTCJ3UHOD7" started.
2022-09-23 14:13:01.911 +01:00 [DBG] Connection 0HMKTCJ3UHOD7 established using the following protocol: "Tls12"
2022-09-23 14:13:01.914 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/api/Users/1/refresh-tokens - -
2022-09-23 14:13:01.917 +01:00 [DBG] 1 candidate(s) found for the request path '/api/Users/1/refresh-tokens'
2022-09-23 14:13:01.918 +01:00 [DBG] Endpoint 'APIBank.Controllers.UsersController.GetRefreshTokens (APIBank)' with route pattern 'api/Users/{id}/refresh-tokens' is valid for the request path '/api/Users/1/refresh-tokens'
2022-09-23 14:13:01.921 +01:00 [DBG] Request matched endpoint 'APIBank.Controllers.UsersController.GetRefreshTokens (APIBank)'
2022-09-23 14:13:01.922 +01:00 [DBG] Static files was skipped as the request already matched an endpoint.
2022-09-23 14:13:01.924 +01:00 [INF] Entity Framework Core 6.0.9 initialized 'PostgresContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:6.0.7+5b98e4b74de93b590b44aef8dd7967c03acc433c' with options: None
2022-09-23 14:13:01.926 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 14:13:01.927 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2022-09-23 14:13:01.930 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 14:13:01.932 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 14:13:01.933 +01:00 [DBG] Executing DbCommand [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.id = @__p_0
LIMIT 1
2022-09-23 14:13:01.937 +01:00 [INF] Executed DbCommand (4ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.id = @__p_0
LIMIT 1
2022-09-23 14:13:01.939 +01:00 [DBG] Context 'PostgresContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 14:13:01.940 +01:00 [DBG] A data reader was disposed.
2022-09-23 14:13:01.941 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 14:13:01.942 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 14:13:01.943 +01:00 [INF] Executing endpoint 'APIBank.Controllers.UsersController.GetRefreshTokens (APIBank)'
2022-09-23 14:13:01.947 +01:00 [INF] Route matched with {action = "GetRefreshTokens", controller = "Users"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult GetRefreshTokens(Int32) on controller APIBank.Controllers.UsersController (APIBank).
2022-09-23 14:13:01.949 +01:00 [DBG] Execution plan of authorization filters (in the following order): ["APIBank.Authorization.AuthorizeAttribute"]
2022-09-23 14:13:01.954 +01:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2022-09-23 14:13:01.955 +01:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2022-09-23 14:13:01.957 +01:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2022-09-23 14:13:01.958 +01:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2022-09-23 14:13:01.959 +01:00 [DBG] Executing controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-23 14:13:01.960 +01:00 [DBG] Executed controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-23 14:13:01.962 +01:00 [DBG] Attempting to bind parameter 'id' of type 'System.Int32' ...
2022-09-23 14:13:01.966 +01:00 [DBG] Attempting to bind parameter 'id' of type 'System.Int32' using the name 'id' in request data ...
2022-09-23 14:13:01.968 +01:00 [DBG] Done attempting to bind parameter 'id' of type 'System.Int32'.
2022-09-23 14:13:01.969 +01:00 [DBG] Done attempting to bind parameter 'id' of type 'System.Int32'.
2022-09-23 14:13:01.970 +01:00 [DBG] Attempting to validate the bound parameter 'id' of type 'System.Int32' ...
2022-09-23 14:13:01.972 +01:00 [DBG] Done attempting to validate the bound parameter 'id' of type 'System.Int32'.
2022-09-23 14:13:01.974 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 14:13:01.975 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2022-09-23 14:13:01.975 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 14:13:01.976 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 14:13:01.977 +01:00 [DBG] Executing DbCommand [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id, r.created, r.created_by_ip, r.expires, r.is_active, r.is_expired, r.is_revoked, r.reason_revoked, r.token, r.replaced_by_token, r.revoked, r.revoked_by_ip, r.user_id
FROM refresh_token AS r
WHERE r.id = @__p_0
LIMIT 1
2022-09-23 14:13:01.980 +01:00 [INF] Executed DbCommand (3ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id, r.created, r.created_by_ip, r.expires, r.is_active, r.is_expired, r.is_revoked, r.reason_revoked, r.token, r.replaced_by_token, r.revoked, r.revoked_by_ip, r.user_id
FROM refresh_token AS r
WHERE r.id = @__p_0
LIMIT 1
2022-09-23 14:13:01.984 +01:00 [DBG] Context 'PostgresContext' started tracking 'RefreshToken' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 14:13:01.985 +01:00 [DBG] A data reader was disposed.
2022-09-23 14:13:01.986 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 14:13:01.987 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 14:13:01.988 +01:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2022-09-23 14:13:01.991 +01:00 [DBG] No information found on request to perform content negotiation.
2022-09-23 14:13:01.991 +01:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2022-09-23 14:13:01.992 +01:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2022-09-23 14:13:01.993 +01:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2022-09-23 14:13:01.994 +01:00 [INF] Executing OkObjectResult, writing value of type 'Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryable`1[[APIBank.ModelEntities.RefreshToken, APIBank, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2022-09-23 14:13:02.005 +01:00 [DBG] Compiling query expression: 
'DbSet<RefreshToken>()
    .Where(rt => rt.UserId == __id_0)
    .AsNoTracking()
    .Select(rt => new RefreshToken{ 
        Id = rt.Id, 
        UserId = rt.UserId, 
        RefToken = rt.RefToken, 
        Expires = rt.Expires, 
        Created = rt.Created, 
        CreatedByIp = rt.CreatedByIp, 
        Revoked = rt.Revoked, 
        RevokedByIp = rt.RevokedByIp, 
        ReplacedByToken = rt.ReplacedByToken, 
        ReasonRevoked = rt.ReasonRevoked, 
        IsExpired = rt.IsExpired, 
        IsRevoked = rt.IsRevoked, 
        IsActive = rt.IsActive 
    }
    )'
2022-09-23 14:13:02.012 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<RefreshToken>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            Id -> 0
            UserId -> 1
            RefToken -> 2
            Expires -> 3
            Created -> 4
            CreatedByIp -> 5
            Revoked -> 6
            RevokedByIp -> 7
            ReplacedByToken -> 8
            ReasonRevoked -> 9
            IsExpired -> 10
            IsRevoked -> 11
            IsActive -> 12
        SELECT r.id AS Id, r.user_id AS UserId, r.token AS RefToken, r.expires AS Expires, r.created AS Created, r.created_by_ip AS CreatedByIp, r.revoked AS Revoked, r.revoked_by_ip AS RevokedByIp, r.replaced_by_token AS ReplacedByToken, r.reason_revoked AS ReasonRevoked, r.is_expired AS IsExpired, r.is_revoked AS IsRevoked, r.is_active AS IsActive
        FROM refresh_token AS r
        WHERE r.user_id == @__id_0), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, RefreshToken>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)'
2022-09-23 14:13:02.044 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 14:13:02.047 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (2ms).
2022-09-23 14:13:02.070 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 14:13:02.076 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 14:13:02.083 +01:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.user_id AS "UserId", r.token AS "RefToken", r.expires AS "Expires", r.created AS "Created", r.created_by_ip AS "CreatedByIp", r.revoked AS "Revoked", r.revoked_by_ip AS "RevokedByIp", r.replaced_by_token AS "ReplacedByToken", r.reason_revoked AS "ReasonRevoked", r.is_expired AS "IsExpired", r.is_revoked AS "IsRevoked", r.is_active AS "IsActive"
FROM refresh_token AS r
WHERE r.user_id = @__id_0
2022-09-23 14:13:02.104 +01:00 [INF] Executed DbCommand (23ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.user_id AS "UserId", r.token AS "RefToken", r.expires AS "Expires", r.created AS "Created", r.created_by_ip AS "CreatedByIp", r.revoked AS "Revoked", r.revoked_by_ip AS "RevokedByIp", r.replaced_by_token AS "ReplacedByToken", r.reason_revoked AS "ReasonRevoked", r.is_expired AS "IsExpired", r.is_revoked AS "IsRevoked", r.is_active AS "IsActive"
FROM refresh_token AS r
WHERE r.user_id = @__id_0
2022-09-23 14:13:02.133 +01:00 [DBG] A data reader was disposed.
2022-09-23 14:13:02.151 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 14:13:02.157 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 14:13:02.159 +01:00 [INF] Executed action APIBank.Controllers.UsersController.GetRefreshTokens (APIBank) in 200.1073ms
2022-09-23 14:13:02.160 +01:00 [INF] Executed endpoint 'APIBank.Controllers.UsersController.GetRefreshTokens (APIBank)'
2022-09-23 14:13:02.162 +01:00 [DBG] 'PostgresContext' disposed.
2022-09-23 14:13:02.163 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/api/Users/1/refresh-tokens - - - 200 - application/json;+charset=utf-8 248.9987ms
2022-09-23 14:13:06.320 +01:00 [DBG] Connection id "0HMKTCJ3UHOD7" received FIN.
2022-09-23 14:13:06.322 +01:00 [DBG] Connection id "0HMKTCJ3UHOD7" is closed. The last processed stream ID was 1.
2022-09-23 14:13:06.324 +01:00 [DBG] Connection id "0HMKTCJ3UHOD7" sending FIN because: "The client closed the connection."
2022-09-23 14:13:06.335 +01:00 [DBG] Connection id "0HMKTCJ3UHOD7" stopped.
2022-09-23 14:13:39.793 +01:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2022-09-23 14:13:39.916 +01:00 [DBG] Hosting starting
2022-09-23 14:13:40.278 +01:00 [DBG] Using development certificate: CN=localhost (Thumbprint: 9CC642E9838495A6C3C202DECA6A8AD300396DD2)
2022-09-23 14:13:40.399 +01:00 [INF] Now listening on: https://localhost:7036
2022-09-23 14:13:40.401 +01:00 [INF] Now listening on: http://localhost:5036
2022-09-23 14:13:40.403 +01:00 [DBG] Loaded hosting startup assembly APIBank
2022-09-23 14:13:40.404 +01:00 [DBG] Loaded hosting startup assembly Microsoft.AspNetCore.Watch.BrowserRefresh
2022-09-23 14:13:40.405 +01:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.BrowserLink.Net
2022-09-23 14:13:40.406 +01:00 [INF] Application started. Press Ctrl+C to shut down.
2022-09-23 14:13:40.408 +01:00 [INF] Hosting environment: Development
2022-09-23 14:13:40.409 +01:00 [INF] Content root path: C:\Users\mguedesa\OneDrive - NTT DATA EMEAL\Documentos\GitHub\OpenBankAPI-NTT\APIBank\APIBank\
2022-09-23 14:13:40.410 +01:00 [DBG] Hosting started
2022-09-23 14:13:40.794 +01:00 [DBG] Connection id "0HMKTCLNHUU2A" received FIN.
2022-09-23 14:13:40.794 +01:00 [DBG] Connection id "0HMKTCLNHUU2B" received FIN.
2022-09-23 14:13:40.806 +01:00 [DBG] Connection id "0HMKTCLNHUU2B" accepted.
2022-09-23 14:13:40.806 +01:00 [DBG] Connection id "0HMKTCLNHUU2A" accepted.
2022-09-23 14:13:40.810 +01:00 [DBG] Connection id "0HMKTCLNHUU2B" started.
2022-09-23 14:13:40.810 +01:00 [DBG] Connection id "0HMKTCLNHUU2A" started.
2022-09-23 14:13:40.845 +01:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException:  Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveBlobAsync[TIOAdapter](TIOAdapter adapter)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](TIOAdapter adapter, Boolean receiveFirst, Byte[] reAuthenticationData, Boolean isApm)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2022-09-23 14:13:40.845 +01:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException:  Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveBlobAsync[TIOAdapter](TIOAdapter adapter)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](TIOAdapter adapter, Boolean receiveFirst, Byte[] reAuthenticationData, Boolean isApm)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2022-09-23 14:13:40.916 +01:00 [DBG] Connection id "0HMKTCLNHUU2A" stopped.
2022-09-23 14:13:40.916 +01:00 [DBG] Connection id "0HMKTCLNHUU2B" stopped.
2022-09-23 14:13:40.921 +01:00 [DBG] Connection id "0HMKTCLNHUU2B" sending FIN because: "The Socket transport's send loop completed gracefully."
2022-09-23 14:13:40.921 +01:00 [DBG] Connection id "0HMKTCLNHUU2A" sending FIN because: "The Socket transport's send loop completed gracefully."
2022-09-23 14:13:41.235 +01:00 [DBG] Connection id "0HMKTCLNHUU2C" accepted.
2022-09-23 14:13:41.242 +01:00 [DBG] Connection id "0HMKTCLNHUU2C" started.
2022-09-23 14:13:41.347 +01:00 [DBG] Connection 0HMKTCLNHUU2C established using the following protocol: "Tls12"
2022-09-23 14:13:41.435 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/swagger/index.html - -
2022-09-23 14:13:41.500 +01:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2022-09-23 14:13:41.539 +01:00 [DBG] No candidates found for the request path '/swagger/index.html'
2022-09-23 14:13:41.541 +01:00 [DBG] Request did not match any endpoints
2022-09-23 14:13:41.667 +01:00 [DBG] Response markup is scheduled to include browser refresh script injection.
2022-09-23 14:13:41.968 +01:00 [DBG] Response markup was updated to include browser refresh script injection.
2022-09-23 14:13:41.988 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/swagger/index.html - - - 200 - text/html;charset=utf-8 557.6399ms
2022-09-23 14:13:41.992 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/_framework/aspnetcore-browser-refresh.js - -
2022-09-23 14:13:42.019 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/_vs/browserLink - -
2022-09-23 14:13:42.025 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/_framework/aspnetcore-browser-refresh.js - - - 200 11984 application/javascript;+charset=utf-8 32.3549ms
2022-09-23 14:13:42.104 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/_vs/browserLink - - - 200 - text/javascript;+charset=UTF-8 86.3280ms
2022-09-23 14:13:42.212 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/swagger/v1/swagger.json - -
2022-09-23 14:13:42.214 +01:00 [DBG] No candidates found for the request path '/swagger/v1/swagger.json'
2022-09-23 14:13:42.219 +01:00 [DBG] Request did not match any endpoints
2022-09-23 14:13:42.748 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/swagger/v1/swagger.json - - - 200 - application/json;charset=utf-8 535.8225ms
2022-09-23 14:13:51.363 +01:00 [DBG] Connection id "0HMKTCLNHUU2C" received FIN.
2022-09-23 14:13:51.375 +01:00 [DBG] Connection id "0HMKTCLNHUU2C" is closed. The last processed stream ID was 7.
2022-09-23 14:13:51.376 +01:00 [DBG] Connection id "0HMKTCLNHUU2C" sending FIN because: "The client closed the connection."
2022-09-23 14:13:51.387 +01:00 [DBG] Connection id "0HMKTCLNHUU2C" stopped.
2022-09-23 14:14:04.340 +01:00 [DBG] Connection id "0HMKTCLNHUU2D" accepted.
2022-09-23 14:14:04.343 +01:00 [DBG] Connection id "0HMKTCLNHUU2D" started.
2022-09-23 14:14:04.355 +01:00 [DBG] Connection 0HMKTCLNHUU2D established using the following protocol: "Tls12"
2022-09-23 14:14:04.358 +01:00 [INF] Request starting HTTP/2 POST https://localhost:7036/api/Users/Login application/json 58
2022-09-23 14:14:04.373 +01:00 [DBG] 1 candidate(s) found for the request path '/api/Users/Login'
2022-09-23 14:14:04.385 +01:00 [DBG] Endpoint 'APIBank.Controllers.UsersController.Login (APIBank)' with route pattern 'api/Users/Login' is valid for the request path '/api/Users/Login'
2022-09-23 14:14:04.388 +01:00 [DBG] Request matched endpoint 'APIBank.Controllers.UsersController.Login (APIBank)'
2022-09-23 14:14:04.391 +01:00 [DBG] Static files was skipped as the request already matched an endpoint.
2022-09-23 14:14:04.938 +01:00 [INF] Executing endpoint 'APIBank.Controllers.UsersController.Login (APIBank)'
2022-09-23 14:14:04.967 +01:00 [INF] Route matched with {action = "Login", controller = "Users"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult Login(APIBank.Models.Requests.UserLoginRequest) on controller APIBank.Controllers.UsersController (APIBank).
2022-09-23 14:14:04.972 +01:00 [DBG] Execution plan of authorization filters (in the following order): ["APIBank.Authorization.AuthorizeAttribute"]
2022-09-23 14:14:04.974 +01:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2022-09-23 14:14:04.975 +01:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2022-09-23 14:14:04.979 +01:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2022-09-23 14:14:04.980 +01:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2022-09-23 14:14:04.983 +01:00 [DBG] Executing controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-23 14:14:04.985 +01:00 [DBG] Executed controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-23 14:14:05.008 +01:00 [DBG] Attempting to bind parameter 'model' of type 'APIBank.Models.Requests.UserLoginRequest' ...
2022-09-23 14:14:05.020 +01:00 [DBG] Attempting to bind parameter 'model' of type 'APIBank.Models.Requests.UserLoginRequest' using the name '' in request data ...
2022-09-23 14:14:05.023 +01:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2022-09-23 14:14:05.036 +01:00 [DBG] Connection id "0HMKTCLNHUU2D", Request id "0HMKTCLNHUU2D:00000001": started reading request body.
2022-09-23 14:14:05.039 +01:00 [DBG] Connection id "0HMKTCLNHUU2D", Request id "0HMKTCLNHUU2D:00000001": done reading request body.
2022-09-23 14:14:05.054 +01:00 [DBG] JSON input formatter succeeded, deserializing to type 'APIBank.Models.Requests.UserLoginRequest'
2022-09-23 14:14:05.056 +01:00 [DBG] Done attempting to bind parameter 'model' of type 'APIBank.Models.Requests.UserLoginRequest'.
2022-09-23 14:14:05.059 +01:00 [DBG] Done attempting to bind parameter 'model' of type 'APIBank.Models.Requests.UserLoginRequest'.
2022-09-23 14:14:05.063 +01:00 [DBG] Attempting to validate the bound parameter 'model' of type 'APIBank.Models.Requests.UserLoginRequest' ...
2022-09-23 14:14:05.074 +01:00 [DBG] Done attempting to validate the bound parameter 'model' of type 'APIBank.Models.Requests.UserLoginRequest'.
2022-09-23 14:14:05.253 +01:00 [DBG] An additional 'IServiceProvider' was created for internal use by Entity Framework. An existing service provider was not used due to the following configuration changes: configuration changed for 'Core:ConfigureWarnings', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:UseAdminDatabase', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:SetPostgresVersion', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:UseRedshift', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:ReverseNullOrdering', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:RemoteCertificateValidationCallback', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:ProvideClientCertificatesCallback', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:ProvidePasswordCallback'.
2022-09-23 14:14:07.090 +01:00 [INF] Entity Framework Core 6.0.9 initialized 'PostgresContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:6.0.7+5b98e4b74de93b590b44aef8dd7967c03acc433c' with options: None
2022-09-23 14:14:07.185 +01:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .SingleOrDefault(x => x.Username == __model_Username_0)'
2022-09-23 14:14:07.760 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<User>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: User.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: User.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 1], [Property: User.Email (string) Required Index MaxLength(254), 2], [Property: User.FullName (string) Required MaxLength(100), 3], [Property: User.PasswordChangedAt (DateTime) Required ValueGenerated.OnAdd, 4], [Property: User.PasswordHash (string) Required MaxLength(200), 5], [Property: User.Username (string) Required Index MaxLength(50), 6] }
        SELECT TOP(2) u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
        FROM users AS u
        WHERE u.username == @__model_Username_0), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, User>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)
    .SingleOrDefault()'
2022-09-23 14:14:07.849 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 14:14:07.987 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (140ms).
2022-09-23 14:14:08.018 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 14:14:08.418 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 14:14:08.469 +01:00 [DBG] Executing DbCommand [Parameters=[@__model_Username_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.username = @__model_Username_0
LIMIT 2
2022-09-23 14:14:08.677 +01:00 [INF] Executed DbCommand (218ms) [Parameters=[@__model_Username_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.username = @__model_Username_0
LIMIT 2
2022-09-23 14:14:08.788 +01:00 [DBG] Context 'PostgresContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 14:14:09.011 +01:00 [DBG] A data reader was disposed.
2022-09-23 14:14:09.018 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 14:14:09.033 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 14:14:09.297 +01:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .Any(user => user.RefreshTokenCollection
        .Any(reftoken => reftoken.RefToken == __token_0))'
2022-09-23 14:14:09.460 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<bool>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            EmptyProjectionMember -> 0
        SELECT EXISTS (
            SELECT 1
            FROM users AS u
            WHERE EXISTS (
                SELECT 1
                FROM refresh_token AS r
                WHERE ((u.id != NULL) && (u.id == r.user_id)) && (r.token == @__token_0)))), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, bool>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)
    .Single()'
2022-09-23 14:14:09.477 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 14:14:09.481 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (3ms).
2022-09-23 14:14:09.483 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 14:14:09.484 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 14:14:09.486 +01:00 [DBG] Executing DbCommand [Parameters=[@__token_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM users AS u
    WHERE EXISTS (
        SELECT 1
        FROM refresh_token AS r
        WHERE (u.id = r.user_id) AND (r.token = @__token_0)))
2022-09-23 14:14:09.493 +01:00 [INF] Executed DbCommand (7ms) [Parameters=[@__token_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM users AS u
    WHERE EXISTS (
        SELECT 1
        FROM refresh_token AS r
        WHERE (u.id = r.user_id) AND (r.token = @__token_0)))
2022-09-23 14:14:09.502 +01:00 [DBG] A data reader was disposed.
2022-09-23 14:14:09.503 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 14:14:09.504 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 14:14:09.511 +01:00 [DBG] SaveChanges starting for 'PostgresContext'.
2022-09-23 14:14:09.515 +01:00 [DBG] DetectChanges starting for 'PostgresContext'.
2022-09-23 14:14:09.565 +01:00 [DBG] 1 entities were added and 0 entities were removed from navigation 'User.RefreshTokenCollection'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 14:14:09.630 +01:00 [DBG] 'PostgresContext' generated a temporary value for the property 'Id.RefreshToken'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 14:14:09.741 +01:00 [DBG] Context 'PostgresContext' started tracking 'RefreshToken' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 14:14:09.748 +01:00 [DBG] DetectChanges completed for 'PostgresContext'.
2022-09-23 14:14:09.762 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 14:14:09.765 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 14:14:09.769 +01:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2022-09-23 14:14:09.785 +01:00 [DBG] Began transaction with isolation level 'ReadCommitted'.
2022-09-23 14:14:09.912 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 14:14:09.915 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (3ms).
2022-09-23 14:14:09.918 +01:00 [DBG] Executing DbCommand [Parameters=[@p0='?' (DbType = DateTime), @p1='?', @p2='?' (DbType = DateTime), @p3='?' (DbType = Boolean), @p4='?' (DbType = Boolean), @p5='?' (DbType = Boolean), @p6='?', @p7='?', @p8='?', @p9='?' (DbType = DateTime), @p10='?', @p11='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO refresh_token (created, created_by_ip, expires, is_active, is_expired, is_revoked, reason_revoked, token, replaced_by_token, revoked, revoked_by_ip, user_id)
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11)
RETURNING id;
2022-09-23 14:14:09.951 +01:00 [INF] Executed DbCommand (33ms) [Parameters=[@p0='?' (DbType = DateTime), @p1='?', @p2='?' (DbType = DateTime), @p3='?' (DbType = Boolean), @p4='?' (DbType = Boolean), @p5='?' (DbType = Boolean), @p6='?', @p7='?', @p8='?', @p9='?' (DbType = DateTime), @p10='?', @p11='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO refresh_token (created, created_by_ip, expires, is_active, is_expired, is_revoked, reason_revoked, token, replaced_by_token, revoked, revoked_by_ip, user_id)
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11)
RETURNING id;
2022-09-23 14:14:09.982 +01:00 [DBG] The foreign key property 'RefreshToken.Id' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2022-09-23 14:14:09.997 +01:00 [DBG] A data reader was disposed.
2022-09-23 14:14:10.002 +01:00 [DBG] Committing transaction.
2022-09-23 14:14:10.015 +01:00 [DBG] Committed transaction.
2022-09-23 14:14:10.017 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 14:14:10.019 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 14:14:10.025 +01:00 [DBG] Disposing transaction.
2022-09-23 14:14:10.043 +01:00 [DBG] An entity of type 'RefreshToken' tracked by 'PostgresContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 14:14:10.047 +01:00 [DBG] SaveChanges completed for 'PostgresContext' with 1 entities written to the database.
2022-09-23 14:14:10.353 +01:00 [DBG] Compiling query expression: 
'DbSet<RefreshToken>()
    .Where(rt => rt.UserId == __id_0)
    .AsNoTracking()
    .Select(rt => new RefreshToken{ 
        Id = rt.Id, 
        UserId = rt.UserId, 
        RefToken = rt.RefToken, 
        Expires = rt.Expires, 
        Created = rt.Created, 
        CreatedByIp = rt.CreatedByIp, 
        Revoked = rt.Revoked, 
        RevokedByIp = rt.RevokedByIp, 
        ReplacedByToken = rt.ReplacedByToken, 
        ReasonRevoked = rt.ReasonRevoked, 
        IsExpired = rt.IsExpired, 
        IsRevoked = rt.IsRevoked, 
        IsActive = rt.IsActive 
    }
    )'
2022-09-23 14:14:10.396 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<RefreshToken>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            Id -> 0
            UserId -> 1
            RefToken -> 2
            Expires -> 3
            Created -> 4
            CreatedByIp -> 5
            Revoked -> 6
            RevokedByIp -> 7
            ReplacedByToken -> 8
            ReasonRevoked -> 9
            IsExpired -> 10
            IsRevoked -> 11
            IsActive -> 12
        SELECT r.id AS Id, r.user_id AS UserId, r.token AS RefToken, r.expires AS Expires, r.created AS Created, r.created_by_ip AS CreatedByIp, r.revoked AS Revoked, r.revoked_by_ip AS RevokedByIp, r.replaced_by_token AS ReplacedByToken, r.reason_revoked AS ReasonRevoked, r.is_expired AS IsExpired, r.is_revoked AS IsRevoked, r.is_active AS IsActive
        FROM refresh_token AS r
        WHERE r.user_id == @__id_0), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, RefreshToken>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)'
2022-09-23 14:14:10.400 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 14:14:10.401 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2022-09-23 14:14:10.402 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 14:14:10.403 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 14:14:10.405 +01:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.user_id AS "UserId", r.token AS "RefToken", r.expires AS "Expires", r.created AS "Created", r.created_by_ip AS "CreatedByIp", r.revoked AS "Revoked", r.revoked_by_ip AS "RevokedByIp", r.replaced_by_token AS "ReplacedByToken", r.reason_revoked AS "ReasonRevoked", r.is_expired AS "IsExpired", r.is_revoked AS "IsRevoked", r.is_active AS "IsActive"
FROM refresh_token AS r
WHERE r.user_id = @__id_0
2022-09-23 14:14:10.408 +01:00 [INF] Executed DbCommand (3ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.user_id AS "UserId", r.token AS "RefToken", r.expires AS "Expires", r.created AS "Created", r.created_by_ip AS "CreatedByIp", r.revoked AS "Revoked", r.revoked_by_ip AS "RevokedByIp", r.replaced_by_token AS "ReplacedByToken", r.reason_revoked AS "ReasonRevoked", r.is_expired AS "IsExpired", r.is_revoked AS "IsRevoked", r.is_active AS "IsActive"
FROM refresh_token AS r
WHERE r.user_id = @__id_0
2022-09-23 14:14:10.413 +01:00 [DBG] A data reader was disposed.
2022-09-23 14:14:10.414 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 14:14:10.415 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 14:14:10.419 +01:00 [DBG] An entity of type 'User' tracked by 'PostgresContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 14:14:10.422 +01:00 [DBG] An entity of type 'RefreshToken' tracked by 'PostgresContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 14:14:10.424 +01:00 [DBG] SaveChanges starting for 'PostgresContext'.
2022-09-23 14:14:10.425 +01:00 [DBG] DetectChanges starting for 'PostgresContext'.
2022-09-23 14:14:10.426 +01:00 [DBG] DetectChanges completed for 'PostgresContext'.
2022-09-23 14:14:10.428 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 14:14:10.430 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 14:14:10.431 +01:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2022-09-23 14:14:10.435 +01:00 [DBG] Began transaction with isolation level 'ReadCommitted'.
2022-09-23 14:14:10.464 +01:00 [DBG] Executing 2 update commands as a batch.
2022-09-23 14:14:10.472 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 14:14:10.473 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (2ms).
2022-09-23 14:14:10.475 +01:00 [DBG] Executing DbCommand [Parameters=[@p12='?' (DbType = Int32), @p0='?' (DbType = DateTime), @p1='?', @p2='?' (DbType = DateTime), @p3='?' (DbType = Boolean), @p4='?' (DbType = Boolean), @p5='?' (DbType = Boolean), @p6='?', @p7='?', @p8='?', @p9='?' (DbType = DateTime), @p10='?', @p11='?' (DbType = Int32), @p19='?' (DbType = Int32), @p13='?' (DbType = DateTime), @p14='?', @p15='?', @p16='?' (DbType = DateTime), @p17='?', @p18='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE refresh_token SET created = @p0, created_by_ip = @p1, expires = @p2, is_active = @p3, is_expired = @p4, is_revoked = @p5, reason_revoked = @p6, token = @p7, replaced_by_token = @p8, revoked = @p9, revoked_by_ip = @p10, user_id = @p11
WHERE id = @p12;
UPDATE users SET created_at = @p13, email = @p14, full_name = @p15, password_changed_at = @p16, password_hash = @p17, username = @p18
WHERE id = @p19;
2022-09-23 14:14:10.479 +01:00 [INF] Executed DbCommand (5ms) [Parameters=[@p12='?' (DbType = Int32), @p0='?' (DbType = DateTime), @p1='?', @p2='?' (DbType = DateTime), @p3='?' (DbType = Boolean), @p4='?' (DbType = Boolean), @p5='?' (DbType = Boolean), @p6='?', @p7='?', @p8='?', @p9='?' (DbType = DateTime), @p10='?', @p11='?' (DbType = Int32), @p19='?' (DbType = Int32), @p13='?' (DbType = DateTime), @p14='?', @p15='?', @p16='?' (DbType = DateTime), @p17='?', @p18='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE refresh_token SET created = @p0, created_by_ip = @p1, expires = @p2, is_active = @p3, is_expired = @p4, is_revoked = @p5, reason_revoked = @p6, token = @p7, replaced_by_token = @p8, revoked = @p9, revoked_by_ip = @p10, user_id = @p11
WHERE id = @p12;
UPDATE users SET created_at = @p13, email = @p14, full_name = @p15, password_changed_at = @p16, password_hash = @p17, username = @p18
WHERE id = @p19;
2022-09-23 14:14:10.482 +01:00 [DBG] A data reader was disposed.
2022-09-23 14:14:10.483 +01:00 [DBG] Committing transaction.
2022-09-23 14:14:10.484 +01:00 [DBG] Committed transaction.
2022-09-23 14:14:10.485 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 14:14:10.486 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 14:14:10.488 +01:00 [DBG] Disposing transaction.
2022-09-23 14:14:10.490 +01:00 [DBG] An entity of type 'User' tracked by 'PostgresContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 14:14:10.491 +01:00 [DBG] An entity of type 'RefreshToken' tracked by 'PostgresContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 14:14:10.493 +01:00 [DBG] SaveChanges completed for 'PostgresContext' with 2 entities written to the database.
2022-09-23 14:14:10.502 +01:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2022-09-23 14:14:10.512 +01:00 [DBG] Attempting to select an output formatter based on Accept header '["text/plain"]'.
2022-09-23 14:14:10.515 +01:00 [DBG] Could not find an output formatter based on content negotiation. Accepted types were (["text/plain"])
2022-09-23 14:14:10.517 +01:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2022-09-23 14:14:10.518 +01:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2022-09-23 14:14:10.523 +01:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2022-09-23 14:14:10.525 +01:00 [INF] Executing OkObjectResult, writing value of type 'APIBank.Models.MyRequestResponses.LoginResponse'.
2022-09-23 14:14:10.551 +01:00 [INF] Executed action APIBank.Controllers.UsersController.Login (APIBank) in 5561.6432ms
2022-09-23 14:14:10.553 +01:00 [INF] Executed endpoint 'APIBank.Controllers.UsersController.Login (APIBank)'
2022-09-23 14:14:10.563 +01:00 [DBG] 'PostgresContext' disposed.
2022-09-23 14:14:10.575 +01:00 [INF] Request finished HTTP/2 POST https://localhost:7036/api/Users/Login application/json 58 - 200 - application/json;+charset=utf-8 6216.6396ms
2022-09-23 14:14:11.395 +01:00 [DBG] Connection id "0HMKTCLNHUU2D" received FIN.
2022-09-23 14:14:11.398 +01:00 [DBG] Connection id "0HMKTCLNHUU2D" is closed. The last processed stream ID was 1.
2022-09-23 14:14:11.400 +01:00 [DBG] Connection id "0HMKTCLNHUU2D" sending FIN because: "The client closed the connection."
2022-09-23 14:14:11.409 +01:00 [DBG] Connection id "0HMKTCLNHUU2D" stopped.
2022-09-23 14:23:45.002 +01:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2022-09-23 14:23:45.429 +01:00 [DBG] Hosting starting
2022-09-23 14:23:45.916 +01:00 [DBG] Using development certificate: CN=localhost (Thumbprint: 9CC642E9838495A6C3C202DECA6A8AD300396DD2)
2022-09-23 14:23:46.078 +01:00 [INF] Now listening on: https://localhost:7036
2022-09-23 14:23:46.087 +01:00 [INF] Now listening on: http://localhost:5036
2022-09-23 14:23:46.093 +01:00 [DBG] Loaded hosting startup assembly APIBank
2022-09-23 14:23:46.096 +01:00 [DBG] Loaded hosting startup assembly Microsoft.AspNetCore.Watch.BrowserRefresh
2022-09-23 14:23:46.102 +01:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.BrowserLink.Net
2022-09-23 14:23:46.104 +01:00 [INF] Application started. Press Ctrl+C to shut down.
2022-09-23 14:23:46.108 +01:00 [INF] Hosting environment: Development
2022-09-23 14:23:46.110 +01:00 [INF] Content root path: C:\Users\mguedesa\OneDrive - NTT DATA EMEAL\Documentos\GitHub\OpenBankAPI-NTT\APIBank\APIBank\
2022-09-23 14:23:46.113 +01:00 [DBG] Hosting started
2022-09-23 14:23:46.532 +01:00 [DBG] Connection id "0HMKTCRC2MBOS" accepted.
2022-09-23 14:23:46.532 +01:00 [DBG] Connection id "0HMKTCRC2MBOT" accepted.
2022-09-23 14:23:46.535 +01:00 [DBG] Connection id "0HMKTCRC2MBOT" started.
2022-09-23 14:23:46.535 +01:00 [DBG] Connection id "0HMKTCRC2MBOS" started.
2022-09-23 14:23:46.542 +01:00 [DBG] Connection id "0HMKTCRC2MBOS" received FIN.
2022-09-23 14:23:46.542 +01:00 [DBG] Connection id "0HMKTCRC2MBOT" received FIN.
2022-09-23 14:23:46.564 +01:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException:  Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveBlobAsync[TIOAdapter](TIOAdapter adapter)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](TIOAdapter adapter, Boolean receiveFirst, Byte[] reAuthenticationData, Boolean isApm)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2022-09-23 14:23:46.564 +01:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException:  Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveBlobAsync[TIOAdapter](TIOAdapter adapter)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](TIOAdapter adapter, Boolean receiveFirst, Byte[] reAuthenticationData, Boolean isApm)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2022-09-23 14:23:46.636 +01:00 [DBG] Connection id "0HMKTCRC2MBOT" stopped.
2022-09-23 14:23:46.636 +01:00 [DBG] Connection id "0HMKTCRC2MBOS" stopped.
2022-09-23 14:23:46.644 +01:00 [DBG] Connection id "0HMKTCRC2MBOT" sending FIN because: "The Socket transport's send loop completed gracefully."
2022-09-23 14:23:46.644 +01:00 [DBG] Connection id "0HMKTCRC2MBOS" sending FIN because: "The Socket transport's send loop completed gracefully."
2022-09-23 14:23:46.902 +01:00 [DBG] Connection id "0HMKTCRC2MBOU" accepted.
2022-09-23 14:23:46.907 +01:00 [DBG] Connection id "0HMKTCRC2MBOU" started.
2022-09-23 14:23:47.002 +01:00 [DBG] Connection 0HMKTCRC2MBOU established using the following protocol: "Tls12"
2022-09-23 14:23:47.148 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/swagger/index.html - -
2022-09-23 14:23:47.215 +01:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2022-09-23 14:23:47.275 +01:00 [DBG] No candidates found for the request path '/swagger/index.html'
2022-09-23 14:23:47.278 +01:00 [DBG] Request did not match any endpoints
2022-09-23 14:23:47.427 +01:00 [DBG] Response markup is scheduled to include browser refresh script injection.
2022-09-23 14:23:47.651 +01:00 [DBG] Response markup was updated to include browser refresh script injection.
2022-09-23 14:23:47.671 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/swagger/index.html - - - 200 - text/html;charset=utf-8 529.9489ms
2022-09-23 14:23:47.680 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/_framework/aspnetcore-browser-refresh.js - -
2022-09-23 14:23:47.711 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/_vs/browserLink - -
2022-09-23 14:23:47.718 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/_framework/aspnetcore-browser-refresh.js - - - 200 11984 application/javascript;+charset=utf-8 37.9396ms
2022-09-23 14:23:47.838 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/_vs/browserLink - - - 200 - text/javascript;+charset=UTF-8 125.9356ms
2022-09-23 14:23:47.954 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/swagger/v1/swagger.json - -
2022-09-23 14:23:47.958 +01:00 [DBG] No candidates found for the request path '/swagger/v1/swagger.json'
2022-09-23 14:23:47.969 +01:00 [DBG] Request did not match any endpoints
2022-09-23 14:23:48.296 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/swagger/v1/swagger.json - - - 200 - application/json;charset=utf-8 342.1533ms
2022-09-23 14:23:54.279 +01:00 [INF] Request starting HTTP/2 POST https://localhost:7036/api/Users/Login application/json 58
2022-09-23 14:23:54.301 +01:00 [DBG] 1 candidate(s) found for the request path '/api/Users/Login'
2022-09-23 14:23:54.319 +01:00 [DBG] Endpoint 'APIBank.Controllers.UsersController.Login (APIBank)' with route pattern 'api/Users/Login' is valid for the request path '/api/Users/Login'
2022-09-23 14:23:54.323 +01:00 [DBG] Request matched endpoint 'APIBank.Controllers.UsersController.Login (APIBank)'
2022-09-23 14:23:54.326 +01:00 [DBG] Static files was skipped as the request already matched an endpoint.
2022-09-23 14:23:55.050 +01:00 [INF] Executing endpoint 'APIBank.Controllers.UsersController.Login (APIBank)'
2022-09-23 14:23:55.104 +01:00 [INF] Route matched with {action = "Login", controller = "Users"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult Login(APIBank.Models.Requests.UserLoginRequest) on controller APIBank.Controllers.UsersController (APIBank).
2022-09-23 14:23:55.108 +01:00 [DBG] Execution plan of authorization filters (in the following order): ["APIBank.Authorization.AuthorizeAttribute"]
2022-09-23 14:23:55.112 +01:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2022-09-23 14:23:55.114 +01:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2022-09-23 14:23:55.122 +01:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2022-09-23 14:23:55.123 +01:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2022-09-23 14:23:55.128 +01:00 [DBG] Executing controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-23 14:23:55.132 +01:00 [DBG] Executed controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-23 14:23:55.221 +01:00 [DBG] Attempting to bind parameter 'model' of type 'APIBank.Models.Requests.UserLoginRequest' ...
2022-09-23 14:23:55.230 +01:00 [DBG] Attempting to bind parameter 'model' of type 'APIBank.Models.Requests.UserLoginRequest' using the name '' in request data ...
2022-09-23 14:23:55.237 +01:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2022-09-23 14:23:55.251 +01:00 [DBG] Connection id "0HMKTCRC2MBOU", Request id "0HMKTCRC2MBOU:00000009": started reading request body.
2022-09-23 14:23:55.254 +01:00 [DBG] Connection id "0HMKTCRC2MBOU", Request id "0HMKTCRC2MBOU:00000009": done reading request body.
2022-09-23 14:23:55.271 +01:00 [DBG] JSON input formatter succeeded, deserializing to type 'APIBank.Models.Requests.UserLoginRequest'
2022-09-23 14:23:55.273 +01:00 [DBG] Done attempting to bind parameter 'model' of type 'APIBank.Models.Requests.UserLoginRequest'.
2022-09-23 14:23:55.274 +01:00 [DBG] Done attempting to bind parameter 'model' of type 'APIBank.Models.Requests.UserLoginRequest'.
2022-09-23 14:23:55.276 +01:00 [DBG] Attempting to validate the bound parameter 'model' of type 'APIBank.Models.Requests.UserLoginRequest' ...
2022-09-23 14:23:55.305 +01:00 [DBG] Done attempting to validate the bound parameter 'model' of type 'APIBank.Models.Requests.UserLoginRequest'.
2022-09-23 14:23:55.569 +01:00 [DBG] An additional 'IServiceProvider' was created for internal use by Entity Framework. An existing service provider was not used due to the following configuration changes: configuration changed for 'Core:ConfigureWarnings', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:UseAdminDatabase', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:SetPostgresVersion', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:UseRedshift', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:ReverseNullOrdering', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:RemoteCertificateValidationCallback', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:ProvideClientCertificatesCallback', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:ProvidePasswordCallback'.
2022-09-23 14:23:57.692 +01:00 [INF] Entity Framework Core 6.0.9 initialized 'PostgresContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:6.0.7+5b98e4b74de93b590b44aef8dd7967c03acc433c' with options: None
2022-09-23 14:23:57.823 +01:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .SingleOrDefault(x => x.Username == __model_Username_0)'
2022-09-23 14:23:58.524 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<User>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: User.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: User.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 1], [Property: User.Email (string) Required Index MaxLength(254), 2], [Property: User.FullName (string) Required MaxLength(100), 3], [Property: User.PasswordChangedAt (DateTime) Required ValueGenerated.OnAdd, 4], [Property: User.PasswordHash (string) Required MaxLength(200), 5], [Property: User.Username (string) Required Index MaxLength(50), 6] }
        SELECT TOP(2) u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
        FROM users AS u
        WHERE u.username == @__model_Username_0), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, User>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)
    .SingleOrDefault()'
2022-09-23 14:23:58.620 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 14:23:58.754 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (128ms).
2022-09-23 14:23:58.771 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 14:23:59.187 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 14:23:59.217 +01:00 [DBG] Executing DbCommand [Parameters=[@__model_Username_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.username = @__model_Username_0
LIMIT 2
2022-09-23 14:23:59.378 +01:00 [INF] Executed DbCommand (175ms) [Parameters=[@__model_Username_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.username = @__model_Username_0
LIMIT 2
2022-09-23 14:23:59.461 +01:00 [DBG] Context 'PostgresContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 14:23:59.548 +01:00 [DBG] A data reader was disposed.
2022-09-23 14:23:59.556 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 14:23:59.571 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 14:23:59.821 +01:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .Any(user => user.RefreshTokenCollection
        .Any(reftoken => reftoken.RefToken == __token_0))'
2022-09-23 14:24:00.035 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<bool>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            EmptyProjectionMember -> 0
        SELECT EXISTS (
            SELECT 1
            FROM users AS u
            WHERE EXISTS (
                SELECT 1
                FROM refresh_token AS r
                WHERE ((u.id != NULL) && (u.id == r.user_id)) && (r.token == @__token_0)))), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, bool>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)
    .Single()'
2022-09-23 14:24:00.067 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 14:24:00.070 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (2ms).
2022-09-23 14:24:00.072 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 14:24:00.075 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 14:24:00.085 +01:00 [DBG] Executing DbCommand [Parameters=[@__token_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM users AS u
    WHERE EXISTS (
        SELECT 1
        FROM refresh_token AS r
        WHERE (u.id = r.user_id) AND (r.token = @__token_0)))
2022-09-23 14:24:00.095 +01:00 [INF] Executed DbCommand (10ms) [Parameters=[@__token_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM users AS u
    WHERE EXISTS (
        SELECT 1
        FROM refresh_token AS r
        WHERE (u.id = r.user_id) AND (r.token = @__token_0)))
2022-09-23 14:24:00.108 +01:00 [DBG] A data reader was disposed.
2022-09-23 14:24:00.113 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 14:24:00.115 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 14:24:00.122 +01:00 [DBG] SaveChanges starting for 'PostgresContext'.
2022-09-23 14:24:00.132 +01:00 [DBG] DetectChanges starting for 'PostgresContext'.
2022-09-23 14:24:00.193 +01:00 [DBG] 1 entities were added and 0 entities were removed from navigation 'User.RefreshTokenCollection'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 14:24:00.256 +01:00 [DBG] 'PostgresContext' generated a temporary value for the property 'Id.RefreshToken'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 14:24:00.367 +01:00 [DBG] Context 'PostgresContext' started tracking 'RefreshToken' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 14:24:00.377 +01:00 [DBG] DetectChanges completed for 'PostgresContext'.
2022-09-23 14:24:00.403 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 14:24:00.406 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 14:24:00.413 +01:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2022-09-23 14:24:00.434 +01:00 [DBG] Began transaction with isolation level 'ReadCommitted'.
2022-09-23 14:24:00.535 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 14:24:00.536 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2022-09-23 14:24:00.539 +01:00 [DBG] Executing DbCommand [Parameters=[@p0='?' (DbType = DateTime), @p1='?', @p2='?' (DbType = DateTime), @p3='?' (DbType = Boolean), @p4='?' (DbType = Boolean), @p5='?' (DbType = Boolean), @p6='?', @p7='?', @p8='?', @p9='?' (DbType = DateTime), @p10='?', @p11='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO refresh_token (created, created_by_ip, expires, is_active, is_expired, is_revoked, reason_revoked, token, replaced_by_token, revoked, revoked_by_ip, user_id)
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11)
RETURNING id;
2022-09-23 14:24:00.570 +01:00 [INF] Executed DbCommand (31ms) [Parameters=[@p0='?' (DbType = DateTime), @p1='?', @p2='?' (DbType = DateTime), @p3='?' (DbType = Boolean), @p4='?' (DbType = Boolean), @p5='?' (DbType = Boolean), @p6='?', @p7='?', @p8='?', @p9='?' (DbType = DateTime), @p10='?', @p11='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO refresh_token (created, created_by_ip, expires, is_active, is_expired, is_revoked, reason_revoked, token, replaced_by_token, revoked, revoked_by_ip, user_id)
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11)
RETURNING id;
2022-09-23 14:24:00.602 +01:00 [DBG] The foreign key property 'RefreshToken.Id' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2022-09-23 14:24:00.613 +01:00 [DBG] A data reader was disposed.
2022-09-23 14:24:00.619 +01:00 [DBG] Committing transaction.
2022-09-23 14:24:00.636 +01:00 [DBG] Committed transaction.
2022-09-23 14:24:00.638 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 14:24:00.639 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 14:24:00.644 +01:00 [DBG] Disposing transaction.
2022-09-23 14:24:00.666 +01:00 [DBG] An entity of type 'RefreshToken' tracked by 'PostgresContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 14:24:00.672 +01:00 [DBG] SaveChanges completed for 'PostgresContext' with 1 entities written to the database.
2022-09-23 14:24:01.002 +01:00 [DBG] Compiling query expression: 
'DbSet<RefreshToken>()
    .Where(rt => rt.UserId == __id_0)
    .AsNoTracking()
    .Select(rt => new RefreshToken{ 
        Id = rt.Id, 
        UserId = rt.UserId, 
        RefToken = rt.RefToken, 
        Expires = rt.Expires, 
        Created = rt.Created, 
        CreatedByIp = rt.CreatedByIp, 
        Revoked = rt.Revoked, 
        RevokedByIp = rt.RevokedByIp, 
        ReplacedByToken = rt.ReplacedByToken, 
        ReasonRevoked = rt.ReasonRevoked, 
        IsExpired = rt.IsExpired, 
        IsRevoked = rt.IsRevoked, 
        IsActive = rt.IsActive 
    }
    )'
2022-09-23 14:24:01.048 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<RefreshToken>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            Id -> 0
            UserId -> 1
            RefToken -> 2
            Expires -> 3
            Created -> 4
            CreatedByIp -> 5
            Revoked -> 6
            RevokedByIp -> 7
            ReplacedByToken -> 8
            ReasonRevoked -> 9
            IsExpired -> 10
            IsRevoked -> 11
            IsActive -> 12
        SELECT r.id AS Id, r.user_id AS UserId, r.token AS RefToken, r.expires AS Expires, r.created AS Created, r.created_by_ip AS CreatedByIp, r.revoked AS Revoked, r.revoked_by_ip AS RevokedByIp, r.replaced_by_token AS ReplacedByToken, r.reason_revoked AS ReasonRevoked, r.is_expired AS IsExpired, r.is_revoked AS IsRevoked, r.is_active AS IsActive
        FROM refresh_token AS r
        WHERE r.user_id == @__id_0), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, RefreshToken>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)'
2022-09-23 14:24:01.051 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 14:24:01.052 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2022-09-23 14:24:01.053 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 14:24:01.054 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 14:24:01.055 +01:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.user_id AS "UserId", r.token AS "RefToken", r.expires AS "Expires", r.created AS "Created", r.created_by_ip AS "CreatedByIp", r.revoked AS "Revoked", r.revoked_by_ip AS "RevokedByIp", r.replaced_by_token AS "ReplacedByToken", r.reason_revoked AS "ReasonRevoked", r.is_expired AS "IsExpired", r.is_revoked AS "IsRevoked", r.is_active AS "IsActive"
FROM refresh_token AS r
WHERE r.user_id = @__id_0
2022-09-23 14:24:01.057 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.user_id AS "UserId", r.token AS "RefToken", r.expires AS "Expires", r.created AS "Created", r.created_by_ip AS "CreatedByIp", r.revoked AS "Revoked", r.revoked_by_ip AS "RevokedByIp", r.replaced_by_token AS "ReplacedByToken", r.reason_revoked AS "ReasonRevoked", r.is_expired AS "IsExpired", r.is_revoked AS "IsRevoked", r.is_active AS "IsActive"
FROM refresh_token AS r
WHERE r.user_id = @__id_0
2022-09-23 14:24:01.062 +01:00 [DBG] A data reader was disposed.
2022-09-23 14:24:01.062 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 14:24:01.063 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 14:24:01.068 +01:00 [DBG] An entity of type 'User' tracked by 'PostgresContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 14:24:01.070 +01:00 [DBG] An entity of type 'RefreshToken' tracked by 'PostgresContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 14:24:01.071 +01:00 [DBG] SaveChanges starting for 'PostgresContext'.
2022-09-23 14:24:01.072 +01:00 [DBG] DetectChanges starting for 'PostgresContext'.
2022-09-23 14:24:01.074 +01:00 [DBG] DetectChanges completed for 'PostgresContext'.
2022-09-23 14:24:01.076 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 14:24:01.078 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 14:24:01.081 +01:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2022-09-23 14:24:01.082 +01:00 [DBG] Began transaction with isolation level 'ReadCommitted'.
2022-09-23 14:24:01.108 +01:00 [DBG] Executing 2 update commands as a batch.
2022-09-23 14:24:01.119 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 14:24:01.121 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2022-09-23 14:24:01.122 +01:00 [DBG] Executing DbCommand [Parameters=[@p12='?' (DbType = Int32), @p0='?' (DbType = DateTime), @p1='?', @p2='?' (DbType = DateTime), @p3='?' (DbType = Boolean), @p4='?' (DbType = Boolean), @p5='?' (DbType = Boolean), @p6='?', @p7='?', @p8='?', @p9='?' (DbType = DateTime), @p10='?', @p11='?' (DbType = Int32), @p19='?' (DbType = Int32), @p13='?' (DbType = DateTime), @p14='?', @p15='?', @p16='?' (DbType = DateTime), @p17='?', @p18='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE refresh_token SET created = @p0, created_by_ip = @p1, expires = @p2, is_active = @p3, is_expired = @p4, is_revoked = @p5, reason_revoked = @p6, token = @p7, replaced_by_token = @p8, revoked = @p9, revoked_by_ip = @p10, user_id = @p11
WHERE id = @p12;
UPDATE users SET created_at = @p13, email = @p14, full_name = @p15, password_changed_at = @p16, password_hash = @p17, username = @p18
WHERE id = @p19;
2022-09-23 14:24:01.134 +01:00 [INF] Executed DbCommand (12ms) [Parameters=[@p12='?' (DbType = Int32), @p0='?' (DbType = DateTime), @p1='?', @p2='?' (DbType = DateTime), @p3='?' (DbType = Boolean), @p4='?' (DbType = Boolean), @p5='?' (DbType = Boolean), @p6='?', @p7='?', @p8='?', @p9='?' (DbType = DateTime), @p10='?', @p11='?' (DbType = Int32), @p19='?' (DbType = Int32), @p13='?' (DbType = DateTime), @p14='?', @p15='?', @p16='?' (DbType = DateTime), @p17='?', @p18='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE refresh_token SET created = @p0, created_by_ip = @p1, expires = @p2, is_active = @p3, is_expired = @p4, is_revoked = @p5, reason_revoked = @p6, token = @p7, replaced_by_token = @p8, revoked = @p9, revoked_by_ip = @p10, user_id = @p11
WHERE id = @p12;
UPDATE users SET created_at = @p13, email = @p14, full_name = @p15, password_changed_at = @p16, password_hash = @p17, username = @p18
WHERE id = @p19;
2022-09-23 14:24:01.137 +01:00 [DBG] A data reader was disposed.
2022-09-23 14:24:01.138 +01:00 [DBG] Committing transaction.
2022-09-23 14:24:01.142 +01:00 [DBG] Committed transaction.
2022-09-23 14:24:01.143 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 14:24:01.145 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 14:24:01.146 +01:00 [DBG] Disposing transaction.
2022-09-23 14:24:01.148 +01:00 [DBG] An entity of type 'User' tracked by 'PostgresContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 14:24:01.151 +01:00 [DBG] An entity of type 'RefreshToken' tracked by 'PostgresContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 14:24:01.153 +01:00 [DBG] SaveChanges completed for 'PostgresContext' with 2 entities written to the database.
2022-09-23 14:24:01.160 +01:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2022-09-23 14:24:01.168 +01:00 [DBG] Attempting to select an output formatter based on Accept header '["text/plain"]'.
2022-09-23 14:24:01.169 +01:00 [DBG] Could not find an output formatter based on content negotiation. Accepted types were (["text/plain"])
2022-09-23 14:24:01.170 +01:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2022-09-23 14:24:01.174 +01:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2022-09-23 14:24:01.175 +01:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2022-09-23 14:24:01.177 +01:00 [INF] Executing OkObjectResult, writing value of type 'APIBank.Models.MyRequestResponses.LoginResponse'.
2022-09-23 14:24:01.205 +01:00 [INF] Executed action APIBank.Controllers.UsersController.Login (APIBank) in 6071.8166ms
2022-09-23 14:24:01.208 +01:00 [INF] Executed endpoint 'APIBank.Controllers.UsersController.Login (APIBank)'
2022-09-23 14:24:01.218 +01:00 [DBG] 'PostgresContext' disposed.
2022-09-23 14:24:01.228 +01:00 [INF] Request finished HTTP/2 POST https://localhost:7036/api/Users/Login application/json 58 - 200 - application/json;+charset=utf-8 6948.6234ms
2022-09-23 14:24:16.564 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/api/Accounts/GetAll - -
2022-09-23 14:24:16.568 +01:00 [DBG] 1 candidate(s) found for the request path '/api/Accounts/GetAll'
2022-09-23 14:24:16.570 +01:00 [DBG] Endpoint 'APIBank.Controllers.AccountsController.GetAllFromUser (APIBank)' with route pattern 'api/Accounts/GetAll' is valid for the request path '/api/Accounts/GetAll'
2022-09-23 14:24:16.572 +01:00 [DBG] Request matched endpoint 'APIBank.Controllers.AccountsController.GetAllFromUser (APIBank)'
2022-09-23 14:24:16.575 +01:00 [DBG] Static files was skipped as the request already matched an endpoint.
2022-09-23 14:24:16.736 +01:00 [INF] Entity Framework Core 6.0.9 initialized 'PostgresContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:6.0.7+5b98e4b74de93b590b44aef8dd7967c03acc433c' with options: None
2022-09-23 14:24:16.756 +01:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .FirstOrDefault(e => EF.Property<int>(e, "Id") == __p_0)'
2022-09-23 14:24:16.761 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<User>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: User.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: User.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 1], [Property: User.Email (string) Required Index MaxLength(254), 2], [Property: User.FullName (string) Required MaxLength(100), 3], [Property: User.PasswordChangedAt (DateTime) Required ValueGenerated.OnAdd, 4], [Property: User.PasswordHash (string) Required MaxLength(200), 5], [Property: User.Username (string) Required Index MaxLength(50), 6] }
        SELECT TOP(1) u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
        FROM users AS u
        WHERE u.id == @__p_0), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, User>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)
    .SingleOrDefault()'
2022-09-23 14:24:16.767 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 14:24:16.769 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (2ms).
2022-09-23 14:24:16.770 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 14:24:16.771 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 14:24:16.772 +01:00 [DBG] Executing DbCommand [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.id = @__p_0
LIMIT 1
2022-09-23 14:24:16.774 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.id = @__p_0
LIMIT 1
2022-09-23 14:24:16.776 +01:00 [DBG] Context 'PostgresContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 14:24:16.777 +01:00 [DBG] A data reader was disposed.
2022-09-23 14:24:16.778 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 14:24:16.780 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 14:24:16.782 +01:00 [INF] Executing endpoint 'APIBank.Controllers.AccountsController.GetAllFromUser (APIBank)'
2022-09-23 14:24:16.785 +01:00 [INF] Route matched with {action = "GetAllFromUser", controller = "Accounts"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult GetAllFromUser() on controller APIBank.Controllers.AccountsController (APIBank).
2022-09-23 14:24:16.787 +01:00 [DBG] Execution plan of authorization filters (in the following order): ["APIBank.Authorization.AuthorizeAttribute"]
2022-09-23 14:24:16.788 +01:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2022-09-23 14:24:16.789 +01:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2022-09-23 14:24:16.791 +01:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2022-09-23 14:24:16.792 +01:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2022-09-23 14:24:16.793 +01:00 [DBG] Executing controller factory for controller APIBank.Controllers.AccountsController (APIBank)
2022-09-23 14:24:16.796 +01:00 [DBG] Executed controller factory for controller APIBank.Controllers.AccountsController (APIBank)
2022-09-23 14:24:16.805 +01:00 [DBG] Compiling query expression: 
'DbSet<RefreshToken>()
    .FirstOrDefault(e => EF.Property<int>(e, "Id") == __p_0)'
2022-09-23 14:24:16.810 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<RefreshToken>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: RefreshToken.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: RefreshToken.Created (DateTime) Required, 1], [Property: RefreshToken.CreatedByIp (string) Required MaxLength(200), 2], [Property: RefreshToken.Expires (DateTime) Required, 3], [Property: RefreshToken.IsActive (no field, bool) Required, 4], [Property: RefreshToken.IsExpired (no field, bool) Required, 5], [Property: RefreshToken.IsRevoked (no field, bool) Required, 6], [Property: RefreshToken.ReasonRevoked (string) MaxLength(200), 7], [Property: RefreshToken.RefToken (string) Required MaxLength(254), 8], [Property: RefreshToken.ReplacedByToken (string) MaxLength(200), 9], [Property: RefreshToken.Revoked (DateTime?), 10], [Property: RefreshToken.RevokedByIp (string) MaxLength(200), 11], [Property: RefreshToken.UserId (int) Required FK Index, 12] }
        SELECT TOP(1) r.id, r.created, r.created_by_ip, r.expires, r.is_active, r.is_expired, r.is_revoked, r.reason_revoked, r.token, r.replaced_by_token, r.revoked, r.revoked_by_ip, r.user_id
        FROM refresh_token AS r
        WHERE r.id == @__p_0), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, RefreshToken>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)
    .SingleOrDefault()'
2022-09-23 14:24:16.815 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 14:24:16.816 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2022-09-23 14:24:16.818 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 14:24:16.820 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 14:24:16.821 +01:00 [DBG] Executing DbCommand [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id, r.created, r.created_by_ip, r.expires, r.is_active, r.is_expired, r.is_revoked, r.reason_revoked, r.token, r.replaced_by_token, r.revoked, r.revoked_by_ip, r.user_id
FROM refresh_token AS r
WHERE r.id = @__p_0
LIMIT 1
2022-09-23 14:24:16.823 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id, r.created, r.created_by_ip, r.expires, r.is_active, r.is_expired, r.is_revoked, r.reason_revoked, r.token, r.replaced_by_token, r.revoked, r.revoked_by_ip, r.user_id
FROM refresh_token AS r
WHERE r.id = @__p_0
LIMIT 1
2022-09-23 14:24:16.827 +01:00 [DBG] Context 'PostgresContext' started tracking 'RefreshToken' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 14:24:16.830 +01:00 [DBG] A data reader was disposed.
2022-09-23 14:24:16.832 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 14:24:16.833 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 14:24:16.840 +01:00 [DBG] Compiling query expression: 
'DbSet<Account>()
    .Where(u => u.UserId == __userId_0)
    .Select(u => new AccountRequestResponse{ 
        Balance = u.Balance, 
        CreatedAt = u.CreatedAt, 
        Currency = u.Currency, 
        Id = u.Id 
    }
    )'
2022-09-23 14:24:16.848 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<AccountRequestResponse>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            Balance -> 0
            CreatedAt -> 1
            Currency -> 2
            Id -> 3
        SELECT a.balance AS Balance, a.created_at AS CreatedAt, a.currency AS Currency, a.id AS Id
        FROM accounts AS a
        WHERE a.user_id == @__userId_0), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, AccountRequestResponse>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)'
2022-09-23 14:24:16.852 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 14:24:16.853 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2022-09-23 14:24:16.855 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 14:24:16.858 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 14:24:16.859 +01:00 [DBG] Executing DbCommand [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a.balance AS "Balance", a.created_at AS "CreatedAt", a.currency AS "Currency", a.id AS "Id"
FROM accounts AS a
WHERE a.user_id = @__userId_0
2022-09-23 14:24:16.866 +01:00 [INF] Executed DbCommand (7ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a.balance AS "Balance", a.created_at AS "CreatedAt", a.currency AS "Currency", a.id AS "Id"
FROM accounts AS a
WHERE a.user_id = @__userId_0
2022-09-23 14:24:16.888 +01:00 [DBG] A data reader was disposed.
2022-09-23 14:24:16.890 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 14:24:16.891 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 14:24:16.893 +01:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2022-09-23 14:24:16.898 +01:00 [DBG] Attempting to select an output formatter based on Accept header '["text/plain"]'.
2022-09-23 14:24:16.899 +01:00 [DBG] Could not find an output formatter based on content negotiation. Accepted types were (["text/plain"])
2022-09-23 14:24:16.902 +01:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2022-09-23 14:24:16.907 +01:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2022-09-23 14:24:16.908 +01:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2022-09-23 14:24:16.910 +01:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[APIBank.Models.Responses.AccountRequestResponse, APIBank, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2022-09-23 14:24:16.927 +01:00 [INF] Executed action APIBank.Controllers.AccountsController.GetAllFromUser (APIBank) in 134.3899ms
2022-09-23 14:24:16.937 +01:00 [INF] Executed endpoint 'APIBank.Controllers.AccountsController.GetAllFromUser (APIBank)'
2022-09-23 14:24:16.939 +01:00 [DBG] 'PostgresContext' disposed.
2022-09-23 14:24:16.940 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/api/Accounts/GetAll - - - 200 - application/json;+charset=utf-8 375.4453ms
2022-09-23 14:24:37.578 +01:00 [INF] Request starting HTTP/2 POST https://localhost:7036/api/Users/revoke-token application/json 20
2022-09-23 14:24:37.585 +01:00 [DBG] 1 candidate(s) found for the request path '/api/Users/revoke-token'
2022-09-23 14:24:37.586 +01:00 [DBG] Endpoint 'APIBank.Controllers.UsersController.RevokeToken (APIBank)' with route pattern 'api/Users/revoke-token' is valid for the request path '/api/Users/revoke-token'
2022-09-23 14:24:37.587 +01:00 [DBG] Request matched endpoint 'APIBank.Controllers.UsersController.RevokeToken (APIBank)'
2022-09-23 14:24:37.588 +01:00 [DBG] Static files was skipped as the request already matched an endpoint.
2022-09-23 14:24:37.667 +01:00 [INF] Entity Framework Core 6.0.9 initialized 'PostgresContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:6.0.7+5b98e4b74de93b590b44aef8dd7967c03acc433c' with options: None
2022-09-23 14:24:37.677 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 14:24:37.678 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2022-09-23 14:24:37.681 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 14:24:37.683 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 14:24:37.684 +01:00 [DBG] Executing DbCommand [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.id = @__p_0
LIMIT 1
2022-09-23 14:24:37.686 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.id = @__p_0
LIMIT 1
2022-09-23 14:24:37.688 +01:00 [DBG] Context 'PostgresContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 14:24:37.689 +01:00 [DBG] A data reader was disposed.
2022-09-23 14:24:37.691 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 14:24:37.692 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 14:24:37.693 +01:00 [INF] Executing endpoint 'APIBank.Controllers.UsersController.RevokeToken (APIBank)'
2022-09-23 14:24:37.697 +01:00 [INF] Route matched with {action = "RevokeToken", controller = "Users"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult RevokeToken(APIBank.Models.MyRequestResponses.UserRevokeTokenRequest) on controller APIBank.Controllers.UsersController (APIBank).
2022-09-23 14:24:37.699 +01:00 [DBG] Execution plan of authorization filters (in the following order): ["APIBank.Authorization.AuthorizeAttribute"]
2022-09-23 14:24:37.700 +01:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2022-09-23 14:24:37.701 +01:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2022-09-23 14:24:37.703 +01:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2022-09-23 14:24:37.704 +01:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2022-09-23 14:24:37.707 +01:00 [DBG] Executing controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-23 14:24:37.708 +01:00 [DBG] Executed controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-23 14:24:37.710 +01:00 [DBG] Attempting to bind parameter 'model' of type 'APIBank.Models.MyRequestResponses.UserRevokeTokenRequest' ...
2022-09-23 14:24:37.715 +01:00 [DBG] Attempting to bind parameter 'model' of type 'APIBank.Models.MyRequestResponses.UserRevokeTokenRequest' using the name '' in request data ...
2022-09-23 14:24:37.717 +01:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2022-09-23 14:24:37.719 +01:00 [DBG] Connection id "0HMKTCRC2MBOU", Request id "0HMKTCRC2MBOU:0000000D": started reading request body.
2022-09-23 14:24:37.723 +01:00 [DBG] Connection id "0HMKTCRC2MBOU", Request id "0HMKTCRC2MBOU:0000000D": done reading request body.
2022-09-23 14:24:37.727 +01:00 [DBG] JSON input formatter succeeded, deserializing to type 'APIBank.Models.MyRequestResponses.UserRevokeTokenRequest'
2022-09-23 14:24:37.735 +01:00 [DBG] Done attempting to bind parameter 'model' of type 'APIBank.Models.MyRequestResponses.UserRevokeTokenRequest'.
2022-09-23 14:24:37.739 +01:00 [DBG] Done attempting to bind parameter 'model' of type 'APIBank.Models.MyRequestResponses.UserRevokeTokenRequest'.
2022-09-23 14:24:37.741 +01:00 [DBG] Attempting to validate the bound parameter 'model' of type 'APIBank.Models.MyRequestResponses.UserRevokeTokenRequest' ...
2022-09-23 14:24:37.747 +01:00 [DBG] Done attempting to validate the bound parameter 'model' of type 'APIBank.Models.MyRequestResponses.UserRevokeTokenRequest'.
2022-09-23 14:24:37.754 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 14:24:37.756 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2022-09-23 14:24:37.757 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 14:24:37.759 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 14:24:37.761 +01:00 [DBG] Executing DbCommand [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id, r.created, r.created_by_ip, r.expires, r.is_active, r.is_expired, r.is_revoked, r.reason_revoked, r.token, r.replaced_by_token, r.revoked, r.revoked_by_ip, r.user_id
FROM refresh_token AS r
WHERE r.id = @__p_0
LIMIT 1
2022-09-23 14:24:37.765 +01:00 [INF] Executed DbCommand (4ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id, r.created, r.created_by_ip, r.expires, r.is_active, r.is_expired, r.is_revoked, r.reason_revoked, r.token, r.replaced_by_token, r.revoked, r.revoked_by_ip, r.user_id
FROM refresh_token AS r
WHERE r.id = @__p_0
LIMIT 1
2022-09-23 14:24:37.768 +01:00 [DBG] Context 'PostgresContext' started tracking 'RefreshToken' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 14:24:37.770 +01:00 [DBG] A data reader was disposed.
2022-09-23 14:24:37.771 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 14:24:37.772 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 14:24:42.764 +01:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .SingleOrDefault(userQuery => userQuery.RefreshTokenCollection
        .Any(refTokenQuery => refTokenQuery.RefToken == __refToken_0))'
2022-09-23 14:24:42.775 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<User>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: User.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: User.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 1], [Property: User.Email (string) Required Index MaxLength(254), 2], [Property: User.FullName (string) Required MaxLength(100), 3], [Property: User.PasswordChangedAt (DateTime) Required ValueGenerated.OnAdd, 4], [Property: User.PasswordHash (string) Required MaxLength(200), 5], [Property: User.Username (string) Required Index MaxLength(50), 6] }
        SELECT TOP(2) u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
        FROM users AS u
        WHERE EXISTS (
            SELECT 1
            FROM refresh_token AS r
            WHERE ((u.id != NULL) && (u.id == r.user_id)) && (r.token == @__refToken_0))), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, User>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)
    .SingleOrDefault()'
2022-09-23 14:24:42.779 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 14:24:42.780 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2022-09-23 14:24:42.781 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 14:24:42.782 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 14:24:42.784 +01:00 [DBG] Executing DbCommand [Parameters=[@__refToken_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE EXISTS (
    SELECT 1
    FROM refresh_token AS r
    WHERE (u.id = r.user_id) AND (r.token = @__refToken_0))
LIMIT 2
2022-09-23 14:24:42.787 +01:00 [INF] Executed DbCommand (3ms) [Parameters=[@__refToken_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE EXISTS (
    SELECT 1
    FROM refresh_token AS r
    WHERE (u.id = r.user_id) AND (r.token = @__refToken_0))
LIMIT 2
2022-09-23 14:24:42.788 +01:00 [DBG] A data reader was disposed.
2022-09-23 14:24:42.789 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 14:24:42.795 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 14:24:42.800 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 14:24:42.800 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2022-09-23 14:24:42.801 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 14:24:42.802 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 14:24:42.804 +01:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.user_id AS "UserId", r.token AS "RefToken", r.expires AS "Expires", r.created AS "Created", r.created_by_ip AS "CreatedByIp", r.revoked AS "Revoked", r.revoked_by_ip AS "RevokedByIp", r.replaced_by_token AS "ReplacedByToken", r.reason_revoked AS "ReasonRevoked", r.is_expired AS "IsExpired", r.is_revoked AS "IsRevoked", r.is_active AS "IsActive"
FROM refresh_token AS r
WHERE r.user_id = @__id_0
2022-09-23 14:24:42.809 +01:00 [INF] Executed DbCommand (6ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.user_id AS "UserId", r.token AS "RefToken", r.expires AS "Expires", r.created AS "Created", r.created_by_ip AS "CreatedByIp", r.revoked AS "Revoked", r.revoked_by_ip AS "RevokedByIp", r.replaced_by_token AS "ReplacedByToken", r.reason_revoked AS "ReasonRevoked", r.is_expired AS "IsExpired", r.is_revoked AS "IsRevoked", r.is_active AS "IsActive"
FROM refresh_token AS r
WHERE r.user_id = @__id_0
2022-09-23 14:24:42.814 +01:00 [DBG] A data reader was disposed.
2022-09-23 14:24:42.815 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 14:24:42.816 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 14:24:42.819 +01:00 [DBG] An entity of type 'User' tracked by 'PostgresContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 14:24:45.714 +01:00 [INF] Executed action APIBank.Controllers.UsersController.RevokeToken (APIBank) in 8007.0363ms
2022-09-23 14:24:45.720 +01:00 [INF] Executed endpoint 'APIBank.Controllers.UsersController.RevokeToken (APIBank)'
2022-09-23 14:24:45.781 +01:00 [INF] Global Error was found:
2022-09-23 14:24:45.785 +01:00 [DBG] 'PostgresContext' disposed.
2022-09-23 14:24:45.789 +01:00 [INF] Request finished HTTP/2 POST https://localhost:7036/api/Users/revoke-token application/json 20 - 500 - application/json 8210.4424ms
2022-09-23 14:39:48.938 +01:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2022-09-23 14:39:49.014 +01:00 [DBG] Hosting starting
2022-09-23 14:39:49.123 +01:00 [DBG] Using development certificate: CN=localhost (Thumbprint: 9CC642E9838495A6C3C202DECA6A8AD300396DD2)
2022-09-23 14:39:49.172 +01:00 [INF] Now listening on: https://localhost:7036
2022-09-23 14:39:49.174 +01:00 [INF] Now listening on: http://localhost:5036
2022-09-23 14:39:49.177 +01:00 [DBG] Loaded hosting startup assembly APIBank
2022-09-23 14:39:49.178 +01:00 [DBG] Loaded hosting startup assembly Microsoft.AspNetCore.Watch.BrowserRefresh
2022-09-23 14:39:49.179 +01:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.BrowserLink.Net
2022-09-23 14:39:49.180 +01:00 [INF] Application started. Press Ctrl+C to shut down.
2022-09-23 14:39:49.181 +01:00 [INF] Hosting environment: Development
2022-09-23 14:39:49.182 +01:00 [INF] Content root path: C:\Users\mguedesa\OneDrive - NTT DATA EMEAL\Documentos\GitHub\OpenBankAPI-NTT\APIBank\APIBank\
2022-09-23 14:39:49.182 +01:00 [DBG] Hosting started
2022-09-23 14:39:49.201 +01:00 [DBG] Connection id "0HMKTD4AVECCB" accepted.
2022-09-23 14:39:49.201 +01:00 [DBG] Connection id "0HMKTD4AVECCC" accepted.
2022-09-23 14:39:49.203 +01:00 [DBG] Connection id "0HMKTD4AVECCB" started.
2022-09-23 14:39:49.203 +01:00 [DBG] Connection id "0HMKTD4AVECCC" started.
2022-09-23 14:39:49.210 +01:00 [DBG] Connection id "0HMKTD4AVECCB" received FIN.
2022-09-23 14:39:49.210 +01:00 [DBG] Connection id "0HMKTD4AVECCC" received FIN.
2022-09-23 14:39:49.222 +01:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException:  Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveBlobAsync[TIOAdapter](TIOAdapter adapter)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](TIOAdapter adapter, Boolean receiveFirst, Byte[] reAuthenticationData, Boolean isApm)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2022-09-23 14:39:49.222 +01:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException:  Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveBlobAsync[TIOAdapter](TIOAdapter adapter)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](TIOAdapter adapter, Boolean receiveFirst, Byte[] reAuthenticationData, Boolean isApm)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2022-09-23 14:39:49.251 +01:00 [DBG] Connection id "0HMKTD4AVECCC" stopped.
2022-09-23 14:39:49.251 +01:00 [DBG] Connection id "0HMKTD4AVECCB" stopped.
2022-09-23 14:39:49.254 +01:00 [DBG] Connection id "0HMKTD4AVECCC" sending FIN because: "The Socket transport's send loop completed gracefully."
2022-09-23 14:39:49.254 +01:00 [DBG] Connection id "0HMKTD4AVECCB" sending FIN because: "The Socket transport's send loop completed gracefully."
2022-09-23 14:39:50.018 +01:00 [DBG] Connection id "0HMKTD4AVECCD" accepted.
2022-09-23 14:39:50.081 +01:00 [DBG] Connection id "0HMKTD4AVECCD" started.
2022-09-23 14:39:50.277 +01:00 [DBG] Connection 0HMKTD4AVECCD established using the following protocol: "Tls12"
2022-09-23 14:39:50.496 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/swagger/index.html - -
2022-09-23 14:39:50.572 +01:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2022-09-23 14:39:50.670 +01:00 [DBG] No candidates found for the request path '/swagger/index.html'
2022-09-23 14:39:50.672 +01:00 [DBG] Request did not match any endpoints
2022-09-23 14:39:50.968 +01:00 [DBG] Response markup is scheduled to include browser refresh script injection.
2022-09-23 14:39:51.215 +01:00 [DBG] Response markup was updated to include browser refresh script injection.
2022-09-23 14:39:51.222 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/swagger/index.html - - - 200 - text/html;charset=utf-8 760.4143ms
2022-09-23 14:39:51.285 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/_framework/aspnetcore-browser-refresh.js - -
2022-09-23 14:39:51.314 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/_framework/aspnetcore-browser-refresh.js - - - 200 11984 application/javascript;+charset=utf-8 9.0799ms
2022-09-23 14:39:51.334 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/_vs/browserLink - -
2022-09-23 14:39:51.376 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/_vs/browserLink - - - 200 - text/javascript;+charset=UTF-8 41.8554ms
2022-09-23 14:39:51.638 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/swagger/v1/swagger.json - -
2022-09-23 14:39:51.642 +01:00 [DBG] No candidates found for the request path '/swagger/v1/swagger.json'
2022-09-23 14:39:51.652 +01:00 [DBG] Request did not match any endpoints
2022-09-23 14:39:52.076 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/swagger/v1/swagger.json - - - 200 - application/json;charset=utf-8 438.1468ms
2022-09-23 14:40:03.157 +01:00 [INF] Request starting HTTP/2 POST https://localhost:7036/api/Users/Login application/json 58
2022-09-23 14:40:03.170 +01:00 [DBG] 1 candidate(s) found for the request path '/api/Users/Login'
2022-09-23 14:40:03.177 +01:00 [DBG] Endpoint 'APIBank.Controllers.UsersController.Login (APIBank)' with route pattern 'api/Users/Login' is valid for the request path '/api/Users/Login'
2022-09-23 14:40:03.186 +01:00 [DBG] Request matched endpoint 'APIBank.Controllers.UsersController.Login (APIBank)'
2022-09-23 14:40:03.205 +01:00 [DBG] Static files was skipped as the request already matched an endpoint.
2022-09-23 14:40:04.013 +01:00 [INF] Executing endpoint 'APIBank.Controllers.UsersController.Login (APIBank)'
2022-09-23 14:40:04.059 +01:00 [INF] Route matched with {action = "Login", controller = "Users"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult Login(APIBank.Models.Requests.UserLoginRequest) on controller APIBank.Controllers.UsersController (APIBank).
2022-09-23 14:40:04.064 +01:00 [DBG] Execution plan of authorization filters (in the following order): ["APIBank.Authorization.AuthorizeAttribute"]
2022-09-23 14:40:04.068 +01:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2022-09-23 14:40:04.072 +01:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2022-09-23 14:40:04.074 +01:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2022-09-23 14:40:04.075 +01:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2022-09-23 14:40:04.080 +01:00 [DBG] Executing controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-23 14:40:04.081 +01:00 [DBG] Executed controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-23 14:40:04.119 +01:00 [DBG] Attempting to bind parameter 'model' of type 'APIBank.Models.Requests.UserLoginRequest' ...
2022-09-23 14:40:04.122 +01:00 [DBG] Attempting to bind parameter 'model' of type 'APIBank.Models.Requests.UserLoginRequest' using the name '' in request data ...
2022-09-23 14:40:04.124 +01:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2022-09-23 14:40:04.133 +01:00 [DBG] Connection id "0HMKTD4AVECCD", Request id "0HMKTD4AVECCD:00000009": started reading request body.
2022-09-23 14:40:04.137 +01:00 [DBG] Connection id "0HMKTD4AVECCD", Request id "0HMKTD4AVECCD:00000009": done reading request body.
2022-09-23 14:40:04.141 +01:00 [DBG] JSON input formatter succeeded, deserializing to type 'APIBank.Models.Requests.UserLoginRequest'
2022-09-23 14:40:04.142 +01:00 [DBG] Done attempting to bind parameter 'model' of type 'APIBank.Models.Requests.UserLoginRequest'.
2022-09-23 14:40:04.146 +01:00 [DBG] Done attempting to bind parameter 'model' of type 'APIBank.Models.Requests.UserLoginRequest'.
2022-09-23 14:40:04.148 +01:00 [DBG] Attempting to validate the bound parameter 'model' of type 'APIBank.Models.Requests.UserLoginRequest' ...
2022-09-23 14:40:04.178 +01:00 [DBG] Done attempting to validate the bound parameter 'model' of type 'APIBank.Models.Requests.UserLoginRequest'.
2022-09-23 14:40:04.277 +01:00 [DBG] An additional 'IServiceProvider' was created for internal use by Entity Framework. An existing service provider was not used due to the following configuration changes: configuration changed for 'Core:ConfigureWarnings', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:UseAdminDatabase', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:SetPostgresVersion', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:UseRedshift', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:ReverseNullOrdering', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:RemoteCertificateValidationCallback', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:ProvideClientCertificatesCallback', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:ProvidePasswordCallback'.
2022-09-23 14:40:06.024 +01:00 [INF] Entity Framework Core 6.0.9 initialized 'PostgresContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:6.0.7+5b98e4b74de93b590b44aef8dd7967c03acc433c' with options: None
2022-09-23 14:40:06.115 +01:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .SingleOrDefault(x => x.Username == __model_Username_0)'
2022-09-23 14:40:06.454 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<User>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: User.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: User.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 1], [Property: User.Email (string) Required Index MaxLength(254), 2], [Property: User.FullName (string) Required MaxLength(100), 3], [Property: User.PasswordChangedAt (DateTime) Required ValueGenerated.OnAdd, 4], [Property: User.PasswordHash (string) Required MaxLength(200), 5], [Property: User.Username (string) Required Index MaxLength(50), 6] }
        SELECT TOP(2) u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
        FROM users AS u
        WHERE u.username == @__model_Username_0), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, User>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)
    .SingleOrDefault()'
2022-09-23 14:40:06.539 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 14:40:06.603 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (57ms).
2022-09-23 14:40:06.630 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 14:40:06.988 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 14:40:07.006 +01:00 [DBG] Executing DbCommand [Parameters=[@__model_Username_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.username = @__model_Username_0
LIMIT 2
2022-09-23 14:40:07.123 +01:00 [INF] Executed DbCommand (123ms) [Parameters=[@__model_Username_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.username = @__model_Username_0
LIMIT 2
2022-09-23 14:40:07.198 +01:00 [DBG] Context 'PostgresContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 14:40:07.270 +01:00 [DBG] A data reader was disposed.
2022-09-23 14:40:07.274 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 14:40:07.282 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 14:40:07.529 +01:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .Any(user => user.RefreshTokenCollection
        .Any(reftoken => reftoken.RefToken == __token_0))'
2022-09-23 14:40:07.637 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<bool>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            EmptyProjectionMember -> 0
        SELECT EXISTS (
            SELECT 1
            FROM users AS u
            WHERE EXISTS (
                SELECT 1
                FROM refresh_token AS r
                WHERE ((u.id != NULL) && (u.id == r.user_id)) && (r.token == @__token_0)))), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, bool>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)
    .Single()'
2022-09-23 14:40:07.648 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 14:40:07.649 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2022-09-23 14:40:07.650 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 14:40:07.651 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 14:40:07.652 +01:00 [DBG] Executing DbCommand [Parameters=[@__token_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM users AS u
    WHERE EXISTS (
        SELECT 1
        FROM refresh_token AS r
        WHERE (u.id = r.user_id) AND (r.token = @__token_0)))
2022-09-23 14:40:07.655 +01:00 [INF] Executed DbCommand (3ms) [Parameters=[@__token_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM users AS u
    WHERE EXISTS (
        SELECT 1
        FROM refresh_token AS r
        WHERE (u.id = r.user_id) AND (r.token = @__token_0)))
2022-09-23 14:40:07.669 +01:00 [DBG] A data reader was disposed.
2022-09-23 14:40:07.677 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 14:40:07.680 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 14:40:07.685 +01:00 [DBG] SaveChanges starting for 'PostgresContext'.
2022-09-23 14:40:07.689 +01:00 [DBG] DetectChanges starting for 'PostgresContext'.
2022-09-23 14:40:07.717 +01:00 [DBG] 1 entities were added and 0 entities were removed from navigation 'User.RefreshTokenCollection'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 14:40:07.767 +01:00 [DBG] 'PostgresContext' generated a temporary value for the property 'Id.RefreshToken'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 14:40:07.845 +01:00 [DBG] Context 'PostgresContext' started tracking 'RefreshToken' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 14:40:07.867 +01:00 [DBG] DetectChanges completed for 'PostgresContext'.
2022-09-23 14:40:07.879 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 14:40:07.880 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 14:40:07.882 +01:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2022-09-23 14:40:07.890 +01:00 [DBG] Began transaction with isolation level 'ReadCommitted'.
2022-09-23 14:40:07.987 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 14:40:07.989 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2022-09-23 14:40:07.991 +01:00 [DBG] Executing DbCommand [Parameters=[@p0='?' (DbType = DateTime), @p1='?', @p2='?' (DbType = DateTime), @p3='?' (DbType = Boolean), @p4='?' (DbType = Boolean), @p5='?' (DbType = Boolean), @p6='?', @p7='?', @p8='?', @p9='?' (DbType = DateTime), @p10='?', @p11='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO refresh_token (created, created_by_ip, expires, is_active, is_expired, is_revoked, reason_revoked, token, replaced_by_token, revoked, revoked_by_ip, user_id)
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11)
RETURNING id;
2022-09-23 14:40:08.022 +01:00 [INF] Executed DbCommand (31ms) [Parameters=[@p0='?' (DbType = DateTime), @p1='?', @p2='?' (DbType = DateTime), @p3='?' (DbType = Boolean), @p4='?' (DbType = Boolean), @p5='?' (DbType = Boolean), @p6='?', @p7='?', @p8='?', @p9='?' (DbType = DateTime), @p10='?', @p11='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO refresh_token (created, created_by_ip, expires, is_active, is_expired, is_revoked, reason_revoked, token, replaced_by_token, revoked, revoked_by_ip, user_id)
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11)
RETURNING id;
2022-09-23 14:40:08.043 +01:00 [DBG] The foreign key property 'RefreshToken.Id' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2022-09-23 14:40:08.071 +01:00 [DBG] A data reader was disposed.
2022-09-23 14:40:08.074 +01:00 [DBG] Committing transaction.
2022-09-23 14:40:08.081 +01:00 [DBG] Committed transaction.
2022-09-23 14:40:08.083 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 14:40:08.084 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 14:40:08.086 +01:00 [DBG] Disposing transaction.
2022-09-23 14:40:08.105 +01:00 [DBG] An entity of type 'RefreshToken' tracked by 'PostgresContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 14:40:08.123 +01:00 [DBG] SaveChanges completed for 'PostgresContext' with 1 entities written to the database.
2022-09-23 14:40:08.332 +01:00 [DBG] Compiling query expression: 
'DbSet<RefreshToken>()
    .Where(rt => rt.UserId == __id_0)
    .AsNoTracking()
    .Select(rt => new RefreshToken{ 
        Id = rt.Id, 
        UserId = rt.UserId, 
        RefToken = rt.RefToken, 
        Expires = rt.Expires, 
        Created = rt.Created, 
        CreatedByIp = rt.CreatedByIp, 
        Revoked = rt.Revoked, 
        RevokedByIp = rt.RevokedByIp, 
        ReplacedByToken = rt.ReplacedByToken, 
        ReasonRevoked = rt.ReasonRevoked, 
        IsExpired = rt.IsExpired, 
        IsRevoked = rt.IsRevoked, 
        IsActive = rt.IsActive 
    }
    )'
2022-09-23 14:40:08.376 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<RefreshToken>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            Id -> 0
            UserId -> 1
            RefToken -> 2
            Expires -> 3
            Created -> 4
            CreatedByIp -> 5
            Revoked -> 6
            RevokedByIp -> 7
            ReplacedByToken -> 8
            ReasonRevoked -> 9
            IsExpired -> 10
            IsRevoked -> 11
            IsActive -> 12
        SELECT r.id AS Id, r.user_id AS UserId, r.token AS RefToken, r.expires AS Expires, r.created AS Created, r.created_by_ip AS CreatedByIp, r.revoked AS Revoked, r.revoked_by_ip AS RevokedByIp, r.replaced_by_token AS ReplacedByToken, r.reason_revoked AS ReasonRevoked, r.is_expired AS IsExpired, r.is_revoked AS IsRevoked, r.is_active AS IsActive
        FROM refresh_token AS r
        WHERE r.user_id == @__id_0), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, RefreshToken>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)'
2022-09-23 14:40:08.380 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 14:40:08.381 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2022-09-23 14:40:08.382 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 14:40:08.384 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 14:40:08.386 +01:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.user_id AS "UserId", r.token AS "RefToken", r.expires AS "Expires", r.created AS "Created", r.created_by_ip AS "CreatedByIp", r.revoked AS "Revoked", r.revoked_by_ip AS "RevokedByIp", r.replaced_by_token AS "ReplacedByToken", r.reason_revoked AS "ReasonRevoked", r.is_expired AS "IsExpired", r.is_revoked AS "IsRevoked", r.is_active AS "IsActive"
FROM refresh_token AS r
WHERE r.user_id = @__id_0
2022-09-23 14:40:08.388 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.user_id AS "UserId", r.token AS "RefToken", r.expires AS "Expires", r.created AS "Created", r.created_by_ip AS "CreatedByIp", r.revoked AS "Revoked", r.revoked_by_ip AS "RevokedByIp", r.replaced_by_token AS "ReplacedByToken", r.reason_revoked AS "ReasonRevoked", r.is_expired AS "IsExpired", r.is_revoked AS "IsRevoked", r.is_active AS "IsActive"
FROM refresh_token AS r
WHERE r.user_id = @__id_0
2022-09-23 14:40:08.390 +01:00 [DBG] A data reader was disposed.
2022-09-23 14:40:08.392 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 14:40:08.394 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 14:40:08.401 +01:00 [DBG] An entity of type 'User' tracked by 'PostgresContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 14:40:08.413 +01:00 [DBG] An entity of type 'RefreshToken' tracked by 'PostgresContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 14:40:08.421 +01:00 [DBG] SaveChanges starting for 'PostgresContext'.
2022-09-23 14:40:08.422 +01:00 [DBG] DetectChanges starting for 'PostgresContext'.
2022-09-23 14:40:08.425 +01:00 [DBG] DetectChanges completed for 'PostgresContext'.
2022-09-23 14:40:08.429 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 14:40:08.432 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 14:40:08.434 +01:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2022-09-23 14:40:08.435 +01:00 [DBG] Began transaction with isolation level 'ReadCommitted'.
2022-09-23 14:40:08.474 +01:00 [DBG] Executing 2 update commands as a batch.
2022-09-23 14:40:08.481 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 14:40:08.482 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2022-09-23 14:40:08.483 +01:00 [DBG] Executing DbCommand [Parameters=[@p12='?' (DbType = Int32), @p0='?' (DbType = DateTime), @p1='?', @p2='?' (DbType = DateTime), @p3='?' (DbType = Boolean), @p4='?' (DbType = Boolean), @p5='?' (DbType = Boolean), @p6='?', @p7='?', @p8='?', @p9='?' (DbType = DateTime), @p10='?', @p11='?' (DbType = Int32), @p19='?' (DbType = Int32), @p13='?' (DbType = DateTime), @p14='?', @p15='?', @p16='?' (DbType = DateTime), @p17='?', @p18='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE refresh_token SET created = @p0, created_by_ip = @p1, expires = @p2, is_active = @p3, is_expired = @p4, is_revoked = @p5, reason_revoked = @p6, token = @p7, replaced_by_token = @p8, revoked = @p9, revoked_by_ip = @p10, user_id = @p11
WHERE id = @p12;
UPDATE users SET created_at = @p13, email = @p14, full_name = @p15, password_changed_at = @p16, password_hash = @p17, username = @p18
WHERE id = @p19;
2022-09-23 14:40:08.486 +01:00 [INF] Executed DbCommand (3ms) [Parameters=[@p12='?' (DbType = Int32), @p0='?' (DbType = DateTime), @p1='?', @p2='?' (DbType = DateTime), @p3='?' (DbType = Boolean), @p4='?' (DbType = Boolean), @p5='?' (DbType = Boolean), @p6='?', @p7='?', @p8='?', @p9='?' (DbType = DateTime), @p10='?', @p11='?' (DbType = Int32), @p19='?' (DbType = Int32), @p13='?' (DbType = DateTime), @p14='?', @p15='?', @p16='?' (DbType = DateTime), @p17='?', @p18='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE refresh_token SET created = @p0, created_by_ip = @p1, expires = @p2, is_active = @p3, is_expired = @p4, is_revoked = @p5, reason_revoked = @p6, token = @p7, replaced_by_token = @p8, revoked = @p9, revoked_by_ip = @p10, user_id = @p11
WHERE id = @p12;
UPDATE users SET created_at = @p13, email = @p14, full_name = @p15, password_changed_at = @p16, password_hash = @p17, username = @p18
WHERE id = @p19;
2022-09-23 14:40:08.488 +01:00 [DBG] A data reader was disposed.
2022-09-23 14:40:08.489 +01:00 [DBG] Committing transaction.
2022-09-23 14:40:08.493 +01:00 [DBG] Committed transaction.
2022-09-23 14:40:08.496 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 14:40:08.498 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 14:40:08.502 +01:00 [DBG] Disposing transaction.
2022-09-23 14:40:08.511 +01:00 [DBG] An entity of type 'User' tracked by 'PostgresContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 14:40:08.522 +01:00 [DBG] An entity of type 'RefreshToken' tracked by 'PostgresContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 14:40:08.526 +01:00 [DBG] SaveChanges completed for 'PostgresContext' with 2 entities written to the database.
2022-09-23 14:40:08.532 +01:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2022-09-23 14:40:08.539 +01:00 [DBG] Attempting to select an output formatter based on Accept header '["text/plain"]'.
2022-09-23 14:40:08.545 +01:00 [DBG] Could not find an output formatter based on content negotiation. Accepted types were (["text/plain"])
2022-09-23 14:40:08.548 +01:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2022-09-23 14:40:08.549 +01:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2022-09-23 14:40:08.551 +01:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2022-09-23 14:40:08.553 +01:00 [INF] Executing OkObjectResult, writing value of type 'APIBank.Models.MyRequestResponses.LoginResponse'.
2022-09-23 14:40:08.606 +01:00 [INF] Executed action APIBank.Controllers.UsersController.Login (APIBank) in 4512.0165ms
2022-09-23 14:40:08.612 +01:00 [INF] Executed endpoint 'APIBank.Controllers.UsersController.Login (APIBank)'
2022-09-23 14:40:08.614 +01:00 [DBG] 'PostgresContext' disposed.
2022-09-23 14:40:08.620 +01:00 [INF] Request finished HTTP/2 POST https://localhost:7036/api/Users/Login application/json 58 - 200 - application/json;+charset=utf-8 5463.2057ms
2022-09-23 14:40:21.828 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/api/Accounts/GetAll - -
2022-09-23 14:40:21.836 +01:00 [DBG] 1 candidate(s) found for the request path '/api/Accounts/GetAll'
2022-09-23 14:40:21.871 +01:00 [DBG] Endpoint 'APIBank.Controllers.AccountsController.GetAllFromUser (APIBank)' with route pattern 'api/Accounts/GetAll' is valid for the request path '/api/Accounts/GetAll'
2022-09-23 14:40:21.873 +01:00 [DBG] Request matched endpoint 'APIBank.Controllers.AccountsController.GetAllFromUser (APIBank)'
2022-09-23 14:40:21.877 +01:00 [DBG] Static files was skipped as the request already matched an endpoint.
2022-09-23 14:40:22.511 +01:00 [INF] Entity Framework Core 6.0.9 initialized 'PostgresContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:6.0.7+5b98e4b74de93b590b44aef8dd7967c03acc433c' with options: None
2022-09-23 14:40:22.594 +01:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .FirstOrDefault(e => EF.Property<int>(e, "Id") == __p_0)'
2022-09-23 14:40:22.641 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<User>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: User.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: User.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 1], [Property: User.Email (string) Required Index MaxLength(254), 2], [Property: User.FullName (string) Required MaxLength(100), 3], [Property: User.PasswordChangedAt (DateTime) Required ValueGenerated.OnAdd, 4], [Property: User.PasswordHash (string) Required MaxLength(200), 5], [Property: User.Username (string) Required Index MaxLength(50), 6] }
        SELECT TOP(1) u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
        FROM users AS u
        WHERE u.id == @__p_0), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, User>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)
    .SingleOrDefault()'
2022-09-23 14:40:22.660 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 14:40:22.677 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (16ms).
2022-09-23 14:40:22.724 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 14:40:22.726 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 14:40:22.730 +01:00 [DBG] Executing DbCommand [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.id = @__p_0
LIMIT 1
2022-09-23 14:40:22.738 +01:00 [INF] Executed DbCommand (10ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.id = @__p_0
LIMIT 1
2022-09-23 14:40:22.748 +01:00 [DBG] Context 'PostgresContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 14:40:22.769 +01:00 [DBG] A data reader was disposed.
2022-09-23 14:40:22.775 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 14:40:22.777 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 14:40:22.778 +01:00 [INF] Executing endpoint 'APIBank.Controllers.AccountsController.GetAllFromUser (APIBank)'
2022-09-23 14:40:22.783 +01:00 [INF] Route matched with {action = "GetAllFromUser", controller = "Accounts"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult GetAllFromUser() on controller APIBank.Controllers.AccountsController (APIBank).
2022-09-23 14:40:22.786 +01:00 [DBG] Execution plan of authorization filters (in the following order): ["APIBank.Authorization.AuthorizeAttribute"]
2022-09-23 14:40:22.790 +01:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2022-09-23 14:40:22.792 +01:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2022-09-23 14:40:22.794 +01:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2022-09-23 14:40:22.797 +01:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2022-09-23 14:40:22.804 +01:00 [DBG] Executing controller factory for controller APIBank.Controllers.AccountsController (APIBank)
2022-09-23 14:40:22.806 +01:00 [DBG] Executed controller factory for controller APIBank.Controllers.AccountsController (APIBank)
2022-09-23 14:40:22.810 +01:00 [DBG] Compiling query expression: 
'DbSet<RefreshToken>()
    .FirstOrDefault(e => EF.Property<int>(e, "Id") == __p_0)'
2022-09-23 14:40:22.831 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<RefreshToken>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: RefreshToken.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: RefreshToken.Created (DateTime) Required, 1], [Property: RefreshToken.CreatedByIp (string) Required MaxLength(200), 2], [Property: RefreshToken.Expires (DateTime) Required, 3], [Property: RefreshToken.IsActive (no field, bool) Required, 4], [Property: RefreshToken.IsExpired (no field, bool) Required, 5], [Property: RefreshToken.IsRevoked (no field, bool) Required, 6], [Property: RefreshToken.ReasonRevoked (string) MaxLength(200), 7], [Property: RefreshToken.RefToken (string) Required MaxLength(254), 8], [Property: RefreshToken.ReplacedByToken (string) MaxLength(200), 9], [Property: RefreshToken.Revoked (DateTime?), 10], [Property: RefreshToken.RevokedByIp (string) MaxLength(200), 11], [Property: RefreshToken.UserId (int) Required FK Index, 12] }
        SELECT TOP(1) r.id, r.created, r.created_by_ip, r.expires, r.is_active, r.is_expired, r.is_revoked, r.reason_revoked, r.token, r.replaced_by_token, r.revoked, r.revoked_by_ip, r.user_id
        FROM refresh_token AS r
        WHERE r.id == @__p_0), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, RefreshToken>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)
    .SingleOrDefault()'
2022-09-23 14:40:22.847 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 14:40:22.851 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (4ms).
2022-09-23 14:40:22.855 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 14:40:22.856 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 14:40:22.857 +01:00 [DBG] Executing DbCommand [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id, r.created, r.created_by_ip, r.expires, r.is_active, r.is_expired, r.is_revoked, r.reason_revoked, r.token, r.replaced_by_token, r.revoked, r.revoked_by_ip, r.user_id
FROM refresh_token AS r
WHERE r.id = @__p_0
LIMIT 1
2022-09-23 14:40:22.859 +01:00 [INF] Executed DbCommand (3ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id, r.created, r.created_by_ip, r.expires, r.is_active, r.is_expired, r.is_revoked, r.reason_revoked, r.token, r.replaced_by_token, r.revoked, r.revoked_by_ip, r.user_id
FROM refresh_token AS r
WHERE r.id = @__p_0
LIMIT 1
2022-09-23 14:40:22.862 +01:00 [DBG] Context 'PostgresContext' started tracking 'RefreshToken' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 14:40:22.869 +01:00 [DBG] A data reader was disposed.
2022-09-23 14:40:22.870 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 14:40:22.871 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 14:40:22.875 +01:00 [DBG] Compiling query expression: 
'DbSet<Account>()
    .Where(u => u.UserId == __userId_0)
    .Select(u => new AccountRequestResponse{ 
        Balance = u.Balance, 
        CreatedAt = u.CreatedAt, 
        Currency = u.Currency, 
        Id = u.Id 
    }
    )'
2022-09-23 14:40:22.883 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<AccountRequestResponse>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            Balance -> 0
            CreatedAt -> 1
            Currency -> 2
            Id -> 3
        SELECT a.balance AS Balance, a.created_at AS CreatedAt, a.currency AS Currency, a.id AS Id
        FROM accounts AS a
        WHERE a.user_id == @__userId_0), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, AccountRequestResponse>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)'
2022-09-23 14:40:22.892 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 14:40:22.908 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (15ms).
2022-09-23 14:40:22.918 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 14:40:22.919 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 14:40:22.920 +01:00 [DBG] Executing DbCommand [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a.balance AS "Balance", a.created_at AS "CreatedAt", a.currency AS "Currency", a.id AS "Id"
FROM accounts AS a
WHERE a.user_id = @__userId_0
2022-09-23 14:40:22.924 +01:00 [INF] Executed DbCommand (4ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a.balance AS "Balance", a.created_at AS "CreatedAt", a.currency AS "Currency", a.id AS "Id"
FROM accounts AS a
WHERE a.user_id = @__userId_0
2022-09-23 14:40:22.940 +01:00 [DBG] A data reader was disposed.
2022-09-23 14:40:22.943 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 14:40:22.945 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 14:40:22.949 +01:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2022-09-23 14:40:22.984 +01:00 [DBG] Attempting to select an output formatter based on Accept header '["text/plain"]'.
2022-09-23 14:40:22.988 +01:00 [DBG] Could not find an output formatter based on content negotiation. Accepted types were (["text/plain"])
2022-09-23 14:40:22.989 +01:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2022-09-23 14:40:22.990 +01:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2022-09-23 14:40:22.990 +01:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2022-09-23 14:40:22.991 +01:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[APIBank.Models.Responses.AccountRequestResponse, APIBank, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2022-09-23 14:40:23.001 +01:00 [INF] Executed action APIBank.Controllers.AccountsController.GetAllFromUser (APIBank) in 197.3665ms
2022-09-23 14:40:23.002 +01:00 [INF] Executed endpoint 'APIBank.Controllers.AccountsController.GetAllFromUser (APIBank)'
2022-09-23 14:40:23.004 +01:00 [DBG] 'PostgresContext' disposed.
2022-09-23 14:40:23.006 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/api/Accounts/GetAll - - - 200 - application/json;+charset=utf-8 1177.7948ms
2022-09-23 14:40:32.715 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/api/Users/1/refresh-tokens - -
2022-09-23 14:40:32.756 +01:00 [DBG] 1 candidate(s) found for the request path '/api/Users/1/refresh-tokens'
2022-09-23 14:40:32.779 +01:00 [DBG] Endpoint 'APIBank.Controllers.UsersController.GetRefreshTokens (APIBank)' with route pattern 'api/Users/{id}/refresh-tokens' is valid for the request path '/api/Users/1/refresh-tokens'
2022-09-23 14:40:32.795 +01:00 [DBG] Request matched endpoint 'APIBank.Controllers.UsersController.GetRefreshTokens (APIBank)'
2022-09-23 14:40:32.796 +01:00 [DBG] Static files was skipped as the request already matched an endpoint.
2022-09-23 14:40:32.958 +01:00 [INF] Entity Framework Core 6.0.9 initialized 'PostgresContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:6.0.7+5b98e4b74de93b590b44aef8dd7967c03acc433c' with options: None
2022-09-23 14:40:32.986 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 14:40:32.995 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (9ms).
2022-09-23 14:40:32.996 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 14:40:32.997 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 14:40:32.998 +01:00 [DBG] Executing DbCommand [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.id = @__p_0
LIMIT 1
2022-09-23 14:40:33.004 +01:00 [INF] Executed DbCommand (5ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.id = @__p_0
LIMIT 1
2022-09-23 14:40:33.009 +01:00 [DBG] Context 'PostgresContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 14:40:33.012 +01:00 [DBG] A data reader was disposed.
2022-09-23 14:40:33.013 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 14:40:33.014 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 14:40:33.017 +01:00 [INF] Executing endpoint 'APIBank.Controllers.UsersController.GetRefreshTokens (APIBank)'
2022-09-23 14:40:33.023 +01:00 [INF] Route matched with {action = "GetRefreshTokens", controller = "Users"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult GetRefreshTokens(Int32) on controller APIBank.Controllers.UsersController (APIBank).
2022-09-23 14:40:33.025 +01:00 [DBG] Execution plan of authorization filters (in the following order): ["APIBank.Authorization.AuthorizeAttribute"]
2022-09-23 14:40:33.052 +01:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2022-09-23 14:40:33.056 +01:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2022-09-23 14:40:33.060 +01:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2022-09-23 14:40:33.068 +01:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2022-09-23 14:40:33.071 +01:00 [DBG] Executing controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-23 14:40:33.075 +01:00 [DBG] Executed controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-23 14:40:33.079 +01:00 [DBG] Attempting to bind parameter 'id' of type 'System.Int32' ...
2022-09-23 14:40:33.081 +01:00 [DBG] Attempting to bind parameter 'id' of type 'System.Int32' using the name 'id' in request data ...
2022-09-23 14:40:33.083 +01:00 [DBG] Done attempting to bind parameter 'id' of type 'System.Int32'.
2022-09-23 14:40:33.084 +01:00 [DBG] Done attempting to bind parameter 'id' of type 'System.Int32'.
2022-09-23 14:40:33.085 +01:00 [DBG] Attempting to validate the bound parameter 'id' of type 'System.Int32' ...
2022-09-23 14:40:33.088 +01:00 [DBG] Done attempting to validate the bound parameter 'id' of type 'System.Int32'.
2022-09-23 14:40:33.094 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 14:40:33.107 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (12ms).
2022-09-23 14:40:33.117 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 14:40:33.145 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 14:40:33.147 +01:00 [DBG] Executing DbCommand [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id, r.created, r.created_by_ip, r.expires, r.is_active, r.is_expired, r.is_revoked, r.reason_revoked, r.token, r.replaced_by_token, r.revoked, r.revoked_by_ip, r.user_id
FROM refresh_token AS r
WHERE r.id = @__p_0
LIMIT 1
2022-09-23 14:40:33.149 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id, r.created, r.created_by_ip, r.expires, r.is_active, r.is_expired, r.is_revoked, r.reason_revoked, r.token, r.replaced_by_token, r.revoked, r.revoked_by_ip, r.user_id
FROM refresh_token AS r
WHERE r.id = @__p_0
LIMIT 1
2022-09-23 14:40:33.151 +01:00 [DBG] Context 'PostgresContext' started tracking 'RefreshToken' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 14:40:33.153 +01:00 [DBG] A data reader was disposed.
2022-09-23 14:40:33.168 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 14:40:33.179 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 14:40:33.182 +01:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2022-09-23 14:40:33.190 +01:00 [DBG] No information found on request to perform content negotiation.
2022-09-23 14:40:33.192 +01:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2022-09-23 14:40:33.197 +01:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2022-09-23 14:40:33.199 +01:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2022-09-23 14:40:33.202 +01:00 [INF] Executing OkObjectResult, writing value of type 'Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryable`1[[APIBank.ModelEntities.RefreshToken, APIBank, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2022-09-23 14:40:33.214 +01:00 [DBG] Compiling query expression: 
'DbSet<RefreshToken>()
    .Where(rt => rt.UserId == __id_0)
    .AsNoTracking()
    .Select(rt => new RefreshToken{ 
        Id = rt.Id, 
        UserId = rt.UserId, 
        RefToken = rt.RefToken, 
        Expires = rt.Expires, 
        Created = rt.Created, 
        CreatedByIp = rt.CreatedByIp, 
        Revoked = rt.Revoked, 
        RevokedByIp = rt.RevokedByIp, 
        ReplacedByToken = rt.ReplacedByToken, 
        ReasonRevoked = rt.ReasonRevoked, 
        IsExpired = rt.IsExpired, 
        IsRevoked = rt.IsRevoked, 
        IsActive = rt.IsActive 
    }
    )'
2022-09-23 14:40:33.279 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<RefreshToken>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            Id -> 0
            UserId -> 1
            RefToken -> 2
            Expires -> 3
            Created -> 4
            CreatedByIp -> 5
            Revoked -> 6
            RevokedByIp -> 7
            ReplacedByToken -> 8
            ReasonRevoked -> 9
            IsExpired -> 10
            IsRevoked -> 11
            IsActive -> 12
        SELECT r.id AS Id, r.user_id AS UserId, r.token AS RefToken, r.expires AS Expires, r.created AS Created, r.created_by_ip AS CreatedByIp, r.revoked AS Revoked, r.revoked_by_ip AS RevokedByIp, r.replaced_by_token AS ReplacedByToken, r.reason_revoked AS ReasonRevoked, r.is_expired AS IsExpired, r.is_revoked AS IsRevoked, r.is_active AS IsActive
        FROM refresh_token AS r
        WHERE r.user_id == @__id_0), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, RefreshToken>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)'
2022-09-23 14:40:33.323 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 14:40:33.353 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (29ms).
2022-09-23 14:40:33.367 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 14:40:33.394 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 14:40:33.401 +01:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.user_id AS "UserId", r.token AS "RefToken", r.expires AS "Expires", r.created AS "Created", r.created_by_ip AS "CreatedByIp", r.revoked AS "Revoked", r.revoked_by_ip AS "RevokedByIp", r.replaced_by_token AS "ReplacedByToken", r.reason_revoked AS "ReasonRevoked", r.is_expired AS "IsExpired", r.is_revoked AS "IsRevoked", r.is_active AS "IsActive"
FROM refresh_token AS r
WHERE r.user_id = @__id_0
2022-09-23 14:40:33.413 +01:00 [INF] Executed DbCommand (12ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.user_id AS "UserId", r.token AS "RefToken", r.expires AS "Expires", r.created AS "Created", r.created_by_ip AS "CreatedByIp", r.revoked AS "Revoked", r.revoked_by_ip AS "RevokedByIp", r.replaced_by_token AS "ReplacedByToken", r.reason_revoked AS "ReasonRevoked", r.is_expired AS "IsExpired", r.is_revoked AS "IsRevoked", r.is_active AS "IsActive"
FROM refresh_token AS r
WHERE r.user_id = @__id_0
2022-09-23 14:40:33.437 +01:00 [DBG] A data reader was disposed.
2022-09-23 14:40:33.456 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 14:40:33.489 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 14:40:33.494 +01:00 [INF] Executed action APIBank.Controllers.UsersController.GetRefreshTokens (APIBank) in 423.3581ms
2022-09-23 14:40:33.495 +01:00 [INF] Executed endpoint 'APIBank.Controllers.UsersController.GetRefreshTokens (APIBank)'
2022-09-23 14:40:33.497 +01:00 [DBG] 'PostgresContext' disposed.
2022-09-23 14:40:33.499 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/api/Users/1/refresh-tokens - - - 200 - application/json;+charset=utf-8 784.1510ms
2022-09-23 14:41:05.083 +01:00 [INF] Request starting HTTP/2 POST https://localhost:7036/api/Users/revoke-token application/json 20
2022-09-23 14:41:05.086 +01:00 [DBG] 1 candidate(s) found for the request path '/api/Users/revoke-token'
2022-09-23 14:41:05.088 +01:00 [DBG] Endpoint 'APIBank.Controllers.UsersController.RevokeToken (APIBank)' with route pattern 'api/Users/revoke-token' is valid for the request path '/api/Users/revoke-token'
2022-09-23 14:41:05.095 +01:00 [DBG] Request matched endpoint 'APIBank.Controllers.UsersController.RevokeToken (APIBank)'
2022-09-23 14:41:05.097 +01:00 [DBG] Static files was skipped as the request already matched an endpoint.
2022-09-23 14:41:05.139 +01:00 [INF] Entity Framework Core 6.0.9 initialized 'PostgresContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:6.0.7+5b98e4b74de93b590b44aef8dd7967c03acc433c' with options: None
2022-09-23 14:41:05.146 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 14:41:05.152 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (5ms).
2022-09-23 14:41:05.155 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 14:41:05.156 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 14:41:05.157 +01:00 [DBG] Executing DbCommand [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.id = @__p_0
LIMIT 1
2022-09-23 14:41:05.160 +01:00 [INF] Executed DbCommand (3ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.id = @__p_0
LIMIT 1
2022-09-23 14:41:05.167 +01:00 [DBG] Context 'PostgresContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 14:41:05.172 +01:00 [DBG] A data reader was disposed.
2022-09-23 14:41:05.175 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 14:41:05.188 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 14:41:05.191 +01:00 [INF] Executing endpoint 'APIBank.Controllers.UsersController.RevokeToken (APIBank)'
2022-09-23 14:41:05.196 +01:00 [INF] Route matched with {action = "RevokeToken", controller = "Users"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult RevokeToken(APIBank.Models.MyRequestResponses.UserRevokeTokenRequest) on controller APIBank.Controllers.UsersController (APIBank).
2022-09-23 14:41:05.199 +01:00 [DBG] Execution plan of authorization filters (in the following order): ["APIBank.Authorization.AuthorizeAttribute"]
2022-09-23 14:41:05.200 +01:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2022-09-23 14:41:05.201 +01:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2022-09-23 14:41:05.203 +01:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2022-09-23 14:41:05.204 +01:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2022-09-23 14:41:05.205 +01:00 [DBG] Executing controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-23 14:41:05.209 +01:00 [DBG] Executed controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-23 14:41:05.215 +01:00 [DBG] Attempting to bind parameter 'model' of type 'APIBank.Models.MyRequestResponses.UserRevokeTokenRequest' ...
2022-09-23 14:41:05.217 +01:00 [DBG] Attempting to bind parameter 'model' of type 'APIBank.Models.MyRequestResponses.UserRevokeTokenRequest' using the name '' in request data ...
2022-09-23 14:41:05.218 +01:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2022-09-23 14:41:05.220 +01:00 [DBG] Connection id "0HMKTD4AVECCD", Request id "0HMKTD4AVECCD:0000000F": started reading request body.
2022-09-23 14:41:05.222 +01:00 [DBG] Connection id "0HMKTD4AVECCD", Request id "0HMKTD4AVECCD:0000000F": done reading request body.
2022-09-23 14:41:05.224 +01:00 [DBG] JSON input formatter succeeded, deserializing to type 'APIBank.Models.MyRequestResponses.UserRevokeTokenRequest'
2022-09-23 14:41:05.225 +01:00 [DBG] Done attempting to bind parameter 'model' of type 'APIBank.Models.MyRequestResponses.UserRevokeTokenRequest'.
2022-09-23 14:41:05.227 +01:00 [DBG] Done attempting to bind parameter 'model' of type 'APIBank.Models.MyRequestResponses.UserRevokeTokenRequest'.
2022-09-23 14:41:05.229 +01:00 [DBG] Attempting to validate the bound parameter 'model' of type 'APIBank.Models.MyRequestResponses.UserRevokeTokenRequest' ...
2022-09-23 14:41:05.236 +01:00 [DBG] Done attempting to validate the bound parameter 'model' of type 'APIBank.Models.MyRequestResponses.UserRevokeTokenRequest'.
2022-09-23 14:41:05.259 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 14:41:05.261 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (2ms).
2022-09-23 14:41:05.263 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 14:41:05.265 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 14:41:05.266 +01:00 [DBG] Executing DbCommand [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id, r.created, r.created_by_ip, r.expires, r.is_active, r.is_expired, r.is_revoked, r.reason_revoked, r.token, r.replaced_by_token, r.revoked, r.revoked_by_ip, r.user_id
FROM refresh_token AS r
WHERE r.id = @__p_0
LIMIT 1
2022-09-23 14:41:05.271 +01:00 [INF] Executed DbCommand (5ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id, r.created, r.created_by_ip, r.expires, r.is_active, r.is_expired, r.is_revoked, r.reason_revoked, r.token, r.replaced_by_token, r.revoked, r.revoked_by_ip, r.user_id
FROM refresh_token AS r
WHERE r.id = @__p_0
LIMIT 1
2022-09-23 14:41:05.273 +01:00 [DBG] Context 'PostgresContext' started tracking 'RefreshToken' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 14:41:05.274 +01:00 [DBG] A data reader was disposed.
2022-09-23 14:41:05.275 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 14:41:05.277 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 14:41:05.300 +01:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .SingleOrDefault(userQuery => userQuery.RefreshTokenCollection
        .Any(refTokenQuery => refTokenQuery.RefToken == __refToken_0))'
2022-09-23 14:41:05.317 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<User>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: User.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: User.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 1], [Property: User.Email (string) Required Index MaxLength(254), 2], [Property: User.FullName (string) Required MaxLength(100), 3], [Property: User.PasswordChangedAt (DateTime) Required ValueGenerated.OnAdd, 4], [Property: User.PasswordHash (string) Required MaxLength(200), 5], [Property: User.Username (string) Required Index MaxLength(50), 6] }
        SELECT TOP(2) u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
        FROM users AS u
        WHERE EXISTS (
            SELECT 1
            FROM refresh_token AS r
            WHERE ((u.id != NULL) && (u.id == r.user_id)) && (r.token == @__refToken_0))), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, User>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)
    .SingleOrDefault()'
2022-09-23 14:41:05.320 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 14:41:05.321 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2022-09-23 14:41:05.322 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 14:41:05.323 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 14:41:05.323 +01:00 [DBG] Executing DbCommand [Parameters=[@__refToken_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE EXISTS (
    SELECT 1
    FROM refresh_token AS r
    WHERE (u.id = r.user_id) AND (r.token = @__refToken_0))
LIMIT 2
2022-09-23 14:41:05.328 +01:00 [INF] Executed DbCommand (4ms) [Parameters=[@__refToken_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE EXISTS (
    SELECT 1
    FROM refresh_token AS r
    WHERE (u.id = r.user_id) AND (r.token = @__refToken_0))
LIMIT 2
2022-09-23 14:41:05.333 +01:00 [DBG] A data reader was disposed.
2022-09-23 14:41:05.333 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 14:41:05.335 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 14:41:05.337 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 14:41:05.338 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2022-09-23 14:41:05.339 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 14:41:05.339 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 14:41:05.340 +01:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.user_id AS "UserId", r.token AS "RefToken", r.expires AS "Expires", r.created AS "Created", r.created_by_ip AS "CreatedByIp", r.revoked AS "Revoked", r.revoked_by_ip AS "RevokedByIp", r.replaced_by_token AS "ReplacedByToken", r.reason_revoked AS "ReasonRevoked", r.is_expired AS "IsExpired", r.is_revoked AS "IsRevoked", r.is_active AS "IsActive"
FROM refresh_token AS r
WHERE r.user_id = @__id_0
2022-09-23 14:41:05.342 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.user_id AS "UserId", r.token AS "RefToken", r.expires AS "Expires", r.created AS "Created", r.created_by_ip AS "CreatedByIp", r.revoked AS "Revoked", r.revoked_by_ip AS "RevokedByIp", r.replaced_by_token AS "ReplacedByToken", r.reason_revoked AS "ReasonRevoked", r.is_expired AS "IsExpired", r.is_revoked AS "IsRevoked", r.is_active AS "IsActive"
FROM refresh_token AS r
WHERE r.user_id = @__id_0
2022-09-23 14:41:05.347 +01:00 [DBG] A data reader was disposed.
2022-09-23 14:41:05.350 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 14:41:05.352 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 14:41:05.360 +01:00 [DBG] An entity of type 'User' tracked by 'PostgresContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 14:41:05.372 +01:00 [DBG] SaveChanges starting for 'PostgresContext'.
2022-09-23 14:41:05.373 +01:00 [DBG] DetectChanges starting for 'PostgresContext'.
2022-09-23 14:41:05.381 +01:00 [DBG] DetectChanges completed for 'PostgresContext'.
2022-09-23 14:41:05.382 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 14:41:05.383 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 14:41:05.385 +01:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2022-09-23 14:41:05.385 +01:00 [DBG] Began transaction with isolation level 'ReadCommitted'.
2022-09-23 14:41:05.387 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 14:41:05.387 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2022-09-23 14:41:05.388 +01:00 [DBG] Executing DbCommand [Parameters=[@p6='?' (DbType = Int32), @p0='?' (DbType = DateTime), @p1='?', @p2='?', @p3='?' (DbType = DateTime), @p4='?', @p5='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE users SET created_at = @p0, email = @p1, full_name = @p2, password_changed_at = @p3, password_hash = @p4, username = @p5
WHERE id = @p6;
2022-09-23 14:41:05.390 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[@p6='?' (DbType = Int32), @p0='?' (DbType = DateTime), @p1='?', @p2='?', @p3='?' (DbType = DateTime), @p4='?', @p5='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE users SET created_at = @p0, email = @p1, full_name = @p2, password_changed_at = @p3, password_hash = @p4, username = @p5
WHERE id = @p6;
2022-09-23 14:41:05.395 +01:00 [DBG] A data reader was disposed.
2022-09-23 14:41:05.396 +01:00 [DBG] Committing transaction.
2022-09-23 14:41:05.401 +01:00 [DBG] Committed transaction.
2022-09-23 14:41:05.404 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 14:41:05.434 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 14:41:05.436 +01:00 [DBG] Disposing transaction.
2022-09-23 14:41:05.438 +01:00 [DBG] An entity of type 'User' tracked by 'PostgresContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 14:41:05.440 +01:00 [DBG] SaveChanges completed for 'PostgresContext' with 1 entities written to the database.
2022-09-23 14:41:05.441 +01:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2022-09-23 14:41:05.450 +01:00 [DBG] No information found on request to perform content negotiation.
2022-09-23 14:41:05.453 +01:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2022-09-23 14:41:05.455 +01:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2022-09-23 14:41:05.456 +01:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2022-09-23 14:41:05.458 +01:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType0`1[[System.String, System.Private.CoreLib, Version=6.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2022-09-23 14:41:05.463 +01:00 [INF] Executed action APIBank.Controllers.UsersController.RevokeToken (APIBank) in 257.9666ms
2022-09-23 14:41:05.469 +01:00 [INF] Executed endpoint 'APIBank.Controllers.UsersController.RevokeToken (APIBank)'
2022-09-23 14:41:05.514 +01:00 [DBG] 'PostgresContext' disposed.
2022-09-23 14:41:05.524 +01:00 [INF] Request finished HTTP/2 POST https://localhost:7036/api/Users/revoke-token application/json 20 - 200 - application/json;+charset=utf-8 440.4504ms
2022-09-23 14:41:18.157 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/api/Users/1/refresh-tokens - -
2022-09-23 14:41:18.160 +01:00 [DBG] 1 candidate(s) found for the request path '/api/Users/1/refresh-tokens'
2022-09-23 14:41:18.161 +01:00 [DBG] Endpoint 'APIBank.Controllers.UsersController.GetRefreshTokens (APIBank)' with route pattern 'api/Users/{id}/refresh-tokens' is valid for the request path '/api/Users/1/refresh-tokens'
2022-09-23 14:41:18.167 +01:00 [DBG] Request matched endpoint 'APIBank.Controllers.UsersController.GetRefreshTokens (APIBank)'
2022-09-23 14:41:18.169 +01:00 [DBG] Static files was skipped as the request already matched an endpoint.
2022-09-23 14:41:18.186 +01:00 [INF] Entity Framework Core 6.0.9 initialized 'PostgresContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:6.0.7+5b98e4b74de93b590b44aef8dd7967c03acc433c' with options: None
2022-09-23 14:41:18.193 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 14:41:18.195 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (2ms).
2022-09-23 14:41:18.197 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 14:41:18.198 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 14:41:18.201 +01:00 [DBG] Executing DbCommand [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.id = @__p_0
LIMIT 1
2022-09-23 14:41:18.213 +01:00 [INF] Executed DbCommand (13ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.id = @__p_0
LIMIT 1
2022-09-23 14:41:18.217 +01:00 [DBG] Context 'PostgresContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 14:41:18.219 +01:00 [DBG] A data reader was disposed.
2022-09-23 14:41:18.219 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 14:41:18.220 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 14:41:18.221 +01:00 [INF] Executing endpoint 'APIBank.Controllers.UsersController.GetRefreshTokens (APIBank)'
2022-09-23 14:41:18.222 +01:00 [INF] Route matched with {action = "GetRefreshTokens", controller = "Users"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult GetRefreshTokens(Int32) on controller APIBank.Controllers.UsersController (APIBank).
2022-09-23 14:41:18.223 +01:00 [DBG] Execution plan of authorization filters (in the following order): ["APIBank.Authorization.AuthorizeAttribute"]
2022-09-23 14:41:18.224 +01:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2022-09-23 14:41:18.226 +01:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2022-09-23 14:41:18.228 +01:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2022-09-23 14:41:18.229 +01:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2022-09-23 14:41:18.230 +01:00 [DBG] Executing controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-23 14:41:18.230 +01:00 [DBG] Executed controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-23 14:41:18.232 +01:00 [DBG] Attempting to bind parameter 'id' of type 'System.Int32' ...
2022-09-23 14:41:18.234 +01:00 [DBG] Attempting to bind parameter 'id' of type 'System.Int32' using the name 'id' in request data ...
2022-09-23 14:41:18.235 +01:00 [DBG] Done attempting to bind parameter 'id' of type 'System.Int32'.
2022-09-23 14:41:18.238 +01:00 [DBG] Done attempting to bind parameter 'id' of type 'System.Int32'.
2022-09-23 14:41:18.246 +01:00 [DBG] Attempting to validate the bound parameter 'id' of type 'System.Int32' ...
2022-09-23 14:41:18.253 +01:00 [DBG] Done attempting to validate the bound parameter 'id' of type 'System.Int32'.
2022-09-23 14:41:18.261 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 14:41:18.262 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2022-09-23 14:41:18.263 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 14:41:18.264 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 14:41:18.265 +01:00 [DBG] Executing DbCommand [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id, r.created, r.created_by_ip, r.expires, r.is_active, r.is_expired, r.is_revoked, r.reason_revoked, r.token, r.replaced_by_token, r.revoked, r.revoked_by_ip, r.user_id
FROM refresh_token AS r
WHERE r.id = @__p_0
LIMIT 1
2022-09-23 14:41:18.268 +01:00 [INF] Executed DbCommand (3ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id, r.created, r.created_by_ip, r.expires, r.is_active, r.is_expired, r.is_revoked, r.reason_revoked, r.token, r.replaced_by_token, r.revoked, r.revoked_by_ip, r.user_id
FROM refresh_token AS r
WHERE r.id = @__p_0
LIMIT 1
2022-09-23 14:41:18.275 +01:00 [DBG] Context 'PostgresContext' started tracking 'RefreshToken' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 14:41:18.276 +01:00 [DBG] A data reader was disposed.
2022-09-23 14:41:18.277 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 14:41:18.278 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 14:41:18.279 +01:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2022-09-23 14:41:18.281 +01:00 [DBG] No information found on request to perform content negotiation.
2022-09-23 14:41:18.281 +01:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2022-09-23 14:41:18.283 +01:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2022-09-23 14:41:18.284 +01:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2022-09-23 14:41:18.285 +01:00 [INF] Executing OkObjectResult, writing value of type 'Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryable`1[[APIBank.ModelEntities.RefreshToken, APIBank, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2022-09-23 14:41:18.306 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 14:41:18.311 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (5ms).
2022-09-23 14:41:18.313 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 14:41:18.315 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 14:41:18.321 +01:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.user_id AS "UserId", r.token AS "RefToken", r.expires AS "Expires", r.created AS "Created", r.created_by_ip AS "CreatedByIp", r.revoked AS "Revoked", r.revoked_by_ip AS "RevokedByIp", r.replaced_by_token AS "ReplacedByToken", r.reason_revoked AS "ReasonRevoked", r.is_expired AS "IsExpired", r.is_revoked AS "IsRevoked", r.is_active AS "IsActive"
FROM refresh_token AS r
WHERE r.user_id = @__id_0
2022-09-23 14:41:18.324 +01:00 [INF] Executed DbCommand (3ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.user_id AS "UserId", r.token AS "RefToken", r.expires AS "Expires", r.created AS "Created", r.created_by_ip AS "CreatedByIp", r.revoked AS "Revoked", r.revoked_by_ip AS "RevokedByIp", r.replaced_by_token AS "ReplacedByToken", r.reason_revoked AS "ReasonRevoked", r.is_expired AS "IsExpired", r.is_revoked AS "IsRevoked", r.is_active AS "IsActive"
FROM refresh_token AS r
WHERE r.user_id = @__id_0
2022-09-23 14:41:18.327 +01:00 [DBG] A data reader was disposed.
2022-09-23 14:41:18.328 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 14:41:18.330 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 14:41:18.331 +01:00 [INF] Executed action APIBank.Controllers.UsersController.GetRefreshTokens (APIBank) in 101.0261ms
2022-09-23 14:41:18.335 +01:00 [INF] Executed endpoint 'APIBank.Controllers.UsersController.GetRefreshTokens (APIBank)'
2022-09-23 14:41:18.337 +01:00 [DBG] 'PostgresContext' disposed.
2022-09-23 14:41:18.338 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/api/Users/1/refresh-tokens - - - 200 - application/json;+charset=utf-8 180.4294ms
2022-09-23 14:41:46.306 +01:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2022-09-23 14:41:47.095 +01:00 [DBG] Hosting starting
2022-09-23 14:41:47.511 +01:00 [DBG] Using development certificate: CN=localhost (Thumbprint: 9CC642E9838495A6C3C202DECA6A8AD300396DD2)
2022-09-23 14:41:47.642 +01:00 [INF] Now listening on: https://localhost:7036
2022-09-23 14:41:47.667 +01:00 [INF] Now listening on: http://localhost:5036
2022-09-23 14:41:47.674 +01:00 [DBG] Loaded hosting startup assembly APIBank
2022-09-23 14:41:47.677 +01:00 [DBG] Connection id "0HMKTD5E9APRB" received FIN.
2022-09-23 14:41:47.678 +01:00 [DBG] Loaded hosting startup assembly Microsoft.AspNetCore.Watch.BrowserRefresh
2022-09-23 14:41:47.682 +01:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.BrowserLink.Net
2022-09-23 14:41:47.685 +01:00 [INF] Application started. Press Ctrl+C to shut down.
2022-09-23 14:41:47.688 +01:00 [INF] Hosting environment: Development
2022-09-23 14:41:47.694 +01:00 [INF] Content root path: C:\Users\mguedesa\OneDrive - NTT DATA EMEAL\Documentos\GitHub\OpenBankAPI-NTT\APIBank\APIBank\
2022-09-23 14:41:47.695 +01:00 [DBG] Hosting started
2022-09-23 14:41:47.699 +01:00 [DBG] Connection id "0HMKTD5E9APRB" accepted.
2022-09-23 14:41:47.702 +01:00 [DBG] Connection id "0HMKTD5E9APRB" started.
2022-09-23 14:41:47.793 +01:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException:  Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveBlobAsync[TIOAdapter](TIOAdapter adapter)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](TIOAdapter adapter, Boolean receiveFirst, Byte[] reAuthenticationData, Boolean isApm)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2022-09-23 14:41:47.938 +01:00 [DBG] Connection id "0HMKTD5E9APRB" stopped.
2022-09-23 14:41:47.947 +01:00 [DBG] Connection id "0HMKTD5E9APRB" sending FIN because: "The Socket transport's send loop completed gracefully."
2022-09-23 14:41:48.098 +01:00 [DBG] Connection id "0HMKTD5E9APRC" accepted.
2022-09-23 14:41:48.105 +01:00 [DBG] Connection id "0HMKTD5E9APRC" started.
2022-09-23 14:41:48.307 +01:00 [DBG] Connection 0HMKTD5E9APRC established using the following protocol: "Tls12"
2022-09-23 14:41:48.745 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/swagger/index.html - -
2022-09-23 14:41:49.070 +01:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2022-09-23 14:41:49.305 +01:00 [DBG] No candidates found for the request path '/swagger/index.html'
2022-09-23 14:41:49.330 +01:00 [DBG] Request did not match any endpoints
2022-09-23 14:41:49.929 +01:00 [DBG] Response markup is scheduled to include browser refresh script injection.
2022-09-23 14:41:51.801 +01:00 [DBG] Response markup was updated to include browser refresh script injection.
2022-09-23 14:41:51.851 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/swagger/index.html - - - 200 - text/html;charset=utf-8 3116.1364ms
2022-09-23 14:41:52.097 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/_framework/aspnetcore-browser-refresh.js - -
2022-09-23 14:41:52.100 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/_vs/browserLink - -
2022-09-23 14:41:52.116 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/_framework/aspnetcore-browser-refresh.js - - - 200 11984 application/javascript;+charset=utf-8 19.3802ms
2022-09-23 14:41:52.422 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/_vs/browserLink - - - 200 - text/javascript;+charset=UTF-8 321.7138ms
2022-09-23 14:41:52.658 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/swagger/v1/swagger.json - -
2022-09-23 14:41:52.666 +01:00 [DBG] No candidates found for the request path '/swagger/v1/swagger.json'
2022-09-23 14:41:52.667 +01:00 [DBG] Request did not match any endpoints
2022-09-23 14:41:53.343 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/swagger/v1/swagger.json - - - 200 - application/json;charset=utf-8 684.1969ms
2022-09-23 14:42:04.522 +01:00 [INF] Request starting HTTP/2 POST https://localhost:7036/api/Users/Login application/json 58
2022-09-23 14:42:04.537 +01:00 [DBG] 1 candidate(s) found for the request path '/api/Users/Login'
2022-09-23 14:42:04.551 +01:00 [DBG] Endpoint 'APIBank.Controllers.UsersController.Login (APIBank)' with route pattern 'api/Users/Login' is valid for the request path '/api/Users/Login'
2022-09-23 14:42:04.559 +01:00 [DBG] Request matched endpoint 'APIBank.Controllers.UsersController.Login (APIBank)'
2022-09-23 14:42:04.573 +01:00 [DBG] Static files was skipped as the request already matched an endpoint.
2022-09-23 14:42:05.849 +01:00 [INF] Executing endpoint 'APIBank.Controllers.UsersController.Login (APIBank)'
2022-09-23 14:42:05.925 +01:00 [INF] Route matched with {action = "Login", controller = "Users"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult Login(APIBank.Models.Requests.UserLoginRequest) on controller APIBank.Controllers.UsersController (APIBank).
2022-09-23 14:42:05.961 +01:00 [DBG] Execution plan of authorization filters (in the following order): ["APIBank.Authorization.AuthorizeAttribute"]
2022-09-23 14:42:05.965 +01:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2022-09-23 14:42:05.966 +01:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2022-09-23 14:42:05.968 +01:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2022-09-23 14:42:05.969 +01:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2022-09-23 14:42:05.972 +01:00 [DBG] Executing controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-23 14:42:05.976 +01:00 [DBG] Executed controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-23 14:42:06.024 +01:00 [DBG] Attempting to bind parameter 'model' of type 'APIBank.Models.Requests.UserLoginRequest' ...
2022-09-23 14:42:06.034 +01:00 [DBG] Attempting to bind parameter 'model' of type 'APIBank.Models.Requests.UserLoginRequest' using the name '' in request data ...
2022-09-23 14:42:06.038 +01:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2022-09-23 14:42:06.048 +01:00 [DBG] Connection id "0HMKTD5E9APRC", Request id "0HMKTD5E9APRC:00000009": started reading request body.
2022-09-23 14:42:06.050 +01:00 [DBG] Connection id "0HMKTD5E9APRC", Request id "0HMKTD5E9APRC:00000009": done reading request body.
2022-09-23 14:42:06.061 +01:00 [DBG] JSON input formatter succeeded, deserializing to type 'APIBank.Models.Requests.UserLoginRequest'
2022-09-23 14:42:06.063 +01:00 [DBG] Done attempting to bind parameter 'model' of type 'APIBank.Models.Requests.UserLoginRequest'.
2022-09-23 14:42:06.066 +01:00 [DBG] Done attempting to bind parameter 'model' of type 'APIBank.Models.Requests.UserLoginRequest'.
2022-09-23 14:42:06.094 +01:00 [DBG] Attempting to validate the bound parameter 'model' of type 'APIBank.Models.Requests.UserLoginRequest' ...
2022-09-23 14:42:06.113 +01:00 [DBG] Done attempting to validate the bound parameter 'model' of type 'APIBank.Models.Requests.UserLoginRequest'.
2022-09-23 14:42:06.443 +01:00 [DBG] An additional 'IServiceProvider' was created for internal use by Entity Framework. An existing service provider was not used due to the following configuration changes: configuration changed for 'Core:ConfigureWarnings', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:UseAdminDatabase', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:SetPostgresVersion', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:UseRedshift', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:ReverseNullOrdering', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:RemoteCertificateValidationCallback', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:ProvideClientCertificatesCallback', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:ProvidePasswordCallback'.
2022-09-23 14:42:09.661 +01:00 [INF] Entity Framework Core 6.0.9 initialized 'PostgresContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:6.0.7+5b98e4b74de93b590b44aef8dd7967c03acc433c' with options: None
2022-09-23 14:42:09.816 +01:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .SingleOrDefault(x => x.Username == __model_Username_0)'
2022-09-23 14:42:11.101 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<User>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: User.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: User.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 1], [Property: User.Email (string) Required Index MaxLength(254), 2], [Property: User.FullName (string) Required MaxLength(100), 3], [Property: User.PasswordChangedAt (DateTime) Required ValueGenerated.OnAdd, 4], [Property: User.PasswordHash (string) Required MaxLength(200), 5], [Property: User.Username (string) Required Index MaxLength(50), 6] }
        SELECT TOP(2) u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
        FROM users AS u
        WHERE u.username == @__model_Username_0), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, User>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)
    .SingleOrDefault()'
2022-09-23 14:42:11.215 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 14:42:11.791 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (556ms).
2022-09-23 14:42:11.845 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 14:42:12.666 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 14:42:12.733 +01:00 [DBG] Executing DbCommand [Parameters=[@__model_Username_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.username = @__model_Username_0
LIMIT 2
2022-09-23 14:42:13.098 +01:00 [INF] Executed DbCommand (407ms) [Parameters=[@__model_Username_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.username = @__model_Username_0
LIMIT 2
2022-09-23 14:42:13.231 +01:00 [DBG] Context 'PostgresContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 14:42:13.354 +01:00 [DBG] A data reader was disposed.
2022-09-23 14:42:13.361 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 14:42:13.376 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 14:42:13.664 +01:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .Any(user => user.RefreshTokenCollection
        .Any(reftoken => reftoken.RefToken == __token_0))'
2022-09-23 14:42:14.026 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<bool>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            EmptyProjectionMember -> 0
        SELECT EXISTS (
            SELECT 1
            FROM users AS u
            WHERE EXISTS (
                SELECT 1
                FROM refresh_token AS r
                WHERE ((u.id != NULL) && (u.id == r.user_id)) && (r.token == @__token_0)))), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, bool>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)
    .Single()'
2022-09-23 14:42:14.074 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 14:42:14.075 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2022-09-23 14:42:14.077 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 14:42:14.079 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 14:42:14.085 +01:00 [DBG] Executing DbCommand [Parameters=[@__token_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM users AS u
    WHERE EXISTS (
        SELECT 1
        FROM refresh_token AS r
        WHERE (u.id = r.user_id) AND (r.token = @__token_0)))
2022-09-23 14:42:14.092 +01:00 [INF] Executed DbCommand (7ms) [Parameters=[@__token_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM users AS u
    WHERE EXISTS (
        SELECT 1
        FROM refresh_token AS r
        WHERE (u.id = r.user_id) AND (r.token = @__token_0)))
2022-09-23 14:42:14.104 +01:00 [DBG] A data reader was disposed.
2022-09-23 14:42:14.108 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 14:42:14.110 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 14:42:14.117 +01:00 [DBG] SaveChanges starting for 'PostgresContext'.
2022-09-23 14:42:14.138 +01:00 [DBG] DetectChanges starting for 'PostgresContext'.
2022-09-23 14:42:14.225 +01:00 [DBG] 1 entities were added and 0 entities were removed from navigation 'User.RefreshTokenCollection'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 14:42:14.335 +01:00 [DBG] 'PostgresContext' generated a temporary value for the property 'Id.RefreshToken'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 14:42:14.493 +01:00 [DBG] Context 'PostgresContext' started tracking 'RefreshToken' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 14:42:14.524 +01:00 [DBG] DetectChanges completed for 'PostgresContext'.
2022-09-23 14:42:14.548 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 14:42:14.550 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 14:42:14.557 +01:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2022-09-23 14:42:14.572 +01:00 [DBG] Began transaction with isolation level 'ReadCommitted'.
2022-09-23 14:42:14.762 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 14:42:14.764 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (2ms).
2022-09-23 14:42:14.766 +01:00 [DBG] Executing DbCommand [Parameters=[@p0='?' (DbType = DateTime), @p1='?', @p2='?' (DbType = DateTime), @p3='?' (DbType = Boolean), @p4='?' (DbType = Boolean), @p5='?' (DbType = Boolean), @p6='?', @p7='?', @p8='?', @p9='?' (DbType = DateTime), @p10='?', @p11='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO refresh_token (created, created_by_ip, expires, is_active, is_expired, is_revoked, reason_revoked, token, replaced_by_token, revoked, revoked_by_ip, user_id)
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11)
RETURNING id;
2022-09-23 14:42:14.825 +01:00 [INF] Executed DbCommand (59ms) [Parameters=[@p0='?' (DbType = DateTime), @p1='?', @p2='?' (DbType = DateTime), @p3='?' (DbType = Boolean), @p4='?' (DbType = Boolean), @p5='?' (DbType = Boolean), @p6='?', @p7='?', @p8='?', @p9='?' (DbType = DateTime), @p10='?', @p11='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO refresh_token (created, created_by_ip, expires, is_active, is_expired, is_revoked, reason_revoked, token, replaced_by_token, revoked, revoked_by_ip, user_id)
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11)
RETURNING id;
2022-09-23 14:42:14.851 +01:00 [DBG] The foreign key property 'RefreshToken.Id' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2022-09-23 14:42:14.880 +01:00 [DBG] A data reader was disposed.
2022-09-23 14:42:14.888 +01:00 [DBG] Committing transaction.
2022-09-23 14:42:14.907 +01:00 [DBG] Committed transaction.
2022-09-23 14:42:14.912 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 14:42:14.914 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 14:42:14.925 +01:00 [DBG] Disposing transaction.
2022-09-23 14:42:14.960 +01:00 [DBG] An entity of type 'RefreshToken' tracked by 'PostgresContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 14:42:14.966 +01:00 [DBG] SaveChanges completed for 'PostgresContext' with 1 entities written to the database.
2022-09-23 14:42:15.421 +01:00 [DBG] Compiling query expression: 
'DbSet<RefreshToken>()
    .Where(rt => rt.UserId == __id_0)
    .AsNoTracking()
    .Select(rt => new RefreshToken{ 
        Id = rt.Id, 
        UserId = rt.UserId, 
        RefToken = rt.RefToken, 
        Expires = rt.Expires, 
        Created = rt.Created, 
        CreatedByIp = rt.CreatedByIp, 
        Revoked = rt.Revoked, 
        RevokedByIp = rt.RevokedByIp, 
        ReplacedByToken = rt.ReplacedByToken, 
        ReasonRevoked = rt.ReasonRevoked, 
        IsExpired = rt.IsExpired, 
        IsRevoked = rt.IsRevoked, 
        IsActive = rt.IsActive 
    }
    )'
2022-09-23 14:42:15.457 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<RefreshToken>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            Id -> 0
            UserId -> 1
            RefToken -> 2
            Expires -> 3
            Created -> 4
            CreatedByIp -> 5
            Revoked -> 6
            RevokedByIp -> 7
            ReplacedByToken -> 8
            ReasonRevoked -> 9
            IsExpired -> 10
            IsRevoked -> 11
            IsActive -> 12
        SELECT r.id AS Id, r.user_id AS UserId, r.token AS RefToken, r.expires AS Expires, r.created AS Created, r.created_by_ip AS CreatedByIp, r.revoked AS Revoked, r.revoked_by_ip AS RevokedByIp, r.replaced_by_token AS ReplacedByToken, r.reason_revoked AS ReasonRevoked, r.is_expired AS IsExpired, r.is_revoked AS IsRevoked, r.is_active AS IsActive
        FROM refresh_token AS r
        WHERE r.user_id == @__id_0), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, RefreshToken>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)'
2022-09-23 14:42:15.462 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 14:42:15.463 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2022-09-23 14:42:15.464 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 14:42:15.465 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 14:42:15.466 +01:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.user_id AS "UserId", r.token AS "RefToken", r.expires AS "Expires", r.created AS "Created", r.created_by_ip AS "CreatedByIp", r.revoked AS "Revoked", r.revoked_by_ip AS "RevokedByIp", r.replaced_by_token AS "ReplacedByToken", r.reason_revoked AS "ReasonRevoked", r.is_expired AS "IsExpired", r.is_revoked AS "IsRevoked", r.is_active AS "IsActive"
FROM refresh_token AS r
WHERE r.user_id = @__id_0
2022-09-23 14:42:15.469 +01:00 [INF] Executed DbCommand (4ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.user_id AS "UserId", r.token AS "RefToken", r.expires AS "Expires", r.created AS "Created", r.created_by_ip AS "CreatedByIp", r.revoked AS "Revoked", r.revoked_by_ip AS "RevokedByIp", r.replaced_by_token AS "ReplacedByToken", r.reason_revoked AS "ReasonRevoked", r.is_expired AS "IsExpired", r.is_revoked AS "IsRevoked", r.is_active AS "IsActive"
FROM refresh_token AS r
WHERE r.user_id = @__id_0
2022-09-23 14:42:15.488 +01:00 [DBG] A data reader was disposed.
2022-09-23 14:42:15.496 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 14:42:15.498 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 14:42:15.507 +01:00 [DBG] An entity of type 'User' tracked by 'PostgresContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 14:42:15.509 +01:00 [DBG] An entity of type 'RefreshToken' tracked by 'PostgresContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 14:42:15.510 +01:00 [DBG] SaveChanges starting for 'PostgresContext'.
2022-09-23 14:42:15.511 +01:00 [DBG] DetectChanges starting for 'PostgresContext'.
2022-09-23 14:42:15.513 +01:00 [DBG] DetectChanges completed for 'PostgresContext'.
2022-09-23 14:42:15.514 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 14:42:15.515 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 14:42:15.517 +01:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2022-09-23 14:42:15.518 +01:00 [DBG] Began transaction with isolation level 'ReadCommitted'.
2022-09-23 14:42:15.557 +01:00 [DBG] Executing 2 update commands as a batch.
2022-09-23 14:42:15.589 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 14:42:15.590 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2022-09-23 14:42:15.591 +01:00 [DBG] Executing DbCommand [Parameters=[@p12='?' (DbType = Int32), @p0='?' (DbType = DateTime), @p1='?', @p2='?' (DbType = DateTime), @p3='?' (DbType = Boolean), @p4='?' (DbType = Boolean), @p5='?' (DbType = Boolean), @p6='?', @p7='?', @p8='?', @p9='?' (DbType = DateTime), @p10='?', @p11='?' (DbType = Int32), @p19='?' (DbType = Int32), @p13='?' (DbType = DateTime), @p14='?', @p15='?', @p16='?' (DbType = DateTime), @p17='?', @p18='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE refresh_token SET created = @p0, created_by_ip = @p1, expires = @p2, is_active = @p3, is_expired = @p4, is_revoked = @p5, reason_revoked = @p6, token = @p7, replaced_by_token = @p8, revoked = @p9, revoked_by_ip = @p10, user_id = @p11
WHERE id = @p12;
UPDATE users SET created_at = @p13, email = @p14, full_name = @p15, password_changed_at = @p16, password_hash = @p17, username = @p18
WHERE id = @p19;
2022-09-23 14:42:15.595 +01:00 [INF] Executed DbCommand (4ms) [Parameters=[@p12='?' (DbType = Int32), @p0='?' (DbType = DateTime), @p1='?', @p2='?' (DbType = DateTime), @p3='?' (DbType = Boolean), @p4='?' (DbType = Boolean), @p5='?' (DbType = Boolean), @p6='?', @p7='?', @p8='?', @p9='?' (DbType = DateTime), @p10='?', @p11='?' (DbType = Int32), @p19='?' (DbType = Int32), @p13='?' (DbType = DateTime), @p14='?', @p15='?', @p16='?' (DbType = DateTime), @p17='?', @p18='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE refresh_token SET created = @p0, created_by_ip = @p1, expires = @p2, is_active = @p3, is_expired = @p4, is_revoked = @p5, reason_revoked = @p6, token = @p7, replaced_by_token = @p8, revoked = @p9, revoked_by_ip = @p10, user_id = @p11
WHERE id = @p12;
UPDATE users SET created_at = @p13, email = @p14, full_name = @p15, password_changed_at = @p16, password_hash = @p17, username = @p18
WHERE id = @p19;
2022-09-23 14:42:15.605 +01:00 [DBG] A data reader was disposed.
2022-09-23 14:42:15.606 +01:00 [DBG] Committing transaction.
2022-09-23 14:42:15.608 +01:00 [DBG] Committed transaction.
2022-09-23 14:42:15.609 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 14:42:15.610 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 14:42:15.610 +01:00 [DBG] Disposing transaction.
2022-09-23 14:42:15.612 +01:00 [DBG] An entity of type 'User' tracked by 'PostgresContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 14:42:15.615 +01:00 [DBG] An entity of type 'RefreshToken' tracked by 'PostgresContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 14:42:15.620 +01:00 [DBG] SaveChanges completed for 'PostgresContext' with 2 entities written to the database.
2022-09-23 14:42:15.628 +01:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2022-09-23 14:42:15.636 +01:00 [DBG] Attempting to select an output formatter based on Accept header '["text/plain"]'.
2022-09-23 14:42:15.640 +01:00 [DBG] Could not find an output formatter based on content negotiation. Accepted types were (["text/plain"])
2022-09-23 14:42:15.645 +01:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2022-09-23 14:42:15.657 +01:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2022-09-23 14:42:15.661 +01:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2022-09-23 14:42:15.664 +01:00 [INF] Executing OkObjectResult, writing value of type 'APIBank.Models.MyRequestResponses.LoginResponse'.
2022-09-23 14:42:15.688 +01:00 [INF] Executed action APIBank.Controllers.UsersController.Login (APIBank) in 9708.5071ms
2022-09-23 14:42:15.689 +01:00 [INF] Executed endpoint 'APIBank.Controllers.UsersController.Login (APIBank)'
2022-09-23 14:42:15.700 +01:00 [DBG] 'PostgresContext' disposed.
2022-09-23 14:42:15.735 +01:00 [INF] Request finished HTTP/2 POST https://localhost:7036/api/Users/Login application/json 58 - 200 - application/json;+charset=utf-8 11209.8385ms
2022-09-23 14:42:40.975 +01:00 [INF] Request starting HTTP/2 POST https://localhost:7036/api/Users/revoke-token application/json 20
2022-09-23 14:42:40.983 +01:00 [DBG] 1 candidate(s) found for the request path '/api/Users/revoke-token'
2022-09-23 14:42:41.000 +01:00 [DBG] Endpoint 'APIBank.Controllers.UsersController.RevokeToken (APIBank)' with route pattern 'api/Users/revoke-token' is valid for the request path '/api/Users/revoke-token'
2022-09-23 14:42:41.014 +01:00 [DBG] Request matched endpoint 'APIBank.Controllers.UsersController.RevokeToken (APIBank)'
2022-09-23 14:42:41.020 +01:00 [DBG] Static files was skipped as the request already matched an endpoint.
2022-09-23 14:42:41.577 +01:00 [INF] Entity Framework Core 6.0.9 initialized 'PostgresContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:6.0.7+5b98e4b74de93b590b44aef8dd7967c03acc433c' with options: None
2022-09-23 14:42:41.626 +01:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .FirstOrDefault(e => EF.Property<int>(e, "Id") == __p_0)'
2022-09-23 14:42:41.638 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<User>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: User.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: User.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 1], [Property: User.Email (string) Required Index MaxLength(254), 2], [Property: User.FullName (string) Required MaxLength(100), 3], [Property: User.PasswordChangedAt (DateTime) Required ValueGenerated.OnAdd, 4], [Property: User.PasswordHash (string) Required MaxLength(200), 5], [Property: User.Username (string) Required Index MaxLength(50), 6] }
        SELECT TOP(1) u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
        FROM users AS u
        WHERE u.id == @__p_0), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, User>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)
    .SingleOrDefault()'
2022-09-23 14:42:41.652 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 14:42:41.654 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (2ms).
2022-09-23 14:42:41.655 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 14:42:41.657 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 14:42:41.658 +01:00 [DBG] Executing DbCommand [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.id = @__p_0
LIMIT 1
2022-09-23 14:42:41.665 +01:00 [INF] Executed DbCommand (7ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.id = @__p_0
LIMIT 1
2022-09-23 14:42:41.670 +01:00 [DBG] Context 'PostgresContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 14:42:41.672 +01:00 [DBG] A data reader was disposed.
2022-09-23 14:42:41.673 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 14:42:41.681 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 14:42:41.684 +01:00 [INF] Executing endpoint 'APIBank.Controllers.UsersController.RevokeToken (APIBank)'
2022-09-23 14:42:41.704 +01:00 [INF] Route matched with {action = "RevokeToken", controller = "Users"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult RevokeToken(APIBank.Models.MyRequestResponses.UserRevokeTokenRequest) on controller APIBank.Controllers.UsersController (APIBank).
2022-09-23 14:42:41.709 +01:00 [DBG] Execution plan of authorization filters (in the following order): ["APIBank.Authorization.AuthorizeAttribute"]
2022-09-23 14:42:41.716 +01:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2022-09-23 14:42:41.718 +01:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2022-09-23 14:42:41.724 +01:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2022-09-23 14:42:41.725 +01:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2022-09-23 14:42:41.727 +01:00 [DBG] Executing controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-23 14:42:41.729 +01:00 [DBG] Executed controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-23 14:42:41.731 +01:00 [DBG] Attempting to bind parameter 'model' of type 'APIBank.Models.MyRequestResponses.UserRevokeTokenRequest' ...
2022-09-23 14:42:41.738 +01:00 [DBG] Attempting to bind parameter 'model' of type 'APIBank.Models.MyRequestResponses.UserRevokeTokenRequest' using the name '' in request data ...
2022-09-23 14:42:41.758 +01:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2022-09-23 14:42:41.762 +01:00 [DBG] Connection id "0HMKTD5E9APRC", Request id "0HMKTD5E9APRC:0000000B": started reading request body.
2022-09-23 14:42:41.766 +01:00 [DBG] Connection id "0HMKTD5E9APRC", Request id "0HMKTD5E9APRC:0000000B": done reading request body.
2022-09-23 14:42:41.769 +01:00 [DBG] JSON input formatter succeeded, deserializing to type 'APIBank.Models.MyRequestResponses.UserRevokeTokenRequest'
2022-09-23 14:42:41.771 +01:00 [DBG] Done attempting to bind parameter 'model' of type 'APIBank.Models.MyRequestResponses.UserRevokeTokenRequest'.
2022-09-23 14:42:41.772 +01:00 [DBG] Done attempting to bind parameter 'model' of type 'APIBank.Models.MyRequestResponses.UserRevokeTokenRequest'.
2022-09-23 14:42:41.773 +01:00 [DBG] Attempting to validate the bound parameter 'model' of type 'APIBank.Models.MyRequestResponses.UserRevokeTokenRequest' ...
2022-09-23 14:42:41.774 +01:00 [DBG] Done attempting to validate the bound parameter 'model' of type 'APIBank.Models.MyRequestResponses.UserRevokeTokenRequest'.
2022-09-23 14:42:41.782 +01:00 [DBG] Compiling query expression: 
'DbSet<RefreshToken>()
    .FirstOrDefault(e => EF.Property<int>(e, "Id") == __p_0)'
2022-09-23 14:42:41.788 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<RefreshToken>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: RefreshToken.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: RefreshToken.Created (DateTime) Required, 1], [Property: RefreshToken.CreatedByIp (string) Required MaxLength(200), 2], [Property: RefreshToken.Expires (DateTime) Required, 3], [Property: RefreshToken.IsActive (no field, bool) Required, 4], [Property: RefreshToken.IsExpired (no field, bool) Required, 5], [Property: RefreshToken.IsRevoked (no field, bool) Required, 6], [Property: RefreshToken.ReasonRevoked (string) MaxLength(200), 7], [Property: RefreshToken.RefToken (string) Required MaxLength(254), 8], [Property: RefreshToken.ReplacedByToken (string) MaxLength(200), 9], [Property: RefreshToken.Revoked (DateTime?), 10], [Property: RefreshToken.RevokedByIp (string) MaxLength(200), 11], [Property: RefreshToken.UserId (int) Required FK Index, 12] }
        SELECT TOP(1) r.id, r.created, r.created_by_ip, r.expires, r.is_active, r.is_expired, r.is_revoked, r.reason_revoked, r.token, r.replaced_by_token, r.revoked, r.revoked_by_ip, r.user_id
        FROM refresh_token AS r
        WHERE r.id == @__p_0), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, RefreshToken>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)
    .SingleOrDefault()'
2022-09-23 14:42:41.790 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 14:42:41.791 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2022-09-23 14:42:41.792 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 14:42:41.793 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 14:42:41.795 +01:00 [DBG] Executing DbCommand [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id, r.created, r.created_by_ip, r.expires, r.is_active, r.is_expired, r.is_revoked, r.reason_revoked, r.token, r.replaced_by_token, r.revoked, r.revoked_by_ip, r.user_id
FROM refresh_token AS r
WHERE r.id = @__p_0
LIMIT 1
2022-09-23 14:42:41.801 +01:00 [INF] Executed DbCommand (6ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id, r.created, r.created_by_ip, r.expires, r.is_active, r.is_expired, r.is_revoked, r.reason_revoked, r.token, r.replaced_by_token, r.revoked, r.revoked_by_ip, r.user_id
FROM refresh_token AS r
WHERE r.id = @__p_0
LIMIT 1
2022-09-23 14:42:41.819 +01:00 [DBG] Context 'PostgresContext' started tracking 'RefreshToken' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 14:42:41.829 +01:00 [DBG] A data reader was disposed.
2022-09-23 14:42:41.832 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 14:42:41.834 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 14:43:30.966 +01:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .SingleOrDefault(userQuery => userQuery.RefreshTokenCollection
        .Any(refTokenQuery => refTokenQuery.RefToken == __refToken_0))'
2022-09-23 14:43:30.981 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<User>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: User.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: User.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 1], [Property: User.Email (string) Required Index MaxLength(254), 2], [Property: User.FullName (string) Required MaxLength(100), 3], [Property: User.PasswordChangedAt (DateTime) Required ValueGenerated.OnAdd, 4], [Property: User.PasswordHash (string) Required MaxLength(200), 5], [Property: User.Username (string) Required Index MaxLength(50), 6] }
        SELECT TOP(2) u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
        FROM users AS u
        WHERE EXISTS (
            SELECT 1
            FROM refresh_token AS r
            WHERE ((u.id != NULL) && (u.id == r.user_id)) && (r.token == @__refToken_0))), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, User>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)
    .SingleOrDefault()'
2022-09-23 14:43:30.994 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 14:43:30.996 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2022-09-23 14:43:30.998 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 14:43:30.999 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 14:43:31.000 +01:00 [DBG] Executing DbCommand [Parameters=[@__refToken_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE EXISTS (
    SELECT 1
    FROM refresh_token AS r
    WHERE (u.id = r.user_id) AND (r.token = @__refToken_0))
LIMIT 2
2022-09-23 14:43:31.004 +01:00 [INF] Executed DbCommand (4ms) [Parameters=[@__refToken_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE EXISTS (
    SELECT 1
    FROM refresh_token AS r
    WHERE (u.id = r.user_id) AND (r.token = @__refToken_0))
LIMIT 2
2022-09-23 14:43:31.009 +01:00 [DBG] A data reader was disposed.
2022-09-23 14:43:31.010 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 14:43:31.012 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 14:43:32.202 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 14:43:32.205 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (3ms).
2022-09-23 14:43:32.206 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 14:43:32.208 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 14:43:32.209 +01:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.user_id AS "UserId", r.token AS "RefToken", r.expires AS "Expires", r.created AS "Created", r.created_by_ip AS "CreatedByIp", r.revoked AS "Revoked", r.revoked_by_ip AS "RevokedByIp", r.replaced_by_token AS "ReplacedByToken", r.reason_revoked AS "ReasonRevoked", r.is_expired AS "IsExpired", r.is_revoked AS "IsRevoked", r.is_active AS "IsActive"
FROM refresh_token AS r
WHERE r.user_id = @__id_0
2022-09-23 14:43:32.211 +01:00 [INF] Executed DbCommand (3ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.user_id AS "UserId", r.token AS "RefToken", r.expires AS "Expires", r.created AS "Created", r.created_by_ip AS "CreatedByIp", r.revoked AS "Revoked", r.revoked_by_ip AS "RevokedByIp", r.replaced_by_token AS "ReplacedByToken", r.reason_revoked AS "ReasonRevoked", r.is_expired AS "IsExpired", r.is_revoked AS "IsRevoked", r.is_active AS "IsActive"
FROM refresh_token AS r
WHERE r.user_id = @__id_0
2022-09-23 14:43:32.214 +01:00 [DBG] A data reader was disposed.
2022-09-23 14:43:32.214 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 14:43:32.216 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 14:50:00.741 +01:00 [DBG] An entity of type 'User' tracked by 'PostgresContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 14:51:45.127 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 14:51:45.134 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (7ms).
2022-09-23 14:51:45.138 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 14:51:45.139 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 14:51:45.141 +01:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.user_id AS "UserId", r.token AS "RefToken", r.expires AS "Expires", r.created AS "Created", r.created_by_ip AS "CreatedByIp", r.revoked AS "Revoked", r.revoked_by_ip AS "RevokedByIp", r.replaced_by_token AS "ReplacedByToken", r.reason_revoked AS "ReasonRevoked", r.is_expired AS "IsExpired", r.is_revoked AS "IsRevoked", r.is_active AS "IsActive"
FROM refresh_token AS r
WHERE r.user_id = @__id_0
2022-09-23 14:51:45.144 +01:00 [INF] Executed DbCommand (3ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.user_id AS "UserId", r.token AS "RefToken", r.expires AS "Expires", r.created AS "Created", r.created_by_ip AS "CreatedByIp", r.revoked AS "Revoked", r.revoked_by_ip AS "RevokedByIp", r.replaced_by_token AS "ReplacedByToken", r.reason_revoked AS "ReasonRevoked", r.is_expired AS "IsExpired", r.is_revoked AS "IsRevoked", r.is_active AS "IsActive"
FROM refresh_token AS r
WHERE r.user_id = @__id_0
2022-09-23 14:51:45.146 +01:00 [DBG] A data reader was disposed.
2022-09-23 14:51:45.147 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 14:51:45.170 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 14:52:12.642 +01:00 [DBG] SaveChanges starting for 'PostgresContext'.
2022-09-23 14:52:12.646 +01:00 [DBG] DetectChanges starting for 'PostgresContext'.
2022-09-23 14:52:12.657 +01:00 [DBG] The unchanged property 'RefreshToken.IsActive' was detected as changed and will be marked as modified. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2022-09-23 14:52:12.660 +01:00 [DBG] An entity of type 'RefreshToken' tracked by 'PostgresContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 14:52:12.669 +01:00 [DBG] The unchanged property 'RefreshToken.IsRevoked' was detected as changed and will be marked as modified. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2022-09-23 14:52:12.682 +01:00 [DBG] The unchanged property 'RefreshToken.ReasonRevoked' was detected as changed and will be marked as modified. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2022-09-23 14:52:12.687 +01:00 [DBG] The unchanged property 'RefreshToken.Revoked' was detected as changed and will be marked as modified. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2022-09-23 14:52:12.691 +01:00 [DBG] The unchanged property 'RefreshToken.RevokedByIp' was detected as changed and will be marked as modified. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2022-09-23 14:52:12.692 +01:00 [DBG] DetectChanges completed for 'PostgresContext'.
2022-09-23 14:52:12.694 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 14:52:12.697 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 14:52:12.700 +01:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2022-09-23 14:52:12.701 +01:00 [DBG] Began transaction with isolation level 'ReadCommitted'.
2022-09-23 14:52:12.702 +01:00 [DBG] Executing 2 update commands as a batch.
2022-09-23 14:52:12.703 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 14:52:12.704 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2022-09-23 14:52:12.705 +01:00 [DBG] Executing DbCommand [Parameters=[@p5='?' (DbType = Int32), @p0='?' (DbType = Boolean), @p1='?' (DbType = Boolean), @p2='?', @p3='?' (DbType = DateTime), @p4='?', @p12='?' (DbType = Int32), @p6='?' (DbType = DateTime), @p7='?', @p8='?', @p9='?' (DbType = DateTime), @p10='?', @p11='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE refresh_token SET is_active = @p0, is_revoked = @p1, reason_revoked = @p2, revoked = @p3, revoked_by_ip = @p4
WHERE id = @p5;
UPDATE users SET created_at = @p6, email = @p7, full_name = @p8, password_changed_at = @p9, password_hash = @p10, username = @p11
WHERE id = @p12;
2022-09-23 14:52:12.709 +01:00 [INF] Executed DbCommand (3ms) [Parameters=[@p5='?' (DbType = Int32), @p0='?' (DbType = Boolean), @p1='?' (DbType = Boolean), @p2='?', @p3='?' (DbType = DateTime), @p4='?', @p12='?' (DbType = Int32), @p6='?' (DbType = DateTime), @p7='?', @p8='?', @p9='?' (DbType = DateTime), @p10='?', @p11='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE refresh_token SET is_active = @p0, is_revoked = @p1, reason_revoked = @p2, revoked = @p3, revoked_by_ip = @p4
WHERE id = @p5;
UPDATE users SET created_at = @p6, email = @p7, full_name = @p8, password_changed_at = @p9, password_hash = @p10, username = @p11
WHERE id = @p12;
2022-09-23 14:52:12.730 +01:00 [DBG] A data reader was disposed.
2022-09-23 14:52:12.731 +01:00 [DBG] Committing transaction.
2022-09-23 14:52:12.733 +01:00 [DBG] Committed transaction.
2022-09-23 14:52:12.734 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 14:52:12.735 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 14:52:12.739 +01:00 [DBG] Disposing transaction.
2022-09-23 14:52:12.740 +01:00 [DBG] An entity of type 'User' tracked by 'PostgresContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 14:52:12.741 +01:00 [DBG] An entity of type 'RefreshToken' tracked by 'PostgresContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 14:52:12.747 +01:00 [DBG] SaveChanges completed for 'PostgresContext' with 2 entities written to the database.
2022-09-23 14:52:18.160 +01:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2022-09-23 14:52:18.167 +01:00 [DBG] No information found on request to perform content negotiation.
2022-09-23 14:52:18.168 +01:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2022-09-23 14:52:18.170 +01:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2022-09-23 14:52:18.172 +01:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2022-09-23 14:52:18.175 +01:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType0`1[[System.String, System.Private.CoreLib, Version=6.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2022-09-23 14:52:18.179 +01:00 [INF] Executed action APIBank.Controllers.UsersController.RevokeToken (APIBank) in 576440.6603ms
2022-09-23 14:52:18.181 +01:00 [INF] Executed endpoint 'APIBank.Controllers.UsersController.RevokeToken (APIBank)'
2022-09-23 14:52:18.182 +01:00 [DBG] 'PostgresContext' disposed.
2022-09-23 14:52:18.184 +01:00 [INF] Request finished HTTP/2 POST https://localhost:7036/api/Users/revoke-token application/json 20 - 200 - application/json;+charset=utf-8 577196.7980ms
2022-09-23 14:52:35.214 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/api/Users/1/refresh-tokens - -
2022-09-23 14:52:35.217 +01:00 [DBG] 1 candidate(s) found for the request path '/api/Users/1/refresh-tokens'
2022-09-23 14:52:35.219 +01:00 [DBG] Endpoint 'APIBank.Controllers.UsersController.GetRefreshTokens (APIBank)' with route pattern 'api/Users/{id}/refresh-tokens' is valid for the request path '/api/Users/1/refresh-tokens'
2022-09-23 14:52:35.224 +01:00 [DBG] Request matched endpoint 'APIBank.Controllers.UsersController.GetRefreshTokens (APIBank)'
2022-09-23 14:52:35.226 +01:00 [DBG] Static files was skipped as the request already matched an endpoint.
2022-09-23 14:52:35.655 +01:00 [INF] Entity Framework Core 6.0.9 initialized 'PostgresContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:6.0.7+5b98e4b74de93b590b44aef8dd7967c03acc433c' with options: None
2022-09-23 14:52:35.683 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 14:52:35.685 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2022-09-23 14:52:35.686 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 14:52:35.687 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 14:52:35.688 +01:00 [DBG] Executing DbCommand [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.id = @__p_0
LIMIT 1
2022-09-23 14:52:35.699 +01:00 [INF] Executed DbCommand (11ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.id = @__p_0
LIMIT 1
2022-09-23 14:52:35.701 +01:00 [DBG] Context 'PostgresContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 14:52:35.703 +01:00 [DBG] A data reader was disposed.
2022-09-23 14:52:35.704 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 14:52:35.707 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 14:52:35.711 +01:00 [INF] Executing endpoint 'APIBank.Controllers.UsersController.GetRefreshTokens (APIBank)'
2022-09-23 14:52:35.725 +01:00 [INF] Route matched with {action = "GetRefreshTokens", controller = "Users"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult GetRefreshTokens(Int32) on controller APIBank.Controllers.UsersController (APIBank).
2022-09-23 14:52:35.734 +01:00 [DBG] Execution plan of authorization filters (in the following order): ["APIBank.Authorization.AuthorizeAttribute"]
2022-09-23 14:52:35.736 +01:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2022-09-23 14:52:35.740 +01:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2022-09-23 14:52:35.745 +01:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2022-09-23 14:52:35.746 +01:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2022-09-23 14:52:35.749 +01:00 [DBG] Executing controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-23 14:52:35.750 +01:00 [DBG] Executed controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-23 14:52:35.751 +01:00 [DBG] Attempting to bind parameter 'id' of type 'System.Int32' ...
2022-09-23 14:52:35.752 +01:00 [DBG] Attempting to bind parameter 'id' of type 'System.Int32' using the name 'id' in request data ...
2022-09-23 14:52:35.759 +01:00 [DBG] Done attempting to bind parameter 'id' of type 'System.Int32'.
2022-09-23 14:52:35.761 +01:00 [DBG] Done attempting to bind parameter 'id' of type 'System.Int32'.
2022-09-23 14:52:35.766 +01:00 [DBG] Attempting to validate the bound parameter 'id' of type 'System.Int32' ...
2022-09-23 14:52:35.781 +01:00 [DBG] Done attempting to validate the bound parameter 'id' of type 'System.Int32'.
2022-09-23 14:52:35.786 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 14:52:35.788 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2022-09-23 14:52:35.791 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 14:52:35.793 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 14:52:35.795 +01:00 [DBG] Executing DbCommand [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id, r.created, r.created_by_ip, r.expires, r.is_active, r.is_expired, r.is_revoked, r.reason_revoked, r.token, r.replaced_by_token, r.revoked, r.revoked_by_ip, r.user_id
FROM refresh_token AS r
WHERE r.id = @__p_0
LIMIT 1
2022-09-23 14:52:35.797 +01:00 [INF] Executed DbCommand (3ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id, r.created, r.created_by_ip, r.expires, r.is_active, r.is_expired, r.is_revoked, r.reason_revoked, r.token, r.replaced_by_token, r.revoked, r.revoked_by_ip, r.user_id
FROM refresh_token AS r
WHERE r.id = @__p_0
LIMIT 1
2022-09-23 14:52:35.802 +01:00 [DBG] Context 'PostgresContext' started tracking 'RefreshToken' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 14:52:35.803 +01:00 [DBG] A data reader was disposed.
2022-09-23 14:52:35.805 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 14:52:35.807 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 14:52:35.824 +01:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2022-09-23 14:52:35.835 +01:00 [DBG] No information found on request to perform content negotiation.
2022-09-23 14:52:35.837 +01:00 [DBG] Attempting to select the first output formatter in the output formatters list which supports a content type from the explicitly specified content types '["application/problem+json","application/problem+xml","application/problem+json","application/problem+xml"]'.
2022-09-23 14:52:35.846 +01:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/problem+json' to write the response.
2022-09-23 14:52:35.850 +01:00 [INF] Executing ObjectResult, writing value of type 'Microsoft.AspNetCore.Mvc.ProblemDetails'.
2022-09-23 14:52:35.855 +01:00 [INF] Executed action APIBank.Controllers.UsersController.GetRefreshTokens (APIBank) in 106.6194ms
2022-09-23 14:52:35.859 +01:00 [INF] Executed endpoint 'APIBank.Controllers.UsersController.GetRefreshTokens (APIBank)'
2022-09-23 14:52:35.894 +01:00 [DBG] 'PostgresContext' disposed.
2022-09-23 14:52:35.896 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/api/Users/1/refresh-tokens - - - 401 - application/problem+json;+charset=utf-8 681.9482ms
2022-09-23 14:52:56.482 +01:00 [INF] Request starting HTTP/2 POST https://localhost:7036/api/Users/refreshToken - 0
2022-09-23 14:52:56.526 +01:00 [DBG] 1 candidate(s) found for the request path '/api/Users/refreshToken'
2022-09-23 14:52:56.528 +01:00 [DBG] Endpoint 'APIBank.Controllers.UsersController.RefreshToken (APIBank)' with route pattern 'api/Users/refreshToken' is valid for the request path '/api/Users/refreshToken'
2022-09-23 14:52:56.559 +01:00 [DBG] Request matched endpoint 'APIBank.Controllers.UsersController.RefreshToken (APIBank)'
2022-09-23 14:52:56.566 +01:00 [DBG] Static files was skipped as the request already matched an endpoint.
2022-09-23 14:52:56.573 +01:00 [INF] Entity Framework Core 6.0.9 initialized 'PostgresContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:6.0.7+5b98e4b74de93b590b44aef8dd7967c03acc433c' with options: None
2022-09-23 14:52:56.585 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 14:52:56.586 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2022-09-23 14:52:56.589 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 14:52:56.603 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 14:52:56.608 +01:00 [DBG] Executing DbCommand [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.id = @__p_0
LIMIT 1
2022-09-23 14:52:56.619 +01:00 [INF] Executed DbCommand (11ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.id = @__p_0
LIMIT 1
2022-09-23 14:52:56.626 +01:00 [DBG] Context 'PostgresContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 14:52:56.630 +01:00 [DBG] A data reader was disposed.
2022-09-23 14:52:56.636 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 14:52:56.659 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 14:52:56.662 +01:00 [INF] Executing endpoint 'APIBank.Controllers.UsersController.RefreshToken (APIBank)'
2022-09-23 14:52:56.682 +01:00 [INF] Route matched with {action = "RefreshToken", controller = "Users"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult RefreshToken() on controller APIBank.Controllers.UsersController (APIBank).
2022-09-23 14:52:56.687 +01:00 [DBG] Execution plan of authorization filters (in the following order): ["APIBank.Authorization.AuthorizeAttribute"]
2022-09-23 14:52:56.690 +01:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2022-09-23 14:52:56.691 +01:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2022-09-23 14:52:56.698 +01:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2022-09-23 14:52:56.702 +01:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2022-09-23 14:52:56.710 +01:00 [DBG] Executing controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-23 14:52:56.713 +01:00 [DBG] Executed controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-23 14:52:56.719 +01:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .SingleOrDefault(userQuery => userQuery.RefreshTokenCollection
        .Any(refTokenQuery => refTokenQuery.RefToken == __refToken_0))'
2022-09-23 14:52:56.752 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<User>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: User.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: User.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 1], [Property: User.Email (string) Required Index MaxLength(254), 2], [Property: User.FullName (string) Required MaxLength(100), 3], [Property: User.PasswordChangedAt (DateTime) Required ValueGenerated.OnAdd, 4], [Property: User.PasswordHash (string) Required MaxLength(200), 5], [Property: User.Username (string) Required Index MaxLength(50), 6] }
        SELECT TOP(2) u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
        FROM users AS u
        WHERE EXISTS (
            SELECT 1
            FROM refresh_token AS r
            WHERE ((u.id != NULL) && (u.id == r.user_id)) && (r.token == @__refToken_0))), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, User>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)
    .SingleOrDefault()'
2022-09-23 14:52:56.802 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 14:52:56.803 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2022-09-23 14:52:56.832 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 14:52:56.847 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 14:52:56.850 +01:00 [DBG] Executing DbCommand [Parameters=[@__refToken_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE EXISTS (
    SELECT 1
    FROM refresh_token AS r
    WHERE (u.id = r.user_id) AND (r.token = @__refToken_0))
LIMIT 2
2022-09-23 14:52:56.852 +01:00 [INF] Executed DbCommand (3ms) [Parameters=[@__refToken_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE EXISTS (
    SELECT 1
    FROM refresh_token AS r
    WHERE (u.id = r.user_id) AND (r.token = @__refToken_0))
LIMIT 2
2022-09-23 14:52:56.858 +01:00 [DBG] A data reader was disposed.
2022-09-23 14:52:56.860 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 14:52:56.863 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 14:52:56.866 +01:00 [DBG] Compiling query expression: 
'DbSet<RefreshToken>()
    .Where(rt => rt.UserId == __id_0)
    .AsNoTracking()
    .Select(rt => new RefreshToken{ 
        Id = rt.Id, 
        UserId = rt.UserId, 
        RefToken = rt.RefToken, 
        Expires = rt.Expires, 
        Created = rt.Created, 
        CreatedByIp = rt.CreatedByIp, 
        Revoked = rt.Revoked, 
        RevokedByIp = rt.RevokedByIp, 
        ReplacedByToken = rt.ReplacedByToken, 
        ReasonRevoked = rt.ReasonRevoked, 
        IsExpired = rt.IsExpired, 
        IsRevoked = rt.IsRevoked, 
        IsActive = rt.IsActive 
    }
    )'
2022-09-23 14:52:56.876 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<RefreshToken>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            Id -> 0
            UserId -> 1
            RefToken -> 2
            Expires -> 3
            Created -> 4
            CreatedByIp -> 5
            Revoked -> 6
            RevokedByIp -> 7
            ReplacedByToken -> 8
            ReasonRevoked -> 9
            IsExpired -> 10
            IsRevoked -> 11
            IsActive -> 12
        SELECT r.id AS Id, r.user_id AS UserId, r.token AS RefToken, r.expires AS Expires, r.created AS Created, r.created_by_ip AS CreatedByIp, r.revoked AS Revoked, r.revoked_by_ip AS RevokedByIp, r.replaced_by_token AS ReplacedByToken, r.reason_revoked AS ReasonRevoked, r.is_expired AS IsExpired, r.is_revoked AS IsRevoked, r.is_active AS IsActive
        FROM refresh_token AS r
        WHERE r.user_id == @__id_0), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, RefreshToken>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)'
2022-09-23 14:52:56.883 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 14:52:56.897 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (14ms).
2022-09-23 14:52:56.907 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 14:52:56.910 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 14:52:56.911 +01:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.user_id AS "UserId", r.token AS "RefToken", r.expires AS "Expires", r.created AS "Created", r.created_by_ip AS "CreatedByIp", r.revoked AS "Revoked", r.revoked_by_ip AS "RevokedByIp", r.replaced_by_token AS "ReplacedByToken", r.reason_revoked AS "ReasonRevoked", r.is_expired AS "IsExpired", r.is_revoked AS "IsRevoked", r.is_active AS "IsActive"
FROM refresh_token AS r
WHERE r.user_id = @__id_0
2022-09-23 14:52:56.915 +01:00 [INF] Executed DbCommand (3ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.user_id AS "UserId", r.token AS "RefToken", r.expires AS "Expires", r.created AS "Created", r.created_by_ip AS "CreatedByIp", r.revoked AS "Revoked", r.revoked_by_ip AS "RevokedByIp", r.replaced_by_token AS "ReplacedByToken", r.reason_revoked AS "ReasonRevoked", r.is_expired AS "IsExpired", r.is_revoked AS "IsRevoked", r.is_active AS "IsActive"
FROM refresh_token AS r
WHERE r.user_id = @__id_0
2022-09-23 14:52:56.917 +01:00 [DBG] A data reader was disposed.
2022-09-23 14:52:56.918 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 14:52:56.920 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 14:52:56.923 +01:00 [DBG] An entity of type 'User' tracked by 'PostgresContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 14:52:56.927 +01:00 [DBG] Context 'PostgresContext' started tracking 'RefreshToken' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 14:52:56.929 +01:00 [DBG] SaveChanges starting for 'PostgresContext'.
2022-09-23 14:52:56.932 +01:00 [DBG] DetectChanges starting for 'PostgresContext'.
2022-09-23 14:52:56.933 +01:00 [DBG] DetectChanges completed for 'PostgresContext'.
2022-09-23 14:52:56.934 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 14:52:56.935 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 14:52:56.936 +01:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2022-09-23 14:52:56.938 +01:00 [DBG] Began transaction with isolation level 'ReadCommitted'.
2022-09-23 14:52:56.940 +01:00 [DBG] Executing 2 update commands as a batch.
2022-09-23 14:52:56.942 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 14:52:56.955 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (12ms).
2022-09-23 14:52:56.974 +01:00 [DBG] Executing DbCommand [Parameters=[@p12='?' (DbType = Int32), @p0='?' (DbType = DateTime), @p1='?', @p2='?' (DbType = DateTime), @p3='?' (DbType = Boolean), @p4='?' (DbType = Boolean), @p5='?' (DbType = Boolean), @p6='?', @p7='?', @p8='?', @p9='?' (DbType = DateTime), @p10='?', @p11='?' (DbType = Int32), @p19='?' (DbType = Int32), @p13='?' (DbType = DateTime), @p14='?', @p15='?', @p16='?' (DbType = DateTime), @p17='?', @p18='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE refresh_token SET created = @p0, created_by_ip = @p1, expires = @p2, is_active = @p3, is_expired = @p4, is_revoked = @p5, reason_revoked = @p6, token = @p7, replaced_by_token = @p8, revoked = @p9, revoked_by_ip = @p10, user_id = @p11
WHERE id = @p12;
UPDATE users SET created_at = @p13, email = @p14, full_name = @p15, password_changed_at = @p16, password_hash = @p17, username = @p18
WHERE id = @p19;
2022-09-23 14:52:56.985 +01:00 [INF] Executed DbCommand (12ms) [Parameters=[@p12='?' (DbType = Int32), @p0='?' (DbType = DateTime), @p1='?', @p2='?' (DbType = DateTime), @p3='?' (DbType = Boolean), @p4='?' (DbType = Boolean), @p5='?' (DbType = Boolean), @p6='?', @p7='?', @p8='?', @p9='?' (DbType = DateTime), @p10='?', @p11='?' (DbType = Int32), @p19='?' (DbType = Int32), @p13='?' (DbType = DateTime), @p14='?', @p15='?', @p16='?' (DbType = DateTime), @p17='?', @p18='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE refresh_token SET created = @p0, created_by_ip = @p1, expires = @p2, is_active = @p3, is_expired = @p4, is_revoked = @p5, reason_revoked = @p6, token = @p7, replaced_by_token = @p8, revoked = @p9, revoked_by_ip = @p10, user_id = @p11
WHERE id = @p12;
UPDATE users SET created_at = @p13, email = @p14, full_name = @p15, password_changed_at = @p16, password_hash = @p17, username = @p18
WHERE id = @p19;
2022-09-23 14:52:56.990 +01:00 [DBG] A data reader was disposed.
2022-09-23 14:52:56.995 +01:00 [DBG] Committing transaction.
2022-09-23 14:52:56.999 +01:00 [DBG] Committed transaction.
2022-09-23 14:52:57.000 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 14:52:57.001 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 14:52:57.002 +01:00 [DBG] Disposing transaction.
2022-09-23 14:52:57.002 +01:00 [DBG] An entity of type 'User' tracked by 'PostgresContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 14:52:57.006 +01:00 [DBG] An entity of type 'RefreshToken' tracked by 'PostgresContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 14:52:57.013 +01:00 [DBG] SaveChanges completed for 'PostgresContext' with 2 entities written to the database.
2022-09-23 14:53:05.744 +01:00 [INF] Executed action APIBank.Controllers.UsersController.RefreshToken (APIBank) in 9034.5338ms
2022-09-23 14:53:05.749 +01:00 [INF] Executed endpoint 'APIBank.Controllers.UsersController.RefreshToken (APIBank)'
2022-09-23 14:53:05.814 +01:00 [INF] Global Error was found:
2022-09-23 14:53:05.822 +01:00 [DBG] 'PostgresContext' disposed.
2022-09-23 14:53:05.827 +01:00 [INF] Request finished HTTP/2 POST https://localhost:7036/api/Users/refreshToken - 0 - 400 - application/json 9344.9083ms
2022-09-23 14:53:13.248 +01:00 [INF] Request starting HTTP/2 POST https://localhost:7036/api/Users/Login application/json 58
2022-09-23 14:53:13.252 +01:00 [DBG] 1 candidate(s) found for the request path '/api/Users/Login'
2022-09-23 14:53:13.254 +01:00 [DBG] Endpoint 'APIBank.Controllers.UsersController.Login (APIBank)' with route pattern 'api/Users/Login' is valid for the request path '/api/Users/Login'
2022-09-23 14:53:13.256 +01:00 [DBG] Request matched endpoint 'APIBank.Controllers.UsersController.Login (APIBank)'
2022-09-23 14:53:13.258 +01:00 [DBG] Static files was skipped as the request already matched an endpoint.
2022-09-23 14:53:13.270 +01:00 [INF] Entity Framework Core 6.0.9 initialized 'PostgresContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:6.0.7+5b98e4b74de93b590b44aef8dd7967c03acc433c' with options: None
2022-09-23 14:53:13.291 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 14:53:13.302 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (11ms).
2022-09-23 14:53:13.304 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 14:53:13.305 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 14:53:13.308 +01:00 [DBG] Executing DbCommand [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.id = @__p_0
LIMIT 1
2022-09-23 14:53:13.320 +01:00 [INF] Executed DbCommand (12ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.id = @__p_0
LIMIT 1
2022-09-23 14:53:13.328 +01:00 [DBG] Context 'PostgresContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 14:53:13.331 +01:00 [DBG] A data reader was disposed.
2022-09-23 14:53:13.332 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 14:53:13.334 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 14:53:13.336 +01:00 [INF] Executing endpoint 'APIBank.Controllers.UsersController.Login (APIBank)'
2022-09-23 14:53:13.340 +01:00 [INF] Route matched with {action = "Login", controller = "Users"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult Login(APIBank.Models.Requests.UserLoginRequest) on controller APIBank.Controllers.UsersController (APIBank).
2022-09-23 14:53:13.372 +01:00 [DBG] Execution plan of authorization filters (in the following order): ["APIBank.Authorization.AuthorizeAttribute"]
2022-09-23 14:53:13.383 +01:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2022-09-23 14:53:13.390 +01:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2022-09-23 14:53:13.394 +01:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2022-09-23 14:53:13.396 +01:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2022-09-23 14:53:13.398 +01:00 [DBG] Executing controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-23 14:53:13.399 +01:00 [DBG] Executed controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-23 14:53:13.405 +01:00 [DBG] Attempting to bind parameter 'model' of type 'APIBank.Models.Requests.UserLoginRequest' ...
2022-09-23 14:53:13.410 +01:00 [DBG] Attempting to bind parameter 'model' of type 'APIBank.Models.Requests.UserLoginRequest' using the name '' in request data ...
2022-09-23 14:53:13.412 +01:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2022-09-23 14:53:13.440 +01:00 [DBG] Connection id "0HMKTD5E9APRC", Request id "0HMKTD5E9APRC:00000011": started reading request body.
2022-09-23 14:53:13.452 +01:00 [DBG] Connection id "0HMKTD5E9APRC", Request id "0HMKTD5E9APRC:00000011": done reading request body.
2022-09-23 14:53:13.454 +01:00 [DBG] JSON input formatter succeeded, deserializing to type 'APIBank.Models.Requests.UserLoginRequest'
2022-09-23 14:53:13.456 +01:00 [DBG] Done attempting to bind parameter 'model' of type 'APIBank.Models.Requests.UserLoginRequest'.
2022-09-23 14:53:13.459 +01:00 [DBG] Done attempting to bind parameter 'model' of type 'APIBank.Models.Requests.UserLoginRequest'.
2022-09-23 14:53:13.472 +01:00 [DBG] Attempting to validate the bound parameter 'model' of type 'APIBank.Models.Requests.UserLoginRequest' ...
2022-09-23 14:53:13.489 +01:00 [DBG] Done attempting to validate the bound parameter 'model' of type 'APIBank.Models.Requests.UserLoginRequest'.
2022-09-23 14:53:13.499 +01:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .SingleOrDefault(x => x.Username == __model_Username_0)'
2022-09-23 14:53:13.504 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<User>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: User.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: User.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 1], [Property: User.Email (string) Required Index MaxLength(254), 2], [Property: User.FullName (string) Required MaxLength(100), 3], [Property: User.PasswordChangedAt (DateTime) Required ValueGenerated.OnAdd, 4], [Property: User.PasswordHash (string) Required MaxLength(200), 5], [Property: User.Username (string) Required Index MaxLength(50), 6] }
        SELECT TOP(2) u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
        FROM users AS u
        WHERE u.username == @__model_Username_0), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, User>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)
    .SingleOrDefault()'
2022-09-23 14:53:13.513 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 14:53:13.515 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (2ms).
2022-09-23 14:53:13.538 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 14:53:13.597 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 14:53:13.618 +01:00 [DBG] Executing DbCommand [Parameters=[@__model_Username_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.username = @__model_Username_0
LIMIT 2
2022-09-23 14:53:13.633 +01:00 [INF] Executed DbCommand (16ms) [Parameters=[@__model_Username_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.username = @__model_Username_0
LIMIT 2
2022-09-23 14:53:13.638 +01:00 [DBG] A data reader was disposed.
2022-09-23 14:53:13.639 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 14:53:13.643 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 14:53:13.983 +01:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .Any(user => user.RefreshTokenCollection
        .Any(reftoken => reftoken.RefToken == __token_0))'
2022-09-23 14:53:14.014 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<bool>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            EmptyProjectionMember -> 0
        SELECT EXISTS (
            SELECT 1
            FROM users AS u
            WHERE EXISTS (
                SELECT 1
                FROM refresh_token AS r
                WHERE ((u.id != NULL) && (u.id == r.user_id)) && (r.token == @__token_0)))), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, bool>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)
    .Single()'
2022-09-23 14:53:14.104 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 14:53:14.163 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (58ms).
2022-09-23 14:53:14.304 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 14:53:14.321 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 14:53:14.386 +01:00 [DBG] Executing DbCommand [Parameters=[@__token_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM users AS u
    WHERE EXISTS (
        SELECT 1
        FROM refresh_token AS r
        WHERE (u.id = r.user_id) AND (r.token = @__token_0)))
2022-09-23 14:53:14.425 +01:00 [INF] Executed DbCommand (40ms) [Parameters=[@__token_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM users AS u
    WHERE EXISTS (
        SELECT 1
        FROM refresh_token AS r
        WHERE (u.id = r.user_id) AND (r.token = @__token_0)))
2022-09-23 14:53:14.456 +01:00 [DBG] A data reader was disposed.
2022-09-23 14:53:14.470 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 14:53:14.504 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 14:53:14.518 +01:00 [DBG] SaveChanges starting for 'PostgresContext'.
2022-09-23 14:53:14.519 +01:00 [DBG] DetectChanges starting for 'PostgresContext'.
2022-09-23 14:53:14.527 +01:00 [DBG] 1 entities were added and 0 entities were removed from navigation 'User.RefreshTokenCollection'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 14:53:14.531 +01:00 [DBG] 'PostgresContext' generated a temporary value for the property 'Id.RefreshToken'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 14:53:14.533 +01:00 [DBG] Context 'PostgresContext' started tracking 'RefreshToken' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 14:53:14.537 +01:00 [DBG] DetectChanges completed for 'PostgresContext'.
2022-09-23 14:53:14.540 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 14:53:14.542 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 14:53:14.544 +01:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2022-09-23 14:53:14.550 +01:00 [DBG] Began transaction with isolation level 'ReadCommitted'.
2022-09-23 14:53:14.576 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 14:53:14.578 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2022-09-23 14:53:14.580 +01:00 [DBG] Executing DbCommand [Parameters=[@p0='?' (DbType = DateTime), @p1='?', @p2='?' (DbType = DateTime), @p3='?' (DbType = Boolean), @p4='?' (DbType = Boolean), @p5='?' (DbType = Boolean), @p6='?', @p7='?', @p8='?', @p9='?' (DbType = DateTime), @p10='?', @p11='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO refresh_token (created, created_by_ip, expires, is_active, is_expired, is_revoked, reason_revoked, token, replaced_by_token, revoked, revoked_by_ip, user_id)
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11)
RETURNING id;
2022-09-23 14:53:14.586 +01:00 [INF] Executed DbCommand (6ms) [Parameters=[@p0='?' (DbType = DateTime), @p1='?', @p2='?' (DbType = DateTime), @p3='?' (DbType = Boolean), @p4='?' (DbType = Boolean), @p5='?' (DbType = Boolean), @p6='?', @p7='?', @p8='?', @p9='?' (DbType = DateTime), @p10='?', @p11='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO refresh_token (created, created_by_ip, expires, is_active, is_expired, is_revoked, reason_revoked, token, replaced_by_token, revoked, revoked_by_ip, user_id)
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11)
RETURNING id;
2022-09-23 14:53:14.591 +01:00 [DBG] The foreign key property 'RefreshToken.Id' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2022-09-23 14:53:14.594 +01:00 [DBG] A data reader was disposed.
2022-09-23 14:53:14.596 +01:00 [DBG] Committing transaction.
2022-09-23 14:53:14.601 +01:00 [DBG] Committed transaction.
2022-09-23 14:53:14.603 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 14:53:14.604 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 14:53:14.605 +01:00 [DBG] Disposing transaction.
2022-09-23 14:53:14.607 +01:00 [DBG] An entity of type 'RefreshToken' tracked by 'PostgresContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 14:53:14.609 +01:00 [DBG] SaveChanges completed for 'PostgresContext' with 1 entities written to the database.
2022-09-23 14:53:14.617 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 14:53:14.623 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (5ms).
2022-09-23 14:53:14.629 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 14:53:14.633 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 14:53:14.635 +01:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.user_id AS "UserId", r.token AS "RefToken", r.expires AS "Expires", r.created AS "Created", r.created_by_ip AS "CreatedByIp", r.revoked AS "Revoked", r.revoked_by_ip AS "RevokedByIp", r.replaced_by_token AS "ReplacedByToken", r.reason_revoked AS "ReasonRevoked", r.is_expired AS "IsExpired", r.is_revoked AS "IsRevoked", r.is_active AS "IsActive"
FROM refresh_token AS r
WHERE r.user_id = @__id_0
2022-09-23 14:53:14.641 +01:00 [INF] Executed DbCommand (5ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.user_id AS "UserId", r.token AS "RefToken", r.expires AS "Expires", r.created AS "Created", r.created_by_ip AS "CreatedByIp", r.revoked AS "Revoked", r.revoked_by_ip AS "RevokedByIp", r.replaced_by_token AS "ReplacedByToken", r.reason_revoked AS "ReasonRevoked", r.is_expired AS "IsExpired", r.is_revoked AS "IsRevoked", r.is_active AS "IsActive"
FROM refresh_token AS r
WHERE r.user_id = @__id_0
2022-09-23 14:53:14.648 +01:00 [DBG] A data reader was disposed.
2022-09-23 14:53:14.650 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 14:53:14.652 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 14:53:14.654 +01:00 [DBG] An entity of type 'User' tracked by 'PostgresContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 14:53:14.663 +01:00 [DBG] An entity of type 'RefreshToken' tracked by 'PostgresContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 14:53:14.671 +01:00 [DBG] SaveChanges starting for 'PostgresContext'.
2022-09-23 14:53:14.686 +01:00 [DBG] DetectChanges starting for 'PostgresContext'.
2022-09-23 14:53:14.687 +01:00 [DBG] DetectChanges completed for 'PostgresContext'.
2022-09-23 14:53:14.691 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 14:53:14.694 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 14:53:14.696 +01:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2022-09-23 14:53:14.697 +01:00 [DBG] Began transaction with isolation level 'ReadCommitted'.
2022-09-23 14:53:14.698 +01:00 [DBG] Executing 2 update commands as a batch.
2022-09-23 14:53:14.699 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 14:53:14.701 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2022-09-23 14:53:14.702 +01:00 [DBG] Executing DbCommand [Parameters=[@p12='?' (DbType = Int32), @p0='?' (DbType = DateTime), @p1='?', @p2='?' (DbType = DateTime), @p3='?' (DbType = Boolean), @p4='?' (DbType = Boolean), @p5='?' (DbType = Boolean), @p6='?', @p7='?', @p8='?', @p9='?' (DbType = DateTime), @p10='?', @p11='?' (DbType = Int32), @p19='?' (DbType = Int32), @p13='?' (DbType = DateTime), @p14='?', @p15='?', @p16='?' (DbType = DateTime), @p17='?', @p18='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE refresh_token SET created = @p0, created_by_ip = @p1, expires = @p2, is_active = @p3, is_expired = @p4, is_revoked = @p5, reason_revoked = @p6, token = @p7, replaced_by_token = @p8, revoked = @p9, revoked_by_ip = @p10, user_id = @p11
WHERE id = @p12;
UPDATE users SET created_at = @p13, email = @p14, full_name = @p15, password_changed_at = @p16, password_hash = @p17, username = @p18
WHERE id = @p19;
2022-09-23 14:53:14.719 +01:00 [INF] Executed DbCommand (16ms) [Parameters=[@p12='?' (DbType = Int32), @p0='?' (DbType = DateTime), @p1='?', @p2='?' (DbType = DateTime), @p3='?' (DbType = Boolean), @p4='?' (DbType = Boolean), @p5='?' (DbType = Boolean), @p6='?', @p7='?', @p8='?', @p9='?' (DbType = DateTime), @p10='?', @p11='?' (DbType = Int32), @p19='?' (DbType = Int32), @p13='?' (DbType = DateTime), @p14='?', @p15='?', @p16='?' (DbType = DateTime), @p17='?', @p18='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE refresh_token SET created = @p0, created_by_ip = @p1, expires = @p2, is_active = @p3, is_expired = @p4, is_revoked = @p5, reason_revoked = @p6, token = @p7, replaced_by_token = @p8, revoked = @p9, revoked_by_ip = @p10, user_id = @p11
WHERE id = @p12;
UPDATE users SET created_at = @p13, email = @p14, full_name = @p15, password_changed_at = @p16, password_hash = @p17, username = @p18
WHERE id = @p19;
2022-09-23 14:53:14.747 +01:00 [DBG] A data reader was disposed.
2022-09-23 14:53:14.748 +01:00 [DBG] Committing transaction.
2022-09-23 14:53:14.750 +01:00 [DBG] Committed transaction.
2022-09-23 14:53:14.754 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 14:53:14.757 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 14:53:14.761 +01:00 [DBG] Disposing transaction.
2022-09-23 14:53:14.762 +01:00 [DBG] An entity of type 'User' tracked by 'PostgresContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 14:53:14.764 +01:00 [DBG] An entity of type 'RefreshToken' tracked by 'PostgresContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 14:53:14.769 +01:00 [DBG] SaveChanges completed for 'PostgresContext' with 2 entities written to the database.
2022-09-23 14:53:14.771 +01:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2022-09-23 14:53:14.774 +01:00 [DBG] Attempting to select an output formatter based on Accept header '["text/plain"]'.
2022-09-23 14:53:14.776 +01:00 [DBG] Could not find an output formatter based on content negotiation. Accepted types were (["text/plain"])
2022-09-23 14:53:14.779 +01:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2022-09-23 14:53:14.787 +01:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2022-09-23 14:53:14.793 +01:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2022-09-23 14:53:14.796 +01:00 [INF] Executing OkObjectResult, writing value of type 'APIBank.Models.MyRequestResponses.LoginResponse'.
2022-09-23 14:53:14.803 +01:00 [INF] Executed action APIBank.Controllers.UsersController.Login (APIBank) in 1405.1959ms
2022-09-23 14:53:14.806 +01:00 [INF] Executed endpoint 'APIBank.Controllers.UsersController.Login (APIBank)'
2022-09-23 14:53:14.813 +01:00 [DBG] 'PostgresContext' disposed.
2022-09-23 14:53:14.815 +01:00 [INF] Request finished HTTP/2 POST https://localhost:7036/api/Users/Login application/json 58 - 200 - application/json;+charset=utf-8 1573.5574ms
2022-09-23 14:53:27.560 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/api/Users/1/refresh-tokens - -
2022-09-23 14:53:27.564 +01:00 [DBG] 1 candidate(s) found for the request path '/api/Users/1/refresh-tokens'
2022-09-23 14:53:27.572 +01:00 [DBG] Endpoint 'APIBank.Controllers.UsersController.GetRefreshTokens (APIBank)' with route pattern 'api/Users/{id}/refresh-tokens' is valid for the request path '/api/Users/1/refresh-tokens'
2022-09-23 14:53:27.590 +01:00 [DBG] Request matched endpoint 'APIBank.Controllers.UsersController.GetRefreshTokens (APIBank)'
2022-09-23 14:53:27.592 +01:00 [DBG] Static files was skipped as the request already matched an endpoint.
2022-09-23 14:53:27.598 +01:00 [INF] Entity Framework Core 6.0.9 initialized 'PostgresContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:6.0.7+5b98e4b74de93b590b44aef8dd7967c03acc433c' with options: None
2022-09-23 14:53:27.605 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 14:53:27.606 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2022-09-23 14:53:27.607 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 14:53:27.608 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 14:53:27.609 +01:00 [DBG] Executing DbCommand [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.id = @__p_0
LIMIT 1
2022-09-23 14:53:27.611 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.id = @__p_0
LIMIT 1
2022-09-23 14:53:27.621 +01:00 [DBG] Context 'PostgresContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 14:53:27.631 +01:00 [DBG] A data reader was disposed.
2022-09-23 14:53:27.647 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 14:53:27.653 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 14:53:27.655 +01:00 [INF] Executing endpoint 'APIBank.Controllers.UsersController.GetRefreshTokens (APIBank)'
2022-09-23 14:53:27.656 +01:00 [INF] Route matched with {action = "GetRefreshTokens", controller = "Users"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult GetRefreshTokens(Int32) on controller APIBank.Controllers.UsersController (APIBank).
2022-09-23 14:53:27.658 +01:00 [DBG] Execution plan of authorization filters (in the following order): ["APIBank.Authorization.AuthorizeAttribute"]
2022-09-23 14:53:27.659 +01:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2022-09-23 14:53:27.663 +01:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2022-09-23 14:53:27.668 +01:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2022-09-23 14:53:27.670 +01:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2022-09-23 14:53:27.672 +01:00 [DBG] Executing controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-23 14:53:27.673 +01:00 [DBG] Executed controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-23 14:53:27.674 +01:00 [DBG] Attempting to bind parameter 'id' of type 'System.Int32' ...
2022-09-23 14:53:27.675 +01:00 [DBG] Attempting to bind parameter 'id' of type 'System.Int32' using the name 'id' in request data ...
2022-09-23 14:53:27.681 +01:00 [DBG] Done attempting to bind parameter 'id' of type 'System.Int32'.
2022-09-23 14:53:27.683 +01:00 [DBG] Done attempting to bind parameter 'id' of type 'System.Int32'.
2022-09-23 14:53:27.684 +01:00 [DBG] Attempting to validate the bound parameter 'id' of type 'System.Int32' ...
2022-09-23 14:53:27.699 +01:00 [DBG] Done attempting to validate the bound parameter 'id' of type 'System.Int32'.
2022-09-23 14:53:27.726 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 14:53:27.730 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (4ms).
2022-09-23 14:53:27.735 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 14:53:27.737 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 14:53:27.741 +01:00 [DBG] Executing DbCommand [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id, r.created, r.created_by_ip, r.expires, r.is_active, r.is_expired, r.is_revoked, r.reason_revoked, r.token, r.replaced_by_token, r.revoked, r.revoked_by_ip, r.user_id
FROM refresh_token AS r
WHERE r.id = @__p_0
LIMIT 1
2022-09-23 14:53:27.750 +01:00 [INF] Executed DbCommand (9ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id, r.created, r.created_by_ip, r.expires, r.is_active, r.is_expired, r.is_revoked, r.reason_revoked, r.token, r.replaced_by_token, r.revoked, r.revoked_by_ip, r.user_id
FROM refresh_token AS r
WHERE r.id = @__p_0
LIMIT 1
2022-09-23 14:53:27.807 +01:00 [DBG] Context 'PostgresContext' started tracking 'RefreshToken' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 14:53:27.821 +01:00 [DBG] A data reader was disposed.
2022-09-23 14:53:27.822 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 14:53:27.824 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 14:53:27.826 +01:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2022-09-23 14:53:27.839 +01:00 [DBG] No information found on request to perform content negotiation.
2022-09-23 14:53:27.842 +01:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2022-09-23 14:53:27.846 +01:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2022-09-23 14:53:27.848 +01:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2022-09-23 14:53:27.852 +01:00 [INF] Executing OkObjectResult, writing value of type 'Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryable`1[[APIBank.ModelEntities.RefreshToken, APIBank, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2022-09-23 14:53:27.904 +01:00 [DBG] Compiling query expression: 
'DbSet<RefreshToken>()
    .Where(rt => rt.UserId == __id_0)
    .AsNoTracking()
    .Select(rt => new RefreshToken{ 
        Id = rt.Id, 
        UserId = rt.UserId, 
        RefToken = rt.RefToken, 
        Expires = rt.Expires, 
        Created = rt.Created, 
        CreatedByIp = rt.CreatedByIp, 
        Revoked = rt.Revoked, 
        RevokedByIp = rt.RevokedByIp, 
        ReplacedByToken = rt.ReplacedByToken, 
        ReasonRevoked = rt.ReasonRevoked, 
        IsExpired = rt.IsExpired, 
        IsRevoked = rt.IsRevoked, 
        IsActive = rt.IsActive 
    }
    )'
2022-09-23 14:53:27.930 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<RefreshToken>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            Id -> 0
            UserId -> 1
            RefToken -> 2
            Expires -> 3
            Created -> 4
            CreatedByIp -> 5
            Revoked -> 6
            RevokedByIp -> 7
            ReplacedByToken -> 8
            ReasonRevoked -> 9
            IsExpired -> 10
            IsRevoked -> 11
            IsActive -> 12
        SELECT r.id AS Id, r.user_id AS UserId, r.token AS RefToken, r.expires AS Expires, r.created AS Created, r.created_by_ip AS CreatedByIp, r.revoked AS Revoked, r.revoked_by_ip AS RevokedByIp, r.replaced_by_token AS ReplacedByToken, r.reason_revoked AS ReasonRevoked, r.is_expired AS IsExpired, r.is_revoked AS IsRevoked, r.is_active AS IsActive
        FROM refresh_token AS r
        WHERE r.user_id == @__id_0), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, RefreshToken>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)'
2022-09-23 14:53:28.086 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 14:53:28.094 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (8ms).
2022-09-23 14:53:28.134 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 14:53:28.139 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 14:53:28.142 +01:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.user_id AS "UserId", r.token AS "RefToken", r.expires AS "Expires", r.created AS "Created", r.created_by_ip AS "CreatedByIp", r.revoked AS "Revoked", r.revoked_by_ip AS "RevokedByIp", r.replaced_by_token AS "ReplacedByToken", r.reason_revoked AS "ReasonRevoked", r.is_expired AS "IsExpired", r.is_revoked AS "IsRevoked", r.is_active AS "IsActive"
FROM refresh_token AS r
WHERE r.user_id = @__id_0
2022-09-23 14:53:28.191 +01:00 [INF] Executed DbCommand (49ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.user_id AS "UserId", r.token AS "RefToken", r.expires AS "Expires", r.created AS "Created", r.created_by_ip AS "CreatedByIp", r.revoked AS "Revoked", r.revoked_by_ip AS "RevokedByIp", r.replaced_by_token AS "ReplacedByToken", r.reason_revoked AS "ReasonRevoked", r.is_expired AS "IsExpired", r.is_revoked AS "IsRevoked", r.is_active AS "IsActive"
FROM refresh_token AS r
WHERE r.user_id = @__id_0
2022-09-23 14:53:28.225 +01:00 [DBG] A data reader was disposed.
2022-09-23 14:53:28.254 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 14:53:28.256 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 14:53:28.257 +01:00 [INF] Executed action APIBank.Controllers.UsersController.GetRefreshTokens (APIBank) in 585.1804ms
2022-09-23 14:53:28.258 +01:00 [INF] Executed endpoint 'APIBank.Controllers.UsersController.GetRefreshTokens (APIBank)'
2022-09-23 14:53:28.259 +01:00 [DBG] 'PostgresContext' disposed.
2022-09-23 14:53:28.266 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/api/Users/1/refresh-tokens - - - 200 - application/json;+charset=utf-8 705.2091ms
2022-09-23 14:53:49.026 +01:00 [INF] Request starting HTTP/2 POST https://localhost:7036/api/Users/refreshToken - 0
2022-09-23 14:53:49.051 +01:00 [DBG] 1 candidate(s) found for the request path '/api/Users/refreshToken'
2022-09-23 14:53:49.068 +01:00 [DBG] Endpoint 'APIBank.Controllers.UsersController.RefreshToken (APIBank)' with route pattern 'api/Users/refreshToken' is valid for the request path '/api/Users/refreshToken'
2022-09-23 14:53:49.070 +01:00 [DBG] Request matched endpoint 'APIBank.Controllers.UsersController.RefreshToken (APIBank)'
2022-09-23 14:53:49.072 +01:00 [DBG] Static files was skipped as the request already matched an endpoint.
2022-09-23 14:53:49.076 +01:00 [INF] Entity Framework Core 6.0.9 initialized 'PostgresContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:6.0.7+5b98e4b74de93b590b44aef8dd7967c03acc433c' with options: None
2022-09-23 14:53:49.085 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 14:53:49.086 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2022-09-23 14:53:49.087 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 14:53:49.089 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 14:53:49.090 +01:00 [DBG] Executing DbCommand [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.id = @__p_0
LIMIT 1
2022-09-23 14:53:49.092 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.id = @__p_0
LIMIT 1
2022-09-23 14:53:49.100 +01:00 [DBG] Context 'PostgresContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 14:53:49.104 +01:00 [DBG] A data reader was disposed.
2022-09-23 14:53:49.115 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 14:53:49.122 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 14:53:49.129 +01:00 [INF] Executing endpoint 'APIBank.Controllers.UsersController.RefreshToken (APIBank)'
2022-09-23 14:53:49.132 +01:00 [INF] Route matched with {action = "RefreshToken", controller = "Users"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult RefreshToken() on controller APIBank.Controllers.UsersController (APIBank).
2022-09-23 14:53:49.134 +01:00 [DBG] Execution plan of authorization filters (in the following order): ["APIBank.Authorization.AuthorizeAttribute"]
2022-09-23 14:53:49.136 +01:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2022-09-23 14:53:49.137 +01:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2022-09-23 14:53:49.139 +01:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2022-09-23 14:53:49.141 +01:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2022-09-23 14:53:49.144 +01:00 [DBG] Executing controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-23 14:53:49.146 +01:00 [DBG] Executed controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-23 14:53:49.149 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 14:53:49.151 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2022-09-23 14:53:49.153 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 14:53:49.163 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 14:53:49.172 +01:00 [DBG] Executing DbCommand [Parameters=[@__refToken_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE EXISTS (
    SELECT 1
    FROM refresh_token AS r
    WHERE (u.id = r.user_id) AND (r.token = @__refToken_0))
LIMIT 2
2022-09-23 14:53:49.230 +01:00 [INF] Executed DbCommand (59ms) [Parameters=[@__refToken_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE EXISTS (
    SELECT 1
    FROM refresh_token AS r
    WHERE (u.id = r.user_id) AND (r.token = @__refToken_0))
LIMIT 2
2022-09-23 14:53:49.241 +01:00 [DBG] A data reader was disposed.
2022-09-23 14:53:49.242 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 14:53:49.249 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 14:53:49.251 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 14:53:49.253 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2022-09-23 14:53:49.255 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 14:53:49.257 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 14:53:49.262 +01:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.user_id AS "UserId", r.token AS "RefToken", r.expires AS "Expires", r.created AS "Created", r.created_by_ip AS "CreatedByIp", r.revoked AS "Revoked", r.revoked_by_ip AS "RevokedByIp", r.replaced_by_token AS "ReplacedByToken", r.reason_revoked AS "ReasonRevoked", r.is_expired AS "IsExpired", r.is_revoked AS "IsRevoked", r.is_active AS "IsActive"
FROM refresh_token AS r
WHERE r.user_id = @__id_0
2022-09-23 14:53:49.285 +01:00 [INF] Executed DbCommand (23ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.user_id AS "UserId", r.token AS "RefToken", r.expires AS "Expires", r.created AS "Created", r.created_by_ip AS "CreatedByIp", r.revoked AS "Revoked", r.revoked_by_ip AS "RevokedByIp", r.replaced_by_token AS "ReplacedByToken", r.reason_revoked AS "ReasonRevoked", r.is_expired AS "IsExpired", r.is_revoked AS "IsRevoked", r.is_active AS "IsActive"
FROM refresh_token AS r
WHERE r.user_id = @__id_0
2022-09-23 14:53:49.322 +01:00 [DBG] A data reader was disposed.
2022-09-23 14:53:49.326 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 14:53:49.337 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 14:53:49.344 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 14:53:49.346 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (2ms).
2022-09-23 14:53:49.356 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 14:53:49.358 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 14:53:49.364 +01:00 [DBG] Executing DbCommand [Parameters=[@__token_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM users AS u
    WHERE EXISTS (
        SELECT 1
        FROM refresh_token AS r
        WHERE (u.id = r.user_id) AND (r.token = @__token_0)))
2022-09-23 14:53:49.418 +01:00 [INF] Executed DbCommand (54ms) [Parameters=[@__token_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM users AS u
    WHERE EXISTS (
        SELECT 1
        FROM refresh_token AS r
        WHERE (u.id = r.user_id) AND (r.token = @__token_0)))
2022-09-23 14:53:49.424 +01:00 [DBG] A data reader was disposed.
2022-09-23 14:53:49.427 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 14:53:49.440 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 14:53:49.444 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 14:53:49.448 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (4ms).
2022-09-23 14:53:49.451 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 14:53:49.455 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 14:53:49.456 +01:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.user_id AS "UserId", r.token AS "RefToken", r.expires AS "Expires", r.created AS "Created", r.created_by_ip AS "CreatedByIp", r.revoked AS "Revoked", r.revoked_by_ip AS "RevokedByIp", r.replaced_by_token AS "ReplacedByToken", r.reason_revoked AS "ReasonRevoked", r.is_expired AS "IsExpired", r.is_revoked AS "IsRevoked", r.is_active AS "IsActive"
FROM refresh_token AS r
WHERE r.user_id = @__id_0
2022-09-23 14:53:49.463 +01:00 [INF] Executed DbCommand (6ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.user_id AS "UserId", r.token AS "RefToken", r.expires AS "Expires", r.created AS "Created", r.created_by_ip AS "CreatedByIp", r.revoked AS "Revoked", r.revoked_by_ip AS "RevokedByIp", r.replaced_by_token AS "ReplacedByToken", r.reason_revoked AS "ReasonRevoked", r.is_expired AS "IsExpired", r.is_revoked AS "IsRevoked", r.is_active AS "IsActive"
FROM refresh_token AS r
WHERE r.user_id = @__id_0
2022-09-23 14:53:49.474 +01:00 [DBG] A data reader was disposed.
2022-09-23 14:53:49.489 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 14:53:49.500 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 14:53:49.502 +01:00 [DBG] An entity of type 'User' tracked by 'PostgresContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 14:53:49.505 +01:00 [DBG] SaveChanges starting for 'PostgresContext'.
2022-09-23 14:53:49.508 +01:00 [DBG] DetectChanges starting for 'PostgresContext'.
2022-09-23 14:53:49.512 +01:00 [DBG] 1 entities were added and 0 entities were removed from navigation 'User.RefreshTokenCollection'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 14:53:49.516 +01:00 [DBG] 'PostgresContext' generated a temporary value for the property 'Id.RefreshToken'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 14:53:49.518 +01:00 [DBG] Context 'PostgresContext' started tracking 'RefreshToken' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 14:53:49.520 +01:00 [DBG] DetectChanges completed for 'PostgresContext'.
2022-09-23 14:53:49.524 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 14:53:49.527 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 14:53:49.529 +01:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2022-09-23 14:53:49.531 +01:00 [DBG] Began transaction with isolation level 'ReadCommitted'.
2022-09-23 14:53:49.534 +01:00 [DBG] Executing 2 update commands as a batch.
2022-09-23 14:53:49.549 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 14:53:49.556 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (7ms).
2022-09-23 14:53:49.558 +01:00 [DBG] Executing DbCommand [Parameters=[@p0='?' (DbType = DateTime), @p1='?', @p2='?' (DbType = DateTime), @p3='?' (DbType = Boolean), @p4='?' (DbType = Boolean), @p5='?' (DbType = Boolean), @p6='?', @p7='?', @p8='?', @p9='?' (DbType = DateTime), @p10='?', @p11='?' (DbType = Int32), @p18='?' (DbType = Int32), @p12='?' (DbType = DateTime), @p13='?', @p14='?', @p15='?' (DbType = DateTime), @p16='?', @p17='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO refresh_token (created, created_by_ip, expires, is_active, is_expired, is_revoked, reason_revoked, token, replaced_by_token, revoked, revoked_by_ip, user_id)
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11)
RETURNING id;
UPDATE users SET created_at = @p12, email = @p13, full_name = @p14, password_changed_at = @p15, password_hash = @p16, username = @p17
WHERE id = @p18;
2022-09-23 14:53:49.565 +01:00 [INF] Executed DbCommand (7ms) [Parameters=[@p0='?' (DbType = DateTime), @p1='?', @p2='?' (DbType = DateTime), @p3='?' (DbType = Boolean), @p4='?' (DbType = Boolean), @p5='?' (DbType = Boolean), @p6='?', @p7='?', @p8='?', @p9='?' (DbType = DateTime), @p10='?', @p11='?' (DbType = Int32), @p18='?' (DbType = Int32), @p12='?' (DbType = DateTime), @p13='?', @p14='?', @p15='?' (DbType = DateTime), @p16='?', @p17='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO refresh_token (created, created_by_ip, expires, is_active, is_expired, is_revoked, reason_revoked, token, replaced_by_token, revoked, revoked_by_ip, user_id)
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11)
RETURNING id;
UPDATE users SET created_at = @p12, email = @p13, full_name = @p14, password_changed_at = @p15, password_hash = @p16, username = @p17
WHERE id = @p18;
2022-09-23 14:53:49.572 +01:00 [DBG] The foreign key property 'RefreshToken.Id' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2022-09-23 14:53:49.574 +01:00 [DBG] A data reader was disposed.
2022-09-23 14:53:49.575 +01:00 [DBG] Committing transaction.
2022-09-23 14:53:49.579 +01:00 [DBG] Committed transaction.
2022-09-23 14:53:49.580 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 14:53:49.604 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 14:53:49.617 +01:00 [DBG] Disposing transaction.
2022-09-23 14:53:49.619 +01:00 [DBG] An entity of type 'RefreshToken' tracked by 'PostgresContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 14:53:49.621 +01:00 [DBG] An entity of type 'User' tracked by 'PostgresContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 14:53:49.624 +01:00 [DBG] SaveChanges completed for 'PostgresContext' with 2 entities written to the database.
2022-09-23 14:53:49.629 +01:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2022-09-23 14:53:49.638 +01:00 [DBG] Attempting to select an output formatter based on Accept header '["text/plain"]'.
2022-09-23 14:53:49.641 +01:00 [DBG] Could not find an output formatter based on content negotiation. Accepted types were (["text/plain"])
2022-09-23 14:53:49.648 +01:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2022-09-23 14:53:49.648 +01:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2022-09-23 14:53:49.649 +01:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2022-09-23 14:53:49.650 +01:00 [INF] Executing OkObjectResult, writing value of type 'APIBank.Models.MyRequestResponses.LoginResponse'.
2022-09-23 14:53:49.651 +01:00 [INF] Executed action APIBank.Controllers.UsersController.RefreshToken (APIBank) in 507.9653ms
2022-09-23 14:53:49.652 +01:00 [INF] Executed endpoint 'APIBank.Controllers.UsersController.RefreshToken (APIBank)'
2022-09-23 14:53:49.653 +01:00 [DBG] 'PostgresContext' disposed.
2022-09-23 14:53:49.655 +01:00 [INF] Request finished HTTP/2 POST https://localhost:7036/api/Users/refreshToken - 0 - 200 - application/json;+charset=utf-8 630.5818ms
2022-09-23 14:54:02.709 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/api/Users/1/refresh-tokens - -
2022-09-23 14:54:02.711 +01:00 [DBG] 1 candidate(s) found for the request path '/api/Users/1/refresh-tokens'
2022-09-23 14:54:02.719 +01:00 [DBG] Endpoint 'APIBank.Controllers.UsersController.GetRefreshTokens (APIBank)' with route pattern 'api/Users/{id}/refresh-tokens' is valid for the request path '/api/Users/1/refresh-tokens'
2022-09-23 14:54:02.722 +01:00 [DBG] Request matched endpoint 'APIBank.Controllers.UsersController.GetRefreshTokens (APIBank)'
2022-09-23 14:54:02.725 +01:00 [DBG] Static files was skipped as the request already matched an endpoint.
2022-09-23 14:54:02.727 +01:00 [INF] Entity Framework Core 6.0.9 initialized 'PostgresContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:6.0.7+5b98e4b74de93b590b44aef8dd7967c03acc433c' with options: None
2022-09-23 14:54:02.738 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 14:54:02.742 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (4ms).
2022-09-23 14:54:02.747 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 14:54:02.749 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 14:54:02.751 +01:00 [DBG] Executing DbCommand [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.id = @__p_0
LIMIT 1
2022-09-23 14:54:02.759 +01:00 [INF] Executed DbCommand (7ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.id = @__p_0
LIMIT 1
2022-09-23 14:54:02.778 +01:00 [DBG] Context 'PostgresContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 14:54:02.780 +01:00 [DBG] A data reader was disposed.
2022-09-23 14:54:02.781 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 14:54:02.784 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 14:54:02.787 +01:00 [INF] Executing endpoint 'APIBank.Controllers.UsersController.GetRefreshTokens (APIBank)'
2022-09-23 14:54:02.789 +01:00 [INF] Route matched with {action = "GetRefreshTokens", controller = "Users"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult GetRefreshTokens(Int32) on controller APIBank.Controllers.UsersController (APIBank).
2022-09-23 14:54:02.795 +01:00 [DBG] Execution plan of authorization filters (in the following order): ["APIBank.Authorization.AuthorizeAttribute"]
2022-09-23 14:54:02.796 +01:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2022-09-23 14:54:02.799 +01:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2022-09-23 14:54:02.802 +01:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2022-09-23 14:54:02.819 +01:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2022-09-23 14:54:02.828 +01:00 [DBG] Executing controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-23 14:54:02.831 +01:00 [DBG] Executed controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-23 14:54:02.837 +01:00 [DBG] Attempting to bind parameter 'id' of type 'System.Int32' ...
2022-09-23 14:54:02.841 +01:00 [DBG] Attempting to bind parameter 'id' of type 'System.Int32' using the name 'id' in request data ...
2022-09-23 14:54:02.843 +01:00 [DBG] Done attempting to bind parameter 'id' of type 'System.Int32'.
2022-09-23 14:54:02.844 +01:00 [DBG] Done attempting to bind parameter 'id' of type 'System.Int32'.
2022-09-23 14:54:02.845 +01:00 [DBG] Attempting to validate the bound parameter 'id' of type 'System.Int32' ...
2022-09-23 14:54:02.849 +01:00 [DBG] Done attempting to validate the bound parameter 'id' of type 'System.Int32'.
2022-09-23 14:54:02.857 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 14:54:02.858 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2022-09-23 14:54:02.860 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 14:54:02.863 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 14:54:02.873 +01:00 [DBG] Executing DbCommand [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id, r.created, r.created_by_ip, r.expires, r.is_active, r.is_expired, r.is_revoked, r.reason_revoked, r.token, r.replaced_by_token, r.revoked, r.revoked_by_ip, r.user_id
FROM refresh_token AS r
WHERE r.id = @__p_0
LIMIT 1
2022-09-23 14:54:02.956 +01:00 [INF] Executed DbCommand (83ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id, r.created, r.created_by_ip, r.expires, r.is_active, r.is_expired, r.is_revoked, r.reason_revoked, r.token, r.replaced_by_token, r.revoked, r.revoked_by_ip, r.user_id
FROM refresh_token AS r
WHERE r.id = @__p_0
LIMIT 1
2022-09-23 14:54:02.963 +01:00 [DBG] Context 'PostgresContext' started tracking 'RefreshToken' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 14:54:02.967 +01:00 [DBG] A data reader was disposed.
2022-09-23 14:54:02.970 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 14:54:02.971 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 14:54:03.044 +01:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2022-09-23 14:54:03.061 +01:00 [DBG] No information found on request to perform content negotiation.
2022-09-23 14:54:03.077 +01:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2022-09-23 14:54:03.086 +01:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2022-09-23 14:54:03.090 +01:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2022-09-23 14:54:03.092 +01:00 [INF] Executing OkObjectResult, writing value of type 'Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryable`1[[APIBank.ModelEntities.RefreshToken, APIBank, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2022-09-23 14:54:03.095 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 14:54:03.101 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (6ms).
2022-09-23 14:54:03.157 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 14:54:03.185 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 14:54:03.211 +01:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.user_id AS "UserId", r.token AS "RefToken", r.expires AS "Expires", r.created AS "Created", r.created_by_ip AS "CreatedByIp", r.revoked AS "Revoked", r.revoked_by_ip AS "RevokedByIp", r.replaced_by_token AS "ReplacedByToken", r.reason_revoked AS "ReasonRevoked", r.is_expired AS "IsExpired", r.is_revoked AS "IsRevoked", r.is_active AS "IsActive"
FROM refresh_token AS r
WHERE r.user_id = @__id_0
2022-09-23 14:54:03.376 +01:00 [INF] Executed DbCommand (165ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.user_id AS "UserId", r.token AS "RefToken", r.expires AS "Expires", r.created AS "Created", r.created_by_ip AS "CreatedByIp", r.revoked AS "Revoked", r.revoked_by_ip AS "RevokedByIp", r.replaced_by_token AS "ReplacedByToken", r.reason_revoked AS "ReasonRevoked", r.is_expired AS "IsExpired", r.is_revoked AS "IsRevoked", r.is_active AS "IsActive"
FROM refresh_token AS r
WHERE r.user_id = @__id_0
2022-09-23 14:54:03.439 +01:00 [DBG] A data reader was disposed.
2022-09-23 14:54:03.444 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 14:54:03.445 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 14:54:03.460 +01:00 [INF] Executed action APIBank.Controllers.UsersController.GetRefreshTokens (APIBank) in 632.39ms
2022-09-23 14:54:03.463 +01:00 [INF] Executed endpoint 'APIBank.Controllers.UsersController.GetRefreshTokens (APIBank)'
2022-09-23 14:54:03.503 +01:00 [DBG] 'PostgresContext' disposed.
2022-09-23 14:54:03.511 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/api/Users/1/refresh-tokens - - - 200 - application/json;+charset=utf-8 799.4366ms
2022-09-23 14:54:14.454 +01:00 [INF] Request starting HTTP/2 POST https://localhost:7036/api/Users/revoke-token application/json 20
2022-09-23 14:54:14.458 +01:00 [DBG] 1 candidate(s) found for the request path '/api/Users/revoke-token'
2022-09-23 14:54:14.460 +01:00 [DBG] Endpoint 'APIBank.Controllers.UsersController.RevokeToken (APIBank)' with route pattern 'api/Users/revoke-token' is valid for the request path '/api/Users/revoke-token'
2022-09-23 14:54:14.464 +01:00 [DBG] Request matched endpoint 'APIBank.Controllers.UsersController.RevokeToken (APIBank)'
2022-09-23 14:54:14.465 +01:00 [DBG] Static files was skipped as the request already matched an endpoint.
2022-09-23 14:54:14.470 +01:00 [INF] Entity Framework Core 6.0.9 initialized 'PostgresContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:6.0.7+5b98e4b74de93b590b44aef8dd7967c03acc433c' with options: None
2022-09-23 14:54:14.487 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 14:54:14.507 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (19ms).
2022-09-23 14:54:14.516 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 14:54:14.517 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 14:54:14.519 +01:00 [DBG] Executing DbCommand [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.id = @__p_0
LIMIT 1
2022-09-23 14:54:14.535 +01:00 [INF] Executed DbCommand (15ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.id = @__p_0
LIMIT 1
2022-09-23 14:54:14.569 +01:00 [DBG] Context 'PostgresContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 14:54:14.650 +01:00 [DBG] A data reader was disposed.
2022-09-23 14:54:14.652 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 14:54:14.684 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 14:54:14.686 +01:00 [INF] Executing endpoint 'APIBank.Controllers.UsersController.RevokeToken (APIBank)'
2022-09-23 14:54:14.697 +01:00 [INF] Route matched with {action = "RevokeToken", controller = "Users"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult RevokeToken(APIBank.Models.MyRequestResponses.UserRevokeTokenRequest) on controller APIBank.Controllers.UsersController (APIBank).
2022-09-23 14:54:14.734 +01:00 [DBG] Execution plan of authorization filters (in the following order): ["APIBank.Authorization.AuthorizeAttribute"]
2022-09-23 14:54:14.746 +01:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2022-09-23 14:54:14.767 +01:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2022-09-23 14:54:14.797 +01:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2022-09-23 14:54:14.800 +01:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2022-09-23 14:54:14.803 +01:00 [DBG] Executing controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-23 14:54:14.809 +01:00 [DBG] Executed controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-23 14:54:14.813 +01:00 [DBG] Attempting to bind parameter 'model' of type 'APIBank.Models.MyRequestResponses.UserRevokeTokenRequest' ...
2022-09-23 14:54:14.865 +01:00 [DBG] Attempting to bind parameter 'model' of type 'APIBank.Models.MyRequestResponses.UserRevokeTokenRequest' using the name '' in request data ...
2022-09-23 14:54:14.870 +01:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2022-09-23 14:54:14.875 +01:00 [DBG] Connection id "0HMKTD5E9APRC", Request id "0HMKTD5E9APRC:00000019": started reading request body.
2022-09-23 14:54:14.882 +01:00 [DBG] Connection id "0HMKTD5E9APRC", Request id "0HMKTD5E9APRC:00000019": done reading request body.
2022-09-23 14:54:14.885 +01:00 [DBG] JSON input formatter succeeded, deserializing to type 'APIBank.Models.MyRequestResponses.UserRevokeTokenRequest'
2022-09-23 14:54:14.886 +01:00 [DBG] Done attempting to bind parameter 'model' of type 'APIBank.Models.MyRequestResponses.UserRevokeTokenRequest'.
2022-09-23 14:54:14.888 +01:00 [DBG] Done attempting to bind parameter 'model' of type 'APIBank.Models.MyRequestResponses.UserRevokeTokenRequest'.
2022-09-23 14:54:14.889 +01:00 [DBG] Attempting to validate the bound parameter 'model' of type 'APIBank.Models.MyRequestResponses.UserRevokeTokenRequest' ...
2022-09-23 14:54:14.916 +01:00 [DBG] Done attempting to validate the bound parameter 'model' of type 'APIBank.Models.MyRequestResponses.UserRevokeTokenRequest'.
2022-09-23 14:54:14.919 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 14:54:14.924 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (4ms).
2022-09-23 14:54:14.926 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 14:54:14.927 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 14:54:14.929 +01:00 [DBG] Executing DbCommand [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id, r.created, r.created_by_ip, r.expires, r.is_active, r.is_expired, r.is_revoked, r.reason_revoked, r.token, r.replaced_by_token, r.revoked, r.revoked_by_ip, r.user_id
FROM refresh_token AS r
WHERE r.id = @__p_0
LIMIT 1
2022-09-23 14:54:14.932 +01:00 [INF] Executed DbCommand (3ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id, r.created, r.created_by_ip, r.expires, r.is_active, r.is_expired, r.is_revoked, r.reason_revoked, r.token, r.replaced_by_token, r.revoked, r.revoked_by_ip, r.user_id
FROM refresh_token AS r
WHERE r.id = @__p_0
LIMIT 1
2022-09-23 14:54:14.934 +01:00 [DBG] Context 'PostgresContext' started tracking 'RefreshToken' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 14:54:14.935 +01:00 [DBG] A data reader was disposed.
2022-09-23 14:54:14.936 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 14:54:14.945 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 14:54:25.251 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 14:54:25.254 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (2ms).
2022-09-23 14:54:25.256 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 14:54:25.260 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 14:54:25.261 +01:00 [DBG] Executing DbCommand [Parameters=[@__refToken_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE EXISTS (
    SELECT 1
    FROM refresh_token AS r
    WHERE (u.id = r.user_id) AND (r.token = @__refToken_0))
LIMIT 2
2022-09-23 14:54:25.264 +01:00 [INF] Executed DbCommand (3ms) [Parameters=[@__refToken_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE EXISTS (
    SELECT 1
    FROM refresh_token AS r
    WHERE (u.id = r.user_id) AND (r.token = @__refToken_0))
LIMIT 2
2022-09-23 14:54:25.267 +01:00 [DBG] A data reader was disposed.
2022-09-23 14:54:25.268 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 14:54:25.269 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 14:54:25.270 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 14:54:25.273 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (2ms).
2022-09-23 14:54:25.275 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 14:54:25.276 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 14:54:25.277 +01:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.user_id AS "UserId", r.token AS "RefToken", r.expires AS "Expires", r.created AS "Created", r.created_by_ip AS "CreatedByIp", r.revoked AS "Revoked", r.revoked_by_ip AS "RevokedByIp", r.replaced_by_token AS "ReplacedByToken", r.reason_revoked AS "ReasonRevoked", r.is_expired AS "IsExpired", r.is_revoked AS "IsRevoked", r.is_active AS "IsActive"
FROM refresh_token AS r
WHERE r.user_id = @__id_0
2022-09-23 14:54:25.280 +01:00 [INF] Executed DbCommand (3ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.user_id AS "UserId", r.token AS "RefToken", r.expires AS "Expires", r.created AS "Created", r.created_by_ip AS "CreatedByIp", r.revoked AS "Revoked", r.revoked_by_ip AS "RevokedByIp", r.replaced_by_token AS "ReplacedByToken", r.reason_revoked AS "ReasonRevoked", r.is_expired AS "IsExpired", r.is_revoked AS "IsRevoked", r.is_active AS "IsActive"
FROM refresh_token AS r
WHERE r.user_id = @__id_0
2022-09-23 14:54:25.285 +01:00 [DBG] A data reader was disposed.
2022-09-23 14:54:25.296 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 14:54:25.305 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 14:54:25.307 +01:00 [DBG] An entity of type 'User' tracked by 'PostgresContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 14:54:25.309 +01:00 [DBG] SaveChanges starting for 'PostgresContext'.
2022-09-23 14:54:25.310 +01:00 [DBG] DetectChanges starting for 'PostgresContext'.
2022-09-23 14:54:25.311 +01:00 [DBG] The unchanged property 'RefreshToken.IsActive' was detected as changed and will be marked as modified. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2022-09-23 14:54:25.312 +01:00 [DBG] An entity of type 'RefreshToken' tracked by 'PostgresContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 14:54:25.319 +01:00 [DBG] The unchanged property 'RefreshToken.IsRevoked' was detected as changed and will be marked as modified. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2022-09-23 14:54:25.322 +01:00 [DBG] The unchanged property 'RefreshToken.ReasonRevoked' was detected as changed and will be marked as modified. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2022-09-23 14:54:25.324 +01:00 [DBG] The unchanged property 'RefreshToken.Revoked' was detected as changed and will be marked as modified. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2022-09-23 14:54:25.325 +01:00 [DBG] The unchanged property 'RefreshToken.RevokedByIp' was detected as changed and will be marked as modified. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2022-09-23 14:54:25.326 +01:00 [DBG] DetectChanges completed for 'PostgresContext'.
2022-09-23 14:54:25.327 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 14:54:25.329 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 14:54:25.330 +01:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2022-09-23 14:54:25.331 +01:00 [DBG] Began transaction with isolation level 'ReadCommitted'.
2022-09-23 14:54:25.335 +01:00 [DBG] Executing 2 update commands as a batch.
2022-09-23 14:54:25.348 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 14:54:25.352 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (3ms).
2022-09-23 14:54:25.354 +01:00 [DBG] Executing DbCommand [Parameters=[@p5='?' (DbType = Int32), @p0='?' (DbType = Boolean), @p1='?' (DbType = Boolean), @p2='?', @p3='?' (DbType = DateTime), @p4='?', @p12='?' (DbType = Int32), @p6='?' (DbType = DateTime), @p7='?', @p8='?', @p9='?' (DbType = DateTime), @p10='?', @p11='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE refresh_token SET is_active = @p0, is_revoked = @p1, reason_revoked = @p2, revoked = @p3, revoked_by_ip = @p4
WHERE id = @p5;
UPDATE users SET created_at = @p6, email = @p7, full_name = @p8, password_changed_at = @p9, password_hash = @p10, username = @p11
WHERE id = @p12;
2022-09-23 14:54:25.358 +01:00 [INF] Executed DbCommand (4ms) [Parameters=[@p5='?' (DbType = Int32), @p0='?' (DbType = Boolean), @p1='?' (DbType = Boolean), @p2='?', @p3='?' (DbType = DateTime), @p4='?', @p12='?' (DbType = Int32), @p6='?' (DbType = DateTime), @p7='?', @p8='?', @p9='?' (DbType = DateTime), @p10='?', @p11='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE refresh_token SET is_active = @p0, is_revoked = @p1, reason_revoked = @p2, revoked = @p3, revoked_by_ip = @p4
WHERE id = @p5;
UPDATE users SET created_at = @p6, email = @p7, full_name = @p8, password_changed_at = @p9, password_hash = @p10, username = @p11
WHERE id = @p12;
2022-09-23 14:54:25.361 +01:00 [DBG] A data reader was disposed.
2022-09-23 14:54:25.364 +01:00 [DBG] Committing transaction.
2022-09-23 14:54:25.367 +01:00 [DBG] Committed transaction.
2022-09-23 14:54:25.368 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 14:54:25.369 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 14:54:25.371 +01:00 [DBG] Disposing transaction.
2022-09-23 14:54:25.372 +01:00 [DBG] An entity of type 'User' tracked by 'PostgresContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 14:54:25.374 +01:00 [DBG] An entity of type 'RefreshToken' tracked by 'PostgresContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 14:54:25.376 +01:00 [DBG] SaveChanges completed for 'PostgresContext' with 2 entities written to the database.
2022-09-23 14:54:25.377 +01:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2022-09-23 14:54:25.379 +01:00 [DBG] No information found on request to perform content negotiation.
2022-09-23 14:54:25.384 +01:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2022-09-23 14:54:25.390 +01:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2022-09-23 14:54:25.393 +01:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2022-09-23 14:54:25.400 +01:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType0`1[[System.String, System.Private.CoreLib, Version=6.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2022-09-23 14:54:25.403 +01:00 [INF] Executed action APIBank.Controllers.UsersController.RevokeToken (APIBank) in 10599.9512ms
2022-09-23 14:54:25.405 +01:00 [INF] Executed endpoint 'APIBank.Controllers.UsersController.RevokeToken (APIBank)'
2022-09-23 14:54:25.406 +01:00 [DBG] 'PostgresContext' disposed.
2022-09-23 14:54:25.408 +01:00 [INF] Request finished HTTP/2 POST https://localhost:7036/api/Users/revoke-token application/json 20 - 200 - application/json;+charset=utf-8 10953.3741ms
2022-09-23 14:54:30.966 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/api/Users/1/refresh-tokens - -
2022-09-23 14:54:30.969 +01:00 [DBG] 1 candidate(s) found for the request path '/api/Users/1/refresh-tokens'
2022-09-23 14:54:30.977 +01:00 [DBG] Endpoint 'APIBank.Controllers.UsersController.GetRefreshTokens (APIBank)' with route pattern 'api/Users/{id}/refresh-tokens' is valid for the request path '/api/Users/1/refresh-tokens'
2022-09-23 14:54:30.982 +01:00 [DBG] Request matched endpoint 'APIBank.Controllers.UsersController.GetRefreshTokens (APIBank)'
2022-09-23 14:54:30.983 +01:00 [DBG] Static files was skipped as the request already matched an endpoint.
2022-09-23 14:54:30.986 +01:00 [INF] Entity Framework Core 6.0.9 initialized 'PostgresContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:6.0.7+5b98e4b74de93b590b44aef8dd7967c03acc433c' with options: None
2022-09-23 14:54:30.989 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 14:54:30.993 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (3ms).
2022-09-23 14:54:30.995 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 14:54:30.997 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 14:54:30.999 +01:00 [DBG] Executing DbCommand [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.id = @__p_0
LIMIT 1
2022-09-23 14:54:31.038 +01:00 [INF] Executed DbCommand (40ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.id = @__p_0
LIMIT 1
2022-09-23 14:54:31.042 +01:00 [DBG] Context 'PostgresContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 14:54:31.044 +01:00 [DBG] A data reader was disposed.
2022-09-23 14:54:31.046 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 14:54:31.049 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 14:54:31.051 +01:00 [INF] Executing endpoint 'APIBank.Controllers.UsersController.GetRefreshTokens (APIBank)'
2022-09-23 14:54:31.052 +01:00 [INF] Route matched with {action = "GetRefreshTokens", controller = "Users"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult GetRefreshTokens(Int32) on controller APIBank.Controllers.UsersController (APIBank).
2022-09-23 14:54:31.055 +01:00 [DBG] Execution plan of authorization filters (in the following order): ["APIBank.Authorization.AuthorizeAttribute"]
2022-09-23 14:54:31.056 +01:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2022-09-23 14:54:31.059 +01:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2022-09-23 14:54:31.062 +01:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2022-09-23 14:54:31.080 +01:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2022-09-23 14:54:31.090 +01:00 [DBG] Executing controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-23 14:54:31.097 +01:00 [DBG] Executed controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-23 14:54:31.115 +01:00 [DBG] Attempting to bind parameter 'id' of type 'System.Int32' ...
2022-09-23 14:54:31.119 +01:00 [DBG] Attempting to bind parameter 'id' of type 'System.Int32' using the name 'id' in request data ...
2022-09-23 14:54:31.122 +01:00 [DBG] Done attempting to bind parameter 'id' of type 'System.Int32'.
2022-09-23 14:54:31.126 +01:00 [DBG] Done attempting to bind parameter 'id' of type 'System.Int32'.
2022-09-23 14:54:31.134 +01:00 [DBG] Attempting to validate the bound parameter 'id' of type 'System.Int32' ...
2022-09-23 14:54:31.136 +01:00 [DBG] Done attempting to validate the bound parameter 'id' of type 'System.Int32'.
2022-09-23 14:54:31.143 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 14:54:31.155 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (12ms).
2022-09-23 14:54:31.166 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 14:54:31.170 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 14:54:31.187 +01:00 [DBG] Executing DbCommand [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id, r.created, r.created_by_ip, r.expires, r.is_active, r.is_expired, r.is_revoked, r.reason_revoked, r.token, r.replaced_by_token, r.revoked, r.revoked_by_ip, r.user_id
FROM refresh_token AS r
WHERE r.id = @__p_0
LIMIT 1
2022-09-23 14:54:31.221 +01:00 [INF] Executed DbCommand (34ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id, r.created, r.created_by_ip, r.expires, r.is_active, r.is_expired, r.is_revoked, r.reason_revoked, r.token, r.replaced_by_token, r.revoked, r.revoked_by_ip, r.user_id
FROM refresh_token AS r
WHERE r.id = @__p_0
LIMIT 1
2022-09-23 14:54:31.248 +01:00 [DBG] Context 'PostgresContext' started tracking 'RefreshToken' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 14:54:31.251 +01:00 [DBG] A data reader was disposed.
2022-09-23 14:54:31.252 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 14:54:31.253 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 14:54:31.254 +01:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2022-09-23 14:54:31.256 +01:00 [DBG] No information found on request to perform content negotiation.
2022-09-23 14:54:31.258 +01:00 [DBG] Attempting to select the first output formatter in the output formatters list which supports a content type from the explicitly specified content types '["application/problem+json","application/problem+xml","application/problem+json","application/problem+xml"]'.
2022-09-23 14:54:31.262 +01:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/problem+json' to write the response.
2022-09-23 14:54:31.273 +01:00 [INF] Executing ObjectResult, writing value of type 'Microsoft.AspNetCore.Mvc.ProblemDetails'.
2022-09-23 14:54:31.295 +01:00 [INF] Executed action APIBank.Controllers.UsersController.GetRefreshTokens (APIBank) in 205.4571ms
2022-09-23 14:54:31.302 +01:00 [INF] Executed endpoint 'APIBank.Controllers.UsersController.GetRefreshTokens (APIBank)'
2022-09-23 14:54:31.338 +01:00 [DBG] 'PostgresContext' disposed.
2022-09-23 14:54:31.347 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/api/Users/1/refresh-tokens - - - 401 - application/problem+json;+charset=utf-8 380.5608ms
2022-09-23 15:01:07.671 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/swagger/index.html - -
2022-09-23 15:01:07.692 +01:00 [DBG] No candidates found for the request path '/swagger/index.html'
2022-09-23 15:01:07.697 +01:00 [DBG] Request did not match any endpoints
2022-09-23 15:01:07.716 +01:00 [DBG] Response markup is scheduled to include browser refresh script injection.
2022-09-23 15:01:07.765 +01:00 [DBG] Response markup was updated to include browser refresh script injection.
2022-09-23 15:01:07.786 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/swagger/index.html - - - 200 - text/html;charset=utf-8 114.5228ms
2022-09-23 15:01:07.813 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/_vs/browserLink - -
2022-09-23 15:01:07.826 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/_framework/aspnetcore-browser-refresh.js - -
2022-09-23 15:01:07.831 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/_framework/aspnetcore-browser-refresh.js - - - 200 11984 application/javascript;+charset=utf-8 7.7316ms
2022-09-23 15:01:07.871 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/_vs/browserLink - - - 200 - text/javascript;+charset=UTF-8 57.8255ms
2022-09-23 15:01:08.279 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/swagger/v1/swagger.json - -
2022-09-23 15:01:08.280 +01:00 [DBG] No candidates found for the request path '/swagger/v1/swagger.json'
2022-09-23 15:01:08.281 +01:00 [DBG] Request did not match any endpoints
2022-09-23 15:01:08.321 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/swagger/v1/swagger.json - - - 200 - application/json;charset=utf-8 42.5955ms
2022-09-23 15:05:01.509 +01:00 [INF] Request starting HTTP/2 POST https://localhost:7036/api/Users/Login application/json 58
2022-09-23 15:05:01.542 +01:00 [DBG] 1 candidate(s) found for the request path '/api/Users/Login'
2022-09-23 15:05:01.554 +01:00 [DBG] Endpoint 'APIBank.Controllers.UsersController.Login (APIBank)' with route pattern 'api/Users/Login' is valid for the request path '/api/Users/Login'
2022-09-23 15:05:01.588 +01:00 [DBG] Request matched endpoint 'APIBank.Controllers.UsersController.Login (APIBank)'
2022-09-23 15:05:01.600 +01:00 [DBG] Static files was skipped as the request already matched an endpoint.
2022-09-23 15:05:01.628 +01:00 [INF] Executing endpoint 'APIBank.Controllers.UsersController.Login (APIBank)'
2022-09-23 15:05:01.633 +01:00 [INF] Route matched with {action = "Login", controller = "Users"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult Login(APIBank.Models.Requests.UserLoginRequest) on controller APIBank.Controllers.UsersController (APIBank).
2022-09-23 15:05:01.643 +01:00 [DBG] Execution plan of authorization filters (in the following order): ["APIBank.Authorization.AuthorizeAttribute"]
2022-09-23 15:05:01.664 +01:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2022-09-23 15:05:01.684 +01:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2022-09-23 15:05:01.737 +01:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2022-09-23 15:05:01.776 +01:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2022-09-23 15:05:01.832 +01:00 [DBG] Executing controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-23 15:05:01.836 +01:00 [DBG] Executed controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-23 15:05:01.875 +01:00 [DBG] Attempting to bind parameter 'model' of type 'APIBank.Models.Requests.UserLoginRequest' ...
2022-09-23 15:05:01.883 +01:00 [DBG] Attempting to bind parameter 'model' of type 'APIBank.Models.Requests.UserLoginRequest' using the name '' in request data ...
2022-09-23 15:05:01.900 +01:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2022-09-23 15:05:01.910 +01:00 [DBG] Connection id "0HMKTD5E9APRC", Request id "0HMKTD5E9APRC:00000025": started reading request body.
2022-09-23 15:05:01.911 +01:00 [DBG] Connection id "0HMKTD5E9APRC", Request id "0HMKTD5E9APRC:00000025": done reading request body.
2022-09-23 15:05:01.913 +01:00 [DBG] JSON input formatter succeeded, deserializing to type 'APIBank.Models.Requests.UserLoginRequest'
2022-09-23 15:05:01.914 +01:00 [DBG] Done attempting to bind parameter 'model' of type 'APIBank.Models.Requests.UserLoginRequest'.
2022-09-23 15:05:01.919 +01:00 [DBG] Done attempting to bind parameter 'model' of type 'APIBank.Models.Requests.UserLoginRequest'.
2022-09-23 15:05:01.921 +01:00 [DBG] Attempting to validate the bound parameter 'model' of type 'APIBank.Models.Requests.UserLoginRequest' ...
2022-09-23 15:05:01.927 +01:00 [DBG] Done attempting to validate the bound parameter 'model' of type 'APIBank.Models.Requests.UserLoginRequest'.
2022-09-23 15:05:01.946 +01:00 [INF] Entity Framework Core 6.0.9 initialized 'PostgresContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:6.0.7+5b98e4b74de93b590b44aef8dd7967c03acc433c' with options: None
2022-09-23 15:05:01.952 +01:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .SingleOrDefault(x => x.Username == __model_Username_0)'
2022-09-23 15:05:01.963 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<User>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: User.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: User.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 1], [Property: User.Email (string) Required Index MaxLength(254), 2], [Property: User.FullName (string) Required MaxLength(100), 3], [Property: User.PasswordChangedAt (DateTime) Required ValueGenerated.OnAdd, 4], [Property: User.PasswordHash (string) Required MaxLength(200), 5], [Property: User.Username (string) Required Index MaxLength(50), 6] }
        SELECT TOP(2) u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
        FROM users AS u
        WHERE u.username == @__model_Username_0), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, User>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)
    .SingleOrDefault()'
2022-09-23 15:05:01.973 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 15:05:01.974 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2022-09-23 15:05:02.005 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 15:05:02.294 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:05:02.297 +01:00 [DBG] Executing DbCommand [Parameters=[@__model_Username_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.username = @__model_Username_0
LIMIT 2
2022-09-23 15:05:02.309 +01:00 [INF] Executed DbCommand (11ms) [Parameters=[@__model_Username_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.username = @__model_Username_0
LIMIT 2
2022-09-23 15:05:02.327 +01:00 [DBG] Context 'PostgresContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 15:05:02.330 +01:00 [DBG] A data reader was disposed.
2022-09-23 15:05:02.332 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:05:02.335 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 15:05:02.695 +01:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .Any(user => user.RefreshTokenCollection
        .Any(reftoken => reftoken.RefToken == __token_0))'
2022-09-23 15:05:02.706 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<bool>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            EmptyProjectionMember -> 0
        SELECT EXISTS (
            SELECT 1
            FROM users AS u
            WHERE EXISTS (
                SELECT 1
                FROM refresh_token AS r
                WHERE ((u.id != NULL) && (u.id == r.user_id)) && (r.token == @__token_0)))), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, bool>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)
    .Single()'
2022-09-23 15:05:02.709 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 15:05:02.710 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2022-09-23 15:05:02.712 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 15:05:02.717 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:05:02.719 +01:00 [DBG] Executing DbCommand [Parameters=[@__token_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM users AS u
    WHERE EXISTS (
        SELECT 1
        FROM refresh_token AS r
        WHERE (u.id = r.user_id) AND (r.token = @__token_0)))
2022-09-23 15:05:02.725 +01:00 [INF] Executed DbCommand (6ms) [Parameters=[@__token_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM users AS u
    WHERE EXISTS (
        SELECT 1
        FROM refresh_token AS r
        WHERE (u.id = r.user_id) AND (r.token = @__token_0)))
2022-09-23 15:05:02.728 +01:00 [DBG] A data reader was disposed.
2022-09-23 15:05:02.729 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:05:02.732 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 15:05:02.736 +01:00 [DBG] SaveChanges starting for 'PostgresContext'.
2022-09-23 15:05:02.739 +01:00 [DBG] DetectChanges starting for 'PostgresContext'.
2022-09-23 15:05:02.743 +01:00 [DBG] 1 entities were added and 0 entities were removed from navigation 'User.RefreshTokenCollection'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 15:05:02.762 +01:00 [DBG] 'PostgresContext' generated a temporary value for the property 'Id.RefreshToken'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 15:05:02.767 +01:00 [DBG] Context 'PostgresContext' started tracking 'RefreshToken' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 15:05:02.770 +01:00 [DBG] DetectChanges completed for 'PostgresContext'.
2022-09-23 15:05:02.772 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 15:05:02.773 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:05:02.775 +01:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2022-09-23 15:05:02.778 +01:00 [DBG] Began transaction with isolation level 'ReadCommitted'.
2022-09-23 15:05:02.780 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 15:05:02.781 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2022-09-23 15:05:02.783 +01:00 [DBG] Executing DbCommand [Parameters=[@p0='?' (DbType = DateTime), @p1='?', @p2='?' (DbType = DateTime), @p3='?' (DbType = Boolean), @p4='?' (DbType = Boolean), @p5='?' (DbType = Boolean), @p6='?', @p7='?', @p8='?', @p9='?' (DbType = DateTime), @p10='?', @p11='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO refresh_token (created, created_by_ip, expires, is_active, is_expired, is_revoked, reason_revoked, token, replaced_by_token, revoked, revoked_by_ip, user_id)
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11)
RETURNING id;
2022-09-23 15:05:02.788 +01:00 [INF] Executed DbCommand (6ms) [Parameters=[@p0='?' (DbType = DateTime), @p1='?', @p2='?' (DbType = DateTime), @p3='?' (DbType = Boolean), @p4='?' (DbType = Boolean), @p5='?' (DbType = Boolean), @p6='?', @p7='?', @p8='?', @p9='?' (DbType = DateTime), @p10='?', @p11='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO refresh_token (created, created_by_ip, expires, is_active, is_expired, is_revoked, reason_revoked, token, replaced_by_token, revoked, revoked_by_ip, user_id)
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11)
RETURNING id;
2022-09-23 15:05:02.794 +01:00 [DBG] The foreign key property 'RefreshToken.Id' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2022-09-23 15:05:02.796 +01:00 [DBG] A data reader was disposed.
2022-09-23 15:05:02.797 +01:00 [DBG] Committing transaction.
2022-09-23 15:05:02.800 +01:00 [DBG] Committed transaction.
2022-09-23 15:05:02.802 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:05:02.804 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 15:05:02.805 +01:00 [DBG] Disposing transaction.
2022-09-23 15:05:02.838 +01:00 [DBG] An entity of type 'RefreshToken' tracked by 'PostgresContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 15:05:02.841 +01:00 [DBG] SaveChanges completed for 'PostgresContext' with 1 entities written to the database.
2022-09-23 15:05:02.843 +01:00 [DBG] Compiling query expression: 
'DbSet<RefreshToken>()
    .Where(rt => rt.UserId == __id_0)
    .AsNoTracking()
    .Select(rt => new RefreshToken{ 
        Id = rt.Id, 
        UserId = rt.UserId, 
        RefToken = rt.RefToken, 
        Expires = rt.Expires, 
        Created = rt.Created, 
        CreatedByIp = rt.CreatedByIp, 
        Revoked = rt.Revoked, 
        RevokedByIp = rt.RevokedByIp, 
        ReplacedByToken = rt.ReplacedByToken, 
        ReasonRevoked = rt.ReasonRevoked, 
        IsExpired = rt.IsExpired, 
        IsRevoked = rt.IsRevoked, 
        IsActive = rt.IsActive 
    }
    )'
2022-09-23 15:05:02.852 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<RefreshToken>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            Id -> 0
            UserId -> 1
            RefToken -> 2
            Expires -> 3
            Created -> 4
            CreatedByIp -> 5
            Revoked -> 6
            RevokedByIp -> 7
            ReplacedByToken -> 8
            ReasonRevoked -> 9
            IsExpired -> 10
            IsRevoked -> 11
            IsActive -> 12
        SELECT r.id AS Id, r.user_id AS UserId, r.token AS RefToken, r.expires AS Expires, r.created AS Created, r.created_by_ip AS CreatedByIp, r.revoked AS Revoked, r.revoked_by_ip AS RevokedByIp, r.replaced_by_token AS ReplacedByToken, r.reason_revoked AS ReasonRevoked, r.is_expired AS IsExpired, r.is_revoked AS IsRevoked, r.is_active AS IsActive
        FROM refresh_token AS r
        WHERE r.user_id == @__id_0), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, RefreshToken>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)'
2022-09-23 15:05:02.862 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 15:05:02.864 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2022-09-23 15:05:02.866 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 15:05:02.878 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:05:02.881 +01:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.user_id AS "UserId", r.token AS "RefToken", r.expires AS "Expires", r.created AS "Created", r.created_by_ip AS "CreatedByIp", r.revoked AS "Revoked", r.revoked_by_ip AS "RevokedByIp", r.replaced_by_token AS "ReplacedByToken", r.reason_revoked AS "ReasonRevoked", r.is_expired AS "IsExpired", r.is_revoked AS "IsRevoked", r.is_active AS "IsActive"
FROM refresh_token AS r
WHERE r.user_id = @__id_0
2022-09-23 15:05:02.901 +01:00 [INF] Executed DbCommand (19ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.user_id AS "UserId", r.token AS "RefToken", r.expires AS "Expires", r.created AS "Created", r.created_by_ip AS "CreatedByIp", r.revoked AS "Revoked", r.revoked_by_ip AS "RevokedByIp", r.replaced_by_token AS "ReplacedByToken", r.reason_revoked AS "ReasonRevoked", r.is_expired AS "IsExpired", r.is_revoked AS "IsRevoked", r.is_active AS "IsActive"
FROM refresh_token AS r
WHERE r.user_id = @__id_0
2022-09-23 15:05:02.919 +01:00 [DBG] A data reader was disposed.
2022-09-23 15:05:02.922 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:05:02.925 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 15:05:02.926 +01:00 [DBG] An entity of type 'User' tracked by 'PostgresContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 15:05:02.929 +01:00 [DBG] An entity of type 'RefreshToken' tracked by 'PostgresContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 15:05:02.938 +01:00 [DBG] SaveChanges starting for 'PostgresContext'.
2022-09-23 15:05:02.941 +01:00 [DBG] DetectChanges starting for 'PostgresContext'.
2022-09-23 15:05:02.947 +01:00 [DBG] DetectChanges completed for 'PostgresContext'.
2022-09-23 15:05:02.949 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 15:05:02.953 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:05:02.955 +01:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2022-09-23 15:05:02.960 +01:00 [DBG] Began transaction with isolation level 'ReadCommitted'.
2022-09-23 15:05:02.981 +01:00 [DBG] Executing 2 update commands as a batch.
2022-09-23 15:05:02.983 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 15:05:02.985 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (2ms).
2022-09-23 15:05:02.990 +01:00 [DBG] Executing DbCommand [Parameters=[@p12='?' (DbType = Int32), @p0='?' (DbType = DateTime), @p1='?', @p2='?' (DbType = DateTime), @p3='?' (DbType = Boolean), @p4='?' (DbType = Boolean), @p5='?' (DbType = Boolean), @p6='?', @p7='?', @p8='?', @p9='?' (DbType = DateTime), @p10='?', @p11='?' (DbType = Int32), @p19='?' (DbType = Int32), @p13='?' (DbType = DateTime), @p14='?', @p15='?', @p16='?' (DbType = DateTime), @p17='?', @p18='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE refresh_token SET created = @p0, created_by_ip = @p1, expires = @p2, is_active = @p3, is_expired = @p4, is_revoked = @p5, reason_revoked = @p6, token = @p7, replaced_by_token = @p8, revoked = @p9, revoked_by_ip = @p10, user_id = @p11
WHERE id = @p12;
UPDATE users SET created_at = @p13, email = @p14, full_name = @p15, password_changed_at = @p16, password_hash = @p17, username = @p18
WHERE id = @p19;
2022-09-23 15:05:02.995 +01:00 [INF] Executed DbCommand (6ms) [Parameters=[@p12='?' (DbType = Int32), @p0='?' (DbType = DateTime), @p1='?', @p2='?' (DbType = DateTime), @p3='?' (DbType = Boolean), @p4='?' (DbType = Boolean), @p5='?' (DbType = Boolean), @p6='?', @p7='?', @p8='?', @p9='?' (DbType = DateTime), @p10='?', @p11='?' (DbType = Int32), @p19='?' (DbType = Int32), @p13='?' (DbType = DateTime), @p14='?', @p15='?', @p16='?' (DbType = DateTime), @p17='?', @p18='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE refresh_token SET created = @p0, created_by_ip = @p1, expires = @p2, is_active = @p3, is_expired = @p4, is_revoked = @p5, reason_revoked = @p6, token = @p7, replaced_by_token = @p8, revoked = @p9, revoked_by_ip = @p10, user_id = @p11
WHERE id = @p12;
UPDATE users SET created_at = @p13, email = @p14, full_name = @p15, password_changed_at = @p16, password_hash = @p17, username = @p18
WHERE id = @p19;
2022-09-23 15:05:02.998 +01:00 [DBG] A data reader was disposed.
2022-09-23 15:05:02.999 +01:00 [DBG] Committing transaction.
2022-09-23 15:05:03.002 +01:00 [DBG] Committed transaction.
2022-09-23 15:05:03.003 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:05:03.006 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 15:05:03.009 +01:00 [DBG] Disposing transaction.
2022-09-23 15:05:03.010 +01:00 [DBG] An entity of type 'User' tracked by 'PostgresContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 15:05:03.013 +01:00 [DBG] An entity of type 'RefreshToken' tracked by 'PostgresContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 15:05:03.015 +01:00 [DBG] SaveChanges completed for 'PostgresContext' with 2 entities written to the database.
2022-09-23 15:05:03.018 +01:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2022-09-23 15:05:03.022 +01:00 [DBG] Attempting to select an output formatter based on Accept header '["text/plain"]'.
2022-09-23 15:05:03.044 +01:00 [DBG] Could not find an output formatter based on content negotiation. Accepted types were (["text/plain"])
2022-09-23 15:05:03.049 +01:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2022-09-23 15:05:03.053 +01:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2022-09-23 15:05:03.059 +01:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2022-09-23 15:05:03.060 +01:00 [INF] Executing OkObjectResult, writing value of type 'APIBank.Models.MyRequestResponses.LoginResponse'.
2022-09-23 15:05:03.063 +01:00 [INF] Executed action APIBank.Controllers.UsersController.Login (APIBank) in 1231.6838ms
2022-09-23 15:05:03.065 +01:00 [INF] Executed endpoint 'APIBank.Controllers.UsersController.Login (APIBank)'
2022-09-23 15:05:03.076 +01:00 [DBG] 'PostgresContext' disposed.
2022-09-23 15:05:03.079 +01:00 [INF] Request finished HTTP/2 POST https://localhost:7036/api/Users/Login application/json 58 - 200 - application/json;+charset=utf-8 1570.0374ms
2022-09-23 15:05:19.782 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/api/Users/1/refresh-tokens - -
2022-09-23 15:05:19.818 +01:00 [DBG] 1 candidate(s) found for the request path '/api/Users/1/refresh-tokens'
2022-09-23 15:05:19.845 +01:00 [DBG] Endpoint 'APIBank.Controllers.UsersController.GetRefreshTokens (APIBank)' with route pattern 'api/Users/{id}/refresh-tokens' is valid for the request path '/api/Users/1/refresh-tokens'
2022-09-23 15:05:19.851 +01:00 [DBG] Request matched endpoint 'APIBank.Controllers.UsersController.GetRefreshTokens (APIBank)'
2022-09-23 15:05:19.859 +01:00 [DBG] Static files was skipped as the request already matched an endpoint.
2022-09-23 15:05:19.933 +01:00 [INF] Entity Framework Core 6.0.9 initialized 'PostgresContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:6.0.7+5b98e4b74de93b590b44aef8dd7967c03acc433c' with options: None
2022-09-23 15:05:19.950 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 15:05:19.955 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (4ms).
2022-09-23 15:05:19.967 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 15:05:19.969 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:05:19.983 +01:00 [DBG] Executing DbCommand [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.id = @__p_0
LIMIT 1
2022-09-23 15:05:19.990 +01:00 [INF] Executed DbCommand (6ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.id = @__p_0
LIMIT 1
2022-09-23 15:05:19.998 +01:00 [DBG] Context 'PostgresContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 15:05:20.008 +01:00 [DBG] A data reader was disposed.
2022-09-23 15:05:20.021 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:05:20.030 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 15:05:20.035 +01:00 [INF] Executing endpoint 'APIBank.Controllers.UsersController.GetRefreshTokens (APIBank)'
2022-09-23 15:05:20.042 +01:00 [INF] Route matched with {action = "GetRefreshTokens", controller = "Users"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult GetRefreshTokens(Int32) on controller APIBank.Controllers.UsersController (APIBank).
2022-09-23 15:05:20.045 +01:00 [DBG] Execution plan of authorization filters (in the following order): ["APIBank.Authorization.AuthorizeAttribute"]
2022-09-23 15:05:20.047 +01:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2022-09-23 15:05:20.049 +01:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2022-09-23 15:05:20.065 +01:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2022-09-23 15:05:20.093 +01:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2022-09-23 15:05:20.101 +01:00 [DBG] Executing controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-23 15:05:20.107 +01:00 [DBG] Executed controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-23 15:05:20.110 +01:00 [DBG] Attempting to bind parameter 'id' of type 'System.Int32' ...
2022-09-23 15:05:20.125 +01:00 [DBG] Attempting to bind parameter 'id' of type 'System.Int32' using the name 'id' in request data ...
2022-09-23 15:05:20.153 +01:00 [DBG] Done attempting to bind parameter 'id' of type 'System.Int32'.
2022-09-23 15:05:20.167 +01:00 [DBG] Done attempting to bind parameter 'id' of type 'System.Int32'.
2022-09-23 15:05:20.171 +01:00 [DBG] Attempting to validate the bound parameter 'id' of type 'System.Int32' ...
2022-09-23 15:05:20.175 +01:00 [DBG] Done attempting to validate the bound parameter 'id' of type 'System.Int32'.
2022-09-23 15:05:20.196 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 15:05:20.198 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2022-09-23 15:05:20.199 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 15:05:20.200 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:05:20.204 +01:00 [DBG] Executing DbCommand [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id, r.created, r.created_by_ip, r.expires, r.is_active, r.is_expired, r.is_revoked, r.reason_revoked, r.token, r.replaced_by_token, r.revoked, r.revoked_by_ip, r.user_id
FROM refresh_token AS r
WHERE r.id = @__p_0
LIMIT 1
2022-09-23 15:05:20.215 +01:00 [INF] Executed DbCommand (10ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id, r.created, r.created_by_ip, r.expires, r.is_active, r.is_expired, r.is_revoked, r.reason_revoked, r.token, r.replaced_by_token, r.revoked, r.revoked_by_ip, r.user_id
FROM refresh_token AS r
WHERE r.id = @__p_0
LIMIT 1
2022-09-23 15:05:20.239 +01:00 [DBG] Context 'PostgresContext' started tracking 'RefreshToken' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 15:05:20.246 +01:00 [DBG] A data reader was disposed.
2022-09-23 15:05:20.247 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:05:20.249 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 15:05:20.260 +01:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2022-09-23 15:05:20.264 +01:00 [DBG] No information found on request to perform content negotiation.
2022-09-23 15:05:20.271 +01:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2022-09-23 15:05:20.281 +01:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2022-09-23 15:05:20.300 +01:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2022-09-23 15:05:20.310 +01:00 [INF] Executing OkObjectResult, writing value of type 'Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryable`1[[APIBank.ModelEntities.RefreshToken, APIBank, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2022-09-23 15:05:20.356 +01:00 [DBG] Compiling query expression: 
'DbSet<RefreshToken>()
    .Where(rt => rt.UserId == __id_0)
    .AsNoTracking()
    .Select(rt => new RefreshToken{ 
        Id = rt.Id, 
        UserId = rt.UserId, 
        RefToken = rt.RefToken, 
        Expires = rt.Expires, 
        Created = rt.Created, 
        CreatedByIp = rt.CreatedByIp, 
        Revoked = rt.Revoked, 
        RevokedByIp = rt.RevokedByIp, 
        ReplacedByToken = rt.ReplacedByToken, 
        ReasonRevoked = rt.ReasonRevoked, 
        IsExpired = rt.IsExpired, 
        IsRevoked = rt.IsRevoked, 
        IsActive = rt.IsActive 
    }
    )'
2022-09-23 15:05:20.384 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<RefreshToken>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            Id -> 0
            UserId -> 1
            RefToken -> 2
            Expires -> 3
            Created -> 4
            CreatedByIp -> 5
            Revoked -> 6
            RevokedByIp -> 7
            ReplacedByToken -> 8
            ReasonRevoked -> 9
            IsExpired -> 10
            IsRevoked -> 11
            IsActive -> 12
        SELECT r.id AS Id, r.user_id AS UserId, r.token AS RefToken, r.expires AS Expires, r.created AS Created, r.created_by_ip AS CreatedByIp, r.revoked AS Revoked, r.revoked_by_ip AS RevokedByIp, r.replaced_by_token AS ReplacedByToken, r.reason_revoked AS ReasonRevoked, r.is_expired AS IsExpired, r.is_revoked AS IsRevoked, r.is_active AS IsActive
        FROM refresh_token AS r
        WHERE r.user_id == @__id_0), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, RefreshToken>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)'
2022-09-23 15:05:20.401 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 15:05:20.443 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (42ms).
2022-09-23 15:05:20.445 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 15:05:20.449 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:05:20.524 +01:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.user_id AS "UserId", r.token AS "RefToken", r.expires AS "Expires", r.created AS "Created", r.created_by_ip AS "CreatedByIp", r.revoked AS "Revoked", r.revoked_by_ip AS "RevokedByIp", r.replaced_by_token AS "ReplacedByToken", r.reason_revoked AS "ReasonRevoked", r.is_expired AS "IsExpired", r.is_revoked AS "IsRevoked", r.is_active AS "IsActive"
FROM refresh_token AS r
WHERE r.user_id = @__id_0
2022-09-23 15:05:20.578 +01:00 [INF] Executed DbCommand (53ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.user_id AS "UserId", r.token AS "RefToken", r.expires AS "Expires", r.created AS "Created", r.created_by_ip AS "CreatedByIp", r.revoked AS "Revoked", r.revoked_by_ip AS "RevokedByIp", r.replaced_by_token AS "ReplacedByToken", r.reason_revoked AS "ReasonRevoked", r.is_expired AS "IsExpired", r.is_revoked AS "IsRevoked", r.is_active AS "IsActive"
FROM refresh_token AS r
WHERE r.user_id = @__id_0
2022-09-23 15:05:20.601 +01:00 [DBG] A data reader was disposed.
2022-09-23 15:05:20.606 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:05:20.609 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 15:05:20.612 +01:00 [INF] Executed action APIBank.Controllers.UsersController.GetRefreshTokens (APIBank) in 510.8396ms
2022-09-23 15:05:20.613 +01:00 [INF] Executed endpoint 'APIBank.Controllers.UsersController.GetRefreshTokens (APIBank)'
2022-09-23 15:05:20.615 +01:00 [DBG] 'PostgresContext' disposed.
2022-09-23 15:05:20.617 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/api/Users/1/refresh-tokens - - - 200 - application/json;+charset=utf-8 834.5437ms
2022-09-23 15:06:47.968 +01:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2022-09-23 15:06:48.246 +01:00 [DBG] Hosting starting
2022-09-23 15:06:48.656 +01:00 [DBG] Using development certificate: CN=localhost (Thumbprint: 9CC642E9838495A6C3C202DECA6A8AD300396DD2)
2022-09-23 15:06:48.746 +01:00 [INF] Now listening on: https://localhost:7036
2022-09-23 15:06:48.768 +01:00 [INF] Now listening on: http://localhost:5036
2022-09-23 15:06:48.769 +01:00 [DBG] Loaded hosting startup assembly APIBank
2022-09-23 15:06:48.770 +01:00 [DBG] Loaded hosting startup assembly Microsoft.AspNetCore.Watch.BrowserRefresh
2022-09-23 15:06:48.771 +01:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.BrowserLink.Net
2022-09-23 15:06:48.772 +01:00 [INF] Application started. Press Ctrl+C to shut down.
2022-09-23 15:06:48.774 +01:00 [INF] Hosting environment: Development
2022-09-23 15:06:48.776 +01:00 [INF] Content root path: C:\Users\mguedesa\OneDrive - NTT DATA EMEAL\Documentos\GitHub\OpenBankAPI-NTT\APIBank\APIBank\
2022-09-23 15:06:48.776 +01:00 [DBG] Hosting started
2022-09-23 15:06:49.217 +01:00 [DBG] Connection id "0HMKTDJDP3755" accepted.
2022-09-23 15:06:49.220 +01:00 [DBG] Connection id "0HMKTDJDP3755" started.
2022-09-23 15:06:49.227 +01:00 [DBG] Connection id "0HMKTDJDP3755" received FIN.
2022-09-23 15:06:49.249 +01:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException:  Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveBlobAsync[TIOAdapter](TIOAdapter adapter)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](TIOAdapter adapter, Boolean receiveFirst, Byte[] reAuthenticationData, Boolean isApm)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2022-09-23 15:06:49.348 +01:00 [DBG] Connection id "0HMKTDJDP3755" stopped.
2022-09-23 15:06:49.353 +01:00 [DBG] Connection id "0HMKTDJDP3755" sending FIN because: "The Socket transport's send loop completed gracefully."
2022-09-23 15:06:49.627 +01:00 [DBG] Connection id "0HMKTDJDP3756" accepted.
2022-09-23 15:06:49.654 +01:00 [DBG] Connection id "0HMKTDJDP3756" started.
2022-09-23 15:06:49.777 +01:00 [DBG] Connection 0HMKTDJDP3756 established using the following protocol: "Tls12"
2022-09-23 15:06:50.099 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/swagger/index.html - -
2022-09-23 15:06:50.225 +01:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2022-09-23 15:06:50.270 +01:00 [DBG] No candidates found for the request path '/swagger/index.html'
2022-09-23 15:06:50.272 +01:00 [DBG] Request did not match any endpoints
2022-09-23 15:06:50.679 +01:00 [DBG] Response markup is scheduled to include browser refresh script injection.
2022-09-23 15:06:51.089 +01:00 [DBG] Response markup was updated to include browser refresh script injection.
2022-09-23 15:06:51.154 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/_vs/browserLink - -
2022-09-23 15:06:51.136 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/_framework/aspnetcore-browser-refresh.js - -
2022-09-23 15:06:51.407 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/swagger/index.html - - - 200 - text/html;charset=utf-8 1316.7937ms
2022-09-23 15:06:51.418 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/_framework/aspnetcore-browser-refresh.js - - - 200 11984 application/javascript;+charset=utf-8 281.7337ms
2022-09-23 15:06:51.627 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/_vs/browserLink - - - 200 - text/javascript;+charset=UTF-8 471.3716ms
2022-09-23 15:06:51.881 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/swagger/v1/swagger.json - -
2022-09-23 15:06:51.885 +01:00 [DBG] No candidates found for the request path '/swagger/v1/swagger.json'
2022-09-23 15:06:51.893 +01:00 [DBG] Request did not match any endpoints
2022-09-23 15:06:52.254 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/swagger/v1/swagger.json - - - 200 - application/json;charset=utf-8 373.4519ms
2022-09-23 15:07:04.452 +01:00 [INF] Request starting HTTP/2 POST https://localhost:7036/api/Users/Login application/json 58
2022-09-23 15:07:04.475 +01:00 [DBG] 1 candidate(s) found for the request path '/api/Users/Login'
2022-09-23 15:07:04.513 +01:00 [DBG] Endpoint 'APIBank.Controllers.UsersController.Login (APIBank)' with route pattern 'api/Users/Login' is valid for the request path '/api/Users/Login'
2022-09-23 15:07:04.527 +01:00 [DBG] Request matched endpoint 'APIBank.Controllers.UsersController.Login (APIBank)'
2022-09-23 15:07:04.539 +01:00 [DBG] Static files was skipped as the request already matched an endpoint.
2022-09-23 15:07:05.299 +01:00 [INF] Executing endpoint 'APIBank.Controllers.UsersController.Login (APIBank)'
2022-09-23 15:07:05.348 +01:00 [INF] Route matched with {action = "Login", controller = "Users"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult Login(APIBank.Models.Requests.UserLoginRequest) on controller APIBank.Controllers.UsersController (APIBank).
2022-09-23 15:07:05.354 +01:00 [DBG] Execution plan of authorization filters (in the following order): ["APIBank.Authorization.AuthorizeAttribute"]
2022-09-23 15:07:05.356 +01:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2022-09-23 15:07:05.357 +01:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2022-09-23 15:07:05.360 +01:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2022-09-23 15:07:05.365 +01:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2022-09-23 15:07:05.368 +01:00 [DBG] Executing controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-23 15:07:05.371 +01:00 [DBG] Executed controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-23 15:07:05.397 +01:00 [DBG] Attempting to bind parameter 'model' of type 'APIBank.Models.Requests.UserLoginRequest' ...
2022-09-23 15:07:05.406 +01:00 [DBG] Attempting to bind parameter 'model' of type 'APIBank.Models.Requests.UserLoginRequest' using the name '' in request data ...
2022-09-23 15:07:05.410 +01:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2022-09-23 15:07:05.424 +01:00 [DBG] Connection id "0HMKTDJDP3756", Request id "0HMKTDJDP3756:00000009": started reading request body.
2022-09-23 15:07:05.426 +01:00 [DBG] Connection id "0HMKTDJDP3756", Request id "0HMKTDJDP3756:00000009": done reading request body.
2022-09-23 15:07:05.449 +01:00 [DBG] JSON input formatter succeeded, deserializing to type 'APIBank.Models.Requests.UserLoginRequest'
2022-09-23 15:07:05.460 +01:00 [DBG] Done attempting to bind parameter 'model' of type 'APIBank.Models.Requests.UserLoginRequest'.
2022-09-23 15:07:05.474 +01:00 [DBG] Done attempting to bind parameter 'model' of type 'APIBank.Models.Requests.UserLoginRequest'.
2022-09-23 15:07:05.476 +01:00 [DBG] Attempting to validate the bound parameter 'model' of type 'APIBank.Models.Requests.UserLoginRequest' ...
2022-09-23 15:07:05.534 +01:00 [DBG] Done attempting to validate the bound parameter 'model' of type 'APIBank.Models.Requests.UserLoginRequest'.
2022-09-23 15:07:05.895 +01:00 [DBG] An additional 'IServiceProvider' was created for internal use by Entity Framework. An existing service provider was not used due to the following configuration changes: configuration changed for 'Core:ConfigureWarnings', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:UseAdminDatabase', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:SetPostgresVersion', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:UseRedshift', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:ReverseNullOrdering', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:RemoteCertificateValidationCallback', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:ProvideClientCertificatesCallback', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:ProvidePasswordCallback'.
2022-09-23 15:07:08.145 +01:00 [INF] Entity Framework Core 6.0.9 initialized 'PostgresContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:6.0.7+5b98e4b74de93b590b44aef8dd7967c03acc433c' with options: None
2022-09-23 15:07:08.457 +01:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .SingleOrDefault(x => x.Username == __model_Username_0)'
2022-09-23 15:07:09.462 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<User>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: User.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: User.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 1], [Property: User.Email (string) Required Index MaxLength(254), 2], [Property: User.FullName (string) Required MaxLength(100), 3], [Property: User.PasswordChangedAt (DateTime) Required ValueGenerated.OnAdd, 4], [Property: User.PasswordHash (string) Required MaxLength(200), 5], [Property: User.Username (string) Required Index MaxLength(50), 6] }
        SELECT TOP(2) u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
        FROM users AS u
        WHERE u.username == @__model_Username_0), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, User>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)
    .SingleOrDefault()'
2022-09-23 15:07:09.597 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 15:07:09.801 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (203ms).
2022-09-23 15:07:09.818 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 15:07:10.354 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:07:10.401 +01:00 [DBG] Executing DbCommand [Parameters=[@__model_Username_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.username = @__model_Username_0
LIMIT 2
2022-09-23 15:07:10.623 +01:00 [INF] Executed DbCommand (236ms) [Parameters=[@__model_Username_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.username = @__model_Username_0
LIMIT 2
2022-09-23 15:07:10.763 +01:00 [DBG] Context 'PostgresContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 15:07:10.873 +01:00 [DBG] A data reader was disposed.
2022-09-23 15:07:10.884 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:07:10.902 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 15:07:11.205 +01:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .Any(user => user.RefreshTokenCollection
        .Any(reftoken => reftoken.RefToken == __token_0))'
2022-09-23 15:07:11.464 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<bool>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            EmptyProjectionMember -> 0
        SELECT EXISTS (
            SELECT 1
            FROM users AS u
            WHERE EXISTS (
                SELECT 1
                FROM refresh_token AS r
                WHERE ((u.id != NULL) && (u.id == r.user_id)) && (r.token == @__token_0)))), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, bool>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)
    .Single()'
2022-09-23 15:07:11.488 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 15:07:11.489 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2022-09-23 15:07:11.493 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 15:07:11.495 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:07:11.498 +01:00 [DBG] Executing DbCommand [Parameters=[@__token_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM users AS u
    WHERE EXISTS (
        SELECT 1
        FROM refresh_token AS r
        WHERE (u.id = r.user_id) AND (r.token = @__token_0)))
2022-09-23 15:07:11.502 +01:00 [INF] Executed DbCommand (4ms) [Parameters=[@__token_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM users AS u
    WHERE EXISTS (
        SELECT 1
        FROM refresh_token AS r
        WHERE (u.id = r.user_id) AND (r.token = @__token_0)))
2022-09-23 15:07:11.510 +01:00 [DBG] A data reader was disposed.
2022-09-23 15:07:11.511 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:07:11.514 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 15:07:11.519 +01:00 [DBG] SaveChanges starting for 'PostgresContext'.
2022-09-23 15:07:11.529 +01:00 [DBG] DetectChanges starting for 'PostgresContext'.
2022-09-23 15:07:11.587 +01:00 [DBG] 1 entities were added and 0 entities were removed from navigation 'User.RefreshTokenCollection'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 15:07:11.660 +01:00 [DBG] 'PostgresContext' generated a temporary value for the property 'Id.RefreshToken'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 15:07:11.746 +01:00 [DBG] Context 'PostgresContext' started tracking 'RefreshToken' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 15:07:11.760 +01:00 [DBG] DetectChanges completed for 'PostgresContext'.
2022-09-23 15:07:11.772 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 15:07:11.776 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:07:11.787 +01:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2022-09-23 15:07:11.826 +01:00 [DBG] Began transaction with isolation level 'ReadCommitted'.
2022-09-23 15:07:11.943 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 15:07:11.945 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (2ms).
2022-09-23 15:07:11.947 +01:00 [DBG] Executing DbCommand [Parameters=[@p0='?' (DbType = DateTime), @p1='?', @p2='?' (DbType = DateTime), @p3='?' (DbType = Boolean), @p4='?' (DbType = Boolean), @p5='?' (DbType = Boolean), @p6='?', @p7='?', @p8='?', @p9='?' (DbType = DateTime), @p10='?', @p11='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO refresh_token (created, created_by_ip, expires, is_active, is_expired, is_revoked, reason_revoked, token, replaced_by_token, revoked, revoked_by_ip, user_id)
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11)
RETURNING id;
2022-09-23 15:07:11.976 +01:00 [INF] Executed DbCommand (29ms) [Parameters=[@p0='?' (DbType = DateTime), @p1='?', @p2='?' (DbType = DateTime), @p3='?' (DbType = Boolean), @p4='?' (DbType = Boolean), @p5='?' (DbType = Boolean), @p6='?', @p7='?', @p8='?', @p9='?' (DbType = DateTime), @p10='?', @p11='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO refresh_token (created, created_by_ip, expires, is_active, is_expired, is_revoked, reason_revoked, token, replaced_by_token, revoked, revoked_by_ip, user_id)
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11)
RETURNING id;
2022-09-23 15:07:12.015 +01:00 [DBG] The foreign key property 'RefreshToken.Id' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2022-09-23 15:07:12.028 +01:00 [DBG] A data reader was disposed.
2022-09-23 15:07:12.039 +01:00 [DBG] Committing transaction.
2022-09-23 15:07:12.056 +01:00 [DBG] Committed transaction.
2022-09-23 15:07:12.059 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:07:12.061 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 15:07:12.065 +01:00 [DBG] Disposing transaction.
2022-09-23 15:07:12.082 +01:00 [DBG] An entity of type 'RefreshToken' tracked by 'PostgresContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 15:07:12.091 +01:00 [DBG] SaveChanges completed for 'PostgresContext' with 1 entities written to the database.
2022-09-23 15:07:12.481 +01:00 [DBG] Compiling query expression: 
'DbSet<RefreshToken>()
    .Where(rt => rt.UserId == __id_0)
    .AsNoTracking()
    .Select(rt => new RefreshToken{ 
        Id = rt.Id, 
        UserId = rt.UserId, 
        RefToken = rt.RefToken, 
        Expires = rt.Expires, 
        Created = rt.Created, 
        CreatedByIp = rt.CreatedByIp, 
        Revoked = rt.Revoked, 
        RevokedByIp = rt.RevokedByIp, 
        ReplacedByToken = rt.ReplacedByToken, 
        ReasonRevoked = rt.ReasonRevoked, 
        IsExpired = rt.IsExpired, 
        IsRevoked = rt.IsRevoked, 
        IsActive = rt.IsActive 
    }
    )'
2022-09-23 15:07:12.544 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<RefreshToken>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            Id -> 0
            UserId -> 1
            RefToken -> 2
            Expires -> 3
            Created -> 4
            CreatedByIp -> 5
            Revoked -> 6
            RevokedByIp -> 7
            ReplacedByToken -> 8
            ReasonRevoked -> 9
            IsExpired -> 10
            IsRevoked -> 11
            IsActive -> 12
        SELECT r.id AS Id, r.user_id AS UserId, r.token AS RefToken, r.expires AS Expires, r.created AS Created, r.created_by_ip AS CreatedByIp, r.revoked AS Revoked, r.revoked_by_ip AS RevokedByIp, r.replaced_by_token AS ReplacedByToken, r.reason_revoked AS ReasonRevoked, r.is_expired AS IsExpired, r.is_revoked AS IsRevoked, r.is_active AS IsActive
        FROM refresh_token AS r
        WHERE r.user_id == @__id_0), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, RefreshToken>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)'
2022-09-23 15:07:12.550 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 15:07:12.551 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2022-09-23 15:07:12.552 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 15:07:12.553 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:07:12.554 +01:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.user_id AS "UserId", r.token AS "RefToken", r.expires AS "Expires", r.created AS "Created", r.created_by_ip AS "CreatedByIp", r.revoked AS "Revoked", r.revoked_by_ip AS "RevokedByIp", r.replaced_by_token AS "ReplacedByToken", r.reason_revoked AS "ReasonRevoked", r.is_expired AS "IsExpired", r.is_revoked AS "IsRevoked", r.is_active AS "IsActive"
FROM refresh_token AS r
WHERE r.user_id = @__id_0
2022-09-23 15:07:12.559 +01:00 [INF] Executed DbCommand (5ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.user_id AS "UserId", r.token AS "RefToken", r.expires AS "Expires", r.created AS "Created", r.created_by_ip AS "CreatedByIp", r.revoked AS "Revoked", r.revoked_by_ip AS "RevokedByIp", r.replaced_by_token AS "ReplacedByToken", r.reason_revoked AS "ReasonRevoked", r.is_expired AS "IsExpired", r.is_revoked AS "IsRevoked", r.is_active AS "IsActive"
FROM refresh_token AS r
WHERE r.user_id = @__id_0
2022-09-23 15:07:12.563 +01:00 [DBG] A data reader was disposed.
2022-09-23 15:07:12.564 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:07:12.565 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 15:07:12.569 +01:00 [DBG] An entity of type 'User' tracked by 'PostgresContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 15:07:12.570 +01:00 [DBG] An entity of type 'RefreshToken' tracked by 'PostgresContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 15:07:12.574 +01:00 [DBG] SaveChanges starting for 'PostgresContext'.
2022-09-23 15:07:12.576 +01:00 [DBG] DetectChanges starting for 'PostgresContext'.
2022-09-23 15:07:12.579 +01:00 [DBG] DetectChanges completed for 'PostgresContext'.
2022-09-23 15:07:12.580 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 15:07:12.581 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:07:12.582 +01:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2022-09-23 15:07:12.583 +01:00 [DBG] Began transaction with isolation level 'ReadCommitted'.
2022-09-23 15:07:12.628 +01:00 [DBG] Executing 2 update commands as a batch.
2022-09-23 15:07:12.636 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 15:07:12.637 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2022-09-23 15:07:12.644 +01:00 [DBG] Executing DbCommand [Parameters=[@p12='?' (DbType = Int32), @p0='?' (DbType = DateTime), @p1='?', @p2='?' (DbType = DateTime), @p3='?' (DbType = Boolean), @p4='?' (DbType = Boolean), @p5='?' (DbType = Boolean), @p6='?', @p7='?', @p8='?', @p9='?' (DbType = DateTime), @p10='?', @p11='?' (DbType = Int32), @p19='?' (DbType = Int32), @p13='?' (DbType = DateTime), @p14='?', @p15='?', @p16='?' (DbType = DateTime), @p17='?', @p18='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE refresh_token SET created = @p0, created_by_ip = @p1, expires = @p2, is_active = @p3, is_expired = @p4, is_revoked = @p5, reason_revoked = @p6, token = @p7, replaced_by_token = @p8, revoked = @p9, revoked_by_ip = @p10, user_id = @p11
WHERE id = @p12;
UPDATE users SET created_at = @p13, email = @p14, full_name = @p15, password_changed_at = @p16, password_hash = @p17, username = @p18
WHERE id = @p19;
2022-09-23 15:07:12.648 +01:00 [INF] Executed DbCommand (5ms) [Parameters=[@p12='?' (DbType = Int32), @p0='?' (DbType = DateTime), @p1='?', @p2='?' (DbType = DateTime), @p3='?' (DbType = Boolean), @p4='?' (DbType = Boolean), @p5='?' (DbType = Boolean), @p6='?', @p7='?', @p8='?', @p9='?' (DbType = DateTime), @p10='?', @p11='?' (DbType = Int32), @p19='?' (DbType = Int32), @p13='?' (DbType = DateTime), @p14='?', @p15='?', @p16='?' (DbType = DateTime), @p17='?', @p18='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE refresh_token SET created = @p0, created_by_ip = @p1, expires = @p2, is_active = @p3, is_expired = @p4, is_revoked = @p5, reason_revoked = @p6, token = @p7, replaced_by_token = @p8, revoked = @p9, revoked_by_ip = @p10, user_id = @p11
WHERE id = @p12;
UPDATE users SET created_at = @p13, email = @p14, full_name = @p15, password_changed_at = @p16, password_hash = @p17, username = @p18
WHERE id = @p19;
2022-09-23 15:07:12.651 +01:00 [DBG] A data reader was disposed.
2022-09-23 15:07:12.652 +01:00 [DBG] Committing transaction.
2022-09-23 15:07:12.654 +01:00 [DBG] Committed transaction.
2022-09-23 15:07:12.657 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:07:12.659 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 15:07:12.660 +01:00 [DBG] Disposing transaction.
2022-09-23 15:07:12.662 +01:00 [DBG] An entity of type 'User' tracked by 'PostgresContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 15:07:12.664 +01:00 [DBG] An entity of type 'RefreshToken' tracked by 'PostgresContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 15:07:12.666 +01:00 [DBG] SaveChanges completed for 'PostgresContext' with 2 entities written to the database.
2022-09-23 15:07:12.678 +01:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2022-09-23 15:07:12.687 +01:00 [DBG] Attempting to select an output formatter based on Accept header '["text/plain"]'.
2022-09-23 15:07:12.691 +01:00 [DBG] Could not find an output formatter based on content negotiation. Accepted types were (["text/plain"])
2022-09-23 15:07:12.693 +01:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2022-09-23 15:07:12.694 +01:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2022-09-23 15:07:12.696 +01:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2022-09-23 15:07:12.697 +01:00 [INF] Executing OkObjectResult, writing value of type 'APIBank.Models.MyRequestResponses.LoginResponse'.
2022-09-23 15:07:12.731 +01:00 [INF] Executed action APIBank.Controllers.UsersController.Login (APIBank) in 7352.0181ms
2022-09-23 15:07:12.735 +01:00 [INF] Executed endpoint 'APIBank.Controllers.UsersController.Login (APIBank)'
2022-09-23 15:07:12.747 +01:00 [DBG] 'PostgresContext' disposed.
2022-09-23 15:07:12.765 +01:00 [INF] Request finished HTTP/2 POST https://localhost:7036/api/Users/Login application/json 58 - 200 - application/json;+charset=utf-8 8313.0310ms
2022-09-23 15:07:25.265 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/api/Users/1/refresh-tokens - -
2022-09-23 15:07:25.269 +01:00 [DBG] 1 candidate(s) found for the request path '/api/Users/1/refresh-tokens'
2022-09-23 15:07:25.273 +01:00 [DBG] Endpoint 'APIBank.Controllers.UsersController.GetRefreshTokens (APIBank)' with route pattern 'api/Users/{id}/refresh-tokens' is valid for the request path '/api/Users/1/refresh-tokens'
2022-09-23 15:07:25.279 +01:00 [DBG] Request matched endpoint 'APIBank.Controllers.UsersController.GetRefreshTokens (APIBank)'
2022-09-23 15:07:25.283 +01:00 [DBG] Static files was skipped as the request already matched an endpoint.
2022-09-23 15:07:25.690 +01:00 [INF] Entity Framework Core 6.0.9 initialized 'PostgresContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:6.0.7+5b98e4b74de93b590b44aef8dd7967c03acc433c' with options: None
2022-09-23 15:07:25.738 +01:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .FirstOrDefault(e => EF.Property<int>(e, "Id") == __p_0)'
2022-09-23 15:07:25.756 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<User>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: User.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: User.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 1], [Property: User.Email (string) Required Index MaxLength(254), 2], [Property: User.FullName (string) Required MaxLength(100), 3], [Property: User.PasswordChangedAt (DateTime) Required ValueGenerated.OnAdd, 4], [Property: User.PasswordHash (string) Required MaxLength(200), 5], [Property: User.Username (string) Required Index MaxLength(50), 6] }
        SELECT TOP(1) u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
        FROM users AS u
        WHERE u.id == @__p_0), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, User>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)
    .SingleOrDefault()'
2022-09-23 15:07:25.771 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 15:07:25.772 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2022-09-23 15:07:25.774 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 15:07:25.776 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:07:25.780 +01:00 [DBG] Executing DbCommand [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.id = @__p_0
LIMIT 1
2022-09-23 15:07:25.786 +01:00 [INF] Executed DbCommand (6ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.id = @__p_0
LIMIT 1
2022-09-23 15:07:25.788 +01:00 [DBG] Context 'PostgresContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 15:07:25.791 +01:00 [DBG] A data reader was disposed.
2022-09-23 15:07:25.792 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:07:25.793 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 15:07:25.797 +01:00 [INF] Executing endpoint 'APIBank.Controllers.UsersController.GetRefreshTokens (APIBank)'
2022-09-23 15:07:25.803 +01:00 [INF] Route matched with {action = "GetRefreshTokens", controller = "Users"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult GetRefreshTokens(Int32) on controller APIBank.Controllers.UsersController (APIBank).
2022-09-23 15:07:25.806 +01:00 [DBG] Execution plan of authorization filters (in the following order): ["APIBank.Authorization.AuthorizeAttribute"]
2022-09-23 15:07:25.807 +01:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2022-09-23 15:07:25.812 +01:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2022-09-23 15:07:25.815 +01:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2022-09-23 15:07:25.816 +01:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2022-09-23 15:07:25.817 +01:00 [DBG] Executing controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-23 15:07:25.819 +01:00 [DBG] Executed controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-23 15:07:25.822 +01:00 [DBG] Attempting to bind parameter 'id' of type 'System.Int32' ...
2022-09-23 15:07:25.827 +01:00 [DBG] Attempting to bind parameter 'id' of type 'System.Int32' using the name 'id' in request data ...
2022-09-23 15:07:25.833 +01:00 [DBG] Done attempting to bind parameter 'id' of type 'System.Int32'.
2022-09-23 15:07:25.835 +01:00 [DBG] Done attempting to bind parameter 'id' of type 'System.Int32'.
2022-09-23 15:07:25.837 +01:00 [DBG] Attempting to validate the bound parameter 'id' of type 'System.Int32' ...
2022-09-23 15:07:25.839 +01:00 [DBG] Done attempting to validate the bound parameter 'id' of type 'System.Int32'.
2022-09-23 15:07:25.850 +01:00 [DBG] Compiling query expression: 
'DbSet<RefreshToken>()
    .FirstOrDefault(e => EF.Property<int>(e, "Id") == __p_0)'
2022-09-23 15:07:25.857 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<RefreshToken>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: RefreshToken.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: RefreshToken.Created (DateTime) Required, 1], [Property: RefreshToken.CreatedByIp (string) Required MaxLength(200), 2], [Property: RefreshToken.Expires (DateTime) Required, 3], [Property: RefreshToken.IsActive (no field, bool) Required, 4], [Property: RefreshToken.IsExpired (no field, bool) Required, 5], [Property: RefreshToken.IsRevoked (no field, bool) Required, 6], [Property: RefreshToken.ReasonRevoked (string) MaxLength(200), 7], [Property: RefreshToken.RefToken (string) Required MaxLength(254), 8], [Property: RefreshToken.ReplacedByToken (string) MaxLength(200), 9], [Property: RefreshToken.Revoked (DateTime?), 10], [Property: RefreshToken.RevokedByIp (string) MaxLength(200), 11], [Property: RefreshToken.UserId (int) Required FK Index, 12] }
        SELECT TOP(1) r.id, r.created, r.created_by_ip, r.expires, r.is_active, r.is_expired, r.is_revoked, r.reason_revoked, r.token, r.replaced_by_token, r.revoked, r.revoked_by_ip, r.user_id
        FROM refresh_token AS r
        WHERE r.id == @__p_0), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, RefreshToken>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)
    .SingleOrDefault()'
2022-09-23 15:07:25.862 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 15:07:25.863 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2022-09-23 15:07:25.864 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 15:07:25.865 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:07:25.866 +01:00 [DBG] Executing DbCommand [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id, r.created, r.created_by_ip, r.expires, r.is_active, r.is_expired, r.is_revoked, r.reason_revoked, r.token, r.replaced_by_token, r.revoked, r.revoked_by_ip, r.user_id
FROM refresh_token AS r
WHERE r.id = @__p_0
LIMIT 1
2022-09-23 15:07:25.869 +01:00 [INF] Executed DbCommand (3ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id, r.created, r.created_by_ip, r.expires, r.is_active, r.is_expired, r.is_revoked, r.reason_revoked, r.token, r.replaced_by_token, r.revoked, r.revoked_by_ip, r.user_id
FROM refresh_token AS r
WHERE r.id = @__p_0
LIMIT 1
2022-09-23 15:07:25.876 +01:00 [DBG] Context 'PostgresContext' started tracking 'RefreshToken' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 15:07:25.881 +01:00 [DBG] A data reader was disposed.
2022-09-23 15:07:25.883 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:07:25.885 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 15:07:25.889 +01:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2022-09-23 15:07:25.893 +01:00 [DBG] No information found on request to perform content negotiation.
2022-09-23 15:07:25.895 +01:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2022-09-23 15:07:25.896 +01:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2022-09-23 15:07:25.897 +01:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2022-09-23 15:07:25.899 +01:00 [INF] Executing OkObjectResult, writing value of type 'Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryable`1[[APIBank.ModelEntities.RefreshToken, APIBank, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2022-09-23 15:07:25.912 +01:00 [DBG] Compiling query expression: 
'DbSet<RefreshToken>()
    .Where(rt => rt.UserId == __id_0)
    .AsNoTracking()
    .Select(rt => new RefreshToken{ 
        Id = rt.Id, 
        UserId = rt.UserId, 
        RefToken = rt.RefToken, 
        Expires = rt.Expires, 
        Created = rt.Created, 
        CreatedByIp = rt.CreatedByIp, 
        Revoked = rt.Revoked, 
        RevokedByIp = rt.RevokedByIp, 
        ReplacedByToken = rt.ReplacedByToken, 
        ReasonRevoked = rt.ReasonRevoked, 
        IsExpired = rt.IsExpired, 
        IsRevoked = rt.IsRevoked, 
        IsActive = rt.IsActive 
    }
    )'
2022-09-23 15:07:25.921 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<RefreshToken>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            Id -> 0
            UserId -> 1
            RefToken -> 2
            Expires -> 3
            Created -> 4
            CreatedByIp -> 5
            Revoked -> 6
            RevokedByIp -> 7
            ReplacedByToken -> 8
            ReasonRevoked -> 9
            IsExpired -> 10
            IsRevoked -> 11
            IsActive -> 12
        SELECT r.id AS Id, r.user_id AS UserId, r.token AS RefToken, r.expires AS Expires, r.created AS Created, r.created_by_ip AS CreatedByIp, r.revoked AS Revoked, r.revoked_by_ip AS RevokedByIp, r.replaced_by_token AS ReplacedByToken, r.reason_revoked AS ReasonRevoked, r.is_expired AS IsExpired, r.is_revoked AS IsRevoked, r.is_active AS IsActive
        FROM refresh_token AS r
        WHERE r.user_id == @__id_0), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, RefreshToken>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)'
2022-09-23 15:07:25.957 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 15:07:25.961 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (3ms).
2022-09-23 15:07:25.982 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 15:07:25.984 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:07:25.987 +01:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.user_id AS "UserId", r.token AS "RefToken", r.expires AS "Expires", r.created AS "Created", r.created_by_ip AS "CreatedByIp", r.revoked AS "Revoked", r.revoked_by_ip AS "RevokedByIp", r.replaced_by_token AS "ReplacedByToken", r.reason_revoked AS "ReasonRevoked", r.is_expired AS "IsExpired", r.is_revoked AS "IsRevoked", r.is_active AS "IsActive"
FROM refresh_token AS r
WHERE r.user_id = @__id_0
2022-09-23 15:07:25.999 +01:00 [INF] Executed DbCommand (11ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.user_id AS "UserId", r.token AS "RefToken", r.expires AS "Expires", r.created AS "Created", r.created_by_ip AS "CreatedByIp", r.revoked AS "Revoked", r.revoked_by_ip AS "RevokedByIp", r.replaced_by_token AS "ReplacedByToken", r.reason_revoked AS "ReasonRevoked", r.is_expired AS "IsExpired", r.is_revoked AS "IsRevoked", r.is_active AS "IsActive"
FROM refresh_token AS r
WHERE r.user_id = @__id_0
2022-09-23 15:07:26.034 +01:00 [DBG] A data reader was disposed.
2022-09-23 15:07:26.056 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:07:26.062 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 15:07:26.064 +01:00 [INF] Executed action APIBank.Controllers.UsersController.GetRefreshTokens (APIBank) in 246.6655ms
2022-09-23 15:07:26.065 +01:00 [INF] Executed endpoint 'APIBank.Controllers.UsersController.GetRefreshTokens (APIBank)'
2022-09-23 15:07:26.066 +01:00 [DBG] 'PostgresContext' disposed.
2022-09-23 15:07:26.067 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/api/Users/1/refresh-tokens - - - 200 - application/json;+charset=utf-8 802.9193ms
2022-09-23 15:07:30.329 +01:00 [INF] Request starting HTTP/2 POST https://localhost:7036/api/Users/revoke-token - 0
2022-09-23 15:07:30.332 +01:00 [DBG] 1 candidate(s) found for the request path '/api/Users/revoke-token'
2022-09-23 15:07:30.355 +01:00 [DBG] Endpoint 'APIBank.Controllers.UsersController.RevokeToken (APIBank)' with route pattern 'api/Users/revoke-token' is valid for the request path '/api/Users/revoke-token'
2022-09-23 15:07:30.356 +01:00 [DBG] Request matched endpoint 'APIBank.Controllers.UsersController.RevokeToken (APIBank)'
2022-09-23 15:07:30.364 +01:00 [DBG] Static files was skipped as the request already matched an endpoint.
2022-09-23 15:07:30.467 +01:00 [INF] Entity Framework Core 6.0.9 initialized 'PostgresContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:6.0.7+5b98e4b74de93b590b44aef8dd7967c03acc433c' with options: None
2022-09-23 15:07:30.486 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 15:07:30.489 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (2ms).
2022-09-23 15:07:30.490 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 15:07:30.494 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:07:30.496 +01:00 [DBG] Executing DbCommand [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.id = @__p_0
LIMIT 1
2022-09-23 15:07:30.501 +01:00 [INF] Executed DbCommand (5ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.id = @__p_0
LIMIT 1
2022-09-23 15:07:30.505 +01:00 [DBG] Context 'PostgresContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 15:07:30.506 +01:00 [DBG] A data reader was disposed.
2022-09-23 15:07:30.507 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:07:30.509 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 15:07:30.511 +01:00 [INF] Executing endpoint 'APIBank.Controllers.UsersController.RevokeToken (APIBank)'
2022-09-23 15:07:30.514 +01:00 [INF] Route matched with {action = "RevokeToken", controller = "Users"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult RevokeToken() on controller APIBank.Controllers.UsersController (APIBank).
2022-09-23 15:07:30.519 +01:00 [DBG] Execution plan of authorization filters (in the following order): ["APIBank.Authorization.AuthorizeAttribute"]
2022-09-23 15:07:30.521 +01:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2022-09-23 15:07:30.522 +01:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2022-09-23 15:07:30.524 +01:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2022-09-23 15:07:30.527 +01:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2022-09-23 15:07:30.530 +01:00 [DBG] Executing controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-23 15:07:30.536 +01:00 [DBG] Executed controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-23 15:07:30.539 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 15:07:30.541 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2022-09-23 15:07:30.543 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 15:07:30.545 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:07:30.548 +01:00 [DBG] Executing DbCommand [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id, r.created, r.created_by_ip, r.expires, r.is_active, r.is_expired, r.is_revoked, r.reason_revoked, r.token, r.replaced_by_token, r.revoked, r.revoked_by_ip, r.user_id
FROM refresh_token AS r
WHERE r.id = @__p_0
LIMIT 1
2022-09-23 15:07:30.552 +01:00 [INF] Executed DbCommand (5ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id, r.created, r.created_by_ip, r.expires, r.is_active, r.is_expired, r.is_revoked, r.reason_revoked, r.token, r.replaced_by_token, r.revoked, r.revoked_by_ip, r.user_id
FROM refresh_token AS r
WHERE r.id = @__p_0
LIMIT 1
2022-09-23 15:07:30.555 +01:00 [DBG] Context 'PostgresContext' started tracking 'RefreshToken' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 15:07:30.557 +01:00 [DBG] A data reader was disposed.
2022-09-23 15:07:30.558 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:07:30.561 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 15:07:51.845 +01:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .SingleOrDefault(userQuery => userQuery.RefreshTokenCollection
        .Any(refTokenQuery => refTokenQuery.RefToken == __refToken_0))'
2022-09-23 15:07:51.855 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<User>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: User.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: User.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 1], [Property: User.Email (string) Required Index MaxLength(254), 2], [Property: User.FullName (string) Required MaxLength(100), 3], [Property: User.PasswordChangedAt (DateTime) Required ValueGenerated.OnAdd, 4], [Property: User.PasswordHash (string) Required MaxLength(200), 5], [Property: User.Username (string) Required Index MaxLength(50), 6] }
        SELECT TOP(2) u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
        FROM users AS u
        WHERE EXISTS (
            SELECT 1
            FROM refresh_token AS r
            WHERE ((u.id != NULL) && (u.id == r.user_id)) && (r.token == @__refToken_0))), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, User>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)
    .SingleOrDefault()'
2022-09-23 15:07:51.859 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 15:07:51.860 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2022-09-23 15:07:51.862 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 15:07:51.864 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:07:51.865 +01:00 [DBG] Executing DbCommand [Parameters=[@__refToken_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE EXISTS (
    SELECT 1
    FROM refresh_token AS r
    WHERE (u.id = r.user_id) AND (r.token = @__refToken_0))
LIMIT 2
2022-09-23 15:07:51.868 +01:00 [INF] Executed DbCommand (3ms) [Parameters=[@__refToken_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE EXISTS (
    SELECT 1
    FROM refresh_token AS r
    WHERE (u.id = r.user_id) AND (r.token = @__refToken_0))
LIMIT 2
2022-09-23 15:07:51.873 +01:00 [DBG] A data reader was disposed.
2022-09-23 15:07:51.876 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:07:51.878 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 15:08:04.671 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 15:08:04.674 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (3ms).
2022-09-23 15:08:04.675 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 15:08:04.677 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:08:04.679 +01:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.user_id AS "UserId", r.token AS "RefToken", r.expires AS "Expires", r.created AS "Created", r.created_by_ip AS "CreatedByIp", r.revoked AS "Revoked", r.revoked_by_ip AS "RevokedByIp", r.replaced_by_token AS "ReplacedByToken", r.reason_revoked AS "ReasonRevoked", r.is_expired AS "IsExpired", r.is_revoked AS "IsRevoked", r.is_active AS "IsActive"
FROM refresh_token AS r
WHERE r.user_id = @__id_0
2022-09-23 15:08:04.682 +01:00 [INF] Executed DbCommand (3ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.user_id AS "UserId", r.token AS "RefToken", r.expires AS "Expires", r.created AS "Created", r.created_by_ip AS "CreatedByIp", r.revoked AS "Revoked", r.revoked_by_ip AS "RevokedByIp", r.replaced_by_token AS "ReplacedByToken", r.reason_revoked AS "ReasonRevoked", r.is_expired AS "IsExpired", r.is_revoked AS "IsRevoked", r.is_active AS "IsActive"
FROM refresh_token AS r
WHERE r.user_id = @__id_0
2022-09-23 15:08:04.684 +01:00 [DBG] A data reader was disposed.
2022-09-23 15:08:04.685 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:08:04.686 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 15:08:18.951 +01:00 [DBG] An entity of type 'User' tracked by 'PostgresContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 15:08:18.970 +01:00 [DBG] SaveChanges starting for 'PostgresContext'.
2022-09-23 15:08:18.972 +01:00 [DBG] DetectChanges starting for 'PostgresContext'.
2022-09-23 15:08:18.987 +01:00 [DBG] The unchanged property 'RefreshToken.IsActive' was detected as changed and will be marked as modified. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2022-09-23 15:08:18.989 +01:00 [DBG] An entity of type 'RefreshToken' tracked by 'PostgresContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 15:08:18.991 +01:00 [DBG] The unchanged property 'RefreshToken.IsRevoked' was detected as changed and will be marked as modified. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2022-09-23 15:08:18.992 +01:00 [DBG] The unchanged property 'RefreshToken.ReasonRevoked' was detected as changed and will be marked as modified. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2022-09-23 15:08:18.995 +01:00 [DBG] The unchanged property 'RefreshToken.Revoked' was detected as changed and will be marked as modified. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2022-09-23 15:08:18.996 +01:00 [DBG] The unchanged property 'RefreshToken.RevokedByIp' was detected as changed and will be marked as modified. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2022-09-23 15:08:18.997 +01:00 [DBG] DetectChanges completed for 'PostgresContext'.
2022-09-23 15:08:19.000 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 15:08:19.001 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:08:19.010 +01:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2022-09-23 15:08:19.026 +01:00 [DBG] Began transaction with isolation level 'ReadCommitted'.
2022-09-23 15:08:19.029 +01:00 [DBG] Executing 2 update commands as a batch.
2022-09-23 15:08:19.030 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 15:08:19.035 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (5ms).
2022-09-23 15:08:19.039 +01:00 [DBG] Executing DbCommand [Parameters=[@p5='?' (DbType = Int32), @p0='?' (DbType = Boolean), @p1='?' (DbType = Boolean), @p2='?', @p3='?' (DbType = DateTime), @p4='?', @p12='?' (DbType = Int32), @p6='?' (DbType = DateTime), @p7='?', @p8='?', @p9='?' (DbType = DateTime), @p10='?', @p11='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE refresh_token SET is_active = @p0, is_revoked = @p1, reason_revoked = @p2, revoked = @p3, revoked_by_ip = @p4
WHERE id = @p5;
UPDATE users SET created_at = @p6, email = @p7, full_name = @p8, password_changed_at = @p9, password_hash = @p10, username = @p11
WHERE id = @p12;
2022-09-23 15:08:19.044 +01:00 [INF] Executed DbCommand (5ms) [Parameters=[@p5='?' (DbType = Int32), @p0='?' (DbType = Boolean), @p1='?' (DbType = Boolean), @p2='?', @p3='?' (DbType = DateTime), @p4='?', @p12='?' (DbType = Int32), @p6='?' (DbType = DateTime), @p7='?', @p8='?', @p9='?' (DbType = DateTime), @p10='?', @p11='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE refresh_token SET is_active = @p0, is_revoked = @p1, reason_revoked = @p2, revoked = @p3, revoked_by_ip = @p4
WHERE id = @p5;
UPDATE users SET created_at = @p6, email = @p7, full_name = @p8, password_changed_at = @p9, password_hash = @p10, username = @p11
WHERE id = @p12;
2022-09-23 15:08:19.046 +01:00 [DBG] A data reader was disposed.
2022-09-23 15:08:19.047 +01:00 [DBG] Committing transaction.
2022-09-23 15:08:19.048 +01:00 [DBG] Committed transaction.
2022-09-23 15:08:19.049 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:08:19.050 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 15:08:19.052 +01:00 [DBG] Disposing transaction.
2022-09-23 15:08:19.055 +01:00 [DBG] An entity of type 'User' tracked by 'PostgresContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 15:08:19.060 +01:00 [DBG] An entity of type 'RefreshToken' tracked by 'PostgresContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 15:08:19.067 +01:00 [DBG] SaveChanges completed for 'PostgresContext' with 2 entities written to the database.
2022-09-23 15:08:19.070 +01:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2022-09-23 15:08:19.073 +01:00 [DBG] No information found on request to perform content negotiation.
2022-09-23 15:08:19.074 +01:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2022-09-23 15:08:19.075 +01:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2022-09-23 15:08:19.075 +01:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2022-09-23 15:08:19.076 +01:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType0`1[[System.String, System.Private.CoreLib, Version=6.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2022-09-23 15:08:19.080 +01:00 [INF] Executed action APIBank.Controllers.UsersController.RevokeToken (APIBank) in 48548.9729ms
2022-09-23 15:08:19.081 +01:00 [INF] Executed endpoint 'APIBank.Controllers.UsersController.RevokeToken (APIBank)'
2022-09-23 15:08:19.083 +01:00 [DBG] 'PostgresContext' disposed.
2022-09-23 15:08:19.084 +01:00 [INF] Request finished HTTP/2 POST https://localhost:7036/api/Users/revoke-token - 0 - 200 - application/json;+charset=utf-8 48754.8121ms
2022-09-23 15:08:27.032 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/api/Users/1/refresh-tokens - -
2022-09-23 15:08:27.036 +01:00 [DBG] 1 candidate(s) found for the request path '/api/Users/1/refresh-tokens'
2022-09-23 15:08:27.037 +01:00 [DBG] Endpoint 'APIBank.Controllers.UsersController.GetRefreshTokens (APIBank)' with route pattern 'api/Users/{id}/refresh-tokens' is valid for the request path '/api/Users/1/refresh-tokens'
2022-09-23 15:08:27.038 +01:00 [DBG] Request matched endpoint 'APIBank.Controllers.UsersController.GetRefreshTokens (APIBank)'
2022-09-23 15:08:27.039 +01:00 [DBG] Static files was skipped as the request already matched an endpoint.
2022-09-23 15:08:27.045 +01:00 [INF] Entity Framework Core 6.0.9 initialized 'PostgresContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:6.0.7+5b98e4b74de93b590b44aef8dd7967c03acc433c' with options: None
2022-09-23 15:08:27.063 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 15:08:27.071 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (7ms).
2022-09-23 15:08:27.072 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 15:08:27.074 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:08:27.083 +01:00 [DBG] Executing DbCommand [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.id = @__p_0
LIMIT 1
2022-09-23 15:08:27.138 +01:00 [INF] Executed DbCommand (55ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.id = @__p_0
LIMIT 1
2022-09-23 15:08:27.145 +01:00 [DBG] Context 'PostgresContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 15:08:27.151 +01:00 [DBG] A data reader was disposed.
2022-09-23 15:08:27.155 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:08:27.156 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 15:08:27.165 +01:00 [INF] Executing endpoint 'APIBank.Controllers.UsersController.GetRefreshTokens (APIBank)'
2022-09-23 15:08:27.167 +01:00 [INF] Route matched with {action = "GetRefreshTokens", controller = "Users"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult GetRefreshTokens(Int32) on controller APIBank.Controllers.UsersController (APIBank).
2022-09-23 15:08:27.169 +01:00 [DBG] Execution plan of authorization filters (in the following order): ["APIBank.Authorization.AuthorizeAttribute"]
2022-09-23 15:08:27.171 +01:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2022-09-23 15:08:27.180 +01:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2022-09-23 15:08:27.223 +01:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2022-09-23 15:08:27.246 +01:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2022-09-23 15:08:27.256 +01:00 [DBG] Executing controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-23 15:08:27.257 +01:00 [DBG] Executed controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-23 15:08:27.263 +01:00 [DBG] Attempting to bind parameter 'id' of type 'System.Int32' ...
2022-09-23 15:08:27.269 +01:00 [DBG] Attempting to bind parameter 'id' of type 'System.Int32' using the name 'id' in request data ...
2022-09-23 15:08:27.271 +01:00 [DBG] Done attempting to bind parameter 'id' of type 'System.Int32'.
2022-09-23 15:08:27.272 +01:00 [DBG] Done attempting to bind parameter 'id' of type 'System.Int32'.
2022-09-23 15:08:27.273 +01:00 [DBG] Attempting to validate the bound parameter 'id' of type 'System.Int32' ...
2022-09-23 15:08:27.275 +01:00 [DBG] Done attempting to validate the bound parameter 'id' of type 'System.Int32'.
2022-09-23 15:08:27.279 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 15:08:27.280 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2022-09-23 15:08:27.287 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 15:08:27.306 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:08:27.340 +01:00 [DBG] Executing DbCommand [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id, r.created, r.created_by_ip, r.expires, r.is_active, r.is_expired, r.is_revoked, r.reason_revoked, r.token, r.replaced_by_token, r.revoked, r.revoked_by_ip, r.user_id
FROM refresh_token AS r
WHERE r.id = @__p_0
LIMIT 1
2022-09-23 15:08:27.356 +01:00 [INF] Executed DbCommand (16ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id, r.created, r.created_by_ip, r.expires, r.is_active, r.is_expired, r.is_revoked, r.reason_revoked, r.token, r.replaced_by_token, r.revoked, r.revoked_by_ip, r.user_id
FROM refresh_token AS r
WHERE r.id = @__p_0
LIMIT 1
2022-09-23 15:08:27.378 +01:00 [DBG] Context 'PostgresContext' started tracking 'RefreshToken' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 15:08:27.380 +01:00 [DBG] A data reader was disposed.
2022-09-23 15:08:27.381 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:08:27.383 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 15:08:27.387 +01:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2022-09-23 15:08:27.391 +01:00 [DBG] No information found on request to perform content negotiation.
2022-09-23 15:08:27.395 +01:00 [DBG] Attempting to select the first output formatter in the output formatters list which supports a content type from the explicitly specified content types '["application/problem+json","application/problem+xml","application/problem+json","application/problem+xml"]'.
2022-09-23 15:08:27.413 +01:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/problem+json' to write the response.
2022-09-23 15:08:27.429 +01:00 [INF] Executing ObjectResult, writing value of type 'Microsoft.AspNetCore.Mvc.ProblemDetails'.
2022-09-23 15:08:27.433 +01:00 [INF] Executed action APIBank.Controllers.UsersController.GetRefreshTokens (APIBank) in 177.077ms
2022-09-23 15:08:27.435 +01:00 [INF] Executed endpoint 'APIBank.Controllers.UsersController.GetRefreshTokens (APIBank)'
2022-09-23 15:08:27.436 +01:00 [DBG] 'PostgresContext' disposed.
2022-09-23 15:08:27.438 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/api/Users/1/refresh-tokens - - - 401 - application/problem+json;+charset=utf-8 448.5508ms
2022-09-23 15:11:45.972 +01:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2022-09-23 15:11:46.295 +01:00 [DBG] Hosting starting
2022-09-23 15:11:46.695 +01:00 [DBG] Using development certificate: CN=localhost (Thumbprint: 9CC642E9838495A6C3C202DECA6A8AD300396DD2)
2022-09-23 15:11:47.018 +01:00 [INF] Now listening on: https://localhost:7036
2022-09-23 15:11:47.224 +01:00 [INF] Now listening on: http://localhost:5036
2022-09-23 15:11:47.225 +01:00 [DBG] Loaded hosting startup assembly APIBank
2022-09-23 15:11:47.228 +01:00 [DBG] Loaded hosting startup assembly Microsoft.AspNetCore.Watch.BrowserRefresh
2022-09-23 15:11:47.230 +01:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.BrowserLink.Net
2022-09-23 15:11:47.231 +01:00 [INF] Application started. Press Ctrl+C to shut down.
2022-09-23 15:11:47.232 +01:00 [INF] Hosting environment: Development
2022-09-23 15:11:47.233 +01:00 [INF] Content root path: C:\Users\mguedesa\OneDrive - NTT DATA EMEAL\Documentos\GitHub\OpenBankAPI-NTT\APIBank\APIBank\
2022-09-23 15:11:47.238 +01:00 [DBG] Hosting started
2022-09-23 15:11:47.469 +01:00 [DBG] Connection id "0HMKTDM6LFRH4" received FIN.
2022-09-23 15:11:47.469 +01:00 [DBG] Connection id "0HMKTDM6LFRH5" received FIN.
2022-09-23 15:11:47.482 +01:00 [DBG] Connection id "0HMKTDM6LFRH4" accepted.
2022-09-23 15:11:47.482 +01:00 [DBG] Connection id "0HMKTDM6LFRH5" accepted.
2022-09-23 15:11:47.485 +01:00 [DBG] Connection id "0HMKTDM6LFRH4" started.
2022-09-23 15:11:47.485 +01:00 [DBG] Connection id "0HMKTDM6LFRH5" started.
2022-09-23 15:11:47.512 +01:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException:  Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveBlobAsync[TIOAdapter](TIOAdapter adapter)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](TIOAdapter adapter, Boolean receiveFirst, Byte[] reAuthenticationData, Boolean isApm)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2022-09-23 15:11:47.512 +01:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException:  Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveBlobAsync[TIOAdapter](TIOAdapter adapter)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](TIOAdapter adapter, Boolean receiveFirst, Byte[] reAuthenticationData, Boolean isApm)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2022-09-23 15:11:47.566 +01:00 [DBG] Connection id "0HMKTDM6LFRH5" stopped.
2022-09-23 15:11:47.566 +01:00 [DBG] Connection id "0HMKTDM6LFRH4" stopped.
2022-09-23 15:11:47.571 +01:00 [DBG] Connection id "0HMKTDM6LFRH4" sending FIN because: "The Socket transport's send loop completed gracefully."
2022-09-23 15:11:47.571 +01:00 [DBG] Connection id "0HMKTDM6LFRH5" sending FIN because: "The Socket transport's send loop completed gracefully."
2022-09-23 15:11:47.858 +01:00 [DBG] Connection id "0HMKTDM6LFRH6" accepted.
2022-09-23 15:11:47.867 +01:00 [DBG] Connection id "0HMKTDM6LFRH6" started.
2022-09-23 15:11:47.977 +01:00 [DBG] Connection 0HMKTDM6LFRH6 established using the following protocol: "Tls12"
2022-09-23 15:11:48.175 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/swagger/index.html - -
2022-09-23 15:11:48.316 +01:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2022-09-23 15:11:48.408 +01:00 [DBG] No candidates found for the request path '/swagger/index.html'
2022-09-23 15:11:48.411 +01:00 [DBG] Request did not match any endpoints
2022-09-23 15:11:48.633 +01:00 [DBG] Response markup is scheduled to include browser refresh script injection.
2022-09-23 15:11:48.851 +01:00 [DBG] Response markup was updated to include browser refresh script injection.
2022-09-23 15:11:48.861 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/swagger/index.html - - - 200 - text/html;charset=utf-8 695.5815ms
2022-09-23 15:11:48.888 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/_vs/browserLink - -
2022-09-23 15:11:48.890 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/_framework/aspnetcore-browser-refresh.js - -
2022-09-23 15:11:48.901 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/_framework/aspnetcore-browser-refresh.js - - - 200 11984 application/javascript;+charset=utf-8 10.3473ms
2022-09-23 15:11:48.941 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/_vs/browserLink - - - 200 - text/javascript;+charset=UTF-8 52.2500ms
2022-09-23 15:11:49.042 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/swagger/v1/swagger.json - -
2022-09-23 15:11:49.044 +01:00 [DBG] No candidates found for the request path '/swagger/v1/swagger.json'
2022-09-23 15:11:49.045 +01:00 [DBG] Request did not match any endpoints
2022-09-23 15:11:49.261 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/swagger/v1/swagger.json - - - 200 - application/json;charset=utf-8 218.9538ms
2022-09-23 15:12:09.820 +01:00 [INF] Request starting HTTP/2 POST https://localhost:7036/api/Users/Login application/json 58
2022-09-23 15:12:09.837 +01:00 [DBG] 1 candidate(s) found for the request path '/api/Users/Login'
2022-09-23 15:12:09.845 +01:00 [DBG] Endpoint 'APIBank.Controllers.UsersController.Login (APIBank)' with route pattern 'api/Users/Login' is valid for the request path '/api/Users/Login'
2022-09-23 15:12:09.847 +01:00 [DBG] Request matched endpoint 'APIBank.Controllers.UsersController.Login (APIBank)'
2022-09-23 15:12:09.849 +01:00 [DBG] Static files was skipped as the request already matched an endpoint.
2022-09-23 15:12:10.359 +01:00 [INF] Executing endpoint 'APIBank.Controllers.UsersController.Login (APIBank)'
2022-09-23 15:12:10.382 +01:00 [INF] Route matched with {action = "Login", controller = "Users"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult Login(APIBank.Models.Requests.UserLoginRequest) on controller APIBank.Controllers.UsersController (APIBank).
2022-09-23 15:12:10.387 +01:00 [DBG] Execution plan of authorization filters (in the following order): ["APIBank.Authorization.AuthorizeAttribute"]
2022-09-23 15:12:10.390 +01:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2022-09-23 15:12:10.391 +01:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2022-09-23 15:12:10.393 +01:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2022-09-23 15:12:10.395 +01:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2022-09-23 15:12:10.398 +01:00 [DBG] Executing controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-23 15:12:10.400 +01:00 [DBG] Executed controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-23 15:12:10.426 +01:00 [DBG] Attempting to bind parameter 'model' of type 'APIBank.Models.Requests.UserLoginRequest' ...
2022-09-23 15:12:10.430 +01:00 [DBG] Attempting to bind parameter 'model' of type 'APIBank.Models.Requests.UserLoginRequest' using the name '' in request data ...
2022-09-23 15:12:10.432 +01:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2022-09-23 15:12:10.444 +01:00 [DBG] Connection id "0HMKTDM6LFRH6", Request id "0HMKTDM6LFRH6:00000009": started reading request body.
2022-09-23 15:12:10.445 +01:00 [DBG] Connection id "0HMKTDM6LFRH6", Request id "0HMKTDM6LFRH6:00000009": done reading request body.
2022-09-23 15:12:10.455 +01:00 [DBG] JSON input formatter succeeded, deserializing to type 'APIBank.Models.Requests.UserLoginRequest'
2022-09-23 15:12:10.457 +01:00 [DBG] Done attempting to bind parameter 'model' of type 'APIBank.Models.Requests.UserLoginRequest'.
2022-09-23 15:12:10.458 +01:00 [DBG] Done attempting to bind parameter 'model' of type 'APIBank.Models.Requests.UserLoginRequest'.
2022-09-23 15:12:10.458 +01:00 [DBG] Attempting to validate the bound parameter 'model' of type 'APIBank.Models.Requests.UserLoginRequest' ...
2022-09-23 15:12:10.473 +01:00 [DBG] Done attempting to validate the bound parameter 'model' of type 'APIBank.Models.Requests.UserLoginRequest'.
2022-09-23 15:12:10.599 +01:00 [DBG] An additional 'IServiceProvider' was created for internal use by Entity Framework. An existing service provider was not used due to the following configuration changes: configuration changed for 'Core:ConfigureWarnings', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:UseAdminDatabase', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:SetPostgresVersion', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:UseRedshift', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:ReverseNullOrdering', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:RemoteCertificateValidationCallback', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:ProvideClientCertificatesCallback', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:ProvidePasswordCallback'.
2022-09-23 15:12:12.173 +01:00 [INF] Entity Framework Core 6.0.9 initialized 'PostgresContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:6.0.7+5b98e4b74de93b590b44aef8dd7967c03acc433c' with options: None
2022-09-23 15:12:12.258 +01:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .SingleOrDefault(x => x.Username == __model_Username_0)'
2022-09-23 15:12:12.796 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<User>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: User.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: User.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 1], [Property: User.Email (string) Required Index MaxLength(254), 2], [Property: User.FullName (string) Required MaxLength(100), 3], [Property: User.PasswordChangedAt (DateTime) Required ValueGenerated.OnAdd, 4], [Property: User.PasswordHash (string) Required MaxLength(200), 5], [Property: User.Username (string) Required Index MaxLength(50), 6] }
        SELECT TOP(2) u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
        FROM users AS u
        WHERE u.username == @__model_Username_0), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, User>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)
    .SingleOrDefault()'
2022-09-23 15:12:12.855 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 15:12:12.956 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (97ms).
2022-09-23 15:12:12.968 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 15:12:13.265 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:12:13.287 +01:00 [DBG] Executing DbCommand [Parameters=[@__model_Username_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.username = @__model_Username_0
LIMIT 2
2022-09-23 15:12:13.418 +01:00 [INF] Executed DbCommand (137ms) [Parameters=[@__model_Username_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.username = @__model_Username_0
LIMIT 2
2022-09-23 15:12:13.478 +01:00 [DBG] Context 'PostgresContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 15:12:13.544 +01:00 [DBG] A data reader was disposed.
2022-09-23 15:12:13.556 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:12:13.577 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 15:12:13.786 +01:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .Any(user => user.RefreshTokenCollection
        .Any(reftoken => reftoken.RefToken == __token_0))'
2022-09-23 15:12:13.942 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<bool>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            EmptyProjectionMember -> 0
        SELECT EXISTS (
            SELECT 1
            FROM users AS u
            WHERE EXISTS (
                SELECT 1
                FROM refresh_token AS r
                WHERE ((u.id != NULL) && (u.id == r.user_id)) && (r.token == @__token_0)))), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, bool>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)
    .Single()'
2022-09-23 15:12:13.962 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 15:12:13.964 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2022-09-23 15:12:13.967 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 15:12:13.968 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:12:13.972 +01:00 [DBG] Executing DbCommand [Parameters=[@__token_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM users AS u
    WHERE EXISTS (
        SELECT 1
        FROM refresh_token AS r
        WHERE (u.id = r.user_id) AND (r.token = @__token_0)))
2022-09-23 15:12:13.977 +01:00 [INF] Executed DbCommand (5ms) [Parameters=[@__token_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM users AS u
    WHERE EXISTS (
        SELECT 1
        FROM refresh_token AS r
        WHERE (u.id = r.user_id) AND (r.token = @__token_0)))
2022-09-23 15:12:13.987 +01:00 [DBG] A data reader was disposed.
2022-09-23 15:12:13.988 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:12:13.989 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 15:12:13.995 +01:00 [DBG] SaveChanges starting for 'PostgresContext'.
2022-09-23 15:12:14.005 +01:00 [DBG] DetectChanges starting for 'PostgresContext'.
2022-09-23 15:12:14.042 +01:00 [DBG] 1 entities were added and 0 entities were removed from navigation 'User.RefreshTokenCollection'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 15:12:14.090 +01:00 [DBG] 'PostgresContext' generated a temporary value for the property 'Id.RefreshToken'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 15:12:14.148 +01:00 [DBG] Context 'PostgresContext' started tracking 'RefreshToken' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 15:12:14.155 +01:00 [DBG] DetectChanges completed for 'PostgresContext'.
2022-09-23 15:12:14.164 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 15:12:14.165 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:12:14.169 +01:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2022-09-23 15:12:14.179 +01:00 [DBG] Began transaction with isolation level 'ReadCommitted'.
2022-09-23 15:12:14.261 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 15:12:14.264 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (3ms).
2022-09-23 15:12:14.268 +01:00 [DBG] Executing DbCommand [Parameters=[@p0='?' (DbType = DateTime), @p1='?', @p2='?' (DbType = DateTime), @p3='?' (DbType = Boolean), @p4='?' (DbType = Boolean), @p5='?' (DbType = Boolean), @p6='?', @p7='?', @p8='?', @p9='?' (DbType = DateTime), @p10='?', @p11='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO refresh_token (created, created_by_ip, expires, is_active, is_expired, is_revoked, reason_revoked, token, replaced_by_token, revoked, revoked_by_ip, user_id)
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11)
RETURNING id;
2022-09-23 15:12:14.294 +01:00 [INF] Executed DbCommand (26ms) [Parameters=[@p0='?' (DbType = DateTime), @p1='?', @p2='?' (DbType = DateTime), @p3='?' (DbType = Boolean), @p4='?' (DbType = Boolean), @p5='?' (DbType = Boolean), @p6='?', @p7='?', @p8='?', @p9='?' (DbType = DateTime), @p10='?', @p11='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO refresh_token (created, created_by_ip, expires, is_active, is_expired, is_revoked, reason_revoked, token, replaced_by_token, revoked, revoked_by_ip, user_id)
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11)
RETURNING id;
2022-09-23 15:12:14.323 +01:00 [DBG] The foreign key property 'RefreshToken.Id' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2022-09-23 15:12:14.335 +01:00 [DBG] A data reader was disposed.
2022-09-23 15:12:14.342 +01:00 [DBG] Committing transaction.
2022-09-23 15:12:14.354 +01:00 [DBG] Committed transaction.
2022-09-23 15:12:14.357 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:12:14.359 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 15:12:14.362 +01:00 [DBG] Disposing transaction.
2022-09-23 15:12:14.375 +01:00 [DBG] An entity of type 'RefreshToken' tracked by 'PostgresContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 15:12:14.378 +01:00 [DBG] SaveChanges completed for 'PostgresContext' with 1 entities written to the database.
2022-09-23 15:12:14.650 +01:00 [DBG] Compiling query expression: 
'DbSet<RefreshToken>()
    .Where(rt => rt.UserId == __id_0)
    .AsNoTracking()
    .Select(rt => new RefreshToken{ 
        Id = rt.Id, 
        UserId = rt.UserId, 
        RefToken = rt.RefToken, 
        Expires = rt.Expires, 
        Created = rt.Created, 
        CreatedByIp = rt.CreatedByIp, 
        Revoked = rt.Revoked, 
        RevokedByIp = rt.RevokedByIp, 
        ReplacedByToken = rt.ReplacedByToken, 
        ReasonRevoked = rt.ReasonRevoked, 
        IsExpired = rt.IsExpired, 
        IsRevoked = rt.IsRevoked, 
        IsActive = rt.IsActive 
    }
    )'
2022-09-23 15:12:14.679 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<RefreshToken>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            Id -> 0
            UserId -> 1
            RefToken -> 2
            Expires -> 3
            Created -> 4
            CreatedByIp -> 5
            Revoked -> 6
            RevokedByIp -> 7
            ReplacedByToken -> 8
            ReasonRevoked -> 9
            IsExpired -> 10
            IsRevoked -> 11
            IsActive -> 12
        SELECT r.id AS Id, r.user_id AS UserId, r.token AS RefToken, r.expires AS Expires, r.created AS Created, r.created_by_ip AS CreatedByIp, r.revoked AS Revoked, r.revoked_by_ip AS RevokedByIp, r.replaced_by_token AS ReplacedByToken, r.reason_revoked AS ReasonRevoked, r.is_expired AS IsExpired, r.is_revoked AS IsRevoked, r.is_active AS IsActive
        FROM refresh_token AS r
        WHERE r.user_id == @__id_0), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, RefreshToken>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)'
2022-09-23 15:12:14.685 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 15:12:14.686 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2022-09-23 15:12:14.687 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 15:12:14.688 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:12:14.689 +01:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.user_id AS "UserId", r.token AS "RefToken", r.expires AS "Expires", r.created AS "Created", r.created_by_ip AS "CreatedByIp", r.revoked AS "Revoked", r.revoked_by_ip AS "RevokedByIp", r.replaced_by_token AS "ReplacedByToken", r.reason_revoked AS "ReasonRevoked", r.is_expired AS "IsExpired", r.is_revoked AS "IsRevoked", r.is_active AS "IsActive"
FROM refresh_token AS r
WHERE r.user_id = @__id_0
2022-09-23 15:12:14.691 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.user_id AS "UserId", r.token AS "RefToken", r.expires AS "Expires", r.created AS "Created", r.created_by_ip AS "CreatedByIp", r.revoked AS "Revoked", r.revoked_by_ip AS "RevokedByIp", r.replaced_by_token AS "ReplacedByToken", r.reason_revoked AS "ReasonRevoked", r.is_expired AS "IsExpired", r.is_revoked AS "IsRevoked", r.is_active AS "IsActive"
FROM refresh_token AS r
WHERE r.user_id = @__id_0
2022-09-23 15:12:14.693 +01:00 [DBG] A data reader was disposed.
2022-09-23 15:12:14.694 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:12:14.695 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 15:12:14.699 +01:00 [DBG] An entity of type 'User' tracked by 'PostgresContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 15:12:14.702 +01:00 [DBG] An entity of type 'RefreshToken' tracked by 'PostgresContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 15:12:14.703 +01:00 [DBG] SaveChanges starting for 'PostgresContext'.
2022-09-23 15:12:14.704 +01:00 [DBG] DetectChanges starting for 'PostgresContext'.
2022-09-23 15:12:14.705 +01:00 [DBG] DetectChanges completed for 'PostgresContext'.
2022-09-23 15:12:14.706 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 15:12:14.707 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:12:14.708 +01:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2022-09-23 15:12:14.708 +01:00 [DBG] Began transaction with isolation level 'ReadCommitted'.
2022-09-23 15:12:14.727 +01:00 [DBG] Executing 2 update commands as a batch.
2022-09-23 15:12:14.734 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 15:12:14.735 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2022-09-23 15:12:14.737 +01:00 [DBG] Executing DbCommand [Parameters=[@p12='?' (DbType = Int32), @p0='?' (DbType = DateTime), @p1='?', @p2='?' (DbType = DateTime), @p3='?' (DbType = Boolean), @p4='?' (DbType = Boolean), @p5='?' (DbType = Boolean), @p6='?', @p7='?', @p8='?', @p9='?' (DbType = DateTime), @p10='?', @p11='?' (DbType = Int32), @p19='?' (DbType = Int32), @p13='?' (DbType = DateTime), @p14='?', @p15='?', @p16='?' (DbType = DateTime), @p17='?', @p18='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE refresh_token SET created = @p0, created_by_ip = @p1, expires = @p2, is_active = @p3, is_expired = @p4, is_revoked = @p5, reason_revoked = @p6, token = @p7, replaced_by_token = @p8, revoked = @p9, revoked_by_ip = @p10, user_id = @p11
WHERE id = @p12;
UPDATE users SET created_at = @p13, email = @p14, full_name = @p15, password_changed_at = @p16, password_hash = @p17, username = @p18
WHERE id = @p19;
2022-09-23 15:12:14.741 +01:00 [INF] Executed DbCommand (4ms) [Parameters=[@p12='?' (DbType = Int32), @p0='?' (DbType = DateTime), @p1='?', @p2='?' (DbType = DateTime), @p3='?' (DbType = Boolean), @p4='?' (DbType = Boolean), @p5='?' (DbType = Boolean), @p6='?', @p7='?', @p8='?', @p9='?' (DbType = DateTime), @p10='?', @p11='?' (DbType = Int32), @p19='?' (DbType = Int32), @p13='?' (DbType = DateTime), @p14='?', @p15='?', @p16='?' (DbType = DateTime), @p17='?', @p18='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE refresh_token SET created = @p0, created_by_ip = @p1, expires = @p2, is_active = @p3, is_expired = @p4, is_revoked = @p5, reason_revoked = @p6, token = @p7, replaced_by_token = @p8, revoked = @p9, revoked_by_ip = @p10, user_id = @p11
WHERE id = @p12;
UPDATE users SET created_at = @p13, email = @p14, full_name = @p15, password_changed_at = @p16, password_hash = @p17, username = @p18
WHERE id = @p19;
2022-09-23 15:12:14.743 +01:00 [DBG] A data reader was disposed.
2022-09-23 15:12:14.743 +01:00 [DBG] Committing transaction.
2022-09-23 15:12:14.744 +01:00 [DBG] Committed transaction.
2022-09-23 15:12:14.746 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:12:14.749 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 15:12:14.750 +01:00 [DBG] Disposing transaction.
2022-09-23 15:12:14.751 +01:00 [DBG] An entity of type 'User' tracked by 'PostgresContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 15:12:14.753 +01:00 [DBG] An entity of type 'RefreshToken' tracked by 'PostgresContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 15:12:14.754 +01:00 [DBG] SaveChanges completed for 'PostgresContext' with 2 entities written to the database.
2022-09-23 15:12:14.759 +01:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2022-09-23 15:12:14.767 +01:00 [DBG] Attempting to select an output formatter based on Accept header '["text/plain"]'.
2022-09-23 15:12:14.768 +01:00 [DBG] Could not find an output formatter based on content negotiation. Accepted types were (["text/plain"])
2022-09-23 15:12:14.770 +01:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2022-09-23 15:12:14.770 +01:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2022-09-23 15:12:14.771 +01:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2022-09-23 15:12:14.773 +01:00 [INF] Executing OkObjectResult, writing value of type 'APIBank.Models.MyRequestResponses.LoginResponse'.
2022-09-23 15:12:14.796 +01:00 [INF] Executed action APIBank.Controllers.UsersController.Login (APIBank) in 4391.4367ms
2022-09-23 15:12:14.801 +01:00 [INF] Executed endpoint 'APIBank.Controllers.UsersController.Login (APIBank)'
2022-09-23 15:12:14.810 +01:00 [DBG] 'PostgresContext' disposed.
2022-09-23 15:12:14.820 +01:00 [INF] Request finished HTTP/2 POST https://localhost:7036/api/Users/Login application/json 58 - 200 - application/json;+charset=utf-8 4999.8488ms
2022-09-23 15:12:55.432 +01:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2022-09-23 15:12:55.518 +01:00 [DBG] Hosting starting
2022-09-23 15:12:55.603 +01:00 [DBG] Using development certificate: CN=localhost (Thumbprint: 9CC642E9838495A6C3C202DECA6A8AD300396DD2)
2022-09-23 15:12:55.642 +01:00 [INF] Now listening on: https://localhost:7036
2022-09-23 15:12:55.644 +01:00 [INF] Now listening on: http://localhost:5036
2022-09-23 15:12:55.646 +01:00 [DBG] Loaded hosting startup assembly APIBank
2022-09-23 15:12:55.647 +01:00 [DBG] Loaded hosting startup assembly Microsoft.AspNetCore.Watch.BrowserRefresh
2022-09-23 15:12:55.647 +01:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.BrowserLink.Net
2022-09-23 15:12:55.648 +01:00 [INF] Application started. Press Ctrl+C to shut down.
2022-09-23 15:12:55.649 +01:00 [INF] Hosting environment: Development
2022-09-23 15:12:55.650 +01:00 [INF] Content root path: C:\Users\mguedesa\OneDrive - NTT DATA EMEAL\Documentos\GitHub\OpenBankAPI-NTT\APIBank\APIBank\
2022-09-23 15:12:55.650 +01:00 [DBG] Hosting started
2022-09-23 15:12:56.093 +01:00 [DBG] Connection id "0HMKTDMR3TTPV" accepted.
2022-09-23 15:12:56.093 +01:00 [DBG] Connection id "0HMKTDMR3TTQ0" accepted.
2022-09-23 15:12:56.097 +01:00 [DBG] Connection id "0HMKTDMR3TTPV" started.
2022-09-23 15:12:56.098 +01:00 [DBG] Connection id "0HMKTDMR3TTQ0" started.
2022-09-23 15:12:56.106 +01:00 [DBG] Connection id "0HMKTDMR3TTPV" received FIN.
2022-09-23 15:12:56.106 +01:00 [DBG] Connection id "0HMKTDMR3TTQ0" received FIN.
2022-09-23 15:12:56.111 +01:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException:  Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.<FillHandshakeBufferAsync>g__InternalFillHandshakeBufferAsync|189_0[TIOAdapter](TIOAdapter adap, ValueTask`1 task, Int32 minSize)
   at System.Net.Security.SslStream.ReceiveBlobAsync[TIOAdapter](TIOAdapter adapter)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](TIOAdapter adapter, Boolean receiveFirst, Byte[] reAuthenticationData, Boolean isApm)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2022-09-23 15:12:56.111 +01:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException:  Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveBlobAsync[TIOAdapter](TIOAdapter adapter)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](TIOAdapter adapter, Boolean receiveFirst, Byte[] reAuthenticationData, Boolean isApm)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2022-09-23 15:12:56.131 +01:00 [DBG] Connection id "0HMKTDMR3TTPV" stopped.
2022-09-23 15:12:56.131 +01:00 [DBG] Connection id "0HMKTDMR3TTQ0" stopped.
2022-09-23 15:12:56.133 +01:00 [DBG] Connection id "0HMKTDMR3TTQ0" sending FIN because: "The Socket transport's send loop completed gracefully."
2022-09-23 15:12:56.133 +01:00 [DBG] Connection id "0HMKTDMR3TTPV" sending FIN because: "The Socket transport's send loop completed gracefully."
2022-09-23 15:12:56.653 +01:00 [DBG] Connection id "0HMKTDMR3TTQ1" accepted.
2022-09-23 15:12:56.656 +01:00 [DBG] Connection id "0HMKTDMR3TTQ1" started.
2022-09-23 15:12:56.724 +01:00 [DBG] Connection 0HMKTDMR3TTQ1 established using the following protocol: "Tls12"
2022-09-23 15:12:56.795 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/swagger/index.html - -
2022-09-23 15:12:56.831 +01:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2022-09-23 15:12:56.865 +01:00 [DBG] No candidates found for the request path '/swagger/index.html'
2022-09-23 15:12:56.867 +01:00 [DBG] Request did not match any endpoints
2022-09-23 15:12:56.974 +01:00 [DBG] Response markup is scheduled to include browser refresh script injection.
2022-09-23 15:12:57.074 +01:00 [DBG] Response markup was updated to include browser refresh script injection.
2022-09-23 15:12:57.078 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/swagger/index.html - - - 200 - text/html;charset=utf-8 287.0038ms
2022-09-23 15:12:57.108 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/_framework/aspnetcore-browser-refresh.js - -
2022-09-23 15:12:57.113 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/_vs/browserLink - -
2022-09-23 15:12:57.117 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/_framework/aspnetcore-browser-refresh.js - - - 200 11984 application/javascript;+charset=utf-8 8.4918ms
2022-09-23 15:12:57.139 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/_vs/browserLink - - - 200 - text/javascript;+charset=UTF-8 26.4250ms
2022-09-23 15:12:57.259 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/swagger/v1/swagger.json - -
2022-09-23 15:12:57.262 +01:00 [DBG] No candidates found for the request path '/swagger/v1/swagger.json'
2022-09-23 15:12:57.263 +01:00 [DBG] Request did not match any endpoints
2022-09-23 15:12:57.428 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/swagger/v1/swagger.json - - - 200 - application/json;charset=utf-8 168.2638ms
2022-09-23 15:13:06.906 +01:00 [INF] Request starting HTTP/2 POST https://localhost:7036/api/Users/Login application/json 58
2022-09-23 15:13:06.916 +01:00 [DBG] 1 candidate(s) found for the request path '/api/Users/Login'
2022-09-23 15:13:06.926 +01:00 [DBG] Endpoint 'APIBank.Controllers.UsersController.Login (APIBank)' with route pattern 'api/Users/Login' is valid for the request path '/api/Users/Login'
2022-09-23 15:13:06.930 +01:00 [DBG] Request matched endpoint 'APIBank.Controllers.UsersController.Login (APIBank)'
2022-09-23 15:13:06.933 +01:00 [DBG] Static files was skipped as the request already matched an endpoint.
2022-09-23 15:13:07.199 +01:00 [INF] Executing endpoint 'APIBank.Controllers.UsersController.Login (APIBank)'
2022-09-23 15:13:07.222 +01:00 [INF] Route matched with {action = "Login", controller = "Users"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult Login(APIBank.Models.Requests.UserLoginRequest) on controller APIBank.Controllers.UsersController (APIBank).
2022-09-23 15:13:07.228 +01:00 [DBG] Execution plan of authorization filters (in the following order): ["APIBank.Authorization.AuthorizeAttribute"]
2022-09-23 15:13:07.230 +01:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2022-09-23 15:13:07.231 +01:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2022-09-23 15:13:07.232 +01:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2022-09-23 15:13:07.233 +01:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2022-09-23 15:13:07.236 +01:00 [DBG] Executing controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-23 15:13:07.239 +01:00 [DBG] Executed controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-23 15:13:07.249 +01:00 [DBG] Attempting to bind parameter 'model' of type 'APIBank.Models.Requests.UserLoginRequest' ...
2022-09-23 15:13:07.252 +01:00 [DBG] Attempting to bind parameter 'model' of type 'APIBank.Models.Requests.UserLoginRequest' using the name '' in request data ...
2022-09-23 15:13:07.258 +01:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2022-09-23 15:13:07.263 +01:00 [DBG] Connection id "0HMKTDMR3TTQ1", Request id "0HMKTDMR3TTQ1:00000009": started reading request body.
2022-09-23 15:13:07.265 +01:00 [DBG] Connection id "0HMKTDMR3TTQ1", Request id "0HMKTDMR3TTQ1:00000009": done reading request body.
2022-09-23 15:13:07.270 +01:00 [DBG] JSON input formatter succeeded, deserializing to type 'APIBank.Models.Requests.UserLoginRequest'
2022-09-23 15:13:07.272 +01:00 [DBG] Done attempting to bind parameter 'model' of type 'APIBank.Models.Requests.UserLoginRequest'.
2022-09-23 15:13:07.273 +01:00 [DBG] Done attempting to bind parameter 'model' of type 'APIBank.Models.Requests.UserLoginRequest'.
2022-09-23 15:13:07.276 +01:00 [DBG] Attempting to validate the bound parameter 'model' of type 'APIBank.Models.Requests.UserLoginRequest' ...
2022-09-23 15:13:07.284 +01:00 [DBG] Done attempting to validate the bound parameter 'model' of type 'APIBank.Models.Requests.UserLoginRequest'.
2022-09-23 15:13:07.357 +01:00 [DBG] An additional 'IServiceProvider' was created for internal use by Entity Framework. An existing service provider was not used due to the following configuration changes: configuration changed for 'Core:ConfigureWarnings', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:UseAdminDatabase', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:SetPostgresVersion', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:UseRedshift', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:ReverseNullOrdering', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:RemoteCertificateValidationCallback', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:ProvideClientCertificatesCallback', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:ProvidePasswordCallback'.
2022-09-23 15:13:08.336 +01:00 [INF] Entity Framework Core 6.0.9 initialized 'PostgresContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:6.0.7+5b98e4b74de93b590b44aef8dd7967c03acc433c' with options: None
2022-09-23 15:13:08.380 +01:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .SingleOrDefault(x => x.Username == __model_Username_0)'
2022-09-23 15:13:08.610 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<User>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: User.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: User.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 1], [Property: User.Email (string) Required Index MaxLength(254), 2], [Property: User.FullName (string) Required MaxLength(100), 3], [Property: User.PasswordChangedAt (DateTime) Required ValueGenerated.OnAdd, 4], [Property: User.PasswordHash (string) Required MaxLength(200), 5], [Property: User.Username (string) Required Index MaxLength(50), 6] }
        SELECT TOP(2) u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
        FROM users AS u
        WHERE u.username == @__model_Username_0), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, User>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)
    .SingleOrDefault()'
2022-09-23 15:13:08.644 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 15:13:08.682 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (32ms).
2022-09-23 15:13:08.690 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 15:13:08.885 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:13:08.898 +01:00 [DBG] Executing DbCommand [Parameters=[@__model_Username_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.username = @__model_Username_0
LIMIT 2
2022-09-23 15:13:08.999 +01:00 [INF] Executed DbCommand (102ms) [Parameters=[@__model_Username_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.username = @__model_Username_0
LIMIT 2
2022-09-23 15:13:09.049 +01:00 [DBG] Context 'PostgresContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 15:13:09.102 +01:00 [DBG] A data reader was disposed.
2022-09-23 15:13:09.107 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:13:09.112 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 15:13:09.328 +01:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .Any(user => user.RefreshTokenCollection
        .Any(reftoken => reftoken.RefToken == __token_0))'
2022-09-23 15:13:09.387 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<bool>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            EmptyProjectionMember -> 0
        SELECT EXISTS (
            SELECT 1
            FROM users AS u
            WHERE EXISTS (
                SELECT 1
                FROM refresh_token AS r
                WHERE ((u.id != NULL) && (u.id == r.user_id)) && (r.token == @__token_0)))), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, bool>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)
    .Single()'
2022-09-23 15:13:09.398 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 15:13:09.400 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2022-09-23 15:13:09.404 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 15:13:09.405 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:13:09.406 +01:00 [DBG] Executing DbCommand [Parameters=[@__token_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM users AS u
    WHERE EXISTS (
        SELECT 1
        FROM refresh_token AS r
        WHERE (u.id = r.user_id) AND (r.token = @__token_0)))
2022-09-23 15:13:09.409 +01:00 [INF] Executed DbCommand (3ms) [Parameters=[@__token_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM users AS u
    WHERE EXISTS (
        SELECT 1
        FROM refresh_token AS r
        WHERE (u.id = r.user_id) AND (r.token = @__token_0)))
2022-09-23 15:13:09.411 +01:00 [DBG] A data reader was disposed.
2022-09-23 15:13:09.412 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:13:09.413 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 15:13:09.415 +01:00 [DBG] SaveChanges starting for 'PostgresContext'.
2022-09-23 15:13:09.417 +01:00 [DBG] DetectChanges starting for 'PostgresContext'.
2022-09-23 15:13:09.440 +01:00 [DBG] 1 entities were added and 0 entities were removed from navigation 'User.RefreshTokenCollection'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 15:13:09.474 +01:00 [DBG] 'PostgresContext' generated a temporary value for the property 'Id.RefreshToken'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 15:13:09.538 +01:00 [DBG] Context 'PostgresContext' started tracking 'RefreshToken' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 15:13:09.544 +01:00 [DBG] DetectChanges completed for 'PostgresContext'.
2022-09-23 15:13:09.555 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 15:13:09.559 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:13:09.561 +01:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2022-09-23 15:13:09.568 +01:00 [DBG] Began transaction with isolation level 'ReadCommitted'.
2022-09-23 15:13:09.629 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 15:13:09.632 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (3ms).
2022-09-23 15:13:09.634 +01:00 [DBG] Executing DbCommand [Parameters=[@p0='?' (DbType = DateTime), @p1='?', @p2='?' (DbType = DateTime), @p3='?' (DbType = Boolean), @p4='?' (DbType = Boolean), @p5='?' (DbType = Boolean), @p6='?', @p7='?', @p8='?', @p9='?' (DbType = DateTime), @p10='?', @p11='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO refresh_token (created, created_by_ip, expires, is_active, is_expired, is_revoked, reason_revoked, token, replaced_by_token, revoked, revoked_by_ip, user_id)
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11)
RETURNING id;
2022-09-23 15:13:09.644 +01:00 [INF] Executed DbCommand (10ms) [Parameters=[@p0='?' (DbType = DateTime), @p1='?', @p2='?' (DbType = DateTime), @p3='?' (DbType = Boolean), @p4='?' (DbType = Boolean), @p5='?' (DbType = Boolean), @p6='?', @p7='?', @p8='?', @p9='?' (DbType = DateTime), @p10='?', @p11='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO refresh_token (created, created_by_ip, expires, is_active, is_expired, is_revoked, reason_revoked, token, replaced_by_token, revoked, revoked_by_ip, user_id)
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11)
RETURNING id;
2022-09-23 15:13:09.657 +01:00 [DBG] The foreign key property 'RefreshToken.Id' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2022-09-23 15:13:09.665 +01:00 [DBG] A data reader was disposed.
2022-09-23 15:13:09.667 +01:00 [DBG] Committing transaction.
2022-09-23 15:13:09.673 +01:00 [DBG] Committed transaction.
2022-09-23 15:13:09.674 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:13:09.675 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 15:13:09.677 +01:00 [DBG] Disposing transaction.
2022-09-23 15:13:09.689 +01:00 [DBG] An entity of type 'RefreshToken' tracked by 'PostgresContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 15:13:09.692 +01:00 [DBG] SaveChanges completed for 'PostgresContext' with 1 entities written to the database.
2022-09-23 15:13:09.836 +01:00 [DBG] Compiling query expression: 
'DbSet<RefreshToken>()
    .Where(rt => rt.UserId == __id_0)
    .AsNoTracking()
    .Select(rt => new RefreshToken{ 
        Id = rt.Id, 
        UserId = rt.UserId, 
        RefToken = rt.RefToken, 
        Expires = rt.Expires, 
        Created = rt.Created, 
        CreatedByIp = rt.CreatedByIp, 
        Revoked = rt.Revoked, 
        RevokedByIp = rt.RevokedByIp, 
        ReplacedByToken = rt.ReplacedByToken, 
        ReasonRevoked = rt.ReasonRevoked, 
        IsExpired = rt.IsExpired, 
        IsRevoked = rt.IsRevoked, 
        IsActive = rt.IsActive 
    }
    )'
2022-09-23 15:13:09.858 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<RefreshToken>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            Id -> 0
            UserId -> 1
            RefToken -> 2
            Expires -> 3
            Created -> 4
            CreatedByIp -> 5
            Revoked -> 6
            RevokedByIp -> 7
            ReplacedByToken -> 8
            ReasonRevoked -> 9
            IsExpired -> 10
            IsRevoked -> 11
            IsActive -> 12
        SELECT r.id AS Id, r.user_id AS UserId, r.token AS RefToken, r.expires AS Expires, r.created AS Created, r.created_by_ip AS CreatedByIp, r.revoked AS Revoked, r.revoked_by_ip AS RevokedByIp, r.replaced_by_token AS ReplacedByToken, r.reason_revoked AS ReasonRevoked, r.is_expired AS IsExpired, r.is_revoked AS IsRevoked, r.is_active AS IsActive
        FROM refresh_token AS r
        WHERE r.user_id == @__id_0), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, RefreshToken>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)'
2022-09-23 15:13:09.861 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 15:13:09.863 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2022-09-23 15:13:09.865 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 15:13:09.866 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:13:09.867 +01:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.user_id AS "UserId", r.token AS "RefToken", r.expires AS "Expires", r.created AS "Created", r.created_by_ip AS "CreatedByIp", r.revoked AS "Revoked", r.revoked_by_ip AS "RevokedByIp", r.replaced_by_token AS "ReplacedByToken", r.reason_revoked AS "ReasonRevoked", r.is_expired AS "IsExpired", r.is_revoked AS "IsRevoked", r.is_active AS "IsActive"
FROM refresh_token AS r
WHERE r.user_id = @__id_0
2022-09-23 15:13:09.869 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.user_id AS "UserId", r.token AS "RefToken", r.expires AS "Expires", r.created AS "Created", r.created_by_ip AS "CreatedByIp", r.revoked AS "Revoked", r.revoked_by_ip AS "RevokedByIp", r.replaced_by_token AS "ReplacedByToken", r.reason_revoked AS "ReasonRevoked", r.is_expired AS "IsExpired", r.is_revoked AS "IsRevoked", r.is_active AS "IsActive"
FROM refresh_token AS r
WHERE r.user_id = @__id_0
2022-09-23 15:13:09.874 +01:00 [DBG] A data reader was disposed.
2022-09-23 15:13:09.874 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:13:09.875 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 15:13:09.877 +01:00 [DBG] An entity of type 'User' tracked by 'PostgresContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 15:13:09.879 +01:00 [DBG] An entity of type 'RefreshToken' tracked by 'PostgresContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 15:13:09.881 +01:00 [DBG] SaveChanges starting for 'PostgresContext'.
2022-09-23 15:13:09.882 +01:00 [DBG] DetectChanges starting for 'PostgresContext'.
2022-09-23 15:13:09.883 +01:00 [DBG] DetectChanges completed for 'PostgresContext'.
2022-09-23 15:13:09.884 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 15:13:09.885 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:13:09.886 +01:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2022-09-23 15:13:09.888 +01:00 [DBG] Began transaction with isolation level 'ReadCommitted'.
2022-09-23 15:13:09.904 +01:00 [DBG] Executing 2 update commands as a batch.
2022-09-23 15:13:09.906 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 15:13:09.907 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2022-09-23 15:13:09.908 +01:00 [DBG] Executing DbCommand [Parameters=[@p12='?' (DbType = Int32), @p0='?' (DbType = DateTime), @p1='?', @p2='?' (DbType = DateTime), @p3='?' (DbType = Boolean), @p4='?' (DbType = Boolean), @p5='?' (DbType = Boolean), @p6='?', @p7='?', @p8='?', @p9='?' (DbType = DateTime), @p10='?', @p11='?' (DbType = Int32), @p19='?' (DbType = Int32), @p13='?' (DbType = DateTime), @p14='?', @p15='?', @p16='?' (DbType = DateTime), @p17='?', @p18='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE refresh_token SET created = @p0, created_by_ip = @p1, expires = @p2, is_active = @p3, is_expired = @p4, is_revoked = @p5, reason_revoked = @p6, token = @p7, replaced_by_token = @p8, revoked = @p9, revoked_by_ip = @p10, user_id = @p11
WHERE id = @p12;
UPDATE users SET created_at = @p13, email = @p14, full_name = @p15, password_changed_at = @p16, password_hash = @p17, username = @p18
WHERE id = @p19;
2022-09-23 15:13:09.912 +01:00 [INF] Executed DbCommand (3ms) [Parameters=[@p12='?' (DbType = Int32), @p0='?' (DbType = DateTime), @p1='?', @p2='?' (DbType = DateTime), @p3='?' (DbType = Boolean), @p4='?' (DbType = Boolean), @p5='?' (DbType = Boolean), @p6='?', @p7='?', @p8='?', @p9='?' (DbType = DateTime), @p10='?', @p11='?' (DbType = Int32), @p19='?' (DbType = Int32), @p13='?' (DbType = DateTime), @p14='?', @p15='?', @p16='?' (DbType = DateTime), @p17='?', @p18='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE refresh_token SET created = @p0, created_by_ip = @p1, expires = @p2, is_active = @p3, is_expired = @p4, is_revoked = @p5, reason_revoked = @p6, token = @p7, replaced_by_token = @p8, revoked = @p9, revoked_by_ip = @p10, user_id = @p11
WHERE id = @p12;
UPDATE users SET created_at = @p13, email = @p14, full_name = @p15, password_changed_at = @p16, password_hash = @p17, username = @p18
WHERE id = @p19;
2022-09-23 15:13:09.915 +01:00 [DBG] A data reader was disposed.
2022-09-23 15:13:09.915 +01:00 [DBG] Committing transaction.
2022-09-23 15:13:09.917 +01:00 [DBG] Committed transaction.
2022-09-23 15:13:09.918 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:13:09.921 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 15:13:09.921 +01:00 [DBG] Disposing transaction.
2022-09-23 15:13:09.922 +01:00 [DBG] An entity of type 'User' tracked by 'PostgresContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 15:13:09.924 +01:00 [DBG] An entity of type 'RefreshToken' tracked by 'PostgresContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 15:13:09.925 +01:00 [DBG] SaveChanges completed for 'PostgresContext' with 2 entities written to the database.
2022-09-23 15:13:09.928 +01:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2022-09-23 15:13:09.933 +01:00 [DBG] Attempting to select an output formatter based on Accept header '["text/plain"]'.
2022-09-23 15:13:09.937 +01:00 [DBG] Could not find an output formatter based on content negotiation. Accepted types were (["text/plain"])
2022-09-23 15:13:09.938 +01:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2022-09-23 15:13:09.939 +01:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2022-09-23 15:13:09.940 +01:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2022-09-23 15:13:09.941 +01:00 [INF] Executing OkObjectResult, writing value of type 'APIBank.Models.MyRequestResponses.LoginResponse'.
2022-09-23 15:13:09.954 +01:00 [INF] Executed action APIBank.Controllers.UsersController.Login (APIBank) in 2714.3276ms
2022-09-23 15:13:09.957 +01:00 [INF] Executed endpoint 'APIBank.Controllers.UsersController.Login (APIBank)'
2022-09-23 15:13:09.959 +01:00 [DBG] 'PostgresContext' disposed.
2022-09-23 15:13:09.962 +01:00 [INF] Request finished HTTP/2 POST https://localhost:7036/api/Users/Login application/json 58 - 200 - application/json;+charset=utf-8 3055.6185ms
2022-09-23 15:13:20.781 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/api/Accounts/GetAll - -
2022-09-23 15:13:20.784 +01:00 [DBG] 1 candidate(s) found for the request path '/api/Accounts/GetAll'
2022-09-23 15:13:20.787 +01:00 [DBG] Endpoint 'APIBank.Controllers.AccountsController.GetAllFromUser (APIBank)' with route pattern 'api/Accounts/GetAll' is valid for the request path '/api/Accounts/GetAll'
2022-09-23 15:13:20.794 +01:00 [DBG] Request matched endpoint 'APIBank.Controllers.AccountsController.GetAllFromUser (APIBank)'
2022-09-23 15:13:20.797 +01:00 [DBG] Static files was skipped as the request already matched an endpoint.
2022-09-23 15:13:20.885 +01:00 [INF] Entity Framework Core 6.0.9 initialized 'PostgresContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:6.0.7+5b98e4b74de93b590b44aef8dd7967c03acc433c' with options: None
2022-09-23 15:13:20.898 +01:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .FirstOrDefault(e => EF.Property<int>(e, "Id") == __p_0)'
2022-09-23 15:13:20.905 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<User>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: User.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: User.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 1], [Property: User.Email (string) Required Index MaxLength(254), 2], [Property: User.FullName (string) Required MaxLength(100), 3], [Property: User.PasswordChangedAt (DateTime) Required ValueGenerated.OnAdd, 4], [Property: User.PasswordHash (string) Required MaxLength(200), 5], [Property: User.Username (string) Required Index MaxLength(50), 6] }
        SELECT TOP(1) u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
        FROM users AS u
        WHERE u.id == @__p_0), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, User>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)
    .SingleOrDefault()'
2022-09-23 15:13:20.909 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 15:13:20.911 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2022-09-23 15:13:20.912 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 15:13:20.913 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:13:20.916 +01:00 [DBG] Executing DbCommand [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.id = @__p_0
LIMIT 1
2022-09-23 15:13:20.918 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.id = @__p_0
LIMIT 1
2022-09-23 15:13:20.920 +01:00 [DBG] Context 'PostgresContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 15:13:20.921 +01:00 [DBG] A data reader was disposed.
2022-09-23 15:13:20.921 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:13:20.922 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 15:13:20.925 +01:00 [INF] Executing endpoint 'APIBank.Controllers.AccountsController.GetAllFromUser (APIBank)'
2022-09-23 15:13:20.928 +01:00 [INF] Route matched with {action = "GetAllFromUser", controller = "Accounts"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult GetAllFromUser() on controller APIBank.Controllers.AccountsController (APIBank).
2022-09-23 15:13:20.932 +01:00 [DBG] Execution plan of authorization filters (in the following order): ["APIBank.Authorization.AuthorizeAttribute"]
2022-09-23 15:13:20.933 +01:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2022-09-23 15:13:20.934 +01:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2022-09-23 15:13:20.935 +01:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2022-09-23 15:13:20.936 +01:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2022-09-23 15:13:20.937 +01:00 [DBG] Executing controller factory for controller APIBank.Controllers.AccountsController (APIBank)
2022-09-23 15:13:20.938 +01:00 [DBG] Executed controller factory for controller APIBank.Controllers.AccountsController (APIBank)
2022-09-23 15:13:20.945 +01:00 [DBG] Compiling query expression: 
'DbSet<RefreshToken>()
    .FirstOrDefault(e => EF.Property<int>(e, "Id") == __p_0)'
2022-09-23 15:13:20.951 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<RefreshToken>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: RefreshToken.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: RefreshToken.Created (DateTime) Required, 1], [Property: RefreshToken.CreatedByIp (string) Required MaxLength(200), 2], [Property: RefreshToken.Expires (DateTime) Required, 3], [Property: RefreshToken.IsActive (no field, bool) Required, 4], [Property: RefreshToken.IsExpired (no field, bool) Required, 5], [Property: RefreshToken.IsRevoked (no field, bool) Required, 6], [Property: RefreshToken.ReasonRevoked (string) MaxLength(200), 7], [Property: RefreshToken.RefToken (string) Required MaxLength(254), 8], [Property: RefreshToken.ReplacedByToken (string) MaxLength(200), 9], [Property: RefreshToken.Revoked (DateTime?), 10], [Property: RefreshToken.RevokedByIp (string) MaxLength(200), 11], [Property: RefreshToken.UserId (int) Required FK Index, 12] }
        SELECT TOP(1) r.id, r.created, r.created_by_ip, r.expires, r.is_active, r.is_expired, r.is_revoked, r.reason_revoked, r.token, r.replaced_by_token, r.revoked, r.revoked_by_ip, r.user_id
        FROM refresh_token AS r
        WHERE r.id == @__p_0), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, RefreshToken>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)
    .SingleOrDefault()'
2022-09-23 15:13:20.954 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 15:13:20.954 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2022-09-23 15:13:20.955 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 15:13:20.957 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:13:20.959 +01:00 [DBG] Executing DbCommand [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id, r.created, r.created_by_ip, r.expires, r.is_active, r.is_expired, r.is_revoked, r.reason_revoked, r.token, r.replaced_by_token, r.revoked, r.revoked_by_ip, r.user_id
FROM refresh_token AS r
WHERE r.id = @__p_0
LIMIT 1
2022-09-23 15:13:20.964 +01:00 [INF] Executed DbCommand (5ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id, r.created, r.created_by_ip, r.expires, r.is_active, r.is_expired, r.is_revoked, r.reason_revoked, r.token, r.replaced_by_token, r.revoked, r.revoked_by_ip, r.user_id
FROM refresh_token AS r
WHERE r.id = @__p_0
LIMIT 1
2022-09-23 15:13:20.966 +01:00 [DBG] Context 'PostgresContext' started tracking 'RefreshToken' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 15:13:20.968 +01:00 [DBG] A data reader was disposed.
2022-09-23 15:13:20.969 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:13:20.970 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 15:13:20.973 +01:00 [DBG] Compiling query expression: 
'DbSet<Account>()
    .Where(u => u.UserId == __userId_0)
    .Select(u => new AccountRequestResponse{ 
        Balance = u.Balance, 
        CreatedAt = u.CreatedAt, 
        Currency = u.Currency, 
        Id = u.Id 
    }
    )'
2022-09-23 15:13:20.979 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<AccountRequestResponse>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            Balance -> 0
            CreatedAt -> 1
            Currency -> 2
            Id -> 3
        SELECT a.balance AS Balance, a.created_at AS CreatedAt, a.currency AS Currency, a.id AS Id
        FROM accounts AS a
        WHERE a.user_id == @__userId_0), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, AccountRequestResponse>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)'
2022-09-23 15:13:20.981 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 15:13:20.982 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2022-09-23 15:13:20.983 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 15:13:20.983 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:13:20.984 +01:00 [DBG] Executing DbCommand [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a.balance AS "Balance", a.created_at AS "CreatedAt", a.currency AS "Currency", a.id AS "Id"
FROM accounts AS a
WHERE a.user_id = @__userId_0
2022-09-23 15:13:20.987 +01:00 [INF] Executed DbCommand (3ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a.balance AS "Balance", a.created_at AS "CreatedAt", a.currency AS "Currency", a.id AS "Id"
FROM accounts AS a
WHERE a.user_id = @__userId_0
2022-09-23 15:13:20.999 +01:00 [DBG] A data reader was disposed.
2022-09-23 15:13:20.999 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:13:21.001 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 15:13:21.001 +01:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2022-09-23 15:13:21.003 +01:00 [DBG] Attempting to select an output formatter based on Accept header '["text/plain"]'.
2022-09-23 15:13:21.004 +01:00 [DBG] Could not find an output formatter based on content negotiation. Accepted types were (["text/plain"])
2022-09-23 15:13:21.004 +01:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2022-09-23 15:13:21.005 +01:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2022-09-23 15:13:21.005 +01:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2022-09-23 15:13:21.008 +01:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[APIBank.Models.Responses.AccountRequestResponse, APIBank, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2022-09-23 15:13:21.016 +01:00 [INF] Executed action APIBank.Controllers.AccountsController.GetAllFromUser (APIBank) in 79.0828ms
2022-09-23 15:13:21.017 +01:00 [INF] Executed endpoint 'APIBank.Controllers.AccountsController.GetAllFromUser (APIBank)'
2022-09-23 15:13:21.018 +01:00 [DBG] 'PostgresContext' disposed.
2022-09-23 15:13:21.019 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/api/Accounts/GetAll - - - 200 - application/json;+charset=utf-8 238.0679ms
2022-09-23 15:13:31.947 +01:00 [INF] Request starting HTTP/2 POST https://localhost:7036/api/Accounts/Create application/json 40
2022-09-23 15:13:31.952 +01:00 [DBG] 1 candidate(s) found for the request path '/api/Accounts/Create'
2022-09-23 15:13:31.954 +01:00 [DBG] Endpoint 'APIBank.Controllers.AccountsController.Create (APIBank)' with route pattern 'api/Accounts/Create' is valid for the request path '/api/Accounts/Create'
2022-09-23 15:13:31.956 +01:00 [DBG] Request matched endpoint 'APIBank.Controllers.AccountsController.Create (APIBank)'
2022-09-23 15:13:31.958 +01:00 [DBG] Static files was skipped as the request already matched an endpoint.
2022-09-23 15:13:32.030 +01:00 [INF] Entity Framework Core 6.0.9 initialized 'PostgresContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:6.0.7+5b98e4b74de93b590b44aef8dd7967c03acc433c' with options: None
2022-09-23 15:13:32.038 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 15:13:32.039 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2022-09-23 15:13:32.040 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 15:13:32.043 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:13:32.044 +01:00 [DBG] Executing DbCommand [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.id = @__p_0
LIMIT 1
2022-09-23 15:13:32.048 +01:00 [INF] Executed DbCommand (4ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.id = @__p_0
LIMIT 1
2022-09-23 15:13:32.051 +01:00 [DBG] Context 'PostgresContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 15:13:32.052 +01:00 [DBG] A data reader was disposed.
2022-09-23 15:13:32.053 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:13:32.054 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 15:13:32.057 +01:00 [INF] Executing endpoint 'APIBank.Controllers.AccountsController.Create (APIBank)'
2022-09-23 15:13:32.059 +01:00 [INF] Route matched with {action = "Create", controller = "Accounts"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult Create(APIBank.Models.Requests.AccountCreateRequest) on controller APIBank.Controllers.AccountsController (APIBank).
2022-09-23 15:13:32.061 +01:00 [DBG] Execution plan of authorization filters (in the following order): ["APIBank.Authorization.AuthorizeAttribute"]
2022-09-23 15:13:32.063 +01:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2022-09-23 15:13:32.065 +01:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2022-09-23 15:13:32.067 +01:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2022-09-23 15:13:32.069 +01:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2022-09-23 15:13:32.070 +01:00 [DBG] Executing controller factory for controller APIBank.Controllers.AccountsController (APIBank)
2022-09-23 15:13:32.073 +01:00 [DBG] Executed controller factory for controller APIBank.Controllers.AccountsController (APIBank)
2022-09-23 15:13:32.075 +01:00 [DBG] Attempting to bind parameter 'model' of type 'APIBank.Models.Requests.AccountCreateRequest' ...
2022-09-23 15:13:32.076 +01:00 [DBG] Attempting to bind parameter 'model' of type 'APIBank.Models.Requests.AccountCreateRequest' using the name '' in request data ...
2022-09-23 15:13:32.078 +01:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2022-09-23 15:13:32.082 +01:00 [DBG] Connection id "0HMKTDMR3TTQ1", Request id "0HMKTDMR3TTQ1:0000000D": started reading request body.
2022-09-23 15:13:32.083 +01:00 [DBG] Connection id "0HMKTDMR3TTQ1", Request id "0HMKTDMR3TTQ1:0000000D": done reading request body.
2022-09-23 15:13:32.089 +01:00 [DBG] JSON input formatter succeeded, deserializing to type 'APIBank.Models.Requests.AccountCreateRequest'
2022-09-23 15:13:32.090 +01:00 [DBG] Done attempting to bind parameter 'model' of type 'APIBank.Models.Requests.AccountCreateRequest'.
2022-09-23 15:13:32.091 +01:00 [DBG] Done attempting to bind parameter 'model' of type 'APIBank.Models.Requests.AccountCreateRequest'.
2022-09-23 15:13:32.092 +01:00 [DBG] Attempting to validate the bound parameter 'model' of type 'APIBank.Models.Requests.AccountCreateRequest' ...
2022-09-23 15:13:32.095 +01:00 [DBG] Done attempting to validate the bound parameter 'model' of type 'APIBank.Models.Requests.AccountCreateRequest'.
2022-09-23 15:13:32.100 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 15:13:32.102 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2022-09-23 15:13:32.105 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 15:13:32.106 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:13:32.107 +01:00 [DBG] Executing DbCommand [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id, r.created, r.created_by_ip, r.expires, r.is_active, r.is_expired, r.is_revoked, r.reason_revoked, r.token, r.replaced_by_token, r.revoked, r.revoked_by_ip, r.user_id
FROM refresh_token AS r
WHERE r.id = @__p_0
LIMIT 1
2022-09-23 15:13:32.110 +01:00 [INF] Executed DbCommand (3ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id, r.created, r.created_by_ip, r.expires, r.is_active, r.is_expired, r.is_revoked, r.reason_revoked, r.token, r.replaced_by_token, r.revoked, r.revoked_by_ip, r.user_id
FROM refresh_token AS r
WHERE r.id = @__p_0
LIMIT 1
2022-09-23 15:13:32.112 +01:00 [DBG] Context 'PostgresContext' started tracking 'RefreshToken' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 15:13:32.115 +01:00 [DBG] A data reader was disposed.
2022-09-23 15:13:32.116 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:13:32.120 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 15:13:32.124 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 15:13:32.125 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:13:32.127 +01:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2022-09-23 15:13:32.128 +01:00 [DBG] Began transaction with isolation level 'ReadCommitted'.
2022-09-23 15:13:32.132 +01:00 [DBG] 'PostgresContext' generated a temporary value for the property 'Id.Account'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 15:13:32.159 +01:00 [DBG] Context 'PostgresContext' started tracking 'Account' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 15:13:32.160 +01:00 [DBG] SaveChanges starting for 'PostgresContext'.
2022-09-23 15:13:32.161 +01:00 [DBG] DetectChanges starting for 'PostgresContext'.
2022-09-23 15:13:32.175 +01:00 [DBG] DetectChanges completed for 'PostgresContext'.
2022-09-23 15:13:32.177 +01:00 [DBG] Creating transaction savepoint.
2022-09-23 15:13:32.187 +01:00 [DBG] Created transaction savepoint.
2022-09-23 15:13:32.189 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 15:13:32.190 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2022-09-23 15:13:32.192 +01:00 [DBG] Executing DbCommand [Parameters=[@p0='?' (DbType = Decimal), @p1='?', @p2='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO accounts (balance, currency, user_id)
VALUES (@p0, @p1, @p2)
RETURNING id, created_at;
2022-09-23 15:13:32.205 +01:00 [INF] Executed DbCommand (14ms) [Parameters=[@p0='?' (DbType = Decimal), @p1='?', @p2='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO accounts (balance, currency, user_id)
VALUES (@p0, @p1, @p2)
RETURNING id, created_at;
2022-09-23 15:13:32.210 +01:00 [DBG] The foreign key property 'Account.Id' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2022-09-23 15:13:32.213 +01:00 [DBG] A data reader was disposed.
2022-09-23 15:13:32.218 +01:00 [DBG] Releasing transaction savepoint.
2022-09-23 15:13:32.220 +01:00 [DBG] Released transaction savepoint.
2022-09-23 15:13:32.224 +01:00 [DBG] An entity of type 'Account' tracked by 'PostgresContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 15:13:32.225 +01:00 [DBG] SaveChanges completed for 'PostgresContext' with 1 entities written to the database.
2022-09-23 15:13:32.230 +01:00 [DBG] 'PostgresContext' generated a temporary value for the property 'Id.Transaction'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 15:13:32.243 +01:00 [DBG] Context 'PostgresContext' started tracking 'Transaction' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 15:13:32.244 +01:00 [DBG] SaveChanges starting for 'PostgresContext'.
2022-09-23 15:13:32.245 +01:00 [DBG] DetectChanges starting for 'PostgresContext'.
2022-09-23 15:13:32.250 +01:00 [DBG] DetectChanges completed for 'PostgresContext'.
2022-09-23 15:13:32.252 +01:00 [DBG] Creating transaction savepoint.
2022-09-23 15:13:32.253 +01:00 [DBG] Created transaction savepoint.
2022-09-23 15:13:32.254 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 15:13:32.255 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2022-09-23 15:13:32.256 +01:00 [DBG] Executing DbCommand [Parameters=[@p0='?' (DbType = Int32), @p1='?' (DbType = Decimal), @p2='?' (DbType = Decimal)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO transactions (account_id, amount, balance)
VALUES (@p0, @p1, @p2)
RETURNING id, created_at;
2022-09-23 15:13:32.259 +01:00 [INF] Executed DbCommand (3ms) [Parameters=[@p0='?' (DbType = Int32), @p1='?' (DbType = Decimal), @p2='?' (DbType = Decimal)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO transactions (account_id, amount, balance)
VALUES (@p0, @p1, @p2)
RETURNING id, created_at;
2022-09-23 15:13:32.262 +01:00 [DBG] The foreign key property 'Transaction.Id' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2022-09-23 15:13:32.265 +01:00 [DBG] A data reader was disposed.
2022-09-23 15:13:32.266 +01:00 [DBG] Releasing transaction savepoint.
2022-09-23 15:13:32.268 +01:00 [DBG] Released transaction savepoint.
2022-09-23 15:13:32.270 +01:00 [DBG] An entity of type 'Transaction' tracked by 'PostgresContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 15:13:32.272 +01:00 [DBG] SaveChanges completed for 'PostgresContext' with 1 entities written to the database.
2022-09-23 15:13:32.275 +01:00 [DBG] Committing transaction.
2022-09-23 15:13:32.277 +01:00 [DBG] Committed transaction.
2022-09-23 15:13:32.278 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:13:32.279 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 15:13:32.281 +01:00 [DBG] Disposing transaction.
2022-09-23 15:13:32.283 +01:00 [INF] Account Created
2022-09-23 15:13:32.284 +01:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2022-09-23 15:13:32.286 +01:00 [DBG] Attempting to select an output formatter based on Accept header '["text/plain"]'.
2022-09-23 15:13:32.287 +01:00 [DBG] Could not find an output formatter based on content negotiation. Accepted types were (["text/plain"])
2022-09-23 15:13:32.288 +01:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2022-09-23 15:13:32.291 +01:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2022-09-23 15:13:32.291 +01:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2022-09-23 15:13:32.293 +01:00 [INF] Executing CreatedResult, writing value of type 'APIBank.Models.Responses.AccountRequestResponse'.
2022-09-23 15:13:32.295 +01:00 [INF] Executed action APIBank.Controllers.AccountsController.Create (APIBank) in 224.3493ms
2022-09-23 15:13:32.296 +01:00 [INF] Executed endpoint 'APIBank.Controllers.AccountsController.Create (APIBank)'
2022-09-23 15:13:32.298 +01:00 [DBG] 'PostgresContext' disposed.
2022-09-23 15:13:32.300 +01:00 [INF] Request finished HTTP/2 POST https://localhost:7036/api/Accounts/Create application/json 40 - 201 - application/json;+charset=utf-8 352.6565ms
2022-09-23 15:13:40.795 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/api/Accounts/GetAll - -
2022-09-23 15:13:40.798 +01:00 [DBG] 1 candidate(s) found for the request path '/api/Accounts/GetAll'
2022-09-23 15:13:40.800 +01:00 [DBG] Endpoint 'APIBank.Controllers.AccountsController.GetAllFromUser (APIBank)' with route pattern 'api/Accounts/GetAll' is valid for the request path '/api/Accounts/GetAll'
2022-09-23 15:13:40.804 +01:00 [DBG] Request matched endpoint 'APIBank.Controllers.AccountsController.GetAllFromUser (APIBank)'
2022-09-23 15:13:40.807 +01:00 [DBG] Static files was skipped as the request already matched an endpoint.
2022-09-23 15:13:40.815 +01:00 [INF] Entity Framework Core 6.0.9 initialized 'PostgresContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:6.0.7+5b98e4b74de93b590b44aef8dd7967c03acc433c' with options: None
2022-09-23 15:13:40.819 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 15:13:40.821 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2022-09-23 15:13:40.822 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 15:13:40.825 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:13:40.827 +01:00 [DBG] Executing DbCommand [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.id = @__p_0
LIMIT 1
2022-09-23 15:13:40.831 +01:00 [INF] Executed DbCommand (4ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.id = @__p_0
LIMIT 1
2022-09-23 15:13:40.837 +01:00 [DBG] Context 'PostgresContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 15:13:40.838 +01:00 [DBG] A data reader was disposed.
2022-09-23 15:13:40.840 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:13:40.842 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 15:13:40.843 +01:00 [INF] Executing endpoint 'APIBank.Controllers.AccountsController.GetAllFromUser (APIBank)'
2022-09-23 15:13:40.845 +01:00 [INF] Route matched with {action = "GetAllFromUser", controller = "Accounts"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult GetAllFromUser() on controller APIBank.Controllers.AccountsController (APIBank).
2022-09-23 15:13:40.847 +01:00 [DBG] Execution plan of authorization filters (in the following order): ["APIBank.Authorization.AuthorizeAttribute"]
2022-09-23 15:13:40.848 +01:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2022-09-23 15:13:40.849 +01:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2022-09-23 15:13:40.852 +01:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2022-09-23 15:13:40.853 +01:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2022-09-23 15:13:40.855 +01:00 [DBG] Executing controller factory for controller APIBank.Controllers.AccountsController (APIBank)
2022-09-23 15:13:40.858 +01:00 [DBG] Executed controller factory for controller APIBank.Controllers.AccountsController (APIBank)
2022-09-23 15:13:40.861 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 15:13:40.862 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2022-09-23 15:13:40.863 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 15:13:40.864 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:13:40.865 +01:00 [DBG] Executing DbCommand [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id, r.created, r.created_by_ip, r.expires, r.is_active, r.is_expired, r.is_revoked, r.reason_revoked, r.token, r.replaced_by_token, r.revoked, r.revoked_by_ip, r.user_id
FROM refresh_token AS r
WHERE r.id = @__p_0
LIMIT 1
2022-09-23 15:13:40.868 +01:00 [INF] Executed DbCommand (3ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id, r.created, r.created_by_ip, r.expires, r.is_active, r.is_expired, r.is_revoked, r.reason_revoked, r.token, r.replaced_by_token, r.revoked, r.revoked_by_ip, r.user_id
FROM refresh_token AS r
WHERE r.id = @__p_0
LIMIT 1
2022-09-23 15:13:40.870 +01:00 [DBG] Context 'PostgresContext' started tracking 'RefreshToken' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 15:13:40.871 +01:00 [DBG] A data reader was disposed.
2022-09-23 15:13:40.872 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:13:40.874 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 15:13:40.877 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 15:13:40.879 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (2ms).
2022-09-23 15:13:40.880 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 15:13:40.881 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:13:40.883 +01:00 [DBG] Executing DbCommand [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a.balance AS "Balance", a.created_at AS "CreatedAt", a.currency AS "Currency", a.id AS "Id"
FROM accounts AS a
WHERE a.user_id = @__userId_0
2022-09-23 15:13:40.885 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a.balance AS "Balance", a.created_at AS "CreatedAt", a.currency AS "Currency", a.id AS "Id"
FROM accounts AS a
WHERE a.user_id = @__userId_0
2022-09-23 15:13:40.887 +01:00 [DBG] A data reader was disposed.
2022-09-23 15:13:40.888 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:13:40.889 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 15:13:40.891 +01:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2022-09-23 15:13:40.893 +01:00 [DBG] Attempting to select an output formatter based on Accept header '["text/plain"]'.
2022-09-23 15:13:40.894 +01:00 [DBG] Could not find an output formatter based on content negotiation. Accepted types were (["text/plain"])
2022-09-23 15:13:40.895 +01:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2022-09-23 15:13:40.896 +01:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2022-09-23 15:13:40.896 +01:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2022-09-23 15:13:40.899 +01:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[APIBank.Models.Responses.AccountRequestResponse, APIBank, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2022-09-23 15:13:40.900 +01:00 [INF] Executed action APIBank.Controllers.AccountsController.GetAllFromUser (APIBank) in 45.2131ms
2022-09-23 15:13:40.901 +01:00 [INF] Executed endpoint 'APIBank.Controllers.AccountsController.GetAllFromUser (APIBank)'
2022-09-23 15:13:40.902 +01:00 [DBG] 'PostgresContext' disposed.
2022-09-23 15:13:40.903 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/api/Accounts/GetAll - - - 200 - application/json;+charset=utf-8 108.2795ms
2022-09-23 15:13:48.890 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/api/Accounts/GetById/100000000 - -
2022-09-23 15:13:48.893 +01:00 [DBG] 1 candidate(s) found for the request path '/api/Accounts/GetById/100000000'
2022-09-23 15:13:48.896 +01:00 [DBG] Endpoint 'APIBank.Controllers.AccountsController.GetById (APIBank)' with route pattern 'api/Accounts/GetById/{accountId}' is valid for the request path '/api/Accounts/GetById/100000000'
2022-09-23 15:13:48.900 +01:00 [DBG] Request matched endpoint 'APIBank.Controllers.AccountsController.GetById (APIBank)'
2022-09-23 15:13:48.903 +01:00 [DBG] Static files was skipped as the request already matched an endpoint.
2022-09-23 15:13:48.906 +01:00 [INF] Entity Framework Core 6.0.9 initialized 'PostgresContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:6.0.7+5b98e4b74de93b590b44aef8dd7967c03acc433c' with options: None
2022-09-23 15:13:48.909 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 15:13:48.910 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2022-09-23 15:13:48.911 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 15:13:48.912 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:13:48.913 +01:00 [DBG] Executing DbCommand [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.id = @__p_0
LIMIT 1
2022-09-23 15:13:48.915 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.id = @__p_0
LIMIT 1
2022-09-23 15:13:48.918 +01:00 [DBG] Context 'PostgresContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 15:13:48.920 +01:00 [DBG] A data reader was disposed.
2022-09-23 15:13:48.921 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:13:48.922 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 15:13:48.923 +01:00 [INF] Executing endpoint 'APIBank.Controllers.AccountsController.GetById (APIBank)'
2022-09-23 15:13:48.926 +01:00 [INF] Route matched with {action = "GetById", controller = "Accounts"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult GetById(Int32) on controller APIBank.Controllers.AccountsController (APIBank).
2022-09-23 15:13:48.928 +01:00 [DBG] Execution plan of authorization filters (in the following order): ["APIBank.Authorization.AuthorizeAttribute"]
2022-09-23 15:13:48.929 +01:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2022-09-23 15:13:48.930 +01:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2022-09-23 15:13:48.931 +01:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2022-09-23 15:13:48.933 +01:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2022-09-23 15:13:48.936 +01:00 [DBG] Executing controller factory for controller APIBank.Controllers.AccountsController (APIBank)
2022-09-23 15:13:48.937 +01:00 [DBG] Executed controller factory for controller APIBank.Controllers.AccountsController (APIBank)
2022-09-23 15:13:48.938 +01:00 [DBG] Attempting to bind parameter 'accountId' of type 'System.Int32' ...
2022-09-23 15:13:48.940 +01:00 [DBG] Attempting to bind parameter 'accountId' of type 'System.Int32' using the name 'accountId' in request data ...
2022-09-23 15:13:48.944 +01:00 [DBG] Done attempting to bind parameter 'accountId' of type 'System.Int32'.
2022-09-23 15:13:48.945 +01:00 [DBG] Done attempting to bind parameter 'accountId' of type 'System.Int32'.
2022-09-23 15:13:48.946 +01:00 [DBG] Attempting to validate the bound parameter 'accountId' of type 'System.Int32' ...
2022-09-23 15:13:48.947 +01:00 [DBG] Done attempting to validate the bound parameter 'accountId' of type 'System.Int32'.
2022-09-23 15:13:48.951 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 15:13:48.953 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2022-09-23 15:13:48.954 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 15:13:48.955 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:13:48.957 +01:00 [DBG] Executing DbCommand [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id, r.created, r.created_by_ip, r.expires, r.is_active, r.is_expired, r.is_revoked, r.reason_revoked, r.token, r.replaced_by_token, r.revoked, r.revoked_by_ip, r.user_id
FROM refresh_token AS r
WHERE r.id = @__p_0
LIMIT 1
2022-09-23 15:13:48.960 +01:00 [INF] Executed DbCommand (3ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id, r.created, r.created_by_ip, r.expires, r.is_active, r.is_expired, r.is_revoked, r.reason_revoked, r.token, r.replaced_by_token, r.revoked, r.revoked_by_ip, r.user_id
FROM refresh_token AS r
WHERE r.id = @__p_0
LIMIT 1
2022-09-23 15:13:48.962 +01:00 [DBG] Context 'PostgresContext' started tracking 'RefreshToken' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 15:13:48.963 +01:00 [DBG] A data reader was disposed.
2022-09-23 15:13:48.964 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:13:48.965 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 15:13:48.972 +01:00 [DBG] Compiling query expression: 
'DbSet<Account>()
    .Include(a => a.Transactions)
    .Where(a => a.Id == __accountId_0 && a.UserId == __userId_1)
    .Select(a => new AccountMovims{ 
        Account = new AccountRequestResponse{ 
            Balance = a.Balance, 
            Currency = a.Currency, 
            CreatedAt = a.CreatedAt, 
            Id = a.Id 
        }
        , 
        Movims = a.Transactions
            .Select(b => new Movim{ 
                Amount = b.Amount, 
                CreatedAt = b.CreatedAt 
            }
            )
            .ToArray() 
    }
    )
    .SingleOrDefault()'
2022-09-23 15:13:49.028 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<AccountMovims>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Client Projections:
            0 -> 0
            1 -> 1
            2 -> 2
            3 -> 3
            4 -> 4
            5 -> 5
            6 -> 6
        SELECT t.balance, t.currency, t.created_at, t.id, t0.amount, t0.created_at, t0.id
        FROM 
        (
            SELECT TOP(2) a.balance, a.currency, a.created_at, a.id
            FROM accounts AS a
            WHERE (a.id == @__accountId_0) && (a.user_id == @__userId_1)
        ) AS t
        LEFT JOIN transactions AS t0 ON t.id == t0.account_id
        ORDER BY t.id ASC), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, AccountMovims>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)
    .SingleOrDefault()'
2022-09-23 15:13:49.035 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 15:13:49.036 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2022-09-23 15:13:49.038 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 15:13:49.039 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:13:49.040 +01:00 [DBG] Executing DbCommand [Parameters=[@__accountId_0='?' (DbType = Int32), @__userId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT t.balance, t.currency, t.created_at, t.id, t0.amount, t0.created_at, t0.id
FROM (
    SELECT a.balance, a.currency, a.created_at, a.id
    FROM accounts AS a
    WHERE (a.id = @__accountId_0) AND (a.user_id = @__userId_1)
    LIMIT 2
) AS t
LEFT JOIN transactions AS t0 ON t.id = t0.account_id
ORDER BY t.id
2022-09-23 15:13:49.042 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[@__accountId_0='?' (DbType = Int32), @__userId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT t.balance, t.currency, t.created_at, t.id, t0.amount, t0.created_at, t0.id
FROM (
    SELECT a.balance, a.currency, a.created_at, a.id
    FROM accounts AS a
    WHERE (a.id = @__accountId_0) AND (a.user_id = @__userId_1)
    LIMIT 2
) AS t
LEFT JOIN transactions AS t0 ON t.id = t0.account_id
ORDER BY t.id
2022-09-23 15:13:49.046 +01:00 [DBG] A data reader was disposed.
2022-09-23 15:13:49.047 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:13:49.048 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 15:13:49.050 +01:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2022-09-23 15:13:49.056 +01:00 [DBG] Attempting to select an output formatter based on Accept header '["text/plain"]'.
2022-09-23 15:13:49.057 +01:00 [DBG] Could not find an output formatter based on content negotiation. Accepted types were (["text/plain"])
2022-09-23 15:13:49.058 +01:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2022-09-23 15:13:49.059 +01:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2022-09-23 15:13:49.060 +01:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2022-09-23 15:13:49.060 +01:00 [INF] Executing OkObjectResult, writing value of type 'APIBank.Models.Responses.AccountMovims'.
2022-09-23 15:13:49.063 +01:00 [INF] Executed action APIBank.Controllers.AccountsController.GetById (APIBank) in 126.7373ms
2022-09-23 15:13:49.064 +01:00 [INF] Executed endpoint 'APIBank.Controllers.AccountsController.GetById (APIBank)'
2022-09-23 15:13:49.065 +01:00 [DBG] 'PostgresContext' disposed.
2022-09-23 15:13:49.068 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/api/Accounts/GetById/100000000 - - - 200 - application/json;+charset=utf-8 178.3302ms
2022-09-23 15:14:08.722 +01:00 [INF] Request starting HTTP/2 POST https://localhost:7036/api/Transfers/TransferRequest application/json 77
2022-09-23 15:14:08.727 +01:00 [DBG] 1 candidate(s) found for the request path '/api/Transfers/TransferRequest'
2022-09-23 15:14:08.728 +01:00 [DBG] Endpoint 'APIBank.Controllers.TransfersController.Create (APIBank)' with route pattern 'api/Transfers/TransferRequest' is valid for the request path '/api/Transfers/TransferRequest'
2022-09-23 15:14:08.730 +01:00 [DBG] Request matched endpoint 'APIBank.Controllers.TransfersController.Create (APIBank)'
2022-09-23 15:14:08.732 +01:00 [DBG] Static files was skipped as the request already matched an endpoint.
2022-09-23 15:14:08.736 +01:00 [INF] Entity Framework Core 6.0.9 initialized 'PostgresContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:6.0.7+5b98e4b74de93b590b44aef8dd7967c03acc433c' with options: None
2022-09-23 15:14:08.745 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 15:14:08.747 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (2ms).
2022-09-23 15:14:08.749 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 15:14:08.751 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:14:08.754 +01:00 [DBG] Executing DbCommand [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.id = @__p_0
LIMIT 1
2022-09-23 15:14:08.758 +01:00 [INF] Executed DbCommand (4ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.id = @__p_0
LIMIT 1
2022-09-23 15:14:08.760 +01:00 [DBG] Context 'PostgresContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 15:14:08.761 +01:00 [DBG] A data reader was disposed.
2022-09-23 15:14:08.761 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:14:08.762 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 15:14:08.763 +01:00 [INF] Executing endpoint 'APIBank.Controllers.TransfersController.Create (APIBank)'
2022-09-23 15:14:08.765 +01:00 [INF] Route matched with {action = "Create", controller = "Transfers"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult Create(APIBank.Models.Requests.TransferRequest) on controller APIBank.Controllers.TransfersController (APIBank).
2022-09-23 15:14:08.771 +01:00 [DBG] Execution plan of authorization filters (in the following order): ["APIBank.Authorization.AuthorizeAttribute"]
2022-09-23 15:14:08.772 +01:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2022-09-23 15:14:08.773 +01:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2022-09-23 15:14:08.775 +01:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2022-09-23 15:14:08.776 +01:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2022-09-23 15:14:08.777 +01:00 [DBG] Executing controller factory for controller APIBank.Controllers.TransfersController (APIBank)
2022-09-23 15:14:08.778 +01:00 [DBG] Executed controller factory for controller APIBank.Controllers.TransfersController (APIBank)
2022-09-23 15:14:08.779 +01:00 [DBG] Attempting to bind parameter 'model' of type 'APIBank.Models.Requests.TransferRequest' ...
2022-09-23 15:14:08.779 +01:00 [DBG] Attempting to bind parameter 'model' of type 'APIBank.Models.Requests.TransferRequest' using the name '' in request data ...
2022-09-23 15:14:08.780 +01:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2022-09-23 15:14:08.782 +01:00 [DBG] Connection id "0HMKTDMR3TTQ1", Request id "0HMKTDMR3TTQ1:00000013": started reading request body.
2022-09-23 15:14:08.787 +01:00 [DBG] Connection id "0HMKTDMR3TTQ1", Request id "0HMKTDMR3TTQ1:00000013": done reading request body.
2022-09-23 15:14:08.789 +01:00 [DBG] JSON input formatter succeeded, deserializing to type 'APIBank.Models.Requests.TransferRequest'
2022-09-23 15:14:08.790 +01:00 [DBG] Done attempting to bind parameter 'model' of type 'APIBank.Models.Requests.TransferRequest'.
2022-09-23 15:14:08.791 +01:00 [DBG] Done attempting to bind parameter 'model' of type 'APIBank.Models.Requests.TransferRequest'.
2022-09-23 15:14:08.792 +01:00 [DBG] Attempting to validate the bound parameter 'model' of type 'APIBank.Models.Requests.TransferRequest' ...
2022-09-23 15:14:08.794 +01:00 [DBG] Done attempting to validate the bound parameter 'model' of type 'APIBank.Models.Requests.TransferRequest'.
2022-09-23 15:14:08.796 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 15:14:08.797 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2022-09-23 15:14:08.797 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 15:14:08.799 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:14:08.802 +01:00 [DBG] Executing DbCommand [Parameters=[@__accountId_0='?' (DbType = Int32), @__userId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT t.balance, t.currency, t.created_at, t.id, t0.amount, t0.created_at, t0.id
FROM (
    SELECT a.balance, a.currency, a.created_at, a.id
    FROM accounts AS a
    WHERE (a.id = @__accountId_0) AND (a.user_id = @__userId_1)
    LIMIT 2
) AS t
LEFT JOIN transactions AS t0 ON t.id = t0.account_id
ORDER BY t.id
2022-09-23 15:14:08.805 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[@__accountId_0='?' (DbType = Int32), @__userId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT t.balance, t.currency, t.created_at, t.id, t0.amount, t0.created_at, t0.id
FROM (
    SELECT a.balance, a.currency, a.created_at, a.id
    FROM accounts AS a
    WHERE (a.id = @__accountId_0) AND (a.user_id = @__userId_1)
    LIMIT 2
) AS t
LEFT JOIN transactions AS t0 ON t.id = t0.account_id
ORDER BY t.id
2022-09-23 15:14:08.807 +01:00 [DBG] A data reader was disposed.
2022-09-23 15:14:08.807 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:14:08.808 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 15:14:08.811 +01:00 [INF] Executed action APIBank.Controllers.TransfersController.Create (APIBank) in 34.7254ms
2022-09-23 15:14:08.813 +01:00 [INF] Executed endpoint 'APIBank.Controllers.TransfersController.Create (APIBank)'
2022-09-23 15:14:08.817 +01:00 [INF] Global Error was found:
2022-09-23 15:14:08.819 +01:00 [DBG] 'PostgresContext' disposed.
2022-09-23 15:14:08.821 +01:00 [INF] Request finished HTTP/2 POST https://localhost:7036/api/Transfers/TransferRequest application/json 77 - 500 - application/json 98.4786ms
2022-09-23 15:14:36.458 +01:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2022-09-23 15:14:36.671 +01:00 [DBG] Hosting starting
2022-09-23 15:14:37.204 +01:00 [DBG] Using development certificate: CN=localhost (Thumbprint: 9CC642E9838495A6C3C202DECA6A8AD300396DD2)
2022-09-23 15:14:37.297 +01:00 [INF] Now listening on: https://localhost:7036
2022-09-23 15:14:37.299 +01:00 [INF] Now listening on: http://localhost:5036
2022-09-23 15:14:37.300 +01:00 [DBG] Loaded hosting startup assembly APIBank
2022-09-23 15:14:37.301 +01:00 [DBG] Loaded hosting startup assembly Microsoft.AspNetCore.Watch.BrowserRefresh
2022-09-23 15:14:37.302 +01:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.BrowserLink.Net
2022-09-23 15:14:37.303 +01:00 [INF] Application started. Press Ctrl+C to shut down.
2022-09-23 15:14:37.304 +01:00 [INF] Hosting environment: Development
2022-09-23 15:14:37.304 +01:00 [INF] Content root path: C:\Users\mguedesa\OneDrive - NTT DATA EMEAL\Documentos\GitHub\OpenBankAPI-NTT\APIBank\APIBank\
2022-09-23 15:14:37.305 +01:00 [DBG] Hosting started
2022-09-23 15:14:37.697 +01:00 [DBG] Connection id "0HMKTDNPCQ9L7" accepted.
2022-09-23 15:14:37.697 +01:00 [DBG] Connection id "0HMKTDNPCQ9L6" accepted.
2022-09-23 15:14:37.697 +01:00 [DBG] Connection id "0HMKTDNPCQ9L6" received FIN.
2022-09-23 15:14:37.697 +01:00 [DBG] Connection id "0HMKTDNPCQ9L7" received FIN.
2022-09-23 15:14:37.700 +01:00 [DBG] Connection id "0HMKTDNPCQ9L7" started.
2022-09-23 15:14:37.700 +01:00 [DBG] Connection id "0HMKTDNPCQ9L6" started.
2022-09-23 15:14:37.740 +01:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException:  Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveBlobAsync[TIOAdapter](TIOAdapter adapter)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](TIOAdapter adapter, Boolean receiveFirst, Byte[] reAuthenticationData, Boolean isApm)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2022-09-23 15:14:37.740 +01:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException:  Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveBlobAsync[TIOAdapter](TIOAdapter adapter)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](TIOAdapter adapter, Boolean receiveFirst, Byte[] reAuthenticationData, Boolean isApm)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2022-09-23 15:14:37.799 +01:00 [DBG] Connection id "0HMKTDNPCQ9L6" stopped.
2022-09-23 15:14:37.799 +01:00 [DBG] Connection id "0HMKTDNPCQ9L7" stopped.
2022-09-23 15:14:37.802 +01:00 [DBG] Connection id "0HMKTDNPCQ9L6" sending FIN because: "The Socket transport's send loop completed gracefully."
2022-09-23 15:14:37.802 +01:00 [DBG] Connection id "0HMKTDNPCQ9L7" sending FIN because: "The Socket transport's send loop completed gracefully."
2022-09-23 15:14:38.033 +01:00 [DBG] Connection id "0HMKTDNPCQ9L8" accepted.
2022-09-23 15:14:38.035 +01:00 [DBG] Connection id "0HMKTDNPCQ9L8" started.
2022-09-23 15:14:38.083 +01:00 [DBG] Connection 0HMKTDNPCQ9L8 established using the following protocol: "Tls12"
2022-09-23 15:14:38.182 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/swagger/index.html - -
2022-09-23 15:14:38.231 +01:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2022-09-23 15:14:38.254 +01:00 [DBG] No candidates found for the request path '/swagger/index.html'
2022-09-23 15:14:38.258 +01:00 [DBG] Request did not match any endpoints
2022-09-23 15:14:38.383 +01:00 [DBG] Response markup is scheduled to include browser refresh script injection.
2022-09-23 15:14:38.570 +01:00 [DBG] Response markup was updated to include browser refresh script injection.
2022-09-23 15:14:38.589 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/swagger/index.html - - - 200 - text/html;charset=utf-8 406.3436ms
2022-09-23 15:14:38.614 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/_framework/aspnetcore-browser-refresh.js - -
2022-09-23 15:14:38.614 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/_vs/browserLink - -
2022-09-23 15:14:38.631 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/_framework/aspnetcore-browser-refresh.js - - - 200 11984 application/javascript;+charset=utf-8 16.5924ms
2022-09-23 15:14:38.649 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/_vs/browserLink - - - 200 - text/javascript;+charset=UTF-8 34.5535ms
2022-09-23 15:14:38.764 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/swagger/v1/swagger.json - -
2022-09-23 15:14:38.769 +01:00 [DBG] No candidates found for the request path '/swagger/v1/swagger.json'
2022-09-23 15:14:38.771 +01:00 [DBG] Request did not match any endpoints
2022-09-23 15:14:39.016 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/swagger/v1/swagger.json - - - 200 - application/json;charset=utf-8 251.7346ms
2022-09-23 15:14:51.911 +01:00 [INF] Request starting HTTP/2 POST https://localhost:7036/api/Users/Login application/json 58
2022-09-23 15:14:51.933 +01:00 [DBG] 1 candidate(s) found for the request path '/api/Users/Login'
2022-09-23 15:14:51.942 +01:00 [DBG] Endpoint 'APIBank.Controllers.UsersController.Login (APIBank)' with route pattern 'api/Users/Login' is valid for the request path '/api/Users/Login'
2022-09-23 15:14:51.947 +01:00 [DBG] Request matched endpoint 'APIBank.Controllers.UsersController.Login (APIBank)'
2022-09-23 15:14:51.953 +01:00 [DBG] Static files was skipped as the request already matched an endpoint.
2022-09-23 15:14:52.464 +01:00 [INF] Executing endpoint 'APIBank.Controllers.UsersController.Login (APIBank)'
2022-09-23 15:14:52.493 +01:00 [INF] Route matched with {action = "Login", controller = "Users"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult Login(APIBank.Models.Requests.UserLoginRequest) on controller APIBank.Controllers.UsersController (APIBank).
2022-09-23 15:14:52.499 +01:00 [DBG] Execution plan of authorization filters (in the following order): ["APIBank.Authorization.AuthorizeAttribute"]
2022-09-23 15:14:52.500 +01:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2022-09-23 15:14:52.502 +01:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2022-09-23 15:14:52.504 +01:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2022-09-23 15:14:52.505 +01:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2022-09-23 15:14:52.508 +01:00 [DBG] Executing controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-23 15:14:52.509 +01:00 [DBG] Executed controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-23 15:14:52.537 +01:00 [DBG] Attempting to bind parameter 'model' of type 'APIBank.Models.Requests.UserLoginRequest' ...
2022-09-23 15:14:52.542 +01:00 [DBG] Attempting to bind parameter 'model' of type 'APIBank.Models.Requests.UserLoginRequest' using the name '' in request data ...
2022-09-23 15:14:52.547 +01:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2022-09-23 15:14:52.557 +01:00 [DBG] Connection id "0HMKTDNPCQ9L8", Request id "0HMKTDNPCQ9L8:00000009": started reading request body.
2022-09-23 15:14:52.559 +01:00 [DBG] Connection id "0HMKTDNPCQ9L8", Request id "0HMKTDNPCQ9L8:00000009": done reading request body.
2022-09-23 15:14:52.576 +01:00 [DBG] JSON input formatter succeeded, deserializing to type 'APIBank.Models.Requests.UserLoginRequest'
2022-09-23 15:14:52.578 +01:00 [DBG] Done attempting to bind parameter 'model' of type 'APIBank.Models.Requests.UserLoginRequest'.
2022-09-23 15:14:52.580 +01:00 [DBG] Done attempting to bind parameter 'model' of type 'APIBank.Models.Requests.UserLoginRequest'.
2022-09-23 15:14:52.581 +01:00 [DBG] Attempting to validate the bound parameter 'model' of type 'APIBank.Models.Requests.UserLoginRequest' ...
2022-09-23 15:14:52.599 +01:00 [DBG] Done attempting to validate the bound parameter 'model' of type 'APIBank.Models.Requests.UserLoginRequest'.
2022-09-23 15:14:52.759 +01:00 [DBG] An additional 'IServiceProvider' was created for internal use by Entity Framework. An existing service provider was not used due to the following configuration changes: configuration changed for 'Core:ConfigureWarnings', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:UseAdminDatabase', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:SetPostgresVersion', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:UseRedshift', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:ReverseNullOrdering', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:RemoteCertificateValidationCallback', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:ProvideClientCertificatesCallback', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:ProvidePasswordCallback'.
2022-09-23 15:14:54.373 +01:00 [INF] Entity Framework Core 6.0.9 initialized 'PostgresContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:6.0.7+5b98e4b74de93b590b44aef8dd7967c03acc433c' with options: None
2022-09-23 15:14:54.467 +01:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .SingleOrDefault(x => x.Username == __model_Username_0)'
2022-09-23 15:14:55.039 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<User>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: User.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: User.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 1], [Property: User.Email (string) Required Index MaxLength(254), 2], [Property: User.FullName (string) Required MaxLength(100), 3], [Property: User.PasswordChangedAt (DateTime) Required ValueGenerated.OnAdd, 4], [Property: User.PasswordHash (string) Required MaxLength(200), 5], [Property: User.Username (string) Required Index MaxLength(50), 6] }
        SELECT TOP(2) u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
        FROM users AS u
        WHERE u.username == @__model_Username_0), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, User>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)
    .SingleOrDefault()'
2022-09-23 15:14:55.112 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 15:14:55.237 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (116ms).
2022-09-23 15:14:55.252 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 15:14:55.728 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:14:55.750 +01:00 [DBG] Executing DbCommand [Parameters=[@__model_Username_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.username = @__model_Username_0
LIMIT 2
2022-09-23 15:14:55.891 +01:00 [INF] Executed DbCommand (148ms) [Parameters=[@__model_Username_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.username = @__model_Username_0
LIMIT 2
2022-09-23 15:14:55.970 +01:00 [DBG] Context 'PostgresContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 15:14:56.054 +01:00 [DBG] A data reader was disposed.
2022-09-23 15:14:56.065 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:14:56.080 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 15:14:56.320 +01:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .Any(user => user.RefreshTokenCollection
        .Any(reftoken => reftoken.RefToken == __token_0))'
2022-09-23 15:14:56.468 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<bool>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            EmptyProjectionMember -> 0
        SELECT EXISTS (
            SELECT 1
            FROM users AS u
            WHERE EXISTS (
                SELECT 1
                FROM refresh_token AS r
                WHERE ((u.id != NULL) && (u.id == r.user_id)) && (r.token == @__token_0)))), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, bool>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)
    .Single()'
2022-09-23 15:14:56.490 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 15:14:56.492 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2022-09-23 15:14:56.497 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 15:14:56.499 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:14:56.500 +01:00 [DBG] Executing DbCommand [Parameters=[@__token_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM users AS u
    WHERE EXISTS (
        SELECT 1
        FROM refresh_token AS r
        WHERE (u.id = r.user_id) AND (r.token = @__token_0)))
2022-09-23 15:14:56.503 +01:00 [INF] Executed DbCommand (3ms) [Parameters=[@__token_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM users AS u
    WHERE EXISTS (
        SELECT 1
        FROM refresh_token AS r
        WHERE (u.id = r.user_id) AND (r.token = @__token_0)))
2022-09-23 15:14:56.510 +01:00 [DBG] A data reader was disposed.
2022-09-23 15:14:56.513 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:14:56.515 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 15:14:56.519 +01:00 [DBG] SaveChanges starting for 'PostgresContext'.
2022-09-23 15:14:56.522 +01:00 [DBG] DetectChanges starting for 'PostgresContext'.
2022-09-23 15:14:56.558 +01:00 [DBG] 1 entities were added and 0 entities were removed from navigation 'User.RefreshTokenCollection'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 15:14:56.628 +01:00 [DBG] 'PostgresContext' generated a temporary value for the property 'Id.RefreshToken'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 15:14:56.703 +01:00 [DBG] Context 'PostgresContext' started tracking 'RefreshToken' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 15:14:56.711 +01:00 [DBG] DetectChanges completed for 'PostgresContext'.
2022-09-23 15:14:56.723 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 15:14:56.725 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:14:56.728 +01:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2022-09-23 15:14:56.739 +01:00 [DBG] Began transaction with isolation level 'ReadCommitted'.
2022-09-23 15:14:56.806 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 15:14:56.808 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (2ms).
2022-09-23 15:14:56.811 +01:00 [DBG] Executing DbCommand [Parameters=[@p0='?' (DbType = DateTime), @p1='?', @p2='?' (DbType = DateTime), @p3='?' (DbType = Boolean), @p4='?' (DbType = Boolean), @p5='?' (DbType = Boolean), @p6='?', @p7='?', @p8='?', @p9='?' (DbType = DateTime), @p10='?', @p11='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO refresh_token (created, created_by_ip, expires, is_active, is_expired, is_revoked, reason_revoked, token, replaced_by_token, revoked, revoked_by_ip, user_id)
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11)
RETURNING id;
2022-09-23 15:14:56.832 +01:00 [INF] Executed DbCommand (21ms) [Parameters=[@p0='?' (DbType = DateTime), @p1='?', @p2='?' (DbType = DateTime), @p3='?' (DbType = Boolean), @p4='?' (DbType = Boolean), @p5='?' (DbType = Boolean), @p6='?', @p7='?', @p8='?', @p9='?' (DbType = DateTime), @p10='?', @p11='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO refresh_token (created, created_by_ip, expires, is_active, is_expired, is_revoked, reason_revoked, token, replaced_by_token, revoked, revoked_by_ip, user_id)
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11)
RETURNING id;
2022-09-23 15:14:56.862 +01:00 [DBG] The foreign key property 'RefreshToken.Id' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2022-09-23 15:14:56.876 +01:00 [DBG] A data reader was disposed.
2022-09-23 15:14:56.882 +01:00 [DBG] Committing transaction.
2022-09-23 15:14:56.898 +01:00 [DBG] Committed transaction.
2022-09-23 15:14:56.900 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:14:56.903 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 15:14:56.910 +01:00 [DBG] Disposing transaction.
2022-09-23 15:14:56.921 +01:00 [DBG] An entity of type 'RefreshToken' tracked by 'PostgresContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 15:14:56.925 +01:00 [DBG] SaveChanges completed for 'PostgresContext' with 1 entities written to the database.
2022-09-23 15:14:57.193 +01:00 [DBG] Compiling query expression: 
'DbSet<RefreshToken>()
    .Where(rt => rt.UserId == __id_0)
    .AsNoTracking()
    .Select(rt => new RefreshToken{ 
        Id = rt.Id, 
        UserId = rt.UserId, 
        RefToken = rt.RefToken, 
        Expires = rt.Expires, 
        Created = rt.Created, 
        CreatedByIp = rt.CreatedByIp, 
        Revoked = rt.Revoked, 
        RevokedByIp = rt.RevokedByIp, 
        ReplacedByToken = rt.ReplacedByToken, 
        ReasonRevoked = rt.ReasonRevoked, 
        IsExpired = rt.IsExpired, 
        IsRevoked = rt.IsRevoked, 
        IsActive = rt.IsActive 
    }
    )'
2022-09-23 15:14:57.229 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<RefreshToken>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            Id -> 0
            UserId -> 1
            RefToken -> 2
            Expires -> 3
            Created -> 4
            CreatedByIp -> 5
            Revoked -> 6
            RevokedByIp -> 7
            ReplacedByToken -> 8
            ReasonRevoked -> 9
            IsExpired -> 10
            IsRevoked -> 11
            IsActive -> 12
        SELECT r.id AS Id, r.user_id AS UserId, r.token AS RefToken, r.expires AS Expires, r.created AS Created, r.created_by_ip AS CreatedByIp, r.revoked AS Revoked, r.revoked_by_ip AS RevokedByIp, r.replaced_by_token AS ReplacedByToken, r.reason_revoked AS ReasonRevoked, r.is_expired AS IsExpired, r.is_revoked AS IsRevoked, r.is_active AS IsActive
        FROM refresh_token AS r
        WHERE r.user_id == @__id_0), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, RefreshToken>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)'
2022-09-23 15:14:57.235 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 15:14:57.235 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2022-09-23 15:14:57.236 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 15:14:57.237 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:14:57.238 +01:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.user_id AS "UserId", r.token AS "RefToken", r.expires AS "Expires", r.created AS "Created", r.created_by_ip AS "CreatedByIp", r.revoked AS "Revoked", r.revoked_by_ip AS "RevokedByIp", r.replaced_by_token AS "ReplacedByToken", r.reason_revoked AS "ReasonRevoked", r.is_expired AS "IsExpired", r.is_revoked AS "IsRevoked", r.is_active AS "IsActive"
FROM refresh_token AS r
WHERE r.user_id = @__id_0
2022-09-23 15:14:57.240 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.user_id AS "UserId", r.token AS "RefToken", r.expires AS "Expires", r.created AS "Created", r.created_by_ip AS "CreatedByIp", r.revoked AS "Revoked", r.revoked_by_ip AS "RevokedByIp", r.replaced_by_token AS "ReplacedByToken", r.reason_revoked AS "ReasonRevoked", r.is_expired AS "IsExpired", r.is_revoked AS "IsRevoked", r.is_active AS "IsActive"
FROM refresh_token AS r
WHERE r.user_id = @__id_0
2022-09-23 15:14:57.243 +01:00 [DBG] A data reader was disposed.
2022-09-23 15:14:57.244 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:14:57.244 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 15:14:57.249 +01:00 [DBG] An entity of type 'User' tracked by 'PostgresContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 15:14:57.252 +01:00 [DBG] An entity of type 'RefreshToken' tracked by 'PostgresContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 15:14:57.253 +01:00 [DBG] SaveChanges starting for 'PostgresContext'.
2022-09-23 15:14:57.254 +01:00 [DBG] DetectChanges starting for 'PostgresContext'.
2022-09-23 15:14:57.256 +01:00 [DBG] DetectChanges completed for 'PostgresContext'.
2022-09-23 15:14:57.258 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 15:14:57.259 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:14:57.263 +01:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2022-09-23 15:14:57.263 +01:00 [DBG] Began transaction with isolation level 'ReadCommitted'.
2022-09-23 15:14:57.285 +01:00 [DBG] Executing 2 update commands as a batch.
2022-09-23 15:14:57.291 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 15:14:57.292 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2022-09-23 15:14:57.296 +01:00 [DBG] Executing DbCommand [Parameters=[@p12='?' (DbType = Int32), @p0='?' (DbType = DateTime), @p1='?', @p2='?' (DbType = DateTime), @p3='?' (DbType = Boolean), @p4='?' (DbType = Boolean), @p5='?' (DbType = Boolean), @p6='?', @p7='?', @p8='?', @p9='?' (DbType = DateTime), @p10='?', @p11='?' (DbType = Int32), @p19='?' (DbType = Int32), @p13='?' (DbType = DateTime), @p14='?', @p15='?', @p16='?' (DbType = DateTime), @p17='?', @p18='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE refresh_token SET created = @p0, created_by_ip = @p1, expires = @p2, is_active = @p3, is_expired = @p4, is_revoked = @p5, reason_revoked = @p6, token = @p7, replaced_by_token = @p8, revoked = @p9, revoked_by_ip = @p10, user_id = @p11
WHERE id = @p12;
UPDATE users SET created_at = @p13, email = @p14, full_name = @p15, password_changed_at = @p16, password_hash = @p17, username = @p18
WHERE id = @p19;
2022-09-23 15:14:57.301 +01:00 [INF] Executed DbCommand (6ms) [Parameters=[@p12='?' (DbType = Int32), @p0='?' (DbType = DateTime), @p1='?', @p2='?' (DbType = DateTime), @p3='?' (DbType = Boolean), @p4='?' (DbType = Boolean), @p5='?' (DbType = Boolean), @p6='?', @p7='?', @p8='?', @p9='?' (DbType = DateTime), @p10='?', @p11='?' (DbType = Int32), @p19='?' (DbType = Int32), @p13='?' (DbType = DateTime), @p14='?', @p15='?', @p16='?' (DbType = DateTime), @p17='?', @p18='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE refresh_token SET created = @p0, created_by_ip = @p1, expires = @p2, is_active = @p3, is_expired = @p4, is_revoked = @p5, reason_revoked = @p6, token = @p7, replaced_by_token = @p8, revoked = @p9, revoked_by_ip = @p10, user_id = @p11
WHERE id = @p12;
UPDATE users SET created_at = @p13, email = @p14, full_name = @p15, password_changed_at = @p16, password_hash = @p17, username = @p18
WHERE id = @p19;
2022-09-23 15:14:57.305 +01:00 [DBG] A data reader was disposed.
2022-09-23 15:14:57.307 +01:00 [DBG] Committing transaction.
2022-09-23 15:14:57.311 +01:00 [DBG] Committed transaction.
2022-09-23 15:14:57.312 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:14:57.314 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 15:14:57.315 +01:00 [DBG] Disposing transaction.
2022-09-23 15:14:57.316 +01:00 [DBG] An entity of type 'User' tracked by 'PostgresContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 15:14:57.318 +01:00 [DBG] An entity of type 'RefreshToken' tracked by 'PostgresContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 15:14:57.319 +01:00 [DBG] SaveChanges completed for 'PostgresContext' with 2 entities written to the database.
2022-09-23 15:14:57.327 +01:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2022-09-23 15:14:57.333 +01:00 [DBG] Attempting to select an output formatter based on Accept header '["text/plain"]'.
2022-09-23 15:14:57.335 +01:00 [DBG] Could not find an output formatter based on content negotiation. Accepted types were (["text/plain"])
2022-09-23 15:14:57.336 +01:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2022-09-23 15:14:57.336 +01:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2022-09-23 15:14:57.337 +01:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2022-09-23 15:14:57.342 +01:00 [INF] Executing OkObjectResult, writing value of type 'APIBank.Models.MyRequestResponses.LoginResponse'.
2022-09-23 15:14:57.364 +01:00 [INF] Executed action APIBank.Controllers.UsersController.Login (APIBank) in 4849.5642ms
2022-09-23 15:14:57.366 +01:00 [INF] Executed endpoint 'APIBank.Controllers.UsersController.Login (APIBank)'
2022-09-23 15:14:57.373 +01:00 [DBG] 'PostgresContext' disposed.
2022-09-23 15:14:57.380 +01:00 [INF] Request finished HTTP/2 POST https://localhost:7036/api/Users/Login application/json 58 - 200 - application/json;+charset=utf-8 5469.1983ms
2022-09-23 15:15:23.327 +01:00 [INF] Request starting HTTP/2 POST https://localhost:7036/api/Transfers/TransferRequest application/json 75
2022-09-23 15:15:23.332 +01:00 [DBG] 1 candidate(s) found for the request path '/api/Transfers/TransferRequest'
2022-09-23 15:15:23.334 +01:00 [DBG] Endpoint 'APIBank.Controllers.TransfersController.Create (APIBank)' with route pattern 'api/Transfers/TransferRequest' is valid for the request path '/api/Transfers/TransferRequest'
2022-09-23 15:15:23.342 +01:00 [DBG] Request matched endpoint 'APIBank.Controllers.TransfersController.Create (APIBank)'
2022-09-23 15:15:23.343 +01:00 [DBG] Static files was skipped as the request already matched an endpoint.
2022-09-23 15:15:23.472 +01:00 [INF] Entity Framework Core 6.0.9 initialized 'PostgresContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:6.0.7+5b98e4b74de93b590b44aef8dd7967c03acc433c' with options: None
2022-09-23 15:15:23.492 +01:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .FirstOrDefault(e => EF.Property<int>(e, "Id") == __p_0)'
2022-09-23 15:15:23.504 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<User>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: User.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: User.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 1], [Property: User.Email (string) Required Index MaxLength(254), 2], [Property: User.FullName (string) Required MaxLength(100), 3], [Property: User.PasswordChangedAt (DateTime) Required ValueGenerated.OnAdd, 4], [Property: User.PasswordHash (string) Required MaxLength(200), 5], [Property: User.Username (string) Required Index MaxLength(50), 6] }
        SELECT TOP(1) u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
        FROM users AS u
        WHERE u.id == @__p_0), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, User>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)
    .SingleOrDefault()'
2022-09-23 15:15:23.507 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 15:15:23.510 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (2ms).
2022-09-23 15:15:23.511 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 15:15:23.512 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:15:23.513 +01:00 [DBG] Executing DbCommand [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.id = @__p_0
LIMIT 1
2022-09-23 15:15:23.515 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.id = @__p_0
LIMIT 1
2022-09-23 15:15:23.517 +01:00 [DBG] Context 'PostgresContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 15:15:23.520 +01:00 [DBG] A data reader was disposed.
2022-09-23 15:15:23.521 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:15:23.523 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 15:15:23.523 +01:00 [INF] Executing endpoint 'APIBank.Controllers.TransfersController.Create (APIBank)'
2022-09-23 15:15:23.527 +01:00 [INF] Route matched with {action = "Create", controller = "Transfers"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult Create(APIBank.Models.Requests.TransferRequest) on controller APIBank.Controllers.TransfersController (APIBank).
2022-09-23 15:15:23.529 +01:00 [DBG] Execution plan of authorization filters (in the following order): ["APIBank.Authorization.AuthorizeAttribute"]
2022-09-23 15:15:23.530 +01:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2022-09-23 15:15:23.531 +01:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2022-09-23 15:15:23.532 +01:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2022-09-23 15:15:23.533 +01:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2022-09-23 15:15:23.534 +01:00 [DBG] Executing controller factory for controller APIBank.Controllers.TransfersController (APIBank)
2022-09-23 15:15:23.536 +01:00 [DBG] Executed controller factory for controller APIBank.Controllers.TransfersController (APIBank)
2022-09-23 15:15:23.538 +01:00 [DBG] Attempting to bind parameter 'model' of type 'APIBank.Models.Requests.TransferRequest' ...
2022-09-23 15:15:23.539 +01:00 [DBG] Attempting to bind parameter 'model' of type 'APIBank.Models.Requests.TransferRequest' using the name '' in request data ...
2022-09-23 15:15:23.542 +01:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2022-09-23 15:15:23.545 +01:00 [DBG] Connection id "0HMKTDNPCQ9L8", Request id "0HMKTDNPCQ9L8:0000000B": started reading request body.
2022-09-23 15:15:23.546 +01:00 [DBG] Connection id "0HMKTDNPCQ9L8", Request id "0HMKTDNPCQ9L8:0000000B": done reading request body.
2022-09-23 15:15:23.550 +01:00 [DBG] JSON input formatter succeeded, deserializing to type 'APIBank.Models.Requests.TransferRequest'
2022-09-23 15:15:23.553 +01:00 [DBG] Done attempting to bind parameter 'model' of type 'APIBank.Models.Requests.TransferRequest'.
2022-09-23 15:15:23.554 +01:00 [DBG] Done attempting to bind parameter 'model' of type 'APIBank.Models.Requests.TransferRequest'.
2022-09-23 15:15:23.557 +01:00 [DBG] Attempting to validate the bound parameter 'model' of type 'APIBank.Models.Requests.TransferRequest' ...
2022-09-23 15:15:23.560 +01:00 [DBG] Done attempting to validate the bound parameter 'model' of type 'APIBank.Models.Requests.TransferRequest'.
2022-09-23 15:15:23.573 +01:00 [DBG] Compiling query expression: 
'DbSet<Account>()
    .Include(a => a.Transactions)
    .Where(a => a.Id == __accountId_0 && a.UserId == __userId_1)
    .Select(a => new AccountMovims{ 
        Account = new AccountRequestResponse{ 
            Balance = a.Balance, 
            Currency = a.Currency, 
            CreatedAt = a.CreatedAt, 
            Id = a.Id 
        }
        , 
        Movims = a.Transactions
            .Select(b => new Movim{ 
                Amount = b.Amount, 
                CreatedAt = b.CreatedAt 
            }
            )
            .ToArray() 
    }
    )
    .SingleOrDefault()'
2022-09-23 15:15:23.685 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<AccountMovims>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Client Projections:
            0 -> 0
            1 -> 1
            2 -> 2
            3 -> 3
            4 -> 4
            5 -> 5
            6 -> 6
        SELECT t.balance, t.currency, t.created_at, t.id, t0.amount, t0.created_at, t0.id
        FROM 
        (
            SELECT TOP(2) a.balance, a.currency, a.created_at, a.id
            FROM accounts AS a
            WHERE (a.id == @__accountId_0) && (a.user_id == @__userId_1)
        ) AS t
        LEFT JOIN transactions AS t0 ON t.id == t0.account_id
        ORDER BY t.id ASC), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, AccountMovims>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)
    .SingleOrDefault()'
2022-09-23 15:15:23.698 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 15:15:23.699 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2022-09-23 15:15:23.704 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 15:15:23.707 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:15:23.709 +01:00 [DBG] Executing DbCommand [Parameters=[@__accountId_0='?' (DbType = Int32), @__userId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT t.balance, t.currency, t.created_at, t.id, t0.amount, t0.created_at, t0.id
FROM (
    SELECT a.balance, a.currency, a.created_at, a.id
    FROM accounts AS a
    WHERE (a.id = @__accountId_0) AND (a.user_id = @__userId_1)
    LIMIT 2
) AS t
LEFT JOIN transactions AS t0 ON t.id = t0.account_id
ORDER BY t.id
2022-09-23 15:15:23.716 +01:00 [INF] Executed DbCommand (7ms) [Parameters=[@__accountId_0='?' (DbType = Int32), @__userId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT t.balance, t.currency, t.created_at, t.id, t0.amount, t0.created_at, t0.id
FROM (
    SELECT a.balance, a.currency, a.created_at, a.id
    FROM accounts AS a
    WHERE (a.id = @__accountId_0) AND (a.user_id = @__userId_1)
    LIMIT 2
) AS t
LEFT JOIN transactions AS t0 ON t.id = t0.account_id
ORDER BY t.id
2022-09-23 15:15:23.744 +01:00 [DBG] A data reader was disposed.
2022-09-23 15:15:23.746 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:15:23.747 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 15:18:27.888 +01:00 [INF] Executed action APIBank.Controllers.TransfersController.Create (APIBank) in 184351.443ms
2022-09-23 15:18:27.892 +01:00 [INF] Executed endpoint 'APIBank.Controllers.TransfersController.Create (APIBank)'
2022-09-23 15:21:49.245 +01:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2022-09-23 15:21:49.490 +01:00 [DBG] Hosting starting
2022-09-23 15:21:49.872 +01:00 [DBG] Using development certificate: CN=localhost (Thumbprint: 9CC642E9838495A6C3C202DECA6A8AD300396DD2)
2022-09-23 15:21:50.261 +01:00 [INF] Now listening on: https://localhost:7036
2022-09-23 15:21:50.277 +01:00 [DBG] Connection id "0HMKTDRQAA3SC" received FIN.
2022-09-23 15:21:50.277 +01:00 [DBG] Connection id "0HMKTDRQAA3SD" received FIN.
2022-09-23 15:21:50.280 +01:00 [INF] Now listening on: http://localhost:5036
2022-09-23 15:21:50.303 +01:00 [DBG] Loaded hosting startup assembly APIBank
2022-09-23 15:21:50.304 +01:00 [DBG] Loaded hosting startup assembly Microsoft.AspNetCore.Watch.BrowserRefresh
2022-09-23 15:21:50.305 +01:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.BrowserLink.Net
2022-09-23 15:21:50.306 +01:00 [INF] Application started. Press Ctrl+C to shut down.
2022-09-23 15:21:50.308 +01:00 [INF] Hosting environment: Development
2022-09-23 15:21:50.309 +01:00 [INF] Content root path: C:\Users\mguedesa\OneDrive - NTT DATA EMEAL\Documentos\GitHub\OpenBankAPI-NTT\APIBank\APIBank\
2022-09-23 15:21:50.310 +01:00 [DBG] Hosting started
2022-09-23 15:21:50.331 +01:00 [DBG] Connection id "0HMKTDRQAA3SC" accepted.
2022-09-23 15:21:50.331 +01:00 [DBG] Connection id "0HMKTDRQAA3SD" accepted.
2022-09-23 15:21:50.334 +01:00 [DBG] Connection id "0HMKTDRQAA3SC" started.
2022-09-23 15:21:50.334 +01:00 [DBG] Connection id "0HMKTDRQAA3SD" started.
2022-09-23 15:21:50.369 +01:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException:  Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveBlobAsync[TIOAdapter](TIOAdapter adapter)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](TIOAdapter adapter, Boolean receiveFirst, Byte[] reAuthenticationData, Boolean isApm)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2022-09-23 15:21:50.469 +01:00 [DBG] Connection id "0HMKTDRQAA3SE" accepted.
2022-09-23 15:21:50.369 +01:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException:  Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveBlobAsync[TIOAdapter](TIOAdapter adapter)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](TIOAdapter adapter, Boolean receiveFirst, Byte[] reAuthenticationData, Boolean isApm)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2022-09-23 15:21:50.534 +01:00 [DBG] Connection id "0HMKTDRQAA3SE" started.
2022-09-23 15:21:50.547 +01:00 [DBG] Connection id "0HMKTDRQAA3SD" stopped.
2022-09-23 15:21:50.548 +01:00 [DBG] Connection id "0HMKTDRQAA3SC" stopped.
2022-09-23 15:21:50.582 +01:00 [DBG] Connection id "0HMKTDRQAA3SC" sending FIN because: "The Socket transport's send loop completed gracefully."
2022-09-23 15:21:50.582 +01:00 [DBG] Connection id "0HMKTDRQAA3SD" sending FIN because: "The Socket transport's send loop completed gracefully."
2022-09-23 15:21:50.644 +01:00 [DBG] Connection 0HMKTDRQAA3SE established using the following protocol: "Tls12"
2022-09-23 15:21:50.780 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/swagger/index.html - -
2022-09-23 15:21:50.848 +01:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2022-09-23 15:21:50.910 +01:00 [DBG] No candidates found for the request path '/swagger/index.html'
2022-09-23 15:21:50.913 +01:00 [DBG] Request did not match any endpoints
2022-09-23 15:21:51.107 +01:00 [DBG] Response markup is scheduled to include browser refresh script injection.
2022-09-23 15:21:51.412 +01:00 [DBG] Response markup was updated to include browser refresh script injection.
2022-09-23 15:21:51.509 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/_framework/aspnetcore-browser-refresh.js - -
2022-09-23 15:21:51.509 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/_vs/browserLink - -
2022-09-23 15:21:51.512 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/swagger/index.html - - - 200 - text/html;charset=utf-8 736.9841ms
2022-09-23 15:21:51.533 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/_framework/aspnetcore-browser-refresh.js - - - 200 11984 application/javascript;+charset=utf-8 23.2443ms
2022-09-23 15:21:51.632 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/_vs/browserLink - - - 200 - text/javascript;+charset=UTF-8 122.2493ms
2022-09-23 15:21:51.711 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/swagger/v1/swagger.json - -
2022-09-23 15:21:51.713 +01:00 [DBG] No candidates found for the request path '/swagger/v1/swagger.json'
2022-09-23 15:21:51.714 +01:00 [DBG] Request did not match any endpoints
2022-09-23 15:21:52.176 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/swagger/v1/swagger.json - - - 200 - application/json;charset=utf-8 465.1305ms
2022-09-23 15:23:07.459 +01:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2022-09-23 15:23:07.602 +01:00 [DBG] Hosting starting
2022-09-23 15:23:07.812 +01:00 [DBG] Using development certificate: CN=localhost (Thumbprint: 9CC642E9838495A6C3C202DECA6A8AD300396DD2)
2022-09-23 15:23:07.884 +01:00 [INF] Now listening on: https://localhost:7036
2022-09-23 15:23:08.136 +01:00 [INF] Now listening on: http://localhost:5036
2022-09-23 15:23:08.143 +01:00 [DBG] Loaded hosting startup assembly APIBank
2022-09-23 15:23:08.143 +01:00 [DBG] Loaded hosting startup assembly Microsoft.AspNetCore.Watch.BrowserRefresh
2022-09-23 15:23:08.149 +01:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.BrowserLink.Net
2022-09-23 15:23:08.150 +01:00 [INF] Application started. Press Ctrl+C to shut down.
2022-09-23 15:23:08.151 +01:00 [INF] Hosting environment: Development
2022-09-23 15:23:08.157 +01:00 [INF] Content root path: C:\Users\mguedesa\OneDrive - NTT DATA EMEAL\Documentos\GitHub\OpenBankAPI-NTT\APIBank\APIBank\
2022-09-23 15:23:08.158 +01:00 [DBG] Hosting started
2022-09-23 15:23:08.236 +01:00 [DBG] Connection id "0HMKTDSHHPGJ8" received FIN.
2022-09-23 15:23:08.236 +01:00 [DBG] Connection id "0HMKTDSHHPGJ9" received FIN.
2022-09-23 15:23:08.417 +01:00 [DBG] Connection id "0HMKTDSHHPGJ8" accepted.
2022-09-23 15:23:08.418 +01:00 [DBG] Connection id "0HMKTDSHHPGJ9" accepted.
2022-09-23 15:23:08.602 +01:00 [DBG] Connection id "0HMKTDSHHPGJ8" started.
2022-09-23 15:23:08.603 +01:00 [DBG] Connection id "0HMKTDSHHPGJ9" started.
2022-09-23 15:23:08.776 +01:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException:  Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveBlobAsync[TIOAdapter](TIOAdapter adapter)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](TIOAdapter adapter, Boolean receiveFirst, Byte[] reAuthenticationData, Boolean isApm)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2022-09-23 15:23:08.781 +01:00 [DBG] Connection id "0HMKTDSHHPGJA" accepted.
2022-09-23 15:23:08.776 +01:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException:  Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveBlobAsync[TIOAdapter](TIOAdapter adapter)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](TIOAdapter adapter, Boolean receiveFirst, Byte[] reAuthenticationData, Boolean isApm)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2022-09-23 15:23:08.897 +01:00 [DBG] Connection id "0HMKTDSHHPGJA" started.
2022-09-23 15:23:08.915 +01:00 [DBG] Connection id "0HMKTDSHHPGJ9" stopped.
2022-09-23 15:23:08.915 +01:00 [DBG] Connection id "0HMKTDSHHPGJ8" stopped.
2022-09-23 15:23:08.929 +01:00 [DBG] Connection id "0HMKTDSHHPGJ8" sending FIN because: "The Socket transport's send loop completed gracefully."
2022-09-23 15:23:08.929 +01:00 [DBG] Connection id "0HMKTDSHHPGJ9" sending FIN because: "The Socket transport's send loop completed gracefully."
2022-09-23 15:23:09.027 +01:00 [DBG] Connection 0HMKTDSHHPGJA established using the following protocol: "Tls12"
2022-09-23 15:23:09.131 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/swagger/index.html - -
2022-09-23 15:23:09.196 +01:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2022-09-23 15:23:09.258 +01:00 [DBG] No candidates found for the request path '/swagger/index.html'
2022-09-23 15:23:09.265 +01:00 [DBG] Request did not match any endpoints
2022-09-23 15:23:09.458 +01:00 [DBG] Response markup is scheduled to include browser refresh script injection.
2022-09-23 15:23:09.968 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/_vs/browserLink - -
2022-09-23 15:23:09.970 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/_framework/aspnetcore-browser-refresh.js - -
2022-09-23 15:23:09.974 +01:00 [DBG] Response markup was updated to include browser refresh script injection.
2022-09-23 15:23:09.996 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/swagger/index.html - - - 200 - text/html;charset=utf-8 867.5026ms
2022-09-23 15:23:10.002 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/_framework/aspnetcore-browser-refresh.js - - - 200 11984 application/javascript;+charset=utf-8 24.4914ms
2022-09-23 15:23:10.127 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/_vs/browserLink - - - 200 - text/javascript;+charset=UTF-8 159.3833ms
2022-09-23 15:23:10.208 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/swagger/v1/swagger.json - -
2022-09-23 15:23:10.211 +01:00 [DBG] No candidates found for the request path '/swagger/v1/swagger.json'
2022-09-23 15:23:10.213 +01:00 [DBG] Request did not match any endpoints
2022-09-23 15:23:10.471 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/swagger/v1/swagger.json - - - 200 - application/json;charset=utf-8 262.5995ms
2022-09-23 15:23:52.896 +01:00 [INF] Request starting HTTP/2 POST https://localhost:7036/api/Users/Login application/json 58
2022-09-23 15:23:52.919 +01:00 [DBG] 1 candidate(s) found for the request path '/api/Users/Login'
2022-09-23 15:23:52.924 +01:00 [DBG] Endpoint 'APIBank.Controllers.UsersController.Login (APIBank)' with route pattern 'api/Users/Login' is valid for the request path '/api/Users/Login'
2022-09-23 15:23:52.926 +01:00 [DBG] Request matched endpoint 'APIBank.Controllers.UsersController.Login (APIBank)'
2022-09-23 15:23:52.930 +01:00 [DBG] Static files was skipped as the request already matched an endpoint.
2022-09-23 15:23:53.506 +01:00 [INF] Executing endpoint 'APIBank.Controllers.UsersController.Login (APIBank)'
2022-09-23 15:23:53.557 +01:00 [INF] Route matched with {action = "Login", controller = "Users"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult Login(APIBank.Models.Requests.UserLoginRequest) on controller APIBank.Controllers.UsersController (APIBank).
2022-09-23 15:23:53.561 +01:00 [DBG] Execution plan of authorization filters (in the following order): ["APIBank.Authorization.AuthorizeAttribute"]
2022-09-23 15:23:53.563 +01:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2022-09-23 15:23:53.568 +01:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2022-09-23 15:23:53.571 +01:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2022-09-23 15:23:53.572 +01:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2022-09-23 15:23:53.576 +01:00 [DBG] Executing controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-23 15:23:53.578 +01:00 [DBG] Executed controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-23 15:23:53.605 +01:00 [DBG] Attempting to bind parameter 'model' of type 'APIBank.Models.Requests.UserLoginRequest' ...
2022-09-23 15:23:53.610 +01:00 [DBG] Attempting to bind parameter 'model' of type 'APIBank.Models.Requests.UserLoginRequest' using the name '' in request data ...
2022-09-23 15:23:53.614 +01:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2022-09-23 15:23:53.623 +01:00 [DBG] Connection id "0HMKTDSHHPGJA", Request id "0HMKTDSHHPGJA:00000009": started reading request body.
2022-09-23 15:23:53.625 +01:00 [DBG] Connection id "0HMKTDSHHPGJA", Request id "0HMKTDSHHPGJA:00000009": done reading request body.
2022-09-23 15:23:53.637 +01:00 [DBG] JSON input formatter succeeded, deserializing to type 'APIBank.Models.Requests.UserLoginRequest'
2022-09-23 15:23:53.639 +01:00 [DBG] Done attempting to bind parameter 'model' of type 'APIBank.Models.Requests.UserLoginRequest'.
2022-09-23 15:23:53.640 +01:00 [DBG] Done attempting to bind parameter 'model' of type 'APIBank.Models.Requests.UserLoginRequest'.
2022-09-23 15:23:53.641 +01:00 [DBG] Attempting to validate the bound parameter 'model' of type 'APIBank.Models.Requests.UserLoginRequest' ...
2022-09-23 15:23:53.655 +01:00 [DBG] Done attempting to validate the bound parameter 'model' of type 'APIBank.Models.Requests.UserLoginRequest'.
2022-09-23 15:23:53.818 +01:00 [DBG] An additional 'IServiceProvider' was created for internal use by Entity Framework. An existing service provider was not used due to the following configuration changes: configuration changed for 'Core:ConfigureWarnings', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:UseAdminDatabase', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:SetPostgresVersion', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:UseRedshift', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:ReverseNullOrdering', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:RemoteCertificateValidationCallback', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:ProvideClientCertificatesCallback', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:ProvidePasswordCallback'.
2022-09-23 15:23:55.296 +01:00 [INF] Entity Framework Core 6.0.9 initialized 'PostgresContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:6.0.7+5b98e4b74de93b590b44aef8dd7967c03acc433c' with options: None
2022-09-23 15:23:55.380 +01:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .SingleOrDefault(x => x.Username == __model_Username_0)'
2022-09-23 15:23:55.947 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<User>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: User.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: User.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 1], [Property: User.Email (string) Required Index MaxLength(254), 2], [Property: User.FullName (string) Required MaxLength(100), 3], [Property: User.PasswordChangedAt (DateTime) Required ValueGenerated.OnAdd, 4], [Property: User.PasswordHash (string) Required MaxLength(200), 5], [Property: User.Username (string) Required Index MaxLength(50), 6] }
        SELECT TOP(2) u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
        FROM users AS u
        WHERE u.username == @__model_Username_0), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, User>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)
    .SingleOrDefault()'
2022-09-23 15:23:56.004 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 15:23:56.113 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (107ms).
2022-09-23 15:23:56.132 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 15:23:56.466 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:23:56.491 +01:00 [DBG] Executing DbCommand [Parameters=[@__model_Username_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.username = @__model_Username_0
LIMIT 2
2022-09-23 15:23:56.635 +01:00 [INF] Executed DbCommand (152ms) [Parameters=[@__model_Username_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.username = @__model_Username_0
LIMIT 2
2022-09-23 15:23:56.723 +01:00 [DBG] Context 'PostgresContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 15:23:56.783 +01:00 [DBG] A data reader was disposed.
2022-09-23 15:23:56.789 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:23:56.801 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 15:23:57.020 +01:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .Any(user => user.RefreshTokenCollection
        .Any(reftoken => reftoken.RefToken == __token_0))'
2022-09-23 15:23:57.162 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<bool>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            EmptyProjectionMember -> 0
        SELECT EXISTS (
            SELECT 1
            FROM users AS u
            WHERE EXISTS (
                SELECT 1
                FROM refresh_token AS r
                WHERE ((u.id != NULL) && (u.id == r.user_id)) && (r.token == @__token_0)))), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, bool>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)
    .Single()'
2022-09-23 15:23:57.178 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 15:23:57.180 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (2ms).
2022-09-23 15:23:57.181 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 15:23:57.182 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:23:57.182 +01:00 [DBG] Executing DbCommand [Parameters=[@__token_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM users AS u
    WHERE EXISTS (
        SELECT 1
        FROM refresh_token AS r
        WHERE (u.id = r.user_id) AND (r.token = @__token_0)))
2022-09-23 15:23:57.185 +01:00 [INF] Executed DbCommand (3ms) [Parameters=[@__token_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM users AS u
    WHERE EXISTS (
        SELECT 1
        FROM refresh_token AS r
        WHERE (u.id = r.user_id) AND (r.token = @__token_0)))
2022-09-23 15:23:57.191 +01:00 [DBG] A data reader was disposed.
2022-09-23 15:23:57.192 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:23:57.194 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 15:23:57.198 +01:00 [DBG] SaveChanges starting for 'PostgresContext'.
2022-09-23 15:23:57.201 +01:00 [DBG] DetectChanges starting for 'PostgresContext'.
2022-09-23 15:23:57.233 +01:00 [DBG] 1 entities were added and 0 entities were removed from navigation 'User.RefreshTokenCollection'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 15:23:57.279 +01:00 [DBG] 'PostgresContext' generated a temporary value for the property 'Id.RefreshToken'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 15:23:57.355 +01:00 [DBG] Context 'PostgresContext' started tracking 'RefreshToken' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 15:23:57.364 +01:00 [DBG] DetectChanges completed for 'PostgresContext'.
2022-09-23 15:23:57.379 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 15:23:57.381 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:23:57.385 +01:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2022-09-23 15:23:57.399 +01:00 [DBG] Began transaction with isolation level 'ReadCommitted'.
2022-09-23 15:23:57.472 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 15:23:57.475 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (3ms).
2022-09-23 15:23:57.478 +01:00 [DBG] Executing DbCommand [Parameters=[@p0='?' (DbType = DateTime), @p1='?', @p2='?' (DbType = DateTime), @p3='?' (DbType = Boolean), @p4='?' (DbType = Boolean), @p5='?' (DbType = Boolean), @p6='?', @p7='?', @p8='?', @p9='?' (DbType = DateTime), @p10='?', @p11='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO refresh_token (created, created_by_ip, expires, is_active, is_expired, is_revoked, reason_revoked, token, replaced_by_token, revoked, revoked_by_ip, user_id)
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11)
RETURNING id;
2022-09-23 15:23:57.497 +01:00 [INF] Executed DbCommand (19ms) [Parameters=[@p0='?' (DbType = DateTime), @p1='?', @p2='?' (DbType = DateTime), @p3='?' (DbType = Boolean), @p4='?' (DbType = Boolean), @p5='?' (DbType = Boolean), @p6='?', @p7='?', @p8='?', @p9='?' (DbType = DateTime), @p10='?', @p11='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO refresh_token (created, created_by_ip, expires, is_active, is_expired, is_revoked, reason_revoked, token, replaced_by_token, revoked, revoked_by_ip, user_id)
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11)
RETURNING id;
2022-09-23 15:23:57.523 +01:00 [DBG] The foreign key property 'RefreshToken.Id' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2022-09-23 15:23:57.531 +01:00 [DBG] A data reader was disposed.
2022-09-23 15:23:57.536 +01:00 [DBG] Committing transaction.
2022-09-23 15:23:57.547 +01:00 [DBG] Committed transaction.
2022-09-23 15:23:57.549 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:23:57.551 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 15:23:57.554 +01:00 [DBG] Disposing transaction.
2022-09-23 15:23:57.566 +01:00 [DBG] An entity of type 'RefreshToken' tracked by 'PostgresContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 15:23:57.569 +01:00 [DBG] SaveChanges completed for 'PostgresContext' with 1 entities written to the database.
2022-09-23 15:23:57.830 +01:00 [DBG] Compiling query expression: 
'DbSet<RefreshToken>()
    .Where(rt => rt.UserId == __id_0)
    .AsNoTracking()
    .Select(rt => new RefreshToken{ 
        Id = rt.Id, 
        UserId = rt.UserId, 
        RefToken = rt.RefToken, 
        Expires = rt.Expires, 
        Created = rt.Created, 
        CreatedByIp = rt.CreatedByIp, 
        Revoked = rt.Revoked, 
        RevokedByIp = rt.RevokedByIp, 
        ReplacedByToken = rt.ReplacedByToken, 
        ReasonRevoked = rt.ReasonRevoked, 
        IsExpired = rt.IsExpired, 
        IsRevoked = rt.IsRevoked, 
        IsActive = rt.IsActive 
    }
    )'
2022-09-23 15:23:57.856 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<RefreshToken>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            Id -> 0
            UserId -> 1
            RefToken -> 2
            Expires -> 3
            Created -> 4
            CreatedByIp -> 5
            Revoked -> 6
            RevokedByIp -> 7
            ReplacedByToken -> 8
            ReasonRevoked -> 9
            IsExpired -> 10
            IsRevoked -> 11
            IsActive -> 12
        SELECT r.id AS Id, r.user_id AS UserId, r.token AS RefToken, r.expires AS Expires, r.created AS Created, r.created_by_ip AS CreatedByIp, r.revoked AS Revoked, r.revoked_by_ip AS RevokedByIp, r.replaced_by_token AS ReplacedByToken, r.reason_revoked AS ReasonRevoked, r.is_expired AS IsExpired, r.is_revoked AS IsRevoked, r.is_active AS IsActive
        FROM refresh_token AS r
        WHERE r.user_id == @__id_0), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, RefreshToken>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)'
2022-09-23 15:23:57.858 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 15:23:57.860 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2022-09-23 15:23:57.863 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 15:23:57.864 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:23:57.865 +01:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.user_id AS "UserId", r.token AS "RefToken", r.expires AS "Expires", r.created AS "Created", r.created_by_ip AS "CreatedByIp", r.revoked AS "Revoked", r.revoked_by_ip AS "RevokedByIp", r.replaced_by_token AS "ReplacedByToken", r.reason_revoked AS "ReasonRevoked", r.is_expired AS "IsExpired", r.is_revoked AS "IsRevoked", r.is_active AS "IsActive"
FROM refresh_token AS r
WHERE r.user_id = @__id_0
2022-09-23 15:23:57.867 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.user_id AS "UserId", r.token AS "RefToken", r.expires AS "Expires", r.created AS "Created", r.created_by_ip AS "CreatedByIp", r.revoked AS "Revoked", r.revoked_by_ip AS "RevokedByIp", r.replaced_by_token AS "ReplacedByToken", r.reason_revoked AS "ReasonRevoked", r.is_expired AS "IsExpired", r.is_revoked AS "IsRevoked", r.is_active AS "IsActive"
FROM refresh_token AS r
WHERE r.user_id = @__id_0
2022-09-23 15:23:57.870 +01:00 [DBG] A data reader was disposed.
2022-09-23 15:23:57.871 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:23:57.871 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 15:23:57.874 +01:00 [DBG] An entity of type 'User' tracked by 'PostgresContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 15:23:57.877 +01:00 [DBG] An entity of type 'RefreshToken' tracked by 'PostgresContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 15:23:57.879 +01:00 [DBG] SaveChanges starting for 'PostgresContext'.
2022-09-23 15:23:57.880 +01:00 [DBG] DetectChanges starting for 'PostgresContext'.
2022-09-23 15:23:57.881 +01:00 [DBG] DetectChanges completed for 'PostgresContext'.
2022-09-23 15:23:57.883 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 15:23:57.883 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:23:57.884 +01:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2022-09-23 15:23:57.885 +01:00 [DBG] Began transaction with isolation level 'ReadCommitted'.
2022-09-23 15:23:57.905 +01:00 [DBG] Executing 2 update commands as a batch.
2022-09-23 15:23:57.911 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 15:23:57.912 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2022-09-23 15:23:57.913 +01:00 [DBG] Executing DbCommand [Parameters=[@p12='?' (DbType = Int32), @p0='?' (DbType = DateTime), @p1='?', @p2='?' (DbType = DateTime), @p3='?' (DbType = Boolean), @p4='?' (DbType = Boolean), @p5='?' (DbType = Boolean), @p6='?', @p7='?', @p8='?', @p9='?' (DbType = DateTime), @p10='?', @p11='?' (DbType = Int32), @p19='?' (DbType = Int32), @p13='?' (DbType = DateTime), @p14='?', @p15='?', @p16='?' (DbType = DateTime), @p17='?', @p18='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE refresh_token SET created = @p0, created_by_ip = @p1, expires = @p2, is_active = @p3, is_expired = @p4, is_revoked = @p5, reason_revoked = @p6, token = @p7, replaced_by_token = @p8, revoked = @p9, revoked_by_ip = @p10, user_id = @p11
WHERE id = @p12;
UPDATE users SET created_at = @p13, email = @p14, full_name = @p15, password_changed_at = @p16, password_hash = @p17, username = @p18
WHERE id = @p19;
2022-09-23 15:23:57.916 +01:00 [INF] Executed DbCommand (4ms) [Parameters=[@p12='?' (DbType = Int32), @p0='?' (DbType = DateTime), @p1='?', @p2='?' (DbType = DateTime), @p3='?' (DbType = Boolean), @p4='?' (DbType = Boolean), @p5='?' (DbType = Boolean), @p6='?', @p7='?', @p8='?', @p9='?' (DbType = DateTime), @p10='?', @p11='?' (DbType = Int32), @p19='?' (DbType = Int32), @p13='?' (DbType = DateTime), @p14='?', @p15='?', @p16='?' (DbType = DateTime), @p17='?', @p18='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE refresh_token SET created = @p0, created_by_ip = @p1, expires = @p2, is_active = @p3, is_expired = @p4, is_revoked = @p5, reason_revoked = @p6, token = @p7, replaced_by_token = @p8, revoked = @p9, revoked_by_ip = @p10, user_id = @p11
WHERE id = @p12;
UPDATE users SET created_at = @p13, email = @p14, full_name = @p15, password_changed_at = @p16, password_hash = @p17, username = @p18
WHERE id = @p19;
2022-09-23 15:23:57.919 +01:00 [DBG] A data reader was disposed.
2022-09-23 15:23:57.919 +01:00 [DBG] Committing transaction.
2022-09-23 15:23:57.921 +01:00 [DBG] Committed transaction.
2022-09-23 15:23:57.921 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:23:57.922 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 15:23:57.923 +01:00 [DBG] Disposing transaction.
2022-09-23 15:23:57.927 +01:00 [DBG] An entity of type 'User' tracked by 'PostgresContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 15:23:57.929 +01:00 [DBG] An entity of type 'RefreshToken' tracked by 'PostgresContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 15:23:57.931 +01:00 [DBG] SaveChanges completed for 'PostgresContext' with 2 entities written to the database.
2022-09-23 15:23:57.940 +01:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2022-09-23 15:23:57.949 +01:00 [DBG] Attempting to select an output formatter based on Accept header '["text/plain"]'.
2022-09-23 15:23:57.950 +01:00 [DBG] Could not find an output formatter based on content negotiation. Accepted types were (["text/plain"])
2022-09-23 15:23:57.952 +01:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2022-09-23 15:23:57.953 +01:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2022-09-23 15:23:57.956 +01:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2022-09-23 15:23:57.957 +01:00 [INF] Executing OkObjectResult, writing value of type 'APIBank.Models.MyRequestResponses.LoginResponse'.
2022-09-23 15:23:57.979 +01:00 [INF] Executed action APIBank.Controllers.UsersController.Login (APIBank) in 4397.8371ms
2022-09-23 15:23:57.981 +01:00 [INF] Executed endpoint 'APIBank.Controllers.UsersController.Login (APIBank)'
2022-09-23 15:23:57.987 +01:00 [DBG] 'PostgresContext' disposed.
2022-09-23 15:23:57.996 +01:00 [INF] Request finished HTTP/2 POST https://localhost:7036/api/Users/Login application/json 58 - 200 - application/json;+charset=utf-8 5100.2619ms
2022-09-23 15:24:10.084 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/api/Accounts/GetAll - -
2022-09-23 15:24:10.089 +01:00 [DBG] 1 candidate(s) found for the request path '/api/Accounts/GetAll'
2022-09-23 15:24:10.091 +01:00 [DBG] Endpoint 'APIBank.Controllers.AccountsController.GetAllFromUser (APIBank)' with route pattern 'api/Accounts/GetAll' is valid for the request path '/api/Accounts/GetAll'
2022-09-23 15:24:10.097 +01:00 [DBG] Request matched endpoint 'APIBank.Controllers.AccountsController.GetAllFromUser (APIBank)'
2022-09-23 15:24:10.100 +01:00 [DBG] Static files was skipped as the request already matched an endpoint.
2022-09-23 15:24:10.223 +01:00 [INF] Entity Framework Core 6.0.9 initialized 'PostgresContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:6.0.7+5b98e4b74de93b590b44aef8dd7967c03acc433c' with options: None
2022-09-23 15:24:10.238 +01:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .FirstOrDefault(e => EF.Property<int>(e, "Id") == __p_0)'
2022-09-23 15:24:10.242 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<User>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: User.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: User.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 1], [Property: User.Email (string) Required Index MaxLength(254), 2], [Property: User.FullName (string) Required MaxLength(100), 3], [Property: User.PasswordChangedAt (DateTime) Required ValueGenerated.OnAdd, 4], [Property: User.PasswordHash (string) Required MaxLength(200), 5], [Property: User.Username (string) Required Index MaxLength(50), 6] }
        SELECT TOP(1) u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
        FROM users AS u
        WHERE u.id == @__p_0), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, User>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)
    .SingleOrDefault()'
2022-09-23 15:24:10.243 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 15:24:10.244 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2022-09-23 15:24:10.244 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 15:24:10.245 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:24:10.246 +01:00 [DBG] Executing DbCommand [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.id = @__p_0
LIMIT 1
2022-09-23 15:24:10.248 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.id = @__p_0
LIMIT 1
2022-09-23 15:24:10.253 +01:00 [DBG] Context 'PostgresContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 15:24:10.255 +01:00 [DBG] A data reader was disposed.
2022-09-23 15:24:10.255 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:24:10.256 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 15:24:10.257 +01:00 [INF] Executing endpoint 'APIBank.Controllers.AccountsController.GetAllFromUser (APIBank)'
2022-09-23 15:24:10.259 +01:00 [INF] Route matched with {action = "GetAllFromUser", controller = "Accounts"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult GetAllFromUser() on controller APIBank.Controllers.AccountsController (APIBank).
2022-09-23 15:24:10.261 +01:00 [DBG] Execution plan of authorization filters (in the following order): ["APIBank.Authorization.AuthorizeAttribute"]
2022-09-23 15:24:10.262 +01:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2022-09-23 15:24:10.263 +01:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2022-09-23 15:24:10.264 +01:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2022-09-23 15:24:10.268 +01:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2022-09-23 15:24:10.270 +01:00 [DBG] Executing controller factory for controller APIBank.Controllers.AccountsController (APIBank)
2022-09-23 15:24:10.273 +01:00 [DBG] Executed controller factory for controller APIBank.Controllers.AccountsController (APIBank)
2022-09-23 15:24:10.278 +01:00 [DBG] Compiling query expression: 
'DbSet<RefreshToken>()
    .FirstOrDefault(e => EF.Property<int>(e, "Id") == __p_0)'
2022-09-23 15:24:10.288 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<RefreshToken>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: RefreshToken.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: RefreshToken.Created (DateTime) Required, 1], [Property: RefreshToken.CreatedByIp (string) Required MaxLength(200), 2], [Property: RefreshToken.Expires (DateTime) Required, 3], [Property: RefreshToken.IsActive (no field, bool) Required, 4], [Property: RefreshToken.IsExpired (no field, bool) Required, 5], [Property: RefreshToken.IsRevoked (no field, bool) Required, 6], [Property: RefreshToken.ReasonRevoked (string) MaxLength(200), 7], [Property: RefreshToken.RefToken (string) Required MaxLength(254), 8], [Property: RefreshToken.ReplacedByToken (string) MaxLength(200), 9], [Property: RefreshToken.Revoked (DateTime?), 10], [Property: RefreshToken.RevokedByIp (string) MaxLength(200), 11], [Property: RefreshToken.UserId (int) Required FK Index, 12] }
        SELECT TOP(1) r.id, r.created, r.created_by_ip, r.expires, r.is_active, r.is_expired, r.is_revoked, r.reason_revoked, r.token, r.replaced_by_token, r.revoked, r.revoked_by_ip, r.user_id
        FROM refresh_token AS r
        WHERE r.id == @__p_0), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, RefreshToken>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)
    .SingleOrDefault()'
2022-09-23 15:24:10.292 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 15:24:10.294 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2022-09-23 15:24:10.295 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 15:24:10.301 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:24:10.304 +01:00 [DBG] Executing DbCommand [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id, r.created, r.created_by_ip, r.expires, r.is_active, r.is_expired, r.is_revoked, r.reason_revoked, r.token, r.replaced_by_token, r.revoked, r.revoked_by_ip, r.user_id
FROM refresh_token AS r
WHERE r.id = @__p_0
LIMIT 1
2022-09-23 15:24:10.307 +01:00 [INF] Executed DbCommand (4ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id, r.created, r.created_by_ip, r.expires, r.is_active, r.is_expired, r.is_revoked, r.reason_revoked, r.token, r.replaced_by_token, r.revoked, r.revoked_by_ip, r.user_id
FROM refresh_token AS r
WHERE r.id = @__p_0
LIMIT 1
2022-09-23 15:24:10.310 +01:00 [DBG] Context 'PostgresContext' started tracking 'RefreshToken' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 15:24:10.312 +01:00 [DBG] A data reader was disposed.
2022-09-23 15:24:10.313 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:24:10.317 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 15:24:10.322 +01:00 [DBG] Compiling query expression: 
'DbSet<Account>()
    .Where(u => u.UserId == __userId_0)
    .Select(u => new AccountRequestResponse{ 
        Balance = u.Balance, 
        CreatedAt = u.CreatedAt, 
        Currency = u.Currency, 
        Id = u.Id 
    }
    )'
2022-09-23 15:24:10.327 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<AccountRequestResponse>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            Balance -> 0
            CreatedAt -> 1
            Currency -> 2
            Id -> 3
        SELECT a.balance AS Balance, a.created_at AS CreatedAt, a.currency AS Currency, a.id AS Id
        FROM accounts AS a
        WHERE a.user_id == @__userId_0), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, AccountRequestResponse>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)'
2022-09-23 15:24:10.332 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 15:24:10.336 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (4ms).
2022-09-23 15:24:10.338 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 15:24:10.339 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:24:10.341 +01:00 [DBG] Executing DbCommand [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a.balance AS "Balance", a.created_at AS "CreatedAt", a.currency AS "Currency", a.id AS "Id"
FROM accounts AS a
WHERE a.user_id = @__userId_0
2022-09-23 15:24:10.345 +01:00 [INF] Executed DbCommand (4ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a.balance AS "Balance", a.created_at AS "CreatedAt", a.currency AS "Currency", a.id AS "Id"
FROM accounts AS a
WHERE a.user_id = @__userId_0
2022-09-23 15:24:10.367 +01:00 [DBG] A data reader was disposed.
2022-09-23 15:24:10.370 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:24:10.371 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 15:24:10.373 +01:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2022-09-23 15:24:10.375 +01:00 [DBG] Attempting to select an output formatter based on Accept header '["text/plain"]'.
2022-09-23 15:24:10.378 +01:00 [DBG] Could not find an output formatter based on content negotiation. Accepted types were (["text/plain"])
2022-09-23 15:24:10.379 +01:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2022-09-23 15:24:10.380 +01:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2022-09-23 15:24:10.381 +01:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2022-09-23 15:24:10.384 +01:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[APIBank.Models.Responses.AccountRequestResponse, APIBank, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2022-09-23 15:24:10.396 +01:00 [INF] Executed action APIBank.Controllers.AccountsController.GetAllFromUser (APIBank) in 126.3601ms
2022-09-23 15:24:10.404 +01:00 [INF] Executed endpoint 'APIBank.Controllers.AccountsController.GetAllFromUser (APIBank)'
2022-09-23 15:24:10.407 +01:00 [DBG] 'PostgresContext' disposed.
2022-09-23 15:24:10.409 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/api/Accounts/GetAll - - - 200 - application/json;+charset=utf-8 325.9815ms
2022-09-23 15:24:27.481 +01:00 [INF] Request starting HTTP/2 POST https://localhost:7036/api/Transfers/TransferRequest application/json 77
2022-09-23 15:24:27.485 +01:00 [DBG] 1 candidate(s) found for the request path '/api/Transfers/TransferRequest'
2022-09-23 15:24:27.486 +01:00 [DBG] Endpoint 'APIBank.Controllers.TransfersController.Create (APIBank)' with route pattern 'api/Transfers/TransferRequest' is valid for the request path '/api/Transfers/TransferRequest'
2022-09-23 15:24:27.488 +01:00 [DBG] Request matched endpoint 'APIBank.Controllers.TransfersController.Create (APIBank)'
2022-09-23 15:24:27.490 +01:00 [DBG] Static files was skipped as the request already matched an endpoint.
2022-09-23 15:24:27.556 +01:00 [INF] Entity Framework Core 6.0.9 initialized 'PostgresContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:6.0.7+5b98e4b74de93b590b44aef8dd7967c03acc433c' with options: None
2022-09-23 15:24:27.563 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 15:24:27.564 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2022-09-23 15:24:27.564 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 15:24:27.565 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:24:27.566 +01:00 [DBG] Executing DbCommand [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.id = @__p_0
LIMIT 1
2022-09-23 15:24:27.570 +01:00 [INF] Executed DbCommand (4ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.id = @__p_0
LIMIT 1
2022-09-23 15:24:27.575 +01:00 [DBG] Context 'PostgresContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 15:24:27.577 +01:00 [DBG] A data reader was disposed.
2022-09-23 15:24:27.577 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:24:27.578 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 15:24:27.579 +01:00 [INF] Executing endpoint 'APIBank.Controllers.TransfersController.Create (APIBank)'
2022-09-23 15:24:27.581 +01:00 [INF] Route matched with {action = "Create", controller = "Transfers"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult Create(APIBank.Models.Requests.TransferRequest) on controller APIBank.Controllers.TransfersController (APIBank).
2022-09-23 15:24:27.582 +01:00 [DBG] Execution plan of authorization filters (in the following order): ["APIBank.Authorization.AuthorizeAttribute"]
2022-09-23 15:24:27.584 +01:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2022-09-23 15:24:27.588 +01:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2022-09-23 15:24:27.590 +01:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2022-09-23 15:24:27.590 +01:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2022-09-23 15:24:27.592 +01:00 [DBG] Executing controller factory for controller APIBank.Controllers.TransfersController (APIBank)
2022-09-23 15:24:27.593 +01:00 [DBG] Executed controller factory for controller APIBank.Controllers.TransfersController (APIBank)
2022-09-23 15:24:27.594 +01:00 [DBG] Attempting to bind parameter 'model' of type 'APIBank.Models.Requests.TransferRequest' ...
2022-09-23 15:24:27.595 +01:00 [DBG] Attempting to bind parameter 'model' of type 'APIBank.Models.Requests.TransferRequest' using the name '' in request data ...
2022-09-23 15:24:27.596 +01:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2022-09-23 15:24:27.598 +01:00 [DBG] Connection id "0HMKTDSHHPGJA", Request id "0HMKTDSHHPGJA:0000000D": started reading request body.
2022-09-23 15:24:27.599 +01:00 [DBG] Connection id "0HMKTDSHHPGJA", Request id "0HMKTDSHHPGJA:0000000D": done reading request body.
2022-09-23 15:24:27.609 +01:00 [DBG] JSON input formatter succeeded, deserializing to type 'APIBank.Models.Requests.TransferRequest'
2022-09-23 15:24:27.611 +01:00 [DBG] Done attempting to bind parameter 'model' of type 'APIBank.Models.Requests.TransferRequest'.
2022-09-23 15:24:27.612 +01:00 [DBG] Done attempting to bind parameter 'model' of type 'APIBank.Models.Requests.TransferRequest'.
2022-09-23 15:24:27.614 +01:00 [DBG] Attempting to validate the bound parameter 'model' of type 'APIBank.Models.Requests.TransferRequest' ...
2022-09-23 15:24:27.622 +01:00 [DBG] Done attempting to validate the bound parameter 'model' of type 'APIBank.Models.Requests.TransferRequest'.
2022-09-23 15:24:27.632 +01:00 [DBG] Compiling query expression: 
'DbSet<Account>()
    .Include(a => a.Transactions)
    .Where(a => a.Id == __accountId_0 && a.UserId == __userId_1)
    .Select(a => new AccountMovims{ 
        Account = new AccountRequestResponse{ 
            Balance = a.Balance, 
            Currency = a.Currency, 
            CreatedAt = a.CreatedAt, 
            Id = a.Id 
        }
        , 
        Movims = a.Transactions
            .Select(b => new Movim{ 
                Amount = b.Amount, 
                CreatedAt = b.CreatedAt 
            }
            )
            .ToArray() 
    }
    )
    .SingleOrDefault()'
2022-09-23 15:24:27.743 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<AccountMovims>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Client Projections:
            0 -> 0
            1 -> 1
            2 -> 2
            3 -> 3
            4 -> 4
            5 -> 5
            6 -> 6
        SELECT t.balance, t.currency, t.created_at, t.id, t0.amount, t0.created_at, t0.id
        FROM 
        (
            SELECT TOP(2) a.balance, a.currency, a.created_at, a.id
            FROM accounts AS a
            WHERE (a.id == @__accountId_0) && (a.user_id == @__userId_1)
        ) AS t
        LEFT JOIN transactions AS t0 ON t.id == t0.account_id
        ORDER BY t.id ASC), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, AccountMovims>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)
    .SingleOrDefault()'
2022-09-23 15:24:27.748 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 15:24:27.748 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2022-09-23 15:24:27.749 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 15:24:27.750 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:24:27.752 +01:00 [DBG] Executing DbCommand [Parameters=[@__accountId_0='?' (DbType = Int32), @__userId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT t.balance, t.currency, t.created_at, t.id, t0.amount, t0.created_at, t0.id
FROM (
    SELECT a.balance, a.currency, a.created_at, a.id
    FROM accounts AS a
    WHERE (a.id = @__accountId_0) AND (a.user_id = @__userId_1)
    LIMIT 2
) AS t
LEFT JOIN transactions AS t0 ON t.id = t0.account_id
ORDER BY t.id
2022-09-23 15:24:27.755 +01:00 [INF] Executed DbCommand (3ms) [Parameters=[@__accountId_0='?' (DbType = Int32), @__userId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT t.balance, t.currency, t.created_at, t.id, t0.amount, t0.created_at, t0.id
FROM (
    SELECT a.balance, a.currency, a.created_at, a.id
    FROM accounts AS a
    WHERE (a.id = @__accountId_0) AND (a.user_id = @__userId_1)
    LIMIT 2
) AS t
LEFT JOIN transactions AS t0 ON t.id = t0.account_id
ORDER BY t.id
2022-09-23 15:24:27.761 +01:00 [DBG] A data reader was disposed.
2022-09-23 15:24:27.761 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:24:27.762 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 15:24:27.764 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 15:24:27.764 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2022-09-23 15:24:27.765 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 15:24:27.766 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:24:27.767 +01:00 [DBG] Executing DbCommand [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id, r.created, r.created_by_ip, r.expires, r.is_active, r.is_expired, r.is_revoked, r.reason_revoked, r.token, r.replaced_by_token, r.revoked, r.revoked_by_ip, r.user_id
FROM refresh_token AS r
WHERE r.id = @__p_0
LIMIT 1
2022-09-23 15:24:27.770 +01:00 [INF] Executed DbCommand (3ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id, r.created, r.created_by_ip, r.expires, r.is_active, r.is_expired, r.is_revoked, r.reason_revoked, r.token, r.replaced_by_token, r.revoked, r.revoked_by_ip, r.user_id
FROM refresh_token AS r
WHERE r.id = @__p_0
LIMIT 1
2022-09-23 15:24:27.773 +01:00 [DBG] Context 'PostgresContext' started tracking 'RefreshToken' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 15:24:27.774 +01:00 [DBG] A data reader was disposed.
2022-09-23 15:24:27.775 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:24:27.775 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 15:24:27.781 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 15:24:27.782 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:24:27.783 +01:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2022-09-23 15:24:27.784 +01:00 [DBG] Began transaction with isolation level 'ReadCommitted'.
2022-09-23 15:24:27.789 +01:00 [DBG] 'PostgresContext' generated a temporary value for the property 'Id.Transfer'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 15:24:27.814 +01:00 [DBG] Context 'PostgresContext' started tracking 'Transfer' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 15:24:27.817 +01:00 [DBG] SaveChanges starting for 'PostgresContext'.
2022-09-23 15:24:27.822 +01:00 [DBG] DetectChanges starting for 'PostgresContext'.
2022-09-23 15:24:27.840 +01:00 [DBG] DetectChanges completed for 'PostgresContext'.
2022-09-23 15:24:27.845 +01:00 [DBG] Creating transaction savepoint.
2022-09-23 15:24:27.853 +01:00 [DBG] Created transaction savepoint.
2022-09-23 15:24:27.855 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 15:24:27.856 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2022-09-23 15:24:27.858 +01:00 [DBG] Executing DbCommand [Parameters=[@p0='?' (DbType = Decimal), @p1='?', @p2='?' (DbType = Int32), @p3='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO transfers (amount, currency, from_account_id, to_account_id)
VALUES (@p0, @p1, @p2, @p3)
RETURNING id, created_at;
2022-09-23 15:24:27.875 +01:00 [INF] Executed DbCommand (17ms) [Parameters=[@p0='?' (DbType = Decimal), @p1='?', @p2='?' (DbType = Int32), @p3='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO transfers (amount, currency, from_account_id, to_account_id)
VALUES (@p0, @p1, @p2, @p3)
RETURNING id, created_at;
2022-09-23 15:24:27.880 +01:00 [DBG] The foreign key property 'Transfer.Id' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2022-09-23 15:24:27.882 +01:00 [DBG] A data reader was disposed.
2022-09-23 15:24:27.888 +01:00 [DBG] Releasing transaction savepoint.
2022-09-23 15:24:27.891 +01:00 [DBG] Released transaction savepoint.
2022-09-23 15:24:27.898 +01:00 [DBG] An entity of type 'Transfer' tracked by 'PostgresContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 15:24:27.900 +01:00 [DBG] SaveChanges completed for 'PostgresContext' with 1 entities written to the database.
2022-09-23 15:24:27.905 +01:00 [DBG] 'PostgresContext' generated a temporary value for the property 'Id.Transaction'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 15:24:27.922 +01:00 [DBG] Context 'PostgresContext' started tracking 'Transaction' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 15:24:27.925 +01:00 [DBG] 'PostgresContext' generated a temporary value for the property 'Id.Transaction'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 15:24:27.926 +01:00 [DBG] Context 'PostgresContext' started tracking 'Transaction' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 15:24:27.928 +01:00 [DBG] SaveChanges starting for 'PostgresContext'.
2022-09-23 15:24:27.928 +01:00 [DBG] DetectChanges starting for 'PostgresContext'.
2022-09-23 15:24:27.931 +01:00 [DBG] DetectChanges completed for 'PostgresContext'.
2022-09-23 15:24:27.932 +01:00 [DBG] Creating transaction savepoint.
2022-09-23 15:24:27.932 +01:00 [DBG] Created transaction savepoint.
2022-09-23 15:24:27.939 +01:00 [DBG] Executing 2 update commands as a batch.
2022-09-23 15:24:27.940 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 15:24:27.941 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2022-09-23 15:24:27.942 +01:00 [DBG] Executing DbCommand [Parameters=[@p0='?' (DbType = Int32), @p1='?' (DbType = Decimal), @p2='?' (DbType = Decimal), @p3='?' (DbType = DateTime), @p4='?' (DbType = Int32), @p5='?' (DbType = Decimal), @p6='?' (DbType = Decimal), @p7='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO transactions (account_id, amount, balance, created_at)
VALUES (@p0, @p1, @p2, @p3)
RETURNING id;
INSERT INTO transactions (account_id, amount, balance, created_at)
VALUES (@p4, @p5, @p6, @p7)
RETURNING id;
2022-09-23 15:24:27.944 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[@p0='?' (DbType = Int32), @p1='?' (DbType = Decimal), @p2='?' (DbType = Decimal), @p3='?' (DbType = DateTime), @p4='?' (DbType = Int32), @p5='?' (DbType = Decimal), @p6='?' (DbType = Decimal), @p7='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO transactions (account_id, amount, balance, created_at)
VALUES (@p0, @p1, @p2, @p3)
RETURNING id;
INSERT INTO transactions (account_id, amount, balance, created_at)
VALUES (@p4, @p5, @p6, @p7)
RETURNING id;
2022-09-23 15:24:27.947 +01:00 [DBG] The foreign key property 'Transaction.Id' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2022-09-23 15:24:27.948 +01:00 [DBG] The foreign key property 'Transaction.Id' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2022-09-23 15:24:27.949 +01:00 [DBG] A data reader was disposed.
2022-09-23 15:24:27.950 +01:00 [DBG] Releasing transaction savepoint.
2022-09-23 15:24:27.953 +01:00 [DBG] Released transaction savepoint.
2022-09-23 15:24:27.956 +01:00 [DBG] An entity of type 'Transaction' tracked by 'PostgresContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 15:24:27.957 +01:00 [DBG] An entity of type 'Transaction' tracked by 'PostgresContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 15:24:27.958 +01:00 [DBG] SaveChanges completed for 'PostgresContext' with 2 entities written to the database.
2022-09-23 15:24:27.961 +01:00 [DBG] Compiling query expression: 
'DbSet<Account>()
    .FirstOrDefault(e => EF.Property<int>(e, "Id") == __p_0)'
2022-09-23 15:24:27.965 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<Account>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: Account.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: Account.Balance (decimal) Required, 1], [Property: Account.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 2], [Property: Account.Currency (string) Required ValueGenerated.OnAdd MaxLength(3), 3], [Property: Account.UserId (int) Required FK Index, 4] }
        SELECT TOP(1) a.id, a.balance, a.created_at, a.currency, a.user_id
        FROM accounts AS a
        WHERE a.id == @__p_0), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, Account>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)
    .SingleOrDefault()'
2022-09-23 15:24:27.967 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 15:24:27.969 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (2ms).
2022-09-23 15:24:27.973 +01:00 [DBG] Executing DbCommand [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a.id, a.balance, a.created_at, a.currency, a.user_id
FROM accounts AS a
WHERE a.id = @__p_0
LIMIT 1
2022-09-23 15:24:27.975 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a.id, a.balance, a.created_at, a.currency, a.user_id
FROM accounts AS a
WHERE a.id = @__p_0
LIMIT 1
2022-09-23 15:24:27.977 +01:00 [DBG] Context 'PostgresContext' started tracking 'Account' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 15:24:27.994 +01:00 [DBG] A data reader was disposed.
2022-09-23 15:24:27.996 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 15:24:27.997 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2022-09-23 15:24:27.998 +01:00 [DBG] Executing DbCommand [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a.id, a.balance, a.created_at, a.currency, a.user_id
FROM accounts AS a
WHERE a.id = @__p_0
LIMIT 1
2022-09-23 15:24:28.000 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a.id, a.balance, a.created_at, a.currency, a.user_id
FROM accounts AS a
WHERE a.id = @__p_0
LIMIT 1
2022-09-23 15:24:28.007 +01:00 [DBG] Context 'PostgresContext' started tracking 'Account' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 15:24:28.008 +01:00 [DBG] A data reader was disposed.
2022-09-23 15:24:28.010 +01:00 [INF] Error updating account balance:
2022-09-23 15:24:34.929 +01:00 [DBG] Disposing transaction.
2022-09-23 15:24:34.934 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:24:34.935 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 15:24:34.939 +01:00 [INF] Executed action APIBank.Controllers.TransfersController.Create (APIBank) in 7346.4265ms
2022-09-23 15:24:34.942 +01:00 [INF] Executed endpoint 'APIBank.Controllers.TransfersController.Create (APIBank)'
2022-09-23 15:24:34.991 +01:00 [INF] Global Error was found:
2022-09-23 15:24:34.997 +01:00 [DBG] 'PostgresContext' disposed.
2022-09-23 15:24:35.006 +01:00 [INF] Request finished HTTP/2 POST https://localhost:7036/api/Transfers/TransferRequest application/json 77 - 400 - application/json 7518.8310ms
2022-09-23 15:24:38.936 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/api/Accounts/GetAll - -
2022-09-23 15:24:38.939 +01:00 [DBG] 1 candidate(s) found for the request path '/api/Accounts/GetAll'
2022-09-23 15:24:38.945 +01:00 [DBG] Endpoint 'APIBank.Controllers.AccountsController.GetAllFromUser (APIBank)' with route pattern 'api/Accounts/GetAll' is valid for the request path '/api/Accounts/GetAll'
2022-09-23 15:24:38.946 +01:00 [DBG] Request matched endpoint 'APIBank.Controllers.AccountsController.GetAllFromUser (APIBank)'
2022-09-23 15:24:38.948 +01:00 [DBG] Static files was skipped as the request already matched an endpoint.
2022-09-23 15:24:38.950 +01:00 [INF] Entity Framework Core 6.0.9 initialized 'PostgresContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:6.0.7+5b98e4b74de93b590b44aef8dd7967c03acc433c' with options: None
2022-09-23 15:24:38.957 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 15:24:38.965 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (7ms).
2022-09-23 15:24:38.968 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 15:24:38.969 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:24:38.970 +01:00 [DBG] Executing DbCommand [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.id = @__p_0
LIMIT 1
2022-09-23 15:24:38.974 +01:00 [INF] Executed DbCommand (4ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.id = @__p_0
LIMIT 1
2022-09-23 15:24:38.978 +01:00 [DBG] Context 'PostgresContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 15:24:38.979 +01:00 [DBG] A data reader was disposed.
2022-09-23 15:24:38.980 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:24:38.981 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 15:24:38.982 +01:00 [INF] Executing endpoint 'APIBank.Controllers.AccountsController.GetAllFromUser (APIBank)'
2022-09-23 15:24:38.983 +01:00 [INF] Route matched with {action = "GetAllFromUser", controller = "Accounts"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult GetAllFromUser() on controller APIBank.Controllers.AccountsController (APIBank).
2022-09-23 15:24:38.984 +01:00 [DBG] Execution plan of authorization filters (in the following order): ["APIBank.Authorization.AuthorizeAttribute"]
2022-09-23 15:24:38.985 +01:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2022-09-23 15:24:38.986 +01:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2022-09-23 15:24:38.989 +01:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2022-09-23 15:24:38.990 +01:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2022-09-23 15:24:38.992 +01:00 [DBG] Executing controller factory for controller APIBank.Controllers.AccountsController (APIBank)
2022-09-23 15:24:38.996 +01:00 [DBG] Executed controller factory for controller APIBank.Controllers.AccountsController (APIBank)
2022-09-23 15:24:38.997 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 15:24:38.998 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2022-09-23 15:24:38.999 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 15:24:39.000 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:24:39.001 +01:00 [DBG] Executing DbCommand [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id, r.created, r.created_by_ip, r.expires, r.is_active, r.is_expired, r.is_revoked, r.reason_revoked, r.token, r.replaced_by_token, r.revoked, r.revoked_by_ip, r.user_id
FROM refresh_token AS r
WHERE r.id = @__p_0
LIMIT 1
2022-09-23 15:24:39.005 +01:00 [INF] Executed DbCommand (4ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id, r.created, r.created_by_ip, r.expires, r.is_active, r.is_expired, r.is_revoked, r.reason_revoked, r.token, r.replaced_by_token, r.revoked, r.revoked_by_ip, r.user_id
FROM refresh_token AS r
WHERE r.id = @__p_0
LIMIT 1
2022-09-23 15:24:39.008 +01:00 [DBG] Context 'PostgresContext' started tracking 'RefreshToken' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 15:24:39.011 +01:00 [DBG] A data reader was disposed.
2022-09-23 15:24:39.013 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:24:39.014 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 15:24:39.017 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 15:24:39.018 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2022-09-23 15:24:39.019 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 15:24:39.020 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:24:39.021 +01:00 [DBG] Executing DbCommand [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a.balance AS "Balance", a.created_at AS "CreatedAt", a.currency AS "Currency", a.id AS "Id"
FROM accounts AS a
WHERE a.user_id = @__userId_0
2022-09-23 15:24:39.023 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a.balance AS "Balance", a.created_at AS "CreatedAt", a.currency AS "Currency", a.id AS "Id"
FROM accounts AS a
WHERE a.user_id = @__userId_0
2022-09-23 15:24:39.026 +01:00 [DBG] A data reader was disposed.
2022-09-23 15:24:39.027 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:24:39.029 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 15:24:39.030 +01:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2022-09-23 15:24:39.032 +01:00 [DBG] Attempting to select an output formatter based on Accept header '["text/plain"]'.
2022-09-23 15:24:39.034 +01:00 [DBG] Could not find an output formatter based on content negotiation. Accepted types were (["text/plain"])
2022-09-23 15:24:39.035 +01:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2022-09-23 15:24:39.036 +01:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2022-09-23 15:24:39.037 +01:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2022-09-23 15:24:39.038 +01:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[APIBank.Models.Responses.AccountRequestResponse, APIBank, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2022-09-23 15:24:39.040 +01:00 [INF] Executed action APIBank.Controllers.AccountsController.GetAllFromUser (APIBank) in 48.0694ms
2022-09-23 15:24:39.041 +01:00 [INF] Executed endpoint 'APIBank.Controllers.AccountsController.GetAllFromUser (APIBank)'
2022-09-23 15:24:39.042 +01:00 [DBG] 'PostgresContext' disposed.
2022-09-23 15:24:39.044 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/api/Accounts/GetAll - - - 200 - application/json;+charset=utf-8 107.2497ms
2022-09-23 15:24:54.482 +01:00 [INF] Request starting HTTP/2 POST https://localhost:7036/api/Transfers/TransferRequest application/json 77
2022-09-23 15:24:54.486 +01:00 [DBG] 1 candidate(s) found for the request path '/api/Transfers/TransferRequest'
2022-09-23 15:24:54.487 +01:00 [DBG] Endpoint 'APIBank.Controllers.TransfersController.Create (APIBank)' with route pattern 'api/Transfers/TransferRequest' is valid for the request path '/api/Transfers/TransferRequest'
2022-09-23 15:24:54.490 +01:00 [DBG] Request matched endpoint 'APIBank.Controllers.TransfersController.Create (APIBank)'
2022-09-23 15:24:54.492 +01:00 [DBG] Static files was skipped as the request already matched an endpoint.
2022-09-23 15:24:54.496 +01:00 [INF] Entity Framework Core 6.0.9 initialized 'PostgresContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:6.0.7+5b98e4b74de93b590b44aef8dd7967c03acc433c' with options: None
2022-09-23 15:24:54.502 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 15:24:54.503 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2022-09-23 15:24:54.504 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 15:24:54.505 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:24:54.506 +01:00 [DBG] Executing DbCommand [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.id = @__p_0
LIMIT 1
2022-09-23 15:24:54.509 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.id = @__p_0
LIMIT 1
2022-09-23 15:24:54.511 +01:00 [DBG] Context 'PostgresContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 15:24:54.513 +01:00 [DBG] A data reader was disposed.
2022-09-23 15:24:54.515 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:24:54.516 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 15:24:54.517 +01:00 [INF] Executing endpoint 'APIBank.Controllers.TransfersController.Create (APIBank)'
2022-09-23 15:24:54.518 +01:00 [INF] Route matched with {action = "Create", controller = "Transfers"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult Create(APIBank.Models.Requests.TransferRequest) on controller APIBank.Controllers.TransfersController (APIBank).
2022-09-23 15:24:54.520 +01:00 [DBG] Execution plan of authorization filters (in the following order): ["APIBank.Authorization.AuthorizeAttribute"]
2022-09-23 15:24:54.521 +01:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2022-09-23 15:24:54.522 +01:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2022-09-23 15:24:54.524 +01:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2022-09-23 15:24:54.525 +01:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2022-09-23 15:24:54.526 +01:00 [DBG] Executing controller factory for controller APIBank.Controllers.TransfersController (APIBank)
2022-09-23 15:24:54.527 +01:00 [DBG] Executed controller factory for controller APIBank.Controllers.TransfersController (APIBank)
2022-09-23 15:24:54.530 +01:00 [DBG] Attempting to bind parameter 'model' of type 'APIBank.Models.Requests.TransferRequest' ...
2022-09-23 15:24:54.534 +01:00 [DBG] Attempting to bind parameter 'model' of type 'APIBank.Models.Requests.TransferRequest' using the name '' in request data ...
2022-09-23 15:24:54.536 +01:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2022-09-23 15:24:54.538 +01:00 [DBG] Connection id "0HMKTDSHHPGJA", Request id "0HMKTDSHHPGJA:00000011": started reading request body.
2022-09-23 15:24:54.539 +01:00 [DBG] Connection id "0HMKTDSHHPGJA", Request id "0HMKTDSHHPGJA:00000011": done reading request body.
2022-09-23 15:24:54.541 +01:00 [DBG] JSON input formatter succeeded, deserializing to type 'APIBank.Models.Requests.TransferRequest'
2022-09-23 15:24:54.542 +01:00 [DBG] Done attempting to bind parameter 'model' of type 'APIBank.Models.Requests.TransferRequest'.
2022-09-23 15:24:54.543 +01:00 [DBG] Done attempting to bind parameter 'model' of type 'APIBank.Models.Requests.TransferRequest'.
2022-09-23 15:24:54.547 +01:00 [DBG] Attempting to validate the bound parameter 'model' of type 'APIBank.Models.Requests.TransferRequest' ...
2022-09-23 15:24:54.548 +01:00 [DBG] Done attempting to validate the bound parameter 'model' of type 'APIBank.Models.Requests.TransferRequest'.
2022-09-23 15:24:54.551 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 15:24:54.552 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2022-09-23 15:24:54.554 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 15:24:54.556 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:24:54.557 +01:00 [DBG] Executing DbCommand [Parameters=[@__accountId_0='?' (DbType = Int32), @__userId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT t.balance, t.currency, t.created_at, t.id, t0.amount, t0.created_at, t0.id
FROM (
    SELECT a.balance, a.currency, a.created_at, a.id
    FROM accounts AS a
    WHERE (a.id = @__accountId_0) AND (a.user_id = @__userId_1)
    LIMIT 2
) AS t
LEFT JOIN transactions AS t0 ON t.id = t0.account_id
ORDER BY t.id
2022-09-23 15:24:54.564 +01:00 [INF] Executed DbCommand (7ms) [Parameters=[@__accountId_0='?' (DbType = Int32), @__userId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT t.balance, t.currency, t.created_at, t.id, t0.amount, t0.created_at, t0.id
FROM (
    SELECT a.balance, a.currency, a.created_at, a.id
    FROM accounts AS a
    WHERE (a.id = @__accountId_0) AND (a.user_id = @__userId_1)
    LIMIT 2
) AS t
LEFT JOIN transactions AS t0 ON t.id = t0.account_id
ORDER BY t.id
2022-09-23 15:24:54.567 +01:00 [DBG] A data reader was disposed.
2022-09-23 15:24:54.568 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:24:54.570 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 15:24:54.572 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 15:24:54.573 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2022-09-23 15:24:54.574 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 15:24:54.576 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:24:54.581 +01:00 [DBG] Executing DbCommand [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id, r.created, r.created_by_ip, r.expires, r.is_active, r.is_expired, r.is_revoked, r.reason_revoked, r.token, r.replaced_by_token, r.revoked, r.revoked_by_ip, r.user_id
FROM refresh_token AS r
WHERE r.id = @__p_0
LIMIT 1
2022-09-23 15:24:54.584 +01:00 [INF] Executed DbCommand (3ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id, r.created, r.created_by_ip, r.expires, r.is_active, r.is_expired, r.is_revoked, r.reason_revoked, r.token, r.replaced_by_token, r.revoked, r.revoked_by_ip, r.user_id
FROM refresh_token AS r
WHERE r.id = @__p_0
LIMIT 1
2022-09-23 15:24:54.586 +01:00 [DBG] Context 'PostgresContext' started tracking 'RefreshToken' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 15:24:54.588 +01:00 [DBG] A data reader was disposed.
2022-09-23 15:24:54.588 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:24:54.590 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 15:24:54.592 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 15:24:54.601 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:24:54.602 +01:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2022-09-23 15:24:54.603 +01:00 [DBG] Began transaction with isolation level 'ReadCommitted'.
2022-09-23 15:24:54.604 +01:00 [DBG] 'PostgresContext' generated a temporary value for the property 'Id.Transfer'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 15:24:54.607 +01:00 [DBG] Context 'PostgresContext' started tracking 'Transfer' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 15:24:54.609 +01:00 [DBG] SaveChanges starting for 'PostgresContext'.
2022-09-23 15:24:54.609 +01:00 [DBG] DetectChanges starting for 'PostgresContext'.
2022-09-23 15:24:54.611 +01:00 [DBG] DetectChanges completed for 'PostgresContext'.
2022-09-23 15:24:54.613 +01:00 [DBG] Creating transaction savepoint.
2022-09-23 15:24:54.615 +01:00 [DBG] Created transaction savepoint.
2022-09-23 15:24:54.616 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 15:24:54.617 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2022-09-23 15:24:54.618 +01:00 [DBG] Executing DbCommand [Parameters=[@p0='?' (DbType = Decimal), @p1='?', @p2='?' (DbType = Int32), @p3='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO transfers (amount, currency, from_account_id, to_account_id)
VALUES (@p0, @p1, @p2, @p3)
RETURNING id, created_at;
2022-09-23 15:24:54.620 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[@p0='?' (DbType = Decimal), @p1='?', @p2='?' (DbType = Int32), @p3='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO transfers (amount, currency, from_account_id, to_account_id)
VALUES (@p0, @p1, @p2, @p3)
RETURNING id, created_at;
2022-09-23 15:24:54.624 +01:00 [DBG] The foreign key property 'Transfer.Id' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2022-09-23 15:24:54.625 +01:00 [DBG] A data reader was disposed.
2022-09-23 15:24:54.626 +01:00 [DBG] Releasing transaction savepoint.
2022-09-23 15:24:54.627 +01:00 [DBG] Released transaction savepoint.
2022-09-23 15:24:54.628 +01:00 [DBG] An entity of type 'Transfer' tracked by 'PostgresContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 15:24:54.630 +01:00 [DBG] SaveChanges completed for 'PostgresContext' with 1 entities written to the database.
2022-09-23 15:24:54.631 +01:00 [DBG] 'PostgresContext' generated a temporary value for the property 'Id.Transaction'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 15:24:54.632 +01:00 [DBG] Context 'PostgresContext' started tracking 'Transaction' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 15:24:54.633 +01:00 [DBG] 'PostgresContext' generated a temporary value for the property 'Id.Transaction'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 15:24:54.634 +01:00 [DBG] Context 'PostgresContext' started tracking 'Transaction' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 15:24:54.635 +01:00 [DBG] SaveChanges starting for 'PostgresContext'.
2022-09-23 15:24:54.637 +01:00 [DBG] DetectChanges starting for 'PostgresContext'.
2022-09-23 15:24:54.639 +01:00 [DBG] DetectChanges completed for 'PostgresContext'.
2022-09-23 15:24:54.640 +01:00 [DBG] Creating transaction savepoint.
2022-09-23 15:24:54.641 +01:00 [DBG] Created transaction savepoint.
2022-09-23 15:24:54.642 +01:00 [DBG] Executing 2 update commands as a batch.
2022-09-23 15:24:54.643 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 15:24:54.644 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2022-09-23 15:24:54.645 +01:00 [DBG] Executing DbCommand [Parameters=[@p0='?' (DbType = Int32), @p1='?' (DbType = Decimal), @p2='?' (DbType = Decimal), @p3='?' (DbType = DateTime), @p4='?' (DbType = Int32), @p5='?' (DbType = Decimal), @p6='?' (DbType = Decimal), @p7='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO transactions (account_id, amount, balance, created_at)
VALUES (@p0, @p1, @p2, @p3)
RETURNING id;
INSERT INTO transactions (account_id, amount, balance, created_at)
VALUES (@p4, @p5, @p6, @p7)
RETURNING id;
2022-09-23 15:24:54.648 +01:00 [INF] Executed DbCommand (3ms) [Parameters=[@p0='?' (DbType = Int32), @p1='?' (DbType = Decimal), @p2='?' (DbType = Decimal), @p3='?' (DbType = DateTime), @p4='?' (DbType = Int32), @p5='?' (DbType = Decimal), @p6='?' (DbType = Decimal), @p7='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO transactions (account_id, amount, balance, created_at)
VALUES (@p0, @p1, @p2, @p3)
RETURNING id;
INSERT INTO transactions (account_id, amount, balance, created_at)
VALUES (@p4, @p5, @p6, @p7)
RETURNING id;
2022-09-23 15:24:54.650 +01:00 [DBG] The foreign key property 'Transaction.Id' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2022-09-23 15:24:54.651 +01:00 [DBG] The foreign key property 'Transaction.Id' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2022-09-23 15:24:54.654 +01:00 [DBG] A data reader was disposed.
2022-09-23 15:24:54.654 +01:00 [DBG] Releasing transaction savepoint.
2022-09-23 15:24:54.655 +01:00 [DBG] Released transaction savepoint.
2022-09-23 15:24:54.656 +01:00 [DBG] An entity of type 'Transaction' tracked by 'PostgresContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 15:24:54.658 +01:00 [DBG] An entity of type 'Transaction' tracked by 'PostgresContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 15:24:54.659 +01:00 [DBG] SaveChanges completed for 'PostgresContext' with 2 entities written to the database.
2022-09-23 15:24:54.662 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 15:24:54.664 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2022-09-23 15:24:54.665 +01:00 [DBG] Executing DbCommand [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a.id, a.balance, a.created_at, a.currency, a.user_id
FROM accounts AS a
WHERE a.id = @__p_0
LIMIT 1
2022-09-23 15:24:54.668 +01:00 [INF] Executed DbCommand (3ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a.id, a.balance, a.created_at, a.currency, a.user_id
FROM accounts AS a
WHERE a.id = @__p_0
LIMIT 1
2022-09-23 15:24:54.670 +01:00 [DBG] Context 'PostgresContext' started tracking 'Account' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 15:24:54.671 +01:00 [DBG] A data reader was disposed.
2022-09-23 15:24:54.672 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 15:24:54.673 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2022-09-23 15:24:54.674 +01:00 [DBG] Executing DbCommand [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a.id, a.balance, a.created_at, a.currency, a.user_id
FROM accounts AS a
WHERE a.id = @__p_0
LIMIT 1
2022-09-23 15:24:54.676 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a.id, a.balance, a.created_at, a.currency, a.user_id
FROM accounts AS a
WHERE a.id = @__p_0
LIMIT 1
2022-09-23 15:24:54.678 +01:00 [DBG] Context 'PostgresContext' started tracking 'Account' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 15:24:54.680 +01:00 [DBG] A data reader was disposed.
2022-09-23 15:24:54.681 +01:00 [INF] Error updating account balance:
2022-09-23 15:26:17.118 +01:00 [DBG] SaveChanges starting for 'PostgresContext'.
2022-09-23 15:26:17.120 +01:00 [DBG] DetectChanges starting for 'PostgresContext'.
2022-09-23 15:26:17.129 +01:00 [DBG] The unchanged property 'Account.Balance' was detected as changed and will be marked as modified. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2022-09-23 15:26:17.130 +01:00 [DBG] An entity of type 'Account' tracked by 'PostgresContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 15:26:17.140 +01:00 [DBG] The unchanged property 'Account.Balance' was detected as changed and will be marked as modified. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2022-09-23 15:26:17.141 +01:00 [DBG] An entity of type 'Account' tracked by 'PostgresContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 15:26:17.143 +01:00 [DBG] DetectChanges completed for 'PostgresContext'.
2022-09-23 15:26:17.144 +01:00 [DBG] Creating transaction savepoint.
2022-09-23 15:26:17.145 +01:00 [DBG] Created transaction savepoint.
2022-09-23 15:26:17.146 +01:00 [DBG] Executing 2 update commands as a batch.
2022-09-23 15:26:17.147 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 15:26:17.148 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2022-09-23 15:26:17.149 +01:00 [DBG] Executing DbCommand [Parameters=[@p1='?' (DbType = Int32), @p0='?' (DbType = Decimal), @p3='?' (DbType = Int32), @p2='?' (DbType = Decimal)], CommandType='"Text"', CommandTimeout='30']
UPDATE accounts SET balance = @p0
WHERE id = @p1;
UPDATE accounts SET balance = @p2
WHERE id = @p3;
2022-09-23 15:26:17.156 +01:00 [INF] Executed DbCommand (7ms) [Parameters=[@p1='?' (DbType = Int32), @p0='?' (DbType = Decimal), @p3='?' (DbType = Int32), @p2='?' (DbType = Decimal)], CommandType='"Text"', CommandTimeout='30']
UPDATE accounts SET balance = @p0
WHERE id = @p1;
UPDATE accounts SET balance = @p2
WHERE id = @p3;
2022-09-23 15:26:17.158 +01:00 [DBG] A data reader was disposed.
2022-09-23 15:26:17.159 +01:00 [DBG] Releasing transaction savepoint.
2022-09-23 15:26:17.160 +01:00 [DBG] Released transaction savepoint.
2022-09-23 15:26:17.161 +01:00 [DBG] An entity of type 'Account' tracked by 'PostgresContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 15:26:17.163 +01:00 [DBG] An entity of type 'Account' tracked by 'PostgresContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 15:26:17.165 +01:00 [DBG] SaveChanges completed for 'PostgresContext' with 2 entities written to the database.
2022-09-23 15:26:17.167 +01:00 [DBG] Committing transaction.
2022-09-23 15:26:17.169 +01:00 [DBG] Committed transaction.
2022-09-23 15:26:17.170 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:26:17.173 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 15:26:17.174 +01:00 [DBG] Disposing transaction.
2022-09-23 15:26:17.175 +01:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2022-09-23 15:26:17.178 +01:00 [DBG] Attempting to select an output formatter based on Accept header '["text/plain"]'.
2022-09-23 15:26:17.179 +01:00 [DBG] Could not find an output formatter based on content negotiation. Accepted types were (["text/plain"])
2022-09-23 15:26:17.180 +01:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2022-09-23 15:26:17.181 +01:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2022-09-23 15:26:17.183 +01:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2022-09-23 15:26:17.184 +01:00 [INF] Executing CreatedResult, writing value of type '<>f__AnonymousType0`1[[System.String, System.Private.CoreLib, Version=6.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2022-09-23 15:26:17.186 +01:00 [INF] Executed action APIBank.Controllers.TransfersController.Create (APIBank) in 82661.4602ms
2022-09-23 15:26:17.191 +01:00 [INF] Executed endpoint 'APIBank.Controllers.TransfersController.Create (APIBank)'
2022-09-23 15:26:17.193 +01:00 [DBG] 'PostgresContext' disposed.
2022-09-23 15:26:17.195 +01:00 [INF] Request finished HTTP/2 POST https://localhost:7036/api/Transfers/TransferRequest application/json 77 - 201 - application/json;+charset=utf-8 82718.2584ms
2022-09-23 15:26:18.087 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/swagger/index.html - -
2022-09-23 15:26:18.090 +01:00 [DBG] No candidates found for the request path '/swagger/index.html'
2022-09-23 15:26:18.092 +01:00 [DBG] Request did not match any endpoints
2022-09-23 15:26:18.102 +01:00 [DBG] Response markup is scheduled to include browser refresh script injection.
2022-09-23 15:26:18.120 +01:00 [DBG] Response markup was updated to include browser refresh script injection.
2022-09-23 15:26:18.122 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/swagger/index.html - - - 200 - text/html;charset=utf-8 34.6751ms
2022-09-23 15:26:18.164 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/_framework/aspnetcore-browser-refresh.js - -
2022-09-23 15:26:18.166 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/_vs/browserLink - -
2022-09-23 15:26:18.167 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/_framework/aspnetcore-browser-refresh.js - - - 200 11984 application/javascript;+charset=utf-8 3.6718ms
2022-09-23 15:26:18.182 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/_vs/browserLink - - - 200 - text/javascript;+charset=UTF-8 16.0764ms
2022-09-23 15:26:18.298 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/swagger/v1/swagger.json - -
2022-09-23 15:26:18.302 +01:00 [DBG] No candidates found for the request path '/swagger/v1/swagger.json'
2022-09-23 15:26:18.303 +01:00 [DBG] Request did not match any endpoints
2022-09-23 15:26:18.321 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/swagger/v1/swagger.json - - - 200 - application/json;charset=utf-8 22.7791ms
2022-09-23 15:26:25.123 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/api/Accounts/GetAll - -
2022-09-23 15:26:25.126 +01:00 [DBG] 1 candidate(s) found for the request path '/api/Accounts/GetAll'
2022-09-23 15:26:25.130 +01:00 [DBG] Endpoint 'APIBank.Controllers.AccountsController.GetAllFromUser (APIBank)' with route pattern 'api/Accounts/GetAll' is valid for the request path '/api/Accounts/GetAll'
2022-09-23 15:26:25.137 +01:00 [DBG] Request matched endpoint 'APIBank.Controllers.AccountsController.GetAllFromUser (APIBank)'
2022-09-23 15:26:25.138 +01:00 [DBG] Static files was skipped as the request already matched an endpoint.
2022-09-23 15:26:25.139 +01:00 [INF] Executing endpoint 'APIBank.Controllers.AccountsController.GetAllFromUser (APIBank)'
2022-09-23 15:26:25.141 +01:00 [INF] Route matched with {action = "GetAllFromUser", controller = "Accounts"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult GetAllFromUser() on controller APIBank.Controllers.AccountsController (APIBank).
2022-09-23 15:26:25.143 +01:00 [DBG] Execution plan of authorization filters (in the following order): ["APIBank.Authorization.AuthorizeAttribute"]
2022-09-23 15:26:25.145 +01:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2022-09-23 15:26:25.146 +01:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2022-09-23 15:26:25.149 +01:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2022-09-23 15:26:25.152 +01:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2022-09-23 15:26:25.153 +01:00 [INF] Authorization failed for the request at filter 'APIBank.Authorization.AuthorizeAttribute'.
2022-09-23 15:26:25.157 +01:00 [INF] Executing JsonResult, writing value of type '<>f__AnonymousType0`1[[System.String, System.Private.CoreLib, Version=6.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2022-09-23 15:26:25.160 +01:00 [INF] Executed action APIBank.Controllers.AccountsController.GetAllFromUser (APIBank) in 7.121ms
2022-09-23 15:26:25.162 +01:00 [INF] Executed endpoint 'APIBank.Controllers.AccountsController.GetAllFromUser (APIBank)'
2022-09-23 15:26:25.164 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/api/Accounts/GetAll - - - 401 - application/json;+charset=utf-8 40.8085ms
2022-09-23 15:26:40.494 +01:00 [INF] Request starting HTTP/2 POST https://localhost:7036/api/Users/Login application/json 58
2022-09-23 15:26:40.498 +01:00 [DBG] 1 candidate(s) found for the request path '/api/Users/Login'
2022-09-23 15:26:40.500 +01:00 [DBG] Endpoint 'APIBank.Controllers.UsersController.Login (APIBank)' with route pattern 'api/Users/Login' is valid for the request path '/api/Users/Login'
2022-09-23 15:26:40.504 +01:00 [DBG] Request matched endpoint 'APIBank.Controllers.UsersController.Login (APIBank)'
2022-09-23 15:26:40.510 +01:00 [DBG] Static files was skipped as the request already matched an endpoint.
2022-09-23 15:26:40.512 +01:00 [INF] Executing endpoint 'APIBank.Controllers.UsersController.Login (APIBank)'
2022-09-23 15:26:40.513 +01:00 [INF] Route matched with {action = "Login", controller = "Users"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult Login(APIBank.Models.Requests.UserLoginRequest) on controller APIBank.Controllers.UsersController (APIBank).
2022-09-23 15:26:40.514 +01:00 [DBG] Execution plan of authorization filters (in the following order): ["APIBank.Authorization.AuthorizeAttribute"]
2022-09-23 15:26:40.515 +01:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2022-09-23 15:26:40.517 +01:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2022-09-23 15:26:40.519 +01:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2022-09-23 15:26:40.521 +01:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2022-09-23 15:26:40.524 +01:00 [DBG] Executing controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-23 15:26:40.525 +01:00 [DBG] Executed controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-23 15:26:40.526 +01:00 [DBG] Attempting to bind parameter 'model' of type 'APIBank.Models.Requests.UserLoginRequest' ...
2022-09-23 15:26:40.527 +01:00 [DBG] Attempting to bind parameter 'model' of type 'APIBank.Models.Requests.UserLoginRequest' using the name '' in request data ...
2022-09-23 15:26:40.528 +01:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2022-09-23 15:26:40.530 +01:00 [DBG] Connection id "0HMKTDSHHPGJA", Request id "0HMKTDSHHPGJA:0000001D": started reading request body.
2022-09-23 15:26:40.531 +01:00 [DBG] Connection id "0HMKTDSHHPGJA", Request id "0HMKTDSHHPGJA:0000001D": done reading request body.
2022-09-23 15:26:40.535 +01:00 [DBG] JSON input formatter succeeded, deserializing to type 'APIBank.Models.Requests.UserLoginRequest'
2022-09-23 15:26:40.538 +01:00 [DBG] Done attempting to bind parameter 'model' of type 'APIBank.Models.Requests.UserLoginRequest'.
2022-09-23 15:26:40.539 +01:00 [DBG] Done attempting to bind parameter 'model' of type 'APIBank.Models.Requests.UserLoginRequest'.
2022-09-23 15:26:40.540 +01:00 [DBG] Attempting to validate the bound parameter 'model' of type 'APIBank.Models.Requests.UserLoginRequest' ...
2022-09-23 15:26:40.542 +01:00 [DBG] Done attempting to validate the bound parameter 'model' of type 'APIBank.Models.Requests.UserLoginRequest'.
2022-09-23 15:26:40.545 +01:00 [INF] Entity Framework Core 6.0.9 initialized 'PostgresContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:6.0.7+5b98e4b74de93b590b44aef8dd7967c03acc433c' with options: None
2022-09-23 15:26:40.547 +01:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .SingleOrDefault(x => x.Username == __model_Username_0)'
2022-09-23 15:26:40.556 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<User>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: User.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: User.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 1], [Property: User.Email (string) Required Index MaxLength(254), 2], [Property: User.FullName (string) Required MaxLength(100), 3], [Property: User.PasswordChangedAt (DateTime) Required ValueGenerated.OnAdd, 4], [Property: User.PasswordHash (string) Required MaxLength(200), 5], [Property: User.Username (string) Required Index MaxLength(50), 6] }
        SELECT TOP(2) u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
        FROM users AS u
        WHERE u.username == @__model_Username_0), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, User>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)
    .SingleOrDefault()'
2022-09-23 15:26:40.559 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 15:26:40.559 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2022-09-23 15:26:40.561 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 15:26:40.562 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:26:40.563 +01:00 [DBG] Executing DbCommand [Parameters=[@__model_Username_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.username = @__model_Username_0
LIMIT 2
2022-09-23 15:26:40.565 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[@__model_Username_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.username = @__model_Username_0
LIMIT 2
2022-09-23 15:26:40.571 +01:00 [DBG] Context 'PostgresContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 15:26:40.572 +01:00 [DBG] A data reader was disposed.
2022-09-23 15:26:40.573 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:26:40.574 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 15:26:40.772 +01:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .Any(user => user.RefreshTokenCollection
        .Any(reftoken => reftoken.RefToken == __token_0))'
2022-09-23 15:26:40.777 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<bool>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            EmptyProjectionMember -> 0
        SELECT EXISTS (
            SELECT 1
            FROM users AS u
            WHERE EXISTS (
                SELECT 1
                FROM refresh_token AS r
                WHERE ((u.id != NULL) && (u.id == r.user_id)) && (r.token == @__token_0)))), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, bool>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)
    .Single()'
2022-09-23 15:26:40.780 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 15:26:40.781 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2022-09-23 15:26:40.782 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 15:26:40.784 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:26:40.787 +01:00 [DBG] Executing DbCommand [Parameters=[@__token_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM users AS u
    WHERE EXISTS (
        SELECT 1
        FROM refresh_token AS r
        WHERE (u.id = r.user_id) AND (r.token = @__token_0)))
2022-09-23 15:26:40.790 +01:00 [INF] Executed DbCommand (3ms) [Parameters=[@__token_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM users AS u
    WHERE EXISTS (
        SELECT 1
        FROM refresh_token AS r
        WHERE (u.id = r.user_id) AND (r.token = @__token_0)))
2022-09-23 15:26:40.792 +01:00 [DBG] A data reader was disposed.
2022-09-23 15:26:40.793 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:26:40.793 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 15:26:40.794 +01:00 [DBG] SaveChanges starting for 'PostgresContext'.
2022-09-23 15:26:40.795 +01:00 [DBG] DetectChanges starting for 'PostgresContext'.
2022-09-23 15:26:40.796 +01:00 [DBG] 1 entities were added and 0 entities were removed from navigation 'User.RefreshTokenCollection'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 15:26:40.797 +01:00 [DBG] 'PostgresContext' generated a temporary value for the property 'Id.RefreshToken'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 15:26:40.799 +01:00 [DBG] Context 'PostgresContext' started tracking 'RefreshToken' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 15:26:40.801 +01:00 [DBG] DetectChanges completed for 'PostgresContext'.
2022-09-23 15:26:40.804 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 15:26:40.805 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:26:40.807 +01:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2022-09-23 15:26:40.808 +01:00 [DBG] Began transaction with isolation level 'ReadCommitted'.
2022-09-23 15:26:40.809 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 15:26:40.810 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2022-09-23 15:26:40.811 +01:00 [DBG] Executing DbCommand [Parameters=[@p0='?' (DbType = DateTime), @p1='?', @p2='?' (DbType = DateTime), @p3='?' (DbType = Boolean), @p4='?' (DbType = Boolean), @p5='?' (DbType = Boolean), @p6='?', @p7='?', @p8='?', @p9='?' (DbType = DateTime), @p10='?', @p11='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO refresh_token (created, created_by_ip, expires, is_active, is_expired, is_revoked, reason_revoked, token, replaced_by_token, revoked, revoked_by_ip, user_id)
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11)
RETURNING id;
2022-09-23 15:26:40.813 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[@p0='?' (DbType = DateTime), @p1='?', @p2='?' (DbType = DateTime), @p3='?' (DbType = Boolean), @p4='?' (DbType = Boolean), @p5='?' (DbType = Boolean), @p6='?', @p7='?', @p8='?', @p9='?' (DbType = DateTime), @p10='?', @p11='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO refresh_token (created, created_by_ip, expires, is_active, is_expired, is_revoked, reason_revoked, token, replaced_by_token, revoked, revoked_by_ip, user_id)
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11)
RETURNING id;
2022-09-23 15:26:40.815 +01:00 [DBG] The foreign key property 'RefreshToken.Id' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2022-09-23 15:26:40.817 +01:00 [DBG] A data reader was disposed.
2022-09-23 15:26:40.820 +01:00 [DBG] Committing transaction.
2022-09-23 15:26:40.823 +01:00 [DBG] Committed transaction.
2022-09-23 15:26:40.824 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:26:40.825 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 15:26:40.826 +01:00 [DBG] Disposing transaction.
2022-09-23 15:26:40.827 +01:00 [DBG] An entity of type 'RefreshToken' tracked by 'PostgresContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 15:26:40.829 +01:00 [DBG] SaveChanges completed for 'PostgresContext' with 1 entities written to the database.
2022-09-23 15:26:40.831 +01:00 [DBG] Compiling query expression: 
'DbSet<RefreshToken>()
    .Where(rt => rt.UserId == __id_0)
    .AsNoTracking()
    .Select(rt => new RefreshToken{ 
        Id = rt.Id, 
        UserId = rt.UserId, 
        RefToken = rt.RefToken, 
        Expires = rt.Expires, 
        Created = rt.Created, 
        CreatedByIp = rt.CreatedByIp, 
        Revoked = rt.Revoked, 
        RevokedByIp = rt.RevokedByIp, 
        ReplacedByToken = rt.ReplacedByToken, 
        ReasonRevoked = rt.ReasonRevoked, 
        IsExpired = rt.IsExpired, 
        IsRevoked = rt.IsRevoked, 
        IsActive = rt.IsActive 
    }
    )'
2022-09-23 15:26:40.843 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<RefreshToken>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            Id -> 0
            UserId -> 1
            RefToken -> 2
            Expires -> 3
            Created -> 4
            CreatedByIp -> 5
            Revoked -> 6
            RevokedByIp -> 7
            ReplacedByToken -> 8
            ReasonRevoked -> 9
            IsExpired -> 10
            IsRevoked -> 11
            IsActive -> 12
        SELECT r.id AS Id, r.user_id AS UserId, r.token AS RefToken, r.expires AS Expires, r.created AS Created, r.created_by_ip AS CreatedByIp, r.revoked AS Revoked, r.revoked_by_ip AS RevokedByIp, r.replaced_by_token AS ReplacedByToken, r.reason_revoked AS ReasonRevoked, r.is_expired AS IsExpired, r.is_revoked AS IsRevoked, r.is_active AS IsActive
        FROM refresh_token AS r
        WHERE r.user_id == @__id_0), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, RefreshToken>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)'
2022-09-23 15:26:40.846 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 15:26:40.849 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (2ms).
2022-09-23 15:26:40.852 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 15:26:40.854 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:26:40.856 +01:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.user_id AS "UserId", r.token AS "RefToken", r.expires AS "Expires", r.created AS "Created", r.created_by_ip AS "CreatedByIp", r.revoked AS "Revoked", r.revoked_by_ip AS "RevokedByIp", r.replaced_by_token AS "ReplacedByToken", r.reason_revoked AS "ReasonRevoked", r.is_expired AS "IsExpired", r.is_revoked AS "IsRevoked", r.is_active AS "IsActive"
FROM refresh_token AS r
WHERE r.user_id = @__id_0
2022-09-23 15:26:40.861 +01:00 [INF] Executed DbCommand (4ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.user_id AS "UserId", r.token AS "RefToken", r.expires AS "Expires", r.created AS "Created", r.created_by_ip AS "CreatedByIp", r.revoked AS "Revoked", r.revoked_by_ip AS "RevokedByIp", r.replaced_by_token AS "ReplacedByToken", r.reason_revoked AS "ReasonRevoked", r.is_expired AS "IsExpired", r.is_revoked AS "IsRevoked", r.is_active AS "IsActive"
FROM refresh_token AS r
WHERE r.user_id = @__id_0
2022-09-23 15:26:40.868 +01:00 [DBG] A data reader was disposed.
2022-09-23 15:26:40.869 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:26:40.871 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 15:26:40.872 +01:00 [DBG] An entity of type 'User' tracked by 'PostgresContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 15:26:40.874 +01:00 [DBG] An entity of type 'RefreshToken' tracked by 'PostgresContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 15:26:40.876 +01:00 [DBG] SaveChanges starting for 'PostgresContext'.
2022-09-23 15:26:40.876 +01:00 [DBG] DetectChanges starting for 'PostgresContext'.
2022-09-23 15:26:40.877 +01:00 [DBG] DetectChanges completed for 'PostgresContext'.
2022-09-23 15:26:40.878 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 15:26:40.880 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:26:40.881 +01:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2022-09-23 15:26:40.881 +01:00 [DBG] Began transaction with isolation level 'ReadCommitted'.
2022-09-23 15:26:40.883 +01:00 [DBG] Executing 2 update commands as a batch.
2022-09-23 15:26:40.885 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 15:26:40.886 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2022-09-23 15:26:40.887 +01:00 [DBG] Executing DbCommand [Parameters=[@p12='?' (DbType = Int32), @p0='?' (DbType = DateTime), @p1='?', @p2='?' (DbType = DateTime), @p3='?' (DbType = Boolean), @p4='?' (DbType = Boolean), @p5='?' (DbType = Boolean), @p6='?', @p7='?', @p8='?', @p9='?' (DbType = DateTime), @p10='?', @p11='?' (DbType = Int32), @p19='?' (DbType = Int32), @p13='?' (DbType = DateTime), @p14='?', @p15='?', @p16='?' (DbType = DateTime), @p17='?', @p18='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE refresh_token SET created = @p0, created_by_ip = @p1, expires = @p2, is_active = @p3, is_expired = @p4, is_revoked = @p5, reason_revoked = @p6, token = @p7, replaced_by_token = @p8, revoked = @p9, revoked_by_ip = @p10, user_id = @p11
WHERE id = @p12;
UPDATE users SET created_at = @p13, email = @p14, full_name = @p15, password_changed_at = @p16, password_hash = @p17, username = @p18
WHERE id = @p19;
2022-09-23 15:26:40.891 +01:00 [INF] Executed DbCommand (4ms) [Parameters=[@p12='?' (DbType = Int32), @p0='?' (DbType = DateTime), @p1='?', @p2='?' (DbType = DateTime), @p3='?' (DbType = Boolean), @p4='?' (DbType = Boolean), @p5='?' (DbType = Boolean), @p6='?', @p7='?', @p8='?', @p9='?' (DbType = DateTime), @p10='?', @p11='?' (DbType = Int32), @p19='?' (DbType = Int32), @p13='?' (DbType = DateTime), @p14='?', @p15='?', @p16='?' (DbType = DateTime), @p17='?', @p18='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE refresh_token SET created = @p0, created_by_ip = @p1, expires = @p2, is_active = @p3, is_expired = @p4, is_revoked = @p5, reason_revoked = @p6, token = @p7, replaced_by_token = @p8, revoked = @p9, revoked_by_ip = @p10, user_id = @p11
WHERE id = @p12;
UPDATE users SET created_at = @p13, email = @p14, full_name = @p15, password_changed_at = @p16, password_hash = @p17, username = @p18
WHERE id = @p19;
2022-09-23 15:26:40.893 +01:00 [DBG] A data reader was disposed.
2022-09-23 15:26:40.895 +01:00 [DBG] Committing transaction.
2022-09-23 15:26:40.896 +01:00 [DBG] Committed transaction.
2022-09-23 15:26:40.897 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:26:40.898 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 15:26:40.899 +01:00 [DBG] Disposing transaction.
2022-09-23 15:26:40.901 +01:00 [DBG] An entity of type 'User' tracked by 'PostgresContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 15:26:40.903 +01:00 [DBG] An entity of type 'RefreshToken' tracked by 'PostgresContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 15:26:40.905 +01:00 [DBG] SaveChanges completed for 'PostgresContext' with 2 entities written to the database.
2022-09-23 15:26:40.907 +01:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2022-09-23 15:26:40.909 +01:00 [DBG] Attempting to select an output formatter based on Accept header '["text/plain"]'.
2022-09-23 15:26:40.912 +01:00 [DBG] Could not find an output formatter based on content negotiation. Accepted types were (["text/plain"])
2022-09-23 15:26:40.913 +01:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2022-09-23 15:26:40.914 +01:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2022-09-23 15:26:40.915 +01:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2022-09-23 15:26:40.917 +01:00 [INF] Executing OkObjectResult, writing value of type 'APIBank.Models.MyRequestResponses.LoginResponse'.
2022-09-23 15:26:40.921 +01:00 [INF] Executed action APIBank.Controllers.UsersController.Login (APIBank) in 396.7091ms
2022-09-23 15:26:40.922 +01:00 [INF] Executed endpoint 'APIBank.Controllers.UsersController.Login (APIBank)'
2022-09-23 15:26:40.924 +01:00 [DBG] 'PostgresContext' disposed.
2022-09-23 15:26:40.926 +01:00 [INF] Request finished HTTP/2 POST https://localhost:7036/api/Users/Login application/json 58 - 200 - application/json;+charset=utf-8 432.4459ms
2022-09-23 15:27:00.233 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/api/Accounts/GetAll - -
2022-09-23 15:27:00.236 +01:00 [DBG] 1 candidate(s) found for the request path '/api/Accounts/GetAll'
2022-09-23 15:27:00.238 +01:00 [DBG] Endpoint 'APIBank.Controllers.AccountsController.GetAllFromUser (APIBank)' with route pattern 'api/Accounts/GetAll' is valid for the request path '/api/Accounts/GetAll'
2022-09-23 15:27:00.240 +01:00 [DBG] Request matched endpoint 'APIBank.Controllers.AccountsController.GetAllFromUser (APIBank)'
2022-09-23 15:27:00.241 +01:00 [DBG] Static files was skipped as the request already matched an endpoint.
2022-09-23 15:27:00.245 +01:00 [INF] Entity Framework Core 6.0.9 initialized 'PostgresContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:6.0.7+5b98e4b74de93b590b44aef8dd7967c03acc433c' with options: None
2022-09-23 15:27:00.250 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 15:27:00.254 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (4ms).
2022-09-23 15:27:00.255 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 15:27:00.256 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:27:00.259 +01:00 [DBG] Executing DbCommand [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.id = @__p_0
LIMIT 1
2022-09-23 15:27:00.261 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.id = @__p_0
LIMIT 1
2022-09-23 15:27:00.263 +01:00 [DBG] Context 'PostgresContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 15:27:00.264 +01:00 [DBG] A data reader was disposed.
2022-09-23 15:27:00.264 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:27:00.266 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 15:27:00.268 +01:00 [INF] Executing endpoint 'APIBank.Controllers.AccountsController.GetAllFromUser (APIBank)'
2022-09-23 15:27:00.270 +01:00 [INF] Route matched with {action = "GetAllFromUser", controller = "Accounts"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult GetAllFromUser() on controller APIBank.Controllers.AccountsController (APIBank).
2022-09-23 15:27:00.272 +01:00 [DBG] Execution plan of authorization filters (in the following order): ["APIBank.Authorization.AuthorizeAttribute"]
2022-09-23 15:27:00.275 +01:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2022-09-23 15:27:00.276 +01:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2022-09-23 15:27:00.277 +01:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2022-09-23 15:27:00.278 +01:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2022-09-23 15:27:00.279 +01:00 [DBG] Executing controller factory for controller APIBank.Controllers.AccountsController (APIBank)
2022-09-23 15:27:00.280 +01:00 [DBG] Executed controller factory for controller APIBank.Controllers.AccountsController (APIBank)
2022-09-23 15:27:00.282 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 15:27:00.285 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (2ms).
2022-09-23 15:27:00.286 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 15:27:00.287 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:27:00.288 +01:00 [DBG] Executing DbCommand [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id, r.created, r.created_by_ip, r.expires, r.is_active, r.is_expired, r.is_revoked, r.reason_revoked, r.token, r.replaced_by_token, r.revoked, r.revoked_by_ip, r.user_id
FROM refresh_token AS r
WHERE r.id = @__p_0
LIMIT 1
2022-09-23 15:27:00.291 +01:00 [INF] Executed DbCommand (3ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id, r.created, r.created_by_ip, r.expires, r.is_active, r.is_expired, r.is_revoked, r.reason_revoked, r.token, r.replaced_by_token, r.revoked, r.revoked_by_ip, r.user_id
FROM refresh_token AS r
WHERE r.id = @__p_0
LIMIT 1
2022-09-23 15:27:00.293 +01:00 [DBG] Context 'PostgresContext' started tracking 'RefreshToken' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 15:27:00.294 +01:00 [DBG] A data reader was disposed.
2022-09-23 15:27:00.294 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:27:00.295 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 15:27:00.296 +01:00 [DBG] Compiling query expression: 
'DbSet<Account>()
    .Where(u => u.UserId == __userId_0)
    .Select(u => new AccountRequestResponse{ 
        Balance = u.Balance, 
        CreatedAt = u.CreatedAt, 
        Currency = u.Currency, 
        Id = u.Id 
    }
    )'
2022-09-23 15:27:00.300 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<AccountRequestResponse>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            Balance -> 0
            CreatedAt -> 1
            Currency -> 2
            Id -> 3
        SELECT a.balance AS Balance, a.created_at AS CreatedAt, a.currency AS Currency, a.id AS Id
        FROM accounts AS a
        WHERE a.user_id == @__userId_0), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, AccountRequestResponse>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)'
2022-09-23 15:27:00.302 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 15:27:00.306 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (3ms).
2022-09-23 15:27:00.307 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 15:27:00.308 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:27:00.309 +01:00 [DBG] Executing DbCommand [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a.balance AS "Balance", a.created_at AS "CreatedAt", a.currency AS "Currency", a.id AS "Id"
FROM accounts AS a
WHERE a.user_id = @__userId_0
2022-09-23 15:27:00.311 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a.balance AS "Balance", a.created_at AS "CreatedAt", a.currency AS "Currency", a.id AS "Id"
FROM accounts AS a
WHERE a.user_id = @__userId_0
2022-09-23 15:27:00.313 +01:00 [DBG] A data reader was disposed.
2022-09-23 15:27:00.314 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:27:00.314 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 15:27:00.315 +01:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2022-09-23 15:27:00.317 +01:00 [DBG] Attempting to select an output formatter based on Accept header '["text/plain"]'.
2022-09-23 15:27:00.321 +01:00 [DBG] Could not find an output formatter based on content negotiation. Accepted types were (["text/plain"])
2022-09-23 15:27:00.323 +01:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2022-09-23 15:27:00.324 +01:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2022-09-23 15:27:00.324 +01:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2022-09-23 15:27:00.325 +01:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[APIBank.Models.Responses.AccountRequestResponse, APIBank, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2022-09-23 15:27:00.327 +01:00 [INF] Executed action APIBank.Controllers.AccountsController.GetAllFromUser (APIBank) in 47.9931ms
2022-09-23 15:27:00.332 +01:00 [INF] Executed endpoint 'APIBank.Controllers.AccountsController.GetAllFromUser (APIBank)'
2022-09-23 15:27:00.333 +01:00 [DBG] 'PostgresContext' disposed.
2022-09-23 15:27:00.336 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/api/Accounts/GetAll - - - 200 - application/json;+charset=utf-8 103.8740ms
2022-09-23 15:27:20.564 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/api/Accounts/GetById/100000000 - -
2022-09-23 15:27:20.579 +01:00 [DBG] 1 candidate(s) found for the request path '/api/Accounts/GetById/100000000'
2022-09-23 15:27:20.581 +01:00 [DBG] Endpoint 'APIBank.Controllers.AccountsController.GetById (APIBank)' with route pattern 'api/Accounts/GetById/{accountId}' is valid for the request path '/api/Accounts/GetById/100000000'
2022-09-23 15:27:20.584 +01:00 [DBG] Request matched endpoint 'APIBank.Controllers.AccountsController.GetById (APIBank)'
2022-09-23 15:27:20.585 +01:00 [DBG] Static files was skipped as the request already matched an endpoint.
2022-09-23 15:27:20.587 +01:00 [INF] Entity Framework Core 6.0.9 initialized 'PostgresContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:6.0.7+5b98e4b74de93b590b44aef8dd7967c03acc433c' with options: None
2022-09-23 15:27:20.589 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 15:27:20.592 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (2ms).
2022-09-23 15:27:20.592 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 15:27:20.593 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:27:20.594 +01:00 [DBG] Executing DbCommand [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.id = @__p_0
LIMIT 1
2022-09-23 15:27:20.596 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.id = @__p_0
LIMIT 1
2022-09-23 15:27:20.600 +01:00 [DBG] Context 'PostgresContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 15:27:20.601 +01:00 [DBG] A data reader was disposed.
2022-09-23 15:27:20.602 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:27:20.603 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 15:27:20.604 +01:00 [INF] Executing endpoint 'APIBank.Controllers.AccountsController.GetById (APIBank)'
2022-09-23 15:27:20.608 +01:00 [INF] Route matched with {action = "GetById", controller = "Accounts"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult GetById(Int32) on controller APIBank.Controllers.AccountsController (APIBank).
2022-09-23 15:27:20.609 +01:00 [DBG] Execution plan of authorization filters (in the following order): ["APIBank.Authorization.AuthorizeAttribute"]
2022-09-23 15:27:20.611 +01:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2022-09-23 15:27:20.612 +01:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2022-09-23 15:27:20.613 +01:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2022-09-23 15:27:20.616 +01:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2022-09-23 15:27:20.618 +01:00 [DBG] Executing controller factory for controller APIBank.Controllers.AccountsController (APIBank)
2022-09-23 15:27:20.619 +01:00 [DBG] Executed controller factory for controller APIBank.Controllers.AccountsController (APIBank)
2022-09-23 15:27:20.620 +01:00 [DBG] Attempting to bind parameter 'accountId' of type 'System.Int32' ...
2022-09-23 15:27:20.622 +01:00 [DBG] Attempting to bind parameter 'accountId' of type 'System.Int32' using the name 'accountId' in request data ...
2022-09-23 15:27:20.625 +01:00 [DBG] Done attempting to bind parameter 'accountId' of type 'System.Int32'.
2022-09-23 15:27:20.626 +01:00 [DBG] Done attempting to bind parameter 'accountId' of type 'System.Int32'.
2022-09-23 15:27:20.626 +01:00 [DBG] Attempting to validate the bound parameter 'accountId' of type 'System.Int32' ...
2022-09-23 15:27:20.628 +01:00 [DBG] Done attempting to validate the bound parameter 'accountId' of type 'System.Int32'.
2022-09-23 15:27:20.630 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 15:27:20.632 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (2ms).
2022-09-23 15:27:20.633 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 15:27:20.634 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:27:20.636 +01:00 [DBG] Executing DbCommand [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id, r.created, r.created_by_ip, r.expires, r.is_active, r.is_expired, r.is_revoked, r.reason_revoked, r.token, r.replaced_by_token, r.revoked, r.revoked_by_ip, r.user_id
FROM refresh_token AS r
WHERE r.id = @__p_0
LIMIT 1
2022-09-23 15:27:20.638 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id, r.created, r.created_by_ip, r.expires, r.is_active, r.is_expired, r.is_revoked, r.reason_revoked, r.token, r.replaced_by_token, r.revoked, r.revoked_by_ip, r.user_id
FROM refresh_token AS r
WHERE r.id = @__p_0
LIMIT 1
2022-09-23 15:27:20.640 +01:00 [DBG] Context 'PostgresContext' started tracking 'RefreshToken' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 15:27:20.641 +01:00 [DBG] A data reader was disposed.
2022-09-23 15:27:20.642 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:27:20.643 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 15:27:20.644 +01:00 [DBG] Compiling query expression: 
'DbSet<Account>()
    .Include(a => a.Transactions)
    .Where(a => a.Id == __accountId_0 && a.UserId == __userId_1)
    .Select(a => new AccountMovims{ 
        Account = new AccountRequestResponse{ 
            Balance = a.Balance, 
            Currency = a.Currency, 
            CreatedAt = a.CreatedAt, 
            Id = a.Id 
        }
        , 
        Movims = a.Transactions
            .Select(b => new Movim{ 
                Amount = b.Amount, 
                CreatedAt = b.CreatedAt 
            }
            )
            .ToArray() 
    }
    )
    .SingleOrDefault()'
2022-09-23 15:27:20.655 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<AccountMovims>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Client Projections:
            0 -> 0
            1 -> 1
            2 -> 2
            3 -> 3
            4 -> 4
            5 -> 5
            6 -> 6
        SELECT t.balance, t.currency, t.created_at, t.id, t0.amount, t0.created_at, t0.id
        FROM 
        (
            SELECT TOP(2) a.balance, a.currency, a.created_at, a.id
            FROM accounts AS a
            WHERE (a.id == @__accountId_0) && (a.user_id == @__userId_1)
        ) AS t
        LEFT JOIN transactions AS t0 ON t.id == t0.account_id
        ORDER BY t.id ASC), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, AccountMovims>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)
    .SingleOrDefault()'
2022-09-23 15:27:20.657 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 15:27:20.657 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2022-09-23 15:27:20.659 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 15:27:20.660 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:27:20.661 +01:00 [DBG] Executing DbCommand [Parameters=[@__accountId_0='?' (DbType = Int32), @__userId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT t.balance, t.currency, t.created_at, t.id, t0.amount, t0.created_at, t0.id
FROM (
    SELECT a.balance, a.currency, a.created_at, a.id
    FROM accounts AS a
    WHERE (a.id = @__accountId_0) AND (a.user_id = @__userId_1)
    LIMIT 2
) AS t
LEFT JOIN transactions AS t0 ON t.id = t0.account_id
ORDER BY t.id
2022-09-23 15:27:20.663 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[@__accountId_0='?' (DbType = Int32), @__userId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT t.balance, t.currency, t.created_at, t.id, t0.amount, t0.created_at, t0.id
FROM (
    SELECT a.balance, a.currency, a.created_at, a.id
    FROM accounts AS a
    WHERE (a.id = @__accountId_0) AND (a.user_id = @__userId_1)
    LIMIT 2
) AS t
LEFT JOIN transactions AS t0 ON t.id = t0.account_id
ORDER BY t.id
2022-09-23 15:27:20.669 +01:00 [DBG] A data reader was disposed.
2022-09-23 15:27:20.670 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:27:20.671 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 15:27:20.672 +01:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2022-09-23 15:27:20.674 +01:00 [DBG] Attempting to select an output formatter based on Accept header '["text/plain"]'.
2022-09-23 15:27:20.676 +01:00 [DBG] Could not find an output formatter based on content negotiation. Accepted types were (["text/plain"])
2022-09-23 15:27:20.676 +01:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2022-09-23 15:27:20.677 +01:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2022-09-23 15:27:20.678 +01:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2022-09-23 15:27:20.679 +01:00 [INF] Executing OkObjectResult, writing value of type 'APIBank.Models.Responses.AccountMovims'.
2022-09-23 15:27:20.685 +01:00 [INF] Executed action APIBank.Controllers.AccountsController.GetById (APIBank) in 67.0083ms
2022-09-23 15:27:20.686 +01:00 [INF] Executed endpoint 'APIBank.Controllers.AccountsController.GetById (APIBank)'
2022-09-23 15:27:20.688 +01:00 [DBG] 'PostgresContext' disposed.
2022-09-23 15:27:20.690 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/api/Accounts/GetById/100000000 - - - 200 - application/json;+charset=utf-8 127.5363ms
2022-09-23 15:27:29.647 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/api/Accounts/GetById/100000003 - -
2022-09-23 15:27:29.649 +01:00 [DBG] 1 candidate(s) found for the request path '/api/Accounts/GetById/100000003'
2022-09-23 15:27:29.650 +01:00 [DBG] Endpoint 'APIBank.Controllers.AccountsController.GetById (APIBank)' with route pattern 'api/Accounts/GetById/{accountId}' is valid for the request path '/api/Accounts/GetById/100000003'
2022-09-23 15:27:29.653 +01:00 [DBG] Request matched endpoint 'APIBank.Controllers.AccountsController.GetById (APIBank)'
2022-09-23 15:27:29.654 +01:00 [DBG] Static files was skipped as the request already matched an endpoint.
2022-09-23 15:27:29.661 +01:00 [INF] Entity Framework Core 6.0.9 initialized 'PostgresContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:6.0.7+5b98e4b74de93b590b44aef8dd7967c03acc433c' with options: None
2022-09-23 15:27:29.663 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 15:27:29.664 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2022-09-23 15:27:29.665 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 15:27:29.666 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:27:29.669 +01:00 [DBG] Executing DbCommand [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.id = @__p_0
LIMIT 1
2022-09-23 15:27:29.671 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.id = @__p_0
LIMIT 1
2022-09-23 15:27:29.674 +01:00 [DBG] Context 'PostgresContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 15:27:29.677 +01:00 [DBG] A data reader was disposed.
2022-09-23 15:27:29.678 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:27:29.679 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 15:27:29.680 +01:00 [INF] Executing endpoint 'APIBank.Controllers.AccountsController.GetById (APIBank)'
2022-09-23 15:27:29.681 +01:00 [INF] Route matched with {action = "GetById", controller = "Accounts"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult GetById(Int32) on controller APIBank.Controllers.AccountsController (APIBank).
2022-09-23 15:27:29.684 +01:00 [DBG] Execution plan of authorization filters (in the following order): ["APIBank.Authorization.AuthorizeAttribute"]
2022-09-23 15:27:29.686 +01:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2022-09-23 15:27:29.687 +01:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2022-09-23 15:27:29.689 +01:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2022-09-23 15:27:29.691 +01:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2022-09-23 15:27:29.693 +01:00 [DBG] Executing controller factory for controller APIBank.Controllers.AccountsController (APIBank)
2022-09-23 15:27:29.694 +01:00 [DBG] Executed controller factory for controller APIBank.Controllers.AccountsController (APIBank)
2022-09-23 15:27:29.696 +01:00 [DBG] Attempting to bind parameter 'accountId' of type 'System.Int32' ...
2022-09-23 15:27:29.697 +01:00 [DBG] Attempting to bind parameter 'accountId' of type 'System.Int32' using the name 'accountId' in request data ...
2022-09-23 15:27:29.700 +01:00 [DBG] Done attempting to bind parameter 'accountId' of type 'System.Int32'.
2022-09-23 15:27:29.701 +01:00 [DBG] Done attempting to bind parameter 'accountId' of type 'System.Int32'.
2022-09-23 15:27:29.702 +01:00 [DBG] Attempting to validate the bound parameter 'accountId' of type 'System.Int32' ...
2022-09-23 15:27:29.703 +01:00 [DBG] Done attempting to validate the bound parameter 'accountId' of type 'System.Int32'.
2022-09-23 15:27:29.706 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 15:27:29.708 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2022-09-23 15:27:29.710 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 15:27:29.711 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:27:29.712 +01:00 [DBG] Executing DbCommand [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id, r.created, r.created_by_ip, r.expires, r.is_active, r.is_expired, r.is_revoked, r.reason_revoked, r.token, r.replaced_by_token, r.revoked, r.revoked_by_ip, r.user_id
FROM refresh_token AS r
WHERE r.id = @__p_0
LIMIT 1
2022-09-23 15:27:29.716 +01:00 [INF] Executed DbCommand (4ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id, r.created, r.created_by_ip, r.expires, r.is_active, r.is_expired, r.is_revoked, r.reason_revoked, r.token, r.replaced_by_token, r.revoked, r.revoked_by_ip, r.user_id
FROM refresh_token AS r
WHERE r.id = @__p_0
LIMIT 1
2022-09-23 15:27:29.718 +01:00 [DBG] Context 'PostgresContext' started tracking 'RefreshToken' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 15:27:29.720 +01:00 [DBG] A data reader was disposed.
2022-09-23 15:27:29.720 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:27:29.721 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 15:27:29.724 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 15:27:29.726 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2022-09-23 15:27:29.727 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 15:27:29.729 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:27:29.731 +01:00 [DBG] Executing DbCommand [Parameters=[@__accountId_0='?' (DbType = Int32), @__userId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT t.balance, t.currency, t.created_at, t.id, t0.amount, t0.created_at, t0.id
FROM (
    SELECT a.balance, a.currency, a.created_at, a.id
    FROM accounts AS a
    WHERE (a.id = @__accountId_0) AND (a.user_id = @__userId_1)
    LIMIT 2
) AS t
LEFT JOIN transactions AS t0 ON t.id = t0.account_id
ORDER BY t.id
2022-09-23 15:27:29.733 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[@__accountId_0='?' (DbType = Int32), @__userId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT t.balance, t.currency, t.created_at, t.id, t0.amount, t0.created_at, t0.id
FROM (
    SELECT a.balance, a.currency, a.created_at, a.id
    FROM accounts AS a
    WHERE (a.id = @__accountId_0) AND (a.user_id = @__userId_1)
    LIMIT 2
) AS t
LEFT JOIN transactions AS t0 ON t.id = t0.account_id
ORDER BY t.id
2022-09-23 15:27:29.735 +01:00 [DBG] A data reader was disposed.
2022-09-23 15:27:29.736 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:27:29.737 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 15:27:29.738 +01:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2022-09-23 15:27:29.741 +01:00 [DBG] Attempting to select an output formatter based on Accept header '["text/plain"]'.
2022-09-23 15:27:29.743 +01:00 [DBG] Could not find an output formatter based on content negotiation. Accepted types were (["text/plain"])
2022-09-23 15:27:29.746 +01:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2022-09-23 15:27:29.747 +01:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2022-09-23 15:27:29.748 +01:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2022-09-23 15:27:29.749 +01:00 [INF] Executing OkObjectResult, writing value of type 'APIBank.Models.Responses.AccountMovims'.
2022-09-23 15:27:29.750 +01:00 [INF] Executed action APIBank.Controllers.AccountsController.GetById (APIBank) in 57.2042ms
2022-09-23 15:27:29.752 +01:00 [INF] Executed endpoint 'APIBank.Controllers.AccountsController.GetById (APIBank)'
2022-09-23 15:27:29.753 +01:00 [DBG] 'PostgresContext' disposed.
2022-09-23 15:27:29.754 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/api/Accounts/GetById/100000003 - - - 200 - application/json;+charset=utf-8 107.2598ms
2022-09-23 15:27:53.746 +01:00 [INF] Request starting HTTP/2 POST https://localhost:7036/api/Transfers/TransferRequest application/json 76
2022-09-23 15:27:53.766 +01:00 [DBG] 1 candidate(s) found for the request path '/api/Transfers/TransferRequest'
2022-09-23 15:27:53.771 +01:00 [DBG] Endpoint 'APIBank.Controllers.TransfersController.Create (APIBank)' with route pattern 'api/Transfers/TransferRequest' is valid for the request path '/api/Transfers/TransferRequest'
2022-09-23 15:27:53.778 +01:00 [DBG] Request matched endpoint 'APIBank.Controllers.TransfersController.Create (APIBank)'
2022-09-23 15:27:53.780 +01:00 [DBG] Static files was skipped as the request already matched an endpoint.
2022-09-23 15:27:53.824 +01:00 [INF] Executing endpoint 'APIBank.Controllers.TransfersController.Create (APIBank)'
2022-09-23 15:27:53.829 +01:00 [INF] Route matched with {action = "Create", controller = "Transfers"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult Create(APIBank.Models.Requests.TransferRequest) on controller APIBank.Controllers.TransfersController (APIBank).
2022-09-23 15:27:53.831 +01:00 [DBG] Execution plan of authorization filters (in the following order): ["APIBank.Authorization.AuthorizeAttribute"]
2022-09-23 15:27:53.832 +01:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2022-09-23 15:27:53.833 +01:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2022-09-23 15:27:53.840 +01:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2022-09-23 15:27:53.841 +01:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2022-09-23 15:27:53.842 +01:00 [INF] Authorization failed for the request at filter 'APIBank.Authorization.AuthorizeAttribute'.
2022-09-23 15:27:53.844 +01:00 [INF] Executing JsonResult, writing value of type '<>f__AnonymousType0`1[[System.String, System.Private.CoreLib, Version=6.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2022-09-23 15:27:53.845 +01:00 [INF] Executed action APIBank.Controllers.TransfersController.Create (APIBank) in 2.2607ms
2022-09-23 15:27:53.846 +01:00 [INF] Executed endpoint 'APIBank.Controllers.TransfersController.Create (APIBank)'
2022-09-23 15:27:53.847 +01:00 [INF] Request finished HTTP/2 POST https://localhost:7036/api/Transfers/TransferRequest application/json 76 - 401 - application/json;+charset=utf-8 101.3736ms
2022-09-23 15:27:53.854 +01:00 [DBG] Connection id "0HMKTDSHHPGJA", Request id "0HMKTDSHHPGJA:00000025": started reading request body.
2022-09-23 15:27:53.856 +01:00 [DBG] Connection id "0HMKTDSHHPGJA", Request id "0HMKTDSHHPGJA:00000025": done reading request body.
2022-09-23 15:28:01.268 +01:00 [INF] Request starting HTTP/2 POST https://localhost:7036/api/Users/refreshToken - 0
2022-09-23 15:28:01.292 +01:00 [DBG] 1 candidate(s) found for the request path '/api/Users/refreshToken'
2022-09-23 15:28:01.293 +01:00 [DBG] Endpoint 'APIBank.Controllers.UsersController.RefreshToken (APIBank)' with route pattern 'api/Users/refreshToken' is valid for the request path '/api/Users/refreshToken'
2022-09-23 15:28:01.300 +01:00 [DBG] Request matched endpoint 'APIBank.Controllers.UsersController.RefreshToken (APIBank)'
2022-09-23 15:28:01.301 +01:00 [DBG] Static files was skipped as the request already matched an endpoint.
2022-09-23 15:28:01.332 +01:00 [INF] Executing endpoint 'APIBank.Controllers.UsersController.RefreshToken (APIBank)'
2022-09-23 15:28:01.336 +01:00 [INF] Route matched with {action = "RefreshToken", controller = "Users"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult RefreshToken() on controller APIBank.Controllers.UsersController (APIBank).
2022-09-23 15:28:01.338 +01:00 [DBG] Execution plan of authorization filters (in the following order): ["APIBank.Authorization.AuthorizeAttribute"]
2022-09-23 15:28:01.339 +01:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2022-09-23 15:28:01.341 +01:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2022-09-23 15:28:01.343 +01:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2022-09-23 15:28:01.346 +01:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2022-09-23 15:28:01.349 +01:00 [DBG] Executing controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-23 15:28:01.353 +01:00 [DBG] Executed controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-23 15:28:01.360 +01:00 [INF] Entity Framework Core 6.0.9 initialized 'PostgresContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:6.0.7+5b98e4b74de93b590b44aef8dd7967c03acc433c' with options: None
2022-09-23 15:28:01.366 +01:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .SingleOrDefault(userQuery => userQuery.RefreshTokenCollection
        .Any(refTokenQuery => refTokenQuery.RefToken == __refToken_0))'
2022-09-23 15:28:01.373 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<User>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: User.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: User.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 1], [Property: User.Email (string) Required Index MaxLength(254), 2], [Property: User.FullName (string) Required MaxLength(100), 3], [Property: User.PasswordChangedAt (DateTime) Required ValueGenerated.OnAdd, 4], [Property: User.PasswordHash (string) Required MaxLength(200), 5], [Property: User.Username (string) Required Index MaxLength(50), 6] }
        SELECT TOP(2) u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
        FROM users AS u
        WHERE EXISTS (
            SELECT 1
            FROM refresh_token AS r
            WHERE ((u.id != NULL) && (u.id == r.user_id)) && (r.token == @__refToken_0))), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, User>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)
    .SingleOrDefault()'
2022-09-23 15:28:01.376 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 15:28:01.379 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (2ms).
2022-09-23 15:28:01.383 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 15:28:01.384 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:28:01.386 +01:00 [DBG] Executing DbCommand [Parameters=[@__refToken_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE EXISTS (
    SELECT 1
    FROM refresh_token AS r
    WHERE (u.id = r.user_id) AND (r.token = @__refToken_0))
LIMIT 2
2022-09-23 15:28:01.389 +01:00 [INF] Executed DbCommand (3ms) [Parameters=[@__refToken_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE EXISTS (
    SELECT 1
    FROM refresh_token AS r
    WHERE (u.id = r.user_id) AND (r.token = @__refToken_0))
LIMIT 2
2022-09-23 15:28:01.391 +01:00 [DBG] Context 'PostgresContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 15:28:01.392 +01:00 [DBG] A data reader was disposed.
2022-09-23 15:28:01.393 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:28:01.395 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 15:28:01.399 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 15:28:01.400 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2022-09-23 15:28:01.401 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 15:28:01.402 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:28:01.404 +01:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.user_id AS "UserId", r.token AS "RefToken", r.expires AS "Expires", r.created AS "Created", r.created_by_ip AS "CreatedByIp", r.revoked AS "Revoked", r.revoked_by_ip AS "RevokedByIp", r.replaced_by_token AS "ReplacedByToken", r.reason_revoked AS "ReasonRevoked", r.is_expired AS "IsExpired", r.is_revoked AS "IsRevoked", r.is_active AS "IsActive"
FROM refresh_token AS r
WHERE r.user_id = @__id_0
2022-09-23 15:28:01.406 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.user_id AS "UserId", r.token AS "RefToken", r.expires AS "Expires", r.created AS "Created", r.created_by_ip AS "CreatedByIp", r.revoked AS "Revoked", r.revoked_by_ip AS "RevokedByIp", r.replaced_by_token AS "ReplacedByToken", r.reason_revoked AS "ReasonRevoked", r.is_expired AS "IsExpired", r.is_revoked AS "IsRevoked", r.is_active AS "IsActive"
FROM refresh_token AS r
WHERE r.user_id = @__id_0
2022-09-23 15:28:01.408 +01:00 [DBG] A data reader was disposed.
2022-09-23 15:28:01.409 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:28:01.410 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 15:28:01.416 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 15:28:01.417 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2022-09-23 15:28:01.418 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 15:28:01.420 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:28:01.421 +01:00 [DBG] Executing DbCommand [Parameters=[@__token_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM users AS u
    WHERE EXISTS (
        SELECT 1
        FROM refresh_token AS r
        WHERE (u.id = r.user_id) AND (r.token = @__token_0)))
2022-09-23 15:28:01.424 +01:00 [INF] Executed DbCommand (3ms) [Parameters=[@__token_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM users AS u
    WHERE EXISTS (
        SELECT 1
        FROM refresh_token AS r
        WHERE (u.id = r.user_id) AND (r.token = @__token_0)))
2022-09-23 15:28:01.425 +01:00 [DBG] A data reader was disposed.
2022-09-23 15:28:01.427 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:28:01.429 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 15:28:01.431 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 15:28:01.432 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2022-09-23 15:28:01.433 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 15:28:01.434 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:28:01.436 +01:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.user_id AS "UserId", r.token AS "RefToken", r.expires AS "Expires", r.created AS "Created", r.created_by_ip AS "CreatedByIp", r.revoked AS "Revoked", r.revoked_by_ip AS "RevokedByIp", r.replaced_by_token AS "ReplacedByToken", r.reason_revoked AS "ReasonRevoked", r.is_expired AS "IsExpired", r.is_revoked AS "IsRevoked", r.is_active AS "IsActive"
FROM refresh_token AS r
WHERE r.user_id = @__id_0
2022-09-23 15:28:01.438 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.user_id AS "UserId", r.token AS "RefToken", r.expires AS "Expires", r.created AS "Created", r.created_by_ip AS "CreatedByIp", r.revoked AS "Revoked", r.revoked_by_ip AS "RevokedByIp", r.replaced_by_token AS "ReplacedByToken", r.reason_revoked AS "ReasonRevoked", r.is_expired AS "IsExpired", r.is_revoked AS "IsRevoked", r.is_active AS "IsActive"
FROM refresh_token AS r
WHERE r.user_id = @__id_0
2022-09-23 15:28:01.440 +01:00 [DBG] A data reader was disposed.
2022-09-23 15:28:01.442 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:28:01.443 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 15:28:01.446 +01:00 [DBG] An entity of type 'User' tracked by 'PostgresContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 15:28:01.448 +01:00 [DBG] SaveChanges starting for 'PostgresContext'.
2022-09-23 15:28:01.449 +01:00 [DBG] DetectChanges starting for 'PostgresContext'.
2022-09-23 15:28:01.449 +01:00 [DBG] 1 entities were added and 0 entities were removed from navigation 'User.RefreshTokenCollection'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 15:28:01.451 +01:00 [DBG] 'PostgresContext' generated a temporary value for the property 'Id.RefreshToken'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 15:28:01.453 +01:00 [DBG] Context 'PostgresContext' started tracking 'RefreshToken' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 15:28:01.455 +01:00 [DBG] DetectChanges completed for 'PostgresContext'.
2022-09-23 15:28:01.456 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 15:28:01.458 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:28:01.459 +01:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2022-09-23 15:28:01.460 +01:00 [DBG] Began transaction with isolation level 'ReadCommitted'.
2022-09-23 15:28:01.463 +01:00 [DBG] Executing 2 update commands as a batch.
2022-09-23 15:28:01.465 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 15:28:01.466 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2022-09-23 15:28:01.467 +01:00 [DBG] Executing DbCommand [Parameters=[@p0='?' (DbType = DateTime), @p1='?', @p2='?' (DbType = DateTime), @p3='?' (DbType = Boolean), @p4='?' (DbType = Boolean), @p5='?' (DbType = Boolean), @p6='?', @p7='?', @p8='?', @p9='?' (DbType = DateTime), @p10='?', @p11='?' (DbType = Int32), @p18='?' (DbType = Int32), @p12='?' (DbType = DateTime), @p13='?', @p14='?', @p15='?' (DbType = DateTime), @p16='?', @p17='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO refresh_token (created, created_by_ip, expires, is_active, is_expired, is_revoked, reason_revoked, token, replaced_by_token, revoked, revoked_by_ip, user_id)
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11)
RETURNING id;
UPDATE users SET created_at = @p12, email = @p13, full_name = @p14, password_changed_at = @p15, password_hash = @p16, username = @p17
WHERE id = @p18;
2022-09-23 15:28:01.470 +01:00 [INF] Executed DbCommand (3ms) [Parameters=[@p0='?' (DbType = DateTime), @p1='?', @p2='?' (DbType = DateTime), @p3='?' (DbType = Boolean), @p4='?' (DbType = Boolean), @p5='?' (DbType = Boolean), @p6='?', @p7='?', @p8='?', @p9='?' (DbType = DateTime), @p10='?', @p11='?' (DbType = Int32), @p18='?' (DbType = Int32), @p12='?' (DbType = DateTime), @p13='?', @p14='?', @p15='?' (DbType = DateTime), @p16='?', @p17='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO refresh_token (created, created_by_ip, expires, is_active, is_expired, is_revoked, reason_revoked, token, replaced_by_token, revoked, revoked_by_ip, user_id)
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11)
RETURNING id;
UPDATE users SET created_at = @p12, email = @p13, full_name = @p14, password_changed_at = @p15, password_hash = @p16, username = @p17
WHERE id = @p18;
2022-09-23 15:28:01.476 +01:00 [DBG] The foreign key property 'RefreshToken.Id' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2022-09-23 15:28:01.482 +01:00 [DBG] A data reader was disposed.
2022-09-23 15:28:01.484 +01:00 [DBG] Committing transaction.
2022-09-23 15:28:01.497 +01:00 [DBG] Committed transaction.
2022-09-23 15:28:01.502 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:28:01.505 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 15:28:01.507 +01:00 [DBG] Disposing transaction.
2022-09-23 15:28:01.509 +01:00 [DBG] An entity of type 'RefreshToken' tracked by 'PostgresContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 15:28:01.514 +01:00 [DBG] An entity of type 'User' tracked by 'PostgresContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 15:28:01.516 +01:00 [DBG] SaveChanges completed for 'PostgresContext' with 2 entities written to the database.
2022-09-23 15:28:01.520 +01:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2022-09-23 15:28:01.524 +01:00 [DBG] Attempting to select an output formatter based on Accept header '["text/plain"]'.
2022-09-23 15:28:01.525 +01:00 [DBG] Could not find an output formatter based on content negotiation. Accepted types were (["text/plain"])
2022-09-23 15:28:01.526 +01:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2022-09-23 15:28:01.529 +01:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2022-09-23 15:28:01.530 +01:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2022-09-23 15:28:01.533 +01:00 [INF] Executing OkObjectResult, writing value of type 'APIBank.Models.MyRequestResponses.LoginResponse'.
2022-09-23 15:28:01.537 +01:00 [INF] Executed action APIBank.Controllers.UsersController.RefreshToken (APIBank) in 187.956ms
2022-09-23 15:28:01.538 +01:00 [INF] Executed endpoint 'APIBank.Controllers.UsersController.RefreshToken (APIBank)'
2022-09-23 15:28:01.539 +01:00 [DBG] 'PostgresContext' disposed.
2022-09-23 15:28:01.541 +01:00 [INF] Request finished HTTP/2 POST https://localhost:7036/api/Users/refreshToken - 0 - 200 - application/json;+charset=utf-8 272.4131ms
2022-09-23 15:28:15.185 +01:00 [INF] Request starting HTTP/2 POST https://localhost:7036/api/Transfers/TransferRequest application/json 76
2022-09-23 15:28:15.189 +01:00 [DBG] 1 candidate(s) found for the request path '/api/Transfers/TransferRequest'
2022-09-23 15:28:15.189 +01:00 [DBG] Endpoint 'APIBank.Controllers.TransfersController.Create (APIBank)' with route pattern 'api/Transfers/TransferRequest' is valid for the request path '/api/Transfers/TransferRequest'
2022-09-23 15:28:15.191 +01:00 [DBG] Request matched endpoint 'APIBank.Controllers.TransfersController.Create (APIBank)'
2022-09-23 15:28:15.209 +01:00 [DBG] Static files was skipped as the request already matched an endpoint.
2022-09-23 15:28:15.212 +01:00 [INF] Entity Framework Core 6.0.9 initialized 'PostgresContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:6.0.7+5b98e4b74de93b590b44aef8dd7967c03acc433c' with options: None
2022-09-23 15:28:15.218 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 15:28:15.220 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2022-09-23 15:28:15.222 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 15:28:15.223 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:28:15.225 +01:00 [DBG] Executing DbCommand [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.id = @__p_0
LIMIT 1
2022-09-23 15:28:15.227 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.id = @__p_0
LIMIT 1
2022-09-23 15:28:15.231 +01:00 [DBG] Context 'PostgresContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 15:28:15.233 +01:00 [DBG] A data reader was disposed.
2022-09-23 15:28:15.234 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:28:15.235 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 15:28:15.236 +01:00 [INF] Executing endpoint 'APIBank.Controllers.TransfersController.Create (APIBank)'
2022-09-23 15:28:15.237 +01:00 [INF] Route matched with {action = "Create", controller = "Transfers"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult Create(APIBank.Models.Requests.TransferRequest) on controller APIBank.Controllers.TransfersController (APIBank).
2022-09-23 15:28:15.239 +01:00 [DBG] Execution plan of authorization filters (in the following order): ["APIBank.Authorization.AuthorizeAttribute"]
2022-09-23 15:28:15.240 +01:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2022-09-23 15:28:15.240 +01:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2022-09-23 15:28:15.242 +01:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2022-09-23 15:28:15.242 +01:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2022-09-23 15:28:15.245 +01:00 [DBG] Executing controller factory for controller APIBank.Controllers.TransfersController (APIBank)
2022-09-23 15:28:15.246 +01:00 [DBG] Executed controller factory for controller APIBank.Controllers.TransfersController (APIBank)
2022-09-23 15:28:15.248 +01:00 [DBG] Attempting to bind parameter 'model' of type 'APIBank.Models.Requests.TransferRequest' ...
2022-09-23 15:28:15.250 +01:00 [DBG] Attempting to bind parameter 'model' of type 'APIBank.Models.Requests.TransferRequest' using the name '' in request data ...
2022-09-23 15:28:15.252 +01:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2022-09-23 15:28:15.254 +01:00 [DBG] Connection id "0HMKTDSHHPGJA", Request id "0HMKTDSHHPGJA:00000029": started reading request body.
2022-09-23 15:28:15.255 +01:00 [DBG] Connection id "0HMKTDSHHPGJA", Request id "0HMKTDSHHPGJA:00000029": done reading request body.
2022-09-23 15:28:15.257 +01:00 [DBG] JSON input formatter succeeded, deserializing to type 'APIBank.Models.Requests.TransferRequest'
2022-09-23 15:28:15.262 +01:00 [DBG] Done attempting to bind parameter 'model' of type 'APIBank.Models.Requests.TransferRequest'.
2022-09-23 15:28:15.265 +01:00 [DBG] Done attempting to bind parameter 'model' of type 'APIBank.Models.Requests.TransferRequest'.
2022-09-23 15:28:15.267 +01:00 [DBG] Attempting to validate the bound parameter 'model' of type 'APIBank.Models.Requests.TransferRequest' ...
2022-09-23 15:28:15.273 +01:00 [DBG] Done attempting to validate the bound parameter 'model' of type 'APIBank.Models.Requests.TransferRequest'.
2022-09-23 15:28:15.276 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 15:28:15.277 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2022-09-23 15:28:15.278 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 15:28:15.279 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:28:15.281 +01:00 [DBG] Executing DbCommand [Parameters=[@__accountId_0='?' (DbType = Int32), @__userId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT t.balance, t.currency, t.created_at, t.id, t0.amount, t0.created_at, t0.id
FROM (
    SELECT a.balance, a.currency, a.created_at, a.id
    FROM accounts AS a
    WHERE (a.id = @__accountId_0) AND (a.user_id = @__userId_1)
    LIMIT 2
) AS t
LEFT JOIN transactions AS t0 ON t.id = t0.account_id
ORDER BY t.id
2022-09-23 15:28:15.286 +01:00 [INF] Executed DbCommand (5ms) [Parameters=[@__accountId_0='?' (DbType = Int32), @__userId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT t.balance, t.currency, t.created_at, t.id, t0.amount, t0.created_at, t0.id
FROM (
    SELECT a.balance, a.currency, a.created_at, a.id
    FROM accounts AS a
    WHERE (a.id = @__accountId_0) AND (a.user_id = @__userId_1)
    LIMIT 2
) AS t
LEFT JOIN transactions AS t0 ON t.id = t0.account_id
ORDER BY t.id
2022-09-23 15:28:15.288 +01:00 [DBG] A data reader was disposed.
2022-09-23 15:28:15.290 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:28:15.291 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 15:28:15.292 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 15:28:15.293 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2022-09-23 15:28:15.294 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 15:28:15.294 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:28:15.295 +01:00 [DBG] Executing DbCommand [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id, r.created, r.created_by_ip, r.expires, r.is_active, r.is_expired, r.is_revoked, r.reason_revoked, r.token, r.replaced_by_token, r.revoked, r.revoked_by_ip, r.user_id
FROM refresh_token AS r
WHERE r.id = @__p_0
LIMIT 1
2022-09-23 15:28:15.297 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id, r.created, r.created_by_ip, r.expires, r.is_active, r.is_expired, r.is_revoked, r.reason_revoked, r.token, r.replaced_by_token, r.revoked, r.revoked_by_ip, r.user_id
FROM refresh_token AS r
WHERE r.id = @__p_0
LIMIT 1
2022-09-23 15:28:15.300 +01:00 [DBG] Context 'PostgresContext' started tracking 'RefreshToken' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 15:28:15.303 +01:00 [DBG] A data reader was disposed.
2022-09-23 15:28:15.303 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:28:15.306 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 15:28:15.312 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 15:28:15.313 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:28:15.314 +01:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2022-09-23 15:28:15.316 +01:00 [DBG] Began transaction with isolation level 'ReadCommitted'.
2022-09-23 15:28:15.317 +01:00 [DBG] 'PostgresContext' generated a temporary value for the property 'Id.Transfer'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 15:28:15.319 +01:00 [DBG] Context 'PostgresContext' started tracking 'Transfer' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 15:28:15.324 +01:00 [DBG] SaveChanges starting for 'PostgresContext'.
2022-09-23 15:28:15.328 +01:00 [DBG] DetectChanges starting for 'PostgresContext'.
2022-09-23 15:28:15.329 +01:00 [DBG] DetectChanges completed for 'PostgresContext'.
2022-09-23 15:28:15.330 +01:00 [DBG] Creating transaction savepoint.
2022-09-23 15:28:15.330 +01:00 [DBG] Created transaction savepoint.
2022-09-23 15:28:15.331 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 15:28:15.333 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2022-09-23 15:28:15.334 +01:00 [DBG] Executing DbCommand [Parameters=[@p0='?' (DbType = Decimal), @p1='?', @p2='?' (DbType = Int32), @p3='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO transfers (amount, currency, from_account_id, to_account_id)
VALUES (@p0, @p1, @p2, @p3)
RETURNING id, created_at;
2022-09-23 15:28:15.339 +01:00 [INF] Executed DbCommand (5ms) [Parameters=[@p0='?' (DbType = Decimal), @p1='?', @p2='?' (DbType = Int32), @p3='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO transfers (amount, currency, from_account_id, to_account_id)
VALUES (@p0, @p1, @p2, @p3)
RETURNING id, created_at;
2022-09-23 15:28:15.342 +01:00 [DBG] The foreign key property 'Transfer.Id' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2022-09-23 15:28:15.344 +01:00 [DBG] A data reader was disposed.
2022-09-23 15:28:15.344 +01:00 [DBG] Releasing transaction savepoint.
2022-09-23 15:28:15.345 +01:00 [DBG] Released transaction savepoint.
2022-09-23 15:28:15.346 +01:00 [DBG] An entity of type 'Transfer' tracked by 'PostgresContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 15:28:15.347 +01:00 [DBG] SaveChanges completed for 'PostgresContext' with 1 entities written to the database.
2022-09-23 15:28:15.349 +01:00 [DBG] 'PostgresContext' generated a temporary value for the property 'Id.Transaction'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 15:28:15.351 +01:00 [DBG] Context 'PostgresContext' started tracking 'Transaction' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 15:28:15.354 +01:00 [DBG] 'PostgresContext' generated a temporary value for the property 'Id.Transaction'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 15:28:15.356 +01:00 [DBG] Context 'PostgresContext' started tracking 'Transaction' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 15:28:15.357 +01:00 [DBG] SaveChanges starting for 'PostgresContext'.
2022-09-23 15:28:15.358 +01:00 [DBG] DetectChanges starting for 'PostgresContext'.
2022-09-23 15:28:15.360 +01:00 [DBG] DetectChanges completed for 'PostgresContext'.
2022-09-23 15:28:15.361 +01:00 [DBG] Creating transaction savepoint.
2022-09-23 15:28:15.362 +01:00 [DBG] Created transaction savepoint.
2022-09-23 15:28:15.362 +01:00 [DBG] Executing 2 update commands as a batch.
2022-09-23 15:28:15.363 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 15:28:15.364 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2022-09-23 15:28:15.365 +01:00 [DBG] Executing DbCommand [Parameters=[@p0='?' (DbType = Int32), @p1='?' (DbType = Decimal), @p2='?' (DbType = Decimal), @p3='?' (DbType = DateTime), @p4='?' (DbType = Int32), @p5='?' (DbType = Decimal), @p6='?' (DbType = Decimal), @p7='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO transactions (account_id, amount, balance, created_at)
VALUES (@p0, @p1, @p2, @p3)
RETURNING id;
INSERT INTO transactions (account_id, amount, balance, created_at)
VALUES (@p4, @p5, @p6, @p7)
RETURNING id;
2022-09-23 15:28:15.372 +01:00 [INF] Executed DbCommand (6ms) [Parameters=[@p0='?' (DbType = Int32), @p1='?' (DbType = Decimal), @p2='?' (DbType = Decimal), @p3='?' (DbType = DateTime), @p4='?' (DbType = Int32), @p5='?' (DbType = Decimal), @p6='?' (DbType = Decimal), @p7='?' (DbType = DateTime)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO transactions (account_id, amount, balance, created_at)
VALUES (@p0, @p1, @p2, @p3)
RETURNING id;
INSERT INTO transactions (account_id, amount, balance, created_at)
VALUES (@p4, @p5, @p6, @p7)
RETURNING id;
2022-09-23 15:28:15.374 +01:00 [DBG] The foreign key property 'Transaction.Id' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2022-09-23 15:28:15.377 +01:00 [DBG] The foreign key property 'Transaction.Id' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2022-09-23 15:28:15.378 +01:00 [DBG] A data reader was disposed.
2022-09-23 15:28:15.378 +01:00 [DBG] Releasing transaction savepoint.
2022-09-23 15:28:15.379 +01:00 [DBG] Released transaction savepoint.
2022-09-23 15:28:15.380 +01:00 [DBG] An entity of type 'Transaction' tracked by 'PostgresContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 15:28:15.381 +01:00 [DBG] An entity of type 'Transaction' tracked by 'PostgresContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 15:28:15.387 +01:00 [DBG] SaveChanges completed for 'PostgresContext' with 2 entities written to the database.
2022-09-23 15:28:15.389 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 15:28:15.390 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2022-09-23 15:28:15.391 +01:00 [DBG] Executing DbCommand [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a.id, a.balance, a.created_at, a.currency, a.user_id
FROM accounts AS a
WHERE a.id = @__p_0
LIMIT 1
2022-09-23 15:28:15.394 +01:00 [INF] Executed DbCommand (3ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a.id, a.balance, a.created_at, a.currency, a.user_id
FROM accounts AS a
WHERE a.id = @__p_0
LIMIT 1
2022-09-23 15:28:15.396 +01:00 [DBG] Context 'PostgresContext' started tracking 'Account' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 15:28:15.397 +01:00 [DBG] A data reader was disposed.
2022-09-23 15:28:15.400 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 15:28:15.402 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2022-09-23 15:28:15.403 +01:00 [DBG] Executing DbCommand [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a.id, a.balance, a.created_at, a.currency, a.user_id
FROM accounts AS a
WHERE a.id = @__p_0
LIMIT 1
2022-09-23 15:28:15.406 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a.id, a.balance, a.created_at, a.currency, a.user_id
FROM accounts AS a
WHERE a.id = @__p_0
LIMIT 1
2022-09-23 15:28:15.409 +01:00 [DBG] Context 'PostgresContext' started tracking 'Account' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 15:28:15.410 +01:00 [DBG] A data reader was disposed.
2022-09-23 15:28:15.411 +01:00 [DBG] SaveChanges starting for 'PostgresContext'.
2022-09-23 15:28:15.411 +01:00 [DBG] DetectChanges starting for 'PostgresContext'.
2022-09-23 15:28:15.412 +01:00 [DBG] The unchanged property 'Account.Balance' was detected as changed and will be marked as modified. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2022-09-23 15:28:15.415 +01:00 [DBG] An entity of type 'Account' tracked by 'PostgresContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 15:28:15.417 +01:00 [DBG] The unchanged property 'Account.Balance' was detected as changed and will be marked as modified. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2022-09-23 15:28:15.419 +01:00 [DBG] An entity of type 'Account' tracked by 'PostgresContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 15:28:15.421 +01:00 [DBG] DetectChanges completed for 'PostgresContext'.
2022-09-23 15:28:15.422 +01:00 [DBG] Creating transaction savepoint.
2022-09-23 15:28:15.423 +01:00 [DBG] Created transaction savepoint.
2022-09-23 15:28:15.424 +01:00 [DBG] Executing 2 update commands as a batch.
2022-09-23 15:28:15.425 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 15:28:15.427 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2022-09-23 15:28:15.427 +01:00 [DBG] Executing DbCommand [Parameters=[@p1='?' (DbType = Int32), @p0='?' (DbType = Decimal), @p3='?' (DbType = Int32), @p2='?' (DbType = Decimal)], CommandType='"Text"', CommandTimeout='30']
UPDATE accounts SET balance = @p0
WHERE id = @p1;
UPDATE accounts SET balance = @p2
WHERE id = @p3;
2022-09-23 15:28:15.433 +01:00 [INF] Executed DbCommand (5ms) [Parameters=[@p1='?' (DbType = Int32), @p0='?' (DbType = Decimal), @p3='?' (DbType = Int32), @p2='?' (DbType = Decimal)], CommandType='"Text"', CommandTimeout='30']
UPDATE accounts SET balance = @p0
WHERE id = @p1;
UPDATE accounts SET balance = @p2
WHERE id = @p3;
2022-09-23 15:28:15.437 +01:00 [DBG] A data reader was disposed.
2022-09-23 15:28:15.438 +01:00 [DBG] Releasing transaction savepoint.
2022-09-23 15:28:15.439 +01:00 [DBG] Released transaction savepoint.
2022-09-23 15:28:15.440 +01:00 [DBG] An entity of type 'Account' tracked by 'PostgresContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 15:28:15.441 +01:00 [DBG] An entity of type 'Account' tracked by 'PostgresContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 15:28:15.443 +01:00 [DBG] SaveChanges completed for 'PostgresContext' with 2 entities written to the database.
2022-09-23 15:28:15.445 +01:00 [DBG] Committing transaction.
2022-09-23 15:28:15.448 +01:00 [DBG] Committed transaction.
2022-09-23 15:28:15.449 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:28:15.451 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 15:28:15.452 +01:00 [DBG] Disposing transaction.
2022-09-23 15:28:15.453 +01:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2022-09-23 15:28:15.455 +01:00 [DBG] Attempting to select an output formatter based on Accept header '["text/plain"]'.
2022-09-23 15:28:15.456 +01:00 [DBG] Could not find an output formatter based on content negotiation. Accepted types were (["text/plain"])
2022-09-23 15:28:15.457 +01:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2022-09-23 15:28:15.459 +01:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2022-09-23 15:28:15.459 +01:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2022-09-23 15:28:15.462 +01:00 [INF] Executing CreatedResult, writing value of type '<>f__AnonymousType0`1[[System.String, System.Private.CoreLib, Version=6.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2022-09-23 15:28:15.463 +01:00 [INF] Executed action APIBank.Controllers.TransfersController.Create (APIBank) in 218.4195ms
2022-09-23 15:28:15.464 +01:00 [INF] Executed endpoint 'APIBank.Controllers.TransfersController.Create (APIBank)'
2022-09-23 15:28:15.467 +01:00 [DBG] 'PostgresContext' disposed.
2022-09-23 15:28:15.469 +01:00 [INF] Request finished HTTP/2 POST https://localhost:7036/api/Transfers/TransferRequest application/json 76 - 201 - application/json;+charset=utf-8 284.0233ms
2022-09-23 15:28:19.901 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/api/Accounts/GetAll - -
2022-09-23 15:28:19.903 +01:00 [DBG] 1 candidate(s) found for the request path '/api/Accounts/GetAll'
2022-09-23 15:28:19.906 +01:00 [DBG] Endpoint 'APIBank.Controllers.AccountsController.GetAllFromUser (APIBank)' with route pattern 'api/Accounts/GetAll' is valid for the request path '/api/Accounts/GetAll'
2022-09-23 15:28:19.909 +01:00 [DBG] Request matched endpoint 'APIBank.Controllers.AccountsController.GetAllFromUser (APIBank)'
2022-09-23 15:28:19.911 +01:00 [DBG] Static files was skipped as the request already matched an endpoint.
2022-09-23 15:28:19.914 +01:00 [INF] Entity Framework Core 6.0.9 initialized 'PostgresContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:6.0.7+5b98e4b74de93b590b44aef8dd7967c03acc433c' with options: None
2022-09-23 15:28:19.921 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 15:28:19.924 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (2ms).
2022-09-23 15:28:19.925 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 15:28:19.926 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:28:19.928 +01:00 [DBG] Executing DbCommand [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.id = @__p_0
LIMIT 1
2022-09-23 15:28:19.932 +01:00 [INF] Executed DbCommand (4ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.id = @__p_0
LIMIT 1
2022-09-23 15:28:19.935 +01:00 [DBG] Context 'PostgresContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 15:28:19.936 +01:00 [DBG] A data reader was disposed.
2022-09-23 15:28:19.936 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:28:19.938 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 15:28:19.940 +01:00 [INF] Executing endpoint 'APIBank.Controllers.AccountsController.GetAllFromUser (APIBank)'
2022-09-23 15:28:19.941 +01:00 [INF] Route matched with {action = "GetAllFromUser", controller = "Accounts"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult GetAllFromUser() on controller APIBank.Controllers.AccountsController (APIBank).
2022-09-23 15:28:19.942 +01:00 [DBG] Execution plan of authorization filters (in the following order): ["APIBank.Authorization.AuthorizeAttribute"]
2022-09-23 15:28:19.944 +01:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2022-09-23 15:28:19.946 +01:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2022-09-23 15:28:19.948 +01:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2022-09-23 15:28:19.949 +01:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2022-09-23 15:28:19.951 +01:00 [DBG] Executing controller factory for controller APIBank.Controllers.AccountsController (APIBank)
2022-09-23 15:28:19.951 +01:00 [DBG] Executed controller factory for controller APIBank.Controllers.AccountsController (APIBank)
2022-09-23 15:28:19.953 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 15:28:19.955 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2022-09-23 15:28:19.956 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 15:28:19.957 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:28:19.958 +01:00 [DBG] Executing DbCommand [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id, r.created, r.created_by_ip, r.expires, r.is_active, r.is_expired, r.is_revoked, r.reason_revoked, r.token, r.replaced_by_token, r.revoked, r.revoked_by_ip, r.user_id
FROM refresh_token AS r
WHERE r.id = @__p_0
LIMIT 1
2022-09-23 15:28:19.960 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id, r.created, r.created_by_ip, r.expires, r.is_active, r.is_expired, r.is_revoked, r.reason_revoked, r.token, r.replaced_by_token, r.revoked, r.revoked_by_ip, r.user_id
FROM refresh_token AS r
WHERE r.id = @__p_0
LIMIT 1
2022-09-23 15:28:19.962 +01:00 [DBG] Context 'PostgresContext' started tracking 'RefreshToken' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 15:28:19.964 +01:00 [DBG] A data reader was disposed.
2022-09-23 15:28:19.965 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:28:19.966 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 15:28:19.967 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 15:28:19.970 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (2ms).
2022-09-23 15:28:19.971 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 15:28:19.972 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:28:19.973 +01:00 [DBG] Executing DbCommand [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a.balance AS "Balance", a.created_at AS "CreatedAt", a.currency AS "Currency", a.id AS "Id"
FROM accounts AS a
WHERE a.user_id = @__userId_0
2022-09-23 15:28:19.975 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a.balance AS "Balance", a.created_at AS "CreatedAt", a.currency AS "Currency", a.id AS "Id"
FROM accounts AS a
WHERE a.user_id = @__userId_0
2022-09-23 15:28:19.977 +01:00 [DBG] A data reader was disposed.
2022-09-23 15:28:19.977 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:28:19.979 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 15:28:19.980 +01:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2022-09-23 15:28:19.982 +01:00 [DBG] Attempting to select an output formatter based on Accept header '["text/plain"]'.
2022-09-23 15:28:19.984 +01:00 [DBG] Could not find an output formatter based on content negotiation. Accepted types were (["text/plain"])
2022-09-23 15:28:19.985 +01:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2022-09-23 15:28:19.986 +01:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2022-09-23 15:28:19.986 +01:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2022-09-23 15:28:19.987 +01:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[APIBank.Models.Responses.AccountRequestResponse, APIBank, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2022-09-23 15:28:19.988 +01:00 [INF] Executed action APIBank.Controllers.AccountsController.GetAllFromUser (APIBank) in 37.9393ms
2022-09-23 15:28:19.989 +01:00 [INF] Executed endpoint 'APIBank.Controllers.AccountsController.GetAllFromUser (APIBank)'
2022-09-23 15:28:19.990 +01:00 [DBG] 'PostgresContext' disposed.
2022-09-23 15:28:19.991 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/api/Accounts/GetAll - - - 200 - application/json;+charset=utf-8 89.9439ms
2022-09-23 15:28:29.956 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/api/Users/1/refresh-tokens - -
2022-09-23 15:28:29.958 +01:00 [DBG] 1 candidate(s) found for the request path '/api/Users/1/refresh-tokens'
2022-09-23 15:28:29.961 +01:00 [DBG] Endpoint 'APIBank.Controllers.UsersController.GetRefreshTokens (APIBank)' with route pattern 'api/Users/{id}/refresh-tokens' is valid for the request path '/api/Users/1/refresh-tokens'
2022-09-23 15:28:29.963 +01:00 [DBG] Request matched endpoint 'APIBank.Controllers.UsersController.GetRefreshTokens (APIBank)'
2022-09-23 15:28:29.964 +01:00 [DBG] Static files was skipped as the request already matched an endpoint.
2022-09-23 15:28:29.967 +01:00 [INF] Entity Framework Core 6.0.9 initialized 'PostgresContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:6.0.7+5b98e4b74de93b590b44aef8dd7967c03acc433c' with options: None
2022-09-23 15:28:29.970 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 15:28:29.973 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (2ms).
2022-09-23 15:28:29.974 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 15:28:29.975 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:28:29.975 +01:00 [DBG] Executing DbCommand [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.id = @__p_0
LIMIT 1
2022-09-23 15:28:29.977 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.id = @__p_0
LIMIT 1
2022-09-23 15:28:29.979 +01:00 [DBG] Context 'PostgresContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 15:28:29.980 +01:00 [DBG] A data reader was disposed.
2022-09-23 15:28:29.980 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:28:29.984 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 15:28:29.984 +01:00 [INF] Executing endpoint 'APIBank.Controllers.UsersController.GetRefreshTokens (APIBank)'
2022-09-23 15:28:29.988 +01:00 [INF] Route matched with {action = "GetRefreshTokens", controller = "Users"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult GetRefreshTokens(Int32) on controller APIBank.Controllers.UsersController (APIBank).
2022-09-23 15:28:29.990 +01:00 [DBG] Execution plan of authorization filters (in the following order): ["APIBank.Authorization.AuthorizeAttribute"]
2022-09-23 15:28:29.991 +01:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2022-09-23 15:28:29.992 +01:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2022-09-23 15:28:29.993 +01:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2022-09-23 15:28:29.994 +01:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2022-09-23 15:28:29.995 +01:00 [DBG] Executing controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-23 15:28:29.996 +01:00 [DBG] Executed controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-23 15:28:29.998 +01:00 [DBG] Attempting to bind parameter 'id' of type 'System.Int32' ...
2022-09-23 15:28:29.999 +01:00 [DBG] Attempting to bind parameter 'id' of type 'System.Int32' using the name 'id' in request data ...
2022-09-23 15:28:30.000 +01:00 [DBG] Done attempting to bind parameter 'id' of type 'System.Int32'.
2022-09-23 15:28:30.001 +01:00 [DBG] Done attempting to bind parameter 'id' of type 'System.Int32'.
2022-09-23 15:28:30.002 +01:00 [DBG] Attempting to validate the bound parameter 'id' of type 'System.Int32' ...
2022-09-23 15:28:30.003 +01:00 [DBG] Done attempting to validate the bound parameter 'id' of type 'System.Int32'.
2022-09-23 15:28:30.007 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 15:28:30.008 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2022-09-23 15:28:30.009 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 15:28:30.009 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:28:30.011 +01:00 [DBG] Executing DbCommand [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id, r.created, r.created_by_ip, r.expires, r.is_active, r.is_expired, r.is_revoked, r.reason_revoked, r.token, r.replaced_by_token, r.revoked, r.revoked_by_ip, r.user_id
FROM refresh_token AS r
WHERE r.id = @__p_0
LIMIT 1
2022-09-23 15:28:30.016 +01:00 [INF] Executed DbCommand (5ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id, r.created, r.created_by_ip, r.expires, r.is_active, r.is_expired, r.is_revoked, r.reason_revoked, r.token, r.replaced_by_token, r.revoked, r.revoked_by_ip, r.user_id
FROM refresh_token AS r
WHERE r.id = @__p_0
LIMIT 1
2022-09-23 15:28:30.019 +01:00 [DBG] Context 'PostgresContext' started tracking 'RefreshToken' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 15:28:30.021 +01:00 [DBG] A data reader was disposed.
2022-09-23 15:28:30.022 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:28:30.023 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 15:28:30.025 +01:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2022-09-23 15:28:30.029 +01:00 [DBG] No information found on request to perform content negotiation.
2022-09-23 15:28:30.030 +01:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2022-09-23 15:28:30.031 +01:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2022-09-23 15:28:30.032 +01:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2022-09-23 15:28:30.034 +01:00 [INF] Executing OkObjectResult, writing value of type 'Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryable`1[[APIBank.ModelEntities.RefreshToken, APIBank, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2022-09-23 15:28:30.042 +01:00 [DBG] Compiling query expression: 
'DbSet<RefreshToken>()
    .Where(rt => rt.UserId == __id_0)
    .AsNoTracking()
    .Select(rt => new RefreshToken{ 
        Id = rt.Id, 
        UserId = rt.UserId, 
        RefToken = rt.RefToken, 
        Expires = rt.Expires, 
        Created = rt.Created, 
        CreatedByIp = rt.CreatedByIp, 
        Revoked = rt.Revoked, 
        RevokedByIp = rt.RevokedByIp, 
        ReplacedByToken = rt.ReplacedByToken, 
        ReasonRevoked = rt.ReasonRevoked, 
        IsExpired = rt.IsExpired, 
        IsRevoked = rt.IsRevoked, 
        IsActive = rt.IsActive 
    }
    )'
2022-09-23 15:28:30.048 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<RefreshToken>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            Id -> 0
            UserId -> 1
            RefToken -> 2
            Expires -> 3
            Created -> 4
            CreatedByIp -> 5
            Revoked -> 6
            RevokedByIp -> 7
            ReplacedByToken -> 8
            ReasonRevoked -> 9
            IsExpired -> 10
            IsRevoked -> 11
            IsActive -> 12
        SELECT r.id AS Id, r.user_id AS UserId, r.token AS RefToken, r.expires AS Expires, r.created AS Created, r.created_by_ip AS CreatedByIp, r.revoked AS Revoked, r.revoked_by_ip AS RevokedByIp, r.replaced_by_token AS ReplacedByToken, r.reason_revoked AS ReasonRevoked, r.is_expired AS IsExpired, r.is_revoked AS IsRevoked, r.is_active AS IsActive
        FROM refresh_token AS r
        WHERE r.user_id == @__id_0), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, RefreshToken>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)'
2022-09-23 15:28:30.072 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 15:28:30.073 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2022-09-23 15:28:30.086 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 15:28:30.088 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:28:30.095 +01:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.user_id AS "UserId", r.token AS "RefToken", r.expires AS "Expires", r.created AS "Created", r.created_by_ip AS "CreatedByIp", r.revoked AS "Revoked", r.revoked_by_ip AS "RevokedByIp", r.replaced_by_token AS "ReplacedByToken", r.reason_revoked AS "ReasonRevoked", r.is_expired AS "IsExpired", r.is_revoked AS "IsRevoked", r.is_active AS "IsActive"
FROM refresh_token AS r
WHERE r.user_id = @__id_0
2022-09-23 15:28:30.100 +01:00 [INF] Executed DbCommand (6ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.user_id AS "UserId", r.token AS "RefToken", r.expires AS "Expires", r.created AS "Created", r.created_by_ip AS "CreatedByIp", r.revoked AS "Revoked", r.revoked_by_ip AS "RevokedByIp", r.replaced_by_token AS "ReplacedByToken", r.reason_revoked AS "ReasonRevoked", r.is_expired AS "IsExpired", r.is_revoked AS "IsRevoked", r.is_active AS "IsActive"
FROM refresh_token AS r
WHERE r.user_id = @__id_0
2022-09-23 15:28:30.118 +01:00 [DBG] A data reader was disposed.
2022-09-23 15:28:30.132 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:28:30.134 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 15:28:30.137 +01:00 [INF] Executed action APIBank.Controllers.UsersController.GetRefreshTokens (APIBank) in 141.7824ms
2022-09-23 15:28:30.139 +01:00 [INF] Executed endpoint 'APIBank.Controllers.UsersController.GetRefreshTokens (APIBank)'
2022-09-23 15:28:30.142 +01:00 [DBG] 'PostgresContext' disposed.
2022-09-23 15:28:30.144 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/api/Users/1/refresh-tokens - - - 200 - application/json;+charset=utf-8 187.9423ms
2022-09-23 15:28:51.331 +01:00 [INF] Request starting HTTP/2 POST https://localhost:7036/api/Users/Logout - 0
2022-09-23 15:28:51.342 +01:00 [DBG] 1 candidate(s) found for the request path '/api/Users/Logout'
2022-09-23 15:28:51.344 +01:00 [DBG] Endpoint 'APIBank.Controllers.UsersController.Logout (APIBank)' with route pattern 'api/Users/Logout' is valid for the request path '/api/Users/Logout'
2022-09-23 15:28:51.346 +01:00 [DBG] Request matched endpoint 'APIBank.Controllers.UsersController.Logout (APIBank)'
2022-09-23 15:28:51.346 +01:00 [DBG] Static files was skipped as the request already matched an endpoint.
2022-09-23 15:28:51.348 +01:00 [INF] Entity Framework Core 6.0.9 initialized 'PostgresContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:6.0.7+5b98e4b74de93b590b44aef8dd7967c03acc433c' with options: None
2022-09-23 15:28:51.352 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 15:28:51.355 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (2ms).
2022-09-23 15:28:51.355 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 15:28:51.356 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:28:51.357 +01:00 [DBG] Executing DbCommand [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.id = @__p_0
LIMIT 1
2022-09-23 15:28:51.359 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.id = @__p_0
LIMIT 1
2022-09-23 15:28:51.361 +01:00 [DBG] Context 'PostgresContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 15:28:51.361 +01:00 [DBG] A data reader was disposed.
2022-09-23 15:28:51.362 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:28:51.363 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 15:28:51.363 +01:00 [INF] Executing endpoint 'APIBank.Controllers.UsersController.Logout (APIBank)'
2022-09-23 15:28:51.365 +01:00 [INF] Route matched with {action = "Logout", controller = "Users"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult Logout() on controller APIBank.Controllers.UsersController (APIBank).
2022-09-23 15:28:51.368 +01:00 [DBG] Execution plan of authorization filters (in the following order): ["APIBank.Authorization.AuthorizeAttribute"]
2022-09-23 15:28:51.371 +01:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2022-09-23 15:28:51.372 +01:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2022-09-23 15:28:51.374 +01:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2022-09-23 15:28:51.374 +01:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2022-09-23 15:28:51.375 +01:00 [DBG] Executing controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-23 15:28:51.376 +01:00 [DBG] Executed controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-23 15:28:51.378 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 15:28:51.379 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2022-09-23 15:28:51.380 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 15:28:51.381 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:28:51.381 +01:00 [DBG] Executing DbCommand [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id, r.created, r.created_by_ip, r.expires, r.is_active, r.is_expired, r.is_revoked, r.reason_revoked, r.token, r.replaced_by_token, r.revoked, r.revoked_by_ip, r.user_id
FROM refresh_token AS r
WHERE r.id = @__p_0
LIMIT 1
2022-09-23 15:28:51.385 +01:00 [INF] Executed DbCommand (4ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id, r.created, r.created_by_ip, r.expires, r.is_active, r.is_expired, r.is_revoked, r.reason_revoked, r.token, r.replaced_by_token, r.revoked, r.revoked_by_ip, r.user_id
FROM refresh_token AS r
WHERE r.id = @__p_0
LIMIT 1
2022-09-23 15:28:51.388 +01:00 [DBG] Context 'PostgresContext' started tracking 'RefreshToken' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 15:28:51.389 +01:00 [DBG] A data reader was disposed.
2022-09-23 15:28:51.390 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:28:51.390 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 15:28:51.392 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 15:28:51.393 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2022-09-23 15:28:51.393 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 15:28:51.394 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:28:51.396 +01:00 [DBG] Executing DbCommand [Parameters=[@__refToken_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE EXISTS (
    SELECT 1
    FROM refresh_token AS r
    WHERE (u.id = r.user_id) AND (r.token = @__refToken_0))
LIMIT 2
2022-09-23 15:28:51.398 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[@__refToken_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE EXISTS (
    SELECT 1
    FROM refresh_token AS r
    WHERE (u.id = r.user_id) AND (r.token = @__refToken_0))
LIMIT 2
2022-09-23 15:28:51.404 +01:00 [DBG] A data reader was disposed.
2022-09-23 15:28:51.405 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:28:51.407 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 15:28:51.408 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 15:28:51.409 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2022-09-23 15:28:51.411 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 15:28:51.413 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:28:51.418 +01:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.user_id AS "UserId", r.token AS "RefToken", r.expires AS "Expires", r.created AS "Created", r.created_by_ip AS "CreatedByIp", r.revoked AS "Revoked", r.revoked_by_ip AS "RevokedByIp", r.replaced_by_token AS "ReplacedByToken", r.reason_revoked AS "ReasonRevoked", r.is_expired AS "IsExpired", r.is_revoked AS "IsRevoked", r.is_active AS "IsActive"
FROM refresh_token AS r
WHERE r.user_id = @__id_0
2022-09-23 15:28:51.422 +01:00 [INF] Executed DbCommand (4ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.user_id AS "UserId", r.token AS "RefToken", r.expires AS "Expires", r.created AS "Created", r.created_by_ip AS "CreatedByIp", r.revoked AS "Revoked", r.revoked_by_ip AS "RevokedByIp", r.replaced_by_token AS "ReplacedByToken", r.reason_revoked AS "ReasonRevoked", r.is_expired AS "IsExpired", r.is_revoked AS "IsRevoked", r.is_active AS "IsActive"
FROM refresh_token AS r
WHERE r.user_id = @__id_0
2022-09-23 15:28:51.427 +01:00 [DBG] A data reader was disposed.
2022-09-23 15:28:51.428 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:28:51.429 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 15:28:51.437 +01:00 [DBG] SaveChanges starting for 'PostgresContext'.
2022-09-23 15:28:51.438 +01:00 [DBG] DetectChanges starting for 'PostgresContext'.
2022-09-23 15:28:51.439 +01:00 [DBG] The unchanged property 'RefreshToken.IsActive' was detected as changed and will be marked as modified. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2022-09-23 15:28:51.440 +01:00 [DBG] An entity of type 'RefreshToken' tracked by 'PostgresContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 15:28:51.441 +01:00 [DBG] The unchanged property 'RefreshToken.IsRevoked' was detected as changed and will be marked as modified. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2022-09-23 15:28:51.442 +01:00 [DBG] The unchanged property 'RefreshToken.ReasonRevoked' was detected as changed and will be marked as modified. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2022-09-23 15:28:51.443 +01:00 [DBG] The unchanged property 'RefreshToken.Revoked' was detected as changed and will be marked as modified. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2022-09-23 15:28:51.444 +01:00 [DBG] The unchanged property 'RefreshToken.RevokedByIp' was detected as changed and will be marked as modified. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2022-09-23 15:28:51.447 +01:00 [DBG] DetectChanges completed for 'PostgresContext'.
2022-09-23 15:28:51.447 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 15:28:51.448 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:28:51.451 +01:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2022-09-23 15:28:51.452 +01:00 [DBG] Began transaction with isolation level 'ReadCommitted'.
2022-09-23 15:28:51.453 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 15:28:51.454 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2022-09-23 15:28:51.455 +01:00 [DBG] Executing DbCommand [Parameters=[@p5='?' (DbType = Int32), @p0='?' (DbType = Boolean), @p1='?' (DbType = Boolean), @p2='?', @p3='?' (DbType = DateTime), @p4='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE refresh_token SET is_active = @p0, is_revoked = @p1, reason_revoked = @p2, revoked = @p3, revoked_by_ip = @p4
WHERE id = @p5;
2022-09-23 15:28:51.458 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[@p5='?' (DbType = Int32), @p0='?' (DbType = Boolean), @p1='?' (DbType = Boolean), @p2='?', @p3='?' (DbType = DateTime), @p4='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE refresh_token SET is_active = @p0, is_revoked = @p1, reason_revoked = @p2, revoked = @p3, revoked_by_ip = @p4
WHERE id = @p5;
2022-09-23 15:28:51.460 +01:00 [DBG] A data reader was disposed.
2022-09-23 15:28:51.460 +01:00 [DBG] Committing transaction.
2022-09-23 15:28:51.461 +01:00 [DBG] Committed transaction.
2022-09-23 15:28:51.463 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:28:51.464 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 15:28:51.464 +01:00 [DBG] Disposing transaction.
2022-09-23 15:28:51.465 +01:00 [DBG] An entity of type 'RefreshToken' tracked by 'PostgresContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 15:28:51.468 +01:00 [DBG] SaveChanges completed for 'PostgresContext' with 1 entities written to the database.
2022-09-23 15:28:51.469 +01:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2022-09-23 15:28:51.472 +01:00 [DBG] No information found on request to perform content negotiation.
2022-09-23 15:28:51.472 +01:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2022-09-23 15:28:51.473 +01:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2022-09-23 15:28:51.474 +01:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2022-09-23 15:28:51.475 +01:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType0`1[[System.String, System.Private.CoreLib, Version=6.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2022-09-23 15:28:51.476 +01:00 [INF] Executed action APIBank.Controllers.UsersController.Logout (APIBank) in 100.5674ms
2022-09-23 15:28:51.478 +01:00 [INF] Executed endpoint 'APIBank.Controllers.UsersController.Logout (APIBank)'
2022-09-23 15:28:51.479 +01:00 [DBG] 'PostgresContext' disposed.
2022-09-23 15:28:51.486 +01:00 [INF] Request finished HTTP/2 POST https://localhost:7036/api/Users/Logout - 0 - 200 - application/json;+charset=utf-8 154.9799ms
2022-09-23 15:29:23.600 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/api/Users/1/refresh-tokens - -
2022-09-23 15:29:23.608 +01:00 [DBG] 1 candidate(s) found for the request path '/api/Users/1/refresh-tokens'
2022-09-23 15:29:23.609 +01:00 [DBG] Endpoint 'APIBank.Controllers.UsersController.GetRefreshTokens (APIBank)' with route pattern 'api/Users/{id}/refresh-tokens' is valid for the request path '/api/Users/1/refresh-tokens'
2022-09-23 15:29:23.610 +01:00 [DBG] Request matched endpoint 'APIBank.Controllers.UsersController.GetRefreshTokens (APIBank)'
2022-09-23 15:29:23.611 +01:00 [DBG] Static files was skipped as the request already matched an endpoint.
2022-09-23 15:29:23.634 +01:00 [INF] Executing endpoint 'APIBank.Controllers.UsersController.GetRefreshTokens (APIBank)'
2022-09-23 15:29:23.635 +01:00 [INF] Route matched with {action = "GetRefreshTokens", controller = "Users"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult GetRefreshTokens(Int32) on controller APIBank.Controllers.UsersController (APIBank).
2022-09-23 15:29:23.637 +01:00 [DBG] Execution plan of authorization filters (in the following order): ["APIBank.Authorization.AuthorizeAttribute"]
2022-09-23 15:29:23.639 +01:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2022-09-23 15:29:23.641 +01:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2022-09-23 15:29:23.643 +01:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2022-09-23 15:29:23.644 +01:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2022-09-23 15:29:23.646 +01:00 [INF] Authorization failed for the request at filter 'APIBank.Authorization.AuthorizeAttribute'.
2022-09-23 15:29:23.647 +01:00 [INF] Executing JsonResult, writing value of type '<>f__AnonymousType0`1[[System.String, System.Private.CoreLib, Version=6.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2022-09-23 15:29:23.648 +01:00 [INF] Executed action APIBank.Controllers.UsersController.GetRefreshTokens (APIBank) in 2.2783ms
2022-09-23 15:29:23.657 +01:00 [INF] Executed endpoint 'APIBank.Controllers.UsersController.GetRefreshTokens (APIBank)'
2022-09-23 15:29:23.659 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/api/Users/1/refresh-tokens - - - 401 - application/json;+charset=utf-8 61.8128ms
2022-09-23 15:29:33.165 +01:00 [INF] Request starting HTTP/2 POST https://localhost:7036/api/Users/refreshToken - 0
2022-09-23 15:29:33.169 +01:00 [DBG] 1 candidate(s) found for the request path '/api/Users/refreshToken'
2022-09-23 15:29:33.172 +01:00 [DBG] Endpoint 'APIBank.Controllers.UsersController.RefreshToken (APIBank)' with route pattern 'api/Users/refreshToken' is valid for the request path '/api/Users/refreshToken'
2022-09-23 15:29:33.175 +01:00 [DBG] Request matched endpoint 'APIBank.Controllers.UsersController.RefreshToken (APIBank)'
2022-09-23 15:29:33.177 +01:00 [DBG] Static files was skipped as the request already matched an endpoint.
2022-09-23 15:29:33.210 +01:00 [INF] Executing endpoint 'APIBank.Controllers.UsersController.RefreshToken (APIBank)'
2022-09-23 15:29:33.214 +01:00 [INF] Route matched with {action = "RefreshToken", controller = "Users"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult RefreshToken() on controller APIBank.Controllers.UsersController (APIBank).
2022-09-23 15:29:33.219 +01:00 [DBG] Execution plan of authorization filters (in the following order): ["APIBank.Authorization.AuthorizeAttribute"]
2022-09-23 15:29:33.221 +01:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2022-09-23 15:29:33.222 +01:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2022-09-23 15:29:33.223 +01:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2022-09-23 15:29:33.224 +01:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2022-09-23 15:29:33.225 +01:00 [DBG] Executing controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-23 15:29:33.226 +01:00 [DBG] Executed controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-23 15:29:33.229 +01:00 [INF] Entity Framework Core 6.0.9 initialized 'PostgresContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:6.0.7+5b98e4b74de93b590b44aef8dd7967c03acc433c' with options: None
2022-09-23 15:29:33.234 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 15:29:33.235 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2022-09-23 15:29:33.236 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 15:29:33.237 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:29:33.238 +01:00 [DBG] Executing DbCommand [Parameters=[@__refToken_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE EXISTS (
    SELECT 1
    FROM refresh_token AS r
    WHERE (u.id = r.user_id) AND (r.token = @__refToken_0))
LIMIT 2
2022-09-23 15:29:33.240 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[@__refToken_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE EXISTS (
    SELECT 1
    FROM refresh_token AS r
    WHERE (u.id = r.user_id) AND (r.token = @__refToken_0))
LIMIT 2
2022-09-23 15:29:33.242 +01:00 [DBG] Context 'PostgresContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 15:29:33.243 +01:00 [DBG] A data reader was disposed.
2022-09-23 15:29:33.244 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:29:33.247 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 15:29:33.251 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 15:29:33.252 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2022-09-23 15:29:33.253 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 15:29:33.254 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:29:33.255 +01:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.user_id AS "UserId", r.token AS "RefToken", r.expires AS "Expires", r.created AS "Created", r.created_by_ip AS "CreatedByIp", r.revoked AS "Revoked", r.revoked_by_ip AS "RevokedByIp", r.replaced_by_token AS "ReplacedByToken", r.reason_revoked AS "ReasonRevoked", r.is_expired AS "IsExpired", r.is_revoked AS "IsRevoked", r.is_active AS "IsActive"
FROM refresh_token AS r
WHERE r.user_id = @__id_0
2022-09-23 15:29:33.257 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.user_id AS "UserId", r.token AS "RefToken", r.expires AS "Expires", r.created AS "Created", r.created_by_ip AS "CreatedByIp", r.revoked AS "Revoked", r.revoked_by_ip AS "RevokedByIp", r.replaced_by_token AS "ReplacedByToken", r.reason_revoked AS "ReasonRevoked", r.is_expired AS "IsExpired", r.is_revoked AS "IsRevoked", r.is_active AS "IsActive"
FROM refresh_token AS r
WHERE r.user_id = @__id_0
2022-09-23 15:29:33.259 +01:00 [DBG] A data reader was disposed.
2022-09-23 15:29:33.259 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:29:33.260 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 15:29:33.263 +01:00 [DBG] An entity of type 'User' tracked by 'PostgresContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 15:29:33.267 +01:00 [DBG] Context 'PostgresContext' started tracking 'RefreshToken' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 15:29:33.268 +01:00 [DBG] SaveChanges starting for 'PostgresContext'.
2022-09-23 15:29:33.269 +01:00 [DBG] DetectChanges starting for 'PostgresContext'.
2022-09-23 15:29:33.269 +01:00 [DBG] DetectChanges completed for 'PostgresContext'.
2022-09-23 15:29:33.270 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 15:29:33.271 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:29:33.272 +01:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2022-09-23 15:29:33.273 +01:00 [DBG] Began transaction with isolation level 'ReadCommitted'.
2022-09-23 15:29:33.274 +01:00 [DBG] Executing 2 update commands as a batch.
2022-09-23 15:29:33.275 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 15:29:33.276 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2022-09-23 15:29:33.277 +01:00 [DBG] Executing DbCommand [Parameters=[@p12='?' (DbType = Int32), @p0='?' (DbType = DateTime), @p1='?', @p2='?' (DbType = DateTime), @p3='?' (DbType = Boolean), @p4='?' (DbType = Boolean), @p5='?' (DbType = Boolean), @p6='?', @p7='?', @p8='?', @p9='?' (DbType = DateTime), @p10='?', @p11='?' (DbType = Int32), @p19='?' (DbType = Int32), @p13='?' (DbType = DateTime), @p14='?', @p15='?', @p16='?' (DbType = DateTime), @p17='?', @p18='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE refresh_token SET created = @p0, created_by_ip = @p1, expires = @p2, is_active = @p3, is_expired = @p4, is_revoked = @p5, reason_revoked = @p6, token = @p7, replaced_by_token = @p8, revoked = @p9, revoked_by_ip = @p10, user_id = @p11
WHERE id = @p12;
UPDATE users SET created_at = @p13, email = @p14, full_name = @p15, password_changed_at = @p16, password_hash = @p17, username = @p18
WHERE id = @p19;
2022-09-23 15:29:33.283 +01:00 [INF] Executed DbCommand (6ms) [Parameters=[@p12='?' (DbType = Int32), @p0='?' (DbType = DateTime), @p1='?', @p2='?' (DbType = DateTime), @p3='?' (DbType = Boolean), @p4='?' (DbType = Boolean), @p5='?' (DbType = Boolean), @p6='?', @p7='?', @p8='?', @p9='?' (DbType = DateTime), @p10='?', @p11='?' (DbType = Int32), @p19='?' (DbType = Int32), @p13='?' (DbType = DateTime), @p14='?', @p15='?', @p16='?' (DbType = DateTime), @p17='?', @p18='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE refresh_token SET created = @p0, created_by_ip = @p1, expires = @p2, is_active = @p3, is_expired = @p4, is_revoked = @p5, reason_revoked = @p6, token = @p7, replaced_by_token = @p8, revoked = @p9, revoked_by_ip = @p10, user_id = @p11
WHERE id = @p12;
UPDATE users SET created_at = @p13, email = @p14, full_name = @p15, password_changed_at = @p16, password_hash = @p17, username = @p18
WHERE id = @p19;
2022-09-23 15:29:33.285 +01:00 [DBG] A data reader was disposed.
2022-09-23 15:29:33.286 +01:00 [DBG] Committing transaction.
2022-09-23 15:29:33.287 +01:00 [DBG] Committed transaction.
2022-09-23 15:29:33.288 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:29:33.289 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 15:29:33.290 +01:00 [DBG] Disposing transaction.
2022-09-23 15:29:33.290 +01:00 [DBG] An entity of type 'User' tracked by 'PostgresContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 15:29:33.292 +01:00 [DBG] An entity of type 'RefreshToken' tracked by 'PostgresContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 15:29:33.293 +01:00 [DBG] SaveChanges completed for 'PostgresContext' with 2 entities written to the database.
2022-09-23 15:29:43.049 +01:00 [INF] Executed action APIBank.Controllers.UsersController.RefreshToken (APIBank) in 9823.7608ms
2022-09-23 15:29:43.053 +01:00 [INF] Executed endpoint 'APIBank.Controllers.UsersController.RefreshToken (APIBank)'
2022-09-23 15:29:43.099 +01:00 [INF] Global Error was found:
2022-09-23 15:29:43.102 +01:00 [DBG] 'PostgresContext' disposed.
2022-09-23 15:29:43.103 +01:00 [INF] Request finished HTTP/2 POST https://localhost:7036/api/Users/refreshToken - 0 - 400 - application/json 9937.9079ms
2022-09-23 15:29:48.352 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/api/Accounts/GetAll - -
2022-09-23 15:29:48.356 +01:00 [DBG] 1 candidate(s) found for the request path '/api/Accounts/GetAll'
2022-09-23 15:29:48.357 +01:00 [DBG] Endpoint 'APIBank.Controllers.AccountsController.GetAllFromUser (APIBank)' with route pattern 'api/Accounts/GetAll' is valid for the request path '/api/Accounts/GetAll'
2022-09-23 15:29:48.358 +01:00 [DBG] Request matched endpoint 'APIBank.Controllers.AccountsController.GetAllFromUser (APIBank)'
2022-09-23 15:29:48.361 +01:00 [DBG] Static files was skipped as the request already matched an endpoint.
2022-09-23 15:29:48.388 +01:00 [INF] Executing endpoint 'APIBank.Controllers.AccountsController.GetAllFromUser (APIBank)'
2022-09-23 15:29:48.391 +01:00 [INF] Route matched with {action = "GetAllFromUser", controller = "Accounts"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult GetAllFromUser() on controller APIBank.Controllers.AccountsController (APIBank).
2022-09-23 15:29:48.394 +01:00 [DBG] Execution plan of authorization filters (in the following order): ["APIBank.Authorization.AuthorizeAttribute"]
2022-09-23 15:29:48.396 +01:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2022-09-23 15:29:48.397 +01:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2022-09-23 15:29:48.400 +01:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2022-09-23 15:29:48.402 +01:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2022-09-23 15:29:48.403 +01:00 [INF] Authorization failed for the request at filter 'APIBank.Authorization.AuthorizeAttribute'.
2022-09-23 15:29:48.404 +01:00 [INF] Executing JsonResult, writing value of type '<>f__AnonymousType0`1[[System.String, System.Private.CoreLib, Version=6.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2022-09-23 15:29:48.405 +01:00 [INF] Executed action APIBank.Controllers.AccountsController.GetAllFromUser (APIBank) in 2.0594ms
2022-09-23 15:29:48.406 +01:00 [INF] Executed endpoint 'APIBank.Controllers.AccountsController.GetAllFromUser (APIBank)'
2022-09-23 15:29:48.410 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/api/Accounts/GetAll - - - 401 - application/json;+charset=utf-8 56.8555ms
2022-09-23 15:29:54.325 +01:00 [INF] Request starting HTTP/2 POST https://localhost:7036/api/Accounts/Create application/json 38
2022-09-23 15:29:54.330 +01:00 [DBG] 1 candidate(s) found for the request path '/api/Accounts/Create'
2022-09-23 15:29:54.331 +01:00 [DBG] Endpoint 'APIBank.Controllers.AccountsController.Create (APIBank)' with route pattern 'api/Accounts/Create' is valid for the request path '/api/Accounts/Create'
2022-09-23 15:29:54.332 +01:00 [DBG] Request matched endpoint 'APIBank.Controllers.AccountsController.Create (APIBank)'
2022-09-23 15:29:54.334 +01:00 [DBG] Static files was skipped as the request already matched an endpoint.
2022-09-23 15:29:54.363 +01:00 [INF] Executing endpoint 'APIBank.Controllers.AccountsController.Create (APIBank)'
2022-09-23 15:29:54.368 +01:00 [INF] Route matched with {action = "Create", controller = "Accounts"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult Create(APIBank.Models.Requests.AccountCreateRequest) on controller APIBank.Controllers.AccountsController (APIBank).
2022-09-23 15:29:54.370 +01:00 [DBG] Execution plan of authorization filters (in the following order): ["APIBank.Authorization.AuthorizeAttribute"]
2022-09-23 15:29:54.371 +01:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2022-09-23 15:29:54.372 +01:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2022-09-23 15:29:54.373 +01:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2022-09-23 15:29:54.374 +01:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2022-09-23 15:29:54.375 +01:00 [INF] Authorization failed for the request at filter 'APIBank.Authorization.AuthorizeAttribute'.
2022-09-23 15:29:54.375 +01:00 [INF] Executing JsonResult, writing value of type '<>f__AnonymousType0`1[[System.String, System.Private.CoreLib, Version=6.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2022-09-23 15:29:54.376 +01:00 [INF] Executed action APIBank.Controllers.AccountsController.Create (APIBank) in 1.4788ms
2022-09-23 15:29:54.377 +01:00 [INF] Executed endpoint 'APIBank.Controllers.AccountsController.Create (APIBank)'
2022-09-23 15:29:54.380 +01:00 [INF] Request finished HTTP/2 POST https://localhost:7036/api/Accounts/Create application/json 38 - 401 - application/json;+charset=utf-8 54.0942ms
2022-09-23 15:29:54.384 +01:00 [DBG] Connection id "0HMKTDSHHPGJA", Request id "0HMKTDSHHPGJA:00000037": started reading request body.
2022-09-23 15:29:54.386 +01:00 [DBG] Connection id "0HMKTDSHHPGJA", Request id "0HMKTDSHHPGJA:00000037": done reading request body.
2022-09-23 15:29:59.112 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/api/Accounts/GetById/100000003 - -
2022-09-23 15:29:59.114 +01:00 [DBG] 1 candidate(s) found for the request path '/api/Accounts/GetById/100000003'
2022-09-23 15:29:59.115 +01:00 [DBG] Endpoint 'APIBank.Controllers.AccountsController.GetById (APIBank)' with route pattern 'api/Accounts/GetById/{accountId}' is valid for the request path '/api/Accounts/GetById/100000003'
2022-09-23 15:29:59.118 +01:00 [DBG] Request matched endpoint 'APIBank.Controllers.AccountsController.GetById (APIBank)'
2022-09-23 15:29:59.120 +01:00 [DBG] Static files was skipped as the request already matched an endpoint.
2022-09-23 15:29:59.149 +01:00 [INF] Executing endpoint 'APIBank.Controllers.AccountsController.GetById (APIBank)'
2022-09-23 15:29:59.151 +01:00 [INF] Route matched with {action = "GetById", controller = "Accounts"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult GetById(Int32) on controller APIBank.Controllers.AccountsController (APIBank).
2022-09-23 15:29:59.153 +01:00 [DBG] Execution plan of authorization filters (in the following order): ["APIBank.Authorization.AuthorizeAttribute"]
2022-09-23 15:29:59.154 +01:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2022-09-23 15:29:59.156 +01:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2022-09-23 15:29:59.161 +01:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2022-09-23 15:29:59.163 +01:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2022-09-23 15:29:59.164 +01:00 [INF] Authorization failed for the request at filter 'APIBank.Authorization.AuthorizeAttribute'.
2022-09-23 15:29:59.166 +01:00 [INF] Executing JsonResult, writing value of type '<>f__AnonymousType0`1[[System.String, System.Private.CoreLib, Version=6.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2022-09-23 15:29:59.167 +01:00 [INF] Executed action APIBank.Controllers.AccountsController.GetById (APIBank) in 2.2334ms
2022-09-23 15:29:59.168 +01:00 [INF] Executed endpoint 'APIBank.Controllers.AccountsController.GetById (APIBank)'
2022-09-23 15:29:59.169 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/api/Accounts/GetById/100000003 - - - 401 - application/json;+charset=utf-8 56.7015ms
2022-09-23 15:30:16.290 +01:00 [INF] Request starting HTTP/2 POST https://localhost:7036/api/Users/Create application/json 119
2022-09-23 15:30:16.295 +01:00 [DBG] 1 candidate(s) found for the request path '/api/Users/Create'
2022-09-23 15:30:16.298 +01:00 [DBG] Endpoint 'APIBank.Controllers.UsersController.Create (APIBank)' with route pattern 'api/Users/Create' is valid for the request path '/api/Users/Create'
2022-09-23 15:30:16.301 +01:00 [DBG] Request matched endpoint 'APIBank.Controllers.UsersController.Create (APIBank)'
2022-09-23 15:30:16.303 +01:00 [DBG] Static files was skipped as the request already matched an endpoint.
2022-09-23 15:30:16.330 +01:00 [INF] Executing endpoint 'APIBank.Controllers.UsersController.Create (APIBank)'
2022-09-23 15:30:16.333 +01:00 [INF] Route matched with {action = "Create", controller = "Users"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult Create(APIBank.Models.Requests.UserCreateRequest) on controller APIBank.Controllers.UsersController (APIBank).
2022-09-23 15:30:16.336 +01:00 [DBG] Execution plan of authorization filters (in the following order): ["APIBank.Authorization.AuthorizeAttribute"]
2022-09-23 15:30:16.337 +01:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2022-09-23 15:30:16.338 +01:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2022-09-23 15:30:16.342 +01:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2022-09-23 15:30:16.345 +01:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2022-09-23 15:30:16.348 +01:00 [DBG] Executing controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-23 15:30:16.349 +01:00 [DBG] Executed controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-23 15:30:16.351 +01:00 [DBG] Attempting to bind parameter 'model' of type 'APIBank.Models.Requests.UserCreateRequest' ...
2022-09-23 15:30:16.352 +01:00 [DBG] Attempting to bind parameter 'model' of type 'APIBank.Models.Requests.UserCreateRequest' using the name '' in request data ...
2022-09-23 15:30:16.354 +01:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2022-09-23 15:30:16.358 +01:00 [DBG] Connection id "0HMKTDSHHPGJA", Request id "0HMKTDSHHPGJA:0000003B": started reading request body.
2022-09-23 15:30:16.361 +01:00 [DBG] Connection id "0HMKTDSHHPGJA", Request id "0HMKTDSHHPGJA:0000003B": done reading request body.
2022-09-23 15:30:16.364 +01:00 [DBG] JSON input formatter succeeded, deserializing to type 'APIBank.Models.Requests.UserCreateRequest'
2022-09-23 15:30:16.365 +01:00 [DBG] Done attempting to bind parameter 'model' of type 'APIBank.Models.Requests.UserCreateRequest'.
2022-09-23 15:30:16.366 +01:00 [DBG] Done attempting to bind parameter 'model' of type 'APIBank.Models.Requests.UserCreateRequest'.
2022-09-23 15:30:16.366 +01:00 [DBG] Attempting to validate the bound parameter 'model' of type 'APIBank.Models.Requests.UserCreateRequest' ...
2022-09-23 15:30:16.368 +01:00 [DBG] Done attempting to validate the bound parameter 'model' of type 'APIBank.Models.Requests.UserCreateRequest'.
2022-09-23 15:30:16.372 +01:00 [INF] Entity Framework Core 6.0.9 initialized 'PostgresContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:6.0.7+5b98e4b74de93b590b44aef8dd7967c03acc433c' with options: None
2022-09-23 15:30:16.374 +01:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .Any(x => x.Username == __model_Username_0)'
2022-09-23 15:30:16.379 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<bool>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            EmptyProjectionMember -> 0
        SELECT EXISTS (
            SELECT 1
            FROM users AS u
            WHERE u.username == @__model_Username_0)), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, bool>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)
    .Single()'
2022-09-23 15:30:16.380 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 15:30:16.381 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2022-09-23 15:30:16.382 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 15:30:16.457 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:30:16.460 +01:00 [DBG] Executing DbCommand [Parameters=[@__model_Username_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM users AS u
    WHERE u.username = @__model_Username_0)
2022-09-23 15:30:16.468 +01:00 [INF] Executed DbCommand (8ms) [Parameters=[@__model_Username_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM users AS u
    WHERE u.username = @__model_Username_0)
2022-09-23 15:30:16.470 +01:00 [DBG] A data reader was disposed.
2022-09-23 15:30:16.471 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:30:16.472 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 15:30:16.473 +01:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .Any(x => x.Email == __model_Email_0)'
2022-09-23 15:30:16.478 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<bool>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            EmptyProjectionMember -> 0
        SELECT EXISTS (
            SELECT 1
            FROM users AS u
            WHERE u.email == @__model_Email_0)), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, bool>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)
    .Single()'
2022-09-23 15:30:16.485 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 15:30:16.486 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2022-09-23 15:30:16.487 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 15:30:16.488 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:30:16.489 +01:00 [DBG] Executing DbCommand [Parameters=[@__model_Email_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM users AS u
    WHERE u.email = @__model_Email_0)
2022-09-23 15:30:16.492 +01:00 [INF] Executed DbCommand (3ms) [Parameters=[@__model_Email_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM users AS u
    WHERE u.email = @__model_Email_0)
2022-09-23 15:30:16.504 +01:00 [DBG] A data reader was disposed.
2022-09-23 15:30:16.505 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:30:16.506 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 15:30:16.715 +01:00 [DBG] 'PostgresContext' generated a temporary value for the property 'Id.User'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 15:30:16.720 +01:00 [DBG] Context 'PostgresContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 15:30:16.721 +01:00 [DBG] SaveChanges starting for 'PostgresContext'.
2022-09-23 15:30:16.722 +01:00 [DBG] DetectChanges starting for 'PostgresContext'.
2022-09-23 15:30:16.724 +01:00 [DBG] DetectChanges completed for 'PostgresContext'.
2022-09-23 15:30:16.725 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 15:30:16.726 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:30:16.727 +01:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2022-09-23 15:30:16.732 +01:00 [DBG] Began transaction with isolation level 'ReadCommitted'.
2022-09-23 15:30:16.733 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 15:30:16.734 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2022-09-23 15:30:16.735 +01:00 [DBG] Executing DbCommand [Parameters=[@p0='?', @p1='?', @p2='?', @p3='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO users (email, full_name, password_hash, username)
VALUES (@p0, @p1, @p2, @p3)
RETURNING id, created_at, password_changed_at;
2022-09-23 15:30:16.740 +01:00 [INF] Executed DbCommand (5ms) [Parameters=[@p0='?', @p1='?', @p2='?', @p3='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO users (email, full_name, password_hash, username)
VALUES (@p0, @p1, @p2, @p3)
RETURNING id, created_at, password_changed_at;
2022-09-23 15:30:16.744 +01:00 [DBG] The foreign key property 'User.Id' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2022-09-23 15:30:16.751 +01:00 [DBG] A data reader was disposed.
2022-09-23 15:30:16.752 +01:00 [DBG] Committing transaction.
2022-09-23 15:30:16.754 +01:00 [DBG] Committed transaction.
2022-09-23 15:30:16.755 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:30:16.757 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 15:30:16.763 +01:00 [DBG] Disposing transaction.
2022-09-23 15:30:16.765 +01:00 [DBG] An entity of type 'User' tracked by 'PostgresContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 15:30:16.767 +01:00 [DBG] SaveChanges completed for 'PostgresContext' with 1 entities written to the database.
2022-09-23 15:30:16.768 +01:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2022-09-23 15:30:16.770 +01:00 [DBG] Attempting to select an output formatter based on Accept header '["text/plain"]'.
2022-09-23 15:30:16.770 +01:00 [DBG] Could not find an output formatter based on content negotiation. Accepted types were (["text/plain"])
2022-09-23 15:30:16.771 +01:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2022-09-23 15:30:16.772 +01:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2022-09-23 15:30:16.773 +01:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2022-09-23 15:30:16.776 +01:00 [INF] Executing CreatedResult, writing value of type '<>f__AnonymousType0`1[[System.String, System.Private.CoreLib, Version=6.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2022-09-23 15:30:16.780 +01:00 [INF] Executed action APIBank.Controllers.UsersController.Create (APIBank) in 432.1273ms
2022-09-23 15:30:16.781 +01:00 [INF] Executed endpoint 'APIBank.Controllers.UsersController.Create (APIBank)'
2022-09-23 15:30:16.782 +01:00 [DBG] 'PostgresContext' disposed.
2022-09-23 15:30:16.787 +01:00 [INF] Request finished HTTP/2 POST https://localhost:7036/api/Users/Create application/json 119 - 201 - application/json;+charset=utf-8 494.1829ms
2022-09-23 15:30:30.763 +01:00 [INF] Request starting HTTP/2 POST https://localhost:7036/api/Users/Login application/json 54
2022-09-23 15:30:30.767 +01:00 [DBG] 1 candidate(s) found for the request path '/api/Users/Login'
2022-09-23 15:30:30.771 +01:00 [DBG] Endpoint 'APIBank.Controllers.UsersController.Login (APIBank)' with route pattern 'api/Users/Login' is valid for the request path '/api/Users/Login'
2022-09-23 15:30:30.776 +01:00 [DBG] Request matched endpoint 'APIBank.Controllers.UsersController.Login (APIBank)'
2022-09-23 15:30:30.785 +01:00 [DBG] Static files was skipped as the request already matched an endpoint.
2022-09-23 15:30:30.809 +01:00 [INF] Executing endpoint 'APIBank.Controllers.UsersController.Login (APIBank)'
2022-09-23 15:30:30.815 +01:00 [INF] Route matched with {action = "Login", controller = "Users"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult Login(APIBank.Models.Requests.UserLoginRequest) on controller APIBank.Controllers.UsersController (APIBank).
2022-09-23 15:30:30.819 +01:00 [DBG] Execution plan of authorization filters (in the following order): ["APIBank.Authorization.AuthorizeAttribute"]
2022-09-23 15:30:30.821 +01:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2022-09-23 15:30:30.824 +01:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2022-09-23 15:30:30.826 +01:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2022-09-23 15:30:30.830 +01:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2022-09-23 15:30:30.835 +01:00 [DBG] Executing controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-23 15:30:30.837 +01:00 [DBG] Executed controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-23 15:30:30.838 +01:00 [DBG] Attempting to bind parameter 'model' of type 'APIBank.Models.Requests.UserLoginRequest' ...
2022-09-23 15:30:30.840 +01:00 [DBG] Attempting to bind parameter 'model' of type 'APIBank.Models.Requests.UserLoginRequest' using the name '' in request data ...
2022-09-23 15:30:30.841 +01:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2022-09-23 15:30:30.842 +01:00 [DBG] Connection id "0HMKTDSHHPGJA", Request id "0HMKTDSHHPGJA:0000003D": started reading request body.
2022-09-23 15:30:30.843 +01:00 [DBG] Connection id "0HMKTDSHHPGJA", Request id "0HMKTDSHHPGJA:0000003D": done reading request body.
2022-09-23 15:30:30.846 +01:00 [DBG] JSON input formatter succeeded, deserializing to type 'APIBank.Models.Requests.UserLoginRequest'
2022-09-23 15:30:30.849 +01:00 [DBG] Done attempting to bind parameter 'model' of type 'APIBank.Models.Requests.UserLoginRequest'.
2022-09-23 15:30:30.850 +01:00 [DBG] Done attempting to bind parameter 'model' of type 'APIBank.Models.Requests.UserLoginRequest'.
2022-09-23 15:30:30.851 +01:00 [DBG] Attempting to validate the bound parameter 'model' of type 'APIBank.Models.Requests.UserLoginRequest' ...
2022-09-23 15:30:30.854 +01:00 [DBG] Done attempting to validate the bound parameter 'model' of type 'APIBank.Models.Requests.UserLoginRequest'.
2022-09-23 15:30:30.856 +01:00 [INF] Entity Framework Core 6.0.9 initialized 'PostgresContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:6.0.7+5b98e4b74de93b590b44aef8dd7967c03acc433c' with options: None
2022-09-23 15:30:30.857 +01:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .SingleOrDefault(x => x.Username == __model_Username_0)'
2022-09-23 15:30:30.860 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<User>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: User.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: User.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 1], [Property: User.Email (string) Required Index MaxLength(254), 2], [Property: User.FullName (string) Required MaxLength(100), 3], [Property: User.PasswordChangedAt (DateTime) Required ValueGenerated.OnAdd, 4], [Property: User.PasswordHash (string) Required MaxLength(200), 5], [Property: User.Username (string) Required Index MaxLength(50), 6] }
        SELECT TOP(2) u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
        FROM users AS u
        WHERE u.username == @__model_Username_0), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, User>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)
    .SingleOrDefault()'
2022-09-23 15:30:30.866 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 15:30:30.867 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2022-09-23 15:30:30.868 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 15:30:30.870 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:30:30.871 +01:00 [DBG] Executing DbCommand [Parameters=[@__model_Username_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.username = @__model_Username_0
LIMIT 2
2022-09-23 15:30:30.873 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[@__model_Username_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.username = @__model_Username_0
LIMIT 2
2022-09-23 15:30:30.875 +01:00 [DBG] Context 'PostgresContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 15:30:30.875 +01:00 [DBG] A data reader was disposed.
2022-09-23 15:30:30.876 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:30:30.881 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 15:30:31.070 +01:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .Any(user => user.RefreshTokenCollection
        .Any(reftoken => reftoken.RefToken == __token_0))'
2022-09-23 15:30:31.075 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<bool>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            EmptyProjectionMember -> 0
        SELECT EXISTS (
            SELECT 1
            FROM users AS u
            WHERE EXISTS (
                SELECT 1
                FROM refresh_token AS r
                WHERE ((u.id != NULL) && (u.id == r.user_id)) && (r.token == @__token_0)))), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, bool>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)
    .Single()'
2022-09-23 15:30:31.079 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 15:30:31.083 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (3ms).
2022-09-23 15:30:31.084 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 15:30:31.085 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:30:31.086 +01:00 [DBG] Executing DbCommand [Parameters=[@__token_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM users AS u
    WHERE EXISTS (
        SELECT 1
        FROM refresh_token AS r
        WHERE (u.id = r.user_id) AND (r.token = @__token_0)))
2022-09-23 15:30:31.089 +01:00 [INF] Executed DbCommand (3ms) [Parameters=[@__token_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM users AS u
    WHERE EXISTS (
        SELECT 1
        FROM refresh_token AS r
        WHERE (u.id = r.user_id) AND (r.token = @__token_0)))
2022-09-23 15:30:31.090 +01:00 [DBG] A data reader was disposed.
2022-09-23 15:30:31.090 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:30:31.091 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 15:30:31.092 +01:00 [DBG] SaveChanges starting for 'PostgresContext'.
2022-09-23 15:30:31.093 +01:00 [DBG] DetectChanges starting for 'PostgresContext'.
2022-09-23 15:30:31.093 +01:00 [DBG] 1 entities were added and 0 entities were removed from navigation 'User.RefreshTokenCollection'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 15:30:31.096 +01:00 [DBG] 'PostgresContext' generated a temporary value for the property 'Id.RefreshToken'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 15:30:31.099 +01:00 [DBG] Context 'PostgresContext' started tracking 'RefreshToken' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 15:30:31.101 +01:00 [DBG] DetectChanges completed for 'PostgresContext'.
2022-09-23 15:30:31.102 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 15:30:31.103 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:30:31.104 +01:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2022-09-23 15:30:31.105 +01:00 [DBG] Began transaction with isolation level 'ReadCommitted'.
2022-09-23 15:30:31.106 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 15:30:31.107 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2022-09-23 15:30:31.108 +01:00 [DBG] Executing DbCommand [Parameters=[@p0='?' (DbType = DateTime), @p1='?', @p2='?' (DbType = DateTime), @p3='?' (DbType = Boolean), @p4='?' (DbType = Boolean), @p5='?' (DbType = Boolean), @p6='?', @p7='?', @p8='?', @p9='?' (DbType = DateTime), @p10='?', @p11='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO refresh_token (created, created_by_ip, expires, is_active, is_expired, is_revoked, reason_revoked, token, replaced_by_token, revoked, revoked_by_ip, user_id)
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11)
RETURNING id;
2022-09-23 15:30:31.111 +01:00 [INF] Executed DbCommand (3ms) [Parameters=[@p0='?' (DbType = DateTime), @p1='?', @p2='?' (DbType = DateTime), @p3='?' (DbType = Boolean), @p4='?' (DbType = Boolean), @p5='?' (DbType = Boolean), @p6='?', @p7='?', @p8='?', @p9='?' (DbType = DateTime), @p10='?', @p11='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO refresh_token (created, created_by_ip, expires, is_active, is_expired, is_revoked, reason_revoked, token, replaced_by_token, revoked, revoked_by_ip, user_id)
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11)
RETURNING id;
2022-09-23 15:30:31.116 +01:00 [DBG] The foreign key property 'RefreshToken.Id' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2022-09-23 15:30:31.117 +01:00 [DBG] A data reader was disposed.
2022-09-23 15:30:31.118 +01:00 [DBG] Committing transaction.
2022-09-23 15:30:31.121 +01:00 [DBG] Committed transaction.
2022-09-23 15:30:31.122 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:30:31.123 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 15:30:31.124 +01:00 [DBG] Disposing transaction.
2022-09-23 15:30:31.125 +01:00 [DBG] An entity of type 'RefreshToken' tracked by 'PostgresContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 15:30:31.126 +01:00 [DBG] SaveChanges completed for 'PostgresContext' with 1 entities written to the database.
2022-09-23 15:30:31.132 +01:00 [DBG] Compiling query expression: 
'DbSet<RefreshToken>()
    .Where(rt => rt.UserId == __id_0)
    .AsNoTracking()
    .Select(rt => new RefreshToken{ 
        Id = rt.Id, 
        UserId = rt.UserId, 
        RefToken = rt.RefToken, 
        Expires = rt.Expires, 
        Created = rt.Created, 
        CreatedByIp = rt.CreatedByIp, 
        Revoked = rt.Revoked, 
        RevokedByIp = rt.RevokedByIp, 
        ReplacedByToken = rt.ReplacedByToken, 
        ReasonRevoked = rt.ReasonRevoked, 
        IsExpired = rt.IsExpired, 
        IsRevoked = rt.IsRevoked, 
        IsActive = rt.IsActive 
    }
    )'
2022-09-23 15:30:31.136 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<RefreshToken>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            Id -> 0
            UserId -> 1
            RefToken -> 2
            Expires -> 3
            Created -> 4
            CreatedByIp -> 5
            Revoked -> 6
            RevokedByIp -> 7
            ReplacedByToken -> 8
            ReasonRevoked -> 9
            IsExpired -> 10
            IsRevoked -> 11
            IsActive -> 12
        SELECT r.id AS Id, r.user_id AS UserId, r.token AS RefToken, r.expires AS Expires, r.created AS Created, r.created_by_ip AS CreatedByIp, r.revoked AS Revoked, r.revoked_by_ip AS RevokedByIp, r.replaced_by_token AS ReplacedByToken, r.reason_revoked AS ReasonRevoked, r.is_expired AS IsExpired, r.is_revoked AS IsRevoked, r.is_active AS IsActive
        FROM refresh_token AS r
        WHERE r.user_id == @__id_0), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, RefreshToken>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)'
2022-09-23 15:30:31.139 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 15:30:31.140 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2022-09-23 15:30:31.140 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 15:30:31.141 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:30:31.142 +01:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.user_id AS "UserId", r.token AS "RefToken", r.expires AS "Expires", r.created AS "Created", r.created_by_ip AS "CreatedByIp", r.revoked AS "Revoked", r.revoked_by_ip AS "RevokedByIp", r.replaced_by_token AS "ReplacedByToken", r.reason_revoked AS "ReasonRevoked", r.is_expired AS "IsExpired", r.is_revoked AS "IsRevoked", r.is_active AS "IsActive"
FROM refresh_token AS r
WHERE r.user_id = @__id_0
2022-09-23 15:30:31.147 +01:00 [INF] Executed DbCommand (5ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.user_id AS "UserId", r.token AS "RefToken", r.expires AS "Expires", r.created AS "Created", r.created_by_ip AS "CreatedByIp", r.revoked AS "Revoked", r.revoked_by_ip AS "RevokedByIp", r.replaced_by_token AS "ReplacedByToken", r.reason_revoked AS "ReasonRevoked", r.is_expired AS "IsExpired", r.is_revoked AS "IsRevoked", r.is_active AS "IsActive"
FROM refresh_token AS r
WHERE r.user_id = @__id_0
2022-09-23 15:30:31.150 +01:00 [DBG] A data reader was disposed.
2022-09-23 15:30:31.151 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:30:31.152 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 15:30:31.153 +01:00 [DBG] An entity of type 'User' tracked by 'PostgresContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 15:30:31.154 +01:00 [DBG] An entity of type 'RefreshToken' tracked by 'PostgresContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 15:30:31.155 +01:00 [DBG] SaveChanges starting for 'PostgresContext'.
2022-09-23 15:30:31.156 +01:00 [DBG] DetectChanges starting for 'PostgresContext'.
2022-09-23 15:30:31.157 +01:00 [DBG] DetectChanges completed for 'PostgresContext'.
2022-09-23 15:30:31.158 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 15:30:31.160 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:30:31.162 +01:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2022-09-23 15:30:31.163 +01:00 [DBG] Began transaction with isolation level 'ReadCommitted'.
2022-09-23 15:30:31.164 +01:00 [DBG] Executing 2 update commands as a batch.
2022-09-23 15:30:31.165 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 15:30:31.165 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2022-09-23 15:30:31.166 +01:00 [DBG] Executing DbCommand [Parameters=[@p12='?' (DbType = Int32), @p0='?' (DbType = DateTime), @p1='?', @p2='?' (DbType = DateTime), @p3='?' (DbType = Boolean), @p4='?' (DbType = Boolean), @p5='?' (DbType = Boolean), @p6='?', @p7='?', @p8='?', @p9='?' (DbType = DateTime), @p10='?', @p11='?' (DbType = Int32), @p19='?' (DbType = Int32), @p13='?' (DbType = DateTime), @p14='?', @p15='?', @p16='?' (DbType = DateTime), @p17='?', @p18='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE refresh_token SET created = @p0, created_by_ip = @p1, expires = @p2, is_active = @p3, is_expired = @p4, is_revoked = @p5, reason_revoked = @p6, token = @p7, replaced_by_token = @p8, revoked = @p9, revoked_by_ip = @p10, user_id = @p11
WHERE id = @p12;
UPDATE users SET created_at = @p13, email = @p14, full_name = @p15, password_changed_at = @p16, password_hash = @p17, username = @p18
WHERE id = @p19;
2022-09-23 15:30:31.169 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[@p12='?' (DbType = Int32), @p0='?' (DbType = DateTime), @p1='?', @p2='?' (DbType = DateTime), @p3='?' (DbType = Boolean), @p4='?' (DbType = Boolean), @p5='?' (DbType = Boolean), @p6='?', @p7='?', @p8='?', @p9='?' (DbType = DateTime), @p10='?', @p11='?' (DbType = Int32), @p19='?' (DbType = Int32), @p13='?' (DbType = DateTime), @p14='?', @p15='?', @p16='?' (DbType = DateTime), @p17='?', @p18='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE refresh_token SET created = @p0, created_by_ip = @p1, expires = @p2, is_active = @p3, is_expired = @p4, is_revoked = @p5, reason_revoked = @p6, token = @p7, replaced_by_token = @p8, revoked = @p9, revoked_by_ip = @p10, user_id = @p11
WHERE id = @p12;
UPDATE users SET created_at = @p13, email = @p14, full_name = @p15, password_changed_at = @p16, password_hash = @p17, username = @p18
WHERE id = @p19;
2022-09-23 15:30:31.171 +01:00 [DBG] A data reader was disposed.
2022-09-23 15:30:31.171 +01:00 [DBG] Committing transaction.
2022-09-23 15:30:31.172 +01:00 [DBG] Committed transaction.
2022-09-23 15:30:31.173 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:30:31.174 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 15:30:31.176 +01:00 [DBG] Disposing transaction.
2022-09-23 15:30:31.176 +01:00 [DBG] An entity of type 'User' tracked by 'PostgresContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 15:30:31.178 +01:00 [DBG] An entity of type 'RefreshToken' tracked by 'PostgresContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 15:30:31.180 +01:00 [DBG] SaveChanges completed for 'PostgresContext' with 2 entities written to the database.
2022-09-23 15:30:31.181 +01:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2022-09-23 15:30:31.183 +01:00 [DBG] Attempting to select an output formatter based on Accept header '["text/plain"]'.
2022-09-23 15:30:31.184 +01:00 [DBG] Could not find an output formatter based on content negotiation. Accepted types were (["text/plain"])
2022-09-23 15:30:31.184 +01:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2022-09-23 15:30:31.185 +01:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2022-09-23 15:30:31.186 +01:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2022-09-23 15:30:31.186 +01:00 [INF] Executing OkObjectResult, writing value of type 'APIBank.Models.MyRequestResponses.LoginResponse'.
2022-09-23 15:30:31.189 +01:00 [INF] Executed action APIBank.Controllers.UsersController.Login (APIBank) in 353.5556ms
2022-09-23 15:30:31.191 +01:00 [INF] Executed endpoint 'APIBank.Controllers.UsersController.Login (APIBank)'
2022-09-23 15:30:31.192 +01:00 [DBG] 'PostgresContext' disposed.
2022-09-23 15:30:31.193 +01:00 [INF] Request finished HTTP/2 POST https://localhost:7036/api/Users/Login application/json 54 - 200 - application/json;+charset=utf-8 430.4575ms
2022-09-23 15:32:36.513 +01:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2022-09-23 15:32:36.584 +01:00 [DBG] Hosting starting
2022-09-23 15:32:36.665 +01:00 [DBG] Using development certificate: CN=localhost (Thumbprint: 9CC642E9838495A6C3C202DECA6A8AD300396DD2)
2022-09-23 15:32:36.706 +01:00 [INF] Now listening on: https://localhost:7036
2022-09-23 15:32:36.708 +01:00 [INF] Now listening on: http://localhost:5036
2022-09-23 15:32:36.708 +01:00 [DBG] Loaded hosting startup assembly APIBank
2022-09-23 15:32:36.709 +01:00 [DBG] Loaded hosting startup assembly Microsoft.AspNetCore.Watch.BrowserRefresh
2022-09-23 15:32:36.710 +01:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.BrowserLink.Net
2022-09-23 15:32:36.711 +01:00 [INF] Application started. Press Ctrl+C to shut down.
2022-09-23 15:32:36.712 +01:00 [INF] Hosting environment: Development
2022-09-23 15:32:36.713 +01:00 [INF] Content root path: C:\Users\mguedesa\OneDrive - NTT DATA EMEAL\Documentos\GitHub\OpenBankAPI-NTT\APIBank\APIBank\
2022-09-23 15:32:36.713 +01:00 [DBG] Hosting started
2022-09-23 15:32:36.718 +01:00 [DBG] Connection id "0HMKTE1QV7TFR" accepted.
2022-09-23 15:32:36.718 +01:00 [DBG] Connection id "0HMKTE1QV7TFS" accepted.
2022-09-23 15:32:36.719 +01:00 [DBG] Connection id "0HMKTE1QV7TFR" started.
2022-09-23 15:32:36.719 +01:00 [DBG] Connection id "0HMKTE1QV7TFS" started.
2022-09-23 15:32:36.734 +01:00 [DBG] Connection id "0HMKTE1QV7TFS" received FIN.
2022-09-23 15:32:36.734 +01:00 [DBG] Connection id "0HMKTE1QV7TFR" received FIN.
2022-09-23 15:32:36.741 +01:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException:  Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.<FillHandshakeBufferAsync>g__InternalFillHandshakeBufferAsync|189_0[TIOAdapter](TIOAdapter adap, ValueTask`1 task, Int32 minSize)
   at System.Net.Security.SslStream.ReceiveBlobAsync[TIOAdapter](TIOAdapter adapter)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](TIOAdapter adapter, Boolean receiveFirst, Byte[] reAuthenticationData, Boolean isApm)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2022-09-23 15:32:36.741 +01:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException:  Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.<FillHandshakeBufferAsync>g__InternalFillHandshakeBufferAsync|189_0[TIOAdapter](TIOAdapter adap, ValueTask`1 task, Int32 minSize)
   at System.Net.Security.SslStream.ReceiveBlobAsync[TIOAdapter](TIOAdapter adapter)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](TIOAdapter adapter, Boolean receiveFirst, Byte[] reAuthenticationData, Boolean isApm)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2022-09-23 15:32:36.765 +01:00 [DBG] Connection id "0HMKTE1QV7TFR" stopped.
2022-09-23 15:32:36.765 +01:00 [DBG] Connection id "0HMKTE1QV7TFS" stopped.
2022-09-23 15:32:36.770 +01:00 [DBG] Connection id "0HMKTE1QV7TFS" sending FIN because: "The Socket transport's send loop completed gracefully."
2022-09-23 15:32:36.770 +01:00 [DBG] Connection id "0HMKTE1QV7TFR" sending FIN because: "The Socket transport's send loop completed gracefully."
2022-09-23 15:32:36.959 +01:00 [DBG] Connection id "0HMKTE1QV7TFT" accepted.
2022-09-23 15:32:36.961 +01:00 [DBG] Connection id "0HMKTE1QV7TFT" started.
2022-09-23 15:32:37.011 +01:00 [DBG] Connection 0HMKTE1QV7TFT established using the following protocol: "Tls12"
2022-09-23 15:32:37.065 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/swagger/index.html - -
2022-09-23 15:32:37.096 +01:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2022-09-23 15:32:37.119 +01:00 [DBG] No candidates found for the request path '/swagger/index.html'
2022-09-23 15:32:37.120 +01:00 [DBG] Request did not match any endpoints
2022-09-23 15:32:37.209 +01:00 [DBG] Response markup is scheduled to include browser refresh script injection.
2022-09-23 15:32:37.303 +01:00 [DBG] Response markup was updated to include browser refresh script injection.
2022-09-23 15:32:37.309 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/swagger/index.html - - - 200 - text/html;charset=utf-8 247.3266ms
2022-09-23 15:32:37.343 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/_framework/aspnetcore-browser-refresh.js - -
2022-09-23 15:32:37.346 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/_vs/browserLink - -
2022-09-23 15:32:37.349 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/_framework/aspnetcore-browser-refresh.js - - - 200 11984 application/javascript;+charset=utf-8 6.4873ms
2022-09-23 15:32:37.428 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/_vs/browserLink - - - 200 - text/javascript;+charset=UTF-8 82.5621ms
2022-09-23 15:32:37.559 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/swagger/v1/swagger.json - -
2022-09-23 15:32:37.563 +01:00 [DBG] No candidates found for the request path '/swagger/v1/swagger.json'
2022-09-23 15:32:37.564 +01:00 [DBG] Request did not match any endpoints
2022-09-23 15:32:37.796 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/swagger/v1/swagger.json - - - 200 - application/json;charset=utf-8 237.3235ms
2022-09-23 15:34:50.142 +01:00 [DBG] Connection id "0HMKTE1QV7TFT" is closing.
2022-09-23 15:34:50.149 +01:00 [DBG] Connection id "0HMKTE1QV7TFT" is closed. The last processed stream ID was 7.
2022-09-23 15:34:50.152 +01:00 [DBG] Connection id "0HMKTE1QV7TFT" received FIN.
2022-09-23 15:34:50.154 +01:00 [DBG] Connection id "0HMKTE1QV7TFT" sending FIN because: "The client closed the connection."
2022-09-23 15:34:50.157 +01:00 [DBG] Connection id "0HMKTE1QV7TFT" stopped.
2022-09-23 15:37:52.155 +01:00 [DBG] Connection id "0HMKTE1QV7TFU" accepted.
2022-09-23 15:37:52.157 +01:00 [DBG] Connection id "0HMKTE1QV7TFU" received FIN.
2022-09-23 15:37:52.158 +01:00 [DBG] Connection id "0HMKTE1QV7TFV" accepted.
2022-09-23 15:37:52.159 +01:00 [DBG] Connection id "0HMKTE1QV7TFU" started.
2022-09-23 15:37:52.160 +01:00 [DBG] Connection id "0HMKTE1QV7TFV" started.
2022-09-23 15:37:52.161 +01:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException:  Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveBlobAsync[TIOAdapter](TIOAdapter adapter)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](TIOAdapter adapter, Boolean receiveFirst, Byte[] reAuthenticationData, Boolean isApm)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2022-09-23 15:37:52.163 +01:00 [DBG] Connection id "0HMKTE1QV7TFU" stopped.
2022-09-23 15:37:52.164 +01:00 [DBG] Connection id "0HMKTE1QV7TFU" sending FIN because: "The Socket transport's send loop completed gracefully."
2022-09-23 15:37:52.167 +01:00 [DBG] Connection 0HMKTE1QV7TFV established using the following protocol: "Tls12"
2022-09-23 15:37:52.177 +01:00 [INF] Request starting HTTP/1.1 GET https://localhost:7036/api/Transfers/TransferRequest - -
2022-09-23 15:37:52.182 +01:00 [DBG] 1 candidate(s) found for the request path '/api/Transfers/TransferRequest'
2022-09-23 15:37:52.183 +01:00 [DBG] Request matched endpoint '405 HTTP Method Not Supported'
2022-09-23 15:37:52.187 +01:00 [DBG] Static files was skipped as the request already matched an endpoint.
2022-09-23 15:37:52.542 +01:00 [INF] Executing endpoint '405 HTTP Method Not Supported'
2022-09-23 15:37:52.544 +01:00 [INF] Executed endpoint '405 HTTP Method Not Supported'
2022-09-23 15:37:52.548 +01:00 [DBG] Connection id "0HMKTE1QV7TFV" completed keep alive response.
2022-09-23 15:37:52.554 +01:00 [INF] Request finished HTTP/1.1 GET https://localhost:7036/api/Transfers/TransferRequest - - - 405 0 - 376.3395ms
2022-09-23 15:38:15.667 +01:00 [INF] Request starting HTTP/1.1 POST https://localhost:7036/api/Users/Login application/json 65
2022-09-23 15:38:15.671 +01:00 [DBG] 1 candidate(s) found for the request path '/api/Users/Login'
2022-09-23 15:38:15.677 +01:00 [DBG] Endpoint 'APIBank.Controllers.UsersController.Login (APIBank)' with route pattern 'api/Users/Login' is valid for the request path '/api/Users/Login'
2022-09-23 15:38:15.678 +01:00 [DBG] Request matched endpoint 'APIBank.Controllers.UsersController.Login (APIBank)'
2022-09-23 15:38:15.681 +01:00 [DBG] Static files was skipped as the request already matched an endpoint.
2022-09-23 15:38:15.690 +01:00 [INF] Executing endpoint 'APIBank.Controllers.UsersController.Login (APIBank)'
2022-09-23 15:38:15.710 +01:00 [INF] Route matched with {action = "Login", controller = "Users"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult Login(APIBank.Models.Requests.UserLoginRequest) on controller APIBank.Controllers.UsersController (APIBank).
2022-09-23 15:38:15.715 +01:00 [DBG] Execution plan of authorization filters (in the following order): ["APIBank.Authorization.AuthorizeAttribute"]
2022-09-23 15:38:15.716 +01:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2022-09-23 15:38:15.718 +01:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2022-09-23 15:38:15.721 +01:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2022-09-23 15:38:15.723 +01:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2022-09-23 15:38:15.725 +01:00 [DBG] Executing controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-23 15:38:15.727 +01:00 [DBG] Executed controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-23 15:38:15.734 +01:00 [DBG] Attempting to bind parameter 'model' of type 'APIBank.Models.Requests.UserLoginRequest' ...
2022-09-23 15:38:15.737 +01:00 [DBG] Attempting to bind parameter 'model' of type 'APIBank.Models.Requests.UserLoginRequest' using the name '' in request data ...
2022-09-23 15:38:15.739 +01:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2022-09-23 15:38:15.744 +01:00 [DBG] Connection id "0HMKTE1QV7TFV", Request id "0HMKTE1QV7TFV:00000003": started reading request body.
2022-09-23 15:38:15.745 +01:00 [DBG] Connection id "0HMKTE1QV7TFV", Request id "0HMKTE1QV7TFV:00000003": done reading request body.
2022-09-23 15:38:15.754 +01:00 [DBG] JSON input formatter succeeded, deserializing to type 'APIBank.Models.Requests.UserLoginRequest'
2022-09-23 15:38:15.756 +01:00 [DBG] Done attempting to bind parameter 'model' of type 'APIBank.Models.Requests.UserLoginRequest'.
2022-09-23 15:38:15.757 +01:00 [DBG] Done attempting to bind parameter 'model' of type 'APIBank.Models.Requests.UserLoginRequest'.
2022-09-23 15:38:15.758 +01:00 [DBG] Attempting to validate the bound parameter 'model' of type 'APIBank.Models.Requests.UserLoginRequest' ...
2022-09-23 15:38:15.769 +01:00 [DBG] Done attempting to validate the bound parameter 'model' of type 'APIBank.Models.Requests.UserLoginRequest'.
2022-09-23 15:38:15.822 +01:00 [DBG] An additional 'IServiceProvider' was created for internal use by Entity Framework. An existing service provider was not used due to the following configuration changes: configuration changed for 'Core:ConfigureWarnings', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:UseAdminDatabase', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:SetPostgresVersion', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:UseRedshift', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:ReverseNullOrdering', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:RemoteCertificateValidationCallback', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:ProvideClientCertificatesCallback', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:ProvidePasswordCallback'.
2022-09-23 15:38:16.558 +01:00 [INF] Entity Framework Core 6.0.9 initialized 'PostgresContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:6.0.7+5b98e4b74de93b590b44aef8dd7967c03acc433c' with options: None
2022-09-23 15:38:16.596 +01:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .SingleOrDefault(x => x.Username == __model_Username_0)'
2022-09-23 15:38:16.810 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<User>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: User.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: User.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 1], [Property: User.Email (string) Required Index MaxLength(254), 2], [Property: User.FullName (string) Required MaxLength(100), 3], [Property: User.PasswordChangedAt (DateTime) Required ValueGenerated.OnAdd, 4], [Property: User.PasswordHash (string) Required MaxLength(200), 5], [Property: User.Username (string) Required Index MaxLength(50), 6] }
        SELECT TOP(2) u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
        FROM users AS u
        WHERE u.username == @__model_Username_0), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, User>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)
    .SingleOrDefault()'
2022-09-23 15:38:16.842 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 15:38:16.877 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (35ms).
2022-09-23 15:38:16.888 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 15:38:17.102 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:38:17.114 +01:00 [DBG] Executing DbCommand [Parameters=[@__model_Username_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.username = @__model_Username_0
LIMIT 2
2022-09-23 15:38:17.187 +01:00 [INF] Executed DbCommand (73ms) [Parameters=[@__model_Username_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.username = @__model_Username_0
LIMIT 2
2022-09-23 15:38:17.219 +01:00 [DBG] Context 'PostgresContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 15:38:17.252 +01:00 [DBG] A data reader was disposed.
2022-09-23 15:38:17.256 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:38:17.260 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 15:38:17.432 +01:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .Any(user => user.RefreshTokenCollection
        .Any(reftoken => reftoken.RefToken == __token_0))'
2022-09-23 15:38:17.493 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<bool>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            EmptyProjectionMember -> 0
        SELECT EXISTS (
            SELECT 1
            FROM users AS u
            WHERE EXISTS (
                SELECT 1
                FROM refresh_token AS r
                WHERE ((u.id != NULL) && (u.id == r.user_id)) && (r.token == @__token_0)))), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, bool>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)
    .Single()'
2022-09-23 15:38:17.504 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 15:38:17.504 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2022-09-23 15:38:17.506 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 15:38:17.507 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:38:17.508 +01:00 [DBG] Executing DbCommand [Parameters=[@__token_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM users AS u
    WHERE EXISTS (
        SELECT 1
        FROM refresh_token AS r
        WHERE (u.id = r.user_id) AND (r.token = @__token_0)))
2022-09-23 15:38:17.515 +01:00 [INF] Executed DbCommand (7ms) [Parameters=[@__token_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM users AS u
    WHERE EXISTS (
        SELECT 1
        FROM refresh_token AS r
        WHERE (u.id = r.user_id) AND (r.token = @__token_0)))
2022-09-23 15:38:17.518 +01:00 [DBG] A data reader was disposed.
2022-09-23 15:38:17.519 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:38:17.520 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 15:38:17.523 +01:00 [DBG] SaveChanges starting for 'PostgresContext'.
2022-09-23 15:38:17.525 +01:00 [DBG] DetectChanges starting for 'PostgresContext'.
2022-09-23 15:38:17.546 +01:00 [DBG] 1 entities were added and 0 entities were removed from navigation 'User.RefreshTokenCollection'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 15:38:17.569 +01:00 [DBG] 'PostgresContext' generated a temporary value for the property 'Id.RefreshToken'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 15:38:17.615 +01:00 [DBG] Context 'PostgresContext' started tracking 'RefreshToken' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 15:38:17.621 +01:00 [DBG] DetectChanges completed for 'PostgresContext'.
2022-09-23 15:38:17.631 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 15:38:17.634 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:38:17.636 +01:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2022-09-23 15:38:17.643 +01:00 [DBG] Began transaction with isolation level 'ReadCommitted'.
2022-09-23 15:38:17.691 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 15:38:17.693 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (2ms).
2022-09-23 15:38:17.697 +01:00 [DBG] Executing DbCommand [Parameters=[@p0='?' (DbType = DateTime), @p1='?', @p2='?' (DbType = DateTime), @p3='?' (DbType = Boolean), @p4='?' (DbType = Boolean), @p5='?' (DbType = Boolean), @p6='?', @p7='?', @p8='?', @p9='?' (DbType = DateTime), @p10='?', @p11='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO refresh_token (created, created_by_ip, expires, is_active, is_expired, is_revoked, reason_revoked, token, replaced_by_token, revoked, revoked_by_ip, user_id)
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11)
RETURNING id;
2022-09-23 15:38:17.705 +01:00 [INF] Executed DbCommand (8ms) [Parameters=[@p0='?' (DbType = DateTime), @p1='?', @p2='?' (DbType = DateTime), @p3='?' (DbType = Boolean), @p4='?' (DbType = Boolean), @p5='?' (DbType = Boolean), @p6='?', @p7='?', @p8='?', @p9='?' (DbType = DateTime), @p10='?', @p11='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO refresh_token (created, created_by_ip, expires, is_active, is_expired, is_revoked, reason_revoked, token, replaced_by_token, revoked, revoked_by_ip, user_id)
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11)
RETURNING id;
2022-09-23 15:38:17.719 +01:00 [DBG] The foreign key property 'RefreshToken.Id' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2022-09-23 15:38:17.727 +01:00 [DBG] A data reader was disposed.
2022-09-23 15:38:17.731 +01:00 [DBG] Committing transaction.
2022-09-23 15:38:17.735 +01:00 [DBG] Committed transaction.
2022-09-23 15:38:17.737 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:38:17.738 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 15:38:17.740 +01:00 [DBG] Disposing transaction.
2022-09-23 15:38:17.750 +01:00 [DBG] An entity of type 'RefreshToken' tracked by 'PostgresContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 15:38:17.753 +01:00 [DBG] SaveChanges completed for 'PostgresContext' with 1 entities written to the database.
2022-09-23 15:38:17.789 +01:00 [DBG] Compiling query expression: 
'DbSet<RefreshToken>()
    .Where(rt => rt.UserId == __id_0)
    .AsNoTracking()
    .Select(rt => new RefreshToken{ 
        Id = rt.Id, 
        UserId = rt.UserId, 
        RefToken = rt.RefToken, 
        Expires = rt.Expires, 
        Created = rt.Created, 
        CreatedByIp = rt.CreatedByIp, 
        Revoked = rt.Revoked, 
        RevokedByIp = rt.RevokedByIp, 
        ReplacedByToken = rt.ReplacedByToken, 
        ReasonRevoked = rt.ReasonRevoked, 
        IsExpired = rt.IsExpired, 
        IsRevoked = rt.IsRevoked, 
        IsActive = rt.IsActive 
    }
    )'
2022-09-23 15:38:17.814 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<RefreshToken>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            Id -> 0
            UserId -> 1
            RefToken -> 2
            Expires -> 3
            Created -> 4
            CreatedByIp -> 5
            Revoked -> 6
            RevokedByIp -> 7
            ReplacedByToken -> 8
            ReasonRevoked -> 9
            IsExpired -> 10
            IsRevoked -> 11
            IsActive -> 12
        SELECT r.id AS Id, r.user_id AS UserId, r.token AS RefToken, r.expires AS Expires, r.created AS Created, r.created_by_ip AS CreatedByIp, r.revoked AS Revoked, r.revoked_by_ip AS RevokedByIp, r.replaced_by_token AS ReplacedByToken, r.reason_revoked AS ReasonRevoked, r.is_expired AS IsExpired, r.is_revoked AS IsRevoked, r.is_active AS IsActive
        FROM refresh_token AS r
        WHERE r.user_id == @__id_0), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, RefreshToken>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)'
2022-09-23 15:38:17.818 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 15:38:17.819 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2022-09-23 15:38:17.819 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 15:38:17.821 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:38:17.822 +01:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.user_id AS "UserId", r.token AS "RefToken", r.expires AS "Expires", r.created AS "Created", r.created_by_ip AS "CreatedByIp", r.revoked AS "Revoked", r.revoked_by_ip AS "RevokedByIp", r.replaced_by_token AS "ReplacedByToken", r.reason_revoked AS "ReasonRevoked", r.is_expired AS "IsExpired", r.is_revoked AS "IsRevoked", r.is_active AS "IsActive"
FROM refresh_token AS r
WHERE r.user_id = @__id_0
2022-09-23 15:38:17.824 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.user_id AS "UserId", r.token AS "RefToken", r.expires AS "Expires", r.created AS "Created", r.created_by_ip AS "CreatedByIp", r.revoked AS "Revoked", r.revoked_by_ip AS "RevokedByIp", r.replaced_by_token AS "ReplacedByToken", r.reason_revoked AS "ReasonRevoked", r.is_expired AS "IsExpired", r.is_revoked AS "IsRevoked", r.is_active AS "IsActive"
FROM refresh_token AS r
WHERE r.user_id = @__id_0
2022-09-23 15:38:17.826 +01:00 [DBG] A data reader was disposed.
2022-09-23 15:38:17.827 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:38:17.828 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 15:38:17.831 +01:00 [DBG] An entity of type 'User' tracked by 'PostgresContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 15:38:17.833 +01:00 [DBG] An entity of type 'RefreshToken' tracked by 'PostgresContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 15:38:17.834 +01:00 [DBG] SaveChanges starting for 'PostgresContext'.
2022-09-23 15:38:17.835 +01:00 [DBG] DetectChanges starting for 'PostgresContext'.
2022-09-23 15:38:17.838 +01:00 [DBG] DetectChanges completed for 'PostgresContext'.
2022-09-23 15:38:17.839 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 15:38:17.840 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:38:17.841 +01:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2022-09-23 15:38:17.842 +01:00 [DBG] Began transaction with isolation level 'ReadCommitted'.
2022-09-23 15:38:17.857 +01:00 [DBG] Executing 2 update commands as a batch.
2022-09-23 15:38:17.859 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 15:38:17.860 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2022-09-23 15:38:17.863 +01:00 [DBG] Executing DbCommand [Parameters=[@p12='?' (DbType = Int32), @p0='?' (DbType = DateTime), @p1='?', @p2='?' (DbType = DateTime), @p3='?' (DbType = Boolean), @p4='?' (DbType = Boolean), @p5='?' (DbType = Boolean), @p6='?', @p7='?', @p8='?', @p9='?' (DbType = DateTime), @p10='?', @p11='?' (DbType = Int32), @p19='?' (DbType = Int32), @p13='?' (DbType = DateTime), @p14='?', @p15='?', @p16='?' (DbType = DateTime), @p17='?', @p18='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE refresh_token SET created = @p0, created_by_ip = @p1, expires = @p2, is_active = @p3, is_expired = @p4, is_revoked = @p5, reason_revoked = @p6, token = @p7, replaced_by_token = @p8, revoked = @p9, revoked_by_ip = @p10, user_id = @p11
WHERE id = @p12;
UPDATE users SET created_at = @p13, email = @p14, full_name = @p15, password_changed_at = @p16, password_hash = @p17, username = @p18
WHERE id = @p19;
2022-09-23 15:38:17.867 +01:00 [INF] Executed DbCommand (4ms) [Parameters=[@p12='?' (DbType = Int32), @p0='?' (DbType = DateTime), @p1='?', @p2='?' (DbType = DateTime), @p3='?' (DbType = Boolean), @p4='?' (DbType = Boolean), @p5='?' (DbType = Boolean), @p6='?', @p7='?', @p8='?', @p9='?' (DbType = DateTime), @p10='?', @p11='?' (DbType = Int32), @p19='?' (DbType = Int32), @p13='?' (DbType = DateTime), @p14='?', @p15='?', @p16='?' (DbType = DateTime), @p17='?', @p18='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE refresh_token SET created = @p0, created_by_ip = @p1, expires = @p2, is_active = @p3, is_expired = @p4, is_revoked = @p5, reason_revoked = @p6, token = @p7, replaced_by_token = @p8, revoked = @p9, revoked_by_ip = @p10, user_id = @p11
WHERE id = @p12;
UPDATE users SET created_at = @p13, email = @p14, full_name = @p15, password_changed_at = @p16, password_hash = @p17, username = @p18
WHERE id = @p19;
2022-09-23 15:38:17.871 +01:00 [DBG] A data reader was disposed.
2022-09-23 15:38:17.872 +01:00 [DBG] Committing transaction.
2022-09-23 15:38:17.873 +01:00 [DBG] Committed transaction.
2022-09-23 15:38:17.874 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:38:17.874 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 15:38:17.875 +01:00 [DBG] Disposing transaction.
2022-09-23 15:38:17.876 +01:00 [DBG] An entity of type 'User' tracked by 'PostgresContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 15:38:17.878 +01:00 [DBG] An entity of type 'RefreshToken' tracked by 'PostgresContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 15:38:17.881 +01:00 [DBG] SaveChanges completed for 'PostgresContext' with 2 entities written to the database.
2022-09-23 15:38:17.885 +01:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2022-09-23 15:38:17.888 +01:00 [DBG] No information found on request to perform content negotiation.
2022-09-23 15:38:17.888 +01:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2022-09-23 15:38:17.889 +01:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2022-09-23 15:38:17.890 +01:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2022-09-23 15:38:17.892 +01:00 [INF] Executing OkObjectResult, writing value of type 'APIBank.Models.MyRequestResponses.LoginResponse'.
2022-09-23 15:38:17.905 +01:00 [INF] Executed action APIBank.Controllers.UsersController.Login (APIBank) in 2177.0137ms
2022-09-23 15:38:17.906 +01:00 [INF] Executed endpoint 'APIBank.Controllers.UsersController.Login (APIBank)'
2022-09-23 15:38:17.907 +01:00 [DBG] Connection id "0HMKTE1QV7TFV" completed keep alive response.
2022-09-23 15:38:17.909 +01:00 [DBG] 'PostgresContext' disposed.
2022-09-23 15:38:17.913 +01:00 [INF] Request finished HTTP/1.1 POST https://localhost:7036/api/Users/Login application/json 65 - 200 - application/json;+charset=utf-8 2245.7140ms
2022-09-23 15:38:43.175 +01:00 [INF] Request starting HTTP/1.1 GET https://localhost:7036/api/Accounts/GetAll - -
2022-09-23 15:38:43.179 +01:00 [DBG] 1 candidate(s) found for the request path '/api/Accounts/GetAll'
2022-09-23 15:38:43.181 +01:00 [DBG] Endpoint 'APIBank.Controllers.AccountsController.GetAllFromUser (APIBank)' with route pattern 'api/Accounts/GetAll' is valid for the request path '/api/Accounts/GetAll'
2022-09-23 15:38:43.184 +01:00 [DBG] Request matched endpoint 'APIBank.Controllers.AccountsController.GetAllFromUser (APIBank)'
2022-09-23 15:38:43.186 +01:00 [DBG] Static files was skipped as the request already matched an endpoint.
2022-09-23 15:38:43.204 +01:00 [INF] Entity Framework Core 6.0.9 initialized 'PostgresContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:6.0.7+5b98e4b74de93b590b44aef8dd7967c03acc433c' with options: None
2022-09-23 15:38:43.214 +01:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .FirstOrDefault(e => EF.Property<int>(e, "Id") == __p_0)'
2022-09-23 15:38:43.218 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<User>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: User.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: User.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 1], [Property: User.Email (string) Required Index MaxLength(254), 2], [Property: User.FullName (string) Required MaxLength(100), 3], [Property: User.PasswordChangedAt (DateTime) Required ValueGenerated.OnAdd, 4], [Property: User.PasswordHash (string) Required MaxLength(200), 5], [Property: User.Username (string) Required Index MaxLength(50), 6] }
        SELECT TOP(1) u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
        FROM users AS u
        WHERE u.id == @__p_0), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, User>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)
    .SingleOrDefault()'
2022-09-23 15:38:43.220 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 15:38:43.221 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2022-09-23 15:38:43.223 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 15:38:43.226 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:38:43.227 +01:00 [DBG] Executing DbCommand [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.id = @__p_0
LIMIT 1
2022-09-23 15:38:43.230 +01:00 [INF] Executed DbCommand (3ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.id = @__p_0
LIMIT 1
2022-09-23 15:38:43.232 +01:00 [DBG] Context 'PostgresContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 15:38:43.233 +01:00 [DBG] A data reader was disposed.
2022-09-23 15:38:43.233 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:38:43.234 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 15:38:43.235 +01:00 [INF] Executing endpoint 'APIBank.Controllers.AccountsController.GetAllFromUser (APIBank)'
2022-09-23 15:38:43.237 +01:00 [INF] Route matched with {action = "GetAllFromUser", controller = "Accounts"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult GetAllFromUser() on controller APIBank.Controllers.AccountsController (APIBank).
2022-09-23 15:38:43.242 +01:00 [DBG] Execution plan of authorization filters (in the following order): ["APIBank.Authorization.AuthorizeAttribute"]
2022-09-23 15:38:43.243 +01:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2022-09-23 15:38:43.244 +01:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2022-09-23 15:38:43.246 +01:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2022-09-23 15:38:43.247 +01:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2022-09-23 15:38:43.248 +01:00 [DBG] Executing controller factory for controller APIBank.Controllers.AccountsController (APIBank)
2022-09-23 15:38:43.249 +01:00 [DBG] Executed controller factory for controller APIBank.Controllers.AccountsController (APIBank)
2022-09-23 15:38:43.252 +01:00 [DBG] Compiling query expression: 
'DbSet<RefreshToken>()
    .FirstOrDefault(e => EF.Property<int>(e, "Id") == __p_0)'
2022-09-23 15:38:43.257 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<RefreshToken>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: RefreshToken.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: RefreshToken.Created (DateTime) Required, 1], [Property: RefreshToken.CreatedByIp (string) Required MaxLength(200), 2], [Property: RefreshToken.Expires (DateTime) Required, 3], [Property: RefreshToken.IsActive (no field, bool) Required, 4], [Property: RefreshToken.IsExpired (no field, bool) Required, 5], [Property: RefreshToken.IsRevoked (no field, bool) Required, 6], [Property: RefreshToken.ReasonRevoked (string) MaxLength(200), 7], [Property: RefreshToken.RefToken (string) Required MaxLength(254), 8], [Property: RefreshToken.ReplacedByToken (string) MaxLength(200), 9], [Property: RefreshToken.Revoked (DateTime?), 10], [Property: RefreshToken.RevokedByIp (string) MaxLength(200), 11], [Property: RefreshToken.UserId (int) Required FK Index, 12] }
        SELECT TOP(1) r.id, r.created, r.created_by_ip, r.expires, r.is_active, r.is_expired, r.is_revoked, r.reason_revoked, r.token, r.replaced_by_token, r.revoked, r.revoked_by_ip, r.user_id
        FROM refresh_token AS r
        WHERE r.id == @__p_0), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, RefreshToken>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)
    .SingleOrDefault()'
2022-09-23 15:38:43.260 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 15:38:43.261 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2022-09-23 15:38:43.262 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 15:38:43.263 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:38:43.263 +01:00 [DBG] Executing DbCommand [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id, r.created, r.created_by_ip, r.expires, r.is_active, r.is_expired, r.is_revoked, r.reason_revoked, r.token, r.replaced_by_token, r.revoked, r.revoked_by_ip, r.user_id
FROM refresh_token AS r
WHERE r.id = @__p_0
LIMIT 1
2022-09-23 15:38:43.266 +01:00 [INF] Executed DbCommand (3ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id, r.created, r.created_by_ip, r.expires, r.is_active, r.is_expired, r.is_revoked, r.reason_revoked, r.token, r.replaced_by_token, r.revoked, r.revoked_by_ip, r.user_id
FROM refresh_token AS r
WHERE r.id = @__p_0
LIMIT 1
2022-09-23 15:38:43.268 +01:00 [DBG] Context 'PostgresContext' started tracking 'RefreshToken' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 15:38:43.270 +01:00 [DBG] A data reader was disposed.
2022-09-23 15:38:43.270 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:38:43.272 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 15:38:43.277 +01:00 [DBG] Compiling query expression: 
'DbSet<Account>()
    .Where(u => u.UserId == __userId_0)
    .Select(u => new AccountRequestResponse{ 
        Balance = u.Balance, 
        CreatedAt = u.CreatedAt, 
        Currency = u.Currency, 
        Id = u.Id 
    }
    )'
2022-09-23 15:38:43.281 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<AccountRequestResponse>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            Balance -> 0
            CreatedAt -> 1
            Currency -> 2
            Id -> 3
        SELECT a.balance AS Balance, a.created_at AS CreatedAt, a.currency AS Currency, a.id AS Id
        FROM accounts AS a
        WHERE a.user_id == @__userId_0), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, AccountRequestResponse>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)'
2022-09-23 15:38:43.283 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 15:38:43.283 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2022-09-23 15:38:43.284 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 15:38:43.286 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:38:43.287 +01:00 [DBG] Executing DbCommand [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a.balance AS "Balance", a.created_at AS "CreatedAt", a.currency AS "Currency", a.id AS "Id"
FROM accounts AS a
WHERE a.user_id = @__userId_0
2022-09-23 15:38:43.291 +01:00 [INF] Executed DbCommand (4ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a.balance AS "Balance", a.created_at AS "CreatedAt", a.currency AS "Currency", a.id AS "Id"
FROM accounts AS a
WHERE a.user_id = @__userId_0
2022-09-23 15:38:43.299 +01:00 [DBG] A data reader was disposed.
2022-09-23 15:38:43.300 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:38:43.302 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 15:38:43.303 +01:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2022-09-23 15:38:43.307 +01:00 [DBG] No information found on request to perform content negotiation.
2022-09-23 15:38:43.308 +01:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2022-09-23 15:38:43.308 +01:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2022-09-23 15:38:43.309 +01:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2022-09-23 15:38:43.310 +01:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[APIBank.Models.Responses.AccountRequestResponse, APIBank, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2022-09-23 15:38:43.315 +01:00 [INF] Executed action APIBank.Controllers.AccountsController.GetAllFromUser (APIBank) in 67.478ms
2022-09-23 15:38:43.317 +01:00 [INF] Executed endpoint 'APIBank.Controllers.AccountsController.GetAllFromUser (APIBank)'
2022-09-23 15:38:43.318 +01:00 [DBG] Connection id "0HMKTE1QV7TFV" completed keep alive response.
2022-09-23 15:38:43.319 +01:00 [DBG] 'PostgresContext' disposed.
2022-09-23 15:38:43.320 +01:00 [INF] Request finished HTTP/1.1 GET https://localhost:7036/api/Accounts/GetAll - - - 200 - application/json;+charset=utf-8 145.3375ms
2022-09-23 15:40:08.093 +01:00 [INF] Request starting HTTP/1.1 GET https://localhost:7036/api/Accounts/GetById/?accountId=100000000 - -
2022-09-23 15:40:08.099 +01:00 [DBG] No candidates found for the request path '/api/Accounts/GetById/'
2022-09-23 15:40:08.102 +01:00 [DBG] Request did not match any endpoints
2022-09-23 15:40:08.103 +01:00 [DBG] The request path  does not match the path filter
2022-09-23 15:40:08.104 +01:00 [DBG] Connection id "0HMKTE1QV7TFV" completed keep alive response.
2022-09-23 15:40:08.105 +01:00 [INF] Request finished HTTP/1.1 GET https://localhost:7036/api/Accounts/GetById/?accountId=100000000 - - - 404 0 - 11.9854ms
2022-09-23 15:40:14.296 +01:00 [INF] Request starting HTTP/1.1 GET https://localhost:7036/api/Accounts/GetById/?accountId=100000000 - -
2022-09-23 15:40:14.298 +01:00 [DBG] No candidates found for the request path '/api/Accounts/GetById/'
2022-09-23 15:40:14.305 +01:00 [DBG] Request did not match any endpoints
2022-09-23 15:40:14.306 +01:00 [DBG] The request path  does not match the path filter
2022-09-23 15:40:14.312 +01:00 [DBG] Connection id "0HMKTE1QV7TFV" completed keep alive response.
2022-09-23 15:40:14.315 +01:00 [INF] Request finished HTTP/1.1 GET https://localhost:7036/api/Accounts/GetById/?accountId=100000000 - - - 404 0 - 18.7567ms
2022-09-23 15:40:25.943 +01:00 [INF] Request starting HTTP/1.1 GET https://localhost:7036/api/Accounts/GetById/100000000 - -
2022-09-23 15:40:25.945 +01:00 [DBG] 1 candidate(s) found for the request path '/api/Accounts/GetById/100000000'
2022-09-23 15:40:25.945 +01:00 [DBG] Endpoint 'APIBank.Controllers.AccountsController.GetById (APIBank)' with route pattern 'api/Accounts/GetById/{accountId}' is valid for the request path '/api/Accounts/GetById/100000000'
2022-09-23 15:40:25.946 +01:00 [DBG] Request matched endpoint 'APIBank.Controllers.AccountsController.GetById (APIBank)'
2022-09-23 15:40:25.949 +01:00 [DBG] Static files was skipped as the request already matched an endpoint.
2022-09-23 15:40:25.950 +01:00 [INF] Executing endpoint 'APIBank.Controllers.AccountsController.GetById (APIBank)'
2022-09-23 15:40:25.954 +01:00 [INF] Route matched with {action = "GetById", controller = "Accounts"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult GetById(Int32) on controller APIBank.Controllers.AccountsController (APIBank).
2022-09-23 15:40:25.955 +01:00 [DBG] Execution plan of authorization filters (in the following order): ["APIBank.Authorization.AuthorizeAttribute"]
2022-09-23 15:40:25.956 +01:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2022-09-23 15:40:25.957 +01:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2022-09-23 15:40:25.958 +01:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2022-09-23 15:40:25.959 +01:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2022-09-23 15:40:25.961 +01:00 [INF] Authorization failed for the request at filter 'APIBank.Authorization.AuthorizeAttribute'.
2022-09-23 15:40:25.963 +01:00 [INF] Executing JsonResult, writing value of type '<>f__AnonymousType0`1[[System.String, System.Private.CoreLib, Version=6.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2022-09-23 15:40:25.967 +01:00 [INF] Executed action APIBank.Controllers.AccountsController.GetById (APIBank) in 7.1115ms
2022-09-23 15:40:25.969 +01:00 [INF] Executed endpoint 'APIBank.Controllers.AccountsController.GetById (APIBank)'
2022-09-23 15:40:25.970 +01:00 [DBG] Connection id "0HMKTE1QV7TFV" completed keep alive response.
2022-09-23 15:40:25.971 +01:00 [INF] Request finished HTTP/1.1 GET https://localhost:7036/api/Accounts/GetById/100000000 - - - 401 - application/json;+charset=utf-8 28.0025ms
2022-09-23 15:40:32.057 +01:00 [INF] Request starting HTTP/1.1 POST https://localhost:7036/api/Users/refreshToken - 0
2022-09-23 15:40:32.061 +01:00 [DBG] 1 candidate(s) found for the request path '/api/Users/refreshToken'
2022-09-23 15:40:32.062 +01:00 [DBG] Endpoint 'APIBank.Controllers.UsersController.RefreshToken (APIBank)' with route pattern 'api/Users/refreshToken' is valid for the request path '/api/Users/refreshToken'
2022-09-23 15:40:32.063 +01:00 [DBG] Request matched endpoint 'APIBank.Controllers.UsersController.RefreshToken (APIBank)'
2022-09-23 15:40:32.063 +01:00 [DBG] Static files was skipped as the request already matched an endpoint.
2022-09-23 15:40:32.064 +01:00 [INF] Executing endpoint 'APIBank.Controllers.UsersController.RefreshToken (APIBank)'
2022-09-23 15:40:32.067 +01:00 [INF] Route matched with {action = "RefreshToken", controller = "Users"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult RefreshToken() on controller APIBank.Controllers.UsersController (APIBank).
2022-09-23 15:40:32.068 +01:00 [DBG] Execution plan of authorization filters (in the following order): ["APIBank.Authorization.AuthorizeAttribute"]
2022-09-23 15:40:32.069 +01:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2022-09-23 15:40:32.070 +01:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2022-09-23 15:40:32.072 +01:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2022-09-23 15:40:32.073 +01:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2022-09-23 15:40:32.074 +01:00 [DBG] Executing controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-23 15:40:32.075 +01:00 [DBG] Executed controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-23 15:40:32.124 +01:00 [INF] Entity Framework Core 6.0.9 initialized 'PostgresContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:6.0.7+5b98e4b74de93b590b44aef8dd7967c03acc433c' with options: None
2022-09-23 15:40:32.130 +01:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .SingleOrDefault(userQuery => userQuery.RefreshTokenCollection
        .Any(refTokenQuery => refTokenQuery.RefToken == __refToken_0))'
2022-09-23 15:40:32.134 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<User>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: User.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: User.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 1], [Property: User.Email (string) Required Index MaxLength(254), 2], [Property: User.FullName (string) Required MaxLength(100), 3], [Property: User.PasswordChangedAt (DateTime) Required ValueGenerated.OnAdd, 4], [Property: User.PasswordHash (string) Required MaxLength(200), 5], [Property: User.Username (string) Required Index MaxLength(50), 6] }
        SELECT TOP(2) u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
        FROM users AS u
        WHERE EXISTS (
            SELECT 1
            FROM refresh_token AS r
            WHERE ((u.id != NULL) && (u.id == r.user_id)) && (r.token == @__refToken_0))), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, User>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)
    .SingleOrDefault()'
2022-09-23 15:40:32.136 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 15:40:32.137 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2022-09-23 15:40:32.137 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 15:40:32.138 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:40:32.139 +01:00 [DBG] Executing DbCommand [Parameters=[@__refToken_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE EXISTS (
    SELECT 1
    FROM refresh_token AS r
    WHERE (u.id = r.user_id) AND (r.token = @__refToken_0))
LIMIT 2
2022-09-23 15:40:32.141 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[@__refToken_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE EXISTS (
    SELECT 1
    FROM refresh_token AS r
    WHERE (u.id = r.user_id) AND (r.token = @__refToken_0))
LIMIT 2
2022-09-23 15:40:32.146 +01:00 [DBG] Context 'PostgresContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 15:40:32.147 +01:00 [DBG] A data reader was disposed.
2022-09-23 15:40:32.147 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:40:32.148 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 15:40:32.151 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 15:40:32.152 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2022-09-23 15:40:32.152 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 15:40:32.153 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:40:32.154 +01:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.user_id AS "UserId", r.token AS "RefToken", r.expires AS "Expires", r.created AS "Created", r.created_by_ip AS "CreatedByIp", r.revoked AS "Revoked", r.revoked_by_ip AS "RevokedByIp", r.replaced_by_token AS "ReplacedByToken", r.reason_revoked AS "ReasonRevoked", r.is_expired AS "IsExpired", r.is_revoked AS "IsRevoked", r.is_active AS "IsActive"
FROM refresh_token AS r
WHERE r.user_id = @__id_0
2022-09-23 15:40:32.156 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.user_id AS "UserId", r.token AS "RefToken", r.expires AS "Expires", r.created AS "Created", r.created_by_ip AS "CreatedByIp", r.revoked AS "Revoked", r.revoked_by_ip AS "RevokedByIp", r.replaced_by_token AS "ReplacedByToken", r.reason_revoked AS "ReasonRevoked", r.is_expired AS "IsExpired", r.is_revoked AS "IsRevoked", r.is_active AS "IsActive"
FROM refresh_token AS r
WHERE r.user_id = @__id_0
2022-09-23 15:40:32.158 +01:00 [DBG] A data reader was disposed.
2022-09-23 15:40:32.161 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:40:32.162 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 15:40:32.164 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 15:40:32.165 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2022-09-23 15:40:32.165 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 15:40:32.166 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:40:32.167 +01:00 [DBG] Executing DbCommand [Parameters=[@__token_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM users AS u
    WHERE EXISTS (
        SELECT 1
        FROM refresh_token AS r
        WHERE (u.id = r.user_id) AND (r.token = @__token_0)))
2022-09-23 15:40:32.169 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[@__token_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM users AS u
    WHERE EXISTS (
        SELECT 1
        FROM refresh_token AS r
        WHERE (u.id = r.user_id) AND (r.token = @__token_0)))
2022-09-23 15:40:32.171 +01:00 [DBG] A data reader was disposed.
2022-09-23 15:40:32.171 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:40:32.172 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 15:40:32.174 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 15:40:32.177 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (3ms).
2022-09-23 15:40:32.179 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 15:40:32.180 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:40:32.181 +01:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.user_id AS "UserId", r.token AS "RefToken", r.expires AS "Expires", r.created AS "Created", r.created_by_ip AS "CreatedByIp", r.revoked AS "Revoked", r.revoked_by_ip AS "RevokedByIp", r.replaced_by_token AS "ReplacedByToken", r.reason_revoked AS "ReasonRevoked", r.is_expired AS "IsExpired", r.is_revoked AS "IsRevoked", r.is_active AS "IsActive"
FROM refresh_token AS r
WHERE r.user_id = @__id_0
2022-09-23 15:40:32.183 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.user_id AS "UserId", r.token AS "RefToken", r.expires AS "Expires", r.created AS "Created", r.created_by_ip AS "CreatedByIp", r.revoked AS "Revoked", r.revoked_by_ip AS "RevokedByIp", r.replaced_by_token AS "ReplacedByToken", r.reason_revoked AS "ReasonRevoked", r.is_expired AS "IsExpired", r.is_revoked AS "IsRevoked", r.is_active AS "IsActive"
FROM refresh_token AS r
WHERE r.user_id = @__id_0
2022-09-23 15:40:32.185 +01:00 [DBG] A data reader was disposed.
2022-09-23 15:40:32.185 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:40:32.186 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 15:40:32.187 +01:00 [DBG] An entity of type 'User' tracked by 'PostgresContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 15:40:32.188 +01:00 [DBG] SaveChanges starting for 'PostgresContext'.
2022-09-23 15:40:32.191 +01:00 [DBG] DetectChanges starting for 'PostgresContext'.
2022-09-23 15:40:32.193 +01:00 [DBG] 1 entities were added and 0 entities were removed from navigation 'User.RefreshTokenCollection'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 15:40:32.195 +01:00 [DBG] 'PostgresContext' generated a temporary value for the property 'Id.RefreshToken'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 15:40:32.197 +01:00 [DBG] Context 'PostgresContext' started tracking 'RefreshToken' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 15:40:32.198 +01:00 [DBG] DetectChanges completed for 'PostgresContext'.
2022-09-23 15:40:32.201 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 15:40:32.202 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:40:32.203 +01:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2022-09-23 15:40:32.204 +01:00 [DBG] Began transaction with isolation level 'ReadCommitted'.
2022-09-23 15:40:32.205 +01:00 [DBG] Executing 2 update commands as a batch.
2022-09-23 15:40:32.207 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 15:40:32.209 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2022-09-23 15:40:32.211 +01:00 [DBG] Executing DbCommand [Parameters=[@p0='?' (DbType = DateTime), @p1='?', @p2='?' (DbType = DateTime), @p3='?' (DbType = Boolean), @p4='?' (DbType = Boolean), @p5='?' (DbType = Boolean), @p6='?', @p7='?', @p8='?', @p9='?' (DbType = DateTime), @p10='?', @p11='?' (DbType = Int32), @p18='?' (DbType = Int32), @p12='?' (DbType = DateTime), @p13='?', @p14='?', @p15='?' (DbType = DateTime), @p16='?', @p17='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO refresh_token (created, created_by_ip, expires, is_active, is_expired, is_revoked, reason_revoked, token, replaced_by_token, revoked, revoked_by_ip, user_id)
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11)
RETURNING id;
UPDATE users SET created_at = @p12, email = @p13, full_name = @p14, password_changed_at = @p15, password_hash = @p16, username = @p17
WHERE id = @p18;
2022-09-23 15:40:32.215 +01:00 [INF] Executed DbCommand (3ms) [Parameters=[@p0='?' (DbType = DateTime), @p1='?', @p2='?' (DbType = DateTime), @p3='?' (DbType = Boolean), @p4='?' (DbType = Boolean), @p5='?' (DbType = Boolean), @p6='?', @p7='?', @p8='?', @p9='?' (DbType = DateTime), @p10='?', @p11='?' (DbType = Int32), @p18='?' (DbType = Int32), @p12='?' (DbType = DateTime), @p13='?', @p14='?', @p15='?' (DbType = DateTime), @p16='?', @p17='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO refresh_token (created, created_by_ip, expires, is_active, is_expired, is_revoked, reason_revoked, token, replaced_by_token, revoked, revoked_by_ip, user_id)
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11)
RETURNING id;
UPDATE users SET created_at = @p12, email = @p13, full_name = @p14, password_changed_at = @p15, password_hash = @p16, username = @p17
WHERE id = @p18;
2022-09-23 15:40:32.217 +01:00 [DBG] The foreign key property 'RefreshToken.Id' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2022-09-23 15:40:32.218 +01:00 [DBG] A data reader was disposed.
2022-09-23 15:40:32.219 +01:00 [DBG] Committing transaction.
2022-09-23 15:40:32.220 +01:00 [DBG] Committed transaction.
2022-09-23 15:40:32.222 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:40:32.223 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 15:40:32.224 +01:00 [DBG] Disposing transaction.
2022-09-23 15:40:32.226 +01:00 [DBG] An entity of type 'RefreshToken' tracked by 'PostgresContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 15:40:32.228 +01:00 [DBG] An entity of type 'User' tracked by 'PostgresContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 15:40:32.230 +01:00 [DBG] SaveChanges completed for 'PostgresContext' with 2 entities written to the database.
2022-09-23 15:40:32.231 +01:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2022-09-23 15:40:32.233 +01:00 [DBG] No information found on request to perform content negotiation.
2022-09-23 15:40:32.233 +01:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2022-09-23 15:40:32.234 +01:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2022-09-23 15:40:32.234 +01:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2022-09-23 15:40:32.235 +01:00 [INF] Executing OkObjectResult, writing value of type 'APIBank.Models.MyRequestResponses.LoginResponse'.
2022-09-23 15:40:32.238 +01:00 [INF] Executed action APIBank.Controllers.UsersController.RefreshToken (APIBank) in 164.3318ms
2022-09-23 15:40:32.239 +01:00 [INF] Executed endpoint 'APIBank.Controllers.UsersController.RefreshToken (APIBank)'
2022-09-23 15:40:32.240 +01:00 [DBG] Connection id "0HMKTE1QV7TFV" completed keep alive response.
2022-09-23 15:40:32.241 +01:00 [DBG] 'PostgresContext' disposed.
2022-09-23 15:40:32.243 +01:00 [INF] Request finished HTTP/1.1 POST https://localhost:7036/api/Users/refreshToken - 0 - 200 - application/json;+charset=utf-8 186.4278ms
2022-09-23 15:40:45.735 +01:00 [INF] Request starting HTTP/1.1 GET https://localhost:7036/api/Accounts/GetById/100000000 - -
2022-09-23 15:40:45.738 +01:00 [DBG] 1 candidate(s) found for the request path '/api/Accounts/GetById/100000000'
2022-09-23 15:40:45.739 +01:00 [DBG] Endpoint 'APIBank.Controllers.AccountsController.GetById (APIBank)' with route pattern 'api/Accounts/GetById/{accountId}' is valid for the request path '/api/Accounts/GetById/100000000'
2022-09-23 15:40:45.740 +01:00 [DBG] Request matched endpoint 'APIBank.Controllers.AccountsController.GetById (APIBank)'
2022-09-23 15:40:45.741 +01:00 [DBG] Static files was skipped as the request already matched an endpoint.
2022-09-23 15:40:45.743 +01:00 [INF] Entity Framework Core 6.0.9 initialized 'PostgresContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:6.0.7+5b98e4b74de93b590b44aef8dd7967c03acc433c' with options: None
2022-09-23 15:40:45.745 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 15:40:45.746 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2022-09-23 15:40:45.747 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 15:40:45.749 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:40:45.750 +01:00 [DBG] Executing DbCommand [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.id = @__p_0
LIMIT 1
2022-09-23 15:40:45.751 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.id = @__p_0
LIMIT 1
2022-09-23 15:40:45.753 +01:00 [DBG] Context 'PostgresContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 15:40:45.754 +01:00 [DBG] A data reader was disposed.
2022-09-23 15:40:45.754 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:40:45.755 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 15:40:45.756 +01:00 [INF] Executing endpoint 'APIBank.Controllers.AccountsController.GetById (APIBank)'
2022-09-23 15:40:45.757 +01:00 [INF] Route matched with {action = "GetById", controller = "Accounts"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult GetById(Int32) on controller APIBank.Controllers.AccountsController (APIBank).
2022-09-23 15:40:45.758 +01:00 [DBG] Execution plan of authorization filters (in the following order): ["APIBank.Authorization.AuthorizeAttribute"]
2022-09-23 15:40:45.760 +01:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2022-09-23 15:40:45.761 +01:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2022-09-23 15:40:45.763 +01:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2022-09-23 15:40:45.766 +01:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2022-09-23 15:40:45.767 +01:00 [DBG] Executing controller factory for controller APIBank.Controllers.AccountsController (APIBank)
2022-09-23 15:40:45.768 +01:00 [DBG] Executed controller factory for controller APIBank.Controllers.AccountsController (APIBank)
2022-09-23 15:40:45.769 +01:00 [DBG] Attempting to bind parameter 'accountId' of type 'System.Int32' ...
2022-09-23 15:40:45.771 +01:00 [DBG] Attempting to bind parameter 'accountId' of type 'System.Int32' using the name 'accountId' in request data ...
2022-09-23 15:40:45.772 +01:00 [DBG] Done attempting to bind parameter 'accountId' of type 'System.Int32'.
2022-09-23 15:40:45.773 +01:00 [DBG] Done attempting to bind parameter 'accountId' of type 'System.Int32'.
2022-09-23 15:40:45.775 +01:00 [DBG] Attempting to validate the bound parameter 'accountId' of type 'System.Int32' ...
2022-09-23 15:40:45.776 +01:00 [DBG] Done attempting to validate the bound parameter 'accountId' of type 'System.Int32'.
2022-09-23 15:40:45.778 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 15:40:45.779 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2022-09-23 15:40:45.781 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 15:40:45.782 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:40:45.783 +01:00 [DBG] Executing DbCommand [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id, r.created, r.created_by_ip, r.expires, r.is_active, r.is_expired, r.is_revoked, r.reason_revoked, r.token, r.replaced_by_token, r.revoked, r.revoked_by_ip, r.user_id
FROM refresh_token AS r
WHERE r.id = @__p_0
LIMIT 1
2022-09-23 15:40:45.785 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id, r.created, r.created_by_ip, r.expires, r.is_active, r.is_expired, r.is_revoked, r.reason_revoked, r.token, r.replaced_by_token, r.revoked, r.revoked_by_ip, r.user_id
FROM refresh_token AS r
WHERE r.id = @__p_0
LIMIT 1
2022-09-23 15:40:45.787 +01:00 [DBG] Context 'PostgresContext' started tracking 'RefreshToken' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 15:40:45.788 +01:00 [DBG] A data reader was disposed.
2022-09-23 15:40:45.788 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:40:45.789 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 15:40:45.794 +01:00 [DBG] Compiling query expression: 
'DbSet<Account>()
    .Include(a => a.Transactions)
    .Where(a => a.Id == __accountId_0 && a.UserId == __userId_1)
    .Select(a => new AccountMovims{ 
        Account = new AccountRequestResponse{ 
            Balance = a.Balance, 
            Currency = a.Currency, 
            CreatedAt = a.CreatedAt, 
            Id = a.Id 
        }
        , 
        Movims = a.Transactions
            .Select(b => new Movim{ 
                Amount = b.Amount, 
                CreatedAt = b.CreatedAt 
            }
            )
            .ToArray() 
    }
    )
    .SingleOrDefault()'
2022-09-23 15:40:45.860 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<AccountMovims>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Client Projections:
            0 -> 0
            1 -> 1
            2 -> 2
            3 -> 3
            4 -> 4
            5 -> 5
            6 -> 6
        SELECT t.balance, t.currency, t.created_at, t.id, t0.amount, t0.created_at, t0.id
        FROM 
        (
            SELECT TOP(2) a.balance, a.currency, a.created_at, a.id
            FROM accounts AS a
            WHERE (a.id == @__accountId_0) && (a.user_id == @__userId_1)
        ) AS t
        LEFT JOIN transactions AS t0 ON t.id == t0.account_id
        ORDER BY t.id ASC), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, AccountMovims>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)
    .SingleOrDefault()'
2022-09-23 15:40:45.865 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 15:40:45.866 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2022-09-23 15:40:45.867 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 15:40:45.868 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:40:45.872 +01:00 [DBG] Executing DbCommand [Parameters=[@__accountId_0='?' (DbType = Int32), @__userId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT t.balance, t.currency, t.created_at, t.id, t0.amount, t0.created_at, t0.id
FROM (
    SELECT a.balance, a.currency, a.created_at, a.id
    FROM accounts AS a
    WHERE (a.id = @__accountId_0) AND (a.user_id = @__userId_1)
    LIMIT 2
) AS t
LEFT JOIN transactions AS t0 ON t.id = t0.account_id
ORDER BY t.id
2022-09-23 15:40:45.875 +01:00 [INF] Executed DbCommand (3ms) [Parameters=[@__accountId_0='?' (DbType = Int32), @__userId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT t.balance, t.currency, t.created_at, t.id, t0.amount, t0.created_at, t0.id
FROM (
    SELECT a.balance, a.currency, a.created_at, a.id
    FROM accounts AS a
    WHERE (a.id = @__accountId_0) AND (a.user_id = @__userId_1)
    LIMIT 2
) AS t
LEFT JOIN transactions AS t0 ON t.id = t0.account_id
ORDER BY t.id
2022-09-23 15:40:45.879 +01:00 [DBG] A data reader was disposed.
2022-09-23 15:40:45.881 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:40:45.882 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 15:40:45.883 +01:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2022-09-23 15:40:45.886 +01:00 [DBG] No information found on request to perform content negotiation.
2022-09-23 15:40:45.887 +01:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2022-09-23 15:40:45.888 +01:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2022-09-23 15:40:45.888 +01:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2022-09-23 15:40:45.889 +01:00 [INF] Executing OkObjectResult, writing value of type 'APIBank.Models.Responses.AccountMovims'.
2022-09-23 15:40:45.892 +01:00 [INF] Executed action APIBank.Controllers.AccountsController.GetById (APIBank) in 124.7218ms
2022-09-23 15:40:45.893 +01:00 [INF] Executed endpoint 'APIBank.Controllers.AccountsController.GetById (APIBank)'
2022-09-23 15:40:45.894 +01:00 [DBG] Connection id "0HMKTE1QV7TFV" completed keep alive response.
2022-09-23 15:40:45.895 +01:00 [DBG] 'PostgresContext' disposed.
2022-09-23 15:40:45.895 +01:00 [INF] Request finished HTTP/1.1 GET https://localhost:7036/api/Accounts/GetById/100000000 - - - 200 - application/json;+charset=utf-8 160.6935ms
2022-09-23 15:41:55.348 +01:00 [INF] Request starting HTTP/1.1 GET https://localhost:7036/api/Users/1/refresh-tokens - -
2022-09-23 15:41:55.351 +01:00 [DBG] 1 candidate(s) found for the request path '/api/Users/1/refresh-tokens'
2022-09-23 15:41:55.355 +01:00 [DBG] Endpoint 'APIBank.Controllers.UsersController.GetRefreshTokens (APIBank)' with route pattern 'api/Users/{id}/refresh-tokens' is valid for the request path '/api/Users/1/refresh-tokens'
2022-09-23 15:41:55.357 +01:00 [DBG] Request matched endpoint 'APIBank.Controllers.UsersController.GetRefreshTokens (APIBank)'
2022-09-23 15:41:55.358 +01:00 [DBG] Static files was skipped as the request already matched an endpoint.
2022-09-23 15:41:55.359 +01:00 [INF] Executing endpoint 'APIBank.Controllers.UsersController.GetRefreshTokens (APIBank)'
2022-09-23 15:41:55.361 +01:00 [INF] Route matched with {action = "GetRefreshTokens", controller = "Users"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult GetRefreshTokens(Int32) on controller APIBank.Controllers.UsersController (APIBank).
2022-09-23 15:41:55.363 +01:00 [DBG] Execution plan of authorization filters (in the following order): ["APIBank.Authorization.AuthorizeAttribute"]
2022-09-23 15:41:55.364 +01:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2022-09-23 15:41:55.365 +01:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2022-09-23 15:41:55.366 +01:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2022-09-23 15:41:55.368 +01:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2022-09-23 15:41:55.373 +01:00 [INF] Authorization failed for the request at filter 'APIBank.Authorization.AuthorizeAttribute'.
2022-09-23 15:41:55.374 +01:00 [INF] Executing JsonResult, writing value of type '<>f__AnonymousType0`1[[System.String, System.Private.CoreLib, Version=6.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2022-09-23 15:41:55.375 +01:00 [INF] Executed action APIBank.Controllers.UsersController.GetRefreshTokens (APIBank) in 1.9396ms
2022-09-23 15:41:55.376 +01:00 [INF] Executed endpoint 'APIBank.Controllers.UsersController.GetRefreshTokens (APIBank)'
2022-09-23 15:41:55.377 +01:00 [DBG] Connection id "0HMKTE1QV7TFV" completed keep alive response.
2022-09-23 15:41:55.378 +01:00 [INF] Request finished HTTP/1.1 GET https://localhost:7036/api/Users/1/refresh-tokens - - - 401 - application/json;+charset=utf-8 29.6260ms
2022-09-23 15:42:00.039 +01:00 [INF] Request starting HTTP/1.1 POST https://localhost:7036/api/Users/refreshToken - 0
2022-09-23 15:42:00.041 +01:00 [DBG] 1 candidate(s) found for the request path '/api/Users/refreshToken'
2022-09-23 15:42:00.042 +01:00 [DBG] Endpoint 'APIBank.Controllers.UsersController.RefreshToken (APIBank)' with route pattern 'api/Users/refreshToken' is valid for the request path '/api/Users/refreshToken'
2022-09-23 15:42:00.052 +01:00 [DBG] Request matched endpoint 'APIBank.Controllers.UsersController.RefreshToken (APIBank)'
2022-09-23 15:42:00.054 +01:00 [DBG] Static files was skipped as the request already matched an endpoint.
2022-09-23 15:42:00.056 +01:00 [INF] Executing endpoint 'APIBank.Controllers.UsersController.RefreshToken (APIBank)'
2022-09-23 15:42:00.057 +01:00 [INF] Route matched with {action = "RefreshToken", controller = "Users"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult RefreshToken() on controller APIBank.Controllers.UsersController (APIBank).
2022-09-23 15:42:00.060 +01:00 [DBG] Execution plan of authorization filters (in the following order): ["APIBank.Authorization.AuthorizeAttribute"]
2022-09-23 15:42:00.061 +01:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2022-09-23 15:42:00.063 +01:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2022-09-23 15:42:00.065 +01:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2022-09-23 15:42:00.067 +01:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2022-09-23 15:42:00.069 +01:00 [DBG] Executing controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-23 15:42:00.070 +01:00 [DBG] Executed controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-23 15:42:00.072 +01:00 [INF] Entity Framework Core 6.0.9 initialized 'PostgresContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:6.0.7+5b98e4b74de93b590b44aef8dd7967c03acc433c' with options: None
2022-09-23 15:42:00.075 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 15:42:00.076 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2022-09-23 15:42:00.077 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 15:42:00.078 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:42:00.079 +01:00 [DBG] Executing DbCommand [Parameters=[@__refToken_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE EXISTS (
    SELECT 1
    FROM refresh_token AS r
    WHERE (u.id = r.user_id) AND (r.token = @__refToken_0))
LIMIT 2
2022-09-23 15:42:00.084 +01:00 [INF] Executed DbCommand (5ms) [Parameters=[@__refToken_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE EXISTS (
    SELECT 1
    FROM refresh_token AS r
    WHERE (u.id = r.user_id) AND (r.token = @__refToken_0))
LIMIT 2
2022-09-23 15:42:00.087 +01:00 [DBG] Context 'PostgresContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 15:42:00.088 +01:00 [DBG] A data reader was disposed.
2022-09-23 15:42:00.089 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:42:00.091 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 15:42:00.093 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 15:42:00.094 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2022-09-23 15:42:00.095 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 15:42:00.096 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:42:00.098 +01:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.user_id AS "UserId", r.token AS "RefToken", r.expires AS "Expires", r.created AS "Created", r.created_by_ip AS "CreatedByIp", r.revoked AS "Revoked", r.revoked_by_ip AS "RevokedByIp", r.replaced_by_token AS "ReplacedByToken", r.reason_revoked AS "ReasonRevoked", r.is_expired AS "IsExpired", r.is_revoked AS "IsRevoked", r.is_active AS "IsActive"
FROM refresh_token AS r
WHERE r.user_id = @__id_0
2022-09-23 15:42:00.101 +01:00 [INF] Executed DbCommand (4ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.user_id AS "UserId", r.token AS "RefToken", r.expires AS "Expires", r.created AS "Created", r.created_by_ip AS "CreatedByIp", r.revoked AS "Revoked", r.revoked_by_ip AS "RevokedByIp", r.replaced_by_token AS "ReplacedByToken", r.reason_revoked AS "ReasonRevoked", r.is_expired AS "IsExpired", r.is_revoked AS "IsRevoked", r.is_active AS "IsActive"
FROM refresh_token AS r
WHERE r.user_id = @__id_0
2022-09-23 15:42:00.104 +01:00 [DBG] A data reader was disposed.
2022-09-23 15:42:00.104 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:42:00.105 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 15:42:00.109 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 15:42:00.110 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2022-09-23 15:42:00.111 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 15:42:00.112 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:42:00.113 +01:00 [DBG] Executing DbCommand [Parameters=[@__token_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM users AS u
    WHERE EXISTS (
        SELECT 1
        FROM refresh_token AS r
        WHERE (u.id = r.user_id) AND (r.token = @__token_0)))
2022-09-23 15:42:00.116 +01:00 [INF] Executed DbCommand (3ms) [Parameters=[@__token_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM users AS u
    WHERE EXISTS (
        SELECT 1
        FROM refresh_token AS r
        WHERE (u.id = r.user_id) AND (r.token = @__token_0)))
2022-09-23 15:42:00.118 +01:00 [DBG] A data reader was disposed.
2022-09-23 15:42:00.119 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:42:00.120 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 15:42:00.123 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 15:42:00.124 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2022-09-23 15:42:00.125 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 15:42:00.126 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:42:00.127 +01:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.user_id AS "UserId", r.token AS "RefToken", r.expires AS "Expires", r.created AS "Created", r.created_by_ip AS "CreatedByIp", r.revoked AS "Revoked", r.revoked_by_ip AS "RevokedByIp", r.replaced_by_token AS "ReplacedByToken", r.reason_revoked AS "ReasonRevoked", r.is_expired AS "IsExpired", r.is_revoked AS "IsRevoked", r.is_active AS "IsActive"
FROM refresh_token AS r
WHERE r.user_id = @__id_0
2022-09-23 15:42:00.130 +01:00 [INF] Executed DbCommand (3ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.user_id AS "UserId", r.token AS "RefToken", r.expires AS "Expires", r.created AS "Created", r.created_by_ip AS "CreatedByIp", r.revoked AS "Revoked", r.revoked_by_ip AS "RevokedByIp", r.replaced_by_token AS "ReplacedByToken", r.reason_revoked AS "ReasonRevoked", r.is_expired AS "IsExpired", r.is_revoked AS "IsRevoked", r.is_active AS "IsActive"
FROM refresh_token AS r
WHERE r.user_id = @__id_0
2022-09-23 15:42:00.133 +01:00 [DBG] A data reader was disposed.
2022-09-23 15:42:00.133 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:42:00.134 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 15:42:00.136 +01:00 [DBG] An entity of type 'User' tracked by 'PostgresContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 15:42:00.138 +01:00 [DBG] SaveChanges starting for 'PostgresContext'.
2022-09-23 15:42:00.138 +01:00 [DBG] DetectChanges starting for 'PostgresContext'.
2022-09-23 15:42:00.139 +01:00 [DBG] 1 entities were added and 0 entities were removed from navigation 'User.RefreshTokenCollection'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 15:42:00.140 +01:00 [DBG] 'PostgresContext' generated a temporary value for the property 'Id.RefreshToken'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 15:42:00.142 +01:00 [DBG] Context 'PostgresContext' started tracking 'RefreshToken' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 15:42:00.143 +01:00 [DBG] DetectChanges completed for 'PostgresContext'.
2022-09-23 15:42:00.144 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 15:42:00.145 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:42:00.146 +01:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2022-09-23 15:42:00.146 +01:00 [DBG] Began transaction with isolation level 'ReadCommitted'.
2022-09-23 15:42:00.148 +01:00 [DBG] Executing 2 update commands as a batch.
2022-09-23 15:42:00.150 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 15:42:00.151 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2022-09-23 15:42:00.154 +01:00 [DBG] Executing DbCommand [Parameters=[@p0='?' (DbType = DateTime), @p1='?', @p2='?' (DbType = DateTime), @p3='?' (DbType = Boolean), @p4='?' (DbType = Boolean), @p5='?' (DbType = Boolean), @p6='?', @p7='?', @p8='?', @p9='?' (DbType = DateTime), @p10='?', @p11='?' (DbType = Int32), @p18='?' (DbType = Int32), @p12='?' (DbType = DateTime), @p13='?', @p14='?', @p15='?' (DbType = DateTime), @p16='?', @p17='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO refresh_token (created, created_by_ip, expires, is_active, is_expired, is_revoked, reason_revoked, token, replaced_by_token, revoked, revoked_by_ip, user_id)
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11)
RETURNING id;
UPDATE users SET created_at = @p12, email = @p13, full_name = @p14, password_changed_at = @p15, password_hash = @p16, username = @p17
WHERE id = @p18;
2022-09-23 15:42:00.158 +01:00 [INF] Executed DbCommand (4ms) [Parameters=[@p0='?' (DbType = DateTime), @p1='?', @p2='?' (DbType = DateTime), @p3='?' (DbType = Boolean), @p4='?' (DbType = Boolean), @p5='?' (DbType = Boolean), @p6='?', @p7='?', @p8='?', @p9='?' (DbType = DateTime), @p10='?', @p11='?' (DbType = Int32), @p18='?' (DbType = Int32), @p12='?' (DbType = DateTime), @p13='?', @p14='?', @p15='?' (DbType = DateTime), @p16='?', @p17='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO refresh_token (created, created_by_ip, expires, is_active, is_expired, is_revoked, reason_revoked, token, replaced_by_token, revoked, revoked_by_ip, user_id)
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11)
RETURNING id;
UPDATE users SET created_at = @p12, email = @p13, full_name = @p14, password_changed_at = @p15, password_hash = @p16, username = @p17
WHERE id = @p18;
2022-09-23 15:42:00.161 +01:00 [DBG] The foreign key property 'RefreshToken.Id' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2022-09-23 15:42:00.162 +01:00 [DBG] A data reader was disposed.
2022-09-23 15:42:00.162 +01:00 [DBG] Committing transaction.
2022-09-23 15:42:00.165 +01:00 [DBG] Committed transaction.
2022-09-23 15:42:00.166 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:42:00.168 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 15:42:00.169 +01:00 [DBG] Disposing transaction.
2022-09-23 15:42:00.170 +01:00 [DBG] An entity of type 'RefreshToken' tracked by 'PostgresContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 15:42:00.171 +01:00 [DBG] An entity of type 'User' tracked by 'PostgresContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 15:42:00.173 +01:00 [DBG] SaveChanges completed for 'PostgresContext' with 2 entities written to the database.
2022-09-23 15:42:00.174 +01:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2022-09-23 15:42:00.176 +01:00 [DBG] No information found on request to perform content negotiation.
2022-09-23 15:42:00.177 +01:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2022-09-23 15:42:00.178 +01:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2022-09-23 15:42:00.178 +01:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2022-09-23 15:42:00.179 +01:00 [INF] Executing OkObjectResult, writing value of type 'APIBank.Models.MyRequestResponses.LoginResponse'.
2022-09-23 15:42:00.182 +01:00 [INF] Executed action APIBank.Controllers.UsersController.RefreshToken (APIBank) in 113.1001ms
2022-09-23 15:42:00.184 +01:00 [INF] Executed endpoint 'APIBank.Controllers.UsersController.RefreshToken (APIBank)'
2022-09-23 15:42:00.186 +01:00 [DBG] Connection id "0HMKTE1QV7TFV" completed keep alive response.
2022-09-23 15:42:00.187 +01:00 [DBG] 'PostgresContext' disposed.
2022-09-23 15:42:00.188 +01:00 [INF] Request finished HTTP/1.1 POST https://localhost:7036/api/Users/refreshToken - 0 - 200 - application/json;+charset=utf-8 148.9327ms
2022-09-23 15:42:14.895 +01:00 [INF] Request starting HTTP/1.1 GET https://localhost:7036/api/Users/1/refresh-tokens - -
2022-09-23 15:42:14.897 +01:00 [DBG] 1 candidate(s) found for the request path '/api/Users/1/refresh-tokens'
2022-09-23 15:42:14.899 +01:00 [DBG] Endpoint 'APIBank.Controllers.UsersController.GetRefreshTokens (APIBank)' with route pattern 'api/Users/{id}/refresh-tokens' is valid for the request path '/api/Users/1/refresh-tokens'
2022-09-23 15:42:14.900 +01:00 [DBG] Request matched endpoint 'APIBank.Controllers.UsersController.GetRefreshTokens (APIBank)'
2022-09-23 15:42:14.903 +01:00 [DBG] Static files was skipped as the request already matched an endpoint.
2022-09-23 15:42:14.905 +01:00 [INF] Executing endpoint 'APIBank.Controllers.UsersController.GetRefreshTokens (APIBank)'
2022-09-23 15:42:14.905 +01:00 [INF] Route matched with {action = "GetRefreshTokens", controller = "Users"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult GetRefreshTokens(Int32) on controller APIBank.Controllers.UsersController (APIBank).
2022-09-23 15:42:14.907 +01:00 [DBG] Execution plan of authorization filters (in the following order): ["APIBank.Authorization.AuthorizeAttribute"]
2022-09-23 15:42:14.908 +01:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2022-09-23 15:42:14.909 +01:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2022-09-23 15:42:14.910 +01:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2022-09-23 15:42:14.911 +01:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2022-09-23 15:42:14.912 +01:00 [INF] Authorization failed for the request at filter 'APIBank.Authorization.AuthorizeAttribute'.
2022-09-23 15:42:14.912 +01:00 [INF] Executing JsonResult, writing value of type '<>f__AnonymousType0`1[[System.String, System.Private.CoreLib, Version=6.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2022-09-23 15:42:14.913 +01:00 [INF] Executed action APIBank.Controllers.UsersController.GetRefreshTokens (APIBank) in 1.6056ms
2022-09-23 15:42:14.914 +01:00 [INF] Executed endpoint 'APIBank.Controllers.UsersController.GetRefreshTokens (APIBank)'
2022-09-23 15:42:14.915 +01:00 [DBG] Connection id "0HMKTE1QV7TFV" completed keep alive response.
2022-09-23 15:42:14.916 +01:00 [INF] Request finished HTTP/1.1 GET https://localhost:7036/api/Users/1/refresh-tokens - - - 401 - application/json;+charset=utf-8 21.2870ms
2022-09-23 15:42:17.139 +01:00 [INF] Request starting HTTP/1.1 GET https://localhost:7036/api/Users/1/refresh-tokens - -
2022-09-23 15:42:17.140 +01:00 [DBG] 1 candidate(s) found for the request path '/api/Users/1/refresh-tokens'
2022-09-23 15:42:17.141 +01:00 [DBG] Endpoint 'APIBank.Controllers.UsersController.GetRefreshTokens (APIBank)' with route pattern 'api/Users/{id}/refresh-tokens' is valid for the request path '/api/Users/1/refresh-tokens'
2022-09-23 15:42:17.143 +01:00 [DBG] Request matched endpoint 'APIBank.Controllers.UsersController.GetRefreshTokens (APIBank)'
2022-09-23 15:42:17.144 +01:00 [DBG] Static files was skipped as the request already matched an endpoint.
2022-09-23 15:42:17.145 +01:00 [INF] Executing endpoint 'APIBank.Controllers.UsersController.GetRefreshTokens (APIBank)'
2022-09-23 15:42:17.146 +01:00 [INF] Route matched with {action = "GetRefreshTokens", controller = "Users"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult GetRefreshTokens(Int32) on controller APIBank.Controllers.UsersController (APIBank).
2022-09-23 15:42:17.151 +01:00 [DBG] Execution plan of authorization filters (in the following order): ["APIBank.Authorization.AuthorizeAttribute"]
2022-09-23 15:42:17.152 +01:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2022-09-23 15:42:17.154 +01:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2022-09-23 15:42:17.156 +01:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2022-09-23 15:42:17.157 +01:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2022-09-23 15:42:17.158 +01:00 [INF] Authorization failed for the request at filter 'APIBank.Authorization.AuthorizeAttribute'.
2022-09-23 15:42:17.159 +01:00 [INF] Executing JsonResult, writing value of type '<>f__AnonymousType0`1[[System.String, System.Private.CoreLib, Version=6.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2022-09-23 15:42:17.161 +01:00 [INF] Executed action APIBank.Controllers.UsersController.GetRefreshTokens (APIBank) in 2.3237ms
2022-09-23 15:42:17.162 +01:00 [INF] Executed endpoint 'APIBank.Controllers.UsersController.GetRefreshTokens (APIBank)'
2022-09-23 15:42:17.163 +01:00 [DBG] Connection id "0HMKTE1QV7TFV" completed keep alive response.
2022-09-23 15:42:17.167 +01:00 [INF] Request finished HTTP/1.1 GET https://localhost:7036/api/Users/1/refresh-tokens - - - 401 - application/json;+charset=utf-8 27.5615ms
2022-09-23 15:42:25.829 +01:00 [INF] Request starting HTTP/1.1 GET https://localhost:7036/api/Users/1/refresh-tokens - -
2022-09-23 15:42:25.833 +01:00 [DBG] 1 candidate(s) found for the request path '/api/Users/1/refresh-tokens'
2022-09-23 15:42:25.834 +01:00 [DBG] Endpoint 'APIBank.Controllers.UsersController.GetRefreshTokens (APIBank)' with route pattern 'api/Users/{id}/refresh-tokens' is valid for the request path '/api/Users/1/refresh-tokens'
2022-09-23 15:42:25.836 +01:00 [DBG] Request matched endpoint 'APIBank.Controllers.UsersController.GetRefreshTokens (APIBank)'
2022-09-23 15:42:25.838 +01:00 [DBG] Static files was skipped as the request already matched an endpoint.
2022-09-23 15:42:25.843 +01:00 [INF] Entity Framework Core 6.0.9 initialized 'PostgresContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:6.0.7+5b98e4b74de93b590b44aef8dd7967c03acc433c' with options: None
2022-09-23 15:42:25.846 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 15:42:25.847 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2022-09-23 15:42:25.848 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 15:42:25.849 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:42:25.850 +01:00 [DBG] Executing DbCommand [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.id = @__p_0
LIMIT 1
2022-09-23 15:42:25.855 +01:00 [INF] Executed DbCommand (4ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.id = @__p_0
LIMIT 1
2022-09-23 15:42:25.857 +01:00 [DBG] Context 'PostgresContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 15:42:25.859 +01:00 [DBG] A data reader was disposed.
2022-09-23 15:42:25.860 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:42:25.862 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 15:42:25.863 +01:00 [INF] Executing endpoint 'APIBank.Controllers.UsersController.GetRefreshTokens (APIBank)'
2022-09-23 15:42:25.864 +01:00 [INF] Route matched with {action = "GetRefreshTokens", controller = "Users"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult GetRefreshTokens(Int32) on controller APIBank.Controllers.UsersController (APIBank).
2022-09-23 15:42:25.865 +01:00 [DBG] Execution plan of authorization filters (in the following order): ["APIBank.Authorization.AuthorizeAttribute"]
2022-09-23 15:42:25.866 +01:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2022-09-23 15:42:25.870 +01:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2022-09-23 15:42:25.871 +01:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2022-09-23 15:42:25.872 +01:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2022-09-23 15:42:25.873 +01:00 [DBG] Executing controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-23 15:42:25.875 +01:00 [DBG] Executed controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-23 15:42:25.877 +01:00 [DBG] Attempting to bind parameter 'id' of type 'System.Int32' ...
2022-09-23 15:42:25.878 +01:00 [DBG] Attempting to bind parameter 'id' of type 'System.Int32' using the name 'id' in request data ...
2022-09-23 15:42:25.879 +01:00 [DBG] Done attempting to bind parameter 'id' of type 'System.Int32'.
2022-09-23 15:42:25.880 +01:00 [DBG] Done attempting to bind parameter 'id' of type 'System.Int32'.
2022-09-23 15:42:25.881 +01:00 [DBG] Attempting to validate the bound parameter 'id' of type 'System.Int32' ...
2022-09-23 15:42:25.883 +01:00 [DBG] Done attempting to validate the bound parameter 'id' of type 'System.Int32'.
2022-09-23 15:42:25.887 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 15:42:25.888 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2022-09-23 15:42:25.889 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 15:42:25.890 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:42:25.892 +01:00 [DBG] Executing DbCommand [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id, r.created, r.created_by_ip, r.expires, r.is_active, r.is_expired, r.is_revoked, r.reason_revoked, r.token, r.replaced_by_token, r.revoked, r.revoked_by_ip, r.user_id
FROM refresh_token AS r
WHERE r.id = @__p_0
LIMIT 1
2022-09-23 15:42:25.895 +01:00 [INF] Executed DbCommand (3ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id, r.created, r.created_by_ip, r.expires, r.is_active, r.is_expired, r.is_revoked, r.reason_revoked, r.token, r.replaced_by_token, r.revoked, r.revoked_by_ip, r.user_id
FROM refresh_token AS r
WHERE r.id = @__p_0
LIMIT 1
2022-09-23 15:42:25.897 +01:00 [DBG] Context 'PostgresContext' started tracking 'RefreshToken' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 15:42:25.900 +01:00 [DBG] A data reader was disposed.
2022-09-23 15:42:25.900 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:42:25.901 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 15:42:25.902 +01:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2022-09-23 15:42:25.904 +01:00 [DBG] No information found on request to perform content negotiation.
2022-09-23 15:42:25.905 +01:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2022-09-23 15:42:25.905 +01:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2022-09-23 15:42:25.906 +01:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2022-09-23 15:42:25.909 +01:00 [INF] Executing OkObjectResult, writing value of type 'Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryable`1[[APIBank.ModelEntities.RefreshToken, APIBank, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2022-09-23 15:42:25.914 +01:00 [DBG] Compiling query expression: 
'DbSet<RefreshToken>()
    .Where(rt => rt.UserId == __id_0)
    .AsNoTracking()
    .Select(rt => new RefreshToken{ 
        Id = rt.Id, 
        UserId = rt.UserId, 
        RefToken = rt.RefToken, 
        Expires = rt.Expires, 
        Created = rt.Created, 
        CreatedByIp = rt.CreatedByIp, 
        Revoked = rt.Revoked, 
        RevokedByIp = rt.RevokedByIp, 
        ReplacedByToken = rt.ReplacedByToken, 
        ReasonRevoked = rt.ReasonRevoked, 
        IsExpired = rt.IsExpired, 
        IsRevoked = rt.IsRevoked, 
        IsActive = rt.IsActive 
    }
    )'
2022-09-23 15:42:25.919 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<RefreshToken>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            Id -> 0
            UserId -> 1
            RefToken -> 2
            Expires -> 3
            Created -> 4
            CreatedByIp -> 5
            Revoked -> 6
            RevokedByIp -> 7
            ReplacedByToken -> 8
            ReasonRevoked -> 9
            IsExpired -> 10
            IsRevoked -> 11
            IsActive -> 12
        SELECT r.id AS Id, r.user_id AS UserId, r.token AS RefToken, r.expires AS Expires, r.created AS Created, r.created_by_ip AS CreatedByIp, r.revoked AS Revoked, r.revoked_by_ip AS RevokedByIp, r.replaced_by_token AS ReplacedByToken, r.reason_revoked AS ReasonRevoked, r.is_expired AS IsExpired, r.is_revoked AS IsRevoked, r.is_active AS IsActive
        FROM refresh_token AS r
        WHERE r.user_id == @__id_0), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, RefreshToken>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)'
2022-09-23 15:42:25.932 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 15:42:25.933 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2022-09-23 15:42:25.935 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 15:42:25.937 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:42:25.939 +01:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.user_id AS "UserId", r.token AS "RefToken", r.expires AS "Expires", r.created AS "Created", r.created_by_ip AS "CreatedByIp", r.revoked AS "Revoked", r.revoked_by_ip AS "RevokedByIp", r.replaced_by_token AS "ReplacedByToken", r.reason_revoked AS "ReasonRevoked", r.is_expired AS "IsExpired", r.is_revoked AS "IsRevoked", r.is_active AS "IsActive"
FROM refresh_token AS r
WHERE r.user_id = @__id_0
2022-09-23 15:42:25.946 +01:00 [INF] Executed DbCommand (7ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.user_id AS "UserId", r.token AS "RefToken", r.expires AS "Expires", r.created AS "Created", r.created_by_ip AS "CreatedByIp", r.revoked AS "Revoked", r.revoked_by_ip AS "RevokedByIp", r.replaced_by_token AS "ReplacedByToken", r.reason_revoked AS "ReasonRevoked", r.is_expired AS "IsExpired", r.is_revoked AS "IsRevoked", r.is_active AS "IsActive"
FROM refresh_token AS r
WHERE r.user_id = @__id_0
2022-09-23 15:42:25.953 +01:00 [DBG] A data reader was disposed.
2022-09-23 15:42:25.955 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:42:25.957 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 15:42:25.959 +01:00 [INF] Executed action APIBank.Controllers.UsersController.GetRefreshTokens (APIBank) in 85.7654ms
2022-09-23 15:42:25.961 +01:00 [INF] Executed endpoint 'APIBank.Controllers.UsersController.GetRefreshTokens (APIBank)'
2022-09-23 15:42:25.963 +01:00 [DBG] Connection id "0HMKTE1QV7TFV" completed keep alive response.
2022-09-23 15:42:25.964 +01:00 [DBG] 'PostgresContext' disposed.
2022-09-23 15:42:25.965 +01:00 [INF] Request finished HTTP/1.1 GET https://localhost:7036/api/Users/1/refresh-tokens - - - 200 - application/json;+charset=utf-8 135.1776ms
2022-09-23 15:43:40.199 +01:00 [INF] Request starting HTTP/1.1 GET https://localhost:7036/api/Accounts/GetAll - -
2022-09-23 15:43:40.201 +01:00 [DBG] 1 candidate(s) found for the request path '/api/Accounts/GetAll'
2022-09-23 15:43:40.203 +01:00 [DBG] Endpoint 'APIBank.Controllers.AccountsController.GetAllFromUser (APIBank)' with route pattern 'api/Accounts/GetAll' is valid for the request path '/api/Accounts/GetAll'
2022-09-23 15:43:40.206 +01:00 [DBG] Request matched endpoint 'APIBank.Controllers.AccountsController.GetAllFromUser (APIBank)'
2022-09-23 15:43:40.206 +01:00 [DBG] Static files was skipped as the request already matched an endpoint.
2022-09-23 15:43:40.207 +01:00 [INF] Executing endpoint 'APIBank.Controllers.AccountsController.GetAllFromUser (APIBank)'
2022-09-23 15:43:40.209 +01:00 [INF] Route matched with {action = "GetAllFromUser", controller = "Accounts"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult GetAllFromUser() on controller APIBank.Controllers.AccountsController (APIBank).
2022-09-23 15:43:40.211 +01:00 [DBG] Execution plan of authorization filters (in the following order): ["APIBank.Authorization.AuthorizeAttribute"]
2022-09-23 15:43:40.213 +01:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2022-09-23 15:43:40.213 +01:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2022-09-23 15:43:40.215 +01:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2022-09-23 15:43:40.216 +01:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2022-09-23 15:43:40.217 +01:00 [INF] Authorization failed for the request at filter 'APIBank.Authorization.AuthorizeAttribute'.
2022-09-23 15:43:40.217 +01:00 [INF] Executing JsonResult, writing value of type '<>f__AnonymousType0`1[[System.String, System.Private.CoreLib, Version=6.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2022-09-23 15:43:40.220 +01:00 [INF] Executed action APIBank.Controllers.AccountsController.GetAllFromUser (APIBank) in 3.8712ms
2022-09-23 15:43:40.222 +01:00 [INF] Executed endpoint 'APIBank.Controllers.AccountsController.GetAllFromUser (APIBank)'
2022-09-23 15:43:40.222 +01:00 [DBG] Connection id "0HMKTE1QV7TFV" completed keep alive response.
2022-09-23 15:43:40.223 +01:00 [INF] Request finished HTTP/1.1 GET https://localhost:7036/api/Accounts/GetAll - - - 401 - application/json;+charset=utf-8 24.1183ms
2022-09-23 15:43:47.014 +01:00 [INF] Request starting HTTP/1.1 POST https://localhost:7036/api/Users/refreshToken - 0
2022-09-23 15:43:47.015 +01:00 [DBG] 1 candidate(s) found for the request path '/api/Users/refreshToken'
2022-09-23 15:43:47.016 +01:00 [DBG] Endpoint 'APIBank.Controllers.UsersController.RefreshToken (APIBank)' with route pattern 'api/Users/refreshToken' is valid for the request path '/api/Users/refreshToken'
2022-09-23 15:43:47.017 +01:00 [DBG] Request matched endpoint 'APIBank.Controllers.UsersController.RefreshToken (APIBank)'
2022-09-23 15:43:47.018 +01:00 [DBG] Static files was skipped as the request already matched an endpoint.
2022-09-23 15:43:47.020 +01:00 [INF] Executing endpoint 'APIBank.Controllers.UsersController.RefreshToken (APIBank)'
2022-09-23 15:43:47.022 +01:00 [INF] Route matched with {action = "RefreshToken", controller = "Users"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult RefreshToken() on controller APIBank.Controllers.UsersController (APIBank).
2022-09-23 15:43:47.025 +01:00 [DBG] Execution plan of authorization filters (in the following order): ["APIBank.Authorization.AuthorizeAttribute"]
2022-09-23 15:43:47.026 +01:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2022-09-23 15:43:47.027 +01:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2022-09-23 15:43:47.028 +01:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2022-09-23 15:43:47.029 +01:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2022-09-23 15:43:47.030 +01:00 [DBG] Executing controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-23 15:43:47.031 +01:00 [DBG] Executed controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-23 15:43:47.033 +01:00 [INF] Entity Framework Core 6.0.9 initialized 'PostgresContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:6.0.7+5b98e4b74de93b590b44aef8dd7967c03acc433c' with options: None
2022-09-23 15:43:47.034 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 15:43:47.037 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2022-09-23 15:43:47.040 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 15:43:47.107 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:43:47.109 +01:00 [DBG] Executing DbCommand [Parameters=[@__refToken_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE EXISTS (
    SELECT 1
    FROM refresh_token AS r
    WHERE (u.id = r.user_id) AND (r.token = @__refToken_0))
LIMIT 2
2022-09-23 15:43:47.112 +01:00 [INF] Executed DbCommand (4ms) [Parameters=[@__refToken_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE EXISTS (
    SELECT 1
    FROM refresh_token AS r
    WHERE (u.id = r.user_id) AND (r.token = @__refToken_0))
LIMIT 2
2022-09-23 15:43:47.116 +01:00 [DBG] Context 'PostgresContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 15:43:47.117 +01:00 [DBG] A data reader was disposed.
2022-09-23 15:43:47.117 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:43:47.119 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 15:43:47.121 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 15:43:47.122 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2022-09-23 15:43:47.124 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 15:43:47.125 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:43:47.126 +01:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.user_id AS "UserId", r.token AS "RefToken", r.expires AS "Expires", r.created AS "Created", r.created_by_ip AS "CreatedByIp", r.revoked AS "Revoked", r.revoked_by_ip AS "RevokedByIp", r.replaced_by_token AS "ReplacedByToken", r.reason_revoked AS "ReasonRevoked", r.is_expired AS "IsExpired", r.is_revoked AS "IsRevoked", r.is_active AS "IsActive"
FROM refresh_token AS r
WHERE r.user_id = @__id_0
2022-09-23 15:43:47.128 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.user_id AS "UserId", r.token AS "RefToken", r.expires AS "Expires", r.created AS "Created", r.created_by_ip AS "CreatedByIp", r.revoked AS "Revoked", r.revoked_by_ip AS "RevokedByIp", r.replaced_by_token AS "ReplacedByToken", r.reason_revoked AS "ReasonRevoked", r.is_expired AS "IsExpired", r.is_revoked AS "IsRevoked", r.is_active AS "IsActive"
FROM refresh_token AS r
WHERE r.user_id = @__id_0
2022-09-23 15:43:47.131 +01:00 [DBG] A data reader was disposed.
2022-09-23 15:43:47.132 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:43:47.133 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 15:43:47.134 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 15:43:47.136 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2022-09-23 15:43:47.137 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 15:43:47.138 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:43:47.139 +01:00 [DBG] Executing DbCommand [Parameters=[@__token_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM users AS u
    WHERE EXISTS (
        SELECT 1
        FROM refresh_token AS r
        WHERE (u.id = r.user_id) AND (r.token = @__token_0)))
2022-09-23 15:43:47.141 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[@__token_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM users AS u
    WHERE EXISTS (
        SELECT 1
        FROM refresh_token AS r
        WHERE (u.id = r.user_id) AND (r.token = @__token_0)))
2022-09-23 15:43:47.143 +01:00 [DBG] A data reader was disposed.
2022-09-23 15:43:47.144 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:43:47.146 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 15:43:47.147 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 15:43:47.148 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2022-09-23 15:43:47.149 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 15:43:47.150 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:43:47.151 +01:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.user_id AS "UserId", r.token AS "RefToken", r.expires AS "Expires", r.created AS "Created", r.created_by_ip AS "CreatedByIp", r.revoked AS "Revoked", r.revoked_by_ip AS "RevokedByIp", r.replaced_by_token AS "ReplacedByToken", r.reason_revoked AS "ReasonRevoked", r.is_expired AS "IsExpired", r.is_revoked AS "IsRevoked", r.is_active AS "IsActive"
FROM refresh_token AS r
WHERE r.user_id = @__id_0
2022-09-23 15:43:47.154 +01:00 [INF] Executed DbCommand (4ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.user_id AS "UserId", r.token AS "RefToken", r.expires AS "Expires", r.created AS "Created", r.created_by_ip AS "CreatedByIp", r.revoked AS "Revoked", r.revoked_by_ip AS "RevokedByIp", r.replaced_by_token AS "ReplacedByToken", r.reason_revoked AS "ReasonRevoked", r.is_expired AS "IsExpired", r.is_revoked AS "IsRevoked", r.is_active AS "IsActive"
FROM refresh_token AS r
WHERE r.user_id = @__id_0
2022-09-23 15:43:47.156 +01:00 [DBG] A data reader was disposed.
2022-09-23 15:43:47.157 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:43:47.158 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 15:43:47.159 +01:00 [DBG] An entity of type 'User' tracked by 'PostgresContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 15:43:47.162 +01:00 [DBG] SaveChanges starting for 'PostgresContext'.
2022-09-23 15:43:47.162 +01:00 [DBG] DetectChanges starting for 'PostgresContext'.
2022-09-23 15:43:47.163 +01:00 [DBG] 1 entities were added and 0 entities were removed from navigation 'User.RefreshTokenCollection'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 15:43:47.165 +01:00 [DBG] 'PostgresContext' generated a temporary value for the property 'Id.RefreshToken'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 15:43:47.166 +01:00 [DBG] Context 'PostgresContext' started tracking 'RefreshToken' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 15:43:47.169 +01:00 [DBG] DetectChanges completed for 'PostgresContext'.
2022-09-23 15:43:47.170 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 15:43:47.171 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:43:47.172 +01:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2022-09-23 15:43:47.173 +01:00 [DBG] Began transaction with isolation level 'ReadCommitted'.
2022-09-23 15:43:47.174 +01:00 [DBG] Executing 2 update commands as a batch.
2022-09-23 15:43:47.174 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 15:43:47.175 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2022-09-23 15:43:47.178 +01:00 [DBG] Executing DbCommand [Parameters=[@p0='?' (DbType = DateTime), @p1='?', @p2='?' (DbType = DateTime), @p3='?' (DbType = Boolean), @p4='?' (DbType = Boolean), @p5='?' (DbType = Boolean), @p6='?', @p7='?', @p8='?', @p9='?' (DbType = DateTime), @p10='?', @p11='?' (DbType = Int32), @p18='?' (DbType = Int32), @p12='?' (DbType = DateTime), @p13='?', @p14='?', @p15='?' (DbType = DateTime), @p16='?', @p17='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO refresh_token (created, created_by_ip, expires, is_active, is_expired, is_revoked, reason_revoked, token, replaced_by_token, revoked, revoked_by_ip, user_id)
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11)
RETURNING id;
UPDATE users SET created_at = @p12, email = @p13, full_name = @p14, password_changed_at = @p15, password_hash = @p16, username = @p17
WHERE id = @p18;
2022-09-23 15:43:47.181 +01:00 [INF] Executed DbCommand (3ms) [Parameters=[@p0='?' (DbType = DateTime), @p1='?', @p2='?' (DbType = DateTime), @p3='?' (DbType = Boolean), @p4='?' (DbType = Boolean), @p5='?' (DbType = Boolean), @p6='?', @p7='?', @p8='?', @p9='?' (DbType = DateTime), @p10='?', @p11='?' (DbType = Int32), @p18='?' (DbType = Int32), @p12='?' (DbType = DateTime), @p13='?', @p14='?', @p15='?' (DbType = DateTime), @p16='?', @p17='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO refresh_token (created, created_by_ip, expires, is_active, is_expired, is_revoked, reason_revoked, token, replaced_by_token, revoked, revoked_by_ip, user_id)
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11)
RETURNING id;
UPDATE users SET created_at = @p12, email = @p13, full_name = @p14, password_changed_at = @p15, password_hash = @p16, username = @p17
WHERE id = @p18;
2022-09-23 15:43:47.183 +01:00 [DBG] The foreign key property 'RefreshToken.Id' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2022-09-23 15:43:47.184 +01:00 [DBG] A data reader was disposed.
2022-09-23 15:43:47.186 +01:00 [DBG] Committing transaction.
2022-09-23 15:43:47.188 +01:00 [DBG] Committed transaction.
2022-09-23 15:43:47.189 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:43:47.190 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 15:43:47.191 +01:00 [DBG] Disposing transaction.
2022-09-23 15:43:47.193 +01:00 [DBG] An entity of type 'RefreshToken' tracked by 'PostgresContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 15:43:47.194 +01:00 [DBG] An entity of type 'User' tracked by 'PostgresContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 15:43:47.196 +01:00 [DBG] SaveChanges completed for 'PostgresContext' with 2 entities written to the database.
2022-09-23 15:43:47.197 +01:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2022-09-23 15:43:47.198 +01:00 [DBG] No information found on request to perform content negotiation.
2022-09-23 15:43:47.199 +01:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2022-09-23 15:43:47.200 +01:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2022-09-23 15:43:47.201 +01:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2022-09-23 15:43:47.203 +01:00 [INF] Executing OkObjectResult, writing value of type 'APIBank.Models.MyRequestResponses.LoginResponse'.
2022-09-23 15:43:47.204 +01:00 [INF] Executed action APIBank.Controllers.UsersController.RefreshToken (APIBank) in 174.0147ms
2022-09-23 15:43:47.206 +01:00 [INF] Executed endpoint 'APIBank.Controllers.UsersController.RefreshToken (APIBank)'
2022-09-23 15:43:47.207 +01:00 [DBG] Connection id "0HMKTE1QV7TFV" completed keep alive response.
2022-09-23 15:43:47.210 +01:00 [DBG] 'PostgresContext' disposed.
2022-09-23 15:43:47.211 +01:00 [INF] Request finished HTTP/1.1 POST https://localhost:7036/api/Users/refreshToken - 0 - 200 - application/json;+charset=utf-8 197.3828ms
2022-09-23 15:44:01.049 +01:00 [INF] Request starting HTTP/1.1 GET https://localhost:7036/api/Accounts/GetAll - -
2022-09-23 15:44:01.054 +01:00 [DBG] 1 candidate(s) found for the request path '/api/Accounts/GetAll'
2022-09-23 15:44:01.054 +01:00 [DBG] Endpoint 'APIBank.Controllers.AccountsController.GetAllFromUser (APIBank)' with route pattern 'api/Accounts/GetAll' is valid for the request path '/api/Accounts/GetAll'
2022-09-23 15:44:01.058 +01:00 [DBG] Request matched endpoint 'APIBank.Controllers.AccountsController.GetAllFromUser (APIBank)'
2022-09-23 15:44:01.059 +01:00 [DBG] Static files was skipped as the request already matched an endpoint.
2022-09-23 15:44:01.061 +01:00 [INF] Entity Framework Core 6.0.9 initialized 'PostgresContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:6.0.7+5b98e4b74de93b590b44aef8dd7967c03acc433c' with options: None
2022-09-23 15:44:01.066 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 15:44:01.067 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2022-09-23 15:44:01.068 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 15:44:01.069 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:44:01.070 +01:00 [DBG] Executing DbCommand [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.id = @__p_0
LIMIT 1
2022-09-23 15:44:01.075 +01:00 [INF] Executed DbCommand (5ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.id = @__p_0
LIMIT 1
2022-09-23 15:44:01.079 +01:00 [DBG] Context 'PostgresContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 15:44:01.082 +01:00 [DBG] A data reader was disposed.
2022-09-23 15:44:01.083 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:44:01.084 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 15:44:01.085 +01:00 [INF] Executing endpoint 'APIBank.Controllers.AccountsController.GetAllFromUser (APIBank)'
2022-09-23 15:44:01.087 +01:00 [INF] Route matched with {action = "GetAllFromUser", controller = "Accounts"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult GetAllFromUser() on controller APIBank.Controllers.AccountsController (APIBank).
2022-09-23 15:44:01.089 +01:00 [DBG] Execution plan of authorization filters (in the following order): ["APIBank.Authorization.AuthorizeAttribute"]
2022-09-23 15:44:01.091 +01:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2022-09-23 15:44:01.092 +01:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2022-09-23 15:44:01.095 +01:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2022-09-23 15:44:01.097 +01:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2022-09-23 15:44:01.099 +01:00 [DBG] Executing controller factory for controller APIBank.Controllers.AccountsController (APIBank)
2022-09-23 15:44:01.101 +01:00 [DBG] Executed controller factory for controller APIBank.Controllers.AccountsController (APIBank)
2022-09-23 15:44:01.104 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 15:44:01.105 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2022-09-23 15:44:01.108 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 15:44:01.109 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:44:01.112 +01:00 [DBG] Executing DbCommand [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id, r.created, r.created_by_ip, r.expires, r.is_active, r.is_expired, r.is_revoked, r.reason_revoked, r.token, r.replaced_by_token, r.revoked, r.revoked_by_ip, r.user_id
FROM refresh_token AS r
WHERE r.id = @__p_0
LIMIT 1
2022-09-23 15:44:01.114 +01:00 [INF] Executed DbCommand (3ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id, r.created, r.created_by_ip, r.expires, r.is_active, r.is_expired, r.is_revoked, r.reason_revoked, r.token, r.replaced_by_token, r.revoked, r.revoked_by_ip, r.user_id
FROM refresh_token AS r
WHERE r.id = @__p_0
LIMIT 1
2022-09-23 15:44:01.117 +01:00 [DBG] Context 'PostgresContext' started tracking 'RefreshToken' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-23 15:44:01.119 +01:00 [DBG] A data reader was disposed.
2022-09-23 15:44:01.120 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:44:01.122 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 15:44:01.125 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-23 15:44:01.127 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (2ms).
2022-09-23 15:44:01.128 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-23 15:44:01.129 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:44:01.131 +01:00 [DBG] Executing DbCommand [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a.balance AS "Balance", a.created_at AS "CreatedAt", a.currency AS "Currency", a.id AS "Id"
FROM accounts AS a
WHERE a.user_id = @__userId_0
2022-09-23 15:44:01.134 +01:00 [INF] Executed DbCommand (3ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a.balance AS "Balance", a.created_at AS "CreatedAt", a.currency AS "Currency", a.id AS "Id"
FROM accounts AS a
WHERE a.user_id = @__userId_0
2022-09-23 15:44:01.136 +01:00 [DBG] A data reader was disposed.
2022-09-23 15:44:01.137 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-23 15:44:01.138 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-23 15:44:01.141 +01:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2022-09-23 15:44:01.146 +01:00 [DBG] No information found on request to perform content negotiation.
2022-09-23 15:44:01.147 +01:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2022-09-23 15:44:01.149 +01:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2022-09-23 15:44:01.149 +01:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2022-09-23 15:44:01.151 +01:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[APIBank.Models.Responses.AccountRequestResponse, APIBank, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2022-09-23 15:44:01.152 +01:00 [INF] Executed action APIBank.Controllers.AccountsController.GetAllFromUser (APIBank) in 52.9613ms
2022-09-23 15:44:01.153 +01:00 [INF] Executed endpoint 'APIBank.Controllers.AccountsController.GetAllFromUser (APIBank)'
2022-09-23 15:44:01.154 +01:00 [DBG] Connection id "0HMKTE1QV7TFV" completed keep alive response.
2022-09-23 15:44:01.155 +01:00 [DBG] 'PostgresContext' disposed.
2022-09-23 15:44:01.156 +01:00 [INF] Request finished HTTP/1.1 GET https://localhost:7036/api/Accounts/GetAll - - - 200 - application/json;+charset=utf-8 106.5737ms
2022-09-23 15:46:12.178 +01:00 [DBG] Connection id "0HMKTE1QV7TFV" disconnecting.
2022-09-23 15:46:12.180 +01:00 [DBG] Connection id "0HMKTE1QV7TFV" stopped.
2022-09-23 15:46:12.181 +01:00 [DBG] Connection id "0HMKTE1QV7TFV" sending FIN because: "The Socket transport's send loop completed gracefully."
