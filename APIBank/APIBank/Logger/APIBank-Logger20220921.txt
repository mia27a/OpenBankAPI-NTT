2022-09-21 09:22:49.902 +01:00 [DBG] Connection id "0HMKR5OJBDUGR" received FIN.
2022-09-21 09:22:50.199 +01:00 [DBG] Connection id "0HMKR5OJBDUGR" is closed. The last processed stream ID was 9.
2022-09-21 09:22:50.271 +01:00 [DBG] Connection id "0HMKR5OJBDUGR" sending FIN because: "The client closed the connection."
2022-09-21 09:22:50.275 +01:00 [DBG] Connection id "0HMKR5OJBDUGR" stopped.
2022-09-21 09:25:05.261 +01:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2022-09-21 09:25:05.476 +01:00 [DBG] Hosting starting
2022-09-21 09:25:05.716 +01:00 [DBG] Using development certificate: CN=localhost (Thumbprint: 9CC642E9838495A6C3C202DECA6A8AD300396DD2)
2022-09-21 09:25:05.804 +01:00 [INF] Now listening on: https://localhost:7036
2022-09-21 09:25:05.806 +01:00 [INF] Now listening on: http://localhost:5036
2022-09-21 09:25:05.807 +01:00 [DBG] Loaded hosting startup assembly APIBank
2022-09-21 09:25:05.808 +01:00 [DBG] Loaded hosting startup assembly Microsoft.AspNetCore.Watch.BrowserRefresh
2022-09-21 09:25:05.811 +01:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.BrowserLink.Net
2022-09-21 09:25:05.812 +01:00 [INF] Application started. Press Ctrl+C to shut down.
2022-09-21 09:25:05.813 +01:00 [INF] Hosting environment: Development
2022-09-21 09:25:05.814 +01:00 [INF] Content root path: C:\Users\mguedesa\OneDrive - NTT DATA EMEAL\Documentos\GitHub\OpenBankAPI-NTT\APIBank\APIBank\
2022-09-21 09:25:05.817 +01:00 [DBG] Hosting started
2022-09-21 09:25:05.825 +01:00 [DBG] Connection id "0HMKRLB4S99FP" accepted.
2022-09-21 09:25:05.825 +01:00 [DBG] Connection id "0HMKRLB4S99FO" accepted.
2022-09-21 09:25:05.826 +01:00 [DBG] Connection id "0HMKRLB4S99FO" received FIN.
2022-09-21 09:25:05.826 +01:00 [DBG] Connection id "0HMKRLB4S99FP" received FIN.
2022-09-21 09:25:05.827 +01:00 [DBG] Connection id "0HMKRLB4S99FP" started.
2022-09-21 09:25:05.827 +01:00 [DBG] Connection id "0HMKRLB4S99FO" started.
2022-09-21 09:25:05.855 +01:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException:  Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveBlobAsync[TIOAdapter](TIOAdapter adapter)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](TIOAdapter adapter, Boolean receiveFirst, Byte[] reAuthenticationData, Boolean isApm)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2022-09-21 09:25:05.855 +01:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException:  Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveBlobAsync[TIOAdapter](TIOAdapter adapter)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](TIOAdapter adapter, Boolean receiveFirst, Byte[] reAuthenticationData, Boolean isApm)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2022-09-21 09:25:05.921 +01:00 [DBG] Connection id "0HMKRLB4S99FP" stopped.
2022-09-21 09:25:05.921 +01:00 [DBG] Connection id "0HMKRLB4S99FO" stopped.
2022-09-21 09:25:05.926 +01:00 [DBG] Connection id "0HMKRLB4S99FO" sending FIN because: "The Socket transport's send loop completed gracefully."
2022-09-21 09:25:05.926 +01:00 [DBG] Connection id "0HMKRLB4S99FP" sending FIN because: "The Socket transport's send loop completed gracefully."
2022-09-21 09:25:06.110 +01:00 [DBG] Connection id "0HMKRLB4S99FQ" accepted.
2022-09-21 09:25:06.112 +01:00 [DBG] Connection id "0HMKRLB4S99FQ" started.
2022-09-21 09:25:06.198 +01:00 [DBG] Connection 0HMKRLB4S99FQ established using the following protocol: "Tls12"
2022-09-21 09:25:06.322 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/swagger/index.html - -
2022-09-21 09:25:06.374 +01:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2022-09-21 09:25:06.398 +01:00 [DBG] No candidates found for the request path '/swagger/index.html'
2022-09-21 09:25:06.401 +01:00 [DBG] Request did not match any endpoints
2022-09-21 09:25:06.528 +01:00 [DBG] Response markup is scheduled to include browser refresh script injection.
2022-09-21 09:25:06.725 +01:00 [DBG] Response markup was updated to include browser refresh script injection.
2022-09-21 09:25:06.736 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/swagger/index.html - - - 200 - text/html;charset=utf-8 420.1556ms
2022-09-21 09:25:06.755 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/_framework/aspnetcore-browser-refresh.js - -
2022-09-21 09:25:06.755 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/_vs/browserLink - -
2022-09-21 09:25:06.769 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/_framework/aspnetcore-browser-refresh.js - - - 200 11984 application/javascript;+charset=utf-8 13.0819ms
2022-09-21 09:25:06.823 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/_vs/browserLink - - - 200 - text/javascript;+charset=UTF-8 67.0931ms
2022-09-21 09:25:06.913 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/swagger/v1/swagger.json - -
2022-09-21 09:25:06.917 +01:00 [DBG] No candidates found for the request path '/swagger/v1/swagger.json'
2022-09-21 09:25:06.920 +01:00 [DBG] Request did not match any endpoints
2022-09-21 09:25:07.156 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/swagger/v1/swagger.json - - - 200 - application/json;charset=utf-8 242.8022ms
2022-09-21 09:25:29.834 +01:00 [DBG] Connection id "0HMKRLB4S99FQ" received FIN.
2022-09-21 09:25:29.843 +01:00 [DBG] Connection id "0HMKRLB4S99FQ" is closed. The last processed stream ID was 7.
2022-09-21 09:25:29.847 +01:00 [DBG] Connection id "0HMKRLB4S99FQ" sending FIN because: "The client closed the connection."
2022-09-21 09:25:29.864 +01:00 [DBG] Connection id "0HMKRLB4S99FQ" stopped.
2022-09-21 10:13:04.653 +01:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2022-09-21 10:13:05.060 +01:00 [DBG] Hosting starting
2022-09-21 10:13:05.435 +01:00 [DBG] Using development certificate: CN=localhost (Thumbprint: 9CC642E9838495A6C3C202DECA6A8AD300396DD2)
2022-09-21 10:13:05.545 +01:00 [INF] Now listening on: https://localhost:7036
2022-09-21 10:13:05.547 +01:00 [INF] Now listening on: http://localhost:5036
2022-09-21 10:13:05.548 +01:00 [DBG] Loaded hosting startup assembly APIBank
2022-09-21 10:13:05.548 +01:00 [DBG] Loaded hosting startup assembly Microsoft.AspNetCore.Watch.BrowserRefresh
2022-09-21 10:13:05.549 +01:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.BrowserLink.Net
2022-09-21 10:13:05.550 +01:00 [INF] Application started. Press Ctrl+C to shut down.
2022-09-21 10:13:05.552 +01:00 [INF] Hosting environment: Development
2022-09-21 10:13:05.553 +01:00 [INF] Content root path: C:\Users\mguedesa\OneDrive - NTT DATA EMEAL\Documentos\GitHub\OpenBankAPI-NTT\APIBank\APIBank\
2022-09-21 10:13:05.555 +01:00 [DBG] Hosting started
2022-09-21 10:13:05.915 +01:00 [DBG] Connection id "0HMKRM5V703QS" accepted.
2022-09-21 10:13:05.915 +01:00 [DBG] Connection id "0HMKRM5V703QR" accepted.
2022-09-21 10:13:05.918 +01:00 [DBG] Connection id "0HMKRM5V703QS" started.
2022-09-21 10:13:05.918 +01:00 [DBG] Connection id "0HMKRM5V703QR" started.
2022-09-21 10:13:05.932 +01:00 [DBG] Connection id "0HMKRM5V703QR" received FIN.
2022-09-21 10:13:05.932 +01:00 [DBG] Connection id "0HMKRM5V703QS" received FIN.
2022-09-21 10:13:05.961 +01:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException:  Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.<FillHandshakeBufferAsync>g__InternalFillHandshakeBufferAsync|189_0[TIOAdapter](TIOAdapter adap, ValueTask`1 task, Int32 minSize)
   at System.Net.Security.SslStream.ReceiveBlobAsync[TIOAdapter](TIOAdapter adapter)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](TIOAdapter adapter, Boolean receiveFirst, Byte[] reAuthenticationData, Boolean isApm)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2022-09-21 10:13:05.961 +01:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException:  Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.<FillHandshakeBufferAsync>g__InternalFillHandshakeBufferAsync|189_0[TIOAdapter](TIOAdapter adap, ValueTask`1 task, Int32 minSize)
   at System.Net.Security.SslStream.ReceiveBlobAsync[TIOAdapter](TIOAdapter adapter)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](TIOAdapter adapter, Boolean receiveFirst, Byte[] reAuthenticationData, Boolean isApm)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2022-09-21 10:13:06.034 +01:00 [DBG] Connection id "0HMKRM5V703QR" stopped.
2022-09-21 10:13:06.034 +01:00 [DBG] Connection id "0HMKRM5V703QS" stopped.
2022-09-21 10:13:06.039 +01:00 [DBG] Connection id "0HMKRM5V703QR" sending FIN because: "The Socket transport's send loop completed gracefully."
2022-09-21 10:13:06.039 +01:00 [DBG] Connection id "0HMKRM5V703QS" sending FIN because: "The Socket transport's send loop completed gracefully."
2022-09-21 10:13:06.156 +01:00 [DBG] Connection id "0HMKRM5V703QT" accepted.
2022-09-21 10:13:06.171 +01:00 [DBG] Connection id "0HMKRM5V703QT" started.
2022-09-21 10:13:06.273 +01:00 [DBG] Connection 0HMKRM5V703QT established using the following protocol: "Tls12"
2022-09-21 10:13:06.357 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/swagger/index.html - -
2022-09-21 10:13:06.395 +01:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2022-09-21 10:13:06.421 +01:00 [DBG] No candidates found for the request path '/swagger/index.html'
2022-09-21 10:13:06.424 +01:00 [DBG] Request did not match any endpoints
2022-09-21 10:13:06.536 +01:00 [DBG] Response markup is scheduled to include browser refresh script injection.
2022-09-21 10:13:06.713 +01:00 [DBG] Response markup was updated to include browser refresh script injection.
2022-09-21 10:13:06.719 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/swagger/index.html - - - 200 - text/html;charset=utf-8 368.8356ms
2022-09-21 10:13:06.750 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/_vs/browserLink - -
2022-09-21 10:13:06.750 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/_framework/aspnetcore-browser-refresh.js - -
2022-09-21 10:13:06.765 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/_framework/aspnetcore-browser-refresh.js - - - 200 11984 application/javascript;+charset=utf-8 15.2258ms
2022-09-21 10:13:06.800 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/_vs/browserLink - - - 200 - text/javascript;+charset=UTF-8 49.5432ms
2022-09-21 10:13:06.877 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/swagger/v1/swagger.json - -
2022-09-21 10:13:06.878 +01:00 [DBG] No candidates found for the request path '/swagger/v1/swagger.json'
2022-09-21 10:13:06.879 +01:00 [DBG] Request did not match any endpoints
2022-09-21 10:13:07.040 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/swagger/v1/swagger.json - - - 200 - application/json;charset=utf-8 163.5713ms
2022-09-21 10:13:12.698 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/api/Accounts/GetAll - -
2022-09-21 10:13:12.714 +01:00 [DBG] 1 candidate(s) found for the request path '/api/Accounts/GetAll'
2022-09-21 10:13:12.727 +01:00 [DBG] Endpoint 'APIBank.Controllers.AccountsController.GetAllFromUser (APIBank)' with route pattern 'api/Accounts/GetAll' is valid for the request path '/api/Accounts/GetAll'
2022-09-21 10:13:12.731 +01:00 [DBG] Request matched endpoint 'APIBank.Controllers.AccountsController.GetAllFromUser (APIBank)'
2022-09-21 10:13:12.735 +01:00 [DBG] Static files was skipped as the request already matched an endpoint.
2022-09-21 10:13:13.236 +01:00 [INF] Executing endpoint 'APIBank.Controllers.AccountsController.GetAllFromUser (APIBank)'
2022-09-21 10:13:13.252 +01:00 [INF] Route matched with {action = "GetAllFromUser", controller = "Accounts"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult GetAllFromUser() on controller APIBank.Controllers.AccountsController (APIBank).
2022-09-21 10:13:13.255 +01:00 [DBG] Execution plan of authorization filters (in the following order): ["APIBank.Authorization.AuthorizeAttribute"]
2022-09-21 10:13:13.257 +01:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2022-09-21 10:13:13.261 +01:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2022-09-21 10:13:13.264 +01:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2022-09-21 10:13:13.266 +01:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2022-09-21 10:13:13.270 +01:00 [INF] Authorization failed for the request at filter 'APIBank.Authorization.AuthorizeAttribute'.
2022-09-21 10:13:13.275 +01:00 [INF] Executing JsonResult, writing value of type '<>f__AnonymousType0`1[[System.String, System.Private.CoreLib, Version=6.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2022-09-21 10:13:13.291 +01:00 [INF] Executed action APIBank.Controllers.AccountsController.GetAllFromUser (APIBank) in 15.6343ms
2022-09-21 10:13:13.294 +01:00 [INF] Executed endpoint 'APIBank.Controllers.AccountsController.GetAllFromUser (APIBank)'
2022-09-21 10:13:13.302 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/api/Accounts/GetAll - - - 401 - application/json;+charset=utf-8 604.0604ms
2022-09-21 10:13:25.541 +01:00 [INF] Request starting HTTP/2 POST https://localhost:7036/api/Users/Login application/json 58
2022-09-21 10:13:25.545 +01:00 [DBG] 1 candidate(s) found for the request path '/api/Users/Login'
2022-09-21 10:13:25.546 +01:00 [DBG] Endpoint 'APIBank.Controllers.UsersController.Login (APIBank)' with route pattern 'api/Users/Login' is valid for the request path '/api/Users/Login'
2022-09-21 10:13:25.548 +01:00 [DBG] Request matched endpoint 'APIBank.Controllers.UsersController.Login (APIBank)'
2022-09-21 10:13:25.549 +01:00 [DBG] Static files was skipped as the request already matched an endpoint.
2022-09-21 10:13:25.564 +01:00 [INF] Executing endpoint 'APIBank.Controllers.UsersController.Login (APIBank)'
2022-09-21 10:13:25.587 +01:00 [INF] Route matched with {action = "Login", controller = "Users"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult Login(APIBank.Models.Requests.LoginRequest) on controller APIBank.Controllers.UsersController (APIBank).
2022-09-21 10:13:25.591 +01:00 [DBG] Execution plan of authorization filters (in the following order): ["APIBank.Authorization.AuthorizeAttribute"]
2022-09-21 10:13:25.593 +01:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2022-09-21 10:13:25.595 +01:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2022-09-21 10:13:25.597 +01:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2022-09-21 10:13:25.600 +01:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2022-09-21 10:13:25.604 +01:00 [DBG] Executing controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-21 10:13:25.607 +01:00 [DBG] Executed controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-21 10:13:25.626 +01:00 [DBG] Attempting to bind parameter 'model' of type 'APIBank.Models.Requests.LoginRequest' ...
2022-09-21 10:13:25.629 +01:00 [DBG] Attempting to bind parameter 'model' of type 'APIBank.Models.Requests.LoginRequest' using the name '' in request data ...
2022-09-21 10:13:25.633 +01:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2022-09-21 10:13:25.644 +01:00 [DBG] Connection id "0HMKRM5V703QT", Request id "0HMKRM5V703QT:0000000B": started reading request body.
2022-09-21 10:13:25.646 +01:00 [DBG] Connection id "0HMKRM5V703QT", Request id "0HMKRM5V703QT:0000000B": done reading request body.
2022-09-21 10:13:25.657 +01:00 [DBG] JSON input formatter succeeded, deserializing to type 'APIBank.Models.Requests.LoginRequest'
2022-09-21 10:13:25.659 +01:00 [DBG] Done attempting to bind parameter 'model' of type 'APIBank.Models.Requests.LoginRequest'.
2022-09-21 10:13:25.662 +01:00 [DBG] Done attempting to bind parameter 'model' of type 'APIBank.Models.Requests.LoginRequest'.
2022-09-21 10:13:25.664 +01:00 [DBG] Attempting to validate the bound parameter 'model' of type 'APIBank.Models.Requests.LoginRequest' ...
2022-09-21 10:13:25.679 +01:00 [DBG] Done attempting to validate the bound parameter 'model' of type 'APIBank.Models.Requests.LoginRequest'.
2022-09-21 10:13:43.982 +01:00 [DBG] An additional 'IServiceProvider' was created for internal use by Entity Framework. An existing service provider was not used due to the following configuration changes: configuration changed for 'Core:ConfigureWarnings', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:UseAdminDatabase', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:SetPostgresVersion', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:UseRedshift', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:ReverseNullOrdering', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:RemoteCertificateValidationCallback', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:ProvideClientCertificatesCallback', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:ProvidePasswordCallback'.
2022-09-21 10:13:45.569 +01:00 [INF] Entity Framework Core 6.0.9 initialized 'PostgresContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:6.0.7+5b98e4b74de93b590b44aef8dd7967c03acc433c' with options: None
2022-09-21 10:13:45.659 +01:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .SingleOrDefault(x => x.Username == __model_Username_0)'
2022-09-21 10:13:46.215 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<User>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: User.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: User.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 1], [Property: User.Email (string) Required Index MaxLength(254), 2], [Property: User.FullName (string) Required MaxLength(100), 3], [Property: User.PasswordChangedAt (DateTime) Required ValueGenerated.OnAdd, 4], [Property: User.PasswordHash (string) Required MaxLength(200), 5], [Property: User.Username (string) Required Index MaxLength(50), 6] }
        SELECT TOP(2) u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
        FROM users AS u
        WHERE u.username == @__model_Username_0), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, User>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)
    .SingleOrDefault()'
2022-09-21 10:13:46.299 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-21 10:13:46.418 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (115ms).
2022-09-21 10:13:46.433 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-21 10:13:46.751 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 10:13:46.774 +01:00 [DBG] Executing DbCommand [Parameters=[@__model_Username_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.username = @__model_Username_0
LIMIT 2
2022-09-21 10:13:46.920 +01:00 [INF] Executed DbCommand (152ms) [Parameters=[@__model_Username_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.username = @__model_Username_0
LIMIT 2
2022-09-21 10:13:46.993 +01:00 [DBG] Context 'PostgresContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 10:13:47.065 +01:00 [DBG] A data reader was disposed.
2022-09-21 10:13:47.075 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 10:13:47.087 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-21 10:13:47.585 +01:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .Any(user => user.RefreshTokenCollection
        .Any(reftoken => reftoken.RefToken == __token_0))'
2022-09-21 10:14:03.005 +01:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2022-09-21 10:14:03.258 +01:00 [DBG] Hosting starting
2022-09-21 10:14:03.473 +01:00 [DBG] Using development certificate: CN=localhost (Thumbprint: 9CC642E9838495A6C3C202DECA6A8AD300396DD2)
2022-09-21 10:14:03.521 +01:00 [INF] Now listening on: https://localhost:7036
2022-09-21 10:14:03.523 +01:00 [INF] Now listening on: http://localhost:5036
2022-09-21 10:14:03.523 +01:00 [DBG] Loaded hosting startup assembly APIBank
2022-09-21 10:14:03.524 +01:00 [DBG] Loaded hosting startup assembly Microsoft.AspNetCore.Watch.BrowserRefresh
2022-09-21 10:14:03.525 +01:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.BrowserLink.Net
2022-09-21 10:14:03.526 +01:00 [INF] Application started. Press Ctrl+C to shut down.
2022-09-21 10:14:03.527 +01:00 [INF] Hosting environment: Development
2022-09-21 10:14:03.527 +01:00 [INF] Content root path: C:\Users\mguedesa\OneDrive - NTT DATA EMEAL\Documentos\GitHub\OpenBankAPI-NTT\APIBank\APIBank\
2022-09-21 10:14:03.528 +01:00 [DBG] Hosting started
2022-09-21 10:14:03.937 +01:00 [DBG] Connection id "0HMKRM6GGAOOV" accepted.
2022-09-21 10:14:03.937 +01:00 [DBG] Connection id "0HMKRM6GGAOOU" accepted.
2022-09-21 10:14:03.940 +01:00 [DBG] Connection id "0HMKRM6GGAOOV" started.
2022-09-21 10:14:03.940 +01:00 [DBG] Connection id "0HMKRM6GGAOOU" started.
2022-09-21 10:14:03.951 +01:00 [DBG] Connection id "0HMKRM6GGAOOV" received FIN.
2022-09-21 10:14:03.951 +01:00 [DBG] Connection id "0HMKRM6GGAOOU" received FIN.
2022-09-21 10:14:03.962 +01:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException:  Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveBlobAsync[TIOAdapter](TIOAdapter adapter)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](TIOAdapter adapter, Boolean receiveFirst, Byte[] reAuthenticationData, Boolean isApm)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2022-09-21 10:14:03.962 +01:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException:  Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveBlobAsync[TIOAdapter](TIOAdapter adapter)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](TIOAdapter adapter, Boolean receiveFirst, Byte[] reAuthenticationData, Boolean isApm)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2022-09-21 10:14:03.998 +01:00 [DBG] Connection id "0HMKRM6GGAOOV" stopped.
2022-09-21 10:14:03.998 +01:00 [DBG] Connection id "0HMKRM6GGAOOU" stopped.
2022-09-21 10:14:04.000 +01:00 [DBG] Connection id "0HMKRM6GGAOOV" sending FIN because: "The Socket transport's send loop completed gracefully."
2022-09-21 10:14:04.000 +01:00 [DBG] Connection id "0HMKRM6GGAOOU" sending FIN because: "The Socket transport's send loop completed gracefully."
2022-09-21 10:14:04.298 +01:00 [DBG] Connection id "0HMKRM6GGAOP0" accepted.
2022-09-21 10:14:04.349 +01:00 [DBG] Connection id "0HMKRM6GGAOP0" started.
2022-09-21 10:14:04.519 +01:00 [DBG] Connection 0HMKRM6GGAOP0 established using the following protocol: "Tls12"
2022-09-21 10:14:04.629 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/swagger/index.html - -
2022-09-21 10:14:04.696 +01:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2022-09-21 10:14:04.732 +01:00 [DBG] No candidates found for the request path '/swagger/index.html'
2022-09-21 10:14:04.736 +01:00 [DBG] Request did not match any endpoints
2022-09-21 10:14:04.853 +01:00 [DBG] Response markup is scheduled to include browser refresh script injection.
2022-09-21 10:14:05.065 +01:00 [DBG] Response markup was updated to include browser refresh script injection.
2022-09-21 10:14:05.073 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/swagger/index.html - - - 200 - text/html;charset=utf-8 451.6615ms
2022-09-21 10:14:05.101 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/_vs/browserLink - -
2022-09-21 10:14:05.101 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/_framework/aspnetcore-browser-refresh.js - -
2022-09-21 10:14:05.132 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/_framework/aspnetcore-browser-refresh.js - - - 200 11984 application/javascript;+charset=utf-8 31.6449ms
2022-09-21 10:14:05.182 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/_vs/browserLink - - - 200 - text/javascript;+charset=UTF-8 81.2608ms
2022-09-21 10:14:05.280 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/swagger/v1/swagger.json - -
2022-09-21 10:14:05.283 +01:00 [DBG] No candidates found for the request path '/swagger/v1/swagger.json'
2022-09-21 10:14:05.285 +01:00 [DBG] Request did not match any endpoints
2022-09-21 10:14:05.593 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/swagger/v1/swagger.json - - - 200 - application/json;charset=utf-8 312.4344ms
2022-09-21 10:14:13.429 +01:00 [INF] Request starting HTTP/2 POST https://localhost:7036/api/Users/Login application/json 58
2022-09-21 10:14:13.449 +01:00 [DBG] 1 candidate(s) found for the request path '/api/Users/Login'
2022-09-21 10:14:13.455 +01:00 [DBG] Endpoint 'APIBank.Controllers.UsersController.Login (APIBank)' with route pattern 'api/Users/Login' is valid for the request path '/api/Users/Login'
2022-09-21 10:14:13.458 +01:00 [DBG] Request matched endpoint 'APIBank.Controllers.UsersController.Login (APIBank)'
2022-09-21 10:14:13.465 +01:00 [DBG] Static files was skipped as the request already matched an endpoint.
2022-09-21 10:14:13.938 +01:00 [INF] Executing endpoint 'APIBank.Controllers.UsersController.Login (APIBank)'
2022-09-21 10:14:13.969 +01:00 [INF] Route matched with {action = "Login", controller = "Users"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult Login(APIBank.Models.Requests.LoginRequest) on controller APIBank.Controllers.UsersController (APIBank).
2022-09-21 10:14:13.974 +01:00 [DBG] Execution plan of authorization filters (in the following order): ["APIBank.Authorization.AuthorizeAttribute"]
2022-09-21 10:14:13.977 +01:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2022-09-21 10:14:13.980 +01:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2022-09-21 10:14:13.983 +01:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2022-09-21 10:14:13.984 +01:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2022-09-21 10:14:13.987 +01:00 [DBG] Executing controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-21 10:14:13.988 +01:00 [DBG] Executed controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-21 10:14:14.004 +01:00 [DBG] Attempting to bind parameter 'model' of type 'APIBank.Models.Requests.LoginRequest' ...
2022-09-21 10:14:14.007 +01:00 [DBG] Attempting to bind parameter 'model' of type 'APIBank.Models.Requests.LoginRequest' using the name '' in request data ...
2022-09-21 10:14:14.009 +01:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2022-09-21 10:14:14.016 +01:00 [DBG] Connection id "0HMKRM6GGAOP0", Request id "0HMKRM6GGAOP0:00000009": started reading request body.
2022-09-21 10:14:14.018 +01:00 [DBG] Connection id "0HMKRM6GGAOP0", Request id "0HMKRM6GGAOP0:00000009": done reading request body.
2022-09-21 10:14:14.024 +01:00 [DBG] JSON input formatter succeeded, deserializing to type 'APIBank.Models.Requests.LoginRequest'
2022-09-21 10:14:14.026 +01:00 [DBG] Done attempting to bind parameter 'model' of type 'APIBank.Models.Requests.LoginRequest'.
2022-09-21 10:14:14.028 +01:00 [DBG] Done attempting to bind parameter 'model' of type 'APIBank.Models.Requests.LoginRequest'.
2022-09-21 10:14:14.029 +01:00 [DBG] Attempting to validate the bound parameter 'model' of type 'APIBank.Models.Requests.LoginRequest' ...
2022-09-21 10:14:14.037 +01:00 [DBG] Done attempting to validate the bound parameter 'model' of type 'APIBank.Models.Requests.LoginRequest'.
2022-09-21 10:14:14.177 +01:00 [DBG] An additional 'IServiceProvider' was created for internal use by Entity Framework. An existing service provider was not used due to the following configuration changes: configuration changed for 'Core:ConfigureWarnings', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:UseAdminDatabase', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:SetPostgresVersion', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:UseRedshift', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:ReverseNullOrdering', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:RemoteCertificateValidationCallback', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:ProvideClientCertificatesCallback', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:ProvidePasswordCallback'.
2022-09-21 10:14:15.806 +01:00 [INF] Entity Framework Core 6.0.9 initialized 'PostgresContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:6.0.7+5b98e4b74de93b590b44aef8dd7967c03acc433c' with options: None
2022-09-21 10:14:15.891 +01:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .SingleOrDefault(x => x.Username == __model_Username_0)'
2022-09-21 10:14:16.411 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<User>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: User.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: User.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 1], [Property: User.Email (string) Required Index MaxLength(254), 2], [Property: User.FullName (string) Required MaxLength(100), 3], [Property: User.PasswordChangedAt (DateTime) Required ValueGenerated.OnAdd, 4], [Property: User.PasswordHash (string) Required MaxLength(200), 5], [Property: User.Username (string) Required Index MaxLength(50), 6] }
        SELECT TOP(2) u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
        FROM users AS u
        WHERE u.username == @__model_Username_0), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, User>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)
    .SingleOrDefault()'
2022-09-21 10:14:16.513 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-21 10:14:16.641 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (124ms).
2022-09-21 10:14:16.653 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-21 10:14:17.022 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 10:14:17.066 +01:00 [DBG] Executing DbCommand [Parameters=[@__model_Username_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.username = @__model_Username_0
LIMIT 2
2022-09-21 10:14:17.274 +01:00 [INF] Executed DbCommand (228ms) [Parameters=[@__model_Username_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.username = @__model_Username_0
LIMIT 2
2022-09-21 10:14:17.381 +01:00 [DBG] Context 'PostgresContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 10:14:17.454 +01:00 [DBG] A data reader was disposed.
2022-09-21 10:14:17.463 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 10:14:17.472 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-21 10:14:17.973 +01:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .Any(user => user.RefreshTokenCollection
        .Any(reftoken => reftoken.RefToken == __token_0))'
2022-09-21 10:14:18.180 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<bool>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            EmptyProjectionMember -> 0
        SELECT EXISTS (
            SELECT 1
            FROM users AS u
            WHERE EXISTS (
                SELECT 1
                FROM refresh_token AS r
                WHERE ((u.id != NULL) && (u.id == r.user_id)) && (r.token == @__token_0)))), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, bool>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)
    .Single()'
2022-09-21 10:14:18.197 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-21 10:14:18.199 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (2ms).
2022-09-21 10:14:18.200 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-21 10:14:18.201 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 10:14:18.202 +01:00 [DBG] Executing DbCommand [Parameters=[@__token_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM users AS u
    WHERE EXISTS (
        SELECT 1
        FROM refresh_token AS r
        WHERE (u.id = r.user_id) AND (r.token = @__token_0)))
2022-09-21 10:14:18.208 +01:00 [INF] Executed DbCommand (5ms) [Parameters=[@__token_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM users AS u
    WHERE EXISTS (
        SELECT 1
        FROM refresh_token AS r
        WHERE (u.id = r.user_id) AND (r.token = @__token_0)))
2022-09-21 10:14:18.219 +01:00 [DBG] A data reader was disposed.
2022-09-21 10:14:18.220 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 10:14:18.222 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-21 10:14:18.242 +01:00 [DBG] Compiling query expression: 
'DbSet<RefreshToken>()
    .Where(rt => rt.UserId == __id_0)
    .AsNoTracking()
    .Select(rt => new RefreshToken{ 
        Id = rt.Id, 
        UserId = rt.UserId, 
        RefToken = rt.RefToken, 
        Expires = rt.Expires, 
        Created = rt.Created, 
        CreatedByIp = rt.CreatedByIp, 
        Revoked = rt.Revoked, 
        RevokedByIp = rt.RevokedByIp, 
        ReplacedByToken = rt.ReplacedByToken, 
        ReasonRevoked = rt.ReasonRevoked, 
        IsExpired = rt.IsExpired, 
        IsRevoked = rt.IsRevoked, 
        IsActive = rt.IsActive 
    }
    )'
2022-09-21 10:14:18.281 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<RefreshToken>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            Id -> 0
            UserId -> 1
            RefToken -> 2
            Expires -> 3
            Created -> 4
            CreatedByIp -> 5
            Revoked -> 6
            RevokedByIp -> 7
            ReplacedByToken -> 8
            ReasonRevoked -> 9
            IsExpired -> 10
            IsRevoked -> 11
            IsActive -> 12
        SELECT r.id AS Id, r.user_id AS UserId, r.token AS RefToken, r.expires AS Expires, r.created AS Created, r.created_by_ip AS CreatedByIp, r.revoked AS Revoked, r.revoked_by_ip AS RevokedByIp, r.replaced_by_token AS ReplacedByToken, r.reason_revoked AS ReasonRevoked, r.is_expired AS IsExpired, r.is_revoked AS IsRevoked, r.is_active AS IsActive
        FROM refresh_token AS r
        WHERE r.user_id == @__id_0), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, RefreshToken>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)'
2022-09-21 10:14:18.288 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-21 10:14:18.292 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (4ms).
2022-09-21 10:14:18.294 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-21 10:14:18.295 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 10:14:18.298 +01:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.user_id AS "UserId", r.token AS "RefToken", r.expires AS "Expires", r.created AS "Created", r.created_by_ip AS "CreatedByIp", r.revoked AS "Revoked", r.revoked_by_ip AS "RevokedByIp", r.replaced_by_token AS "ReplacedByToken", r.reason_revoked AS "ReasonRevoked", r.is_expired AS "IsExpired", r.is_revoked AS "IsRevoked", r.is_active AS "IsActive"
FROM refresh_token AS r
WHERE r.user_id = @__id_0
2022-09-21 10:14:18.313 +01:00 [INF] Executed DbCommand (15ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.user_id AS "UserId", r.token AS "RefToken", r.expires AS "Expires", r.created AS "Created", r.created_by_ip AS "CreatedByIp", r.revoked AS "Revoked", r.revoked_by_ip AS "RevokedByIp", r.replaced_by_token AS "ReplacedByToken", r.reason_revoked AS "ReasonRevoked", r.is_expired AS "IsExpired", r.is_revoked AS "IsRevoked", r.is_active AS "IsActive"
FROM refresh_token AS r
WHERE r.user_id = @__id_0
2022-09-21 10:14:18.319 +01:00 [DBG] A data reader was disposed.
2022-09-21 10:14:18.320 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 10:14:18.321 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-21 10:14:18.348 +01:00 [DBG] An entity of type 'User' tracked by 'PostgresContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 10:14:18.419 +01:00 [DBG] 'PostgresContext' generated a temporary value for the property 'Id.RefreshToken'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 10:14:18.470 +01:00 [DBG] Context 'PostgresContext' started tracking 'RefreshToken' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 10:14:18.482 +01:00 [DBG] SaveChanges starting for 'PostgresContext'.
2022-09-21 10:14:18.490 +01:00 [DBG] DetectChanges starting for 'PostgresContext'.
2022-09-21 10:14:18.545 +01:00 [DBG] 1 entities were added and 0 entities were removed from navigation 'User.RefreshTokenCollection'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 10:14:18.577 +01:00 [DBG] The foreign key property 'RefreshToken.UserId' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2022-09-21 10:14:18.615 +01:00 [DBG] DetectChanges completed for 'PostgresContext'.
2022-09-21 10:14:18.633 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-21 10:14:18.634 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 10:14:18.638 +01:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2022-09-21 10:14:18.650 +01:00 [DBG] Began transaction with isolation level 'ReadCommitted'.
2022-09-21 10:14:18.727 +01:00 [DBG] Executing 2 update commands as a batch.
2022-09-21 10:14:18.747 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-21 10:14:18.749 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (2ms).
2022-09-21 10:14:18.751 +01:00 [DBG] Executing DbCommand [Parameters=[@p0='?' (DbType = DateTime), @p1='?', @p2='?' (DbType = DateTime), @p3='?' (DbType = Boolean), @p4='?' (DbType = Boolean), @p5='?' (DbType = Boolean), @p6='?', @p7='?', @p8='?', @p9='?' (DbType = DateTime), @p10='?', @p11='?' (DbType = Int32), @p18='?' (DbType = Int32), @p12='?' (DbType = DateTime), @p13='?', @p14='?', @p15='?' (DbType = DateTime), @p16='?', @p17='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO refresh_token (created, created_by_ip, expires, is_active, is_expired, is_revoked, reason_revoked, token, replaced_by_token, revoked, revoked_by_ip, user_id)
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11)
RETURNING id;
UPDATE users SET created_at = @p12, email = @p13, full_name = @p14, password_changed_at = @p15, password_hash = @p16, username = @p17
WHERE id = @p18;
2022-09-21 10:14:18.767 +01:00 [INF] Executed DbCommand (16ms) [Parameters=[@p0='?' (DbType = DateTime), @p1='?', @p2='?' (DbType = DateTime), @p3='?' (DbType = Boolean), @p4='?' (DbType = Boolean), @p5='?' (DbType = Boolean), @p6='?', @p7='?', @p8='?', @p9='?' (DbType = DateTime), @p10='?', @p11='?' (DbType = Int32), @p18='?' (DbType = Int32), @p12='?' (DbType = DateTime), @p13='?', @p14='?', @p15='?' (DbType = DateTime), @p16='?', @p17='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO refresh_token (created, created_by_ip, expires, is_active, is_expired, is_revoked, reason_revoked, token, replaced_by_token, revoked, revoked_by_ip, user_id)
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11)
RETURNING id;
UPDATE users SET created_at = @p12, email = @p13, full_name = @p14, password_changed_at = @p15, password_hash = @p16, username = @p17
WHERE id = @p18;
2022-09-21 10:14:18.796 +01:00 [DBG] The foreign key property 'RefreshToken.Id' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2022-09-21 10:14:18.800 +01:00 [DBG] A data reader was disposed.
2022-09-21 10:14:18.810 +01:00 [DBG] Committing transaction.
2022-09-21 10:14:18.826 +01:00 [DBG] Committed transaction.
2022-09-21 10:14:18.829 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 10:14:18.830 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-21 10:14:18.835 +01:00 [DBG] Disposing transaction.
2022-09-21 10:14:18.842 +01:00 [DBG] An entity of type 'RefreshToken' tracked by 'PostgresContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 10:14:18.846 +01:00 [DBG] An entity of type 'User' tracked by 'PostgresContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 10:14:18.849 +01:00 [DBG] SaveChanges completed for 'PostgresContext' with 2 entities written to the database.
2022-09-21 10:14:18.861 +01:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2022-09-21 10:14:18.868 +01:00 [DBG] Attempting to select an output formatter based on Accept header '["text/plain"]'.
2022-09-21 10:14:18.870 +01:00 [DBG] Could not find an output formatter based on content negotiation. Accepted types were (["text/plain"])
2022-09-21 10:14:18.873 +01:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2022-09-21 10:14:18.875 +01:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2022-09-21 10:14:18.876 +01:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2022-09-21 10:14:18.878 +01:00 [INF] Executing OkObjectResult, writing value of type 'APIBank.Models.Users.Responses.LoginResponse'.
2022-09-21 10:14:18.897 +01:00 [INF] Executed action APIBank.Controllers.UsersController.Login (APIBank) in 4905.8512ms
2022-09-21 10:14:18.899 +01:00 [INF] Executed endpoint 'APIBank.Controllers.UsersController.Login (APIBank)'
2022-09-21 10:14:18.906 +01:00 [DBG] 'PostgresContext' disposed.
2022-09-21 10:14:18.915 +01:00 [INF] Request finished HTTP/2 POST https://localhost:7036/api/Users/Login application/json 58 - 200 - application/json;+charset=utf-8 5486.3857ms
2022-09-21 10:15:00.766 +01:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2022-09-21 10:15:01.061 +01:00 [DBG] Hosting starting
2022-09-21 10:15:01.217 +01:00 [DBG] Using development certificate: CN=localhost (Thumbprint: 9CC642E9838495A6C3C202DECA6A8AD300396DD2)
2022-09-21 10:15:01.284 +01:00 [INF] Now listening on: https://localhost:7036
2022-09-21 10:15:01.286 +01:00 [INF] Now listening on: http://localhost:5036
2022-09-21 10:15:01.287 +01:00 [DBG] Loaded hosting startup assembly APIBank
2022-09-21 10:15:01.289 +01:00 [DBG] Loaded hosting startup assembly Microsoft.AspNetCore.Watch.BrowserRefresh
2022-09-21 10:15:01.290 +01:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.BrowserLink.Net
2022-09-21 10:15:01.291 +01:00 [INF] Application started. Press Ctrl+C to shut down.
2022-09-21 10:15:01.293 +01:00 [INF] Hosting environment: Development
2022-09-21 10:15:01.294 +01:00 [INF] Content root path: C:\Users\mguedesa\OneDrive - NTT DATA EMEAL\Documentos\GitHub\OpenBankAPI-NTT\APIBank\APIBank\
2022-09-21 10:15:01.295 +01:00 [DBG] Hosting started
2022-09-21 10:15:01.402 +01:00 [DBG] Connection id "0HMKRM71KCGBD" received FIN.
2022-09-21 10:15:01.402 +01:00 [DBG] Connection id "0HMKRM71KCGBE" received FIN.
2022-09-21 10:15:01.417 +01:00 [DBG] Connection id "0HMKRM71KCGBD" accepted.
2022-09-21 10:15:01.417 +01:00 [DBG] Connection id "0HMKRM71KCGBE" accepted.
2022-09-21 10:15:01.421 +01:00 [DBG] Connection id "0HMKRM71KCGBD" started.
2022-09-21 10:15:01.421 +01:00 [DBG] Connection id "0HMKRM71KCGBE" started.
2022-09-21 10:15:01.463 +01:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException:  Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveBlobAsync[TIOAdapter](TIOAdapter adapter)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](TIOAdapter adapter, Boolean receiveFirst, Byte[] reAuthenticationData, Boolean isApm)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2022-09-21 10:15:01.463 +01:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException:  Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveBlobAsync[TIOAdapter](TIOAdapter adapter)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](TIOAdapter adapter, Boolean receiveFirst, Byte[] reAuthenticationData, Boolean isApm)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2022-09-21 10:15:01.561 +01:00 [DBG] Connection id "0HMKRM71KCGBD" stopped.
2022-09-21 10:15:01.561 +01:00 [DBG] Connection id "0HMKRM71KCGBE" stopped.
2022-09-21 10:15:01.566 +01:00 [DBG] Connection id "0HMKRM71KCGBD" sending FIN because: "The Socket transport's send loop completed gracefully."
2022-09-21 10:15:01.566 +01:00 [DBG] Connection id "0HMKRM71KCGBE" sending FIN because: "The Socket transport's send loop completed gracefully."
2022-09-21 10:15:01.673 +01:00 [DBG] Connection id "0HMKRM71KCGBF" accepted.
2022-09-21 10:15:01.678 +01:00 [DBG] Connection id "0HMKRM71KCGBF" started.
2022-09-21 10:15:01.781 +01:00 [DBG] Connection 0HMKRM71KCGBF established using the following protocol: "Tls12"
2022-09-21 10:15:01.953 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/swagger/index.html - -
2022-09-21 10:15:02.054 +01:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2022-09-21 10:15:02.115 +01:00 [DBG] No candidates found for the request path '/swagger/index.html'
2022-09-21 10:15:02.119 +01:00 [DBG] Request did not match any endpoints
2022-09-21 10:15:02.272 +01:00 [DBG] Response markup is scheduled to include browser refresh script injection.
2022-09-21 10:15:02.437 +01:00 [DBG] Response markup was updated to include browser refresh script injection.
2022-09-21 10:15:02.445 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/swagger/index.html - - - 200 - text/html;charset=utf-8 497.7794ms
2022-09-21 10:15:02.467 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/_framework/aspnetcore-browser-refresh.js - -
2022-09-21 10:15:02.467 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/_vs/browserLink - -
2022-09-21 10:15:02.480 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/_framework/aspnetcore-browser-refresh.js - - - 200 11984 application/javascript;+charset=utf-8 12.7644ms
2022-09-21 10:15:02.539 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/_vs/browserLink - - - 200 - text/javascript;+charset=UTF-8 71.6799ms
2022-09-21 10:15:02.641 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/swagger/v1/swagger.json - -
2022-09-21 10:15:02.643 +01:00 [DBG] No candidates found for the request path '/swagger/v1/swagger.json'
2022-09-21 10:15:02.644 +01:00 [DBG] Request did not match any endpoints
2022-09-21 10:15:02.873 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/swagger/v1/swagger.json - - - 200 - application/json;charset=utf-8 231.6272ms
2022-09-21 10:15:09.654 +01:00 [INF] Request starting HTTP/2 POST https://localhost:7036/api/Users/Login application/json 58
2022-09-21 10:15:09.670 +01:00 [DBG] 1 candidate(s) found for the request path '/api/Users/Login'
2022-09-21 10:15:09.676 +01:00 [DBG] Endpoint 'APIBank.Controllers.UsersController.Login (APIBank)' with route pattern 'api/Users/Login' is valid for the request path '/api/Users/Login'
2022-09-21 10:15:09.684 +01:00 [DBG] Request matched endpoint 'APIBank.Controllers.UsersController.Login (APIBank)'
2022-09-21 10:15:09.688 +01:00 [DBG] Static files was skipped as the request already matched an endpoint.
2022-09-21 10:15:10.167 +01:00 [INF] Executing endpoint 'APIBank.Controllers.UsersController.Login (APIBank)'
2022-09-21 10:15:10.196 +01:00 [INF] Route matched with {action = "Login", controller = "Users"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult Login(APIBank.Models.Requests.LoginRequest) on controller APIBank.Controllers.UsersController (APIBank).
2022-09-21 10:15:10.199 +01:00 [DBG] Execution plan of authorization filters (in the following order): ["APIBank.Authorization.AuthorizeAttribute"]
2022-09-21 10:15:10.201 +01:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2022-09-21 10:15:10.202 +01:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2022-09-21 10:15:10.203 +01:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2022-09-21 10:15:10.205 +01:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2022-09-21 10:15:10.208 +01:00 [DBG] Executing controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-21 10:15:10.213 +01:00 [DBG] Executed controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-21 10:15:10.233 +01:00 [DBG] Attempting to bind parameter 'model' of type 'APIBank.Models.Requests.LoginRequest' ...
2022-09-21 10:15:10.239 +01:00 [DBG] Attempting to bind parameter 'model' of type 'APIBank.Models.Requests.LoginRequest' using the name '' in request data ...
2022-09-21 10:15:10.241 +01:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2022-09-21 10:15:10.254 +01:00 [DBG] Connection id "0HMKRM71KCGBF", Request id "0HMKRM71KCGBF:00000009": started reading request body.
2022-09-21 10:15:10.257 +01:00 [DBG] Connection id "0HMKRM71KCGBF", Request id "0HMKRM71KCGBF:00000009": done reading request body.
2022-09-21 10:15:10.267 +01:00 [DBG] JSON input formatter succeeded, deserializing to type 'APIBank.Models.Requests.LoginRequest'
2022-09-21 10:15:10.269 +01:00 [DBG] Done attempting to bind parameter 'model' of type 'APIBank.Models.Requests.LoginRequest'.
2022-09-21 10:15:10.270 +01:00 [DBG] Done attempting to bind parameter 'model' of type 'APIBank.Models.Requests.LoginRequest'.
2022-09-21 10:15:10.271 +01:00 [DBG] Attempting to validate the bound parameter 'model' of type 'APIBank.Models.Requests.LoginRequest' ...
2022-09-21 10:15:10.286 +01:00 [DBG] Done attempting to validate the bound parameter 'model' of type 'APIBank.Models.Requests.LoginRequest'.
2022-09-21 10:15:10.449 +01:00 [DBG] An additional 'IServiceProvider' was created for internal use by Entity Framework. An existing service provider was not used due to the following configuration changes: configuration changed for 'Core:ConfigureWarnings', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:UseAdminDatabase', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:SetPostgresVersion', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:UseRedshift', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:ReverseNullOrdering', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:RemoteCertificateValidationCallback', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:ProvideClientCertificatesCallback', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:ProvidePasswordCallback'.
2022-09-21 10:15:12.082 +01:00 [INF] Entity Framework Core 6.0.9 initialized 'PostgresContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:6.0.7+5b98e4b74de93b590b44aef8dd7967c03acc433c' with options: None
2022-09-21 10:15:12.169 +01:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .SingleOrDefault(x => x.Username == __model_Username_0)'
2022-09-21 10:15:12.749 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<User>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: User.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: User.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 1], [Property: User.Email (string) Required Index MaxLength(254), 2], [Property: User.FullName (string) Required MaxLength(100), 3], [Property: User.PasswordChangedAt (DateTime) Required ValueGenerated.OnAdd, 4], [Property: User.PasswordHash (string) Required MaxLength(200), 5], [Property: User.Username (string) Required Index MaxLength(50), 6] }
        SELECT TOP(2) u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
        FROM users AS u
        WHERE u.username == @__model_Username_0), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, User>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)
    .SingleOrDefault()'
2022-09-21 10:15:12.825 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-21 10:15:12.949 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (120ms).
2022-09-21 10:15:12.967 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-21 10:15:13.409 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 10:15:13.436 +01:00 [DBG] Executing DbCommand [Parameters=[@__model_Username_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.username = @__model_Username_0
LIMIT 2
2022-09-21 10:15:13.576 +01:00 [INF] Executed DbCommand (148ms) [Parameters=[@__model_Username_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.username = @__model_Username_0
LIMIT 2
2022-09-21 10:15:13.654 +01:00 [DBG] Context 'PostgresContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 10:15:13.738 +01:00 [DBG] A data reader was disposed.
2022-09-21 10:15:13.748 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 10:15:13.763 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-21 10:15:14.269 +01:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .Any(user => user.RefreshTokenCollection
        .Any(reftoken => reftoken.RefToken == __token_0))'
2022-09-21 10:15:14.416 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<bool>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            EmptyProjectionMember -> 0
        SELECT EXISTS (
            SELECT 1
            FROM users AS u
            WHERE EXISTS (
                SELECT 1
                FROM refresh_token AS r
                WHERE ((u.id != NULL) && (u.id == r.user_id)) && (r.token == @__token_0)))), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, bool>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)
    .Single()'
2022-09-21 10:15:14.435 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-21 10:15:14.436 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2022-09-21 10:15:14.437 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-21 10:15:14.437 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 10:15:14.438 +01:00 [DBG] Executing DbCommand [Parameters=[@__token_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM users AS u
    WHERE EXISTS (
        SELECT 1
        FROM refresh_token AS r
        WHERE (u.id = r.user_id) AND (r.token = @__token_0)))
2022-09-21 10:15:14.445 +01:00 [INF] Executed DbCommand (6ms) [Parameters=[@__token_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM users AS u
    WHERE EXISTS (
        SELECT 1
        FROM refresh_token AS r
        WHERE (u.id = r.user_id) AND (r.token = @__token_0)))
2022-09-21 10:15:14.449 +01:00 [DBG] A data reader was disposed.
2022-09-21 10:15:14.450 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 10:15:14.451 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-21 10:15:14.465 +01:00 [DBG] Compiling query expression: 
'DbSet<RefreshToken>()
    .Where(rt => rt.UserId == __id_0)
    .AsNoTracking()
    .Select(rt => new RefreshToken{ 
        Id = rt.Id, 
        UserId = rt.UserId, 
        RefToken = rt.RefToken, 
        Expires = rt.Expires, 
        Created = rt.Created, 
        CreatedByIp = rt.CreatedByIp, 
        Revoked = rt.Revoked, 
        RevokedByIp = rt.RevokedByIp, 
        ReplacedByToken = rt.ReplacedByToken, 
        ReasonRevoked = rt.ReasonRevoked, 
        IsExpired = rt.IsExpired, 
        IsRevoked = rt.IsRevoked, 
        IsActive = rt.IsActive 
    }
    )'
2022-09-21 10:15:14.493 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<RefreshToken>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            Id -> 0
            UserId -> 1
            RefToken -> 2
            Expires -> 3
            Created -> 4
            CreatedByIp -> 5
            Revoked -> 6
            RevokedByIp -> 7
            ReplacedByToken -> 8
            ReasonRevoked -> 9
            IsExpired -> 10
            IsRevoked -> 11
            IsActive -> 12
        SELECT r.id AS Id, r.user_id AS UserId, r.token AS RefToken, r.expires AS Expires, r.created AS Created, r.created_by_ip AS CreatedByIp, r.revoked AS Revoked, r.revoked_by_ip AS RevokedByIp, r.replaced_by_token AS ReplacedByToken, r.reason_revoked AS ReasonRevoked, r.is_expired AS IsExpired, r.is_revoked AS IsRevoked, r.is_active AS IsActive
        FROM refresh_token AS r
        WHERE r.user_id == @__id_0), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, RefreshToken>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)'
2022-09-21 10:15:14.497 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-21 10:15:14.498 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2022-09-21 10:15:14.499 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-21 10:15:14.500 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 10:15:14.501 +01:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.user_id AS "UserId", r.token AS "RefToken", r.expires AS "Expires", r.created AS "Created", r.created_by_ip AS "CreatedByIp", r.revoked AS "Revoked", r.revoked_by_ip AS "RevokedByIp", r.replaced_by_token AS "ReplacedByToken", r.reason_revoked AS "ReasonRevoked", r.is_expired AS "IsExpired", r.is_revoked AS "IsRevoked", r.is_active AS "IsActive"
FROM refresh_token AS r
WHERE r.user_id = @__id_0
2022-09-21 10:15:14.512 +01:00 [INF] Executed DbCommand (12ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.user_id AS "UserId", r.token AS "RefToken", r.expires AS "Expires", r.created AS "Created", r.created_by_ip AS "CreatedByIp", r.revoked AS "Revoked", r.revoked_by_ip AS "RevokedByIp", r.replaced_by_token AS "ReplacedByToken", r.reason_revoked AS "ReasonRevoked", r.is_expired AS "IsExpired", r.is_revoked AS "IsRevoked", r.is_active AS "IsActive"
FROM refresh_token AS r
WHERE r.user_id = @__id_0
2022-09-21 10:15:14.515 +01:00 [DBG] A data reader was disposed.
2022-09-21 10:15:14.516 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 10:15:14.516 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-21 10:15:14.533 +01:00 [DBG] An entity of type 'User' tracked by 'PostgresContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 10:15:14.577 +01:00 [DBG] 'PostgresContext' generated a temporary value for the property 'Id.RefreshToken'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 10:15:14.632 +01:00 [DBG] Context 'PostgresContext' started tracking 'RefreshToken' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 10:15:14.643 +01:00 [DBG] SaveChanges starting for 'PostgresContext'.
2022-09-21 10:15:14.649 +01:00 [DBG] DetectChanges starting for 'PostgresContext'.
2022-09-21 10:15:14.698 +01:00 [DBG] 1 entities were added and 0 entities were removed from navigation 'User.RefreshTokenCollection'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 10:15:14.722 +01:00 [DBG] The foreign key property 'RefreshToken.UserId' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2022-09-21 10:15:14.753 +01:00 [DBG] DetectChanges completed for 'PostgresContext'.
2022-09-21 10:15:14.773 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-21 10:15:14.776 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 10:15:14.780 +01:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2022-09-21 10:15:14.789 +01:00 [DBG] Began transaction with isolation level 'ReadCommitted'.
2022-09-21 10:15:14.882 +01:00 [DBG] Executing 2 update commands as a batch.
2022-09-21 10:15:14.915 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-21 10:15:14.917 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2022-09-21 10:15:14.920 +01:00 [DBG] Executing DbCommand [Parameters=[@p0='?' (DbType = DateTime), @p1='?', @p2='?' (DbType = DateTime), @p3='?' (DbType = Boolean), @p4='?' (DbType = Boolean), @p5='?' (DbType = Boolean), @p6='?', @p7='?', @p8='?', @p9='?' (DbType = DateTime), @p10='?', @p11='?' (DbType = Int32), @p18='?' (DbType = Int32), @p12='?' (DbType = DateTime), @p13='?', @p14='?', @p15='?' (DbType = DateTime), @p16='?', @p17='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO refresh_token (created, created_by_ip, expires, is_active, is_expired, is_revoked, reason_revoked, token, replaced_by_token, revoked, revoked_by_ip, user_id)
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11)
RETURNING id;
UPDATE users SET created_at = @p12, email = @p13, full_name = @p14, password_changed_at = @p15, password_hash = @p16, username = @p17
WHERE id = @p18;
2022-09-21 10:15:14.935 +01:00 [INF] Executed DbCommand (15ms) [Parameters=[@p0='?' (DbType = DateTime), @p1='?', @p2='?' (DbType = DateTime), @p3='?' (DbType = Boolean), @p4='?' (DbType = Boolean), @p5='?' (DbType = Boolean), @p6='?', @p7='?', @p8='?', @p9='?' (DbType = DateTime), @p10='?', @p11='?' (DbType = Int32), @p18='?' (DbType = Int32), @p12='?' (DbType = DateTime), @p13='?', @p14='?', @p15='?' (DbType = DateTime), @p16='?', @p17='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO refresh_token (created, created_by_ip, expires, is_active, is_expired, is_revoked, reason_revoked, token, replaced_by_token, revoked, revoked_by_ip, user_id)
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11)
RETURNING id;
UPDATE users SET created_at = @p12, email = @p13, full_name = @p14, password_changed_at = @p15, password_hash = @p16, username = @p17
WHERE id = @p18;
2022-09-21 10:15:14.954 +01:00 [DBG] The foreign key property 'RefreshToken.Id' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2022-09-21 10:15:14.959 +01:00 [DBG] A data reader was disposed.
2022-09-21 10:15:14.965 +01:00 [DBG] Committing transaction.
2022-09-21 10:15:14.977 +01:00 [DBG] Committed transaction.
2022-09-21 10:15:14.980 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 10:15:14.982 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-21 10:15:14.985 +01:00 [DBG] Disposing transaction.
2022-09-21 10:15:14.988 +01:00 [DBG] An entity of type 'RefreshToken' tracked by 'PostgresContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 10:15:14.991 +01:00 [DBG] An entity of type 'User' tracked by 'PostgresContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 10:15:14.997 +01:00 [DBG] SaveChanges completed for 'PostgresContext' with 2 entities written to the database.
2022-09-21 10:15:15.004 +01:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2022-09-21 10:15:15.011 +01:00 [DBG] Attempting to select an output formatter based on Accept header '["text/plain"]'.
2022-09-21 10:15:15.013 +01:00 [DBG] Could not find an output formatter based on content negotiation. Accepted types were (["text/plain"])
2022-09-21 10:15:15.014 +01:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2022-09-21 10:15:15.015 +01:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2022-09-21 10:15:15.017 +01:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2022-09-21 10:15:15.018 +01:00 [INF] Executing OkObjectResult, writing value of type 'APIBank.Models.Users.Responses.LoginResponse'.
2022-09-21 10:15:15.037 +01:00 [INF] Executed action APIBank.Controllers.UsersController.Login (APIBank) in 4824.9475ms
2022-09-21 10:15:15.038 +01:00 [INF] Executed endpoint 'APIBank.Controllers.UsersController.Login (APIBank)'
2022-09-21 10:15:15.047 +01:00 [DBG] 'PostgresContext' disposed.
2022-09-21 10:15:15.054 +01:00 [INF] Request finished HTTP/2 POST https://localhost:7036/api/Users/Login application/json 58 - 200 - application/json;+charset=utf-8 5401.2269ms
2022-09-21 10:15:55.688 +01:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2022-09-21 10:15:55.813 +01:00 [DBG] Hosting starting
2022-09-21 10:15:55.994 +01:00 [DBG] Using development certificate: CN=localhost (Thumbprint: 9CC642E9838495A6C3C202DECA6A8AD300396DD2)
2022-09-21 10:15:56.046 +01:00 [INF] Now listening on: https://localhost:7036
2022-09-21 10:15:56.047 +01:00 [INF] Now listening on: http://localhost:5036
2022-09-21 10:15:56.047 +01:00 [DBG] Loaded hosting startup assembly APIBank
2022-09-21 10:15:56.048 +01:00 [DBG] Loaded hosting startup assembly Microsoft.AspNetCore.Watch.BrowserRefresh
2022-09-21 10:15:56.049 +01:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.BrowserLink.Net
2022-09-21 10:15:56.049 +01:00 [INF] Application started. Press Ctrl+C to shut down.
2022-09-21 10:15:56.050 +01:00 [INF] Hosting environment: Development
2022-09-21 10:15:56.051 +01:00 [INF] Content root path: C:\Users\mguedesa\OneDrive - NTT DATA EMEAL\Documentos\GitHub\OpenBankAPI-NTT\APIBank\APIBank\
2022-09-21 10:15:56.052 +01:00 [DBG] Hosting started
2022-09-21 10:15:56.357 +01:00 [DBG] Connection id "0HMKRM7I0FG5K" received FIN.
2022-09-21 10:15:56.362 +01:00 [DBG] Connection id "0HMKRM7I0FG5K" accepted.
2022-09-21 10:15:56.362 +01:00 [DBG] Connection id "0HMKRM7I0FG5L" accepted.
2022-09-21 10:15:56.358 +01:00 [DBG] Connection id "0HMKRM7I0FG5M" received FIN.
2022-09-21 10:15:56.412 +01:00 [DBG] Connection id "0HMKRM7I0FG5K" started.
2022-09-21 10:15:56.439 +01:00 [DBG] Connection id "0HMKRM7I0FG5L" started.
2022-09-21 10:15:56.490 +01:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException:  Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveBlobAsync[TIOAdapter](TIOAdapter adapter)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](TIOAdapter adapter, Boolean receiveFirst, Byte[] reAuthenticationData, Boolean isApm)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2022-09-21 10:15:56.491 +01:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException:  Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveBlobAsync[TIOAdapter](TIOAdapter adapter)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](TIOAdapter adapter, Boolean receiveFirst, Byte[] reAuthenticationData, Boolean isApm)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2022-09-21 10:15:56.663 +01:00 [DBG] Connection id "0HMKRM7I0FG5N" accepted.
2022-09-21 10:15:56.700 +01:00 [DBG] Connection id "0HMKRM7I0FG5N" started.
2022-09-21 10:15:56.702 +01:00 [DBG] Connection id "0HMKRM7I0FG5K" stopped.
2022-09-21 10:15:56.702 +01:00 [DBG] Connection id "0HMKRM7I0FG5L" stopped.
2022-09-21 10:15:56.752 +01:00 [DBG] Connection id "0HMKRM7I0FG5K" sending FIN because: "The Socket transport's send loop completed gracefully."
2022-09-21 10:15:56.759 +01:00 [DBG] Connection id "0HMKRM7I0FG5L" sending FIN because: "The Socket transport's send loop completed gracefully."
2022-09-21 10:15:56.831 +01:00 [DBG] Connection 0HMKRM7I0FG5N established using the following protocol: "Tls12"
2022-09-21 10:15:56.915 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/swagger/index.html - -
2022-09-21 10:15:56.957 +01:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2022-09-21 10:15:56.985 +01:00 [DBG] No candidates found for the request path '/swagger/index.html'
2022-09-21 10:15:56.986 +01:00 [DBG] Request did not match any endpoints
2022-09-21 10:15:57.096 +01:00 [DBG] Response markup is scheduled to include browser refresh script injection.
2022-09-21 10:15:57.270 +01:00 [DBG] Response markup was updated to include browser refresh script injection.
2022-09-21 10:15:57.281 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/swagger/index.html - - - 200 - text/html;charset=utf-8 368.7182ms
2022-09-21 10:15:57.321 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/_framework/aspnetcore-browser-refresh.js - -
2022-09-21 10:15:57.321 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/_vs/browserLink - -
2022-09-21 10:15:57.331 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/_framework/aspnetcore-browser-refresh.js - - - 200 11984 application/javascript;+charset=utf-8 10.5224ms
2022-09-21 10:15:57.353 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/_vs/browserLink - - - 200 - text/javascript;+charset=UTF-8 32.5998ms
2022-09-21 10:15:57.436 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/swagger/v1/swagger.json - -
2022-09-21 10:15:57.440 +01:00 [DBG] No candidates found for the request path '/swagger/v1/swagger.json'
2022-09-21 10:15:57.441 +01:00 [DBG] Request did not match any endpoints
2022-09-21 10:15:57.731 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/swagger/v1/swagger.json - - - 200 - application/json;charset=utf-8 295.1289ms
2022-09-21 10:16:04.050 +01:00 [INF] Request starting HTTP/2 POST https://localhost:7036/api/Users/Login application/json 58
2022-09-21 10:16:04.062 +01:00 [DBG] 1 candidate(s) found for the request path '/api/Users/Login'
2022-09-21 10:16:04.071 +01:00 [DBG] Endpoint 'APIBank.Controllers.UsersController.Login (APIBank)' with route pattern 'api/Users/Login' is valid for the request path '/api/Users/Login'
2022-09-21 10:16:04.075 +01:00 [DBG] Request matched endpoint 'APIBank.Controllers.UsersController.Login (APIBank)'
2022-09-21 10:16:04.079 +01:00 [DBG] Static files was skipped as the request already matched an endpoint.
2022-09-21 10:16:04.570 +01:00 [INF] Executing endpoint 'APIBank.Controllers.UsersController.Login (APIBank)'
2022-09-21 10:16:04.590 +01:00 [INF] Route matched with {action = "Login", controller = "Users"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult Login(APIBank.Models.Requests.LoginRequest) on controller APIBank.Controllers.UsersController (APIBank).
2022-09-21 10:16:04.593 +01:00 [DBG] Execution plan of authorization filters (in the following order): ["APIBank.Authorization.AuthorizeAttribute"]
2022-09-21 10:16:04.595 +01:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2022-09-21 10:16:04.596 +01:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2022-09-21 10:16:04.599 +01:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2022-09-21 10:16:04.601 +01:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2022-09-21 10:16:04.603 +01:00 [DBG] Executing controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-21 10:16:04.604 +01:00 [DBG] Executed controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-21 10:16:04.621 +01:00 [DBG] Attempting to bind parameter 'model' of type 'APIBank.Models.Requests.LoginRequest' ...
2022-09-21 10:16:04.626 +01:00 [DBG] Attempting to bind parameter 'model' of type 'APIBank.Models.Requests.LoginRequest' using the name '' in request data ...
2022-09-21 10:16:04.629 +01:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2022-09-21 10:16:04.638 +01:00 [DBG] Connection id "0HMKRM7I0FG5N", Request id "0HMKRM7I0FG5N:00000009": started reading request body.
2022-09-21 10:16:04.639 +01:00 [DBG] Connection id "0HMKRM7I0FG5N", Request id "0HMKRM7I0FG5N:00000009": done reading request body.
2022-09-21 10:16:04.649 +01:00 [DBG] JSON input formatter succeeded, deserializing to type 'APIBank.Models.Requests.LoginRequest'
2022-09-21 10:16:04.651 +01:00 [DBG] Done attempting to bind parameter 'model' of type 'APIBank.Models.Requests.LoginRequest'.
2022-09-21 10:16:04.652 +01:00 [DBG] Done attempting to bind parameter 'model' of type 'APIBank.Models.Requests.LoginRequest'.
2022-09-21 10:16:04.654 +01:00 [DBG] Attempting to validate the bound parameter 'model' of type 'APIBank.Models.Requests.LoginRequest' ...
2022-09-21 10:16:04.666 +01:00 [DBG] Done attempting to validate the bound parameter 'model' of type 'APIBank.Models.Requests.LoginRequest'.
2022-09-21 10:16:04.817 +01:00 [DBG] An additional 'IServiceProvider' was created for internal use by Entity Framework. An existing service provider was not used due to the following configuration changes: configuration changed for 'Core:ConfigureWarnings', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:UseAdminDatabase', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:SetPostgresVersion', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:UseRedshift', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:ReverseNullOrdering', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:RemoteCertificateValidationCallback', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:ProvideClientCertificatesCallback', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:ProvidePasswordCallback'.
2022-09-21 10:16:06.385 +01:00 [INF] Entity Framework Core 6.0.9 initialized 'PostgresContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:6.0.7+5b98e4b74de93b590b44aef8dd7967c03acc433c' with options: None
2022-09-21 10:16:06.473 +01:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .SingleOrDefault(x => x.Username == __model_Username_0)'
2022-09-21 10:16:07.016 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<User>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: User.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: User.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 1], [Property: User.Email (string) Required Index MaxLength(254), 2], [Property: User.FullName (string) Required MaxLength(100), 3], [Property: User.PasswordChangedAt (DateTime) Required ValueGenerated.OnAdd, 4], [Property: User.PasswordHash (string) Required MaxLength(200), 5], [Property: User.Username (string) Required Index MaxLength(50), 6] }
        SELECT TOP(2) u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
        FROM users AS u
        WHERE u.username == @__model_Username_0), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, User>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)
    .SingleOrDefault()'
2022-09-21 10:16:07.085 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-21 10:16:07.223 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (134ms).
2022-09-21 10:16:07.242 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-21 10:16:07.584 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 10:16:07.615 +01:00 [DBG] Executing DbCommand [Parameters=[@__model_Username_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.username = @__model_Username_0
LIMIT 2
2022-09-21 10:16:07.768 +01:00 [INF] Executed DbCommand (168ms) [Parameters=[@__model_Username_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.username = @__model_Username_0
LIMIT 2
2022-09-21 10:16:07.854 +01:00 [DBG] Context 'PostgresContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 10:16:07.931 +01:00 [DBG] A data reader was disposed.
2022-09-21 10:16:07.939 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 10:16:07.952 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-21 10:16:08.463 +01:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .Any(user => user.RefreshTokenCollection
        .Any(reftoken => reftoken.RefToken == __token_0))'
2022-09-21 10:16:08.618 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<bool>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            EmptyProjectionMember -> 0
        SELECT EXISTS (
            SELECT 1
            FROM users AS u
            WHERE EXISTS (
                SELECT 1
                FROM refresh_token AS r
                WHERE ((u.id != NULL) && (u.id == r.user_id)) && (r.token == @__token_0)))), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, bool>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)
    .Single()'
2022-09-21 10:16:08.634 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-21 10:16:08.635 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2022-09-21 10:16:08.636 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-21 10:16:08.638 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 10:16:08.638 +01:00 [DBG] Executing DbCommand [Parameters=[@__token_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM users AS u
    WHERE EXISTS (
        SELECT 1
        FROM refresh_token AS r
        WHERE (u.id = r.user_id) AND (r.token = @__token_0)))
2022-09-21 10:16:08.641 +01:00 [INF] Executed DbCommand (3ms) [Parameters=[@__token_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM users AS u
    WHERE EXISTS (
        SELECT 1
        FROM refresh_token AS r
        WHERE (u.id = r.user_id) AND (r.token = @__token_0)))
2022-09-21 10:16:08.647 +01:00 [DBG] A data reader was disposed.
2022-09-21 10:16:08.648 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 10:16:08.649 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-21 10:16:08.662 +01:00 [DBG] Compiling query expression: 
'DbSet<RefreshToken>()
    .Where(rt => rt.UserId == __id_0)
    .AsNoTracking()
    .Select(rt => new RefreshToken{ 
        Id = rt.Id, 
        UserId = rt.UserId, 
        RefToken = rt.RefToken, 
        Expires = rt.Expires, 
        Created = rt.Created, 
        CreatedByIp = rt.CreatedByIp, 
        Revoked = rt.Revoked, 
        RevokedByIp = rt.RevokedByIp, 
        ReplacedByToken = rt.ReplacedByToken, 
        ReasonRevoked = rt.ReasonRevoked, 
        IsExpired = rt.IsExpired, 
        IsRevoked = rt.IsRevoked, 
        IsActive = rt.IsActive 
    }
    )'
2022-09-21 10:16:08.686 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<RefreshToken>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            Id -> 0
            UserId -> 1
            RefToken -> 2
            Expires -> 3
            Created -> 4
            CreatedByIp -> 5
            Revoked -> 6
            RevokedByIp -> 7
            ReplacedByToken -> 8
            ReasonRevoked -> 9
            IsExpired -> 10
            IsRevoked -> 11
            IsActive -> 12
        SELECT r.id AS Id, r.user_id AS UserId, r.token AS RefToken, r.expires AS Expires, r.created AS Created, r.created_by_ip AS CreatedByIp, r.revoked AS Revoked, r.revoked_by_ip AS RevokedByIp, r.replaced_by_token AS ReplacedByToken, r.reason_revoked AS ReasonRevoked, r.is_expired AS IsExpired, r.is_revoked AS IsRevoked, r.is_active AS IsActive
        FROM refresh_token AS r
        WHERE r.user_id == @__id_0), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, RefreshToken>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)'
2022-09-21 10:16:08.689 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-21 10:16:08.690 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2022-09-21 10:16:08.691 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-21 10:16:08.691 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 10:16:08.693 +01:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.user_id AS "UserId", r.token AS "RefToken", r.expires AS "Expires", r.created AS "Created", r.created_by_ip AS "CreatedByIp", r.revoked AS "Revoked", r.revoked_by_ip AS "RevokedByIp", r.replaced_by_token AS "ReplacedByToken", r.reason_revoked AS "ReasonRevoked", r.is_expired AS "IsExpired", r.is_revoked AS "IsRevoked", r.is_active AS "IsActive"
FROM refresh_token AS r
WHERE r.user_id = @__id_0
2022-09-21 10:16:08.701 +01:00 [INF] Executed DbCommand (8ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.user_id AS "UserId", r.token AS "RefToken", r.expires AS "Expires", r.created AS "Created", r.created_by_ip AS "CreatedByIp", r.revoked AS "Revoked", r.revoked_by_ip AS "RevokedByIp", r.replaced_by_token AS "ReplacedByToken", r.reason_revoked AS "ReasonRevoked", r.is_expired AS "IsExpired", r.is_revoked AS "IsRevoked", r.is_active AS "IsActive"
FROM refresh_token AS r
WHERE r.user_id = @__id_0
2022-09-21 10:16:08.703 +01:00 [DBG] A data reader was disposed.
2022-09-21 10:16:08.704 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 10:16:08.704 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-21 10:16:08.721 +01:00 [DBG] An entity of type 'User' tracked by 'PostgresContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 10:16:08.766 +01:00 [DBG] 'PostgresContext' generated a temporary value for the property 'Id.RefreshToken'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 10:16:08.828 +01:00 [DBG] Context 'PostgresContext' started tracking 'RefreshToken' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 10:16:08.833 +01:00 [DBG] SaveChanges starting for 'PostgresContext'.
2022-09-21 10:16:08.836 +01:00 [DBG] DetectChanges starting for 'PostgresContext'.
2022-09-21 10:16:08.873 +01:00 [DBG] 1 entities were added and 0 entities were removed from navigation 'User.RefreshTokenCollection'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 10:16:08.897 +01:00 [DBG] The foreign key property 'RefreshToken.UserId' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2022-09-21 10:16:08.922 +01:00 [DBG] DetectChanges completed for 'PostgresContext'.
2022-09-21 10:16:08.939 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-21 10:16:08.941 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 10:16:08.948 +01:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2022-09-21 10:16:08.965 +01:00 [DBG] Began transaction with isolation level 'ReadCommitted'.
2022-09-21 10:16:09.062 +01:00 [DBG] Executing 2 update commands as a batch.
2022-09-21 10:16:09.096 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-21 10:16:09.098 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2022-09-21 10:16:09.100 +01:00 [DBG] Executing DbCommand [Parameters=[@p0='?' (DbType = DateTime), @p1='?', @p2='?' (DbType = DateTime), @p3='?' (DbType = Boolean), @p4='?' (DbType = Boolean), @p5='?' (DbType = Boolean), @p6='?', @p7='?', @p8='?', @p9='?' (DbType = DateTime), @p10='?', @p11='?' (DbType = Int32), @p18='?' (DbType = Int32), @p12='?' (DbType = DateTime), @p13='?', @p14='?', @p15='?' (DbType = DateTime), @p16='?', @p17='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO refresh_token (created, created_by_ip, expires, is_active, is_expired, is_revoked, reason_revoked, token, replaced_by_token, revoked, revoked_by_ip, user_id)
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11)
RETURNING id;
UPDATE users SET created_at = @p12, email = @p13, full_name = @p14, password_changed_at = @p15, password_hash = @p16, username = @p17
WHERE id = @p18;
2022-09-21 10:16:09.117 +01:00 [INF] Executed DbCommand (16ms) [Parameters=[@p0='?' (DbType = DateTime), @p1='?', @p2='?' (DbType = DateTime), @p3='?' (DbType = Boolean), @p4='?' (DbType = Boolean), @p5='?' (DbType = Boolean), @p6='?', @p7='?', @p8='?', @p9='?' (DbType = DateTime), @p10='?', @p11='?' (DbType = Int32), @p18='?' (DbType = Int32), @p12='?' (DbType = DateTime), @p13='?', @p14='?', @p15='?' (DbType = DateTime), @p16='?', @p17='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO refresh_token (created, created_by_ip, expires, is_active, is_expired, is_revoked, reason_revoked, token, replaced_by_token, revoked, revoked_by_ip, user_id)
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11)
RETURNING id;
UPDATE users SET created_at = @p12, email = @p13, full_name = @p14, password_changed_at = @p15, password_hash = @p16, username = @p17
WHERE id = @p18;
2022-09-21 10:16:09.138 +01:00 [DBG] The foreign key property 'RefreshToken.Id' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2022-09-21 10:16:09.141 +01:00 [DBG] A data reader was disposed.
2022-09-21 10:16:09.146 +01:00 [DBG] Committing transaction.
2022-09-21 10:16:09.162 +01:00 [DBG] Committed transaction.
2022-09-21 10:16:09.165 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 10:16:09.168 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-21 10:16:09.177 +01:00 [DBG] Disposing transaction.
2022-09-21 10:16:09.182 +01:00 [DBG] An entity of type 'RefreshToken' tracked by 'PostgresContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 10:16:09.185 +01:00 [DBG] An entity of type 'User' tracked by 'PostgresContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 10:16:09.190 +01:00 [DBG] SaveChanges completed for 'PostgresContext' with 2 entities written to the database.
2022-09-21 10:16:09.202 +01:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2022-09-21 10:16:09.208 +01:00 [DBG] Attempting to select an output formatter based on Accept header '["text/plain"]'.
2022-09-21 10:16:09.212 +01:00 [DBG] Could not find an output formatter based on content negotiation. Accepted types were (["text/plain"])
2022-09-21 10:16:09.214 +01:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2022-09-21 10:16:09.216 +01:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2022-09-21 10:16:09.217 +01:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2022-09-21 10:16:09.219 +01:00 [INF] Executing OkObjectResult, writing value of type 'APIBank.Models.Users.Responses.LoginResponse'.
2022-09-21 10:16:09.245 +01:00 [INF] Executed action APIBank.Controllers.UsersController.Login (APIBank) in 4633.0774ms
2022-09-21 10:16:09.247 +01:00 [INF] Executed endpoint 'APIBank.Controllers.UsersController.Login (APIBank)'
2022-09-21 10:16:09.253 +01:00 [DBG] 'PostgresContext' disposed.
2022-09-21 10:16:09.264 +01:00 [INF] Request finished HTTP/2 POST https://localhost:7036/api/Users/Login application/json 58 - 200 - application/json;+charset=utf-8 5214.0441ms
2022-09-21 10:16:56.106 +01:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2022-09-21 10:16:56.332 +01:00 [DBG] Hosting starting
2022-09-21 10:16:56.522 +01:00 [DBG] Using development certificate: CN=localhost (Thumbprint: 9CC642E9838495A6C3C202DECA6A8AD300396DD2)
2022-09-21 10:16:56.583 +01:00 [INF] Now listening on: https://localhost:7036
2022-09-21 10:16:56.585 +01:00 [INF] Now listening on: http://localhost:5036
2022-09-21 10:16:56.585 +01:00 [DBG] Loaded hosting startup assembly APIBank
2022-09-21 10:16:56.586 +01:00 [DBG] Loaded hosting startup assembly Microsoft.AspNetCore.Watch.BrowserRefresh
2022-09-21 10:16:56.587 +01:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.BrowserLink.Net
2022-09-21 10:16:56.588 +01:00 [INF] Application started. Press Ctrl+C to shut down.
2022-09-21 10:16:56.589 +01:00 [INF] Hosting environment: Development
2022-09-21 10:16:56.589 +01:00 [INF] Content root path: C:\Users\mguedesa\OneDrive - NTT DATA EMEAL\Documentos\GitHub\OpenBankAPI-NTT\APIBank\APIBank\
2022-09-21 10:16:56.590 +01:00 [DBG] Hosting started
2022-09-21 10:16:57.050 +01:00 [DBG] Connection id "0HMKRM84388U9" accepted.
2022-09-21 10:16:57.050 +01:00 [DBG] Connection id "0HMKRM84388U8" accepted.
2022-09-21 10:16:57.054 +01:00 [DBG] Connection id "0HMKRM84388U9" started.
2022-09-21 10:16:57.054 +01:00 [DBG] Connection id "0HMKRM84388U8" started.
2022-09-21 10:16:57.064 +01:00 [DBG] Connection id "0HMKRM84388U9" received FIN.
2022-09-21 10:16:57.064 +01:00 [DBG] Connection id "0HMKRM84388U8" received FIN.
2022-09-21 10:16:57.088 +01:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException:  Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveBlobAsync[TIOAdapter](TIOAdapter adapter)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](TIOAdapter adapter, Boolean receiveFirst, Byte[] reAuthenticationData, Boolean isApm)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2022-09-21 10:16:57.088 +01:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException:  Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveBlobAsync[TIOAdapter](TIOAdapter adapter)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](TIOAdapter adapter, Boolean receiveFirst, Byte[] reAuthenticationData, Boolean isApm)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2022-09-21 10:16:57.223 +01:00 [DBG] Connection id "0HMKRM84388U8" stopped.
2022-09-21 10:16:57.223 +01:00 [DBG] Connection id "0HMKRM84388U9" stopped.
2022-09-21 10:16:57.229 +01:00 [DBG] Connection id "0HMKRM84388U8" sending FIN because: "The Socket transport's send loop completed gracefully."
2022-09-21 10:16:57.237 +01:00 [DBG] Connection id "0HMKRM84388U9" sending FIN because: "The Socket transport's send loop completed gracefully."
2022-09-21 10:16:57.383 +01:00 [DBG] Connection id "0HMKRM84388UA" accepted.
2022-09-21 10:16:57.394 +01:00 [DBG] Connection id "0HMKRM84388UA" started.
2022-09-21 10:16:57.562 +01:00 [DBG] Connection 0HMKRM84388UA established using the following protocol: "Tls12"
2022-09-21 10:16:57.643 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/swagger/index.html - -
2022-09-21 10:16:57.682 +01:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2022-09-21 10:16:57.708 +01:00 [DBG] No candidates found for the request path '/swagger/index.html'
2022-09-21 10:16:57.710 +01:00 [DBG] Request did not match any endpoints
2022-09-21 10:16:57.819 +01:00 [DBG] Response markup is scheduled to include browser refresh script injection.
2022-09-21 10:16:57.967 +01:00 [DBG] Response markup was updated to include browser refresh script injection.
2022-09-21 10:16:57.975 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/swagger/index.html - - - 200 - text/html;charset=utf-8 333.4551ms
2022-09-21 10:16:58.004 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/_framework/aspnetcore-browser-refresh.js - -
2022-09-21 10:16:58.004 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/_vs/browserLink - -
2022-09-21 10:16:58.015 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/_framework/aspnetcore-browser-refresh.js - - - 200 11984 application/javascript;+charset=utf-8 10.1097ms
2022-09-21 10:16:58.041 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/_vs/browserLink - - - 200 - text/javascript;+charset=UTF-8 37.0730ms
2022-09-21 10:16:58.118 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/swagger/v1/swagger.json - -
2022-09-21 10:16:58.120 +01:00 [DBG] No candidates found for the request path '/swagger/v1/swagger.json'
2022-09-21 10:16:58.121 +01:00 [DBG] Request did not match any endpoints
2022-09-21 10:16:58.364 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/swagger/v1/swagger.json - - - 200 - application/json;charset=utf-8 246.5125ms
2022-09-21 10:17:10.493 +01:00 [INF] Request starting HTTP/2 POST https://localhost:7036/api/Users/Login application/json 58
2022-09-21 10:17:10.511 +01:00 [DBG] 1 candidate(s) found for the request path '/api/Users/Login'
2022-09-21 10:17:10.516 +01:00 [DBG] Endpoint 'APIBank.Controllers.UsersController.Login (APIBank)' with route pattern 'api/Users/Login' is valid for the request path '/api/Users/Login'
2022-09-21 10:17:10.518 +01:00 [DBG] Request matched endpoint 'APIBank.Controllers.UsersController.Login (APIBank)'
2022-09-21 10:17:10.522 +01:00 [DBG] Static files was skipped as the request already matched an endpoint.
2022-09-21 10:17:10.966 +01:00 [INF] Executing endpoint 'APIBank.Controllers.UsersController.Login (APIBank)'
2022-09-21 10:17:11.002 +01:00 [INF] Route matched with {action = "Login", controller = "Users"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult Login(APIBank.Models.Requests.LoginRequest) on controller APIBank.Controllers.UsersController (APIBank).
2022-09-21 10:17:11.010 +01:00 [DBG] Execution plan of authorization filters (in the following order): ["APIBank.Authorization.AuthorizeAttribute"]
2022-09-21 10:17:11.013 +01:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2022-09-21 10:17:11.014 +01:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2022-09-21 10:17:11.015 +01:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2022-09-21 10:17:11.016 +01:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2022-09-21 10:17:11.019 +01:00 [DBG] Executing controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-21 10:17:11.020 +01:00 [DBG] Executed controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-21 10:17:11.041 +01:00 [DBG] Attempting to bind parameter 'model' of type 'APIBank.Models.Requests.LoginRequest' ...
2022-09-21 10:17:11.049 +01:00 [DBG] Attempting to bind parameter 'model' of type 'APIBank.Models.Requests.LoginRequest' using the name '' in request data ...
2022-09-21 10:17:11.051 +01:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2022-09-21 10:17:11.060 +01:00 [DBG] Connection id "0HMKRM84388UA", Request id "0HMKRM84388UA:00000009": started reading request body.
2022-09-21 10:17:11.063 +01:00 [DBG] Connection id "0HMKRM84388UA", Request id "0HMKRM84388UA:00000009": done reading request body.
2022-09-21 10:17:11.071 +01:00 [DBG] JSON input formatter succeeded, deserializing to type 'APIBank.Models.Requests.LoginRequest'
2022-09-21 10:17:11.073 +01:00 [DBG] Done attempting to bind parameter 'model' of type 'APIBank.Models.Requests.LoginRequest'.
2022-09-21 10:17:11.075 +01:00 [DBG] Done attempting to bind parameter 'model' of type 'APIBank.Models.Requests.LoginRequest'.
2022-09-21 10:17:11.076 +01:00 [DBG] Attempting to validate the bound parameter 'model' of type 'APIBank.Models.Requests.LoginRequest' ...
2022-09-21 10:17:11.084 +01:00 [DBG] Done attempting to validate the bound parameter 'model' of type 'APIBank.Models.Requests.LoginRequest'.
2022-09-21 10:17:11.217 +01:00 [DBG] An additional 'IServiceProvider' was created for internal use by Entity Framework. An existing service provider was not used due to the following configuration changes: configuration changed for 'Core:ConfigureWarnings', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:UseAdminDatabase', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:SetPostgresVersion', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:UseRedshift', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:ReverseNullOrdering', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:RemoteCertificateValidationCallback', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:ProvideClientCertificatesCallback', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:ProvidePasswordCallback'.
2022-09-21 10:17:12.847 +01:00 [INF] Entity Framework Core 6.0.9 initialized 'PostgresContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:6.0.7+5b98e4b74de93b590b44aef8dd7967c03acc433c' with options: None
2022-09-21 10:17:12.951 +01:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .SingleOrDefault(x => x.Username == __model_Username_0)'
2022-09-21 10:17:13.612 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<User>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: User.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: User.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 1], [Property: User.Email (string) Required Index MaxLength(254), 2], [Property: User.FullName (string) Required MaxLength(100), 3], [Property: User.PasswordChangedAt (DateTime) Required ValueGenerated.OnAdd, 4], [Property: User.PasswordHash (string) Required MaxLength(200), 5], [Property: User.Username (string) Required Index MaxLength(50), 6] }
        SELECT TOP(2) u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
        FROM users AS u
        WHERE u.username == @__model_Username_0), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, User>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)
    .SingleOrDefault()'
2022-09-21 10:17:13.689 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-21 10:17:13.820 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (127ms).
2022-09-21 10:17:13.835 +01:00 [DBG] Opening connection to database 'BankAP' on server ''.
2022-09-21 10:17:14.151 +01:00 [ERR] An error occurred using the connection to database 'BankAP' on server ''.
2022-09-21 10:17:14.174 +01:00 [ERR] An exception occurred while iterating over the results of a query for context type 'APIBank.Helpers.PostgresContext'.
Npgsql.PostgresException (0x80004005): 3D000: database "BankAP" does not exist
   at Npgsql.Internal.NpgsqlConnector.<ReadMessage>g__ReadMessageLong|215_0(NpgsqlConnector connector, Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|195_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.ConnectorPool.OpenNewConnector(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.ConnectorPool.<Get>g__RentAsync|28_0(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|45_0(Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.Open()
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternal(Boolean errorsExpected)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.Open(Boolean errorsExpected)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReader(RelationalCommandParameterObject parameterObject)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.Enumerator.InitializeReader(Enumerator enumerator)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.Execute[TState,TResult](TState state, Func`3 operation, Func`3 verifySucceeded)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.Enumerator.MoveNext()
  Exception data:
    Severity: FATAL
    SqlState: 3D000
    MessageText: database "BankAP" does not exist
    File: postinit.c
    Line: 887
    Routine: InitPostgres
Npgsql.PostgresException (0x80004005): 3D000: database "BankAP" does not exist
   at Npgsql.Internal.NpgsqlConnector.<ReadMessage>g__ReadMessageLong|215_0(NpgsqlConnector connector, Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|195_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.ConnectorPool.OpenNewConnector(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.ConnectorPool.<Get>g__RentAsync|28_0(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|45_0(Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.Open()
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternal(Boolean errorsExpected)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.Open(Boolean errorsExpected)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReader(RelationalCommandParameterObject parameterObject)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.Enumerator.InitializeReader(Enumerator enumerator)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.Execute[TState,TResult](TState state, Func`3 operation, Func`3 verifySucceeded)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.Enumerator.MoveNext()
  Exception data:
    Severity: FATAL
    SqlState: 3D000
    MessageText: database "BankAP" does not exist
    File: postinit.c
    Line: 887
    Routine: InitPostgres
2022-09-21 10:17:19.683 +01:00 [INF] Executed action APIBank.Controllers.UsersController.Login (APIBank) in 8657.4906ms
2022-09-21 10:17:19.691 +01:00 [INF] Executed endpoint 'APIBank.Controllers.UsersController.Login (APIBank)'
2022-09-21 10:17:19.742 +01:00 [DBG] 'PostgresContext' disposed.
2022-09-21 10:17:19.757 +01:00 [INF] Request finished HTTP/2 POST https://localhost:7036/api/Users/Login application/json 58 - 500 - application/json 9263.4696ms
2022-09-21 10:17:41.992 +01:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2022-09-21 10:17:42.128 +01:00 [DBG] Hosting starting
2022-09-21 10:17:42.297 +01:00 [DBG] Using development certificate: CN=localhost (Thumbprint: 9CC642E9838495A6C3C202DECA6A8AD300396DD2)
2022-09-21 10:17:42.441 +01:00 [INF] Now listening on: https://localhost:7036
2022-09-21 10:17:42.443 +01:00 [INF] Now listening on: http://localhost:5036
2022-09-21 10:17:42.446 +01:00 [DBG] Loaded hosting startup assembly APIBank
2022-09-21 10:17:42.447 +01:00 [DBG] Loaded hosting startup assembly Microsoft.AspNetCore.Watch.BrowserRefresh
2022-09-21 10:17:42.448 +01:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.BrowserLink.Net
2022-09-21 10:17:42.449 +01:00 [INF] Application started. Press Ctrl+C to shut down.
2022-09-21 10:17:42.450 +01:00 [INF] Hosting environment: Development
2022-09-21 10:17:42.451 +01:00 [INF] Content root path: C:\Users\mguedesa\OneDrive - NTT DATA EMEAL\Documentos\GitHub\OpenBankAPI-NTT\APIBank\APIBank\
2022-09-21 10:17:42.452 +01:00 [DBG] Hosting started
2022-09-21 10:17:42.808 +01:00 [DBG] Connection id "0HMKRM8HNHK8G" received FIN.
2022-09-21 10:17:42.808 +01:00 [DBG] Connection id "0HMKRM8HNHK8F" received FIN.
2022-09-21 10:17:42.809 +01:00 [DBG] Connection id "0HMKRM8HNHK8G" accepted.
2022-09-21 10:17:42.809 +01:00 [DBG] Connection id "0HMKRM8HNHK8F" accepted.
2022-09-21 10:17:42.815 +01:00 [DBG] Connection id "0HMKRM8HNHK8F" started.
2022-09-21 10:17:42.815 +01:00 [DBG] Connection id "0HMKRM8HNHK8G" started.
2022-09-21 10:17:42.838 +01:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException:  Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveBlobAsync[TIOAdapter](TIOAdapter adapter)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](TIOAdapter adapter, Boolean receiveFirst, Byte[] reAuthenticationData, Boolean isApm)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2022-09-21 10:17:42.838 +01:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException:  Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveBlobAsync[TIOAdapter](TIOAdapter adapter)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](TIOAdapter adapter, Boolean receiveFirst, Byte[] reAuthenticationData, Boolean isApm)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2022-09-21 10:17:42.890 +01:00 [DBG] Connection id "0HMKRM8HNHK8F" stopped.
2022-09-21 10:17:42.890 +01:00 [DBG] Connection id "0HMKRM8HNHK8G" stopped.
2022-09-21 10:17:42.894 +01:00 [DBG] Connection id "0HMKRM8HNHK8G" sending FIN because: "The Socket transport's send loop completed gracefully."
2022-09-21 10:17:42.894 +01:00 [DBG] Connection id "0HMKRM8HNHK8F" sending FIN because: "The Socket transport's send loop completed gracefully."
2022-09-21 10:17:42.992 +01:00 [DBG] Connection id "0HMKRM8HNHK8H" accepted.
2022-09-21 10:17:42.994 +01:00 [DBG] Connection id "0HMKRM8HNHK8H" started.
2022-09-21 10:17:43.053 +01:00 [DBG] Connection 0HMKRM8HNHK8H established using the following protocol: "Tls12"
2022-09-21 10:17:43.134 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/swagger/index.html - -
2022-09-21 10:17:43.174 +01:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2022-09-21 10:17:43.200 +01:00 [DBG] No candidates found for the request path '/swagger/index.html'
2022-09-21 10:17:43.202 +01:00 [DBG] Request did not match any endpoints
2022-09-21 10:17:43.317 +01:00 [DBG] Response markup is scheduled to include browser refresh script injection.
2022-09-21 10:17:43.543 +01:00 [DBG] Response markup was updated to include browser refresh script injection.
2022-09-21 10:17:43.548 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/swagger/index.html - - - 200 - text/html;charset=utf-8 421.2852ms
2022-09-21 10:17:43.575 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/_vs/browserLink - -
2022-09-21 10:17:43.576 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/_framework/aspnetcore-browser-refresh.js - -
2022-09-21 10:17:43.587 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/_framework/aspnetcore-browser-refresh.js - - - 200 11984 application/javascript;+charset=utf-8 11.2274ms
2022-09-21 10:17:43.606 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/_vs/browserLink - - - 200 - text/javascript;+charset=UTF-8 30.9361ms
2022-09-21 10:17:43.696 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/swagger/v1/swagger.json - -
2022-09-21 10:17:43.699 +01:00 [DBG] No candidates found for the request path '/swagger/v1/swagger.json'
2022-09-21 10:17:43.700 +01:00 [DBG] Request did not match any endpoints
2022-09-21 10:17:43.922 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/swagger/v1/swagger.json - - - 200 - application/json;charset=utf-8 226.3190ms
2022-09-21 10:17:52.968 +01:00 [INF] Request starting HTTP/2 POST https://localhost:7036/api/Users/Login application/json 58
2022-09-21 10:17:52.984 +01:00 [DBG] 1 candidate(s) found for the request path '/api/Users/Login'
2022-09-21 10:17:52.996 +01:00 [DBG] Endpoint 'APIBank.Controllers.UsersController.Login (APIBank)' with route pattern 'api/Users/Login' is valid for the request path '/api/Users/Login'
2022-09-21 10:17:52.999 +01:00 [DBG] Request matched endpoint 'APIBank.Controllers.UsersController.Login (APIBank)'
2022-09-21 10:17:53.008 +01:00 [DBG] Static files was skipped as the request already matched an endpoint.
2022-09-21 10:17:53.499 +01:00 [INF] Executing endpoint 'APIBank.Controllers.UsersController.Login (APIBank)'
2022-09-21 10:17:53.533 +01:00 [INF] Route matched with {action = "Login", controller = "Users"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult Login(APIBank.Models.Requests.LoginRequest) on controller APIBank.Controllers.UsersController (APIBank).
2022-09-21 10:17:53.537 +01:00 [DBG] Execution plan of authorization filters (in the following order): ["APIBank.Authorization.AuthorizeAttribute"]
2022-09-21 10:17:53.540 +01:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2022-09-21 10:17:53.541 +01:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2022-09-21 10:17:53.544 +01:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2022-09-21 10:17:53.545 +01:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2022-09-21 10:17:53.547 +01:00 [DBG] Executing controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-21 10:17:53.548 +01:00 [DBG] Executed controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-21 10:17:53.566 +01:00 [DBG] Attempting to bind parameter 'model' of type 'APIBank.Models.Requests.LoginRequest' ...
2022-09-21 10:17:53.572 +01:00 [DBG] Attempting to bind parameter 'model' of type 'APIBank.Models.Requests.LoginRequest' using the name '' in request data ...
2022-09-21 10:17:53.575 +01:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2022-09-21 10:17:53.580 +01:00 [DBG] Connection id "0HMKRM8HNHK8H", Request id "0HMKRM8HNHK8H:00000009": started reading request body.
2022-09-21 10:17:53.582 +01:00 [DBG] Connection id "0HMKRM8HNHK8H", Request id "0HMKRM8HNHK8H:00000009": done reading request body.
2022-09-21 10:17:53.591 +01:00 [DBG] JSON input formatter succeeded, deserializing to type 'APIBank.Models.Requests.LoginRequest'
2022-09-21 10:17:53.592 +01:00 [DBG] Done attempting to bind parameter 'model' of type 'APIBank.Models.Requests.LoginRequest'.
2022-09-21 10:17:53.593 +01:00 [DBG] Done attempting to bind parameter 'model' of type 'APIBank.Models.Requests.LoginRequest'.
2022-09-21 10:17:53.594 +01:00 [DBG] Attempting to validate the bound parameter 'model' of type 'APIBank.Models.Requests.LoginRequest' ...
2022-09-21 10:17:53.602 +01:00 [DBG] Done attempting to validate the bound parameter 'model' of type 'APIBank.Models.Requests.LoginRequest'.
2022-09-21 10:17:53.746 +01:00 [DBG] An additional 'IServiceProvider' was created for internal use by Entity Framework. An existing service provider was not used due to the following configuration changes: configuration changed for 'Core:ConfigureWarnings', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:UseAdminDatabase', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:SetPostgresVersion', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:UseRedshift', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:ReverseNullOrdering', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:RemoteCertificateValidationCallback', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:ProvideClientCertificatesCallback', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:ProvidePasswordCallback'.
2022-09-21 10:17:55.427 +01:00 [INF] Entity Framework Core 6.0.9 initialized 'PostgresContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:6.0.7+5b98e4b74de93b590b44aef8dd7967c03acc433c' with options: None
2022-09-21 10:17:55.514 +01:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .SingleOrDefault(x => x.Username == __model_Username_0)'
2022-09-21 10:17:56.076 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<User>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: User.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: User.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 1], [Property: User.Email (string) Required Index MaxLength(254), 2], [Property: User.FullName (string) Required MaxLength(100), 3], [Property: User.PasswordChangedAt (DateTime) Required ValueGenerated.OnAdd, 4], [Property: User.PasswordHash (string) Required MaxLength(200), 5], [Property: User.Username (string) Required Index MaxLength(50), 6] }
        SELECT TOP(2) u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
        FROM users AS u
        WHERE u.username == @__model_Username_0), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, User>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)
    .SingleOrDefault()'
2022-09-21 10:17:56.143 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-21 10:17:56.252 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (102ms).
2022-09-21 10:17:56.264 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-21 10:17:56.604 +01:00 [ERR] An error occurred using the connection to database 'BankAPI' on server ''.
2022-09-21 10:17:56.618 +01:00 [ERR] An exception occurred while iterating over the results of a query for context type 'APIBank.Helpers.PostgresContext'.
Npgsql.PostgresException (0x80004005): 28P01: password authentication failed for user "postgres"
   at Npgsql.Internal.NpgsqlConnector.<ReadMessage>g__ReadMessageLong|215_0(NpgsqlConnector connector, Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at Npgsql.Internal.NpgsqlConnector.AuthenticateSASL(List`1 mechanisms, String username, Boolean async, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.Authenticate(String username, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|195_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.ConnectorPool.OpenNewConnector(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.ConnectorPool.<Get>g__RentAsync|28_0(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|45_0(Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.Open()
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternal(Boolean errorsExpected)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.Open(Boolean errorsExpected)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReader(RelationalCommandParameterObject parameterObject)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.Enumerator.InitializeReader(Enumerator enumerator)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.Execute[TState,TResult](TState state, Func`3 operation, Func`3 verifySucceeded)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.Enumerator.MoveNext()
  Exception data:
    Severity: FATAL
    SqlState: 28P01
    MessageText: password authentication failed for user "postgres"
    File: auth.c
    Line: 338
    Routine: auth_failed
Npgsql.PostgresException (0x80004005): 28P01: password authentication failed for user "postgres"
   at Npgsql.Internal.NpgsqlConnector.<ReadMessage>g__ReadMessageLong|215_0(NpgsqlConnector connector, Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at Npgsql.Internal.NpgsqlConnector.AuthenticateSASL(List`1 mechanisms, String username, Boolean async, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.Authenticate(String username, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|195_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.ConnectorPool.OpenNewConnector(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.ConnectorPool.<Get>g__RentAsync|28_0(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|45_0(Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.Open()
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternal(Boolean errorsExpected)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.Open(Boolean errorsExpected)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReader(RelationalCommandParameterObject parameterObject)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.Enumerator.InitializeReader(Enumerator enumerator)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.Execute[TState,TResult](TState state, Func`3 operation, Func`3 verifySucceeded)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.Enumerator.MoveNext()
  Exception data:
    Severity: FATAL
    SqlState: 28P01
    MessageText: password authentication failed for user "postgres"
    File: auth.c
    Line: 338
    Routine: auth_failed
2022-09-21 10:18:05.002 +01:00 [INF] Executed action APIBank.Controllers.UsersController.Login (APIBank) in 11451.7341ms
2022-09-21 10:18:05.010 +01:00 [INF] Executed endpoint 'APIBank.Controllers.UsersController.Login (APIBank)'
2022-09-21 10:18:05.061 +01:00 [DBG] 'PostgresContext' disposed.
2022-09-21 10:18:05.076 +01:00 [INF] Request finished HTTP/2 POST https://localhost:7036/api/Users/Login application/json 58 - 500 - application/json 12108.6126ms
2022-09-21 10:18:22.486 +01:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2022-09-21 10:18:22.691 +01:00 [DBG] Hosting starting
2022-09-21 10:18:22.852 +01:00 [DBG] Using development certificate: CN=localhost (Thumbprint: 9CC642E9838495A6C3C202DECA6A8AD300396DD2)
2022-09-21 10:18:22.907 +01:00 [INF] Now listening on: https://localhost:7036
2022-09-21 10:18:22.908 +01:00 [INF] Now listening on: http://localhost:5036
2022-09-21 10:18:22.909 +01:00 [DBG] Loaded hosting startup assembly APIBank
2022-09-21 10:18:22.910 +01:00 [DBG] Loaded hosting startup assembly Microsoft.AspNetCore.Watch.BrowserRefresh
2022-09-21 10:18:22.911 +01:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.BrowserLink.Net
2022-09-21 10:18:22.912 +01:00 [INF] Application started. Press Ctrl+C to shut down.
2022-09-21 10:18:22.913 +01:00 [INF] Hosting environment: Development
2022-09-21 10:18:22.914 +01:00 [INF] Content root path: C:\Users\mguedesa\OneDrive - NTT DATA EMEAL\Documentos\GitHub\OpenBankAPI-NTT\APIBank\APIBank\
2022-09-21 10:18:22.915 +01:00 [DBG] Hosting started
2022-09-21 10:18:23.341 +01:00 [DBG] Connection id "0HMKRM8TQ78KD" received FIN.
2022-09-21 10:18:23.341 +01:00 [DBG] Connection id "0HMKRM8TQ78KE" received FIN.
2022-09-21 10:18:23.355 +01:00 [DBG] Connection id "0HMKRM8TQ78KD" accepted.
2022-09-21 10:18:23.355 +01:00 [DBG] Connection id "0HMKRM8TQ78KE" accepted.
2022-09-21 10:18:23.359 +01:00 [DBG] Connection id "0HMKRM8TQ78KE" started.
2022-09-21 10:18:23.359 +01:00 [DBG] Connection id "0HMKRM8TQ78KD" started.
2022-09-21 10:18:23.409 +01:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException:  Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveBlobAsync[TIOAdapter](TIOAdapter adapter)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](TIOAdapter adapter, Boolean receiveFirst, Byte[] reAuthenticationData, Boolean isApm)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2022-09-21 10:18:23.409 +01:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException:  Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveBlobAsync[TIOAdapter](TIOAdapter adapter)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](TIOAdapter adapter, Boolean receiveFirst, Byte[] reAuthenticationData, Boolean isApm)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2022-09-21 10:18:23.496 +01:00 [DBG] Connection id "0HMKRM8TQ78KD" stopped.
2022-09-21 10:18:23.496 +01:00 [DBG] Connection id "0HMKRM8TQ78KE" stopped.
2022-09-21 10:18:23.503 +01:00 [DBG] Connection id "0HMKRM8TQ78KD" sending FIN because: "The Socket transport's send loop completed gracefully."
2022-09-21 10:18:23.503 +01:00 [DBG] Connection id "0HMKRM8TQ78KE" sending FIN because: "The Socket transport's send loop completed gracefully."
2022-09-21 10:18:23.628 +01:00 [DBG] Connection id "0HMKRM8TQ78KF" accepted.
2022-09-21 10:18:23.632 +01:00 [DBG] Connection id "0HMKRM8TQ78KF" started.
2022-09-21 10:18:23.745 +01:00 [DBG] Connection 0HMKRM8TQ78KF established using the following protocol: "Tls12"
2022-09-21 10:18:23.846 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/swagger/index.html - -
2022-09-21 10:18:23.908 +01:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2022-09-21 10:18:23.941 +01:00 [DBG] No candidates found for the request path '/swagger/index.html'
2022-09-21 10:18:23.946 +01:00 [DBG] Request did not match any endpoints
2022-09-21 10:18:24.068 +01:00 [DBG] Response markup is scheduled to include browser refresh script injection.
2022-09-21 10:18:24.249 +01:00 [DBG] Response markup was updated to include browser refresh script injection.
2022-09-21 10:18:24.260 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/swagger/index.html - - - 200 - text/html;charset=utf-8 417.7787ms
2022-09-21 10:18:24.287 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/_vs/browserLink - -
2022-09-21 10:18:24.289 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/_framework/aspnetcore-browser-refresh.js - -
2022-09-21 10:18:24.305 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/_framework/aspnetcore-browser-refresh.js - - - 200 11984 application/javascript;+charset=utf-8 15.4836ms
2022-09-21 10:18:24.426 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/_vs/browserLink - - - 200 - text/javascript;+charset=UTF-8 138.9413ms
2022-09-21 10:18:24.514 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/swagger/v1/swagger.json - -
2022-09-21 10:18:24.517 +01:00 [DBG] No candidates found for the request path '/swagger/v1/swagger.json'
2022-09-21 10:18:24.519 +01:00 [DBG] Request did not match any endpoints
2022-09-21 10:18:24.713 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/swagger/v1/swagger.json - - - 200 - application/json;charset=utf-8 198.6984ms
2022-09-21 10:18:30.850 +01:00 [INF] Request starting HTTP/2 POST https://localhost:7036/api/Users/Login application/json 58
2022-09-21 10:18:30.865 +01:00 [DBG] 1 candidate(s) found for the request path '/api/Users/Login'
2022-09-21 10:18:30.873 +01:00 [DBG] Endpoint 'APIBank.Controllers.UsersController.Login (APIBank)' with route pattern 'api/Users/Login' is valid for the request path '/api/Users/Login'
2022-09-21 10:18:30.879 +01:00 [DBG] Request matched endpoint 'APIBank.Controllers.UsersController.Login (APIBank)'
2022-09-21 10:18:30.881 +01:00 [DBG] Static files was skipped as the request already matched an endpoint.
2022-09-21 10:18:31.374 +01:00 [INF] Executing endpoint 'APIBank.Controllers.UsersController.Login (APIBank)'
2022-09-21 10:18:31.406 +01:00 [INF] Route matched with {action = "Login", controller = "Users"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult Login(APIBank.Models.Requests.LoginRequest) on controller APIBank.Controllers.UsersController (APIBank).
2022-09-21 10:18:31.409 +01:00 [DBG] Execution plan of authorization filters (in the following order): ["APIBank.Authorization.AuthorizeAttribute"]
2022-09-21 10:18:31.411 +01:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2022-09-21 10:18:31.412 +01:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2022-09-21 10:18:31.414 +01:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2022-09-21 10:18:31.415 +01:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2022-09-21 10:18:31.418 +01:00 [DBG] Executing controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-21 10:18:31.422 +01:00 [DBG] Executed controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-21 10:18:31.440 +01:00 [DBG] Attempting to bind parameter 'model' of type 'APIBank.Models.Requests.LoginRequest' ...
2022-09-21 10:18:31.443 +01:00 [DBG] Attempting to bind parameter 'model' of type 'APIBank.Models.Requests.LoginRequest' using the name '' in request data ...
2022-09-21 10:18:31.445 +01:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2022-09-21 10:18:31.455 +01:00 [DBG] Connection id "0HMKRM8TQ78KF", Request id "0HMKRM8TQ78KF:00000009": started reading request body.
2022-09-21 10:18:31.457 +01:00 [DBG] Connection id "0HMKRM8TQ78KF", Request id "0HMKRM8TQ78KF:00000009": done reading request body.
2022-09-21 10:18:31.466 +01:00 [DBG] JSON input formatter succeeded, deserializing to type 'APIBank.Models.Requests.LoginRequest'
2022-09-21 10:18:31.467 +01:00 [DBG] Done attempting to bind parameter 'model' of type 'APIBank.Models.Requests.LoginRequest'.
2022-09-21 10:18:31.470 +01:00 [DBG] Done attempting to bind parameter 'model' of type 'APIBank.Models.Requests.LoginRequest'.
2022-09-21 10:18:31.472 +01:00 [DBG] Attempting to validate the bound parameter 'model' of type 'APIBank.Models.Requests.LoginRequest' ...
2022-09-21 10:18:31.481 +01:00 [DBG] Done attempting to validate the bound parameter 'model' of type 'APIBank.Models.Requests.LoginRequest'.
2022-09-21 10:18:31.612 +01:00 [DBG] An additional 'IServiceProvider' was created for internal use by Entity Framework. An existing service provider was not used due to the following configuration changes: configuration changed for 'Core:ConfigureWarnings', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:UseAdminDatabase', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:SetPostgresVersion', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:UseRedshift', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:ReverseNullOrdering', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:RemoteCertificateValidationCallback', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:ProvideClientCertificatesCallback', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:ProvidePasswordCallback'.
2022-09-21 10:18:33.281 +01:00 [INF] Entity Framework Core 6.0.9 initialized 'PostgresContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:6.0.7+5b98e4b74de93b590b44aef8dd7967c03acc433c' with options: None
2022-09-21 10:18:33.380 +01:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .SingleOrDefault(x => x.Username == __model_Username_0)'
2022-09-21 10:18:33.979 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<User>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: User.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: User.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 1], [Property: User.Email (string) Required Index MaxLength(254), 2], [Property: User.FullName (string) Required MaxLength(100), 3], [Property: User.PasswordChangedAt (DateTime) Required ValueGenerated.OnAdd, 4], [Property: User.PasswordHash (string) Required MaxLength(200), 5], [Property: User.Username (string) Required Index MaxLength(50), 6] }
        SELECT TOP(2) u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
        FROM users AS u
        WHERE u.username == @__model_Username_0), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, User>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)
    .SingleOrDefault()'
2022-09-21 10:18:34.073 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-21 10:18:34.196 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (120ms).
2022-09-21 10:18:34.210 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-21 10:18:34.452 +01:00 [ERR] An error occurred using the connection to database 'BankAPI' on server ''.
2022-09-21 10:18:34.470 +01:00 [ERR] An exception occurred while iterating over the results of a query for context type 'APIBank.Helpers.PostgresContext'.
Npgsql.PostgresException (0x80004005): 28P01: password authentication failed for user "postgre"
   at Npgsql.Internal.NpgsqlConnector.<ReadMessage>g__ReadMessageLong|215_0(NpgsqlConnector connector, Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at Npgsql.Internal.NpgsqlConnector.AuthenticateSASL(List`1 mechanisms, String username, Boolean async, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.Authenticate(String username, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|195_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.ConnectorPool.OpenNewConnector(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.ConnectorPool.<Get>g__RentAsync|28_0(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|45_0(Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.Open()
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternal(Boolean errorsExpected)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.Open(Boolean errorsExpected)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReader(RelationalCommandParameterObject parameterObject)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.Enumerator.InitializeReader(Enumerator enumerator)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.Execute[TState,TResult](TState state, Func`3 operation, Func`3 verifySucceeded)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.Enumerator.MoveNext()
  Exception data:
    Severity: FATAL
    SqlState: 28P01
    MessageText: password authentication failed for user "postgre"
    File: auth.c
    Line: 338
    Routine: auth_failed
Npgsql.PostgresException (0x80004005): 28P01: password authentication failed for user "postgre"
   at Npgsql.Internal.NpgsqlConnector.<ReadMessage>g__ReadMessageLong|215_0(NpgsqlConnector connector, Boolean async, DataRowLoadingMode dataRowLoadingMode, Boolean readingNotifications, Boolean isReadingPrependedMessage)
   at Npgsql.Internal.NpgsqlConnector.AuthenticateSASL(List`1 mechanisms, String username, Boolean async, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.Authenticate(String username, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|195_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.ConnectorPool.OpenNewConnector(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.ConnectorPool.<Get>g__RentAsync|28_0(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|45_0(Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.Open()
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternal(Boolean errorsExpected)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.Open(Boolean errorsExpected)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReader(RelationalCommandParameterObject parameterObject)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.Enumerator.InitializeReader(Enumerator enumerator)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.Execute[TState,TResult](TState state, Func`3 operation, Func`3 verifySucceeded)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.Enumerator.MoveNext()
  Exception data:
    Severity: FATAL
    SqlState: 28P01
    MessageText: password authentication failed for user "postgre"
    File: auth.c
    Line: 338
    Routine: auth_failed
2022-09-21 10:18:38.739 +01:00 [INF] Executed action APIBank.Controllers.UsersController.Login (APIBank) in 7317.9765ms
2022-09-21 10:18:38.744 +01:00 [INF] Executed endpoint 'APIBank.Controllers.UsersController.Login (APIBank)'
2022-09-21 10:18:38.796 +01:00 [DBG] 'PostgresContext' disposed.
2022-09-21 10:18:38.806 +01:00 [INF] Request finished HTTP/2 POST https://localhost:7036/api/Users/Login application/json 58 - 500 - application/json 7956.9696ms
2022-09-21 10:19:05.656 +01:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2022-09-21 10:19:05.775 +01:00 [DBG] Hosting starting
2022-09-21 10:19:05.948 +01:00 [DBG] Using development certificate: CN=localhost (Thumbprint: 9CC642E9838495A6C3C202DECA6A8AD300396DD2)
2022-09-21 10:19:06.018 +01:00 [INF] Now listening on: https://localhost:7036
2022-09-21 10:19:06.026 +01:00 [INF] Now listening on: http://localhost:5036
2022-09-21 10:19:06.028 +01:00 [DBG] Loaded hosting startup assembly APIBank
2022-09-21 10:19:06.030 +01:00 [DBG] Loaded hosting startup assembly Microsoft.AspNetCore.Watch.BrowserRefresh
2022-09-21 10:19:06.031 +01:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.BrowserLink.Net
2022-09-21 10:19:06.032 +01:00 [INF] Application started. Press Ctrl+C to shut down.
2022-09-21 10:19:06.033 +01:00 [INF] Hosting environment: Development
2022-09-21 10:19:06.033 +01:00 [INF] Content root path: C:\Users\mguedesa\OneDrive - NTT DATA EMEAL\Documentos\GitHub\OpenBankAPI-NTT\APIBank\APIBank\
2022-09-21 10:19:06.034 +01:00 [DBG] Hosting started
2022-09-21 10:19:06.280 +01:00 [DBG] Connection id "0HMKRM9AJLDCF" accepted.
2022-09-21 10:19:06.280 +01:00 [DBG] Connection id "0HMKRM9AJLDCG" accepted.
2022-09-21 10:19:06.363 +01:00 [DBG] Connection id "0HMKRM9AJLDCG" received FIN.
2022-09-21 10:19:06.363 +01:00 [DBG] Connection id "0HMKRM9AJLDCF" received FIN.
2022-09-21 10:19:06.658 +01:00 [DBG] Connection id "0HMKRM9AJLDCG" started.
2022-09-21 10:19:06.365 +01:00 [DBG] Connection id "0HMKRM9AJLDCF" started.
2022-09-21 10:19:06.744 +01:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException:  Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveBlobAsync[TIOAdapter](TIOAdapter adapter)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](TIOAdapter adapter, Boolean receiveFirst, Byte[] reAuthenticationData, Boolean isApm)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2022-09-21 10:19:06.773 +01:00 [DBG] Connection id "0HMKRM9AJLDCH" accepted.
2022-09-21 10:19:06.744 +01:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException:  Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveBlobAsync[TIOAdapter](TIOAdapter adapter)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](TIOAdapter adapter, Boolean receiveFirst, Byte[] reAuthenticationData, Boolean isApm)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2022-09-21 10:19:06.891 +01:00 [DBG] Connection id "0HMKRM9AJLDCH" started.
2022-09-21 10:19:06.901 +01:00 [DBG] Connection id "0HMKRM9AJLDCF" stopped.
2022-09-21 10:19:06.901 +01:00 [DBG] Connection id "0HMKRM9AJLDCG" stopped.
2022-09-21 10:19:06.916 +01:00 [DBG] Connection id "0HMKRM9AJLDCG" sending FIN because: "The Socket transport's send loop completed gracefully."
2022-09-21 10:19:06.916 +01:00 [DBG] Connection id "0HMKRM9AJLDCF" sending FIN because: "The Socket transport's send loop completed gracefully."
2022-09-21 10:19:06.982 +01:00 [DBG] Connection 0HMKRM9AJLDCH established using the following protocol: "Tls12"
2022-09-21 10:19:07.077 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/swagger/index.html - -
2022-09-21 10:19:07.123 +01:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2022-09-21 10:19:07.149 +01:00 [DBG] No candidates found for the request path '/swagger/index.html'
2022-09-21 10:19:07.151 +01:00 [DBG] Request did not match any endpoints
2022-09-21 10:19:07.294 +01:00 [DBG] Response markup is scheduled to include browser refresh script injection.
2022-09-21 10:19:07.548 +01:00 [DBG] Response markup was updated to include browser refresh script injection.
2022-09-21 10:19:07.562 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/swagger/index.html - - - 200 - text/html;charset=utf-8 491.4542ms
2022-09-21 10:19:07.599 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/_vs/browserLink - -
2022-09-21 10:19:07.599 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/_framework/aspnetcore-browser-refresh.js - -
2022-09-21 10:19:07.617 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/_framework/aspnetcore-browser-refresh.js - - - 200 11984 application/javascript;+charset=utf-8 17.5847ms
2022-09-21 10:19:07.725 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/_vs/browserLink - - - 200 - text/javascript;+charset=UTF-8 125.7748ms
2022-09-21 10:19:07.824 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/swagger/v1/swagger.json - -
2022-09-21 10:19:07.826 +01:00 [DBG] No candidates found for the request path '/swagger/v1/swagger.json'
2022-09-21 10:19:07.828 +01:00 [DBG] Request did not match any endpoints
2022-09-21 10:19:08.065 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/swagger/v1/swagger.json - - - 200 - application/json;charset=utf-8 240.9968ms
2022-09-21 10:19:14.605 +01:00 [INF] Request starting HTTP/2 POST https://localhost:7036/api/Users/Login application/json 58
2022-09-21 10:19:14.618 +01:00 [DBG] 1 candidate(s) found for the request path '/api/Users/Login'
2022-09-21 10:19:14.625 +01:00 [DBG] Endpoint 'APIBank.Controllers.UsersController.Login (APIBank)' with route pattern 'api/Users/Login' is valid for the request path '/api/Users/Login'
2022-09-21 10:19:14.627 +01:00 [DBG] Request matched endpoint 'APIBank.Controllers.UsersController.Login (APIBank)'
2022-09-21 10:19:14.630 +01:00 [DBG] Static files was skipped as the request already matched an endpoint.
2022-09-21 10:19:15.110 +01:00 [INF] Executing endpoint 'APIBank.Controllers.UsersController.Login (APIBank)'
2022-09-21 10:19:15.149 +01:00 [INF] Route matched with {action = "Login", controller = "Users"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult Login(APIBank.Models.Requests.LoginRequest) on controller APIBank.Controllers.UsersController (APIBank).
2022-09-21 10:19:15.157 +01:00 [DBG] Execution plan of authorization filters (in the following order): ["APIBank.Authorization.AuthorizeAttribute"]
2022-09-21 10:19:15.158 +01:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2022-09-21 10:19:15.160 +01:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2022-09-21 10:19:15.165 +01:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2022-09-21 10:19:15.168 +01:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2022-09-21 10:19:15.172 +01:00 [DBG] Executing controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-21 10:19:15.174 +01:00 [DBG] Executed controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-21 10:19:15.204 +01:00 [DBG] Attempting to bind parameter 'model' of type 'APIBank.Models.Requests.LoginRequest' ...
2022-09-21 10:19:15.211 +01:00 [DBG] Attempting to bind parameter 'model' of type 'APIBank.Models.Requests.LoginRequest' using the name '' in request data ...
2022-09-21 10:19:15.216 +01:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2022-09-21 10:19:15.224 +01:00 [DBG] Connection id "0HMKRM9AJLDCH", Request id "0HMKRM9AJLDCH:00000009": started reading request body.
2022-09-21 10:19:15.225 +01:00 [DBG] Connection id "0HMKRM9AJLDCH", Request id "0HMKRM9AJLDCH:00000009": done reading request body.
2022-09-21 10:19:15.237 +01:00 [DBG] JSON input formatter succeeded, deserializing to type 'APIBank.Models.Requests.LoginRequest'
2022-09-21 10:19:15.239 +01:00 [DBG] Done attempting to bind parameter 'model' of type 'APIBank.Models.Requests.LoginRequest'.
2022-09-21 10:19:15.239 +01:00 [DBG] Done attempting to bind parameter 'model' of type 'APIBank.Models.Requests.LoginRequest'.
2022-09-21 10:19:15.240 +01:00 [DBG] Attempting to validate the bound parameter 'model' of type 'APIBank.Models.Requests.LoginRequest' ...
2022-09-21 10:19:15.252 +01:00 [DBG] Done attempting to validate the bound parameter 'model' of type 'APIBank.Models.Requests.LoginRequest'.
2022-09-21 10:19:15.405 +01:00 [DBG] An additional 'IServiceProvider' was created for internal use by Entity Framework. An existing service provider was not used due to the following configuration changes: configuration changed for 'Core:ConfigureWarnings', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:UseAdminDatabase', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:SetPostgresVersion', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:UseRedshift', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:ReverseNullOrdering', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:RemoteCertificateValidationCallback', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:ProvideClientCertificatesCallback', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:ProvidePasswordCallback'.
2022-09-21 10:19:17.235 +01:00 [INF] Entity Framework Core 6.0.9 initialized 'PostgresContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:6.0.7+5b98e4b74de93b590b44aef8dd7967c03acc433c' with options: None
2022-09-21 10:19:17.337 +01:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .SingleOrDefault(x => x.Username == __model_Username_0)'
2022-09-21 10:19:17.949 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<User>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: User.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: User.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 1], [Property: User.Email (string) Required Index MaxLength(254), 2], [Property: User.FullName (string) Required MaxLength(100), 3], [Property: User.PasswordChangedAt (DateTime) Required ValueGenerated.OnAdd, 4], [Property: User.PasswordHash (string) Required MaxLength(200), 5], [Property: User.Username (string) Required Index MaxLength(50), 6] }
        SELECT TOP(2) u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
        FROM users AS u
        WHERE u.username == @__model_Username_0), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, User>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)
    .SingleOrDefault()'
2022-09-21 10:19:18.042 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-21 10:19:18.203 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (162ms).
2022-09-21 10:19:18.222 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-21 10:19:18.697 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 10:19:18.723 +01:00 [DBG] Executing DbCommand [Parameters=[@__model_Username_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.username = @__model_Username_0
LIMIT 2
2022-09-21 10:19:18.895 +01:00 [INF] Executed DbCommand (174ms) [Parameters=[@__model_Username_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.username = @__model_Username_0
LIMIT 2
2022-09-21 10:19:18.987 +01:00 [DBG] Context 'PostgresContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 10:19:19.065 +01:00 [DBG] A data reader was disposed.
2022-09-21 10:19:19.073 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 10:19:19.085 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-21 10:19:19.652 +01:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .Any(user => user.RefreshTokenCollection
        .Any(reftoken => reftoken.RefToken == __token_0))'
2022-09-21 10:19:19.850 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<bool>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            EmptyProjectionMember -> 0
        SELECT EXISTS (
            SELECT 1
            FROM users AS u
            WHERE EXISTS (
                SELECT 1
                FROM refresh_token AS r
                WHERE ((u.id != NULL) && (u.id == r.user_id)) && (r.token == @__token_0)))), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, bool>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)
    .Single()'
2022-09-21 10:19:19.871 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-21 10:19:19.872 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2022-09-21 10:19:19.873 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-21 10:19:19.874 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 10:19:19.875 +01:00 [DBG] Executing DbCommand [Parameters=[@__token_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM users AS u
    WHERE EXISTS (
        SELECT 1
        FROM refresh_token AS r
        WHERE (u.id = r.user_id) AND (r.token = @__token_0)))
2022-09-21 10:19:19.881 +01:00 [INF] Executed DbCommand (6ms) [Parameters=[@__token_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM users AS u
    WHERE EXISTS (
        SELECT 1
        FROM refresh_token AS r
        WHERE (u.id = r.user_id) AND (r.token = @__token_0)))
2022-09-21 10:19:19.886 +01:00 [DBG] A data reader was disposed.
2022-09-21 10:19:19.887 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 10:19:19.888 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-21 10:19:19.909 +01:00 [DBG] Compiling query expression: 
'DbSet<RefreshToken>()
    .Where(rt => rt.UserId == __id_0)
    .AsNoTracking()
    .Select(rt => new RefreshToken{ 
        Id = rt.Id, 
        UserId = rt.UserId, 
        RefToken = rt.RefToken, 
        Expires = rt.Expires, 
        Created = rt.Created, 
        CreatedByIp = rt.CreatedByIp, 
        Revoked = rt.Revoked, 
        RevokedByIp = rt.RevokedByIp, 
        ReplacedByToken = rt.ReplacedByToken, 
        ReasonRevoked = rt.ReasonRevoked, 
        IsExpired = rt.IsExpired, 
        IsRevoked = rt.IsRevoked, 
        IsActive = rt.IsActive 
    }
    )'
2022-09-21 10:19:19.949 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<RefreshToken>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            Id -> 0
            UserId -> 1
            RefToken -> 2
            Expires -> 3
            Created -> 4
            CreatedByIp -> 5
            Revoked -> 6
            RevokedByIp -> 7
            ReplacedByToken -> 8
            ReasonRevoked -> 9
            IsExpired -> 10
            IsRevoked -> 11
            IsActive -> 12
        SELECT r.id AS Id, r.user_id AS UserId, r.token AS RefToken, r.expires AS Expires, r.created AS Created, r.created_by_ip AS CreatedByIp, r.revoked AS Revoked, r.revoked_by_ip AS RevokedByIp, r.replaced_by_token AS ReplacedByToken, r.reason_revoked AS ReasonRevoked, r.is_expired AS IsExpired, r.is_revoked AS IsRevoked, r.is_active AS IsActive
        FROM refresh_token AS r
        WHERE r.user_id == @__id_0), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, RefreshToken>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)'
2022-09-21 10:19:19.953 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-21 10:19:19.953 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2022-09-21 10:19:19.954 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-21 10:19:19.955 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 10:19:19.956 +01:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.user_id AS "UserId", r.token AS "RefToken", r.expires AS "Expires", r.created AS "Created", r.created_by_ip AS "CreatedByIp", r.revoked AS "Revoked", r.revoked_by_ip AS "RevokedByIp", r.replaced_by_token AS "ReplacedByToken", r.reason_revoked AS "ReasonRevoked", r.is_expired AS "IsExpired", r.is_revoked AS "IsRevoked", r.is_active AS "IsActive"
FROM refresh_token AS r
WHERE r.user_id = @__id_0
2022-09-21 10:19:19.964 +01:00 [INF] Executed DbCommand (8ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.user_id AS "UserId", r.token AS "RefToken", r.expires AS "Expires", r.created AS "Created", r.created_by_ip AS "CreatedByIp", r.revoked AS "Revoked", r.revoked_by_ip AS "RevokedByIp", r.replaced_by_token AS "ReplacedByToken", r.reason_revoked AS "ReasonRevoked", r.is_expired AS "IsExpired", r.is_revoked AS "IsRevoked", r.is_active AS "IsActive"
FROM refresh_token AS r
WHERE r.user_id = @__id_0
2022-09-21 10:19:19.966 +01:00 [DBG] A data reader was disposed.
2022-09-21 10:19:19.967 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 10:19:19.968 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-21 10:19:19.991 +01:00 [DBG] An entity of type 'User' tracked by 'PostgresContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 10:19:20.057 +01:00 [DBG] 'PostgresContext' generated a temporary value for the property 'Id.RefreshToken'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 10:19:20.117 +01:00 [DBG] Context 'PostgresContext' started tracking 'RefreshToken' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 10:19:20.124 +01:00 [DBG] SaveChanges starting for 'PostgresContext'.
2022-09-21 10:19:20.130 +01:00 [DBG] DetectChanges starting for 'PostgresContext'.
2022-09-21 10:19:20.177 +01:00 [DBG] 1 entities were added and 0 entities were removed from navigation 'User.RefreshTokenCollection'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 10:19:20.207 +01:00 [DBG] The foreign key property 'RefreshToken.UserId' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2022-09-21 10:19:20.246 +01:00 [DBG] DetectChanges completed for 'PostgresContext'.
2022-09-21 10:19:20.267 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-21 10:19:20.270 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 10:19:20.276 +01:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2022-09-21 10:19:20.292 +01:00 [DBG] Began transaction with isolation level 'ReadCommitted'.
2022-09-21 10:19:20.398 +01:00 [DBG] Executing 2 update commands as a batch.
2022-09-21 10:19:20.438 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-21 10:19:20.440 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2022-09-21 10:19:20.446 +01:00 [DBG] Executing DbCommand [Parameters=[@p0='?' (DbType = DateTime), @p1='?', @p2='?' (DbType = DateTime), @p3='?' (DbType = Boolean), @p4='?' (DbType = Boolean), @p5='?' (DbType = Boolean), @p6='?', @p7='?', @p8='?', @p9='?' (DbType = DateTime), @p10='?', @p11='?' (DbType = Int32), @p18='?' (DbType = Int32), @p12='?' (DbType = DateTime), @p13='?', @p14='?', @p15='?' (DbType = DateTime), @p16='?', @p17='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO refresh_token (created, created_by_ip, expires, is_active, is_expired, is_revoked, reason_revoked, token, replaced_by_token, revoked, revoked_by_ip, user_id)
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11)
RETURNING id;
UPDATE users SET created_at = @p12, email = @p13, full_name = @p14, password_changed_at = @p15, password_hash = @p16, username = @p17
WHERE id = @p18;
2022-09-21 10:19:20.472 +01:00 [INF] Executed DbCommand (27ms) [Parameters=[@p0='?' (DbType = DateTime), @p1='?', @p2='?' (DbType = DateTime), @p3='?' (DbType = Boolean), @p4='?' (DbType = Boolean), @p5='?' (DbType = Boolean), @p6='?', @p7='?', @p8='?', @p9='?' (DbType = DateTime), @p10='?', @p11='?' (DbType = Int32), @p18='?' (DbType = Int32), @p12='?' (DbType = DateTime), @p13='?', @p14='?', @p15='?' (DbType = DateTime), @p16='?', @p17='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO refresh_token (created, created_by_ip, expires, is_active, is_expired, is_revoked, reason_revoked, token, replaced_by_token, revoked, revoked_by_ip, user_id)
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11)
RETURNING id;
UPDATE users SET created_at = @p12, email = @p13, full_name = @p14, password_changed_at = @p15, password_hash = @p16, username = @p17
WHERE id = @p18;
2022-09-21 10:19:20.491 +01:00 [DBG] The foreign key property 'RefreshToken.Id' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2022-09-21 10:19:20.496 +01:00 [DBG] A data reader was disposed.
2022-09-21 10:19:20.502 +01:00 [DBG] Committing transaction.
2022-09-21 10:19:20.521 +01:00 [DBG] Committed transaction.
2022-09-21 10:19:20.524 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 10:19:20.527 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-21 10:19:20.532 +01:00 [DBG] Disposing transaction.
2022-09-21 10:19:20.537 +01:00 [DBG] An entity of type 'RefreshToken' tracked by 'PostgresContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 10:19:20.541 +01:00 [DBG] An entity of type 'User' tracked by 'PostgresContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 10:19:20.546 +01:00 [DBG] SaveChanges completed for 'PostgresContext' with 2 entities written to the database.
2022-09-21 10:19:20.552 +01:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2022-09-21 10:19:20.558 +01:00 [DBG] Attempting to select an output formatter based on Accept header '["text/plain"]'.
2022-09-21 10:19:20.561 +01:00 [DBG] Could not find an output formatter based on content negotiation. Accepted types were (["text/plain"])
2022-09-21 10:19:20.562 +01:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2022-09-21 10:19:20.563 +01:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2022-09-21 10:19:20.565 +01:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2022-09-21 10:19:20.566 +01:00 [INF] Executing OkObjectResult, writing value of type 'APIBank.Models.Users.Responses.LoginResponse'.
2022-09-21 10:19:20.591 +01:00 [INF] Executed action APIBank.Controllers.UsersController.Login (APIBank) in 5412.3851ms
2022-09-21 10:19:20.595 +01:00 [INF] Executed endpoint 'APIBank.Controllers.UsersController.Login (APIBank)'
2022-09-21 10:19:20.604 +01:00 [DBG] 'PostgresContext' disposed.
2022-09-21 10:19:20.614 +01:00 [INF] Request finished HTTP/2 POST https://localhost:7036/api/Users/Login application/json 58 - 200 - application/json;+charset=utf-8 6008.5629ms
2022-09-21 10:19:34.502 +01:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2022-09-21 10:19:34.756 +01:00 [DBG] Hosting starting
2022-09-21 10:19:34.957 +01:00 [DBG] Using development certificate: CN=localhost (Thumbprint: 9CC642E9838495A6C3C202DECA6A8AD300396DD2)
2022-09-21 10:19:35.010 +01:00 [INF] Now listening on: https://localhost:7036
2022-09-21 10:19:35.011 +01:00 [INF] Now listening on: http://localhost:5036
2022-09-21 10:19:35.012 +01:00 [DBG] Loaded hosting startup assembly APIBank
2022-09-21 10:19:35.013 +01:00 [DBG] Loaded hosting startup assembly Microsoft.AspNetCore.Watch.BrowserRefresh
2022-09-21 10:19:35.015 +01:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.BrowserLink.Net
2022-09-21 10:19:35.016 +01:00 [INF] Application started. Press Ctrl+C to shut down.
2022-09-21 10:19:35.017 +01:00 [INF] Hosting environment: Development
2022-09-21 10:19:35.017 +01:00 [INF] Content root path: C:\Users\mguedesa\OneDrive - NTT DATA EMEAL\Documentos\GitHub\OpenBankAPI-NTT\APIBank\APIBank\
2022-09-21 10:19:35.018 +01:00 [DBG] Hosting started
2022-09-21 10:19:35.262 +01:00 [DBG] Connection id "0HMKRM9J83IH3" received FIN.
2022-09-21 10:19:35.262 +01:00 [DBG] Connection id "0HMKRM9J83IH4" received FIN.
2022-09-21 10:19:35.271 +01:00 [DBG] Connection id "0HMKRM9J83IH3" accepted.
2022-09-21 10:19:35.271 +01:00 [DBG] Connection id "0HMKRM9J83IH4" accepted.
2022-09-21 10:19:35.308 +01:00 [DBG] Connection id "0HMKRM9J83IH4" started.
2022-09-21 10:19:35.308 +01:00 [DBG] Connection id "0HMKRM9J83IH3" started.
2022-09-21 10:19:35.358 +01:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException:  Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveBlobAsync[TIOAdapter](TIOAdapter adapter)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](TIOAdapter adapter, Boolean receiveFirst, Byte[] reAuthenticationData, Boolean isApm)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2022-09-21 10:19:35.555 +01:00 [DBG] Connection id "0HMKRM9J83IH5" accepted.
2022-09-21 10:19:35.358 +01:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException:  Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveBlobAsync[TIOAdapter](TIOAdapter adapter)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](TIOAdapter adapter, Boolean receiveFirst, Byte[] reAuthenticationData, Boolean isApm)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2022-09-21 10:19:35.571 +01:00 [DBG] Connection id "0HMKRM9J83IH5" started.
2022-09-21 10:19:35.583 +01:00 [DBG] Connection id "0HMKRM9J83IH3" stopped.
2022-09-21 10:19:35.583 +01:00 [DBG] Connection id "0HMKRM9J83IH4" stopped.
2022-09-21 10:19:35.598 +01:00 [DBG] Connection id "0HMKRM9J83IH3" sending FIN because: "The Socket transport's send loop completed gracefully."
2022-09-21 10:19:35.610 +01:00 [DBG] Connection id "0HMKRM9J83IH4" sending FIN because: "The Socket transport's send loop completed gracefully."
2022-09-21 10:19:35.677 +01:00 [DBG] Connection 0HMKRM9J83IH5 established using the following protocol: "Tls12"
2022-09-21 10:19:35.788 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/swagger/index.html - -
2022-09-21 10:19:35.853 +01:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2022-09-21 10:19:35.890 +01:00 [DBG] No candidates found for the request path '/swagger/index.html'
2022-09-21 10:19:35.893 +01:00 [DBG] Request did not match any endpoints
2022-09-21 10:19:36.062 +01:00 [DBG] Response markup is scheduled to include browser refresh script injection.
2022-09-21 10:19:36.234 +01:00 [DBG] Response markup was updated to include browser refresh script injection.
2022-09-21 10:19:36.242 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/swagger/index.html - - - 200 - text/html;charset=utf-8 456.8371ms
2022-09-21 10:19:36.260 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/_framework/aspnetcore-browser-refresh.js - -
2022-09-21 10:19:36.268 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/_vs/browserLink - -
2022-09-21 10:19:36.270 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/_framework/aspnetcore-browser-refresh.js - - - 200 11984 application/javascript;+charset=utf-8 10.1849ms
2022-09-21 10:19:36.298 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/_vs/browserLink - - - 200 - text/javascript;+charset=UTF-8 29.9592ms
2022-09-21 10:19:36.437 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/swagger/v1/swagger.json - -
2022-09-21 10:19:36.447 +01:00 [DBG] No candidates found for the request path '/swagger/v1/swagger.json'
2022-09-21 10:19:36.457 +01:00 [DBG] Request did not match any endpoints
2022-09-21 10:19:36.679 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/swagger/v1/swagger.json - - - 200 - application/json;charset=utf-8 242.0493ms
2022-09-21 10:19:42.881 +01:00 [INF] Request starting HTTP/2 POST https://localhost:7036/api/Users/Login application/json 58
2022-09-21 10:19:42.902 +01:00 [DBG] 1 candidate(s) found for the request path '/api/Users/Login'
2022-09-21 10:19:42.910 +01:00 [DBG] Endpoint 'APIBank.Controllers.UsersController.Login (APIBank)' with route pattern 'api/Users/Login' is valid for the request path '/api/Users/Login'
2022-09-21 10:19:42.914 +01:00 [DBG] Request matched endpoint 'APIBank.Controllers.UsersController.Login (APIBank)'
2022-09-21 10:19:42.917 +01:00 [DBG] Static files was skipped as the request already matched an endpoint.
2022-09-21 10:19:43.390 +01:00 [INF] Executing endpoint 'APIBank.Controllers.UsersController.Login (APIBank)'
2022-09-21 10:19:43.425 +01:00 [INF] Route matched with {action = "Login", controller = "Users"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult Login(APIBank.Models.Requests.LoginRequest) on controller APIBank.Controllers.UsersController (APIBank).
2022-09-21 10:19:43.429 +01:00 [DBG] Execution plan of authorization filters (in the following order): ["APIBank.Authorization.AuthorizeAttribute"]
2022-09-21 10:19:43.432 +01:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2022-09-21 10:19:43.434 +01:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2022-09-21 10:19:43.436 +01:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2022-09-21 10:19:43.437 +01:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2022-09-21 10:19:43.442 +01:00 [DBG] Executing controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-21 10:19:43.444 +01:00 [DBG] Executed controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-21 10:19:43.459 +01:00 [DBG] Attempting to bind parameter 'model' of type 'APIBank.Models.Requests.LoginRequest' ...
2022-09-21 10:19:43.462 +01:00 [DBG] Attempting to bind parameter 'model' of type 'APIBank.Models.Requests.LoginRequest' using the name '' in request data ...
2022-09-21 10:19:43.464 +01:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2022-09-21 10:19:43.469 +01:00 [DBG] Connection id "0HMKRM9J83IH5", Request id "0HMKRM9J83IH5:00000009": started reading request body.
2022-09-21 10:19:43.470 +01:00 [DBG] Connection id "0HMKRM9J83IH5", Request id "0HMKRM9J83IH5:00000009": done reading request body.
2022-09-21 10:19:43.477 +01:00 [DBG] JSON input formatter succeeded, deserializing to type 'APIBank.Models.Requests.LoginRequest'
2022-09-21 10:19:43.479 +01:00 [DBG] Done attempting to bind parameter 'model' of type 'APIBank.Models.Requests.LoginRequest'.
2022-09-21 10:19:43.480 +01:00 [DBG] Done attempting to bind parameter 'model' of type 'APIBank.Models.Requests.LoginRequest'.
2022-09-21 10:19:43.481 +01:00 [DBG] Attempting to validate the bound parameter 'model' of type 'APIBank.Models.Requests.LoginRequest' ...
2022-09-21 10:19:43.487 +01:00 [DBG] Done attempting to validate the bound parameter 'model' of type 'APIBank.Models.Requests.LoginRequest'.
2022-09-21 10:19:43.620 +01:00 [DBG] An additional 'IServiceProvider' was created for internal use by Entity Framework. An existing service provider was not used due to the following configuration changes: configuration changed for 'Core:ConfigureWarnings', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:UseAdminDatabase', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:SetPostgresVersion', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:UseRedshift', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:ReverseNullOrdering', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:RemoteCertificateValidationCallback', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:ProvideClientCertificatesCallback', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:ProvidePasswordCallback'.
2022-09-21 10:19:45.379 +01:00 [INF] Entity Framework Core 6.0.9 initialized 'PostgresContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:6.0.7+5b98e4b74de93b590b44aef8dd7967c03acc433c' with options: None
2022-09-21 10:19:45.468 +01:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .SingleOrDefault(x => x.Username == __model_Username_0)'
2022-09-21 10:19:46.049 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<User>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: User.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: User.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 1], [Property: User.Email (string) Required Index MaxLength(254), 2], [Property: User.FullName (string) Required MaxLength(100), 3], [Property: User.PasswordChangedAt (DateTime) Required ValueGenerated.OnAdd, 4], [Property: User.PasswordHash (string) Required MaxLength(200), 5], [Property: User.Username (string) Required Index MaxLength(50), 6] }
        SELECT TOP(2) u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
        FROM users AS u
        WHERE u.username == @__model_Username_0), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, User>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)
    .SingleOrDefault()'
2022-09-21 10:19:46.128 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-21 10:19:46.253 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (123ms).
2022-09-21 10:19:46.268 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-21 10:19:50.463 +01:00 [ERR] An error occurred using the connection to database 'BankAPI' on server ''.
2022-09-21 10:19:50.478 +01:00 [ERR] An exception occurred while iterating over the results of a query for context type 'APIBank.Helpers.PostgresContext'.
System.InvalidOperationException: An exception has been raised that is likely due to a transient failure.
 ---> Npgsql.NpgsqlException (0x80004005): Failed to connect to [::1]:543
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at Npgsql.Internal.NpgsqlConnector.Connect(NpgsqlTimeout timeout)
   at Npgsql.Internal.NpgsqlConnector.Connect(NpgsqlTimeout timeout)
   at Npgsql.Internal.NpgsqlConnector.RawOpen(SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|195_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.ConnectorPool.OpenNewConnector(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.ConnectorPool.<Get>g__RentAsync|28_0(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|45_0(Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.Open()
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternal(Boolean errorsExpected)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.Open(Boolean errorsExpected)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReader(RelationalCommandParameterObject parameterObject)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.Enumerator.InitializeReader(Enumerator enumerator)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.Execute[TState,TResult](TState state, Func`3 operation, Func`3 verifySucceeded)
   --- End of inner exception stack trace ---
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.Execute[TState,TResult](TState state, Func`3 operation, Func`3 verifySucceeded)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.Enumerator.MoveNext()
System.InvalidOperationException: An exception has been raised that is likely due to a transient failure.
 ---> Npgsql.NpgsqlException (0x80004005): Failed to connect to [::1]:543
 ---> System.Net.Sockets.SocketException (10061): No connection could be made because the target machine actively refused it.
   at Npgsql.Internal.NpgsqlConnector.Connect(NpgsqlTimeout timeout)
   at Npgsql.Internal.NpgsqlConnector.Connect(NpgsqlTimeout timeout)
   at Npgsql.Internal.NpgsqlConnector.RawOpen(SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.<Open>g__OpenCore|195_1(NpgsqlConnector conn, SslMode sslMode, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken, Boolean isFirstAttempt)
   at Npgsql.Internal.NpgsqlConnector.Open(NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.ConnectorPool.OpenNewConnector(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.ConnectorPool.<Get>g__RentAsync|28_0(NpgsqlConnection conn, NpgsqlTimeout timeout, Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.<Open>g__OpenAsync|45_0(Boolean async, CancellationToken cancellationToken)
   at Npgsql.NpgsqlConnection.Open()
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.OpenInternal(Boolean errorsExpected)
   at Microsoft.EntityFrameworkCore.Storage.RelationalConnection.Open(Boolean errorsExpected)
   at Microsoft.EntityFrameworkCore.Storage.RelationalCommand.ExecuteReader(RelationalCommandParameterObject parameterObject)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.Enumerator.InitializeReader(Enumerator enumerator)
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.Execute[TState,TResult](TState state, Func`3 operation, Func`3 verifySucceeded)
   --- End of inner exception stack trace ---
   at Npgsql.EntityFrameworkCore.PostgreSQL.Storage.Internal.NpgsqlExecutionStrategy.Execute[TState,TResult](TState state, Func`3 operation, Func`3 verifySucceeded)
   at Microsoft.EntityFrameworkCore.Query.Internal.SingleQueryingEnumerable`1.Enumerator.MoveNext()
2022-09-21 10:19:55.080 +01:00 [INF] Executed action APIBank.Controllers.UsersController.Login (APIBank) in 11634.3311ms
2022-09-21 10:19:55.085 +01:00 [INF] Executed endpoint 'APIBank.Controllers.UsersController.Login (APIBank)'
2022-09-21 10:19:55.138 +01:00 [DBG] 'PostgresContext' disposed.
2022-09-21 10:19:55.150 +01:00 [INF] Request finished HTTP/2 POST https://localhost:7036/api/Users/Login application/json 58 - 500 - application/json 12269.8021ms
2022-09-21 10:21:28.426 +01:00 [DBG] Config reload token fired. Checking for changes...
2022-09-21 10:21:28.689 +01:00 [DBG] Config reload token fired. Checking for changes...
2022-09-21 10:56:29.107 +01:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2022-09-21 10:56:29.243 +01:00 [DBG] Hosting starting
2022-09-21 10:56:29.790 +01:00 [DBG] Using development certificate: CN=localhost (Thumbprint: 9CC642E9838495A6C3C202DECA6A8AD300396DD2)
2022-09-21 10:56:30.120 +01:00 [INF] Now listening on: https://localhost:7036
2022-09-21 10:56:30.122 +01:00 [INF] Now listening on: http://localhost:5036
2022-09-21 10:56:30.123 +01:00 [DBG] Loaded hosting startup assembly APIBank
2022-09-21 10:56:30.125 +01:00 [DBG] Loaded hosting startup assembly Microsoft.AspNetCore.Watch.BrowserRefresh
2022-09-21 10:56:30.127 +01:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.BrowserLink.Net
2022-09-21 10:56:30.129 +01:00 [INF] Application started. Press Ctrl+C to shut down.
2022-09-21 10:56:30.130 +01:00 [INF] Hosting environment: Development
2022-09-21 10:56:30.131 +01:00 [INF] Content root path: C:\Users\mguedesa\OneDrive - NTT DATA EMEAL\Documentos\GitHub\OpenBankAPI-NTT\APIBank\APIBank\
2022-09-21 10:56:30.132 +01:00 [DBG] Hosting started
2022-09-21 10:56:30.315 +01:00 [DBG] Connection id "0HMKRMU7CG9JE" received FIN.
2022-09-21 10:56:30.328 +01:00 [DBG] Connection id "0HMKRMU7CG9JE" accepted.
2022-09-21 10:56:30.332 +01:00 [DBG] Connection id "0HMKRMU7CG9JE" started.
2022-09-21 10:56:30.366 +01:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException:  Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveBlobAsync[TIOAdapter](TIOAdapter adapter)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](TIOAdapter adapter, Boolean receiveFirst, Byte[] reAuthenticationData, Boolean isApm)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2022-09-21 10:56:30.482 +01:00 [DBG] Connection id "0HMKRMU7CG9JE" stopped.
2022-09-21 10:56:30.487 +01:00 [DBG] Connection id "0HMKRMU7CG9JE" sending FIN because: "The Socket transport's send loop completed gracefully."
2022-09-21 10:56:30.652 +01:00 [DBG] Connection id "0HMKRMU7CG9JF" accepted.
2022-09-21 10:56:30.654 +01:00 [DBG] Connection id "0HMKRMU7CG9JF" started.
2022-09-21 10:56:30.875 +01:00 [DBG] Connection 0HMKRMU7CG9JF established using the following protocol: "Tls12"
2022-09-21 10:56:31.120 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/swagger/index.html - -
2022-09-21 10:56:31.221 +01:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2022-09-21 10:56:31.266 +01:00 [DBG] No candidates found for the request path '/swagger/index.html'
2022-09-21 10:56:31.269 +01:00 [DBG] Request did not match any endpoints
2022-09-21 10:56:31.444 +01:00 [DBG] Response markup is scheduled to include browser refresh script injection.
2022-09-21 10:56:31.657 +01:00 [DBG] Response markup was updated to include browser refresh script injection.
2022-09-21 10:56:31.666 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/swagger/index.html - - - 200 - text/html;charset=utf-8 558.2087ms
2022-09-21 10:56:31.688 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/_framework/aspnetcore-browser-refresh.js - -
2022-09-21 10:56:31.692 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/_vs/browserLink - -
2022-09-21 10:56:31.696 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/_framework/aspnetcore-browser-refresh.js - - - 200 11984 application/javascript;+charset=utf-8 8.6095ms
2022-09-21 10:56:31.750 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/_vs/browserLink - - - 200 - text/javascript;+charset=UTF-8 58.2439ms
2022-09-21 10:56:31.819 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/swagger/v1/swagger.json - -
2022-09-21 10:56:31.821 +01:00 [DBG] No candidates found for the request path '/swagger/v1/swagger.json'
2022-09-21 10:56:31.821 +01:00 [DBG] Request did not match any endpoints
2022-09-21 10:56:32.005 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/swagger/v1/swagger.json - - - 200 - application/json;charset=utf-8 185.4555ms
2022-09-21 10:57:12.059 +01:00 [INF] Request starting HTTP/2 POST https://localhost:7036/api/Users/Login application/json 58
2022-09-21 10:57:12.081 +01:00 [DBG] 1 candidate(s) found for the request path '/api/Users/Login'
2022-09-21 10:57:12.090 +01:00 [DBG] Endpoint 'APIBank.Controllers.UsersController.Login (APIBank)' with route pattern 'api/Users/Login' is valid for the request path '/api/Users/Login'
2022-09-21 10:57:12.099 +01:00 [DBG] Request matched endpoint 'APIBank.Controllers.UsersController.Login (APIBank)'
2022-09-21 10:57:12.102 +01:00 [DBG] Static files was skipped as the request already matched an endpoint.
2022-09-21 10:57:12.638 +01:00 [INF] Executing endpoint 'APIBank.Controllers.UsersController.Login (APIBank)'
2022-09-21 10:57:12.672 +01:00 [INF] Route matched with {action = "Login", controller = "Users"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult Login(APIBank.Models.Requests.LoginRequest) on controller APIBank.Controllers.UsersController (APIBank).
2022-09-21 10:57:12.680 +01:00 [DBG] Execution plan of authorization filters (in the following order): ["APIBank.Authorization.AuthorizeAttribute"]
2022-09-21 10:57:12.682 +01:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2022-09-21 10:57:12.684 +01:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2022-09-21 10:57:12.686 +01:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2022-09-21 10:57:12.687 +01:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2022-09-21 10:57:12.690 +01:00 [DBG] Executing controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-21 10:57:12.692 +01:00 [DBG] Executed controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-21 10:57:12.716 +01:00 [DBG] Attempting to bind parameter 'model' of type 'APIBank.Models.Requests.LoginRequest' ...
2022-09-21 10:57:12.719 +01:00 [DBG] Attempting to bind parameter 'model' of type 'APIBank.Models.Requests.LoginRequest' using the name '' in request data ...
2022-09-21 10:57:12.721 +01:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2022-09-21 10:57:12.729 +01:00 [DBG] Connection id "0HMKRMU7CG9JF", Request id "0HMKRMU7CG9JF:00000009": started reading request body.
2022-09-21 10:57:12.731 +01:00 [DBG] Connection id "0HMKRMU7CG9JF", Request id "0HMKRMU7CG9JF:00000009": done reading request body.
2022-09-21 10:57:12.737 +01:00 [DBG] JSON input formatter succeeded, deserializing to type 'APIBank.Models.Requests.LoginRequest'
2022-09-21 10:57:12.738 +01:00 [DBG] Done attempting to bind parameter 'model' of type 'APIBank.Models.Requests.LoginRequest'.
2022-09-21 10:57:12.739 +01:00 [DBG] Done attempting to bind parameter 'model' of type 'APIBank.Models.Requests.LoginRequest'.
2022-09-21 10:57:12.740 +01:00 [DBG] Attempting to validate the bound parameter 'model' of type 'APIBank.Models.Requests.LoginRequest' ...
2022-09-21 10:57:12.750 +01:00 [DBG] Done attempting to validate the bound parameter 'model' of type 'APIBank.Models.Requests.LoginRequest'.
2022-09-21 10:57:12.890 +01:00 [DBG] An additional 'IServiceProvider' was created for internal use by Entity Framework. An existing service provider was not used due to the following configuration changes: configuration changed for 'Core:ConfigureWarnings', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:UseAdminDatabase', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:SetPostgresVersion', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:UseRedshift', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:ReverseNullOrdering', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:RemoteCertificateValidationCallback', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:ProvideClientCertificatesCallback', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:ProvidePasswordCallback'.
2022-09-21 10:57:14.589 +01:00 [INF] Entity Framework Core 6.0.9 initialized 'PostgresContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:6.0.7+5b98e4b74de93b590b44aef8dd7967c03acc433c' with options: None
2022-09-21 10:57:14.662 +01:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .SingleOrDefault(x => x.Username == __model_Username_0)'
2022-09-21 10:57:15.233 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<User>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: User.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: User.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 1], [Property: User.Email (string) Required Index MaxLength(254), 2], [Property: User.FullName (string) Required MaxLength(100), 3], [Property: User.PasswordChangedAt (DateTime) Required ValueGenerated.OnAdd, 4], [Property: User.PasswordHash (string) Required MaxLength(200), 5], [Property: User.Username (string) Required Index MaxLength(50), 6] }
        SELECT TOP(2) u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
        FROM users AS u
        WHERE u.username == @__model_Username_0), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, User>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)
    .SingleOrDefault()'
2022-09-21 10:57:15.313 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-21 10:57:15.432 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (114ms).
2022-09-21 10:57:15.448 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-21 10:57:15.861 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 10:57:15.889 +01:00 [DBG] Executing DbCommand [Parameters=[@__model_Username_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.username = @__model_Username_0
LIMIT 2
2022-09-21 10:57:16.022 +01:00 [INF] Executed DbCommand (143ms) [Parameters=[@__model_Username_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.username = @__model_Username_0
LIMIT 2
2022-09-21 10:57:16.085 +01:00 [DBG] Context 'PostgresContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 10:57:16.142 +01:00 [DBG] A data reader was disposed.
2022-09-21 10:57:16.150 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 10:57:16.162 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-21 10:57:16.672 +01:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .Any(user => user.RefreshTokenCollection
        .Any(reftoken => reftoken.RefToken == __token_0))'
2022-09-21 10:57:16.846 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<bool>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            EmptyProjectionMember -> 0
        SELECT EXISTS (
            SELECT 1
            FROM users AS u
            WHERE EXISTS (
                SELECT 1
                FROM refresh_token AS r
                WHERE ((u.id != NULL) && (u.id == r.user_id)) && (r.token == @__token_0)))), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, bool>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)
    .Single()'
2022-09-21 10:57:16.861 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-21 10:57:16.864 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (2ms).
2022-09-21 10:57:16.865 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-21 10:57:16.866 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 10:57:16.867 +01:00 [DBG] Executing DbCommand [Parameters=[@__token_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM users AS u
    WHERE EXISTS (
        SELECT 1
        FROM refresh_token AS r
        WHERE (u.id = r.user_id) AND (r.token = @__token_0)))
2022-09-21 10:57:16.871 +01:00 [INF] Executed DbCommand (4ms) [Parameters=[@__token_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM users AS u
    WHERE EXISTS (
        SELECT 1
        FROM refresh_token AS r
        WHERE (u.id = r.user_id) AND (r.token = @__token_0)))
2022-09-21 10:57:16.882 +01:00 [DBG] A data reader was disposed.
2022-09-21 10:57:16.884 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 10:57:16.884 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-21 10:57:16.897 +01:00 [DBG] Compiling query expression: 
'DbSet<RefreshToken>()
    .Where(rt => rt.UserId == __id_0)
    .AsNoTracking()
    .Select(rt => new RefreshToken{ 
        Id = rt.Id, 
        UserId = rt.UserId, 
        RefToken = rt.RefToken, 
        Expires = rt.Expires, 
        Created = rt.Created, 
        CreatedByIp = rt.CreatedByIp, 
        Revoked = rt.Revoked, 
        RevokedByIp = rt.RevokedByIp, 
        ReplacedByToken = rt.ReplacedByToken, 
        ReasonRevoked = rt.ReasonRevoked, 
        IsExpired = rt.IsExpired, 
        IsRevoked = rt.IsRevoked, 
        IsActive = rt.IsActive 
    }
    )'
2022-09-21 10:57:16.936 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<RefreshToken>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            Id -> 0
            UserId -> 1
            RefToken -> 2
            Expires -> 3
            Created -> 4
            CreatedByIp -> 5
            Revoked -> 6
            RevokedByIp -> 7
            ReplacedByToken -> 8
            ReasonRevoked -> 9
            IsExpired -> 10
            IsRevoked -> 11
            IsActive -> 12
        SELECT r.id AS Id, r.user_id AS UserId, r.token AS RefToken, r.expires AS Expires, r.created AS Created, r.created_by_ip AS CreatedByIp, r.revoked AS Revoked, r.revoked_by_ip AS RevokedByIp, r.replaced_by_token AS ReplacedByToken, r.reason_revoked AS ReasonRevoked, r.is_expired AS IsExpired, r.is_revoked AS IsRevoked, r.is_active AS IsActive
        FROM refresh_token AS r
        WHERE r.user_id == @__id_0), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, RefreshToken>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)'
2022-09-21 10:57:16.942 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-21 10:57:16.943 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2022-09-21 10:57:16.945 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-21 10:57:16.945 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 10:57:16.946 +01:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.user_id AS "UserId", r.token AS "RefToken", r.expires AS "Expires", r.created AS "Created", r.created_by_ip AS "CreatedByIp", r.revoked AS "Revoked", r.revoked_by_ip AS "RevokedByIp", r.replaced_by_token AS "ReplacedByToken", r.reason_revoked AS "ReasonRevoked", r.is_expired AS "IsExpired", r.is_revoked AS "IsRevoked", r.is_active AS "IsActive"
FROM refresh_token AS r
WHERE r.user_id = @__id_0
2022-09-21 10:57:16.953 +01:00 [INF] Executed DbCommand (7ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.user_id AS "UserId", r.token AS "RefToken", r.expires AS "Expires", r.created AS "Created", r.created_by_ip AS "CreatedByIp", r.revoked AS "Revoked", r.revoked_by_ip AS "RevokedByIp", r.replaced_by_token AS "ReplacedByToken", r.reason_revoked AS "ReasonRevoked", r.is_expired AS "IsExpired", r.is_revoked AS "IsRevoked", r.is_active AS "IsActive"
FROM refresh_token AS r
WHERE r.user_id = @__id_0
2022-09-21 10:57:16.958 +01:00 [DBG] A data reader was disposed.
2022-09-21 10:57:16.959 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 10:57:16.960 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-21 10:57:16.980 +01:00 [DBG] An entity of type 'User' tracked by 'PostgresContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 10:57:17.030 +01:00 [DBG] 'PostgresContext' generated a temporary value for the property 'Id.RefreshToken'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 10:57:17.094 +01:00 [DBG] Context 'PostgresContext' started tracking 'RefreshToken' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 10:57:17.101 +01:00 [DBG] SaveChanges starting for 'PostgresContext'.
2022-09-21 10:57:17.104 +01:00 [DBG] DetectChanges starting for 'PostgresContext'.
2022-09-21 10:57:17.142 +01:00 [DBG] 1 entities were added and 0 entities were removed from navigation 'User.RefreshTokenCollection'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 10:57:17.162 +01:00 [DBG] The foreign key property 'RefreshToken.UserId' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2022-09-21 10:57:17.191 +01:00 [DBG] DetectChanges completed for 'PostgresContext'.
2022-09-21 10:57:17.209 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-21 10:57:17.212 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 10:57:17.215 +01:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2022-09-21 10:57:17.227 +01:00 [DBG] Began transaction with isolation level 'ReadCommitted'.
2022-09-21 10:57:17.305 +01:00 [DBG] Executing 2 update commands as a batch.
2022-09-21 10:57:17.330 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-21 10:57:17.333 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (2ms).
2022-09-21 10:57:17.335 +01:00 [DBG] Executing DbCommand [Parameters=[@p0='?' (DbType = DateTime), @p1='?', @p2='?' (DbType = DateTime), @p3='?' (DbType = Boolean), @p4='?' (DbType = Boolean), @p5='?' (DbType = Boolean), @p6='?', @p7='?', @p8='?', @p9='?' (DbType = DateTime), @p10='?', @p11='?' (DbType = Int32), @p18='?' (DbType = Int32), @p12='?' (DbType = DateTime), @p13='?', @p14='?', @p15='?' (DbType = DateTime), @p16='?', @p17='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO refresh_token (created, created_by_ip, expires, is_active, is_expired, is_revoked, reason_revoked, token, replaced_by_token, revoked, revoked_by_ip, user_id)
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11)
RETURNING id;
UPDATE users SET created_at = @p12, email = @p13, full_name = @p14, password_changed_at = @p15, password_hash = @p16, username = @p17
WHERE id = @p18;
2022-09-21 10:57:17.355 +01:00 [INF] Executed DbCommand (20ms) [Parameters=[@p0='?' (DbType = DateTime), @p1='?', @p2='?' (DbType = DateTime), @p3='?' (DbType = Boolean), @p4='?' (DbType = Boolean), @p5='?' (DbType = Boolean), @p6='?', @p7='?', @p8='?', @p9='?' (DbType = DateTime), @p10='?', @p11='?' (DbType = Int32), @p18='?' (DbType = Int32), @p12='?' (DbType = DateTime), @p13='?', @p14='?', @p15='?' (DbType = DateTime), @p16='?', @p17='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO refresh_token (created, created_by_ip, expires, is_active, is_expired, is_revoked, reason_revoked, token, replaced_by_token, revoked, revoked_by_ip, user_id)
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11)
RETURNING id;
UPDATE users SET created_at = @p12, email = @p13, full_name = @p14, password_changed_at = @p15, password_hash = @p16, username = @p17
WHERE id = @p18;
2022-09-21 10:57:17.385 +01:00 [DBG] The foreign key property 'RefreshToken.Id' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2022-09-21 10:57:17.391 +01:00 [DBG] A data reader was disposed.
2022-09-21 10:57:17.399 +01:00 [DBG] Committing transaction.
2022-09-21 10:57:17.410 +01:00 [DBG] Committed transaction.
2022-09-21 10:57:17.412 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 10:57:17.413 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-21 10:57:17.416 +01:00 [DBG] Disposing transaction.
2022-09-21 10:57:17.419 +01:00 [DBG] An entity of type 'RefreshToken' tracked by 'PostgresContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 10:57:17.422 +01:00 [DBG] An entity of type 'User' tracked by 'PostgresContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 10:57:17.426 +01:00 [DBG] SaveChanges completed for 'PostgresContext' with 2 entities written to the database.
2022-09-21 10:57:17.433 +01:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2022-09-21 10:57:17.443 +01:00 [DBG] Attempting to select an output formatter based on Accept header '["text/plain"]'.
2022-09-21 10:57:17.446 +01:00 [DBG] Could not find an output formatter based on content negotiation. Accepted types were (["text/plain"])
2022-09-21 10:57:17.447 +01:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2022-09-21 10:57:17.448 +01:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2022-09-21 10:57:17.450 +01:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2022-09-21 10:57:17.453 +01:00 [INF] Executing OkObjectResult, writing value of type 'APIBank.Models.Users.Responses.LoginResponse'.
2022-09-21 10:57:17.481 +01:00 [INF] Executed action APIBank.Controllers.UsersController.Login (APIBank) in 4786.6451ms
2022-09-21 10:57:17.486 +01:00 [INF] Executed endpoint 'APIBank.Controllers.UsersController.Login (APIBank)'
2022-09-21 10:57:17.496 +01:00 [DBG] 'PostgresContext' disposed.
2022-09-21 10:57:17.505 +01:00 [INF] Request finished HTTP/2 POST https://localhost:7036/api/Users/Login application/json 58 - 200 - application/json;+charset=utf-8 5445.7400ms
2022-09-21 10:57:37.402 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/api/Accounts/GetAll - -
2022-09-21 10:57:37.419 +01:00 [DBG] 1 candidate(s) found for the request path '/api/Accounts/GetAll'
2022-09-21 10:57:37.426 +01:00 [DBG] Endpoint 'APIBank.Controllers.AccountsController.GetAllFromUser (APIBank)' with route pattern 'api/Accounts/GetAll' is valid for the request path '/api/Accounts/GetAll'
2022-09-21 10:57:37.430 +01:00 [DBG] Request matched endpoint 'APIBank.Controllers.AccountsController.GetAllFromUser (APIBank)'
2022-09-21 10:57:37.431 +01:00 [DBG] Static files was skipped as the request already matched an endpoint.
2022-09-21 10:57:37.579 +01:00 [INF] Entity Framework Core 6.0.9 initialized 'PostgresContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:6.0.7+5b98e4b74de93b590b44aef8dd7967c03acc433c' with options: None
2022-09-21 10:57:37.595 +01:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .FirstOrDefault(e => EF.Property<int>(e, "Id") == __p_0)'
2022-09-21 10:57:37.600 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<User>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: User.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: User.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 1], [Property: User.Email (string) Required Index MaxLength(254), 2], [Property: User.FullName (string) Required MaxLength(100), 3], [Property: User.PasswordChangedAt (DateTime) Required ValueGenerated.OnAdd, 4], [Property: User.PasswordHash (string) Required MaxLength(200), 5], [Property: User.Username (string) Required Index MaxLength(50), 6] }
        SELECT TOP(1) u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
        FROM users AS u
        WHERE u.id == @__p_0), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, User>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)
    .SingleOrDefault()'
2022-09-21 10:57:37.602 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-21 10:57:37.603 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2022-09-21 10:57:37.603 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-21 10:57:37.604 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 10:57:37.605 +01:00 [DBG] Executing DbCommand [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.id = @__p_0
LIMIT 1
2022-09-21 10:57:37.611 +01:00 [INF] Executed DbCommand (6ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.id = @__p_0
LIMIT 1
2022-09-21 10:57:37.613 +01:00 [DBG] Context 'PostgresContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 10:57:37.614 +01:00 [DBG] A data reader was disposed.
2022-09-21 10:57:37.615 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 10:57:37.616 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-21 10:57:37.617 +01:00 [INF] Executing endpoint 'APIBank.Controllers.AccountsController.GetAllFromUser (APIBank)'
2022-09-21 10:57:37.619 +01:00 [INF] Route matched with {action = "GetAllFromUser", controller = "Accounts"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult GetAllFromUser() on controller APIBank.Controllers.AccountsController (APIBank).
2022-09-21 10:57:37.620 +01:00 [DBG] Execution plan of authorization filters (in the following order): ["APIBank.Authorization.AuthorizeAttribute"]
2022-09-21 10:57:37.621 +01:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2022-09-21 10:57:37.627 +01:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2022-09-21 10:57:37.628 +01:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2022-09-21 10:57:37.629 +01:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2022-09-21 10:57:37.630 +01:00 [DBG] Executing controller factory for controller APIBank.Controllers.AccountsController (APIBank)
2022-09-21 10:57:37.631 +01:00 [DBG] Executed controller factory for controller APIBank.Controllers.AccountsController (APIBank)
2022-09-21 10:57:37.636 +01:00 [DBG] Compiling query expression: 
'DbSet<Account>()
    .Where(u => u.UserId == __userId_0)
    .Select(u => new AccountRe{ 
        Balance = u.Balance, 
        CreatedAt = u.CreatedAt, 
        Currency = u.Currency, 
        Id = u.Id 
    }
    )'
2022-09-21 10:57:37.646 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<AccountRe>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            Balance -> 0
            CreatedAt -> 1
            Currency -> 2
            Id -> 3
        SELECT a.balance AS Balance, a.created_at AS CreatedAt, a.currency AS Currency, a.id AS Id
        FROM accounts AS a
        WHERE a.user_id == @__userId_0), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, AccountRe>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)'
2022-09-21 10:57:37.649 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-21 10:57:37.650 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2022-09-21 10:57:37.653 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-21 10:57:37.654 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 10:57:37.658 +01:00 [DBG] Executing DbCommand [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a.balance AS "Balance", a.created_at AS "CreatedAt", a.currency AS "Currency", a.id AS "Id"
FROM accounts AS a
WHERE a.user_id = @__userId_0
2022-09-21 10:57:37.664 +01:00 [INF] Executed DbCommand (7ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a.balance AS "Balance", a.created_at AS "CreatedAt", a.currency AS "Currency", a.id AS "Id"
FROM accounts AS a
WHERE a.user_id = @__userId_0
2022-09-21 10:57:37.682 +01:00 [DBG] A data reader was disposed.
2022-09-21 10:57:37.684 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 10:57:37.685 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-21 10:57:37.686 +01:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2022-09-21 10:57:37.689 +01:00 [DBG] Attempting to select an output formatter based on Accept header '["text/plain"]'.
2022-09-21 10:57:37.692 +01:00 [DBG] Could not find an output formatter based on content negotiation. Accepted types were (["text/plain"])
2022-09-21 10:57:37.694 +01:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2022-09-21 10:57:37.695 +01:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2022-09-21 10:57:37.696 +01:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2022-09-21 10:57:37.697 +01:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[APIBank.Models.Accounts.AccountRe, APIBank, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2022-09-21 10:57:37.705 +01:00 [INF] Executed action APIBank.Controllers.AccountsController.GetAllFromUser (APIBank) in 74.5378ms
2022-09-21 10:57:37.708 +01:00 [INF] Executed endpoint 'APIBank.Controllers.AccountsController.GetAllFromUser (APIBank)'
2022-09-21 10:57:37.710 +01:00 [DBG] 'PostgresContext' disposed.
2022-09-21 10:57:37.711 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/api/Accounts/GetAll - - - 200 - application/json;+charset=utf-8 308.9331ms
2022-09-21 10:57:43.401 +01:00 [DBG] Connection id "0HMKRMU7CG9JF" received FIN.
2022-09-21 10:57:43.403 +01:00 [DBG] Connection id "0HMKRMU7CG9JF" is closed. The last processed stream ID was 11.
2022-09-21 10:57:43.405 +01:00 [DBG] Connection id "0HMKRMU7CG9JF" sending FIN because: "The client closed the connection."
2022-09-21 10:57:43.408 +01:00 [DBG] Connection id "0HMKRMU7CG9JF" stopped.
2022-09-21 10:58:34.845 +01:00 [DBG] Connection id "0HMKRMU7CG9JG" accepted.
2022-09-21 10:58:34.849 +01:00 [DBG] Connection id "0HMKRMU7CG9JG" started.
2022-09-21 10:58:34.863 +01:00 [DBG] Connection 0HMKRMU7CG9JG established using the following protocol: "Tls12"
2022-09-21 10:58:34.865 +01:00 [INF] Request starting HTTP/2 POST https://localhost:7036/api/Transfers/TransferRequest application/json 76
2022-09-21 10:58:34.874 +01:00 [DBG] 1 candidate(s) found for the request path '/api/Transfers/TransferRequest'
2022-09-21 10:58:34.875 +01:00 [DBG] Endpoint 'APIBank.Controllers.TransfersController.Create (APIBank)' with route pattern 'api/Transfers/TransferRequest' is valid for the request path '/api/Transfers/TransferRequest'
2022-09-21 10:58:34.877 +01:00 [DBG] Request matched endpoint 'APIBank.Controllers.TransfersController.Create (APIBank)'
2022-09-21 10:58:34.878 +01:00 [DBG] Static files was skipped as the request already matched an endpoint.
2022-09-21 10:58:34.940 +01:00 [INF] Entity Framework Core 6.0.9 initialized 'PostgresContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:6.0.7+5b98e4b74de93b590b44aef8dd7967c03acc433c' with options: None
2022-09-21 10:58:34.949 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-21 10:58:34.950 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2022-09-21 10:58:34.950 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-21 10:58:34.951 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 10:58:34.952 +01:00 [DBG] Executing DbCommand [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.id = @__p_0
LIMIT 1
2022-09-21 10:58:34.954 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.id = @__p_0
LIMIT 1
2022-09-21 10:58:34.957 +01:00 [DBG] Context 'PostgresContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 10:58:34.959 +01:00 [DBG] A data reader was disposed.
2022-09-21 10:58:34.960 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 10:58:34.961 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-21 10:58:34.963 +01:00 [INF] Executing endpoint 'APIBank.Controllers.TransfersController.Create (APIBank)'
2022-09-21 10:58:34.966 +01:00 [INF] Route matched with {action = "Create", controller = "Transfers"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult Create(APIBank.Models.Transfers.Requests.TransferRequest) on controller APIBank.Controllers.TransfersController (APIBank).
2022-09-21 10:58:34.967 +01:00 [DBG] Execution plan of authorization filters (in the following order): ["APIBank.Authorization.AuthorizeAttribute"]
2022-09-21 10:58:34.968 +01:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2022-09-21 10:58:34.969 +01:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2022-09-21 10:58:34.970 +01:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2022-09-21 10:58:34.971 +01:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2022-09-21 10:58:34.974 +01:00 [DBG] Executing controller factory for controller APIBank.Controllers.TransfersController (APIBank)
2022-09-21 10:58:34.975 +01:00 [DBG] Executed controller factory for controller APIBank.Controllers.TransfersController (APIBank)
2022-09-21 10:58:34.977 +01:00 [DBG] Attempting to bind parameter 'model' of type 'APIBank.Models.Transfers.Requests.TransferRequest' ...
2022-09-21 10:58:34.980 +01:00 [DBG] Attempting to bind parameter 'model' of type 'APIBank.Models.Transfers.Requests.TransferRequest' using the name '' in request data ...
2022-09-21 10:58:34.981 +01:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2022-09-21 10:58:34.982 +01:00 [DBG] Connection id "0HMKRMU7CG9JG", Request id "0HMKRMU7CG9JG:00000001": started reading request body.
2022-09-21 10:58:34.983 +01:00 [DBG] Connection id "0HMKRMU7CG9JG", Request id "0HMKRMU7CG9JG:00000001": done reading request body.
2022-09-21 10:58:34.991 +01:00 [DBG] JSON input formatter succeeded, deserializing to type 'APIBank.Models.Transfers.Requests.TransferRequest'
2022-09-21 10:58:34.992 +01:00 [DBG] Done attempting to bind parameter 'model' of type 'APIBank.Models.Transfers.Requests.TransferRequest'.
2022-09-21 10:58:34.995 +01:00 [DBG] Done attempting to bind parameter 'model' of type 'APIBank.Models.Transfers.Requests.TransferRequest'.
2022-09-21 10:58:34.996 +01:00 [DBG] Attempting to validate the bound parameter 'model' of type 'APIBank.Models.Transfers.Requests.TransferRequest' ...
2022-09-21 10:58:34.999 +01:00 [DBG] Done attempting to validate the bound parameter 'model' of type 'APIBank.Models.Transfers.Requests.TransferRequest'.
2022-09-21 10:58:35.004 +01:00 [DBG] Compiling query expression: 
'DbSet<Account>()
    .Include(a => a.Transactions)
    .Where(a => a.Id == __accountId_0 && a.UserId == __userId_1)
    .Select(a => new AccountMovims{ 
        Account = new AccountRe{ 
            Balance = a.Balance, 
            Currency = a.Currency, 
            CreatedAt = a.CreatedAt, 
            Id = a.Id 
        }
        , 
        Movims = a.Transactions
            .Select(b => new Movim{ 
                Amount = b.Amount, 
                CreatedAt = b.CreatedAt 
            }
            )
            .ToArray() 
    }
    )
    .SingleOrDefault()'
2022-09-21 10:58:35.149 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<AccountMovims>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Client Projections:
            0 -> 0
            1 -> 1
            2 -> 2
            3 -> 3
            4 -> 4
            5 -> 5
            6 -> 6
        SELECT t.balance, t.currency, t.created_at, t.id, t0.amount, t0.created_at, t0.id
        FROM 
        (
            SELECT TOP(2) a.balance, a.currency, a.created_at, a.id
            FROM accounts AS a
            WHERE (a.id == @__accountId_0) && (a.user_id == @__userId_1)
        ) AS t
        LEFT JOIN transactions AS t0 ON t.id == t0.account_id
        ORDER BY t.id ASC), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, AccountMovims>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)
    .SingleOrDefault()'
2022-09-21 10:58:35.160 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-21 10:58:35.162 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (2ms).
2022-09-21 10:58:35.163 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-21 10:58:35.165 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 10:58:35.166 +01:00 [DBG] Executing DbCommand [Parameters=[@__accountId_0='?' (DbType = Int32), @__userId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT t.balance, t.currency, t.created_at, t.id, t0.amount, t0.created_at, t0.id
FROM (
    SELECT a.balance, a.currency, a.created_at, a.id
    FROM accounts AS a
    WHERE (a.id = @__accountId_0) AND (a.user_id = @__userId_1)
    LIMIT 2
) AS t
LEFT JOIN transactions AS t0 ON t.id = t0.account_id
ORDER BY t.id
2022-09-21 10:58:35.169 +01:00 [INF] Executed DbCommand (3ms) [Parameters=[@__accountId_0='?' (DbType = Int32), @__userId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT t.balance, t.currency, t.created_at, t.id, t0.amount, t0.created_at, t0.id
FROM (
    SELECT a.balance, a.currency, a.created_at, a.id
    FROM accounts AS a
    WHERE (a.id = @__accountId_0) AND (a.user_id = @__userId_1)
    LIMIT 2
) AS t
LEFT JOIN transactions AS t0 ON t.id = t0.account_id
ORDER BY t.id
2022-09-21 10:58:35.173 +01:00 [DBG] A data reader was disposed.
2022-09-21 10:58:35.174 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 10:58:35.176 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-21 10:59:11.113 +01:00 [INF] Executed action APIBank.Controllers.TransfersController.Create (APIBank) in 36139.4732ms
2022-09-21 10:59:11.119 +01:00 [INF] Executed endpoint 'APIBank.Controllers.TransfersController.Create (APIBank)'
2022-09-21 10:59:11.166 +01:00 [INF] Global Error was found:
2022-09-21 10:59:11.168 +01:00 [DBG] 'PostgresContext' disposed.
2022-09-21 10:59:11.169 +01:00 [INF] Request finished HTTP/2 POST https://localhost:7036/api/Transfers/TransferRequest application/json 76 - 500 - application/json 36304.0484ms
2022-09-21 10:59:28.337 +01:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2022-09-21 10:59:28.685 +01:00 [DBG] Hosting starting
2022-09-21 10:59:29.025 +01:00 [DBG] Using development certificate: CN=localhost (Thumbprint: 9CC642E9838495A6C3C202DECA6A8AD300396DD2)
2022-09-21 10:59:29.088 +01:00 [INF] Now listening on: https://localhost:7036
2022-09-21 10:59:29.089 +01:00 [INF] Now listening on: http://localhost:5036
2022-09-21 10:59:29.090 +01:00 [DBG] Loaded hosting startup assembly APIBank
2022-09-21 10:59:29.091 +01:00 [DBG] Loaded hosting startup assembly Microsoft.AspNetCore.Watch.BrowserRefresh
2022-09-21 10:59:29.092 +01:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.BrowserLink.Net
2022-09-21 10:59:29.093 +01:00 [INF] Application started. Press Ctrl+C to shut down.
2022-09-21 10:59:29.093 +01:00 [INF] Hosting environment: Development
2022-09-21 10:59:29.094 +01:00 [INF] Content root path: C:\Users\mguedesa\OneDrive - NTT DATA EMEAL\Documentos\GitHub\OpenBankAPI-NTT\APIBank\APIBank\
2022-09-21 10:59:29.094 +01:00 [DBG] Hosting started
2022-09-21 10:59:29.421 +01:00 [DBG] Connection id "0HMKRMVSOIHJP" accepted.
2022-09-21 10:59:29.421 +01:00 [DBG] Connection id "0HMKRMVSOIHJQ" accepted.
2022-09-21 10:59:29.424 +01:00 [DBG] Connection id "0HMKRMVSOIHJP" started.
2022-09-21 10:59:29.424 +01:00 [DBG] Connection id "0HMKRMVSOIHJQ" started.
2022-09-21 10:59:29.433 +01:00 [DBG] Connection id "0HMKRMVSOIHJP" received FIN.
2022-09-21 10:59:29.433 +01:00 [DBG] Connection id "0HMKRMVSOIHJQ" received FIN.
2022-09-21 10:59:29.443 +01:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException:  Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveBlobAsync[TIOAdapter](TIOAdapter adapter)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](TIOAdapter adapter, Boolean receiveFirst, Byte[] reAuthenticationData, Boolean isApm)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2022-09-21 10:59:29.443 +01:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException:  Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveBlobAsync[TIOAdapter](TIOAdapter adapter)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](TIOAdapter adapter, Boolean receiveFirst, Byte[] reAuthenticationData, Boolean isApm)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2022-09-21 10:59:29.480 +01:00 [DBG] Connection id "0HMKRMVSOIHJQ" stopped.
2022-09-21 10:59:29.480 +01:00 [DBG] Connection id "0HMKRMVSOIHJP" stopped.
2022-09-21 10:59:29.482 +01:00 [DBG] Connection id "0HMKRMVSOIHJP" sending FIN because: "The Socket transport's send loop completed gracefully."
2022-09-21 10:59:29.482 +01:00 [DBG] Connection id "0HMKRMVSOIHJQ" sending FIN because: "The Socket transport's send loop completed gracefully."
2022-09-21 10:59:29.885 +01:00 [DBG] Connection id "0HMKRMVSOIHJR" accepted.
2022-09-21 10:59:29.888 +01:00 [DBG] Connection id "0HMKRMVSOIHJR" started.
2022-09-21 10:59:29.969 +01:00 [DBG] Connection 0HMKRMVSOIHJR established using the following protocol: "Tls12"
2022-09-21 10:59:30.095 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/swagger/index.html - -
2022-09-21 10:59:30.193 +01:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2022-09-21 10:59:30.242 +01:00 [DBG] No candidates found for the request path '/swagger/index.html'
2022-09-21 10:59:30.245 +01:00 [DBG] Request did not match any endpoints
2022-09-21 10:59:30.478 +01:00 [DBG] Response markup is scheduled to include browser refresh script injection.
2022-09-21 10:59:30.618 +01:00 [DBG] Response markup was updated to include browser refresh script injection.
2022-09-21 10:59:30.629 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/swagger/index.html - - - 200 - text/html;charset=utf-8 541.2721ms
2022-09-21 10:59:30.659 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/_vs/browserLink - -
2022-09-21 10:59:30.659 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/_framework/aspnetcore-browser-refresh.js - -
2022-09-21 10:59:30.681 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/_framework/aspnetcore-browser-refresh.js - - - 200 11984 application/javascript;+charset=utf-8 21.3277ms
2022-09-21 10:59:30.707 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/_vs/browserLink - - - 200 - text/javascript;+charset=UTF-8 47.2107ms
2022-09-21 10:59:30.797 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/swagger/v1/swagger.json - -
2022-09-21 10:59:30.799 +01:00 [DBG] No candidates found for the request path '/swagger/v1/swagger.json'
2022-09-21 10:59:30.800 +01:00 [DBG] Request did not match any endpoints
2022-09-21 10:59:30.999 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/swagger/v1/swagger.json - - - 200 - application/json;charset=utf-8 202.0652ms
2022-09-21 10:59:44.139 +01:00 [INF] Request starting HTTP/2 POST https://localhost:7036/api/Users/Login application/json 58
2022-09-21 10:59:44.165 +01:00 [DBG] 1 candidate(s) found for the request path '/api/Users/Login'
2022-09-21 10:59:44.174 +01:00 [DBG] Endpoint 'APIBank.Controllers.UsersController.Login (APIBank)' with route pattern 'api/Users/Login' is valid for the request path '/api/Users/Login'
2022-09-21 10:59:44.180 +01:00 [DBG] Request matched endpoint 'APIBank.Controllers.UsersController.Login (APIBank)'
2022-09-21 10:59:44.185 +01:00 [DBG] Static files was skipped as the request already matched an endpoint.
2022-09-21 10:59:44.710 +01:00 [INF] Executing endpoint 'APIBank.Controllers.UsersController.Login (APIBank)'
2022-09-21 10:59:44.747 +01:00 [INF] Route matched with {action = "Login", controller = "Users"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult Login(APIBank.Models.Requests.LoginRequest) on controller APIBank.Controllers.UsersController (APIBank).
2022-09-21 10:59:44.750 +01:00 [DBG] Execution plan of authorization filters (in the following order): ["APIBank.Authorization.AuthorizeAttribute"]
2022-09-21 10:59:44.752 +01:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2022-09-21 10:59:44.753 +01:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2022-09-21 10:59:44.754 +01:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2022-09-21 10:59:44.755 +01:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2022-09-21 10:59:44.758 +01:00 [DBG] Executing controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-21 10:59:44.760 +01:00 [DBG] Executed controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-21 10:59:44.779 +01:00 [DBG] Attempting to bind parameter 'model' of type 'APIBank.Models.Requests.LoginRequest' ...
2022-09-21 10:59:44.783 +01:00 [DBG] Attempting to bind parameter 'model' of type 'APIBank.Models.Requests.LoginRequest' using the name '' in request data ...
2022-09-21 10:59:44.785 +01:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2022-09-21 10:59:44.791 +01:00 [DBG] Connection id "0HMKRMVSOIHJR", Request id "0HMKRMVSOIHJR:00000009": started reading request body.
2022-09-21 10:59:44.792 +01:00 [DBG] Connection id "0HMKRMVSOIHJR", Request id "0HMKRMVSOIHJR:00000009": done reading request body.
2022-09-21 10:59:44.801 +01:00 [DBG] JSON input formatter succeeded, deserializing to type 'APIBank.Models.Requests.LoginRequest'
2022-09-21 10:59:44.802 +01:00 [DBG] Done attempting to bind parameter 'model' of type 'APIBank.Models.Requests.LoginRequest'.
2022-09-21 10:59:44.803 +01:00 [DBG] Done attempting to bind parameter 'model' of type 'APIBank.Models.Requests.LoginRequest'.
2022-09-21 10:59:44.804 +01:00 [DBG] Attempting to validate the bound parameter 'model' of type 'APIBank.Models.Requests.LoginRequest' ...
2022-09-21 10:59:44.815 +01:00 [DBG] Done attempting to validate the bound parameter 'model' of type 'APIBank.Models.Requests.LoginRequest'.
2022-09-21 10:59:44.940 +01:00 [DBG] An additional 'IServiceProvider' was created for internal use by Entity Framework. An existing service provider was not used due to the following configuration changes: configuration changed for 'Core:ConfigureWarnings', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:UseAdminDatabase', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:SetPostgresVersion', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:UseRedshift', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:ReverseNullOrdering', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:RemoteCertificateValidationCallback', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:ProvideClientCertificatesCallback', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:ProvidePasswordCallback'.
2022-09-21 10:59:46.531 +01:00 [INF] Entity Framework Core 6.0.9 initialized 'PostgresContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:6.0.7+5b98e4b74de93b590b44aef8dd7967c03acc433c' with options: None
2022-09-21 10:59:46.608 +01:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .SingleOrDefault(x => x.Username == __model_Username_0)'
2022-09-21 10:59:47.135 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<User>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: User.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: User.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 1], [Property: User.Email (string) Required Index MaxLength(254), 2], [Property: User.FullName (string) Required MaxLength(100), 3], [Property: User.PasswordChangedAt (DateTime) Required ValueGenerated.OnAdd, 4], [Property: User.PasswordHash (string) Required MaxLength(200), 5], [Property: User.Username (string) Required Index MaxLength(50), 6] }
        SELECT TOP(2) u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
        FROM users AS u
        WHERE u.username == @__model_Username_0), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, User>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)
    .SingleOrDefault()'
2022-09-21 10:59:47.215 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-21 10:59:47.350 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (123ms).
2022-09-21 10:59:47.364 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-21 10:59:47.688 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 10:59:47.713 +01:00 [DBG] Executing DbCommand [Parameters=[@__model_Username_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.username = @__model_Username_0
LIMIT 2
2022-09-21 10:59:47.849 +01:00 [INF] Executed DbCommand (144ms) [Parameters=[@__model_Username_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.username = @__model_Username_0
LIMIT 2
2022-09-21 10:59:47.923 +01:00 [DBG] Context 'PostgresContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 10:59:48.007 +01:00 [DBG] A data reader was disposed.
2022-09-21 10:59:48.015 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 10:59:48.027 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-21 10:59:48.529 +01:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .Any(user => user.RefreshTokenCollection
        .Any(reftoken => reftoken.RefToken == __token_0))'
2022-09-21 10:59:48.672 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<bool>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            EmptyProjectionMember -> 0
        SELECT EXISTS (
            SELECT 1
            FROM users AS u
            WHERE EXISTS (
                SELECT 1
                FROM refresh_token AS r
                WHERE ((u.id != NULL) && (u.id == r.user_id)) && (r.token == @__token_0)))), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, bool>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)
    .Single()'
2022-09-21 10:59:48.688 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-21 10:59:48.689 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2022-09-21 10:59:48.692 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-21 10:59:48.694 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 10:59:48.695 +01:00 [DBG] Executing DbCommand [Parameters=[@__token_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM users AS u
    WHERE EXISTS (
        SELECT 1
        FROM refresh_token AS r
        WHERE (u.id = r.user_id) AND (r.token = @__token_0)))
2022-09-21 10:59:48.699 +01:00 [INF] Executed DbCommand (4ms) [Parameters=[@__token_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM users AS u
    WHERE EXISTS (
        SELECT 1
        FROM refresh_token AS r
        WHERE (u.id = r.user_id) AND (r.token = @__token_0)))
2022-09-21 10:59:48.705 +01:00 [DBG] A data reader was disposed.
2022-09-21 10:59:48.706 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 10:59:48.708 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-21 10:59:48.729 +01:00 [DBG] Compiling query expression: 
'DbSet<RefreshToken>()
    .Where(rt => rt.UserId == __id_0)
    .AsNoTracking()
    .Select(rt => new RefreshToken{ 
        Id = rt.Id, 
        UserId = rt.UserId, 
        RefToken = rt.RefToken, 
        Expires = rt.Expires, 
        Created = rt.Created, 
        CreatedByIp = rt.CreatedByIp, 
        Revoked = rt.Revoked, 
        RevokedByIp = rt.RevokedByIp, 
        ReplacedByToken = rt.ReplacedByToken, 
        ReasonRevoked = rt.ReasonRevoked, 
        IsExpired = rt.IsExpired, 
        IsRevoked = rt.IsRevoked, 
        IsActive = rt.IsActive 
    }
    )'
2022-09-21 10:59:48.765 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<RefreshToken>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            Id -> 0
            UserId -> 1
            RefToken -> 2
            Expires -> 3
            Created -> 4
            CreatedByIp -> 5
            Revoked -> 6
            RevokedByIp -> 7
            ReplacedByToken -> 8
            ReasonRevoked -> 9
            IsExpired -> 10
            IsRevoked -> 11
            IsActive -> 12
        SELECT r.id AS Id, r.user_id AS UserId, r.token AS RefToken, r.expires AS Expires, r.created AS Created, r.created_by_ip AS CreatedByIp, r.revoked AS Revoked, r.revoked_by_ip AS RevokedByIp, r.replaced_by_token AS ReplacedByToken, r.reason_revoked AS ReasonRevoked, r.is_expired AS IsExpired, r.is_revoked AS IsRevoked, r.is_active AS IsActive
        FROM refresh_token AS r
        WHERE r.user_id == @__id_0), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, RefreshToken>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)'
2022-09-21 10:59:48.770 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-21 10:59:48.771 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2022-09-21 10:59:48.772 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-21 10:59:48.772 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 10:59:48.775 +01:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.user_id AS "UserId", r.token AS "RefToken", r.expires AS "Expires", r.created AS "Created", r.created_by_ip AS "CreatedByIp", r.revoked AS "Revoked", r.revoked_by_ip AS "RevokedByIp", r.replaced_by_token AS "ReplacedByToken", r.reason_revoked AS "ReasonRevoked", r.is_expired AS "IsExpired", r.is_revoked AS "IsRevoked", r.is_active AS "IsActive"
FROM refresh_token AS r
WHERE r.user_id = @__id_0
2022-09-21 10:59:48.786 +01:00 [INF] Executed DbCommand (12ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.user_id AS "UserId", r.token AS "RefToken", r.expires AS "Expires", r.created AS "Created", r.created_by_ip AS "CreatedByIp", r.revoked AS "Revoked", r.revoked_by_ip AS "RevokedByIp", r.replaced_by_token AS "ReplacedByToken", r.reason_revoked AS "ReasonRevoked", r.is_expired AS "IsExpired", r.is_revoked AS "IsRevoked", r.is_active AS "IsActive"
FROM refresh_token AS r
WHERE r.user_id = @__id_0
2022-09-21 10:59:48.789 +01:00 [DBG] A data reader was disposed.
2022-09-21 10:59:48.790 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 10:59:48.792 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-21 10:59:48.817 +01:00 [DBG] An entity of type 'User' tracked by 'PostgresContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 10:59:48.868 +01:00 [DBG] 'PostgresContext' generated a temporary value for the property 'Id.RefreshToken'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 10:59:48.948 +01:00 [DBG] Context 'PostgresContext' started tracking 'RefreshToken' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 10:59:48.960 +01:00 [DBG] SaveChanges starting for 'PostgresContext'.
2022-09-21 10:59:48.965 +01:00 [DBG] DetectChanges starting for 'PostgresContext'.
2022-09-21 10:59:49.003 +01:00 [DBG] 1 entities were added and 0 entities were removed from navigation 'User.RefreshTokenCollection'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 10:59:49.033 +01:00 [DBG] The foreign key property 'RefreshToken.UserId' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2022-09-21 10:59:49.062 +01:00 [DBG] DetectChanges completed for 'PostgresContext'.
2022-09-21 10:59:49.079 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-21 10:59:49.080 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 10:59:49.090 +01:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2022-09-21 10:59:49.111 +01:00 [DBG] Began transaction with isolation level 'ReadCommitted'.
2022-09-21 10:59:49.205 +01:00 [DBG] Executing 2 update commands as a batch.
2022-09-21 10:59:49.231 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-21 10:59:49.233 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (2ms).
2022-09-21 10:59:49.237 +01:00 [DBG] Executing DbCommand [Parameters=[@p0='?' (DbType = DateTime), @p1='?', @p2='?' (DbType = DateTime), @p3='?' (DbType = Boolean), @p4='?' (DbType = Boolean), @p5='?' (DbType = Boolean), @p6='?', @p7='?', @p8='?', @p9='?' (DbType = DateTime), @p10='?', @p11='?' (DbType = Int32), @p18='?' (DbType = Int32), @p12='?' (DbType = DateTime), @p13='?', @p14='?', @p15='?' (DbType = DateTime), @p16='?', @p17='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO refresh_token (created, created_by_ip, expires, is_active, is_expired, is_revoked, reason_revoked, token, replaced_by_token, revoked, revoked_by_ip, user_id)
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11)
RETURNING id;
UPDATE users SET created_at = @p12, email = @p13, full_name = @p14, password_changed_at = @p15, password_hash = @p16, username = @p17
WHERE id = @p18;
2022-09-21 10:59:49.267 +01:00 [INF] Executed DbCommand (30ms) [Parameters=[@p0='?' (DbType = DateTime), @p1='?', @p2='?' (DbType = DateTime), @p3='?' (DbType = Boolean), @p4='?' (DbType = Boolean), @p5='?' (DbType = Boolean), @p6='?', @p7='?', @p8='?', @p9='?' (DbType = DateTime), @p10='?', @p11='?' (DbType = Int32), @p18='?' (DbType = Int32), @p12='?' (DbType = DateTime), @p13='?', @p14='?', @p15='?' (DbType = DateTime), @p16='?', @p17='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO refresh_token (created, created_by_ip, expires, is_active, is_expired, is_revoked, reason_revoked, token, replaced_by_token, revoked, revoked_by_ip, user_id)
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11)
RETURNING id;
UPDATE users SET created_at = @p12, email = @p13, full_name = @p14, password_changed_at = @p15, password_hash = @p16, username = @p17
WHERE id = @p18;
2022-09-21 10:59:49.304 +01:00 [DBG] The foreign key property 'RefreshToken.Id' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2022-09-21 10:59:49.311 +01:00 [DBG] A data reader was disposed.
2022-09-21 10:59:49.322 +01:00 [DBG] Committing transaction.
2022-09-21 10:59:49.344 +01:00 [DBG] Committed transaction.
2022-09-21 10:59:49.349 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 10:59:49.352 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-21 10:59:49.356 +01:00 [DBG] Disposing transaction.
2022-09-21 10:59:49.361 +01:00 [DBG] An entity of type 'RefreshToken' tracked by 'PostgresContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 10:59:49.364 +01:00 [DBG] An entity of type 'User' tracked by 'PostgresContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 10:59:49.367 +01:00 [DBG] SaveChanges completed for 'PostgresContext' with 2 entities written to the database.
2022-09-21 10:59:49.376 +01:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2022-09-21 10:59:49.382 +01:00 [DBG] Attempting to select an output formatter based on Accept header '["text/plain"]'.
2022-09-21 10:59:49.384 +01:00 [DBG] Could not find an output formatter based on content negotiation. Accepted types were (["text/plain"])
2022-09-21 10:59:49.385 +01:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2022-09-21 10:59:49.386 +01:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2022-09-21 10:59:49.388 +01:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2022-09-21 10:59:49.390 +01:00 [INF] Executing OkObjectResult, writing value of type 'APIBank.Models.Users.Responses.LoginResponse'.
2022-09-21 10:59:49.410 +01:00 [INF] Executed action APIBank.Controllers.UsersController.Login (APIBank) in 4646.1266ms
2022-09-21 10:59:49.411 +01:00 [INF] Executed endpoint 'APIBank.Controllers.UsersController.Login (APIBank)'
2022-09-21 10:59:49.416 +01:00 [DBG] 'PostgresContext' disposed.
2022-09-21 10:59:49.428 +01:00 [INF] Request finished HTTP/2 POST https://localhost:7036/api/Users/Login application/json 58 - 200 - application/json;+charset=utf-8 5288.1072ms
2022-09-21 11:00:13.283 +01:00 [INF] Request starting HTTP/2 POST https://localhost:7036/api/Transfers/TransferRequest application/json 76
2022-09-21 11:00:13.287 +01:00 [DBG] 1 candidate(s) found for the request path '/api/Transfers/TransferRequest'
2022-09-21 11:00:13.290 +01:00 [DBG] Endpoint 'APIBank.Controllers.TransfersController.Create (APIBank)' with route pattern 'api/Transfers/TransferRequest' is valid for the request path '/api/Transfers/TransferRequest'
2022-09-21 11:00:13.292 +01:00 [DBG] Request matched endpoint 'APIBank.Controllers.TransfersController.Create (APIBank)'
2022-09-21 11:00:13.293 +01:00 [DBG] Static files was skipped as the request already matched an endpoint.
2022-09-21 11:00:13.311 +01:00 [INF] Executing endpoint 'APIBank.Controllers.TransfersController.Create (APIBank)'
2022-09-21 11:00:13.315 +01:00 [INF] Route matched with {action = "Create", controller = "Transfers"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult Create(APIBank.Models.Transfers.Requests.TransferRequest) on controller APIBank.Controllers.TransfersController (APIBank).
2022-09-21 11:00:13.317 +01:00 [DBG] Execution plan of authorization filters (in the following order): ["APIBank.Authorization.AuthorizeAttribute"]
2022-09-21 11:00:13.319 +01:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2022-09-21 11:00:13.326 +01:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2022-09-21 11:00:13.329 +01:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2022-09-21 11:00:13.330 +01:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2022-09-21 11:00:13.332 +01:00 [INF] Authorization failed for the request at filter 'APIBank.Authorization.AuthorizeAttribute'.
2022-09-21 11:00:13.338 +01:00 [INF] Executing JsonResult, writing value of type '<>f__AnonymousType0`1[[System.String, System.Private.CoreLib, Version=6.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2022-09-21 11:00:13.342 +01:00 [INF] Executed action APIBank.Controllers.TransfersController.Create (APIBank) in 9.8885ms
2022-09-21 11:00:13.343 +01:00 [INF] Executed endpoint 'APIBank.Controllers.TransfersController.Create (APIBank)'
2022-09-21 11:00:13.344 +01:00 [INF] Request finished HTTP/2 POST https://localhost:7036/api/Transfers/TransferRequest application/json 76 - 401 - application/json;+charset=utf-8 60.8001ms
2022-09-21 11:00:13.347 +01:00 [DBG] Connection id "0HMKRMVSOIHJR", Request id "0HMKRMVSOIHJR:0000000B": started reading request body.
2022-09-21 11:00:13.348 +01:00 [DBG] Connection id "0HMKRMVSOIHJR", Request id "0HMKRMVSOIHJR:0000000B": done reading request body.
2022-09-21 11:00:30.570 +01:00 [INF] Request starting HTTP/2 POST https://localhost:7036/api/Transfers/TransferRequest application/json 76
2022-09-21 11:00:30.573 +01:00 [DBG] 1 candidate(s) found for the request path '/api/Transfers/TransferRequest'
2022-09-21 11:00:30.575 +01:00 [DBG] Endpoint 'APIBank.Controllers.TransfersController.Create (APIBank)' with route pattern 'api/Transfers/TransferRequest' is valid for the request path '/api/Transfers/TransferRequest'
2022-09-21 11:00:30.580 +01:00 [DBG] Request matched endpoint 'APIBank.Controllers.TransfersController.Create (APIBank)'
2022-09-21 11:00:30.581 +01:00 [DBG] Static files was skipped as the request already matched an endpoint.
2022-09-21 11:00:30.748 +01:00 [INF] Entity Framework Core 6.0.9 initialized 'PostgresContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:6.0.7+5b98e4b74de93b590b44aef8dd7967c03acc433c' with options: None
2022-09-21 11:00:30.764 +01:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .FirstOrDefault(e => EF.Property<int>(e, "Id") == __p_0)'
2022-09-21 11:00:30.770 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<User>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: User.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: User.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 1], [Property: User.Email (string) Required Index MaxLength(254), 2], [Property: User.FullName (string) Required MaxLength(100), 3], [Property: User.PasswordChangedAt (DateTime) Required ValueGenerated.OnAdd, 4], [Property: User.PasswordHash (string) Required MaxLength(200), 5], [Property: User.Username (string) Required Index MaxLength(50), 6] }
        SELECT TOP(1) u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
        FROM users AS u
        WHERE u.id == @__p_0), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, User>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)
    .SingleOrDefault()'
2022-09-21 11:00:30.773 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-21 11:00:30.776 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (2ms).
2022-09-21 11:00:30.777 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-21 11:00:30.779 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 11:00:30.780 +01:00 [DBG] Executing DbCommand [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.id = @__p_0
LIMIT 1
2022-09-21 11:00:30.782 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.id = @__p_0
LIMIT 1
2022-09-21 11:00:30.784 +01:00 [DBG] Context 'PostgresContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 11:00:30.785 +01:00 [DBG] A data reader was disposed.
2022-09-21 11:00:30.786 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 11:00:30.786 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-21 11:00:30.788 +01:00 [INF] Executing endpoint 'APIBank.Controllers.TransfersController.Create (APIBank)'
2022-09-21 11:00:30.791 +01:00 [INF] Route matched with {action = "Create", controller = "Transfers"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult Create(APIBank.Models.Transfers.Requests.TransferRequest) on controller APIBank.Controllers.TransfersController (APIBank).
2022-09-21 11:00:30.794 +01:00 [DBG] Execution plan of authorization filters (in the following order): ["APIBank.Authorization.AuthorizeAttribute"]
2022-09-21 11:00:30.796 +01:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2022-09-21 11:00:30.798 +01:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2022-09-21 11:00:30.799 +01:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2022-09-21 11:00:30.800 +01:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2022-09-21 11:00:30.801 +01:00 [DBG] Executing controller factory for controller APIBank.Controllers.TransfersController (APIBank)
2022-09-21 11:00:30.803 +01:00 [DBG] Executed controller factory for controller APIBank.Controllers.TransfersController (APIBank)
2022-09-21 11:00:30.804 +01:00 [DBG] Attempting to bind parameter 'model' of type 'APIBank.Models.Transfers.Requests.TransferRequest' ...
2022-09-21 11:00:30.806 +01:00 [DBG] Attempting to bind parameter 'model' of type 'APIBank.Models.Transfers.Requests.TransferRequest' using the name '' in request data ...
2022-09-21 11:00:30.809 +01:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2022-09-21 11:00:30.814 +01:00 [DBG] Connection id "0HMKRMVSOIHJR", Request id "0HMKRMVSOIHJR:0000000D": started reading request body.
2022-09-21 11:00:30.815 +01:00 [DBG] Connection id "0HMKRMVSOIHJR", Request id "0HMKRMVSOIHJR:0000000D": done reading request body.
2022-09-21 11:00:30.821 +01:00 [DBG] JSON input formatter succeeded, deserializing to type 'APIBank.Models.Transfers.Requests.TransferRequest'
2022-09-21 11:00:30.823 +01:00 [DBG] Done attempting to bind parameter 'model' of type 'APIBank.Models.Transfers.Requests.TransferRequest'.
2022-09-21 11:00:30.827 +01:00 [DBG] Done attempting to bind parameter 'model' of type 'APIBank.Models.Transfers.Requests.TransferRequest'.
2022-09-21 11:00:30.829 +01:00 [DBG] Attempting to validate the bound parameter 'model' of type 'APIBank.Models.Transfers.Requests.TransferRequest' ...
2022-09-21 11:00:30.833 +01:00 [DBG] Done attempting to validate the bound parameter 'model' of type 'APIBank.Models.Transfers.Requests.TransferRequest'.
2022-09-21 11:00:30.848 +01:00 [DBG] Compiling query expression: 
'DbSet<Account>()
    .Include(a => a.Transactions)
    .Where(a => a.Id == __accountId_0 && a.UserId == __userId_1)
    .Select(a => new AccountMovims{ 
        Account = new AccountRe{ 
            Balance = a.Balance, 
            Currency = a.Currency, 
            CreatedAt = a.CreatedAt, 
            Id = a.Id 
        }
        , 
        Movims = a.Transactions
            .Select(b => new Movim{ 
                Amount = b.Amount, 
                CreatedAt = b.CreatedAt 
            }
            )
            .ToArray() 
    }
    )
    .SingleOrDefault()'
2022-09-21 11:00:31.003 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<AccountMovims>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Client Projections:
            0 -> 0
            1 -> 1
            2 -> 2
            3 -> 3
            4 -> 4
            5 -> 5
            6 -> 6
        SELECT t.balance, t.currency, t.created_at, t.id, t0.amount, t0.created_at, t0.id
        FROM 
        (
            SELECT TOP(2) a.balance, a.currency, a.created_at, a.id
            FROM accounts AS a
            WHERE (a.id == @__accountId_0) && (a.user_id == @__userId_1)
        ) AS t
        LEFT JOIN transactions AS t0 ON t.id == t0.account_id
        ORDER BY t.id ASC), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, AccountMovims>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)
    .SingleOrDefault()'
2022-09-21 11:00:31.011 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-21 11:00:31.012 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2022-09-21 11:00:31.013 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-21 11:00:31.013 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 11:00:31.014 +01:00 [DBG] Executing DbCommand [Parameters=[@__accountId_0='?' (DbType = Int32), @__userId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT t.balance, t.currency, t.created_at, t.id, t0.amount, t0.created_at, t0.id
FROM (
    SELECT a.balance, a.currency, a.created_at, a.id
    FROM accounts AS a
    WHERE (a.id = @__accountId_0) AND (a.user_id = @__userId_1)
    LIMIT 2
) AS t
LEFT JOIN transactions AS t0 ON t.id = t0.account_id
ORDER BY t.id
2022-09-21 11:00:31.017 +01:00 [INF] Executed DbCommand (3ms) [Parameters=[@__accountId_0='?' (DbType = Int32), @__userId_1='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT t.balance, t.currency, t.created_at, t.id, t0.amount, t0.created_at, t0.id
FROM (
    SELECT a.balance, a.currency, a.created_at, a.id
    FROM accounts AS a
    WHERE (a.id = @__accountId_0) AND (a.user_id = @__userId_1)
    LIMIT 2
) AS t
LEFT JOIN transactions AS t0 ON t.id = t0.account_id
ORDER BY t.id
2022-09-21 11:00:31.019 +01:00 [DBG] A data reader was disposed.
2022-09-21 11:00:31.020 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 11:00:31.021 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-21 11:00:38.584 +01:00 [INF] Executed action APIBank.Controllers.TransfersController.Create (APIBank) in 7782.4233ms
2022-09-21 11:00:38.588 +01:00 [INF] Executed endpoint 'APIBank.Controllers.TransfersController.Create (APIBank)'
2022-09-21 11:00:38.622 +01:00 [INF] Global Error was found:
2022-09-21 11:00:38.624 +01:00 [DBG] 'PostgresContext' disposed.
2022-09-21 11:00:38.625 +01:00 [INF] Request finished HTTP/2 POST https://localhost:7036/api/Transfers/TransferRequest application/json 76 - 400 - application/json 8054.1728ms
2022-09-21 11:02:53.216 +01:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2022-09-21 11:02:53.633 +01:00 [DBG] Hosting starting
2022-09-21 11:02:53.940 +01:00 [DBG] Using development certificate: CN=localhost (Thumbprint: 9CC642E9838495A6C3C202DECA6A8AD300396DD2)
2022-09-21 11:02:54.008 +01:00 [INF] Now listening on: https://localhost:7036
2022-09-21 11:02:54.010 +01:00 [INF] Now listening on: http://localhost:5036
2022-09-21 11:02:54.010 +01:00 [DBG] Loaded hosting startup assembly APIBank
2022-09-21 11:02:54.011 +01:00 [DBG] Loaded hosting startup assembly Microsoft.AspNetCore.Watch.BrowserRefresh
2022-09-21 11:02:54.012 +01:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.BrowserLink.Net
2022-09-21 11:02:54.013 +01:00 [INF] Application started. Press Ctrl+C to shut down.
2022-09-21 11:02:54.014 +01:00 [INF] Hosting environment: Development
2022-09-21 11:02:54.014 +01:00 [INF] Content root path: C:\Users\mguedesa\OneDrive - NTT DATA EMEAL\Documentos\GitHub\OpenBankAPI-NTT\APIBank\APIBank\
2022-09-21 11:02:54.015 +01:00 [DBG] Hosting started
2022-09-21 11:02:54.500 +01:00 [DBG] Connection id "0HMKRN1PSB2AC" received FIN.
2022-09-21 11:02:54.500 +01:00 [DBG] Connection id "0HMKRN1PSB2AB" received FIN.
2022-09-21 11:02:54.500 +01:00 [DBG] Connection id "0HMKRN1PSB2AB" accepted.
2022-09-21 11:02:54.500 +01:00 [DBG] Connection id "0HMKRN1PSB2AC" accepted.
2022-09-21 11:02:54.504 +01:00 [DBG] Connection id "0HMKRN1PSB2AB" started.
2022-09-21 11:02:54.504 +01:00 [DBG] Connection id "0HMKRN1PSB2AC" started.
2022-09-21 11:02:54.522 +01:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException:  Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveBlobAsync[TIOAdapter](TIOAdapter adapter)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](TIOAdapter adapter, Boolean receiveFirst, Byte[] reAuthenticationData, Boolean isApm)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2022-09-21 11:02:54.522 +01:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException:  Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveBlobAsync[TIOAdapter](TIOAdapter adapter)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](TIOAdapter adapter, Boolean receiveFirst, Byte[] reAuthenticationData, Boolean isApm)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2022-09-21 11:02:54.590 +01:00 [DBG] Connection id "0HMKRN1PSB2AB" stopped.
2022-09-21 11:02:54.590 +01:00 [DBG] Connection id "0HMKRN1PSB2AC" stopped.
2022-09-21 11:02:54.603 +01:00 [DBG] Connection id "0HMKRN1PSB2AC" sending FIN because: "The Socket transport's send loop completed gracefully."
2022-09-21 11:02:54.603 +01:00 [DBG] Connection id "0HMKRN1PSB2AB" sending FIN because: "The Socket transport's send loop completed gracefully."
2022-09-21 11:02:54.686 +01:00 [DBG] Connection id "0HMKRN1PSB2AD" accepted.
2022-09-21 11:02:54.688 +01:00 [DBG] Connection id "0HMKRN1PSB2AD" started.
2022-09-21 11:02:54.753 +01:00 [DBG] Connection 0HMKRN1PSB2AD established using the following protocol: "Tls12"
2022-09-21 11:02:54.876 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/swagger/index.html - -
2022-09-21 11:02:54.981 +01:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2022-09-21 11:02:55.075 +01:00 [DBG] No candidates found for the request path '/swagger/index.html'
2022-09-21 11:02:55.084 +01:00 [DBG] Request did not match any endpoints
2022-09-21 11:02:55.229 +01:00 [DBG] Response markup is scheduled to include browser refresh script injection.
2022-09-21 11:02:55.393 +01:00 [DBG] Response markup was updated to include browser refresh script injection.
2022-09-21 11:02:55.402 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/swagger/index.html - - - 200 - text/html;charset=utf-8 530.9927ms
2022-09-21 11:02:55.425 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/_framework/aspnetcore-browser-refresh.js - -
2022-09-21 11:02:55.425 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/_vs/browserLink - -
2022-09-21 11:02:55.440 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/_framework/aspnetcore-browser-refresh.js - - - 200 11984 application/javascript;+charset=utf-8 14.1081ms
2022-09-21 11:02:55.454 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/_vs/browserLink - - - 200 - text/javascript;+charset=UTF-8 29.1269ms
2022-09-21 11:02:55.534 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/swagger/v1/swagger.json - -
2022-09-21 11:02:55.536 +01:00 [DBG] No candidates found for the request path '/swagger/v1/swagger.json'
2022-09-21 11:02:55.536 +01:00 [DBG] Request did not match any endpoints
2022-09-21 11:02:55.722 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/swagger/v1/swagger.json - - - 200 - application/json;charset=utf-8 187.7383ms
2022-09-21 11:34:32.392 +01:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2022-09-21 11:34:32.540 +01:00 [DBG] Hosting starting
2022-09-21 11:34:33.123 +01:00 [DBG] Using development certificate: CN=localhost (Thumbprint: 9CC642E9838495A6C3C202DECA6A8AD300396DD2)
2022-09-21 11:34:33.247 +01:00 [INF] Now listening on: https://localhost:7036
2022-09-21 11:34:33.249 +01:00 [INF] Now listening on: http://localhost:5036
2022-09-21 11:34:33.250 +01:00 [DBG] Loaded hosting startup assembly APIBank
2022-09-21 11:34:33.251 +01:00 [DBG] Loaded hosting startup assembly Microsoft.AspNetCore.Watch.BrowserRefresh
2022-09-21 11:34:33.252 +01:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.BrowserLink.Net
2022-09-21 11:34:33.253 +01:00 [INF] Application started. Press Ctrl+C to shut down.
2022-09-21 11:34:33.254 +01:00 [INF] Hosting environment: Development
2022-09-21 11:34:33.257 +01:00 [INF] Content root path: C:\Users\mguedesa\OneDrive - NTT DATA EMEAL\Documentos\GitHub\OpenBankAPI-NTT\APIBank\APIBank\
2022-09-21 11:34:33.259 +01:00 [DBG] Hosting started
2022-09-21 11:34:33.635 +01:00 [DBG] Connection id "0HMKRNJFRUCPU" received FIN.
2022-09-21 11:34:33.635 +01:00 [DBG] Connection id "0HMKRNJFRUCPT" received FIN.
2022-09-21 11:34:33.640 +01:00 [DBG] Connection id "0HMKRNJFRUCPU" accepted.
2022-09-21 11:34:33.640 +01:00 [DBG] Connection id "0HMKRNJFRUCPT" accepted.
2022-09-21 11:34:33.645 +01:00 [DBG] Connection id "0HMKRNJFRUCPU" started.
2022-09-21 11:34:33.646 +01:00 [DBG] Connection id "0HMKRNJFRUCPT" started.
2022-09-21 11:34:33.673 +01:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException:  Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveBlobAsync[TIOAdapter](TIOAdapter adapter)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](TIOAdapter adapter, Boolean receiveFirst, Byte[] reAuthenticationData, Boolean isApm)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2022-09-21 11:34:33.673 +01:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException:  Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveBlobAsync[TIOAdapter](TIOAdapter adapter)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](TIOAdapter adapter, Boolean receiveFirst, Byte[] reAuthenticationData, Boolean isApm)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2022-09-21 11:34:33.758 +01:00 [DBG] Connection id "0HMKRNJFRUCPU" stopped.
2022-09-21 11:34:33.758 +01:00 [DBG] Connection id "0HMKRNJFRUCPT" stopped.
2022-09-21 11:34:33.764 +01:00 [DBG] Connection id "0HMKRNJFRUCPU" sending FIN because: "The Socket transport's send loop completed gracefully."
2022-09-21 11:34:33.769 +01:00 [DBG] Connection id "0HMKRNJFRUCPT" sending FIN because: "The Socket transport's send loop completed gracefully."
2022-09-21 11:34:33.984 +01:00 [DBG] Connection id "0HMKRNJFRUCPV" accepted.
2022-09-21 11:34:34.003 +01:00 [DBG] Connection id "0HMKRNJFRUCPV" started.
2022-09-21 11:34:34.125 +01:00 [DBG] Connection 0HMKRNJFRUCPV established using the following protocol: "Tls12"
2022-09-21 11:34:34.240 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/swagger/index.html - -
2022-09-21 11:34:34.312 +01:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2022-09-21 11:34:34.352 +01:00 [DBG] No candidates found for the request path '/swagger/index.html'
2022-09-21 11:34:34.354 +01:00 [DBG] Request did not match any endpoints
2022-09-21 11:34:34.548 +01:00 [DBG] Response markup is scheduled to include browser refresh script injection.
2022-09-21 11:34:34.753 +01:00 [DBG] Response markup was updated to include browser refresh script injection.
2022-09-21 11:34:34.761 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/swagger/index.html - - - 200 - text/html;charset=utf-8 528.4878ms
2022-09-21 11:34:34.815 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/_vs/browserLink - -
2022-09-21 11:34:34.815 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/_framework/aspnetcore-browser-refresh.js - -
2022-09-21 11:34:34.828 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/_framework/aspnetcore-browser-refresh.js - - - 200 11984 application/javascript;+charset=utf-8 13.0165ms
2022-09-21 11:34:34.865 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/_vs/browserLink - - - 200 - text/javascript;+charset=UTF-8 50.0913ms
2022-09-21 11:34:34.955 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/swagger/v1/swagger.json - -
2022-09-21 11:34:34.958 +01:00 [DBG] No candidates found for the request path '/swagger/v1/swagger.json'
2022-09-21 11:34:34.961 +01:00 [DBG] Request did not match any endpoints
2022-09-21 11:34:35.194 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/swagger/v1/swagger.json - - - 200 - application/json;charset=utf-8 239.5882ms
2022-09-21 11:45:10.409 +01:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2022-09-21 11:45:10.537 +01:00 [DBG] Hosting starting
2022-09-21 11:45:11.000 +01:00 [DBG] Using development certificate: CN=localhost (Thumbprint: 9CC642E9838495A6C3C202DECA6A8AD300396DD2)
2022-09-21 11:45:11.158 +01:00 [INF] Now listening on: https://localhost:7036
2022-09-21 11:45:11.169 +01:00 [INF] Now listening on: http://localhost:5036
2022-09-21 11:45:11.170 +01:00 [DBG] Loaded hosting startup assembly APIBank
2022-09-21 11:45:11.172 +01:00 [DBG] Loaded hosting startup assembly Microsoft.AspNetCore.Watch.BrowserRefresh
2022-09-21 11:45:11.174 +01:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.BrowserLink.Net
2022-09-21 11:45:11.176 +01:00 [INF] Application started. Press Ctrl+C to shut down.
2022-09-21 11:45:11.177 +01:00 [INF] Hosting environment: Development
2022-09-21 11:45:11.179 +01:00 [INF] Content root path: C:\Users\mguedesa\OneDrive - NTT DATA EMEAL\Documentos\GitHub\OpenBankAPI-NTT\APIBank\APIBank\
2022-09-21 11:45:11.181 +01:00 [DBG] Hosting started
2022-09-21 11:45:11.572 +01:00 [DBG] Connection id "0HMKRNPDVP5AS" received FIN.
2022-09-21 11:45:11.572 +01:00 [DBG] Connection id "0HMKRNPDVP5AT" received FIN.
2022-09-21 11:45:11.582 +01:00 [DBG] Connection id "0HMKRNPDVP5AS" accepted.
2022-09-21 11:45:11.582 +01:00 [DBG] Connection id "0HMKRNPDVP5AT" accepted.
2022-09-21 11:45:11.585 +01:00 [DBG] Connection id "0HMKRNPDVP5AT" started.
2022-09-21 11:45:11.585 +01:00 [DBG] Connection id "0HMKRNPDVP5AS" started.
2022-09-21 11:45:11.609 +01:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException:  Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveBlobAsync[TIOAdapter](TIOAdapter adapter)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](TIOAdapter adapter, Boolean receiveFirst, Byte[] reAuthenticationData, Boolean isApm)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2022-09-21 11:45:11.609 +01:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException:  Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveBlobAsync[TIOAdapter](TIOAdapter adapter)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](TIOAdapter adapter, Boolean receiveFirst, Byte[] reAuthenticationData, Boolean isApm)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2022-09-21 11:45:11.679 +01:00 [DBG] Connection id "0HMKRNPDVP5AS" stopped.
2022-09-21 11:45:11.679 +01:00 [DBG] Connection id "0HMKRNPDVP5AT" stopped.
2022-09-21 11:45:11.686 +01:00 [DBG] Connection id "0HMKRNPDVP5AS" sending FIN because: "The Socket transport's send loop completed gracefully."
2022-09-21 11:45:11.686 +01:00 [DBG] Connection id "0HMKRNPDVP5AT" sending FIN because: "The Socket transport's send loop completed gracefully."
2022-09-21 11:45:11.865 +01:00 [DBG] Connection id "0HMKRNPDVP5AU" accepted.
2022-09-21 11:45:11.867 +01:00 [DBG] Connection id "0HMKRNPDVP5AU" started.
2022-09-21 11:45:11.988 +01:00 [DBG] Connection 0HMKRNPDVP5AU established using the following protocol: "Tls12"
2022-09-21 11:45:12.133 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/swagger/index.html - -
2022-09-21 11:45:12.205 +01:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2022-09-21 11:45:12.236 +01:00 [DBG] No candidates found for the request path '/swagger/index.html'
2022-09-21 11:45:12.237 +01:00 [DBG] Request did not match any endpoints
2022-09-21 11:45:12.361 +01:00 [DBG] Response markup is scheduled to include browser refresh script injection.
2022-09-21 11:45:12.526 +01:00 [DBG] Response markup was updated to include browser refresh script injection.
2022-09-21 11:45:12.535 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/swagger/index.html - - - 200 - text/html;charset=utf-8 408.2279ms
2022-09-21 11:45:12.561 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/_vs/browserLink - -
2022-09-21 11:45:12.561 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/_framework/aspnetcore-browser-refresh.js - -
2022-09-21 11:45:12.577 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/_framework/aspnetcore-browser-refresh.js - - - 200 11984 application/javascript;+charset=utf-8 15.3384ms
2022-09-21 11:45:12.590 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/_vs/browserLink - - - 200 - text/javascript;+charset=UTF-8 29.6933ms
2022-09-21 11:45:12.678 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/swagger/v1/swagger.json - -
2022-09-21 11:45:12.679 +01:00 [DBG] No candidates found for the request path '/swagger/v1/swagger.json'
2022-09-21 11:45:12.680 +01:00 [DBG] Request did not match any endpoints
2022-09-21 11:45:12.886 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/swagger/v1/swagger.json - - - 200 - application/json;charset=utf-8 208.7906ms
2022-09-21 11:45:27.648 +01:00 [INF] Request starting HTTP/2 POST https://localhost:7036/api/Users/Login application/json 58
2022-09-21 11:45:27.666 +01:00 [DBG] 1 candidate(s) found for the request path '/api/Users/Login'
2022-09-21 11:45:27.677 +01:00 [DBG] Endpoint 'APIBank.Controllers.UsersController.Login (APIBank)' with route pattern 'api/Users/Login' is valid for the request path '/api/Users/Login'
2022-09-21 11:45:27.682 +01:00 [DBG] Request matched endpoint 'APIBank.Controllers.UsersController.Login (APIBank)'
2022-09-21 11:45:27.685 +01:00 [DBG] Static files was skipped as the request already matched an endpoint.
2022-09-21 11:45:28.158 +01:00 [INF] Executing endpoint 'APIBank.Controllers.UsersController.Login (APIBank)'
2022-09-21 11:45:28.183 +01:00 [INF] Route matched with {action = "Login", controller = "Users"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult Login(APIBank.Models.Requests.LoginRequest) on controller APIBank.Controllers.UsersController (APIBank).
2022-09-21 11:45:28.188 +01:00 [DBG] Execution plan of authorization filters (in the following order): ["APIBank.Authorization.AuthorizeAttribute"]
2022-09-21 11:45:28.189 +01:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2022-09-21 11:45:28.192 +01:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2022-09-21 11:45:28.194 +01:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2022-09-21 11:45:28.195 +01:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2022-09-21 11:45:28.197 +01:00 [DBG] Executing controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-21 11:45:28.198 +01:00 [DBG] Executed controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-21 11:45:28.215 +01:00 [DBG] Attempting to bind parameter 'model' of type 'APIBank.Models.Requests.LoginRequest' ...
2022-09-21 11:45:28.219 +01:00 [DBG] Attempting to bind parameter 'model' of type 'APIBank.Models.Requests.LoginRequest' using the name '' in request data ...
2022-09-21 11:45:28.223 +01:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2022-09-21 11:45:28.229 +01:00 [DBG] Connection id "0HMKRNPDVP5AU", Request id "0HMKRNPDVP5AU:00000009": started reading request body.
2022-09-21 11:45:28.230 +01:00 [DBG] Connection id "0HMKRNPDVP5AU", Request id "0HMKRNPDVP5AU:00000009": done reading request body.
2022-09-21 11:45:28.239 +01:00 [DBG] JSON input formatter succeeded, deserializing to type 'APIBank.Models.Requests.LoginRequest'
2022-09-21 11:45:28.242 +01:00 [DBG] Done attempting to bind parameter 'model' of type 'APIBank.Models.Requests.LoginRequest'.
2022-09-21 11:45:28.243 +01:00 [DBG] Done attempting to bind parameter 'model' of type 'APIBank.Models.Requests.LoginRequest'.
2022-09-21 11:45:28.244 +01:00 [DBG] Attempting to validate the bound parameter 'model' of type 'APIBank.Models.Requests.LoginRequest' ...
2022-09-21 11:45:28.255 +01:00 [DBG] Done attempting to validate the bound parameter 'model' of type 'APIBank.Models.Requests.LoginRequest'.
2022-09-21 11:45:28.399 +01:00 [DBG] An additional 'IServiceProvider' was created for internal use by Entity Framework. An existing service provider was not used due to the following configuration changes: configuration changed for 'Core:ConfigureWarnings', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:UseAdminDatabase', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:SetPostgresVersion', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:UseRedshift', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:ReverseNullOrdering', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:RemoteCertificateValidationCallback', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:ProvideClientCertificatesCallback', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:ProvidePasswordCallback'.
2022-09-21 11:45:30.045 +01:00 [INF] Entity Framework Core 6.0.9 initialized 'PostgresContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:6.0.7+5b98e4b74de93b590b44aef8dd7967c03acc433c' with options: None
2022-09-21 11:45:30.146 +01:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .SingleOrDefault(x => x.Username == __model_Username_0)'
2022-09-21 11:45:30.726 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<User>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: User.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: User.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 1], [Property: User.Email (string) Required Index MaxLength(254), 2], [Property: User.FullName (string) Required MaxLength(100), 3], [Property: User.PasswordChangedAt (DateTime) Required ValueGenerated.OnAdd, 4], [Property: User.PasswordHash (string) Required MaxLength(200), 5], [Property: User.Username (string) Required Index MaxLength(50), 6] }
        SELECT TOP(2) u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
        FROM users AS u
        WHERE u.username == @__model_Username_0), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, User>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)
    .SingleOrDefault()'
2022-09-21 11:45:30.812 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-21 11:45:30.923 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (106ms).
2022-09-21 11:45:30.939 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-21 11:45:31.274 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 11:45:31.294 +01:00 [DBG] Executing DbCommand [Parameters=[@__model_Username_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.username = @__model_Username_0
LIMIT 2
2022-09-21 11:45:31.428 +01:00 [INF] Executed DbCommand (135ms) [Parameters=[@__model_Username_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.username = @__model_Username_0
LIMIT 2
2022-09-21 11:45:31.508 +01:00 [DBG] Context 'PostgresContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 11:45:31.607 +01:00 [DBG] A data reader was disposed.
2022-09-21 11:45:31.619 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 11:45:31.631 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-21 11:45:32.157 +01:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .Any(user => user.RefreshTokenCollection
        .Any(reftoken => reftoken.RefToken == __token_0))'
2022-09-21 11:45:32.327 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<bool>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            EmptyProjectionMember -> 0
        SELECT EXISTS (
            SELECT 1
            FROM users AS u
            WHERE EXISTS (
                SELECT 1
                FROM refresh_token AS r
                WHERE ((u.id != NULL) && (u.id == r.user_id)) && (r.token == @__token_0)))), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, bool>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)
    .Single()'
2022-09-21 11:45:32.342 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-21 11:45:32.343 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2022-09-21 11:45:32.344 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-21 11:45:32.345 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 11:45:32.346 +01:00 [DBG] Executing DbCommand [Parameters=[@__token_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM users AS u
    WHERE EXISTS (
        SELECT 1
        FROM refresh_token AS r
        WHERE (u.id = r.user_id) AND (r.token = @__token_0)))
2022-09-21 11:45:32.352 +01:00 [INF] Executed DbCommand (6ms) [Parameters=[@__token_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM users AS u
    WHERE EXISTS (
        SELECT 1
        FROM refresh_token AS r
        WHERE (u.id = r.user_id) AND (r.token = @__token_0)))
2022-09-21 11:45:32.357 +01:00 [DBG] A data reader was disposed.
2022-09-21 11:45:32.357 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 11:45:32.358 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-21 11:45:32.372 +01:00 [DBG] Compiling query expression: 
'DbSet<RefreshToken>()
    .Where(rt => rt.UserId == __id_0)
    .AsNoTracking()
    .Select(rt => new RefreshToken{ 
        Id = rt.Id, 
        UserId = rt.UserId, 
        RefToken = rt.RefToken, 
        Expires = rt.Expires, 
        Created = rt.Created, 
        CreatedByIp = rt.CreatedByIp, 
        Revoked = rt.Revoked, 
        RevokedByIp = rt.RevokedByIp, 
        ReplacedByToken = rt.ReplacedByToken, 
        ReasonRevoked = rt.ReasonRevoked, 
        IsExpired = rt.IsExpired, 
        IsRevoked = rt.IsRevoked, 
        IsActive = rt.IsActive 
    }
    )'
2022-09-21 11:45:32.393 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<RefreshToken>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            Id -> 0
            UserId -> 1
            RefToken -> 2
            Expires -> 3
            Created -> 4
            CreatedByIp -> 5
            Revoked -> 6
            RevokedByIp -> 7
            ReplacedByToken -> 8
            ReasonRevoked -> 9
            IsExpired -> 10
            IsRevoked -> 11
            IsActive -> 12
        SELECT r.id AS Id, r.user_id AS UserId, r.token AS RefToken, r.expires AS Expires, r.created AS Created, r.created_by_ip AS CreatedByIp, r.revoked AS Revoked, r.revoked_by_ip AS RevokedByIp, r.replaced_by_token AS ReplacedByToken, r.reason_revoked AS ReasonRevoked, r.is_expired AS IsExpired, r.is_revoked AS IsRevoked, r.is_active AS IsActive
        FROM refresh_token AS r
        WHERE r.user_id == @__id_0), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, RefreshToken>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)'
2022-09-21 11:45:32.395 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-21 11:45:32.397 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (2ms).
2022-09-21 11:45:32.400 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-21 11:45:32.400 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 11:45:32.401 +01:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.user_id AS "UserId", r.token AS "RefToken", r.expires AS "Expires", r.created AS "Created", r.created_by_ip AS "CreatedByIp", r.revoked AS "Revoked", r.revoked_by_ip AS "RevokedByIp", r.replaced_by_token AS "ReplacedByToken", r.reason_revoked AS "ReasonRevoked", r.is_expired AS "IsExpired", r.is_revoked AS "IsRevoked", r.is_active AS "IsActive"
FROM refresh_token AS r
WHERE r.user_id = @__id_0
2022-09-21 11:45:32.408 +01:00 [INF] Executed DbCommand (7ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.user_id AS "UserId", r.token AS "RefToken", r.expires AS "Expires", r.created AS "Created", r.created_by_ip AS "CreatedByIp", r.revoked AS "Revoked", r.revoked_by_ip AS "RevokedByIp", r.replaced_by_token AS "ReplacedByToken", r.reason_revoked AS "ReasonRevoked", r.is_expired AS "IsExpired", r.is_revoked AS "IsRevoked", r.is_active AS "IsActive"
FROM refresh_token AS r
WHERE r.user_id = @__id_0
2022-09-21 11:45:32.410 +01:00 [DBG] A data reader was disposed.
2022-09-21 11:45:32.410 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 11:45:32.411 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-21 11:45:32.431 +01:00 [DBG] An entity of type 'User' tracked by 'PostgresContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 11:45:32.471 +01:00 [DBG] 'PostgresContext' generated a temporary value for the property 'Id.RefreshToken'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 11:45:32.510 +01:00 [DBG] Context 'PostgresContext' started tracking 'RefreshToken' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 11:45:32.518 +01:00 [DBG] SaveChanges starting for 'PostgresContext'.
2022-09-21 11:45:32.523 +01:00 [DBG] DetectChanges starting for 'PostgresContext'.
2022-09-21 11:45:32.562 +01:00 [DBG] 1 entities were added and 0 entities were removed from navigation 'User.RefreshTokenCollection'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 11:45:32.601 +01:00 [DBG] The foreign key property 'RefreshToken.UserId' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2022-09-21 11:45:32.637 +01:00 [DBG] DetectChanges completed for 'PostgresContext'.
2022-09-21 11:45:32.655 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-21 11:45:32.658 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 11:45:32.663 +01:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2022-09-21 11:45:32.676 +01:00 [DBG] Began transaction with isolation level 'ReadCommitted'.
2022-09-21 11:45:32.770 +01:00 [DBG] Executing 2 update commands as a batch.
2022-09-21 11:45:32.794 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-21 11:45:32.795 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2022-09-21 11:45:32.797 +01:00 [DBG] Executing DbCommand [Parameters=[@p0='?' (DbType = DateTime), @p1='?', @p2='?' (DbType = DateTime), @p3='?' (DbType = Boolean), @p4='?' (DbType = Boolean), @p5='?' (DbType = Boolean), @p6='?', @p7='?', @p8='?', @p9='?' (DbType = DateTime), @p10='?', @p11='?' (DbType = Int32), @p18='?' (DbType = Int32), @p12='?' (DbType = DateTime), @p13='?', @p14='?', @p15='?' (DbType = DateTime), @p16='?', @p17='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO refresh_token (created, created_by_ip, expires, is_active, is_expired, is_revoked, reason_revoked, token, replaced_by_token, revoked, revoked_by_ip, user_id)
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11)
RETURNING id;
UPDATE users SET created_at = @p12, email = @p13, full_name = @p14, password_changed_at = @p15, password_hash = @p16, username = @p17
WHERE id = @p18;
2022-09-21 11:45:32.817 +01:00 [INF] Executed DbCommand (20ms) [Parameters=[@p0='?' (DbType = DateTime), @p1='?', @p2='?' (DbType = DateTime), @p3='?' (DbType = Boolean), @p4='?' (DbType = Boolean), @p5='?' (DbType = Boolean), @p6='?', @p7='?', @p8='?', @p9='?' (DbType = DateTime), @p10='?', @p11='?' (DbType = Int32), @p18='?' (DbType = Int32), @p12='?' (DbType = DateTime), @p13='?', @p14='?', @p15='?' (DbType = DateTime), @p16='?', @p17='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO refresh_token (created, created_by_ip, expires, is_active, is_expired, is_revoked, reason_revoked, token, replaced_by_token, revoked, revoked_by_ip, user_id)
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11)
RETURNING id;
UPDATE users SET created_at = @p12, email = @p13, full_name = @p14, password_changed_at = @p15, password_hash = @p16, username = @p17
WHERE id = @p18;
2022-09-21 11:45:32.839 +01:00 [DBG] The foreign key property 'RefreshToken.Id' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2022-09-21 11:45:32.843 +01:00 [DBG] A data reader was disposed.
2022-09-21 11:45:32.848 +01:00 [DBG] Committing transaction.
2022-09-21 11:45:32.862 +01:00 [DBG] Committed transaction.
2022-09-21 11:45:32.864 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 11:45:32.867 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-21 11:45:32.873 +01:00 [DBG] Disposing transaction.
2022-09-21 11:45:32.876 +01:00 [DBG] An entity of type 'RefreshToken' tracked by 'PostgresContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 11:45:32.880 +01:00 [DBG] An entity of type 'User' tracked by 'PostgresContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 11:45:32.885 +01:00 [DBG] SaveChanges completed for 'PostgresContext' with 2 entities written to the database.
2022-09-21 11:45:32.891 +01:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2022-09-21 11:45:32.897 +01:00 [DBG] Attempting to select an output formatter based on Accept header '["text/plain"]'.
2022-09-21 11:45:32.899 +01:00 [DBG] Could not find an output formatter based on content negotiation. Accepted types were (["text/plain"])
2022-09-21 11:45:32.901 +01:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2022-09-21 11:45:32.903 +01:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2022-09-21 11:45:32.904 +01:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2022-09-21 11:45:32.905 +01:00 [INF] Executing OkObjectResult, writing value of type 'APIBank.Models.Users.Responses.LoginResponse'.
2022-09-21 11:45:32.928 +01:00 [INF] Executed action APIBank.Controllers.UsersController.Login (APIBank) in 4721.4552ms
2022-09-21 11:45:32.930 +01:00 [INF] Executed endpoint 'APIBank.Controllers.UsersController.Login (APIBank)'
2022-09-21 11:45:32.940 +01:00 [DBG] 'PostgresContext' disposed.
2022-09-21 11:45:32.950 +01:00 [INF] Request finished HTTP/2 POST https://localhost:7036/api/Users/Login application/json 58 - 200 - application/json;+charset=utf-8 5302.4902ms
2022-09-21 11:45:50.813 +01:00 [INF] Request starting HTTP/2 POST https://localhost:7036/api/Users/refreshToken - 0
2022-09-21 11:45:50.820 +01:00 [DBG] 1 candidate(s) found for the request path '/api/Users/refreshToken'
2022-09-21 11:45:50.821 +01:00 [DBG] Endpoint 'APIBank.Controllers.UsersController.RefreshToken (APIBank)' with route pattern 'api/Users/refreshToken' is valid for the request path '/api/Users/refreshToken'
2022-09-21 11:45:50.824 +01:00 [DBG] Request matched endpoint 'APIBank.Controllers.UsersController.RefreshToken (APIBank)'
2022-09-21 11:45:50.826 +01:00 [DBG] Static files was skipped as the request already matched an endpoint.
2022-09-21 11:45:50.963 +01:00 [INF] Entity Framework Core 6.0.9 initialized 'PostgresContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:6.0.7+5b98e4b74de93b590b44aef8dd7967c03acc433c' with options: None
2022-09-21 11:45:50.980 +01:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .FirstOrDefault(e => EF.Property<int>(e, "Id") == __p_0)'
2022-09-21 11:45:50.986 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<User>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: User.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: User.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 1], [Property: User.Email (string) Required Index MaxLength(254), 2], [Property: User.FullName (string) Required MaxLength(100), 3], [Property: User.PasswordChangedAt (DateTime) Required ValueGenerated.OnAdd, 4], [Property: User.PasswordHash (string) Required MaxLength(200), 5], [Property: User.Username (string) Required Index MaxLength(50), 6] }
        SELECT TOP(1) u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
        FROM users AS u
        WHERE u.id == @__p_0), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, User>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)
    .SingleOrDefault()'
2022-09-21 11:45:50.988 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-21 11:45:50.989 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2022-09-21 11:45:50.990 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-21 11:45:50.992 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 11:45:50.993 +01:00 [DBG] Executing DbCommand [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.id = @__p_0
LIMIT 1
2022-09-21 11:45:50.995 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.id = @__p_0
LIMIT 1
2022-09-21 11:45:50.997 +01:00 [DBG] Context 'PostgresContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 11:45:50.999 +01:00 [DBG] A data reader was disposed.
2022-09-21 11:45:51.000 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 11:45:51.001 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-21 11:45:51.002 +01:00 [INF] Executing endpoint 'APIBank.Controllers.UsersController.RefreshToken (APIBank)'
2022-09-21 11:45:51.004 +01:00 [INF] Route matched with {action = "RefreshToken", controller = "Users"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult RefreshToken() on controller APIBank.Controllers.UsersController (APIBank).
2022-09-21 11:45:51.005 +01:00 [DBG] Execution plan of authorization filters (in the following order): ["APIBank.Authorization.AuthorizeAttribute"]
2022-09-21 11:45:51.007 +01:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2022-09-21 11:45:51.008 +01:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2022-09-21 11:45:51.009 +01:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2022-09-21 11:45:51.010 +01:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2022-09-21 11:45:51.011 +01:00 [DBG] Executing controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-21 11:45:51.012 +01:00 [DBG] Executed controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-21 11:47:37.578 +01:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .SingleOrDefault(userQuery => userQuery.RefreshTokenCollection
        .Any(refTokenQuery => refTokenQuery.RefToken == __refToken_0))'
2022-09-21 11:47:37.584 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<User>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: User.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: User.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 1], [Property: User.Email (string) Required Index MaxLength(254), 2], [Property: User.FullName (string) Required MaxLength(100), 3], [Property: User.PasswordChangedAt (DateTime) Required ValueGenerated.OnAdd, 4], [Property: User.PasswordHash (string) Required MaxLength(200), 5], [Property: User.Username (string) Required Index MaxLength(50), 6] }
        SELECT TOP(2) u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
        FROM users AS u
        WHERE EXISTS (
            SELECT 1
            FROM refresh_token AS r
            WHERE ((u.id != NULL) && (u.id == r.user_id)) && (r.token == @__refToken_0))), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, User>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)
    .SingleOrDefault()'
2022-09-21 11:47:37.587 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-21 11:47:37.589 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2022-09-21 11:47:37.592 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-21 11:47:37.594 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 11:47:37.594 +01:00 [DBG] Executing DbCommand [Parameters=[@__refToken_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE EXISTS (
    SELECT 1
    FROM refresh_token AS r
    WHERE (u.id = r.user_id) AND (r.token = @__refToken_0))
LIMIT 2
2022-09-21 11:47:37.597 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[@__refToken_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE EXISTS (
    SELECT 1
    FROM refresh_token AS r
    WHERE (u.id = r.user_id) AND (r.token = @__refToken_0))
LIMIT 2
2022-09-21 11:47:37.599 +01:00 [DBG] A data reader was disposed.
2022-09-21 11:47:37.600 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 11:47:37.601 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-21 11:48:24.906 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-21 11:48:24.908 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (2ms).
2022-09-21 11:48:24.909 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-21 11:48:24.910 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 11:48:24.911 +01:00 [DBG] Executing DbCommand [Parameters=[@__token_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM users AS u
    WHERE EXISTS (
        SELECT 1
        FROM refresh_token AS r
        WHERE (u.id = r.user_id) AND (r.token = @__token_0)))
2022-09-21 11:48:24.912 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[@__token_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM users AS u
    WHERE EXISTS (
        SELECT 1
        FROM refresh_token AS r
        WHERE (u.id = r.user_id) AND (r.token = @__token_0)))
2022-09-21 11:48:24.916 +01:00 [DBG] A data reader was disposed.
2022-09-21 11:48:24.917 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 11:48:24.919 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-21 11:48:24.921 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-21 11:48:24.922 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2022-09-21 11:48:24.923 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-21 11:48:24.924 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 11:48:24.924 +01:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.user_id AS "UserId", r.token AS "RefToken", r.expires AS "Expires", r.created AS "Created", r.created_by_ip AS "CreatedByIp", r.revoked AS "Revoked", r.revoked_by_ip AS "RevokedByIp", r.replaced_by_token AS "ReplacedByToken", r.reason_revoked AS "ReasonRevoked", r.is_expired AS "IsExpired", r.is_revoked AS "IsRevoked", r.is_active AS "IsActive"
FROM refresh_token AS r
WHERE r.user_id = @__id_0
2022-09-21 11:48:24.926 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.user_id AS "UserId", r.token AS "RefToken", r.expires AS "Expires", r.created AS "Created", r.created_by_ip AS "CreatedByIp", r.revoked AS "Revoked", r.revoked_by_ip AS "RevokedByIp", r.replaced_by_token AS "ReplacedByToken", r.reason_revoked AS "ReasonRevoked", r.is_expired AS "IsExpired", r.is_revoked AS "IsRevoked", r.is_active AS "IsActive"
FROM refresh_token AS r
WHERE r.user_id = @__id_0
2022-09-21 11:48:24.928 +01:00 [DBG] A data reader was disposed.
2022-09-21 11:48:24.928 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 11:48:24.929 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-21 11:48:24.931 +01:00 [DBG] An entity of type 'User' tracked by 'PostgresContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 11:48:24.935 +01:00 [DBG] SaveChanges starting for 'PostgresContext'.
2022-09-21 11:48:24.936 +01:00 [DBG] DetectChanges starting for 'PostgresContext'.
2022-09-21 11:48:24.937 +01:00 [DBG] 1 entities were added and 0 entities were removed from navigation 'User.RefreshTokenCollection'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 11:48:24.939 +01:00 [DBG] 'PostgresContext' generated a temporary value for the property 'Id.RefreshToken'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 11:48:24.942 +01:00 [DBG] Context 'PostgresContext' started tracking 'RefreshToken' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 11:48:24.944 +01:00 [DBG] DetectChanges completed for 'PostgresContext'.
2022-09-21 11:48:24.945 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-21 11:48:24.946 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 11:48:24.949 +01:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2022-09-21 11:48:24.952 +01:00 [DBG] Began transaction with isolation level 'ReadCommitted'.
2022-09-21 11:48:24.954 +01:00 [DBG] Executing 2 update commands as a batch.
2022-09-21 11:48:24.955 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-21 11:48:24.955 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2022-09-21 11:48:24.956 +01:00 [DBG] Executing DbCommand [Parameters=[@p0='?' (DbType = DateTime), @p1='?', @p2='?' (DbType = DateTime), @p3='?' (DbType = Boolean), @p4='?' (DbType = Boolean), @p5='?' (DbType = Boolean), @p6='?', @p7='?', @p8='?', @p9='?' (DbType = DateTime), @p10='?', @p11='?' (DbType = Int32), @p18='?' (DbType = Int32), @p12='?' (DbType = DateTime), @p13='?', @p14='?', @p15='?' (DbType = DateTime), @p16='?', @p17='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO refresh_token (created, created_by_ip, expires, is_active, is_expired, is_revoked, reason_revoked, token, replaced_by_token, revoked, revoked_by_ip, user_id)
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11)
RETURNING id;
UPDATE users SET created_at = @p12, email = @p13, full_name = @p14, password_changed_at = @p15, password_hash = @p16, username = @p17
WHERE id = @p18;
2022-09-21 11:48:24.958 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[@p0='?' (DbType = DateTime), @p1='?', @p2='?' (DbType = DateTime), @p3='?' (DbType = Boolean), @p4='?' (DbType = Boolean), @p5='?' (DbType = Boolean), @p6='?', @p7='?', @p8='?', @p9='?' (DbType = DateTime), @p10='?', @p11='?' (DbType = Int32), @p18='?' (DbType = Int32), @p12='?' (DbType = DateTime), @p13='?', @p14='?', @p15='?' (DbType = DateTime), @p16='?', @p17='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO refresh_token (created, created_by_ip, expires, is_active, is_expired, is_revoked, reason_revoked, token, replaced_by_token, revoked, revoked_by_ip, user_id)
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11)
RETURNING id;
UPDATE users SET created_at = @p12, email = @p13, full_name = @p14, password_changed_at = @p15, password_hash = @p16, username = @p17
WHERE id = @p18;
2022-09-21 11:48:24.961 +01:00 [DBG] The foreign key property 'RefreshToken.Id' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2022-09-21 11:48:24.965 +01:00 [DBG] A data reader was disposed.
2022-09-21 11:48:24.966 +01:00 [DBG] Committing transaction.
2022-09-21 11:48:24.969 +01:00 [DBG] Committed transaction.
2022-09-21 11:48:24.970 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 11:48:24.971 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-21 11:48:24.972 +01:00 [DBG] Disposing transaction.
2022-09-21 11:48:24.973 +01:00 [DBG] An entity of type 'RefreshToken' tracked by 'PostgresContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 11:48:24.975 +01:00 [DBG] An entity of type 'User' tracked by 'PostgresContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 11:48:24.978 +01:00 [DBG] SaveChanges completed for 'PostgresContext' with 2 entities written to the database.
2022-09-21 11:48:24.983 +01:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2022-09-21 11:48:24.985 +01:00 [DBG] Attempting to select an output formatter based on Accept header '["text/plain"]'.
2022-09-21 11:48:24.987 +01:00 [DBG] Could not find an output formatter based on content negotiation. Accepted types were (["text/plain"])
2022-09-21 11:48:24.988 +01:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2022-09-21 11:48:24.989 +01:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2022-09-21 11:48:24.990 +01:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2022-09-21 11:48:24.991 +01:00 [INF] Executing OkObjectResult, writing value of type 'APIBank.Models.Users.Responses.LoginResponse'.
2022-09-21 11:48:24.992 +01:00 [INF] Executed action APIBank.Controllers.UsersController.RefreshToken (APIBank) in 153981.6361ms
2022-09-21 11:48:25.003 +01:00 [INF] Executed endpoint 'APIBank.Controllers.UsersController.RefreshToken (APIBank)'
2022-09-21 11:48:25.004 +01:00 [DBG] 'PostgresContext' disposed.
2022-09-21 11:48:25.005 +01:00 [INF] Request finished HTTP/2 POST https://localhost:7036/api/Users/refreshToken - 0 - 200 - application/json;+charset=utf-8 154192.0384ms
2022-09-21 11:48:44.932 +01:00 [INF] Request starting HTTP/2 POST https://localhost:7036/api/Users/refreshToken - 0
2022-09-21 11:48:44.936 +01:00 [DBG] 1 candidate(s) found for the request path '/api/Users/refreshToken'
2022-09-21 11:48:44.937 +01:00 [DBG] Endpoint 'APIBank.Controllers.UsersController.RefreshToken (APIBank)' with route pattern 'api/Users/refreshToken' is valid for the request path '/api/Users/refreshToken'
2022-09-21 11:48:44.938 +01:00 [DBG] Request matched endpoint 'APIBank.Controllers.UsersController.RefreshToken (APIBank)'
2022-09-21 11:48:44.939 +01:00 [DBG] Static files was skipped as the request already matched an endpoint.
2022-09-21 11:48:45.009 +01:00 [INF] Entity Framework Core 6.0.9 initialized 'PostgresContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:6.0.7+5b98e4b74de93b590b44aef8dd7967c03acc433c' with options: None
2022-09-21 11:48:45.014 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-21 11:48:45.015 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2022-09-21 11:48:45.016 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-21 11:48:45.017 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 11:48:45.018 +01:00 [DBG] Executing DbCommand [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.id = @__p_0
LIMIT 1
2022-09-21 11:48:45.019 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.id = @__p_0
LIMIT 1
2022-09-21 11:48:45.021 +01:00 [DBG] Context 'PostgresContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 11:48:45.022 +01:00 [DBG] A data reader was disposed.
2022-09-21 11:48:45.022 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 11:48:45.023 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-21 11:48:45.023 +01:00 [INF] Executing endpoint 'APIBank.Controllers.UsersController.RefreshToken (APIBank)'
2022-09-21 11:48:45.025 +01:00 [INF] Route matched with {action = "RefreshToken", controller = "Users"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult RefreshToken() on controller APIBank.Controllers.UsersController (APIBank).
2022-09-21 11:48:45.027 +01:00 [DBG] Execution plan of authorization filters (in the following order): ["APIBank.Authorization.AuthorizeAttribute"]
2022-09-21 11:48:45.028 +01:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2022-09-21 11:48:45.029 +01:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2022-09-21 11:48:45.031 +01:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2022-09-21 11:48:45.032 +01:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2022-09-21 11:48:45.033 +01:00 [DBG] Executing controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-21 11:48:45.034 +01:00 [DBG] Executed controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-21 11:49:19.155 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-21 11:49:19.158 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (2ms).
2022-09-21 11:49:19.159 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-21 11:49:19.160 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 11:49:19.161 +01:00 [DBG] Executing DbCommand [Parameters=[@__refToken_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE EXISTS (
    SELECT 1
    FROM refresh_token AS r
    WHERE (u.id = r.user_id) AND (r.token = @__refToken_0))
LIMIT 2
2022-09-21 11:49:19.164 +01:00 [INF] Executed DbCommand (3ms) [Parameters=[@__refToken_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE EXISTS (
    SELECT 1
    FROM refresh_token AS r
    WHERE (u.id = r.user_id) AND (r.token = @__refToken_0))
LIMIT 2
2022-09-21 11:49:19.168 +01:00 [DBG] A data reader was disposed.
2022-09-21 11:49:19.169 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 11:49:19.171 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-21 11:50:41.848 +01:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2022-09-21 11:50:42.013 +01:00 [DBG] Hosting starting
2022-09-21 11:50:42.261 +01:00 [DBG] Using development certificate: CN=localhost (Thumbprint: 9CC642E9838495A6C3C202DECA6A8AD300396DD2)
2022-09-21 11:50:42.388 +01:00 [INF] Now listening on: https://localhost:7036
2022-09-21 11:50:42.390 +01:00 [INF] Now listening on: http://localhost:5036
2022-09-21 11:50:42.391 +01:00 [DBG] Loaded hosting startup assembly APIBank
2022-09-21 11:50:42.392 +01:00 [DBG] Loaded hosting startup assembly Microsoft.AspNetCore.Watch.BrowserRefresh
2022-09-21 11:50:42.394 +01:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.BrowserLink.Net
2022-09-21 11:50:42.397 +01:00 [INF] Application started. Press Ctrl+C to shut down.
2022-09-21 11:50:42.398 +01:00 [INF] Hosting environment: Development
2022-09-21 11:50:42.399 +01:00 [INF] Content root path: C:\Users\mguedesa\OneDrive - NTT DATA EMEAL\Documentos\GitHub\OpenBankAPI-NTT\APIBank\APIBank\
2022-09-21 11:50:42.400 +01:00 [DBG] Hosting started
2022-09-21 11:50:42.702 +01:00 [DBG] Connection id "0HMKRNSGLLF88" accepted.
2022-09-21 11:50:42.702 +01:00 [DBG] Connection id "0HMKRNSGLLF89" accepted.
2022-09-21 11:50:42.706 +01:00 [DBG] Connection id "0HMKRNSGLLF88" started.
2022-09-21 11:50:42.706 +01:00 [DBG] Connection id "0HMKRNSGLLF89" started.
2022-09-21 11:50:42.715 +01:00 [DBG] Connection id "0HMKRNSGLLF88" received FIN.
2022-09-21 11:50:42.715 +01:00 [DBG] Connection id "0HMKRNSGLLF89" received FIN.
2022-09-21 11:50:42.725 +01:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException:  Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveBlobAsync[TIOAdapter](TIOAdapter adapter)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](TIOAdapter adapter, Boolean receiveFirst, Byte[] reAuthenticationData, Boolean isApm)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2022-09-21 11:50:42.725 +01:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException:  Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveBlobAsync[TIOAdapter](TIOAdapter adapter)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](TIOAdapter adapter, Boolean receiveFirst, Byte[] reAuthenticationData, Boolean isApm)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2022-09-21 11:50:42.768 +01:00 [DBG] Connection id "0HMKRNSGLLF89" stopped.
2022-09-21 11:50:42.768 +01:00 [DBG] Connection id "0HMKRNSGLLF88" stopped.
2022-09-21 11:50:42.771 +01:00 [DBG] Connection id "0HMKRNSGLLF89" sending FIN because: "The Socket transport's send loop completed gracefully."
2022-09-21 11:50:42.771 +01:00 [DBG] Connection id "0HMKRNSGLLF88" sending FIN because: "The Socket transport's send loop completed gracefully."
2022-09-21 11:50:42.928 +01:00 [DBG] Connection id "0HMKRNSGLLF8A" accepted.
2022-09-21 11:50:42.930 +01:00 [DBG] Connection id "0HMKRNSGLLF8A" started.
2022-09-21 11:50:42.998 +01:00 [DBG] Connection 0HMKRNSGLLF8A established using the following protocol: "Tls12"
2022-09-21 11:50:43.088 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/swagger/index.html - -
2022-09-21 11:50:43.133 +01:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2022-09-21 11:50:43.157 +01:00 [DBG] No candidates found for the request path '/swagger/index.html'
2022-09-21 11:50:43.158 +01:00 [DBG] Request did not match any endpoints
2022-09-21 11:50:43.260 +01:00 [DBG] Response markup is scheduled to include browser refresh script injection.
2022-09-21 11:50:43.428 +01:00 [DBG] Response markup was updated to include browser refresh script injection.
2022-09-21 11:50:43.437 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/swagger/index.html - - - 200 - text/html;charset=utf-8 351.2485ms
2022-09-21 11:50:43.456 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/_framework/aspnetcore-browser-refresh.js - -
2022-09-21 11:50:43.456 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/_vs/browserLink - -
2022-09-21 11:50:43.469 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/_framework/aspnetcore-browser-refresh.js - - - 200 11984 application/javascript;+charset=utf-8 13.5047ms
2022-09-21 11:50:43.482 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/_vs/browserLink - - - 200 - text/javascript;+charset=UTF-8 26.8219ms
2022-09-21 11:50:43.590 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/swagger/v1/swagger.json - -
2022-09-21 11:50:43.593 +01:00 [DBG] No candidates found for the request path '/swagger/v1/swagger.json'
2022-09-21 11:50:43.594 +01:00 [DBG] Request did not match any endpoints
2022-09-21 11:50:43.785 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/swagger/v1/swagger.json - - - 200 - application/json;charset=utf-8 195.7196ms
2022-09-21 11:51:00.082 +01:00 [INF] Request starting HTTP/2 POST https://localhost:7036/api/Users/Login application/json 58
2022-09-21 11:51:00.097 +01:00 [DBG] 1 candidate(s) found for the request path '/api/Users/Login'
2022-09-21 11:51:00.107 +01:00 [DBG] Endpoint 'APIBank.Controllers.UsersController.Login (APIBank)' with route pattern 'api/Users/Login' is valid for the request path '/api/Users/Login'
2022-09-21 11:51:00.116 +01:00 [DBG] Request matched endpoint 'APIBank.Controllers.UsersController.Login (APIBank)'
2022-09-21 11:51:00.123 +01:00 [DBG] Static files was skipped as the request already matched an endpoint.
2022-09-21 11:51:00.622 +01:00 [INF] Executing endpoint 'APIBank.Controllers.UsersController.Login (APIBank)'
2022-09-21 11:51:00.650 +01:00 [INF] Route matched with {action = "Login", controller = "Users"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult Login(APIBank.Models.Requests.LoginRequest) on controller APIBank.Controllers.UsersController (APIBank).
2022-09-21 11:51:00.654 +01:00 [DBG] Execution plan of authorization filters (in the following order): ["APIBank.Authorization.AuthorizeAttribute"]
2022-09-21 11:51:00.656 +01:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2022-09-21 11:51:00.658 +01:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2022-09-21 11:51:00.659 +01:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2022-09-21 11:51:00.660 +01:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2022-09-21 11:51:00.664 +01:00 [DBG] Executing controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-21 11:51:00.666 +01:00 [DBG] Executed controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-21 11:51:00.683 +01:00 [DBG] Attempting to bind parameter 'model' of type 'APIBank.Models.Requests.LoginRequest' ...
2022-09-21 11:51:00.686 +01:00 [DBG] Attempting to bind parameter 'model' of type 'APIBank.Models.Requests.LoginRequest' using the name '' in request data ...
2022-09-21 11:51:00.688 +01:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2022-09-21 11:51:00.694 +01:00 [DBG] Connection id "0HMKRNSGLLF8A", Request id "0HMKRNSGLLF8A:00000009": started reading request body.
2022-09-21 11:51:00.697 +01:00 [DBG] Connection id "0HMKRNSGLLF8A", Request id "0HMKRNSGLLF8A:00000009": done reading request body.
2022-09-21 11:51:00.704 +01:00 [DBG] JSON input formatter succeeded, deserializing to type 'APIBank.Models.Requests.LoginRequest'
2022-09-21 11:51:00.705 +01:00 [DBG] Done attempting to bind parameter 'model' of type 'APIBank.Models.Requests.LoginRequest'.
2022-09-21 11:51:00.706 +01:00 [DBG] Done attempting to bind parameter 'model' of type 'APIBank.Models.Requests.LoginRequest'.
2022-09-21 11:51:00.707 +01:00 [DBG] Attempting to validate the bound parameter 'model' of type 'APIBank.Models.Requests.LoginRequest' ...
2022-09-21 11:51:00.718 +01:00 [DBG] Done attempting to validate the bound parameter 'model' of type 'APIBank.Models.Requests.LoginRequest'.
2022-09-21 11:51:00.856 +01:00 [DBG] An additional 'IServiceProvider' was created for internal use by Entity Framework. An existing service provider was not used due to the following configuration changes: configuration changed for 'Core:ConfigureWarnings', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:UseAdminDatabase', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:SetPostgresVersion', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:UseRedshift', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:ReverseNullOrdering', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:RemoteCertificateValidationCallback', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:ProvideClientCertificatesCallback', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:ProvidePasswordCallback'.
2022-09-21 11:51:02.472 +01:00 [INF] Entity Framework Core 6.0.9 initialized 'PostgresContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:6.0.7+5b98e4b74de93b590b44aef8dd7967c03acc433c' with options: None
2022-09-21 11:51:02.592 +01:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .SingleOrDefault(x => x.Username == __model_Username_0)'
2022-09-21 11:51:03.162 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<User>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: User.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: User.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 1], [Property: User.Email (string) Required Index MaxLength(254), 2], [Property: User.FullName (string) Required MaxLength(100), 3], [Property: User.PasswordChangedAt (DateTime) Required ValueGenerated.OnAdd, 4], [Property: User.PasswordHash (string) Required MaxLength(200), 5], [Property: User.Username (string) Required Index MaxLength(50), 6] }
        SELECT TOP(2) u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
        FROM users AS u
        WHERE u.username == @__model_Username_0), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, User>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)
    .SingleOrDefault()'
2022-09-21 11:51:03.246 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-21 11:51:03.362 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (113ms).
2022-09-21 11:51:03.373 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-21 11:51:03.731 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 11:51:03.751 +01:00 [DBG] Executing DbCommand [Parameters=[@__model_Username_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.username = @__model_Username_0
LIMIT 2
2022-09-21 11:51:03.900 +01:00 [INF] Executed DbCommand (150ms) [Parameters=[@__model_Username_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.username = @__model_Username_0
LIMIT 2
2022-09-21 11:51:03.976 +01:00 [DBG] Context 'PostgresContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 11:51:04.031 +01:00 [DBG] A data reader was disposed.
2022-09-21 11:51:04.036 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 11:51:04.046 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-21 11:51:04.589 +01:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .Any(user => user.RefreshTokenCollection
        .Any(reftoken => reftoken.RefToken == __token_0))'
2022-09-21 11:51:04.736 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<bool>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            EmptyProjectionMember -> 0
        SELECT EXISTS (
            SELECT 1
            FROM users AS u
            WHERE EXISTS (
                SELECT 1
                FROM refresh_token AS r
                WHERE ((u.id != NULL) && (u.id == r.user_id)) && (r.token == @__token_0)))), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, bool>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)
    .Single()'
2022-09-21 11:51:04.753 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-21 11:51:04.755 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2022-09-21 11:51:04.756 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-21 11:51:04.761 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 11:51:04.762 +01:00 [DBG] Executing DbCommand [Parameters=[@__token_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM users AS u
    WHERE EXISTS (
        SELECT 1
        FROM refresh_token AS r
        WHERE (u.id = r.user_id) AND (r.token = @__token_0)))
2022-09-21 11:51:04.765 +01:00 [INF] Executed DbCommand (3ms) [Parameters=[@__token_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM users AS u
    WHERE EXISTS (
        SELECT 1
        FROM refresh_token AS r
        WHERE (u.id = r.user_id) AND (r.token = @__token_0)))
2022-09-21 11:51:04.770 +01:00 [DBG] A data reader was disposed.
2022-09-21 11:51:04.771 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 11:51:04.771 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-21 11:51:04.787 +01:00 [DBG] Compiling query expression: 
'DbSet<RefreshToken>()
    .Where(rt => rt.UserId == __id_0)
    .AsNoTracking()
    .Select(rt => new RefreshToken{ 
        Id = rt.Id, 
        UserId = rt.UserId, 
        RefToken = rt.RefToken, 
        Expires = rt.Expires, 
        Created = rt.Created, 
        CreatedByIp = rt.CreatedByIp, 
        Revoked = rt.Revoked, 
        RevokedByIp = rt.RevokedByIp, 
        ReplacedByToken = rt.ReplacedByToken, 
        ReasonRevoked = rt.ReasonRevoked, 
        IsExpired = rt.IsExpired, 
        IsRevoked = rt.IsRevoked, 
        IsActive = rt.IsActive 
    }
    )'
2022-09-21 11:51:04.826 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<RefreshToken>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            Id -> 0
            UserId -> 1
            RefToken -> 2
            Expires -> 3
            Created -> 4
            CreatedByIp -> 5
            Revoked -> 6
            RevokedByIp -> 7
            ReplacedByToken -> 8
            ReasonRevoked -> 9
            IsExpired -> 10
            IsRevoked -> 11
            IsActive -> 12
        SELECT r.id AS Id, r.user_id AS UserId, r.token AS RefToken, r.expires AS Expires, r.created AS Created, r.created_by_ip AS CreatedByIp, r.revoked AS Revoked, r.revoked_by_ip AS RevokedByIp, r.replaced_by_token AS ReplacedByToken, r.reason_revoked AS ReasonRevoked, r.is_expired AS IsExpired, r.is_revoked AS IsRevoked, r.is_active AS IsActive
        FROM refresh_token AS r
        WHERE r.user_id == @__id_0), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, RefreshToken>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)'
2022-09-21 11:51:04.831 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-21 11:51:04.831 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2022-09-21 11:51:04.832 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-21 11:51:04.833 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 11:51:04.834 +01:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.user_id AS "UserId", r.token AS "RefToken", r.expires AS "Expires", r.created AS "Created", r.created_by_ip AS "CreatedByIp", r.revoked AS "Revoked", r.revoked_by_ip AS "RevokedByIp", r.replaced_by_token AS "ReplacedByToken", r.reason_revoked AS "ReasonRevoked", r.is_expired AS "IsExpired", r.is_revoked AS "IsRevoked", r.is_active AS "IsActive"
FROM refresh_token AS r
WHERE r.user_id = @__id_0
2022-09-21 11:51:04.843 +01:00 [INF] Executed DbCommand (9ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.user_id AS "UserId", r.token AS "RefToken", r.expires AS "Expires", r.created AS "Created", r.created_by_ip AS "CreatedByIp", r.revoked AS "Revoked", r.revoked_by_ip AS "RevokedByIp", r.replaced_by_token AS "ReplacedByToken", r.reason_revoked AS "ReasonRevoked", r.is_expired AS "IsExpired", r.is_revoked AS "IsRevoked", r.is_active AS "IsActive"
FROM refresh_token AS r
WHERE r.user_id = @__id_0
2022-09-21 11:51:04.846 +01:00 [DBG] A data reader was disposed.
2022-09-21 11:51:04.846 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 11:51:04.847 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-21 11:51:04.863 +01:00 [DBG] An entity of type 'User' tracked by 'PostgresContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 11:51:04.904 +01:00 [DBG] 'PostgresContext' generated a temporary value for the property 'Id.RefreshToken'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 11:51:04.954 +01:00 [DBG] Context 'PostgresContext' started tracking 'RefreshToken' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 11:51:04.963 +01:00 [DBG] SaveChanges starting for 'PostgresContext'.
2022-09-21 11:51:04.970 +01:00 [DBG] DetectChanges starting for 'PostgresContext'.
2022-09-21 11:51:05.018 +01:00 [DBG] 1 entities were added and 0 entities were removed from navigation 'User.RefreshTokenCollection'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 11:51:05.045 +01:00 [DBG] The foreign key property 'RefreshToken.UserId' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2022-09-21 11:51:05.071 +01:00 [DBG] DetectChanges completed for 'PostgresContext'.
2022-09-21 11:51:05.089 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-21 11:51:05.092 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 11:51:05.097 +01:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2022-09-21 11:51:05.107 +01:00 [DBG] Began transaction with isolation level 'ReadCommitted'.
2022-09-21 11:51:05.197 +01:00 [DBG] Executing 2 update commands as a batch.
2022-09-21 11:51:05.220 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-21 11:51:05.221 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2022-09-21 11:51:05.223 +01:00 [DBG] Executing DbCommand [Parameters=[@p0='?' (DbType = DateTime), @p1='?', @p2='?' (DbType = DateTime), @p3='?' (DbType = Boolean), @p4='?' (DbType = Boolean), @p5='?' (DbType = Boolean), @p6='?', @p7='?', @p8='?', @p9='?' (DbType = DateTime), @p10='?', @p11='?' (DbType = Int32), @p18='?' (DbType = Int32), @p12='?' (DbType = DateTime), @p13='?', @p14='?', @p15='?' (DbType = DateTime), @p16='?', @p17='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO refresh_token (created, created_by_ip, expires, is_active, is_expired, is_revoked, reason_revoked, token, replaced_by_token, revoked, revoked_by_ip, user_id)
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11)
RETURNING id;
UPDATE users SET created_at = @p12, email = @p13, full_name = @p14, password_changed_at = @p15, password_hash = @p16, username = @p17
WHERE id = @p18;
2022-09-21 11:51:05.244 +01:00 [INF] Executed DbCommand (21ms) [Parameters=[@p0='?' (DbType = DateTime), @p1='?', @p2='?' (DbType = DateTime), @p3='?' (DbType = Boolean), @p4='?' (DbType = Boolean), @p5='?' (DbType = Boolean), @p6='?', @p7='?', @p8='?', @p9='?' (DbType = DateTime), @p10='?', @p11='?' (DbType = Int32), @p18='?' (DbType = Int32), @p12='?' (DbType = DateTime), @p13='?', @p14='?', @p15='?' (DbType = DateTime), @p16='?', @p17='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO refresh_token (created, created_by_ip, expires, is_active, is_expired, is_revoked, reason_revoked, token, replaced_by_token, revoked, revoked_by_ip, user_id)
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11)
RETURNING id;
UPDATE users SET created_at = @p12, email = @p13, full_name = @p14, password_changed_at = @p15, password_hash = @p16, username = @p17
WHERE id = @p18;
2022-09-21 11:51:05.262 +01:00 [DBG] The foreign key property 'RefreshToken.Id' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2022-09-21 11:51:05.266 +01:00 [DBG] A data reader was disposed.
2022-09-21 11:51:05.269 +01:00 [DBG] Committing transaction.
2022-09-21 11:51:05.280 +01:00 [DBG] Committed transaction.
2022-09-21 11:51:05.281 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 11:51:05.282 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-21 11:51:05.285 +01:00 [DBG] Disposing transaction.
2022-09-21 11:51:05.288 +01:00 [DBG] An entity of type 'RefreshToken' tracked by 'PostgresContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 11:51:05.293 +01:00 [DBG] An entity of type 'User' tracked by 'PostgresContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 11:51:05.297 +01:00 [DBG] SaveChanges completed for 'PostgresContext' with 2 entities written to the database.
2022-09-21 11:51:05.303 +01:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2022-09-21 11:51:05.314 +01:00 [DBG] Attempting to select an output formatter based on Accept header '["text/plain"]'.
2022-09-21 11:51:05.317 +01:00 [DBG] Could not find an output formatter based on content negotiation. Accepted types were (["text/plain"])
2022-09-21 11:51:05.319 +01:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2022-09-21 11:51:05.320 +01:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2022-09-21 11:51:05.322 +01:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2022-09-21 11:51:05.323 +01:00 [INF] Executing OkObjectResult, writing value of type 'APIBank.Models.Users.Responses.LoginResponse'.
2022-09-21 11:51:05.342 +01:00 [INF] Executed action APIBank.Controllers.UsersController.Login (APIBank) in 4672.7878ms
2022-09-21 11:51:05.344 +01:00 [INF] Executed endpoint 'APIBank.Controllers.UsersController.Login (APIBank)'
2022-09-21 11:51:05.350 +01:00 [DBG] 'PostgresContext' disposed.
2022-09-21 11:51:05.358 +01:00 [INF] Request finished HTTP/2 POST https://localhost:7036/api/Users/Login application/json 58 - 200 - application/json;+charset=utf-8 5276.1472ms
2022-09-21 11:51:19.490 +01:00 [INF] Request starting HTTP/2 POST https://localhost:7036/api/Users/refreshToken - 0
2022-09-21 11:51:19.497 +01:00 [DBG] 1 candidate(s) found for the request path '/api/Users/refreshToken'
2022-09-21 11:51:19.500 +01:00 [DBG] Endpoint 'APIBank.Controllers.UsersController.RefreshToken (APIBank)' with route pattern 'api/Users/refreshToken' is valid for the request path '/api/Users/refreshToken'
2022-09-21 11:51:19.504 +01:00 [DBG] Request matched endpoint 'APIBank.Controllers.UsersController.RefreshToken (APIBank)'
2022-09-21 11:51:19.506 +01:00 [DBG] Static files was skipped as the request already matched an endpoint.
2022-09-21 11:51:19.643 +01:00 [INF] Entity Framework Core 6.0.9 initialized 'PostgresContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:6.0.7+5b98e4b74de93b590b44aef8dd7967c03acc433c' with options: None
2022-09-21 11:51:19.663 +01:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .FirstOrDefault(e => EF.Property<int>(e, "Id") == __p_0)'
2022-09-21 11:51:19.668 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<User>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: User.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: User.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 1], [Property: User.Email (string) Required Index MaxLength(254), 2], [Property: User.FullName (string) Required MaxLength(100), 3], [Property: User.PasswordChangedAt (DateTime) Required ValueGenerated.OnAdd, 4], [Property: User.PasswordHash (string) Required MaxLength(200), 5], [Property: User.Username (string) Required Index MaxLength(50), 6] }
        SELECT TOP(1) u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
        FROM users AS u
        WHERE u.id == @__p_0), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, User>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)
    .SingleOrDefault()'
2022-09-21 11:51:19.670 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-21 11:51:19.671 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2022-09-21 11:51:19.672 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-21 11:51:19.673 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 11:51:19.674 +01:00 [DBG] Executing DbCommand [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.id = @__p_0
LIMIT 1
2022-09-21 11:51:19.676 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.id = @__p_0
LIMIT 1
2022-09-21 11:51:19.679 +01:00 [DBG] Context 'PostgresContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 11:51:19.682 +01:00 [DBG] A data reader was disposed.
2022-09-21 11:51:19.683 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 11:51:19.684 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-21 11:51:19.685 +01:00 [INF] Executing endpoint 'APIBank.Controllers.UsersController.RefreshToken (APIBank)'
2022-09-21 11:51:19.686 +01:00 [INF] Route matched with {action = "RefreshToken", controller = "Users"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult RefreshToken() on controller APIBank.Controllers.UsersController (APIBank).
2022-09-21 11:51:19.688 +01:00 [DBG] Execution plan of authorization filters (in the following order): ["APIBank.Authorization.AuthorizeAttribute"]
2022-09-21 11:51:19.689 +01:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2022-09-21 11:51:19.689 +01:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2022-09-21 11:51:19.691 +01:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2022-09-21 11:51:19.692 +01:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2022-09-21 11:51:19.693 +01:00 [DBG] Executing controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-21 11:51:19.693 +01:00 [DBG] Executed controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-21 11:51:32.014 +01:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .SingleOrDefault(userQuery => userQuery.RefreshTokenCollection
        .Any(refTokenQuery => refTokenQuery.RefToken == __refToken_0))'
2022-09-21 11:51:32.024 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<User>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: User.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: User.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 1], [Property: User.Email (string) Required Index MaxLength(254), 2], [Property: User.FullName (string) Required MaxLength(100), 3], [Property: User.PasswordChangedAt (DateTime) Required ValueGenerated.OnAdd, 4], [Property: User.PasswordHash (string) Required MaxLength(200), 5], [Property: User.Username (string) Required Index MaxLength(50), 6] }
        SELECT TOP(2) u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
        FROM users AS u
        WHERE EXISTS (
            SELECT 1
            FROM refresh_token AS r
            WHERE ((u.id != NULL) && (u.id == r.user_id)) && (r.token == @__refToken_0))), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, User>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)
    .SingleOrDefault()'
2022-09-21 11:51:32.026 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-21 11:51:32.027 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2022-09-21 11:51:32.029 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-21 11:51:32.031 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 11:51:32.034 +01:00 [DBG] Executing DbCommand [Parameters=[@__refToken_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE EXISTS (
    SELECT 1
    FROM refresh_token AS r
    WHERE (u.id = r.user_id) AND (r.token = @__refToken_0))
LIMIT 2
2022-09-21 11:51:32.037 +01:00 [INF] Executed DbCommand (4ms) [Parameters=[@__refToken_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE EXISTS (
    SELECT 1
    FROM refresh_token AS r
    WHERE (u.id = r.user_id) AND (r.token = @__refToken_0))
LIMIT 2
2022-09-21 11:51:32.039 +01:00 [DBG] A data reader was disposed.
2022-09-21 11:51:32.040 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 11:51:32.042 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-21 11:54:51.336 +01:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2022-09-21 11:54:51.517 +01:00 [DBG] Hosting starting
2022-09-21 11:54:52.139 +01:00 [DBG] Using development certificate: CN=localhost (Thumbprint: 9CC642E9838495A6C3C202DECA6A8AD300396DD2)
2022-09-21 11:54:52.193 +01:00 [INF] Now listening on: https://localhost:7036
2022-09-21 11:54:52.194 +01:00 [INF] Now listening on: http://localhost:5036
2022-09-21 11:54:52.195 +01:00 [DBG] Loaded hosting startup assembly APIBank
2022-09-21 11:54:52.196 +01:00 [DBG] Loaded hosting startup assembly Microsoft.AspNetCore.Watch.BrowserRefresh
2022-09-21 11:54:52.197 +01:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.BrowserLink.Net
2022-09-21 11:54:52.197 +01:00 [INF] Application started. Press Ctrl+C to shut down.
2022-09-21 11:54:52.198 +01:00 [INF] Hosting environment: Development
2022-09-21 11:54:52.199 +01:00 [INF] Content root path: C:\Users\mguedesa\OneDrive - NTT DATA EMEAL\Documentos\GitHub\OpenBankAPI-NTT\APIBank\APIBank\
2022-09-21 11:54:52.199 +01:00 [DBG] Hosting started
2022-09-21 11:54:52.474 +01:00 [DBG] Connection id "0HMKRNUR3MHLG" received FIN.
2022-09-21 11:54:52.474 +01:00 [DBG] Connection id "0HMKRNUR3MHLH" received FIN.
2022-09-21 11:54:52.485 +01:00 [DBG] Connection id "0HMKRNUR3MHLG" accepted.
2022-09-21 11:54:52.485 +01:00 [DBG] Connection id "0HMKRNUR3MHLH" accepted.
2022-09-21 11:54:52.488 +01:00 [DBG] Connection id "0HMKRNUR3MHLG" started.
2022-09-21 11:54:52.488 +01:00 [DBG] Connection id "0HMKRNUR3MHLH" started.
2022-09-21 11:54:52.510 +01:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException:  Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveBlobAsync[TIOAdapter](TIOAdapter adapter)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](TIOAdapter adapter, Boolean receiveFirst, Byte[] reAuthenticationData, Boolean isApm)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2022-09-21 11:54:52.510 +01:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException:  Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveBlobAsync[TIOAdapter](TIOAdapter adapter)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](TIOAdapter adapter, Boolean receiveFirst, Byte[] reAuthenticationData, Boolean isApm)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2022-09-21 11:54:52.547 +01:00 [DBG] Connection id "0HMKRNUR3MHLH" stopped.
2022-09-21 11:54:52.547 +01:00 [DBG] Connection id "0HMKRNUR3MHLG" stopped.
2022-09-21 11:54:52.550 +01:00 [DBG] Connection id "0HMKRNUR3MHLG" sending FIN because: "The Socket transport's send loop completed gracefully."
2022-09-21 11:54:52.550 +01:00 [DBG] Connection id "0HMKRNUR3MHLH" sending FIN because: "The Socket transport's send loop completed gracefully."
2022-09-21 11:54:52.922 +01:00 [DBG] Connection id "0HMKRNUR3MHLI" accepted.
2022-09-21 11:54:52.952 +01:00 [DBG] Connection id "0HMKRNUR3MHLI" started.
2022-09-21 11:54:53.062 +01:00 [DBG] Connection 0HMKRNUR3MHLI established using the following protocol: "Tls12"
2022-09-21 11:54:53.184 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/swagger/index.html - -
2022-09-21 11:54:53.254 +01:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2022-09-21 11:54:53.291 +01:00 [DBG] No candidates found for the request path '/swagger/index.html'
2022-09-21 11:54:53.293 +01:00 [DBG] Request did not match any endpoints
2022-09-21 11:54:53.401 +01:00 [DBG] Response markup is scheduled to include browser refresh script injection.
2022-09-21 11:54:53.558 +01:00 [DBG] Response markup was updated to include browser refresh script injection.
2022-09-21 11:54:53.565 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/swagger/index.html - - - 200 - text/html;charset=utf-8 391.6264ms
2022-09-21 11:54:53.592 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/_vs/browserLink - -
2022-09-21 11:54:53.592 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/_framework/aspnetcore-browser-refresh.js - -
2022-09-21 11:54:53.607 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/_framework/aspnetcore-browser-refresh.js - - - 200 11984 application/javascript;+charset=utf-8 14.7091ms
2022-09-21 11:54:53.623 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/_vs/browserLink - - - 200 - text/javascript;+charset=UTF-8 31.3969ms
2022-09-21 11:54:53.709 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/swagger/v1/swagger.json - -
2022-09-21 11:54:53.712 +01:00 [DBG] No candidates found for the request path '/swagger/v1/swagger.json'
2022-09-21 11:54:53.713 +01:00 [DBG] Request did not match any endpoints
2022-09-21 11:54:53.900 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/swagger/v1/swagger.json - - - 200 - application/json;charset=utf-8 191.6326ms
2022-09-21 11:55:23.889 +01:00 [INF] Request starting HTTP/2 POST https://localhost:7036/api/Users/Login application/json 58
2022-09-21 11:55:23.907 +01:00 [DBG] 1 candidate(s) found for the request path '/api/Users/Login'
2022-09-21 11:55:23.917 +01:00 [DBG] Endpoint 'APIBank.Controllers.UsersController.Login (APIBank)' with route pattern 'api/Users/Login' is valid for the request path '/api/Users/Login'
2022-09-21 11:55:23.924 +01:00 [DBG] Request matched endpoint 'APIBank.Controllers.UsersController.Login (APIBank)'
2022-09-21 11:55:23.928 +01:00 [DBG] Static files was skipped as the request already matched an endpoint.
2022-09-21 11:55:24.413 +01:00 [INF] Executing endpoint 'APIBank.Controllers.UsersController.Login (APIBank)'
2022-09-21 11:55:24.450 +01:00 [INF] Route matched with {action = "Login", controller = "Users"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult Login(APIBank.Models.Requests.LoginRequest) on controller APIBank.Controllers.UsersController (APIBank).
2022-09-21 11:55:24.454 +01:00 [DBG] Execution plan of authorization filters (in the following order): ["APIBank.Authorization.AuthorizeAttribute"]
2022-09-21 11:55:24.456 +01:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2022-09-21 11:55:24.457 +01:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2022-09-21 11:55:24.458 +01:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2022-09-21 11:55:24.459 +01:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2022-09-21 11:55:24.461 +01:00 [DBG] Executing controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-21 11:55:24.463 +01:00 [DBG] Executed controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-21 11:55:24.480 +01:00 [DBG] Attempting to bind parameter 'model' of type 'APIBank.Models.Requests.LoginRequest' ...
2022-09-21 11:55:24.485 +01:00 [DBG] Attempting to bind parameter 'model' of type 'APIBank.Models.Requests.LoginRequest' using the name '' in request data ...
2022-09-21 11:55:24.488 +01:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2022-09-21 11:55:24.493 +01:00 [DBG] Connection id "0HMKRNUR3MHLI", Request id "0HMKRNUR3MHLI:00000009": started reading request body.
2022-09-21 11:55:24.495 +01:00 [DBG] Connection id "0HMKRNUR3MHLI", Request id "0HMKRNUR3MHLI:00000009": done reading request body.
2022-09-21 11:55:24.505 +01:00 [DBG] JSON input formatter succeeded, deserializing to type 'APIBank.Models.Requests.LoginRequest'
2022-09-21 11:55:24.507 +01:00 [DBG] Done attempting to bind parameter 'model' of type 'APIBank.Models.Requests.LoginRequest'.
2022-09-21 11:55:24.508 +01:00 [DBG] Done attempting to bind parameter 'model' of type 'APIBank.Models.Requests.LoginRequest'.
2022-09-21 11:55:24.510 +01:00 [DBG] Attempting to validate the bound parameter 'model' of type 'APIBank.Models.Requests.LoginRequest' ...
2022-09-21 11:55:24.524 +01:00 [DBG] Done attempting to validate the bound parameter 'model' of type 'APIBank.Models.Requests.LoginRequest'.
2022-09-21 11:55:24.684 +01:00 [DBG] An additional 'IServiceProvider' was created for internal use by Entity Framework. An existing service provider was not used due to the following configuration changes: configuration changed for 'Core:ConfigureWarnings', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:UseAdminDatabase', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:SetPostgresVersion', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:UseRedshift', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:ReverseNullOrdering', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:RemoteCertificateValidationCallback', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:ProvideClientCertificatesCallback', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:ProvidePasswordCallback'.
2022-09-21 11:55:26.242 +01:00 [INF] Entity Framework Core 6.0.9 initialized 'PostgresContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:6.0.7+5b98e4b74de93b590b44aef8dd7967c03acc433c' with options: None
2022-09-21 11:55:26.341 +01:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .SingleOrDefault(x => x.Username == __model_Username_0)'
2022-09-21 11:55:26.904 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<User>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: User.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: User.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 1], [Property: User.Email (string) Required Index MaxLength(254), 2], [Property: User.FullName (string) Required MaxLength(100), 3], [Property: User.PasswordChangedAt (DateTime) Required ValueGenerated.OnAdd, 4], [Property: User.PasswordHash (string) Required MaxLength(200), 5], [Property: User.Username (string) Required Index MaxLength(50), 6] }
        SELECT TOP(2) u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
        FROM users AS u
        WHERE u.username == @__model_Username_0), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, User>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)
    .SingleOrDefault()'
2022-09-21 11:55:26.970 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-21 11:55:27.103 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (123ms).
2022-09-21 11:55:27.115 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-21 11:55:27.443 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 11:55:27.468 +01:00 [DBG] Executing DbCommand [Parameters=[@__model_Username_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.username = @__model_Username_0
LIMIT 2
2022-09-21 11:55:27.630 +01:00 [INF] Executed DbCommand (159ms) [Parameters=[@__model_Username_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.username = @__model_Username_0
LIMIT 2
2022-09-21 11:55:27.701 +01:00 [DBG] Context 'PostgresContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 11:55:27.781 +01:00 [DBG] A data reader was disposed.
2022-09-21 11:55:27.788 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 11:55:27.800 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-21 11:55:28.302 +01:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .Any(user => user.RefreshTokenCollection
        .Any(reftoken => reftoken.RefToken == __token_0))'
2022-09-21 11:55:28.469 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<bool>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            EmptyProjectionMember -> 0
        SELECT EXISTS (
            SELECT 1
            FROM users AS u
            WHERE EXISTS (
                SELECT 1
                FROM refresh_token AS r
                WHERE ((u.id != NULL) && (u.id == r.user_id)) && (r.token == @__token_0)))), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, bool>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)
    .Single()'
2022-09-21 11:55:28.485 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-21 11:55:28.487 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2022-09-21 11:55:28.488 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-21 11:55:28.489 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 11:55:28.490 +01:00 [DBG] Executing DbCommand [Parameters=[@__token_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM users AS u
    WHERE EXISTS (
        SELECT 1
        FROM refresh_token AS r
        WHERE (u.id = r.user_id) AND (r.token = @__token_0)))
2022-09-21 11:55:28.493 +01:00 [INF] Executed DbCommand (3ms) [Parameters=[@__token_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM users AS u
    WHERE EXISTS (
        SELECT 1
        FROM refresh_token AS r
        WHERE (u.id = r.user_id) AND (r.token = @__token_0)))
2022-09-21 11:55:28.500 +01:00 [DBG] A data reader was disposed.
2022-09-21 11:55:28.501 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 11:55:28.502 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-21 11:55:28.520 +01:00 [DBG] Compiling query expression: 
'DbSet<RefreshToken>()
    .Where(rt => rt.UserId == __id_0)
    .AsNoTracking()
    .Select(rt => new RefreshToken{ 
        Id = rt.Id, 
        UserId = rt.UserId, 
        RefToken = rt.RefToken, 
        Expires = rt.Expires, 
        Created = rt.Created, 
        CreatedByIp = rt.CreatedByIp, 
        Revoked = rt.Revoked, 
        RevokedByIp = rt.RevokedByIp, 
        ReplacedByToken = rt.ReplacedByToken, 
        ReasonRevoked = rt.ReasonRevoked, 
        IsExpired = rt.IsExpired, 
        IsRevoked = rt.IsRevoked, 
        IsActive = rt.IsActive 
    }
    )'
2022-09-21 11:55:28.555 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<RefreshToken>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            Id -> 0
            UserId -> 1
            RefToken -> 2
            Expires -> 3
            Created -> 4
            CreatedByIp -> 5
            Revoked -> 6
            RevokedByIp -> 7
            ReplacedByToken -> 8
            ReasonRevoked -> 9
            IsExpired -> 10
            IsRevoked -> 11
            IsActive -> 12
        SELECT r.id AS Id, r.user_id AS UserId, r.token AS RefToken, r.expires AS Expires, r.created AS Created, r.created_by_ip AS CreatedByIp, r.revoked AS Revoked, r.revoked_by_ip AS RevokedByIp, r.replaced_by_token AS ReplacedByToken, r.reason_revoked AS ReasonRevoked, r.is_expired AS IsExpired, r.is_revoked AS IsRevoked, r.is_active AS IsActive
        FROM refresh_token AS r
        WHERE r.user_id == @__id_0), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, RefreshToken>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)'
2022-09-21 11:55:28.563 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-21 11:55:28.564 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2022-09-21 11:55:28.567 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-21 11:55:28.568 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 11:55:28.568 +01:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.user_id AS "UserId", r.token AS "RefToken", r.expires AS "Expires", r.created AS "Created", r.created_by_ip AS "CreatedByIp", r.revoked AS "Revoked", r.revoked_by_ip AS "RevokedByIp", r.replaced_by_token AS "ReplacedByToken", r.reason_revoked AS "ReasonRevoked", r.is_expired AS "IsExpired", r.is_revoked AS "IsRevoked", r.is_active AS "IsActive"
FROM refresh_token AS r
WHERE r.user_id = @__id_0
2022-09-21 11:55:28.575 +01:00 [INF] Executed DbCommand (7ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.user_id AS "UserId", r.token AS "RefToken", r.expires AS "Expires", r.created AS "Created", r.created_by_ip AS "CreatedByIp", r.revoked AS "Revoked", r.revoked_by_ip AS "RevokedByIp", r.replaced_by_token AS "ReplacedByToken", r.reason_revoked AS "ReasonRevoked", r.is_expired AS "IsExpired", r.is_revoked AS "IsRevoked", r.is_active AS "IsActive"
FROM refresh_token AS r
WHERE r.user_id = @__id_0
2022-09-21 11:55:28.579 +01:00 [DBG] A data reader was disposed.
2022-09-21 11:55:28.580 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 11:55:28.581 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-21 11:55:28.599 +01:00 [DBG] An entity of type 'User' tracked by 'PostgresContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 11:55:28.639 +01:00 [DBG] 'PostgresContext' generated a temporary value for the property 'Id.RefreshToken'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 11:55:28.701 +01:00 [DBG] Context 'PostgresContext' started tracking 'RefreshToken' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 11:55:28.706 +01:00 [DBG] SaveChanges starting for 'PostgresContext'.
2022-09-21 11:55:28.709 +01:00 [DBG] DetectChanges starting for 'PostgresContext'.
2022-09-21 11:55:28.750 +01:00 [DBG] 1 entities were added and 0 entities were removed from navigation 'User.RefreshTokenCollection'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 11:55:28.770 +01:00 [DBG] The foreign key property 'RefreshToken.UserId' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2022-09-21 11:55:28.799 +01:00 [DBG] DetectChanges completed for 'PostgresContext'.
2022-09-21 11:55:28.817 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-21 11:55:28.820 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 11:55:28.824 +01:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2022-09-21 11:55:28.837 +01:00 [DBG] Began transaction with isolation level 'ReadCommitted'.
2022-09-21 11:55:28.906 +01:00 [DBG] Executing 2 update commands as a batch.
2022-09-21 11:55:28.933 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-21 11:55:28.935 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (2ms).
2022-09-21 11:55:28.938 +01:00 [DBG] Executing DbCommand [Parameters=[@p0='?' (DbType = DateTime), @p1='?', @p2='?' (DbType = DateTime), @p3='?' (DbType = Boolean), @p4='?' (DbType = Boolean), @p5='?' (DbType = Boolean), @p6='?', @p7='?', @p8='?', @p9='?' (DbType = DateTime), @p10='?', @p11='?' (DbType = Int32), @p18='?' (DbType = Int32), @p12='?' (DbType = DateTime), @p13='?', @p14='?', @p15='?' (DbType = DateTime), @p16='?', @p17='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO refresh_token (created, created_by_ip, expires, is_active, is_expired, is_revoked, reason_revoked, token, replaced_by_token, revoked, revoked_by_ip, user_id)
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11)
RETURNING id;
UPDATE users SET created_at = @p12, email = @p13, full_name = @p14, password_changed_at = @p15, password_hash = @p16, username = @p17
WHERE id = @p18;
2022-09-21 11:55:28.955 +01:00 [INF] Executed DbCommand (17ms) [Parameters=[@p0='?' (DbType = DateTime), @p1='?', @p2='?' (DbType = DateTime), @p3='?' (DbType = Boolean), @p4='?' (DbType = Boolean), @p5='?' (DbType = Boolean), @p6='?', @p7='?', @p8='?', @p9='?' (DbType = DateTime), @p10='?', @p11='?' (DbType = Int32), @p18='?' (DbType = Int32), @p12='?' (DbType = DateTime), @p13='?', @p14='?', @p15='?' (DbType = DateTime), @p16='?', @p17='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO refresh_token (created, created_by_ip, expires, is_active, is_expired, is_revoked, reason_revoked, token, replaced_by_token, revoked, revoked_by_ip, user_id)
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11)
RETURNING id;
UPDATE users SET created_at = @p12, email = @p13, full_name = @p14, password_changed_at = @p15, password_hash = @p16, username = @p17
WHERE id = @p18;
2022-09-21 11:55:28.982 +01:00 [DBG] The foreign key property 'RefreshToken.Id' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2022-09-21 11:55:28.988 +01:00 [DBG] A data reader was disposed.
2022-09-21 11:55:28.993 +01:00 [DBG] Committing transaction.
2022-09-21 11:55:29.005 +01:00 [DBG] Committed transaction.
2022-09-21 11:55:29.012 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 11:55:29.014 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-21 11:55:29.020 +01:00 [DBG] Disposing transaction.
2022-09-21 11:55:29.025 +01:00 [DBG] An entity of type 'RefreshToken' tracked by 'PostgresContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 11:55:29.029 +01:00 [DBG] An entity of type 'User' tracked by 'PostgresContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 11:55:29.033 +01:00 [DBG] SaveChanges completed for 'PostgresContext' with 2 entities written to the database.
2022-09-21 11:55:29.039 +01:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2022-09-21 11:55:29.046 +01:00 [DBG] Attempting to select an output formatter based on Accept header '["text/plain"]'.
2022-09-21 11:55:29.048 +01:00 [DBG] Could not find an output formatter based on content negotiation. Accepted types were (["text/plain"])
2022-09-21 11:55:29.050 +01:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2022-09-21 11:55:29.051 +01:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2022-09-21 11:55:29.053 +01:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2022-09-21 11:55:29.056 +01:00 [INF] Executing OkObjectResult, writing value of type 'APIBank.Models.Users.Responses.LoginResponse'.
2022-09-21 11:55:29.079 +01:00 [INF] Executed action APIBank.Controllers.UsersController.Login (APIBank) in 4610.4361ms
2022-09-21 11:55:29.081 +01:00 [INF] Executed endpoint 'APIBank.Controllers.UsersController.Login (APIBank)'
2022-09-21 11:55:29.088 +01:00 [DBG] 'PostgresContext' disposed.
2022-09-21 11:55:29.097 +01:00 [INF] Request finished HTTP/2 POST https://localhost:7036/api/Users/Login application/json 58 - 200 - application/json;+charset=utf-8 5208.1219ms
2022-09-21 11:55:42.824 +01:00 [INF] Request starting HTTP/2 POST https://localhost:7036/api/Users/refreshToken - 0
2022-09-21 11:55:42.839 +01:00 [DBG] 1 candidate(s) found for the request path '/api/Users/refreshToken'
2022-09-21 11:55:42.841 +01:00 [DBG] Endpoint 'APIBank.Controllers.UsersController.RefreshToken (APIBank)' with route pattern 'api/Users/refreshToken' is valid for the request path '/api/Users/refreshToken'
2022-09-21 11:55:42.844 +01:00 [DBG] Request matched endpoint 'APIBank.Controllers.UsersController.RefreshToken (APIBank)'
2022-09-21 11:55:42.844 +01:00 [DBG] Static files was skipped as the request already matched an endpoint.
2022-09-21 11:55:42.978 +01:00 [INF] Entity Framework Core 6.0.9 initialized 'PostgresContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:6.0.7+5b98e4b74de93b590b44aef8dd7967c03acc433c' with options: None
2022-09-21 11:55:42.998 +01:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .FirstOrDefault(e => EF.Property<int>(e, "Id") == __p_0)'
2022-09-21 11:55:43.009 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<User>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: User.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: User.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 1], [Property: User.Email (string) Required Index MaxLength(254), 2], [Property: User.FullName (string) Required MaxLength(100), 3], [Property: User.PasswordChangedAt (DateTime) Required ValueGenerated.OnAdd, 4], [Property: User.PasswordHash (string) Required MaxLength(200), 5], [Property: User.Username (string) Required Index MaxLength(50), 6] }
        SELECT TOP(1) u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
        FROM users AS u
        WHERE u.id == @__p_0), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, User>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)
    .SingleOrDefault()'
2022-09-21 11:55:43.012 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-21 11:55:43.013 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2022-09-21 11:55:43.013 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-21 11:55:43.015 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 11:55:43.019 +01:00 [DBG] Executing DbCommand [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.id = @__p_0
LIMIT 1
2022-09-21 11:55:43.024 +01:00 [INF] Executed DbCommand (4ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.id = @__p_0
LIMIT 1
2022-09-21 11:55:43.025 +01:00 [DBG] Context 'PostgresContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 11:55:43.026 +01:00 [DBG] A data reader was disposed.
2022-09-21 11:55:43.027 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 11:55:43.028 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-21 11:55:43.028 +01:00 [INF] Executing endpoint 'APIBank.Controllers.UsersController.RefreshToken (APIBank)'
2022-09-21 11:55:43.030 +01:00 [INF] Route matched with {action = "RefreshToken", controller = "Users"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult RefreshToken() on controller APIBank.Controllers.UsersController (APIBank).
2022-09-21 11:55:43.036 +01:00 [DBG] Execution plan of authorization filters (in the following order): ["APIBank.Authorization.AuthorizeAttribute"]
2022-09-21 11:55:43.038 +01:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2022-09-21 11:55:43.039 +01:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2022-09-21 11:55:43.040 +01:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2022-09-21 11:55:43.041 +01:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2022-09-21 11:55:43.042 +01:00 [DBG] Executing controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-21 11:55:43.043 +01:00 [DBG] Executed controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-21 11:55:59.709 +01:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .SingleOrDefault(userQuery => userQuery.RefreshTokenCollection
        .Any(refTokenQuery => refTokenQuery.RefToken == __refToken_0))'
2022-09-21 11:55:59.724 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<User>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: User.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: User.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 1], [Property: User.Email (string) Required Index MaxLength(254), 2], [Property: User.FullName (string) Required MaxLength(100), 3], [Property: User.PasswordChangedAt (DateTime) Required ValueGenerated.OnAdd, 4], [Property: User.PasswordHash (string) Required MaxLength(200), 5], [Property: User.Username (string) Required Index MaxLength(50), 6] }
        SELECT TOP(2) u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
        FROM users AS u
        WHERE EXISTS (
            SELECT 1
            FROM refresh_token AS r
            WHERE ((u.id != NULL) && (u.id == r.user_id)) && (r.token == @__refToken_0))), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, User>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)
    .SingleOrDefault()'
2022-09-21 11:55:59.726 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-21 11:55:59.728 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2022-09-21 11:55:59.729 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-21 11:55:59.731 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 11:55:59.732 +01:00 [DBG] Executing DbCommand [Parameters=[@__refToken_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE EXISTS (
    SELECT 1
    FROM refresh_token AS r
    WHERE (u.id = r.user_id) AND (r.token = @__refToken_0))
LIMIT 2
2022-09-21 11:55:59.738 +01:00 [INF] Executed DbCommand (5ms) [Parameters=[@__refToken_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE EXISTS (
    SELECT 1
    FROM refresh_token AS r
    WHERE (u.id = r.user_id) AND (r.token = @__refToken_0))
LIMIT 2
2022-09-21 11:55:59.742 +01:00 [DBG] A data reader was disposed.
2022-09-21 11:55:59.742 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 11:55:59.745 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-21 11:56:13.867 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-21 11:56:13.869 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2022-09-21 11:56:13.870 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-21 11:56:13.872 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 11:56:13.873 +01:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.user_id AS "UserId", r.token AS "RefToken", r.expires AS "Expires", r.created AS "Created", r.created_by_ip AS "CreatedByIp", r.revoked AS "Revoked", r.revoked_by_ip AS "RevokedByIp", r.replaced_by_token AS "ReplacedByToken", r.reason_revoked AS "ReasonRevoked", r.is_expired AS "IsExpired", r.is_revoked AS "IsRevoked", r.is_active AS "IsActive"
FROM refresh_token AS r
WHERE r.user_id = @__id_0
2022-09-21 11:56:13.875 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.user_id AS "UserId", r.token AS "RefToken", r.expires AS "Expires", r.created AS "Created", r.created_by_ip AS "CreatedByIp", r.revoked AS "Revoked", r.revoked_by_ip AS "RevokedByIp", r.replaced_by_token AS "ReplacedByToken", r.reason_revoked AS "ReasonRevoked", r.is_expired AS "IsExpired", r.is_revoked AS "IsRevoked", r.is_active AS "IsActive"
FROM refresh_token AS r
WHERE r.user_id = @__id_0
2022-09-21 11:56:13.901 +01:00 [DBG] A data reader was disposed.
2022-09-21 11:56:13.901 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 11:56:13.903 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-21 11:57:20.351 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-21 11:57:20.354 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (3ms).
2022-09-21 11:57:20.357 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-21 11:57:20.357 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 11:57:20.359 +01:00 [DBG] Executing DbCommand [Parameters=[@__token_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM users AS u
    WHERE EXISTS (
        SELECT 1
        FROM refresh_token AS r
        WHERE (u.id = r.user_id) AND (r.token = @__token_0)))
2022-09-21 11:57:20.364 +01:00 [INF] Executed DbCommand (5ms) [Parameters=[@__token_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM users AS u
    WHERE EXISTS (
        SELECT 1
        FROM refresh_token AS r
        WHERE (u.id = r.user_id) AND (r.token = @__token_0)))
2022-09-21 11:57:20.370 +01:00 [DBG] A data reader was disposed.
2022-09-21 11:57:20.371 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 11:57:20.372 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-21 11:59:26.698 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-21 11:59:26.701 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (2ms).
2022-09-21 11:59:26.702 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-21 11:59:26.706 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 11:59:26.707 +01:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.user_id AS "UserId", r.token AS "RefToken", r.expires AS "Expires", r.created AS "Created", r.created_by_ip AS "CreatedByIp", r.revoked AS "Revoked", r.revoked_by_ip AS "RevokedByIp", r.replaced_by_token AS "ReplacedByToken", r.reason_revoked AS "ReasonRevoked", r.is_expired AS "IsExpired", r.is_revoked AS "IsRevoked", r.is_active AS "IsActive"
FROM refresh_token AS r
WHERE r.user_id = @__id_0
2022-09-21 11:59:26.709 +01:00 [INF] Executed DbCommand (3ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.user_id AS "UserId", r.token AS "RefToken", r.expires AS "Expires", r.created AS "Created", r.created_by_ip AS "CreatedByIp", r.revoked AS "Revoked", r.revoked_by_ip AS "RevokedByIp", r.replaced_by_token AS "ReplacedByToken", r.reason_revoked AS "ReasonRevoked", r.is_expired AS "IsExpired", r.is_revoked AS "IsRevoked", r.is_active AS "IsActive"
FROM refresh_token AS r
WHERE r.user_id = @__id_0
2022-09-21 11:59:26.727 +01:00 [DBG] A data reader was disposed.
2022-09-21 11:59:26.728 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 11:59:26.729 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-21 12:00:33.435 +01:00 [DBG] An entity of type 'User' tracked by 'PostgresContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 12:01:33.590 +01:00 [DBG] Context 'PostgresContext' started tracking 'RefreshToken' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 12:01:39.152 +01:00 [DBG] SaveChanges starting for 'PostgresContext'.
2022-09-21 12:01:39.154 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/swagger/index.html - -
2022-09-21 12:01:39.156 +01:00 [DBG] DetectChanges starting for 'PostgresContext'.
2022-09-21 12:01:39.159 +01:00 [DBG] No candidates found for the request path '/swagger/index.html'
2022-09-21 12:01:39.160 +01:00 [DBG] 1 entities were added and 0 entities were removed from navigation 'User.RefreshTokenCollection'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 12:01:39.161 +01:00 [DBG] Request did not match any endpoints
2022-09-21 12:01:39.163 +01:00 [DBG] Response markup is scheduled to include browser refresh script injection.
2022-09-21 12:01:39.164 +01:00 [DBG] 'PostgresContext' generated a temporary value for the property 'Id.RefreshToken'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 12:01:39.187 +01:00 [DBG] Context 'PostgresContext' started tracking 'RefreshToken' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 12:01:39.192 +01:00 [DBG] DetectChanges completed for 'PostgresContext'.
2022-09-21 12:01:39.193 +01:00 [DBG] Response markup was updated to include browser refresh script injection.
2022-09-21 12:01:39.194 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-21 12:01:39.195 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/swagger/index.html - - - 200 - text/html;charset=utf-8 41.1606ms
2022-09-21 12:01:39.196 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 12:01:39.199 +01:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2022-09-21 12:01:39.200 +01:00 [DBG] Began transaction with isolation level 'ReadCommitted'.
2022-09-21 12:01:39.206 +01:00 [DBG] Executing 3 update commands as a batch.
2022-09-21 12:01:39.209 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-21 12:01:39.210 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2022-09-21 12:01:39.212 +01:00 [DBG] Executing DbCommand [Parameters=[@p12='?' (DbType = Int32), @p0='?' (DbType = DateTime), @p1='?', @p2='?' (DbType = DateTime), @p3='?' (DbType = Boolean), @p4='?' (DbType = Boolean), @p5='?' (DbType = Boolean), @p6='?', @p7='?', @p8='?', @p9='?' (DbType = DateTime), @p10='?', @p11='?' (DbType = Int32), @p13='?' (DbType = DateTime), @p14='?', @p15='?' (DbType = DateTime), @p16='?' (DbType = Boolean), @p17='?' (DbType = Boolean), @p18='?' (DbType = Boolean), @p19='?', @p20='?', @p21='?', @p22='?' (DbType = DateTime), @p23='?', @p24='?' (DbType = Int32), @p31='?' (DbType = Int32), @p25='?' (DbType = DateTime), @p26='?', @p27='?', @p28='?' (DbType = DateTime), @p29='?', @p30='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE refresh_token SET created = @p0, created_by_ip = @p1, expires = @p2, is_active = @p3, is_expired = @p4, is_revoked = @p5, reason_revoked = @p6, token = @p7, replaced_by_token = @p8, revoked = @p9, revoked_by_ip = @p10, user_id = @p11
WHERE id = @p12;
INSERT INTO refresh_token (created, created_by_ip, expires, is_active, is_expired, is_revoked, reason_revoked, token, replaced_by_token, revoked, revoked_by_ip, user_id)
VALUES (@p13, @p14, @p15, @p16, @p17, @p18, @p19, @p20, @p21, @p22, @p23, @p24)
RETURNING id;
UPDATE users SET created_at = @p25, email = @p26, full_name = @p27, password_changed_at = @p28, password_hash = @p29, username = @p30
WHERE id = @p31;
2022-09-21 12:01:39.218 +01:00 [INF] Executed DbCommand (6ms) [Parameters=[@p12='?' (DbType = Int32), @p0='?' (DbType = DateTime), @p1='?', @p2='?' (DbType = DateTime), @p3='?' (DbType = Boolean), @p4='?' (DbType = Boolean), @p5='?' (DbType = Boolean), @p6='?', @p7='?', @p8='?', @p9='?' (DbType = DateTime), @p10='?', @p11='?' (DbType = Int32), @p13='?' (DbType = DateTime), @p14='?', @p15='?' (DbType = DateTime), @p16='?' (DbType = Boolean), @p17='?' (DbType = Boolean), @p18='?' (DbType = Boolean), @p19='?', @p20='?', @p21='?', @p22='?' (DbType = DateTime), @p23='?', @p24='?' (DbType = Int32), @p31='?' (DbType = Int32), @p25='?' (DbType = DateTime), @p26='?', @p27='?', @p28='?' (DbType = DateTime), @p29='?', @p30='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE refresh_token SET created = @p0, created_by_ip = @p1, expires = @p2, is_active = @p3, is_expired = @p4, is_revoked = @p5, reason_revoked = @p6, token = @p7, replaced_by_token = @p8, revoked = @p9, revoked_by_ip = @p10, user_id = @p11
WHERE id = @p12;
INSERT INTO refresh_token (created, created_by_ip, expires, is_active, is_expired, is_revoked, reason_revoked, token, replaced_by_token, revoked, revoked_by_ip, user_id)
VALUES (@p13, @p14, @p15, @p16, @p17, @p18, @p19, @p20, @p21, @p22, @p23, @p24)
RETURNING id;
UPDATE users SET created_at = @p25, email = @p26, full_name = @p27, password_changed_at = @p28, password_hash = @p29, username = @p30
WHERE id = @p31;
2022-09-21 12:01:39.225 +01:00 [DBG] The foreign key property 'RefreshToken.Id' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2022-09-21 12:01:39.227 +01:00 [DBG] A data reader was disposed.
2022-09-21 12:01:39.228 +01:00 [DBG] Committing transaction.
2022-09-21 12:01:39.229 +01:00 [DBG] Committed transaction.
2022-09-21 12:01:39.230 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 12:01:39.232 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-21 12:01:39.233 +01:00 [DBG] Disposing transaction.
2022-09-21 12:01:39.234 +01:00 [DBG] An entity of type 'RefreshToken' tracked by 'PostgresContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 12:01:39.235 +01:00 [DBG] An entity of type 'User' tracked by 'PostgresContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 12:01:39.237 +01:00 [DBG] An entity of type 'RefreshToken' tracked by 'PostgresContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 12:01:39.239 +01:00 [DBG] SaveChanges completed for 'PostgresContext' with 3 entities written to the database.
2022-09-21 12:01:47.003 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/_framework/aspnetcore-browser-refresh.js - -
2022-09-21 12:01:48.088 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/_vs/browserLink - -
2022-09-21 12:01:48.713 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/_framework/aspnetcore-browser-refresh.js - - - 200 11984 application/javascript;+charset=utf-8 1710.0612ms
2022-09-21 12:01:58.844 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/_vs/browserLink - - - 200 - text/javascript;+charset=UTF-8 10756.2685ms
2022-09-21 12:01:59.201 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/swagger/v1/swagger.json - -
2022-09-21 12:01:59.364 +01:00 [DBG] No candidates found for the request path '/swagger/v1/swagger.json'
2022-09-21 12:01:59.667 +01:00 [DBG] Request did not match any endpoints
2022-09-21 12:02:01.126 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/swagger/v1/swagger.json - - - 200 - application/json;charset=utf-8 1566.0899ms
2022-09-21 12:02:43.337 +01:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2022-09-21 12:02:43.345 +01:00 [DBG] Attempting to select an output formatter based on Accept header '["text/plain"]'.
2022-09-21 12:02:43.347 +01:00 [DBG] Could not find an output formatter based on content negotiation. Accepted types were (["text/plain"])
2022-09-21 12:02:43.348 +01:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2022-09-21 12:02:43.350 +01:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2022-09-21 12:02:43.351 +01:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2022-09-21 12:02:43.352 +01:00 [INF] Executing OkObjectResult, writing value of type 'APIBank.Models.Users.Responses.LoginResponse'.
2022-09-21 12:02:43.391 +01:00 [INF] Executed action APIBank.Controllers.UsersController.RefreshToken (APIBank) in 420349.0527ms
2022-09-21 12:02:43.393 +01:00 [INF] Executed endpoint 'APIBank.Controllers.UsersController.RefreshToken (APIBank)'
2022-09-21 12:03:16.831 +01:00 [DBG] 'PostgresContext' disposed.
2022-09-21 12:03:16.834 +01:00 [INF] Request finished HTTP/2 POST https://localhost:7036/api/Users/refreshToken - 0 - 0 - application/json;+charset=utf-8 454010.2146ms
2022-09-21 12:03:34.983 +01:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2022-09-21 12:03:35.149 +01:00 [DBG] Hosting starting
2022-09-21 12:03:35.758 +01:00 [DBG] Using development certificate: CN=localhost (Thumbprint: 9CC642E9838495A6C3C202DECA6A8AD300396DD2)
2022-09-21 12:03:35.927 +01:00 [INF] Now listening on: https://localhost:7036
2022-09-21 12:03:35.930 +01:00 [INF] Now listening on: http://localhost:5036
2022-09-21 12:03:35.933 +01:00 [DBG] Loaded hosting startup assembly APIBank
2022-09-21 12:03:35.936 +01:00 [DBG] Loaded hosting startup assembly Microsoft.AspNetCore.Watch.BrowserRefresh
2022-09-21 12:03:35.937 +01:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.BrowserLink.Net
2022-09-21 12:03:35.938 +01:00 [INF] Application started. Press Ctrl+C to shut down.
2022-09-21 12:03:35.940 +01:00 [INF] Hosting environment: Development
2022-09-21 12:03:35.941 +01:00 [INF] Content root path: C:\Users\mguedesa\OneDrive - NTT DATA EMEAL\Documentos\GitHub\OpenBankAPI-NTT\APIBank\APIBank\
2022-09-21 12:03:35.942 +01:00 [DBG] Hosting started
2022-09-21 12:03:36.047 +01:00 [DBG] Connection id "0HMKRO3N4RB65" accepted.
2022-09-21 12:03:36.047 +01:00 [DBG] Connection id "0HMKRO3N4RB64" accepted.
2022-09-21 12:03:36.050 +01:00 [DBG] Connection id "0HMKRO3N4RB65" started.
2022-09-21 12:03:36.050 +01:00 [DBG] Connection id "0HMKRO3N4RB64" started.
2022-09-21 12:03:36.062 +01:00 [DBG] Connection id "0HMKRO3N4RB65" received FIN.
2022-09-21 12:03:36.062 +01:00 [DBG] Connection id "0HMKRO3N4RB64" received FIN.
2022-09-21 12:03:36.080 +01:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException:  Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveBlobAsync[TIOAdapter](TIOAdapter adapter)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](TIOAdapter adapter, Boolean receiveFirst, Byte[] reAuthenticationData, Boolean isApm)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2022-09-21 12:03:36.080 +01:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException:  Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveBlobAsync[TIOAdapter](TIOAdapter adapter)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](TIOAdapter adapter, Boolean receiveFirst, Byte[] reAuthenticationData, Boolean isApm)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2022-09-21 12:03:36.176 +01:00 [DBG] Connection id "0HMKRO3N4RB64" stopped.
2022-09-21 12:03:36.176 +01:00 [DBG] Connection id "0HMKRO3N4RB65" stopped.
2022-09-21 12:03:36.181 +01:00 [DBG] Connection id "0HMKRO3N4RB65" sending FIN because: "The Socket transport's send loop completed gracefully."
2022-09-21 12:03:36.181 +01:00 [DBG] Connection id "0HMKRO3N4RB64" sending FIN because: "The Socket transport's send loop completed gracefully."
2022-09-21 12:03:36.327 +01:00 [DBG] Connection id "0HMKRO3N4RB66" accepted.
2022-09-21 12:03:36.336 +01:00 [DBG] Connection id "0HMKRO3N4RB66" started.
2022-09-21 12:03:36.389 +01:00 [DBG] Connection 0HMKRO3N4RB66 established using the following protocol: "Tls12"
2022-09-21 12:03:36.505 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/swagger/index.html - -
2022-09-21 12:03:36.588 +01:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2022-09-21 12:03:36.662 +01:00 [DBG] No candidates found for the request path '/swagger/index.html'
2022-09-21 12:03:36.667 +01:00 [DBG] Request did not match any endpoints
2022-09-21 12:03:36.975 +01:00 [DBG] Response markup is scheduled to include browser refresh script injection.
2022-09-21 12:03:37.180 +01:00 [DBG] Response markup was updated to include browser refresh script injection.
2022-09-21 12:03:37.190 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/swagger/index.html - - - 200 - text/html;charset=utf-8 690.5049ms
2022-09-21 12:03:37.212 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/_vs/browserLink - -
2022-09-21 12:03:37.212 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/_framework/aspnetcore-browser-refresh.js - -
2022-09-21 12:03:37.224 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/_framework/aspnetcore-browser-refresh.js - - - 200 11984 application/javascript;+charset=utf-8 12.3076ms
2022-09-21 12:03:37.245 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/_vs/browserLink - - - 200 - text/javascript;+charset=UTF-8 33.4362ms
2022-09-21 12:03:37.348 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/swagger/v1/swagger.json - -
2022-09-21 12:03:37.354 +01:00 [DBG] No candidates found for the request path '/swagger/v1/swagger.json'
2022-09-21 12:03:37.359 +01:00 [DBG] Request did not match any endpoints
2022-09-21 12:03:37.573 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/swagger/v1/swagger.json - - - 200 - application/json;charset=utf-8 224.2884ms
2022-09-21 12:03:50.299 +01:00 [INF] Request starting HTTP/2 POST https://localhost:7036/api/Users/Login application/json 58
2022-09-21 12:03:50.320 +01:00 [DBG] 1 candidate(s) found for the request path '/api/Users/Login'
2022-09-21 12:03:50.327 +01:00 [DBG] Endpoint 'APIBank.Controllers.UsersController.Login (APIBank)' with route pattern 'api/Users/Login' is valid for the request path '/api/Users/Login'
2022-09-21 12:03:50.331 +01:00 [DBG] Request matched endpoint 'APIBank.Controllers.UsersController.Login (APIBank)'
2022-09-21 12:03:50.333 +01:00 [DBG] Static files was skipped as the request already matched an endpoint.
2022-09-21 12:03:50.820 +01:00 [INF] Executing endpoint 'APIBank.Controllers.UsersController.Login (APIBank)'
2022-09-21 12:03:50.854 +01:00 [INF] Route matched with {action = "Login", controller = "Users"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult Login(APIBank.Models.Requests.LoginRequest) on controller APIBank.Controllers.UsersController (APIBank).
2022-09-21 12:03:50.861 +01:00 [DBG] Execution plan of authorization filters (in the following order): ["APIBank.Authorization.AuthorizeAttribute"]
2022-09-21 12:03:50.863 +01:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2022-09-21 12:03:50.864 +01:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2022-09-21 12:03:50.866 +01:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2022-09-21 12:03:50.867 +01:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2022-09-21 12:03:50.869 +01:00 [DBG] Executing controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-21 12:03:50.870 +01:00 [DBG] Executed controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-21 12:03:50.888 +01:00 [DBG] Attempting to bind parameter 'model' of type 'APIBank.Models.Requests.LoginRequest' ...
2022-09-21 12:03:50.895 +01:00 [DBG] Attempting to bind parameter 'model' of type 'APIBank.Models.Requests.LoginRequest' using the name '' in request data ...
2022-09-21 12:03:50.898 +01:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2022-09-21 12:03:50.904 +01:00 [DBG] Connection id "0HMKRO3N4RB66", Request id "0HMKRO3N4RB66:00000009": started reading request body.
2022-09-21 12:03:50.908 +01:00 [DBG] Connection id "0HMKRO3N4RB66", Request id "0HMKRO3N4RB66:00000009": done reading request body.
2022-09-21 12:03:50.918 +01:00 [DBG] JSON input formatter succeeded, deserializing to type 'APIBank.Models.Requests.LoginRequest'
2022-09-21 12:03:50.920 +01:00 [DBG] Done attempting to bind parameter 'model' of type 'APIBank.Models.Requests.LoginRequest'.
2022-09-21 12:03:50.921 +01:00 [DBG] Done attempting to bind parameter 'model' of type 'APIBank.Models.Requests.LoginRequest'.
2022-09-21 12:03:50.922 +01:00 [DBG] Attempting to validate the bound parameter 'model' of type 'APIBank.Models.Requests.LoginRequest' ...
2022-09-21 12:03:50.935 +01:00 [DBG] Done attempting to validate the bound parameter 'model' of type 'APIBank.Models.Requests.LoginRequest'.
2022-09-21 12:03:51.099 +01:00 [DBG] An additional 'IServiceProvider' was created for internal use by Entity Framework. An existing service provider was not used due to the following configuration changes: configuration changed for 'Core:ConfigureWarnings', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:UseAdminDatabase', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:SetPostgresVersion', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:UseRedshift', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:ReverseNullOrdering', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:RemoteCertificateValidationCallback', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:ProvideClientCertificatesCallback', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:ProvidePasswordCallback'.
2022-09-21 12:03:52.740 +01:00 [INF] Entity Framework Core 6.0.9 initialized 'PostgresContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:6.0.7+5b98e4b74de93b590b44aef8dd7967c03acc433c' with options: None
2022-09-21 12:03:52.829 +01:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .SingleOrDefault(x => x.Username == __model_Username_0)'
2022-09-21 12:03:53.429 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<User>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: User.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: User.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 1], [Property: User.Email (string) Required Index MaxLength(254), 2], [Property: User.FullName (string) Required MaxLength(100), 3], [Property: User.PasswordChangedAt (DateTime) Required ValueGenerated.OnAdd, 4], [Property: User.PasswordHash (string) Required MaxLength(200), 5], [Property: User.Username (string) Required Index MaxLength(50), 6] }
        SELECT TOP(2) u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
        FROM users AS u
        WHERE u.username == @__model_Username_0), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, User>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)
    .SingleOrDefault()'
2022-09-21 12:03:53.510 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-21 12:03:53.623 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (107ms).
2022-09-21 12:03:53.635 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-21 12:03:53.951 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 12:03:53.980 +01:00 [DBG] Executing DbCommand [Parameters=[@__model_Username_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.username = @__model_Username_0
LIMIT 2
2022-09-21 12:03:54.117 +01:00 [INF] Executed DbCommand (148ms) [Parameters=[@__model_Username_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.username = @__model_Username_0
LIMIT 2
2022-09-21 12:03:54.184 +01:00 [DBG] Context 'PostgresContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 12:03:54.257 +01:00 [DBG] A data reader was disposed.
2022-09-21 12:03:54.267 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 12:03:54.288 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-21 12:03:54.765 +01:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .Any(user => user.RefreshTokenCollection
        .Any(reftoken => reftoken.RefToken == __token_0))'
2022-09-21 12:03:54.944 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<bool>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            EmptyProjectionMember -> 0
        SELECT EXISTS (
            SELECT 1
            FROM users AS u
            WHERE EXISTS (
                SELECT 1
                FROM refresh_token AS r
                WHERE ((u.id != NULL) && (u.id == r.user_id)) && (r.token == @__token_0)))), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, bool>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)
    .Single()'
2022-09-21 12:03:54.961 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-21 12:03:54.962 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2022-09-21 12:03:54.963 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-21 12:03:54.964 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 12:03:54.965 +01:00 [DBG] Executing DbCommand [Parameters=[@__token_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM users AS u
    WHERE EXISTS (
        SELECT 1
        FROM refresh_token AS r
        WHERE (u.id = r.user_id) AND (r.token = @__token_0)))
2022-09-21 12:03:54.968 +01:00 [INF] Executed DbCommand (3ms) [Parameters=[@__token_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM users AS u
    WHERE EXISTS (
        SELECT 1
        FROM refresh_token AS r
        WHERE (u.id = r.user_id) AND (r.token = @__token_0)))
2022-09-21 12:03:54.974 +01:00 [DBG] A data reader was disposed.
2022-09-21 12:03:54.975 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 12:03:54.975 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-21 12:03:54.986 +01:00 [DBG] Compiling query expression: 
'DbSet<RefreshToken>()
    .Where(rt => rt.UserId == __id_0)
    .AsNoTracking()
    .Select(rt => new RefreshToken{ 
        Id = rt.Id, 
        UserId = rt.UserId, 
        RefToken = rt.RefToken, 
        Expires = rt.Expires, 
        Created = rt.Created, 
        CreatedByIp = rt.CreatedByIp, 
        Revoked = rt.Revoked, 
        RevokedByIp = rt.RevokedByIp, 
        ReplacedByToken = rt.ReplacedByToken, 
        ReasonRevoked = rt.ReasonRevoked, 
        IsExpired = rt.IsExpired, 
        IsRevoked = rt.IsRevoked, 
        IsActive = rt.IsActive 
    }
    )'
2022-09-21 12:03:55.014 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<RefreshToken>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            Id -> 0
            UserId -> 1
            RefToken -> 2
            Expires -> 3
            Created -> 4
            CreatedByIp -> 5
            Revoked -> 6
            RevokedByIp -> 7
            ReplacedByToken -> 8
            ReasonRevoked -> 9
            IsExpired -> 10
            IsRevoked -> 11
            IsActive -> 12
        SELECT r.id AS Id, r.user_id AS UserId, r.token AS RefToken, r.expires AS Expires, r.created AS Created, r.created_by_ip AS CreatedByIp, r.revoked AS Revoked, r.revoked_by_ip AS RevokedByIp, r.replaced_by_token AS ReplacedByToken, r.reason_revoked AS ReasonRevoked, r.is_expired AS IsExpired, r.is_revoked AS IsRevoked, r.is_active AS IsActive
        FROM refresh_token AS r
        WHERE r.user_id == @__id_0), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, RefreshToken>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)'
2022-09-21 12:03:55.021 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-21 12:03:55.023 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (2ms).
2022-09-21 12:03:55.024 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-21 12:03:55.024 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 12:03:55.025 +01:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.user_id AS "UserId", r.token AS "RefToken", r.expires AS "Expires", r.created AS "Created", r.created_by_ip AS "CreatedByIp", r.revoked AS "Revoked", r.revoked_by_ip AS "RevokedByIp", r.replaced_by_token AS "ReplacedByToken", r.reason_revoked AS "ReasonRevoked", r.is_expired AS "IsExpired", r.is_revoked AS "IsRevoked", r.is_active AS "IsActive"
FROM refresh_token AS r
WHERE r.user_id = @__id_0
2022-09-21 12:03:55.032 +01:00 [INF] Executed DbCommand (7ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.user_id AS "UserId", r.token AS "RefToken", r.expires AS "Expires", r.created AS "Created", r.created_by_ip AS "CreatedByIp", r.revoked AS "Revoked", r.revoked_by_ip AS "RevokedByIp", r.replaced_by_token AS "ReplacedByToken", r.reason_revoked AS "ReasonRevoked", r.is_expired AS "IsExpired", r.is_revoked AS "IsRevoked", r.is_active AS "IsActive"
FROM refresh_token AS r
WHERE r.user_id = @__id_0
2022-09-21 12:03:55.034 +01:00 [DBG] A data reader was disposed.
2022-09-21 12:03:55.035 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 12:03:55.036 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-21 12:03:55.058 +01:00 [DBG] An entity of type 'User' tracked by 'PostgresContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 12:03:55.106 +01:00 [DBG] 'PostgresContext' generated a temporary value for the property 'Id.RefreshToken'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 12:03:55.161 +01:00 [DBG] Context 'PostgresContext' started tracking 'RefreshToken' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 12:03:55.171 +01:00 [DBG] SaveChanges starting for 'PostgresContext'.
2022-09-21 12:03:55.176 +01:00 [DBG] DetectChanges starting for 'PostgresContext'.
2022-09-21 12:03:55.233 +01:00 [DBG] 1 entities were added and 0 entities were removed from navigation 'User.RefreshTokenCollection'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 12:03:55.273 +01:00 [DBG] The foreign key property 'RefreshToken.UserId' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2022-09-21 12:03:55.308 +01:00 [DBG] DetectChanges completed for 'PostgresContext'.
2022-09-21 12:03:55.326 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-21 12:03:55.328 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 12:03:55.341 +01:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2022-09-21 12:03:55.359 +01:00 [DBG] Began transaction with isolation level 'ReadCommitted'.
2022-09-21 12:03:55.450 +01:00 [DBG] Executing 2 update commands as a batch.
2022-09-21 12:03:55.482 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-21 12:03:55.487 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (4ms).
2022-09-21 12:03:55.490 +01:00 [DBG] Executing DbCommand [Parameters=[@p0='?' (DbType = DateTime), @p1='?', @p2='?' (DbType = DateTime), @p3='?' (DbType = Boolean), @p4='?' (DbType = Boolean), @p5='?' (DbType = Boolean), @p6='?', @p7='?', @p8='?', @p9='?' (DbType = DateTime), @p10='?', @p11='?' (DbType = Int32), @p18='?' (DbType = Int32), @p12='?' (DbType = DateTime), @p13='?', @p14='?', @p15='?' (DbType = DateTime), @p16='?', @p17='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO refresh_token (created, created_by_ip, expires, is_active, is_expired, is_revoked, reason_revoked, token, replaced_by_token, revoked, revoked_by_ip, user_id)
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11)
RETURNING id;
UPDATE users SET created_at = @p12, email = @p13, full_name = @p14, password_changed_at = @p15, password_hash = @p16, username = @p17
WHERE id = @p18;
2022-09-21 12:03:55.505 +01:00 [INF] Executed DbCommand (16ms) [Parameters=[@p0='?' (DbType = DateTime), @p1='?', @p2='?' (DbType = DateTime), @p3='?' (DbType = Boolean), @p4='?' (DbType = Boolean), @p5='?' (DbType = Boolean), @p6='?', @p7='?', @p8='?', @p9='?' (DbType = DateTime), @p10='?', @p11='?' (DbType = Int32), @p18='?' (DbType = Int32), @p12='?' (DbType = DateTime), @p13='?', @p14='?', @p15='?' (DbType = DateTime), @p16='?', @p17='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO refresh_token (created, created_by_ip, expires, is_active, is_expired, is_revoked, reason_revoked, token, replaced_by_token, revoked, revoked_by_ip, user_id)
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11)
RETURNING id;
UPDATE users SET created_at = @p12, email = @p13, full_name = @p14, password_changed_at = @p15, password_hash = @p16, username = @p17
WHERE id = @p18;
2022-09-21 12:03:55.524 +01:00 [DBG] The foreign key property 'RefreshToken.Id' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2022-09-21 12:03:55.528 +01:00 [DBG] A data reader was disposed.
2022-09-21 12:03:55.539 +01:00 [DBG] Committing transaction.
2022-09-21 12:03:55.553 +01:00 [DBG] Committed transaction.
2022-09-21 12:03:55.555 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 12:03:55.557 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-21 12:03:55.560 +01:00 [DBG] Disposing transaction.
2022-09-21 12:03:55.565 +01:00 [DBG] An entity of type 'RefreshToken' tracked by 'PostgresContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 12:03:55.567 +01:00 [DBG] An entity of type 'User' tracked by 'PostgresContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 12:03:55.572 +01:00 [DBG] SaveChanges completed for 'PostgresContext' with 2 entities written to the database.
2022-09-21 12:03:55.579 +01:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2022-09-21 12:03:55.587 +01:00 [DBG] Attempting to select an output formatter based on Accept header '["text/plain"]'.
2022-09-21 12:03:55.588 +01:00 [DBG] Could not find an output formatter based on content negotiation. Accepted types were (["text/plain"])
2022-09-21 12:03:55.589 +01:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2022-09-21 12:03:55.590 +01:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2022-09-21 12:03:55.592 +01:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2022-09-21 12:03:55.593 +01:00 [INF] Executing OkObjectResult, writing value of type 'APIBank.Models.Users.Responses.LoginResponse'.
2022-09-21 12:03:55.610 +01:00 [INF] Executed action APIBank.Controllers.UsersController.Login (APIBank) in 4736.922ms
2022-09-21 12:03:55.611 +01:00 [INF] Executed endpoint 'APIBank.Controllers.UsersController.Login (APIBank)'
2022-09-21 12:03:55.616 +01:00 [DBG] 'PostgresContext' disposed.
2022-09-21 12:03:55.625 +01:00 [INF] Request finished HTTP/2 POST https://localhost:7036/api/Users/Login application/json 58 - 200 - application/json;+charset=utf-8 5326.2701ms
2022-09-21 12:04:09.539 +01:00 [INF] Request starting HTTP/2 POST https://localhost:7036/api/Users/refreshToken - 0
2022-09-21 12:04:09.545 +01:00 [DBG] 1 candidate(s) found for the request path '/api/Users/refreshToken'
2022-09-21 12:04:09.548 +01:00 [DBG] Endpoint 'APIBank.Controllers.UsersController.RefreshToken (APIBank)' with route pattern 'api/Users/refreshToken' is valid for the request path '/api/Users/refreshToken'
2022-09-21 12:04:09.550 +01:00 [DBG] Request matched endpoint 'APIBank.Controllers.UsersController.RefreshToken (APIBank)'
2022-09-21 12:04:09.551 +01:00 [DBG] Static files was skipped as the request already matched an endpoint.
2022-09-21 12:04:09.705 +01:00 [INF] Entity Framework Core 6.0.9 initialized 'PostgresContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:6.0.7+5b98e4b74de93b590b44aef8dd7967c03acc433c' with options: None
2022-09-21 12:04:09.722 +01:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .FirstOrDefault(e => EF.Property<int>(e, "Id") == __p_0)'
2022-09-21 12:04:09.733 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<User>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: User.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: User.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 1], [Property: User.Email (string) Required Index MaxLength(254), 2], [Property: User.FullName (string) Required MaxLength(100), 3], [Property: User.PasswordChangedAt (DateTime) Required ValueGenerated.OnAdd, 4], [Property: User.PasswordHash (string) Required MaxLength(200), 5], [Property: User.Username (string) Required Index MaxLength(50), 6] }
        SELECT TOP(1) u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
        FROM users AS u
        WHERE u.id == @__p_0), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, User>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)
    .SingleOrDefault()'
2022-09-21 12:04:09.736 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-21 12:04:09.738 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (2ms).
2022-09-21 12:04:09.739 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-21 12:04:09.740 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 12:04:09.741 +01:00 [DBG] Executing DbCommand [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.id = @__p_0
LIMIT 1
2022-09-21 12:04:09.746 +01:00 [INF] Executed DbCommand (5ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.id = @__p_0
LIMIT 1
2022-09-21 12:04:09.748 +01:00 [DBG] Context 'PostgresContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 12:04:09.749 +01:00 [DBG] A data reader was disposed.
2022-09-21 12:04:09.749 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 12:04:09.750 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-21 12:04:09.751 +01:00 [INF] Executing endpoint 'APIBank.Controllers.UsersController.RefreshToken (APIBank)'
2022-09-21 12:04:09.752 +01:00 [INF] Route matched with {action = "RefreshToken", controller = "Users"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult RefreshToken() on controller APIBank.Controllers.UsersController (APIBank).
2022-09-21 12:04:09.755 +01:00 [DBG] Execution plan of authorization filters (in the following order): ["APIBank.Authorization.AuthorizeAttribute"]
2022-09-21 12:04:09.756 +01:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2022-09-21 12:04:09.757 +01:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2022-09-21 12:04:09.759 +01:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2022-09-21 12:04:09.762 +01:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2022-09-21 12:04:09.763 +01:00 [DBG] Executing controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-21 12:04:09.764 +01:00 [DBG] Executed controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-21 12:04:26.487 +01:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .SingleOrDefault(userQuery => userQuery.RefreshTokenCollection
        .Any(refTokenQuery => refTokenQuery.RefToken == __refToken_0))'
2022-09-21 12:04:26.495 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<User>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: User.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: User.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 1], [Property: User.Email (string) Required Index MaxLength(254), 2], [Property: User.FullName (string) Required MaxLength(100), 3], [Property: User.PasswordChangedAt (DateTime) Required ValueGenerated.OnAdd, 4], [Property: User.PasswordHash (string) Required MaxLength(200), 5], [Property: User.Username (string) Required Index MaxLength(50), 6] }
        SELECT TOP(2) u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
        FROM users AS u
        WHERE EXISTS (
            SELECT 1
            FROM refresh_token AS r
            WHERE ((u.id != NULL) && (u.id == r.user_id)) && (r.token == @__refToken_0))), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, User>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)
    .SingleOrDefault()'
2022-09-21 12:04:26.497 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-21 12:04:26.498 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2022-09-21 12:04:26.498 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-21 12:04:26.499 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 12:04:26.500 +01:00 [DBG] Executing DbCommand [Parameters=[@__refToken_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE EXISTS (
    SELECT 1
    FROM refresh_token AS r
    WHERE (u.id = r.user_id) AND (r.token = @__refToken_0))
LIMIT 2
2022-09-21 12:04:26.502 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[@__refToken_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE EXISTS (
    SELECT 1
    FROM refresh_token AS r
    WHERE (u.id = r.user_id) AND (r.token = @__refToken_0))
LIMIT 2
2022-09-21 12:04:26.503 +01:00 [DBG] A data reader was disposed.
2022-09-21 12:04:26.504 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 12:04:26.505 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-21 12:04:37.887 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-21 12:04:37.889 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (2ms).
2022-09-21 12:04:37.890 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-21 12:04:37.892 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 12:04:37.893 +01:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.user_id AS "UserId", r.token AS "RefToken", r.expires AS "Expires", r.created AS "Created", r.created_by_ip AS "CreatedByIp", r.revoked AS "Revoked", r.revoked_by_ip AS "RevokedByIp", r.replaced_by_token AS "ReplacedByToken", r.reason_revoked AS "ReasonRevoked", r.is_expired AS "IsExpired", r.is_revoked AS "IsRevoked", r.is_active AS "IsActive"
FROM refresh_token AS r
WHERE r.user_id = @__id_0
2022-09-21 12:04:37.896 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.user_id AS "UserId", r.token AS "RefToken", r.expires AS "Expires", r.created AS "Created", r.created_by_ip AS "CreatedByIp", r.revoked AS "Revoked", r.revoked_by_ip AS "RevokedByIp", r.replaced_by_token AS "ReplacedByToken", r.reason_revoked AS "ReasonRevoked", r.is_expired AS "IsExpired", r.is_revoked AS "IsRevoked", r.is_active AS "IsActive"
FROM refresh_token AS r
WHERE r.user_id = @__id_0
2022-09-21 12:04:37.900 +01:00 [DBG] A data reader was disposed.
2022-09-21 12:04:37.901 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 12:04:37.902 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-21 12:04:58.711 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-21 12:04:58.717 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (5ms).
2022-09-21 12:04:58.720 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-21 12:04:58.720 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 12:04:58.721 +01:00 [DBG] Executing DbCommand [Parameters=[@__token_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM users AS u
    WHERE EXISTS (
        SELECT 1
        FROM refresh_token AS r
        WHERE (u.id = r.user_id) AND (r.token = @__token_0)))
2022-09-21 12:04:58.724 +01:00 [INF] Executed DbCommand (3ms) [Parameters=[@__token_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM users AS u
    WHERE EXISTS (
        SELECT 1
        FROM refresh_token AS r
        WHERE (u.id = r.user_id) AND (r.token = @__token_0)))
2022-09-21 12:04:58.726 +01:00 [DBG] A data reader was disposed.
2022-09-21 12:04:58.727 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 12:04:58.728 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-21 12:05:26.141 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-21 12:05:26.144 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (2ms).
2022-09-21 12:05:26.146 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-21 12:05:26.147 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 12:05:26.148 +01:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.user_id AS "UserId", r.token AS "RefToken", r.expires AS "Expires", r.created AS "Created", r.created_by_ip AS "CreatedByIp", r.revoked AS "Revoked", r.revoked_by_ip AS "RevokedByIp", r.replaced_by_token AS "ReplacedByToken", r.reason_revoked AS "ReasonRevoked", r.is_expired AS "IsExpired", r.is_revoked AS "IsRevoked", r.is_active AS "IsActive"
FROM refresh_token AS r
WHERE r.user_id = @__id_0
2022-09-21 12:05:26.150 +01:00 [INF] Executed DbCommand (3ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.user_id AS "UserId", r.token AS "RefToken", r.expires AS "Expires", r.created AS "Created", r.created_by_ip AS "CreatedByIp", r.revoked AS "Revoked", r.revoked_by_ip AS "RevokedByIp", r.replaced_by_token AS "ReplacedByToken", r.reason_revoked AS "ReasonRevoked", r.is_expired AS "IsExpired", r.is_revoked AS "IsRevoked", r.is_active AS "IsActive"
FROM refresh_token AS r
WHERE r.user_id = @__id_0
2022-09-21 12:05:26.176 +01:00 [DBG] A data reader was disposed.
2022-09-21 12:05:26.177 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 12:05:26.178 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-21 12:06:55.397 +01:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2022-09-21 12:06:55.771 +01:00 [DBG] Hosting starting
2022-09-21 12:06:55.949 +01:00 [DBG] Using development certificate: CN=localhost (Thumbprint: 9CC642E9838495A6C3C202DECA6A8AD300396DD2)
2022-09-21 12:06:55.995 +01:00 [INF] Now listening on: https://localhost:7036
2022-09-21 12:06:55.996 +01:00 [INF] Now listening on: http://localhost:5036
2022-09-21 12:06:55.997 +01:00 [DBG] Loaded hosting startup assembly APIBank
2022-09-21 12:06:55.997 +01:00 [DBG] Loaded hosting startup assembly Microsoft.AspNetCore.Watch.BrowserRefresh
2022-09-21 12:06:55.998 +01:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.BrowserLink.Net
2022-09-21 12:06:55.999 +01:00 [INF] Application started. Press Ctrl+C to shut down.
2022-09-21 12:06:56.000 +01:00 [INF] Hosting environment: Development
2022-09-21 12:06:56.000 +01:00 [INF] Content root path: C:\Users\mguedesa\OneDrive - NTT DATA EMEAL\Documentos\GitHub\OpenBankAPI-NTT\APIBank\APIBank\
2022-09-21 12:06:56.001 +01:00 [DBG] Hosting started
2022-09-21 12:06:56.160 +01:00 [DBG] Connection id "0HMKRO5IP8H93" accepted.
2022-09-21 12:06:56.160 +01:00 [DBG] Connection id "0HMKRO5IP8H92" accepted.
2022-09-21 12:06:56.163 +01:00 [DBG] Connection id "0HMKRO5IP8H92" started.
2022-09-21 12:06:56.163 +01:00 [DBG] Connection id "0HMKRO5IP8H93" started.
2022-09-21 12:06:56.176 +01:00 [DBG] Connection id "0HMKRO5IP8H93" received FIN.
2022-09-21 12:06:56.176 +01:00 [DBG] Connection id "0HMKRO5IP8H92" received FIN.
2022-09-21 12:06:56.199 +01:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException:  Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveBlobAsync[TIOAdapter](TIOAdapter adapter)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](TIOAdapter adapter, Boolean receiveFirst, Byte[] reAuthenticationData, Boolean isApm)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2022-09-21 12:06:56.199 +01:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException:  Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveBlobAsync[TIOAdapter](TIOAdapter adapter)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](TIOAdapter adapter, Boolean receiveFirst, Byte[] reAuthenticationData, Boolean isApm)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2022-09-21 12:06:56.251 +01:00 [DBG] Connection id "0HMKRO5IP8H92" stopped.
2022-09-21 12:06:56.251 +01:00 [DBG] Connection id "0HMKRO5IP8H93" stopped.
2022-09-21 12:06:56.254 +01:00 [DBG] Connection id "0HMKRO5IP8H93" sending FIN because: "The Socket transport's send loop completed gracefully."
2022-09-21 12:06:56.254 +01:00 [DBG] Connection id "0HMKRO5IP8H92" sending FIN because: "The Socket transport's send loop completed gracefully."
2022-09-21 12:06:56.576 +01:00 [DBG] Connection id "0HMKRO5IP8H94" accepted.
2022-09-21 12:06:56.617 +01:00 [DBG] Connection id "0HMKRO5IP8H94" started.
2022-09-21 12:06:56.743 +01:00 [DBG] Connection 0HMKRO5IP8H94 established using the following protocol: "Tls12"
2022-09-21 12:06:56.868 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/swagger/index.html - -
2022-09-21 12:06:56.935 +01:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2022-09-21 12:06:56.987 +01:00 [DBG] No candidates found for the request path '/swagger/index.html'
2022-09-21 12:06:56.989 +01:00 [DBG] Request did not match any endpoints
2022-09-21 12:06:57.134 +01:00 [DBG] Response markup is scheduled to include browser refresh script injection.
2022-09-21 12:06:57.304 +01:00 [DBG] Response markup was updated to include browser refresh script injection.
2022-09-21 12:06:57.314 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/swagger/index.html - - - 200 - text/html;charset=utf-8 455.6613ms
2022-09-21 12:06:57.337 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/_vs/browserLink - -
2022-09-21 12:06:57.337 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/_framework/aspnetcore-browser-refresh.js - -
2022-09-21 12:06:57.350 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/_framework/aspnetcore-browser-refresh.js - - - 200 11984 application/javascript;+charset=utf-8 12.7369ms
2022-09-21 12:06:57.369 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/_vs/browserLink - - - 200 - text/javascript;+charset=UTF-8 32.5406ms
2022-09-21 12:06:57.454 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/swagger/v1/swagger.json - -
2022-09-21 12:06:57.456 +01:00 [DBG] No candidates found for the request path '/swagger/v1/swagger.json'
2022-09-21 12:06:57.456 +01:00 [DBG] Request did not match any endpoints
2022-09-21 12:06:57.648 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/swagger/v1/swagger.json - - - 200 - application/json;charset=utf-8 193.8976ms
2022-09-21 12:07:08.743 +01:00 [INF] Request starting HTTP/2 POST https://localhost:7036/api/Users/Login application/json 58
2022-09-21 12:07:08.758 +01:00 [DBG] 1 candidate(s) found for the request path '/api/Users/Login'
2022-09-21 12:07:08.763 +01:00 [DBG] Endpoint 'APIBank.Controllers.UsersController.Login (APIBank)' with route pattern 'api/Users/Login' is valid for the request path '/api/Users/Login'
2022-09-21 12:07:08.767 +01:00 [DBG] Request matched endpoint 'APIBank.Controllers.UsersController.Login (APIBank)'
2022-09-21 12:07:08.771 +01:00 [DBG] Static files was skipped as the request already matched an endpoint.
2022-09-21 12:07:09.243 +01:00 [INF] Executing endpoint 'APIBank.Controllers.UsersController.Login (APIBank)'
2022-09-21 12:07:09.273 +01:00 [INF] Route matched with {action = "Login", controller = "Users"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult Login(APIBank.Models.Requests.LoginRequest) on controller APIBank.Controllers.UsersController (APIBank).
2022-09-21 12:07:09.276 +01:00 [DBG] Execution plan of authorization filters (in the following order): ["APIBank.Authorization.AuthorizeAttribute"]
2022-09-21 12:07:09.277 +01:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2022-09-21 12:07:09.279 +01:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2022-09-21 12:07:09.281 +01:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2022-09-21 12:07:09.282 +01:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2022-09-21 12:07:09.287 +01:00 [DBG] Executing controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-21 12:07:09.290 +01:00 [DBG] Executed controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-21 12:07:09.310 +01:00 [DBG] Attempting to bind parameter 'model' of type 'APIBank.Models.Requests.LoginRequest' ...
2022-09-21 12:07:09.314 +01:00 [DBG] Attempting to bind parameter 'model' of type 'APIBank.Models.Requests.LoginRequest' using the name '' in request data ...
2022-09-21 12:07:09.316 +01:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2022-09-21 12:07:09.325 +01:00 [DBG] Connection id "0HMKRO5IP8H94", Request id "0HMKRO5IP8H94:00000009": started reading request body.
2022-09-21 12:07:09.328 +01:00 [DBG] Connection id "0HMKRO5IP8H94", Request id "0HMKRO5IP8H94:00000009": done reading request body.
2022-09-21 12:07:09.337 +01:00 [DBG] JSON input formatter succeeded, deserializing to type 'APIBank.Models.Requests.LoginRequest'
2022-09-21 12:07:09.340 +01:00 [DBG] Done attempting to bind parameter 'model' of type 'APIBank.Models.Requests.LoginRequest'.
2022-09-21 12:07:09.342 +01:00 [DBG] Done attempting to bind parameter 'model' of type 'APIBank.Models.Requests.LoginRequest'.
2022-09-21 12:07:09.344 +01:00 [DBG] Attempting to validate the bound parameter 'model' of type 'APIBank.Models.Requests.LoginRequest' ...
2022-09-21 12:07:09.360 +01:00 [DBG] Done attempting to validate the bound parameter 'model' of type 'APIBank.Models.Requests.LoginRequest'.
2022-09-21 12:07:09.506 +01:00 [DBG] An additional 'IServiceProvider' was created for internal use by Entity Framework. An existing service provider was not used due to the following configuration changes: configuration changed for 'Core:ConfigureWarnings', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:UseAdminDatabase', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:SetPostgresVersion', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:UseRedshift', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:ReverseNullOrdering', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:RemoteCertificateValidationCallback', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:ProvideClientCertificatesCallback', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:ProvidePasswordCallback'.
2022-09-21 12:07:11.095 +01:00 [INF] Entity Framework Core 6.0.9 initialized 'PostgresContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:6.0.7+5b98e4b74de93b590b44aef8dd7967c03acc433c' with options: None
2022-09-21 12:07:11.189 +01:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .SingleOrDefault(x => x.Username == __model_Username_0)'
2022-09-21 12:07:11.792 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<User>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: User.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: User.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 1], [Property: User.Email (string) Required Index MaxLength(254), 2], [Property: User.FullName (string) Required MaxLength(100), 3], [Property: User.PasswordChangedAt (DateTime) Required ValueGenerated.OnAdd, 4], [Property: User.PasswordHash (string) Required MaxLength(200), 5], [Property: User.Username (string) Required Index MaxLength(50), 6] }
        SELECT TOP(2) u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
        FROM users AS u
        WHERE u.username == @__model_Username_0), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, User>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)
    .SingleOrDefault()'
2022-09-21 12:07:11.886 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-21 12:07:12.060 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (160ms).
2022-09-21 12:07:12.075 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-21 12:07:12.517 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 12:07:12.540 +01:00 [DBG] Executing DbCommand [Parameters=[@__model_Username_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.username = @__model_Username_0
LIMIT 2
2022-09-21 12:07:12.681 +01:00 [INF] Executed DbCommand (144ms) [Parameters=[@__model_Username_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.username = @__model_Username_0
LIMIT 2
2022-09-21 12:07:12.748 +01:00 [DBG] Context 'PostgresContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 12:07:12.857 +01:00 [DBG] A data reader was disposed.
2022-09-21 12:07:12.866 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 12:07:12.879 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-21 12:07:13.371 +01:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .Any(user => user.RefreshTokenCollection
        .Any(reftoken => reftoken.RefToken == __token_0))'
2022-09-21 12:07:13.547 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<bool>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            EmptyProjectionMember -> 0
        SELECT EXISTS (
            SELECT 1
            FROM users AS u
            WHERE EXISTS (
                SELECT 1
                FROM refresh_token AS r
                WHERE ((u.id != NULL) && (u.id == r.user_id)) && (r.token == @__token_0)))), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, bool>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)
    .Single()'
2022-09-21 12:07:13.562 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-21 12:07:13.566 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (3ms).
2022-09-21 12:07:13.567 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-21 12:07:13.568 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 12:07:13.570 +01:00 [DBG] Executing DbCommand [Parameters=[@__token_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM users AS u
    WHERE EXISTS (
        SELECT 1
        FROM refresh_token AS r
        WHERE (u.id = r.user_id) AND (r.token = @__token_0)))
2022-09-21 12:07:13.574 +01:00 [INF] Executed DbCommand (5ms) [Parameters=[@__token_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM users AS u
    WHERE EXISTS (
        SELECT 1
        FROM refresh_token AS r
        WHERE (u.id = r.user_id) AND (r.token = @__token_0)))
2022-09-21 12:07:13.582 +01:00 [DBG] A data reader was disposed.
2022-09-21 12:07:13.584 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 12:07:13.585 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-21 12:07:13.600 +01:00 [DBG] Compiling query expression: 
'DbSet<RefreshToken>()
    .Where(rt => rt.UserId == __id_0)
    .AsNoTracking()
    .Select(rt => new RefreshToken{ 
        Id = rt.Id, 
        UserId = rt.UserId, 
        RefToken = rt.RefToken, 
        Expires = rt.Expires, 
        Created = rt.Created, 
        CreatedByIp = rt.CreatedByIp, 
        Revoked = rt.Revoked, 
        RevokedByIp = rt.RevokedByIp, 
        ReplacedByToken = rt.ReplacedByToken, 
        ReasonRevoked = rt.ReasonRevoked, 
        IsExpired = rt.IsExpired, 
        IsRevoked = rt.IsRevoked, 
        IsActive = rt.IsActive 
    }
    )'
2022-09-21 12:07:13.626 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<RefreshToken>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            Id -> 0
            UserId -> 1
            RefToken -> 2
            Expires -> 3
            Created -> 4
            CreatedByIp -> 5
            Revoked -> 6
            RevokedByIp -> 7
            ReplacedByToken -> 8
            ReasonRevoked -> 9
            IsExpired -> 10
            IsRevoked -> 11
            IsActive -> 12
        SELECT r.id AS Id, r.user_id AS UserId, r.token AS RefToken, r.expires AS Expires, r.created AS Created, r.created_by_ip AS CreatedByIp, r.revoked AS Revoked, r.revoked_by_ip AS RevokedByIp, r.replaced_by_token AS ReplacedByToken, r.reason_revoked AS ReasonRevoked, r.is_expired AS IsExpired, r.is_revoked AS IsRevoked, r.is_active AS IsActive
        FROM refresh_token AS r
        WHERE r.user_id == @__id_0), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, RefreshToken>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)'
2022-09-21 12:07:13.631 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-21 12:07:13.632 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2022-09-21 12:07:13.633 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-21 12:07:13.635 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 12:07:13.636 +01:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.user_id AS "UserId", r.token AS "RefToken", r.expires AS "Expires", r.created AS "Created", r.created_by_ip AS "CreatedByIp", r.revoked AS "Revoked", r.revoked_by_ip AS "RevokedByIp", r.replaced_by_token AS "ReplacedByToken", r.reason_revoked AS "ReasonRevoked", r.is_expired AS "IsExpired", r.is_revoked AS "IsRevoked", r.is_active AS "IsActive"
FROM refresh_token AS r
WHERE r.user_id = @__id_0
2022-09-21 12:07:13.644 +01:00 [INF] Executed DbCommand (8ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.user_id AS "UserId", r.token AS "RefToken", r.expires AS "Expires", r.created AS "Created", r.created_by_ip AS "CreatedByIp", r.revoked AS "Revoked", r.revoked_by_ip AS "RevokedByIp", r.replaced_by_token AS "ReplacedByToken", r.reason_revoked AS "ReasonRevoked", r.is_expired AS "IsExpired", r.is_revoked AS "IsRevoked", r.is_active AS "IsActive"
FROM refresh_token AS r
WHERE r.user_id = @__id_0
2022-09-21 12:07:13.648 +01:00 [DBG] A data reader was disposed.
2022-09-21 12:07:13.649 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 12:07:13.650 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-21 12:07:13.667 +01:00 [DBG] An entity of type 'User' tracked by 'PostgresContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 12:07:13.711 +01:00 [DBG] 'PostgresContext' generated a temporary value for the property 'Id.RefreshToken'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 12:07:13.766 +01:00 [DBG] Context 'PostgresContext' started tracking 'RefreshToken' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 12:07:13.775 +01:00 [DBG] SaveChanges starting for 'PostgresContext'.
2022-09-21 12:07:13.781 +01:00 [DBG] DetectChanges starting for 'PostgresContext'.
2022-09-21 12:07:13.818 +01:00 [DBG] 1 entities were added and 0 entities were removed from navigation 'User.RefreshTokenCollection'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 12:07:13.847 +01:00 [DBG] The foreign key property 'RefreshToken.UserId' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2022-09-21 12:07:13.872 +01:00 [DBG] DetectChanges completed for 'PostgresContext'.
2022-09-21 12:07:13.884 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-21 12:07:13.886 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 12:07:13.889 +01:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2022-09-21 12:07:13.898 +01:00 [DBG] Began transaction with isolation level 'ReadCommitted'.
2022-09-21 12:07:13.979 +01:00 [DBG] Executing 2 update commands as a batch.
2022-09-21 12:07:14.003 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-21 12:07:14.006 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (2ms).
2022-09-21 12:07:14.007 +01:00 [DBG] Executing DbCommand [Parameters=[@p0='?' (DbType = DateTime), @p1='?', @p2='?' (DbType = DateTime), @p3='?' (DbType = Boolean), @p4='?' (DbType = Boolean), @p5='?' (DbType = Boolean), @p6='?', @p7='?', @p8='?', @p9='?' (DbType = DateTime), @p10='?', @p11='?' (DbType = Int32), @p18='?' (DbType = Int32), @p12='?' (DbType = DateTime), @p13='?', @p14='?', @p15='?' (DbType = DateTime), @p16='?', @p17='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO refresh_token (created, created_by_ip, expires, is_active, is_expired, is_revoked, reason_revoked, token, replaced_by_token, revoked, revoked_by_ip, user_id)
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11)
RETURNING id;
UPDATE users SET created_at = @p12, email = @p13, full_name = @p14, password_changed_at = @p15, password_hash = @p16, username = @p17
WHERE id = @p18;
2022-09-21 12:07:14.022 +01:00 [INF] Executed DbCommand (14ms) [Parameters=[@p0='?' (DbType = DateTime), @p1='?', @p2='?' (DbType = DateTime), @p3='?' (DbType = Boolean), @p4='?' (DbType = Boolean), @p5='?' (DbType = Boolean), @p6='?', @p7='?', @p8='?', @p9='?' (DbType = DateTime), @p10='?', @p11='?' (DbType = Int32), @p18='?' (DbType = Int32), @p12='?' (DbType = DateTime), @p13='?', @p14='?', @p15='?' (DbType = DateTime), @p16='?', @p17='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO refresh_token (created, created_by_ip, expires, is_active, is_expired, is_revoked, reason_revoked, token, replaced_by_token, revoked, revoked_by_ip, user_id)
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11)
RETURNING id;
UPDATE users SET created_at = @p12, email = @p13, full_name = @p14, password_changed_at = @p15, password_hash = @p16, username = @p17
WHERE id = @p18;
2022-09-21 12:07:14.048 +01:00 [DBG] The foreign key property 'RefreshToken.Id' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2022-09-21 12:07:14.053 +01:00 [DBG] A data reader was disposed.
2022-09-21 12:07:14.058 +01:00 [DBG] Committing transaction.
2022-09-21 12:07:14.069 +01:00 [DBG] Committed transaction.
2022-09-21 12:07:14.071 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 12:07:14.073 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-21 12:07:14.075 +01:00 [DBG] Disposing transaction.
2022-09-21 12:07:14.081 +01:00 [DBG] An entity of type 'RefreshToken' tracked by 'PostgresContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 12:07:14.083 +01:00 [DBG] An entity of type 'User' tracked by 'PostgresContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 12:07:14.085 +01:00 [DBG] SaveChanges completed for 'PostgresContext' with 2 entities written to the database.
2022-09-21 12:07:14.090 +01:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2022-09-21 12:07:14.098 +01:00 [DBG] Attempting to select an output formatter based on Accept header '["text/plain"]'.
2022-09-21 12:07:14.099 +01:00 [DBG] Could not find an output formatter based on content negotiation. Accepted types were (["text/plain"])
2022-09-21 12:07:14.100 +01:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2022-09-21 12:07:14.101 +01:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2022-09-21 12:07:14.102 +01:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2022-09-21 12:07:14.103 +01:00 [INF] Executing OkObjectResult, writing value of type 'APIBank.Models.Users.Responses.LoginResponse'.
2022-09-21 12:07:14.120 +01:00 [INF] Executed action APIBank.Controllers.UsersController.Login (APIBank) in 4830.1849ms
2022-09-21 12:07:14.122 +01:00 [INF] Executed endpoint 'APIBank.Controllers.UsersController.Login (APIBank)'
2022-09-21 12:07:14.129 +01:00 [DBG] 'PostgresContext' disposed.
2022-09-21 12:07:14.137 +01:00 [INF] Request finished HTTP/2 POST https://localhost:7036/api/Users/Login application/json 58 - 200 - application/json;+charset=utf-8 5393.1999ms
2022-09-21 12:07:33.142 +01:00 [INF] Request starting HTTP/2 POST https://localhost:7036/api/Users/refreshToken - 0
2022-09-21 12:07:33.146 +01:00 [DBG] 1 candidate(s) found for the request path '/api/Users/refreshToken'
2022-09-21 12:07:33.148 +01:00 [DBG] Endpoint 'APIBank.Controllers.UsersController.RefreshToken (APIBank)' with route pattern 'api/Users/refreshToken' is valid for the request path '/api/Users/refreshToken'
2022-09-21 12:07:33.152 +01:00 [DBG] Request matched endpoint 'APIBank.Controllers.UsersController.RefreshToken (APIBank)'
2022-09-21 12:07:33.153 +01:00 [DBG] Static files was skipped as the request already matched an endpoint.
2022-09-21 12:07:33.298 +01:00 [INF] Entity Framework Core 6.0.9 initialized 'PostgresContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:6.0.7+5b98e4b74de93b590b44aef8dd7967c03acc433c' with options: None
2022-09-21 12:07:33.309 +01:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .FirstOrDefault(e => EF.Property<int>(e, "Id") == __p_0)'
2022-09-21 12:07:33.315 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<User>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: User.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: User.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 1], [Property: User.Email (string) Required Index MaxLength(254), 2], [Property: User.FullName (string) Required MaxLength(100), 3], [Property: User.PasswordChangedAt (DateTime) Required ValueGenerated.OnAdd, 4], [Property: User.PasswordHash (string) Required MaxLength(200), 5], [Property: User.Username (string) Required Index MaxLength(50), 6] }
        SELECT TOP(1) u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
        FROM users AS u
        WHERE u.id == @__p_0), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, User>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)
    .SingleOrDefault()'
2022-09-21 12:07:33.316 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-21 12:07:33.317 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2022-09-21 12:07:33.318 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-21 12:07:33.319 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 12:07:33.321 +01:00 [DBG] Executing DbCommand [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.id = @__p_0
LIMIT 1
2022-09-21 12:07:33.323 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.id = @__p_0
LIMIT 1
2022-09-21 12:07:33.325 +01:00 [DBG] Context 'PostgresContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 12:07:33.326 +01:00 [DBG] A data reader was disposed.
2022-09-21 12:07:33.326 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 12:07:33.327 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-21 12:07:33.330 +01:00 [INF] Executing endpoint 'APIBank.Controllers.UsersController.RefreshToken (APIBank)'
2022-09-21 12:07:33.333 +01:00 [INF] Route matched with {action = "RefreshToken", controller = "Users"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult RefreshToken() on controller APIBank.Controllers.UsersController (APIBank).
2022-09-21 12:07:33.336 +01:00 [DBG] Execution plan of authorization filters (in the following order): ["APIBank.Authorization.AuthorizeAttribute"]
2022-09-21 12:07:33.338 +01:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2022-09-21 12:07:33.339 +01:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2022-09-21 12:07:33.340 +01:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2022-09-21 12:07:33.341 +01:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2022-09-21 12:07:33.342 +01:00 [DBG] Executing controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-21 12:07:33.343 +01:00 [DBG] Executed controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-21 12:07:45.479 +01:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .SingleOrDefault(userQuery => userQuery.RefreshTokenCollection
        .Any(refTokenQuery => refTokenQuery.RefToken == __refToken_0))'
2022-09-21 12:07:45.487 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<User>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: User.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: User.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 1], [Property: User.Email (string) Required Index MaxLength(254), 2], [Property: User.FullName (string) Required MaxLength(100), 3], [Property: User.PasswordChangedAt (DateTime) Required ValueGenerated.OnAdd, 4], [Property: User.PasswordHash (string) Required MaxLength(200), 5], [Property: User.Username (string) Required Index MaxLength(50), 6] }
        SELECT TOP(2) u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
        FROM users AS u
        WHERE EXISTS (
            SELECT 1
            FROM refresh_token AS r
            WHERE ((u.id != NULL) && (u.id == r.user_id)) && (r.token == @__refToken_0))), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, User>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)
    .SingleOrDefault()'
2022-09-21 12:07:45.490 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-21 12:07:45.491 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2022-09-21 12:07:45.492 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-21 12:07:45.493 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 12:07:45.493 +01:00 [DBG] Executing DbCommand [Parameters=[@__refToken_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE EXISTS (
    SELECT 1
    FROM refresh_token AS r
    WHERE (u.id = r.user_id) AND (r.token = @__refToken_0))
LIMIT 2
2022-09-21 12:07:45.496 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[@__refToken_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE EXISTS (
    SELECT 1
    FROM refresh_token AS r
    WHERE (u.id = r.user_id) AND (r.token = @__refToken_0))
LIMIT 2
2022-09-21 12:07:45.498 +01:00 [DBG] A data reader was disposed.
2022-09-21 12:07:45.498 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 12:07:45.499 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-21 12:07:47.855 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-21 12:07:47.857 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2022-09-21 12:07:47.858 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-21 12:07:47.860 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 12:07:47.861 +01:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.user_id AS "UserId", r.token AS "RefToken", r.expires AS "Expires", r.created AS "Created", r.created_by_ip AS "CreatedByIp", r.revoked AS "Revoked", r.revoked_by_ip AS "RevokedByIp", r.replaced_by_token AS "ReplacedByToken", r.reason_revoked AS "ReasonRevoked", r.is_expired AS "IsExpired", r.is_revoked AS "IsRevoked", r.is_active AS "IsActive"
FROM refresh_token AS r
WHERE r.user_id = @__id_0
2022-09-21 12:07:47.862 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.user_id AS "UserId", r.token AS "RefToken", r.expires AS "Expires", r.created AS "Created", r.created_by_ip AS "CreatedByIp", r.revoked AS "Revoked", r.revoked_by_ip AS "RevokedByIp", r.replaced_by_token AS "ReplacedByToken", r.reason_revoked AS "ReasonRevoked", r.is_expired AS "IsExpired", r.is_revoked AS "IsRevoked", r.is_active AS "IsActive"
FROM refresh_token AS r
WHERE r.user_id = @__id_0
2022-09-21 12:07:47.864 +01:00 [DBG] A data reader was disposed.
2022-09-21 12:07:47.864 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 12:07:47.865 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-21 12:08:17.876 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-21 12:08:17.879 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (3ms).
2022-09-21 12:08:17.882 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-21 12:08:17.882 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 12:08:17.883 +01:00 [DBG] Executing DbCommand [Parameters=[@__token_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM users AS u
    WHERE EXISTS (
        SELECT 1
        FROM refresh_token AS r
        WHERE (u.id = r.user_id) AND (r.token = @__token_0)))
2022-09-21 12:08:17.885 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[@__token_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM users AS u
    WHERE EXISTS (
        SELECT 1
        FROM refresh_token AS r
        WHERE (u.id = r.user_id) AND (r.token = @__token_0)))
2022-09-21 12:08:17.887 +01:00 [DBG] A data reader was disposed.
2022-09-21 12:08:17.887 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 12:08:17.889 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-21 12:08:47.774 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-21 12:08:47.778 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (3ms).
2022-09-21 12:08:47.779 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-21 12:08:47.781 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 12:08:47.783 +01:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.user_id AS "UserId", r.token AS "RefToken", r.expires AS "Expires", r.created AS "Created", r.created_by_ip AS "CreatedByIp", r.revoked AS "Revoked", r.revoked_by_ip AS "RevokedByIp", r.replaced_by_token AS "ReplacedByToken", r.reason_revoked AS "ReasonRevoked", r.is_expired AS "IsExpired", r.is_revoked AS "IsRevoked", r.is_active AS "IsActive"
FROM refresh_token AS r
WHERE r.user_id = @__id_0
2022-09-21 12:08:47.785 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.user_id AS "UserId", r.token AS "RefToken", r.expires AS "Expires", r.created AS "Created", r.created_by_ip AS "CreatedByIp", r.revoked AS "Revoked", r.revoked_by_ip AS "RevokedByIp", r.replaced_by_token AS "ReplacedByToken", r.reason_revoked AS "ReasonRevoked", r.is_expired AS "IsExpired", r.is_revoked AS "IsRevoked", r.is_active AS "IsActive"
FROM refresh_token AS r
WHERE r.user_id = @__id_0
2022-09-21 12:08:47.788 +01:00 [DBG] A data reader was disposed.
2022-09-21 12:08:47.789 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 12:08:47.789 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-21 12:08:50.873 +01:00 [DBG] An entity of type 'User' tracked by 'PostgresContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 12:08:52.687 +01:00 [DBG] Context 'PostgresContext' started tracking 'RefreshToken' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 12:08:53.616 +01:00 [DBG] 'PostgresContext' generated a temporary value for the property 'Id.RefreshToken'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 12:08:53.630 +01:00 [DBG] Context 'PostgresContext' started tracking 'RefreshToken' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 12:08:54.730 +01:00 [DBG] SaveChanges starting for 'PostgresContext'.
2022-09-21 12:08:54.732 +01:00 [DBG] DetectChanges starting for 'PostgresContext'.
2022-09-21 12:08:54.744 +01:00 [DBG] 1 entities were added and 0 entities were removed from navigation 'User.RefreshTokenCollection'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 12:08:54.746 +01:00 [DBG] The foreign key property 'RefreshToken.UserId' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2022-09-21 12:08:54.747 +01:00 [DBG] DetectChanges completed for 'PostgresContext'.
2022-09-21 12:08:54.747 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-21 12:08:54.748 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 12:08:54.750 +01:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2022-09-21 12:08:54.751 +01:00 [DBG] Began transaction with isolation level 'ReadCommitted'.
2022-09-21 12:08:54.755 +01:00 [DBG] Executing 3 update commands as a batch.
2022-09-21 12:08:54.756 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-21 12:08:54.758 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2022-09-21 12:08:54.759 +01:00 [DBG] Executing DbCommand [Parameters=[@p12='?' (DbType = Int32), @p0='?' (DbType = DateTime), @p1='?', @p2='?' (DbType = DateTime), @p3='?' (DbType = Boolean), @p4='?' (DbType = Boolean), @p5='?' (DbType = Boolean), @p6='?', @p7='?', @p8='?', @p9='?' (DbType = DateTime), @p10='?', @p11='?' (DbType = Int32), @p13='?' (DbType = DateTime), @p14='?', @p15='?' (DbType = DateTime), @p16='?' (DbType = Boolean), @p17='?' (DbType = Boolean), @p18='?' (DbType = Boolean), @p19='?', @p20='?', @p21='?', @p22='?' (DbType = DateTime), @p23='?', @p24='?' (DbType = Int32), @p31='?' (DbType = Int32), @p25='?' (DbType = DateTime), @p26='?', @p27='?', @p28='?' (DbType = DateTime), @p29='?', @p30='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE refresh_token SET created = @p0, created_by_ip = @p1, expires = @p2, is_active = @p3, is_expired = @p4, is_revoked = @p5, reason_revoked = @p6, token = @p7, replaced_by_token = @p8, revoked = @p9, revoked_by_ip = @p10, user_id = @p11
WHERE id = @p12;
INSERT INTO refresh_token (created, created_by_ip, expires, is_active, is_expired, is_revoked, reason_revoked, token, replaced_by_token, revoked, revoked_by_ip, user_id)
VALUES (@p13, @p14, @p15, @p16, @p17, @p18, @p19, @p20, @p21, @p22, @p23, @p24)
RETURNING id;
UPDATE users SET created_at = @p25, email = @p26, full_name = @p27, password_changed_at = @p28, password_hash = @p29, username = @p30
WHERE id = @p31;
2022-09-21 12:08:54.764 +01:00 [INF] Executed DbCommand (5ms) [Parameters=[@p12='?' (DbType = Int32), @p0='?' (DbType = DateTime), @p1='?', @p2='?' (DbType = DateTime), @p3='?' (DbType = Boolean), @p4='?' (DbType = Boolean), @p5='?' (DbType = Boolean), @p6='?', @p7='?', @p8='?', @p9='?' (DbType = DateTime), @p10='?', @p11='?' (DbType = Int32), @p13='?' (DbType = DateTime), @p14='?', @p15='?' (DbType = DateTime), @p16='?' (DbType = Boolean), @p17='?' (DbType = Boolean), @p18='?' (DbType = Boolean), @p19='?', @p20='?', @p21='?', @p22='?' (DbType = DateTime), @p23='?', @p24='?' (DbType = Int32), @p31='?' (DbType = Int32), @p25='?' (DbType = DateTime), @p26='?', @p27='?', @p28='?' (DbType = DateTime), @p29='?', @p30='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE refresh_token SET created = @p0, created_by_ip = @p1, expires = @p2, is_active = @p3, is_expired = @p4, is_revoked = @p5, reason_revoked = @p6, token = @p7, replaced_by_token = @p8, revoked = @p9, revoked_by_ip = @p10, user_id = @p11
WHERE id = @p12;
INSERT INTO refresh_token (created, created_by_ip, expires, is_active, is_expired, is_revoked, reason_revoked, token, replaced_by_token, revoked, revoked_by_ip, user_id)
VALUES (@p13, @p14, @p15, @p16, @p17, @p18, @p19, @p20, @p21, @p22, @p23, @p24)
RETURNING id;
UPDATE users SET created_at = @p25, email = @p26, full_name = @p27, password_changed_at = @p28, password_hash = @p29, username = @p30
WHERE id = @p31;
2022-09-21 12:08:54.767 +01:00 [DBG] The foreign key property 'RefreshToken.Id' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2022-09-21 12:08:54.768 +01:00 [DBG] A data reader was disposed.
2022-09-21 12:08:54.769 +01:00 [DBG] Committing transaction.
2022-09-21 12:08:54.771 +01:00 [DBG] Committed transaction.
2022-09-21 12:08:54.772 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 12:08:54.773 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-21 12:08:54.773 +01:00 [DBG] Disposing transaction.
2022-09-21 12:08:54.775 +01:00 [DBG] An entity of type 'RefreshToken' tracked by 'PostgresContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 12:08:54.778 +01:00 [DBG] An entity of type 'User' tracked by 'PostgresContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 12:08:54.780 +01:00 [DBG] An entity of type 'RefreshToken' tracked by 'PostgresContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 12:08:54.782 +01:00 [DBG] SaveChanges completed for 'PostgresContext' with 3 entities written to the database.
2022-09-21 12:09:45.775 +01:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2022-09-21 12:09:45.782 +01:00 [DBG] Attempting to select an output formatter based on Accept header '["text/plain"]'.
2022-09-21 12:09:45.783 +01:00 [DBG] Could not find an output formatter based on content negotiation. Accepted types were (["text/plain"])
2022-09-21 12:09:45.784 +01:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2022-09-21 12:09:45.785 +01:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2022-09-21 12:09:45.785 +01:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2022-09-21 12:09:45.786 +01:00 [INF] Executing OkObjectResult, writing value of type 'APIBank.Models.Users.Responses.LoginResponse'.
2022-09-21 12:09:45.806 +01:00 [INF] Executed action APIBank.Controllers.UsersController.RefreshToken (APIBank) in 132464.8541ms
2022-09-21 12:09:45.808 +01:00 [INF] Executed endpoint 'APIBank.Controllers.UsersController.RefreshToken (APIBank)'
2022-09-21 12:09:50.216 +01:00 [DBG] 'PostgresContext' disposed.
2022-09-21 12:09:50.218 +01:00 [INF] Request finished HTTP/2 POST https://localhost:7036/api/Users/refreshToken - 0 - 200 - application/json;+charset=utf-8 137075.9652ms
2022-09-21 12:11:58.919 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/api/Users/1/refresh-tokens - -
2022-09-21 12:11:58.934 +01:00 [DBG] 1 candidate(s) found for the request path '/api/Users/1/refresh-tokens'
2022-09-21 12:11:58.936 +01:00 [DBG] Endpoint 'APIBank.Controllers.UsersController.GetRefreshTokens (APIBank)' with route pattern 'api/Users/{id}/refresh-tokens' is valid for the request path '/api/Users/1/refresh-tokens'
2022-09-21 12:11:58.940 +01:00 [DBG] Request matched endpoint 'APIBank.Controllers.UsersController.GetRefreshTokens (APIBank)'
2022-09-21 12:11:58.941 +01:00 [DBG] Static files was skipped as the request already matched an endpoint.
2022-09-21 12:13:15.136 +01:00 [INF] Entity Framework Core 6.0.9 initialized 'PostgresContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:6.0.7+5b98e4b74de93b590b44aef8dd7967c03acc433c' with options: None
2022-09-21 12:13:15.141 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-21 12:13:15.142 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2022-09-21 12:13:15.143 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-21 12:13:15.144 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 12:13:15.144 +01:00 [DBG] Executing DbCommand [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.id = @__p_0
LIMIT 1
2022-09-21 12:13:15.146 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.id = @__p_0
LIMIT 1
2022-09-21 12:13:20.500 +01:00 [DBG] Context 'PostgresContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 12:13:20.504 +01:00 [DBG] A data reader was disposed.
2022-09-21 12:13:20.505 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 12:13:20.505 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-21 12:13:42.399 +01:00 [INF] Executing endpoint 'APIBank.Controllers.UsersController.GetRefreshTokens (APIBank)'
2022-09-21 12:13:42.468 +01:00 [INF] Route matched with {action = "GetRefreshTokens", controller = "Users"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult GetRefreshTokens(Int32) on controller APIBank.Controllers.UsersController (APIBank).
2022-09-21 12:13:42.470 +01:00 [DBG] Execution plan of authorization filters (in the following order): ["APIBank.Authorization.AuthorizeAttribute"]
2022-09-21 12:13:42.471 +01:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2022-09-21 12:13:42.472 +01:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2022-09-21 12:13:42.475 +01:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2022-09-21 12:13:42.478 +01:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2022-09-21 12:13:54.004 +01:00 [DBG] Executing controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-21 12:13:59.945 +01:00 [DBG] Executed controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-21 12:13:59.950 +01:00 [DBG] Attempting to bind parameter 'id' of type 'System.Int32' ...
2022-09-21 12:13:59.951 +01:00 [DBG] Attempting to bind parameter 'id' of type 'System.Int32' using the name 'id' in request data ...
2022-09-21 12:13:59.953 +01:00 [DBG] Done attempting to bind parameter 'id' of type 'System.Int32'.
2022-09-21 12:13:59.954 +01:00 [DBG] Done attempting to bind parameter 'id' of type 'System.Int32'.
2022-09-21 12:13:59.955 +01:00 [DBG] Attempting to validate the bound parameter 'id' of type 'System.Int32' ...
2022-09-21 12:13:59.956 +01:00 [DBG] Done attempting to validate the bound parameter 'id' of type 'System.Int32'.
2022-09-21 12:14:13.628 +01:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2022-09-21 12:14:13.640 +01:00 [DBG] No information found on request to perform content negotiation.
2022-09-21 12:14:13.640 +01:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2022-09-21 12:14:13.641 +01:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2022-09-21 12:14:13.642 +01:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2022-09-21 12:14:13.645 +01:00 [INF] Executing OkObjectResult, writing value of type 'Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryable`1[[APIBank.ModelEntities.RefreshToken, APIBank, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2022-09-21 12:14:13.706 +01:00 [DBG] Compiling query expression: 
'DbSet<RefreshToken>()
    .Where(rt => rt.UserId == __id_0)
    .AsNoTracking()
    .Select(rt => new RefreshToken{ 
        Id = rt.Id, 
        UserId = rt.UserId, 
        RefToken = rt.RefToken, 
        Expires = rt.Expires, 
        Created = rt.Created, 
        CreatedByIp = rt.CreatedByIp, 
        Revoked = rt.Revoked, 
        RevokedByIp = rt.RevokedByIp, 
        ReplacedByToken = rt.ReplacedByToken, 
        ReasonRevoked = rt.ReasonRevoked, 
        IsExpired = rt.IsExpired, 
        IsRevoked = rt.IsRevoked, 
        IsActive = rt.IsActive 
    }
    )'
2022-09-21 12:14:13.717 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<RefreshToken>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            Id -> 0
            UserId -> 1
            RefToken -> 2
            Expires -> 3
            Created -> 4
            CreatedByIp -> 5
            Revoked -> 6
            RevokedByIp -> 7
            ReplacedByToken -> 8
            ReasonRevoked -> 9
            IsExpired -> 10
            IsRevoked -> 11
            IsActive -> 12
        SELECT r.id AS Id, r.user_id AS UserId, r.token AS RefToken, r.expires AS Expires, r.created AS Created, r.created_by_ip AS CreatedByIp, r.revoked AS Revoked, r.revoked_by_ip AS RevokedByIp, r.replaced_by_token AS ReplacedByToken, r.reason_revoked AS ReasonRevoked, r.is_expired AS IsExpired, r.is_revoked AS IsRevoked, r.is_active AS IsActive
        FROM refresh_token AS r
        WHERE r.user_id == @__id_0), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, RefreshToken>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)'
2022-09-21 12:14:13.757 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-21 12:14:13.759 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (2ms).
2022-09-21 12:14:13.773 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-21 12:14:13.776 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 12:14:13.781 +01:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.user_id AS "UserId", r.token AS "RefToken", r.expires AS "Expires", r.created AS "Created", r.created_by_ip AS "CreatedByIp", r.revoked AS "Revoked", r.revoked_by_ip AS "RevokedByIp", r.replaced_by_token AS "ReplacedByToken", r.reason_revoked AS "ReasonRevoked", r.is_expired AS "IsExpired", r.is_revoked AS "IsRevoked", r.is_active AS "IsActive"
FROM refresh_token AS r
WHERE r.user_id = @__id_0
2022-09-21 12:14:13.789 +01:00 [INF] Executed DbCommand (10ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.user_id AS "UserId", r.token AS "RefToken", r.expires AS "Expires", r.created AS "Created", r.created_by_ip AS "CreatedByIp", r.revoked AS "Revoked", r.revoked_by_ip AS "RevokedByIp", r.replaced_by_token AS "ReplacedByToken", r.reason_revoked AS "ReasonRevoked", r.is_expired AS "IsExpired", r.is_revoked AS "IsRevoked", r.is_active AS "IsActive"
FROM refresh_token AS r
WHERE r.user_id = @__id_0
2022-09-21 12:14:13.839 +01:00 [DBG] A data reader was disposed.
2022-09-21 12:14:13.854 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 12:14:13.856 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-21 12:14:13.857 +01:00 [INF] Executed action APIBank.Controllers.UsersController.GetRefreshTokens (APIBank) in 31377.223ms
2022-09-21 12:14:13.858 +01:00 [INF] Executed endpoint 'APIBank.Controllers.UsersController.GetRefreshTokens (APIBank)'
2022-09-21 12:14:18.196 +01:00 [DBG] 'PostgresContext' disposed.
2022-09-21 12:14:18.200 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/api/Users/1/refresh-tokens - - - 200 - application/json;+charset=utf-8 139282.1223ms
2022-09-21 12:15:24.100 +01:00 [INF] Request starting HTTP/2 POST https://localhost:7036/api/Users/refreshToken - 0
2022-09-21 12:15:24.120 +01:00 [DBG] 1 candidate(s) found for the request path '/api/Users/refreshToken'
2022-09-21 12:15:24.125 +01:00 [DBG] Endpoint 'APIBank.Controllers.UsersController.RefreshToken (APIBank)' with route pattern 'api/Users/refreshToken' is valid for the request path '/api/Users/refreshToken'
2022-09-21 12:15:24.127 +01:00 [DBG] Request matched endpoint 'APIBank.Controllers.UsersController.RefreshToken (APIBank)'
2022-09-21 12:15:24.128 +01:00 [DBG] Static files was skipped as the request already matched an endpoint.
2022-09-21 12:15:24.130 +01:00 [INF] Entity Framework Core 6.0.9 initialized 'PostgresContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:6.0.7+5b98e4b74de93b590b44aef8dd7967c03acc433c' with options: None
2022-09-21 12:15:24.132 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-21 12:15:24.133 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2022-09-21 12:15:24.133 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-21 12:15:24.135 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 12:15:24.138 +01:00 [DBG] Executing DbCommand [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.id = @__p_0
LIMIT 1
2022-09-21 12:15:24.140 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.id = @__p_0
LIMIT 1
2022-09-21 12:15:24.142 +01:00 [DBG] Context 'PostgresContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 12:15:24.143 +01:00 [DBG] A data reader was disposed.
2022-09-21 12:15:24.143 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 12:15:24.144 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-21 12:15:24.144 +01:00 [INF] Executing endpoint 'APIBank.Controllers.UsersController.RefreshToken (APIBank)'
2022-09-21 12:15:24.145 +01:00 [INF] Route matched with {action = "RefreshToken", controller = "Users"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult RefreshToken() on controller APIBank.Controllers.UsersController (APIBank).
2022-09-21 12:15:24.147 +01:00 [DBG] Execution plan of authorization filters (in the following order): ["APIBank.Authorization.AuthorizeAttribute"]
2022-09-21 12:15:24.148 +01:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2022-09-21 12:15:24.149 +01:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2022-09-21 12:15:24.150 +01:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2022-09-21 12:15:24.153 +01:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2022-09-21 12:15:24.155 +01:00 [DBG] Executing controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-21 12:15:24.156 +01:00 [DBG] Executed controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-21 12:15:37.113 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-21 12:15:37.116 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (3ms).
2022-09-21 12:15:37.118 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-21 12:15:37.119 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 12:15:37.120 +01:00 [DBG] Executing DbCommand [Parameters=[@__refToken_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE EXISTS (
    SELECT 1
    FROM refresh_token AS r
    WHERE (u.id = r.user_id) AND (r.token = @__refToken_0))
LIMIT 2
2022-09-21 12:15:37.122 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[@__refToken_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE EXISTS (
    SELECT 1
    FROM refresh_token AS r
    WHERE (u.id = r.user_id) AND (r.token = @__refToken_0))
LIMIT 2
2022-09-21 12:15:37.125 +01:00 [DBG] A data reader was disposed.
2022-09-21 12:15:37.125 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 12:15:37.128 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-21 12:15:37.699 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-21 12:15:37.701 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (2ms).
2022-09-21 12:15:37.704 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-21 12:15:37.708 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 12:15:37.710 +01:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.user_id AS "UserId", r.token AS "RefToken", r.expires AS "Expires", r.created AS "Created", r.created_by_ip AS "CreatedByIp", r.revoked AS "Revoked", r.revoked_by_ip AS "RevokedByIp", r.replaced_by_token AS "ReplacedByToken", r.reason_revoked AS "ReasonRevoked", r.is_expired AS "IsExpired", r.is_revoked AS "IsRevoked", r.is_active AS "IsActive"
FROM refresh_token AS r
WHERE r.user_id = @__id_0
2022-09-21 12:15:37.717 +01:00 [INF] Executed DbCommand (7ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.user_id AS "UserId", r.token AS "RefToken", r.expires AS "Expires", r.created AS "Created", r.created_by_ip AS "CreatedByIp", r.revoked AS "Revoked", r.revoked_by_ip AS "RevokedByIp", r.replaced_by_token AS "ReplacedByToken", r.reason_revoked AS "ReasonRevoked", r.is_expired AS "IsExpired", r.is_revoked AS "IsRevoked", r.is_active AS "IsActive"
FROM refresh_token AS r
WHERE r.user_id = @__id_0
2022-09-21 12:15:37.720 +01:00 [DBG] A data reader was disposed.
2022-09-21 12:15:37.720 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 12:15:37.721 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-21 12:16:01.150 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-21 12:16:01.155 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (5ms).
2022-09-21 12:16:01.158 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-21 12:16:01.159 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 12:16:01.160 +01:00 [DBG] Executing DbCommand [Parameters=[@__token_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM users AS u
    WHERE EXISTS (
        SELECT 1
        FROM refresh_token AS r
        WHERE (u.id = r.user_id) AND (r.token = @__token_0)))
2022-09-21 12:16:01.162 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[@__token_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM users AS u
    WHERE EXISTS (
        SELECT 1
        FROM refresh_token AS r
        WHERE (u.id = r.user_id) AND (r.token = @__token_0)))
2022-09-21 12:16:01.163 +01:00 [DBG] A data reader was disposed.
2022-09-21 12:16:01.164 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 12:16:01.166 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-21 12:16:29.675 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-21 12:16:29.680 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (4ms).
2022-09-21 12:16:29.681 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-21 12:16:29.681 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 12:16:29.682 +01:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.user_id AS "UserId", r.token AS "RefToken", r.expires AS "Expires", r.created AS "Created", r.created_by_ip AS "CreatedByIp", r.revoked AS "Revoked", r.revoked_by_ip AS "RevokedByIp", r.replaced_by_token AS "ReplacedByToken", r.reason_revoked AS "ReasonRevoked", r.is_expired AS "IsExpired", r.is_revoked AS "IsRevoked", r.is_active AS "IsActive"
FROM refresh_token AS r
WHERE r.user_id = @__id_0
2022-09-21 12:16:29.684 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.user_id AS "UserId", r.token AS "RefToken", r.expires AS "Expires", r.created AS "Created", r.created_by_ip AS "CreatedByIp", r.revoked AS "Revoked", r.revoked_by_ip AS "RevokedByIp", r.replaced_by_token AS "ReplacedByToken", r.reason_revoked AS "ReasonRevoked", r.is_expired AS "IsExpired", r.is_revoked AS "IsRevoked", r.is_active AS "IsActive"
FROM refresh_token AS r
WHERE r.user_id = @__id_0
2022-09-21 12:16:29.697 +01:00 [DBG] A data reader was disposed.
2022-09-21 12:16:29.697 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 12:16:29.698 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-21 12:17:48.245 +01:00 [DBG] An entity of type 'User' tracked by 'PostgresContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 12:17:49.389 +01:00 [DBG] Context 'PostgresContext' started tracking 'RefreshToken' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 12:17:52.328 +01:00 [DBG] 'PostgresContext' generated a temporary value for the property 'Id.RefreshToken'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 12:17:52.342 +01:00 [DBG] Context 'PostgresContext' started tracking 'RefreshToken' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 12:17:53.895 +01:00 [DBG] SaveChanges starting for 'PostgresContext'.
2022-09-21 12:17:53.898 +01:00 [DBG] DetectChanges starting for 'PostgresContext'.
2022-09-21 12:17:53.910 +01:00 [DBG] 1 entities were added and 0 entities were removed from navigation 'User.RefreshTokenCollection'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 12:17:53.912 +01:00 [DBG] The foreign key property 'RefreshToken.UserId' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2022-09-21 12:17:53.913 +01:00 [DBG] DetectChanges completed for 'PostgresContext'.
2022-09-21 12:17:53.913 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-21 12:17:53.914 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 12:17:53.915 +01:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2022-09-21 12:17:53.916 +01:00 [DBG] Began transaction with isolation level 'ReadCommitted'.
2022-09-21 12:17:53.916 +01:00 [DBG] Executing 3 update commands as a batch.
2022-09-21 12:17:53.917 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-21 12:17:53.918 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2022-09-21 12:17:53.919 +01:00 [DBG] Executing DbCommand [Parameters=[@p12='?' (DbType = Int32), @p0='?' (DbType = DateTime), @p1='?', @p2='?' (DbType = DateTime), @p3='?' (DbType = Boolean), @p4='?' (DbType = Boolean), @p5='?' (DbType = Boolean), @p6='?', @p7='?', @p8='?', @p9='?' (DbType = DateTime), @p10='?', @p11='?' (DbType = Int32), @p13='?' (DbType = DateTime), @p14='?', @p15='?' (DbType = DateTime), @p16='?' (DbType = Boolean), @p17='?' (DbType = Boolean), @p18='?' (DbType = Boolean), @p19='?', @p20='?', @p21='?', @p22='?' (DbType = DateTime), @p23='?', @p24='?' (DbType = Int32), @p31='?' (DbType = Int32), @p25='?' (DbType = DateTime), @p26='?', @p27='?', @p28='?' (DbType = DateTime), @p29='?', @p30='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE refresh_token SET created = @p0, created_by_ip = @p1, expires = @p2, is_active = @p3, is_expired = @p4, is_revoked = @p5, reason_revoked = @p6, token = @p7, replaced_by_token = @p8, revoked = @p9, revoked_by_ip = @p10, user_id = @p11
WHERE id = @p12;
INSERT INTO refresh_token (created, created_by_ip, expires, is_active, is_expired, is_revoked, reason_revoked, token, replaced_by_token, revoked, revoked_by_ip, user_id)
VALUES (@p13, @p14, @p15, @p16, @p17, @p18, @p19, @p20, @p21, @p22, @p23, @p24)
RETURNING id;
UPDATE users SET created_at = @p25, email = @p26, full_name = @p27, password_changed_at = @p28, password_hash = @p29, username = @p30
WHERE id = @p31;
2022-09-21 12:17:53.923 +01:00 [INF] Executed DbCommand (4ms) [Parameters=[@p12='?' (DbType = Int32), @p0='?' (DbType = DateTime), @p1='?', @p2='?' (DbType = DateTime), @p3='?' (DbType = Boolean), @p4='?' (DbType = Boolean), @p5='?' (DbType = Boolean), @p6='?', @p7='?', @p8='?', @p9='?' (DbType = DateTime), @p10='?', @p11='?' (DbType = Int32), @p13='?' (DbType = DateTime), @p14='?', @p15='?' (DbType = DateTime), @p16='?' (DbType = Boolean), @p17='?' (DbType = Boolean), @p18='?' (DbType = Boolean), @p19='?', @p20='?', @p21='?', @p22='?' (DbType = DateTime), @p23='?', @p24='?' (DbType = Int32), @p31='?' (DbType = Int32), @p25='?' (DbType = DateTime), @p26='?', @p27='?', @p28='?' (DbType = DateTime), @p29='?', @p30='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE refresh_token SET created = @p0, created_by_ip = @p1, expires = @p2, is_active = @p3, is_expired = @p4, is_revoked = @p5, reason_revoked = @p6, token = @p7, replaced_by_token = @p8, revoked = @p9, revoked_by_ip = @p10, user_id = @p11
WHERE id = @p12;
INSERT INTO refresh_token (created, created_by_ip, expires, is_active, is_expired, is_revoked, reason_revoked, token, replaced_by_token, revoked, revoked_by_ip, user_id)
VALUES (@p13, @p14, @p15, @p16, @p17, @p18, @p19, @p20, @p21, @p22, @p23, @p24)
RETURNING id;
UPDATE users SET created_at = @p25, email = @p26, full_name = @p27, password_changed_at = @p28, password_hash = @p29, username = @p30
WHERE id = @p31;
2022-09-21 12:17:53.931 +01:00 [DBG] The foreign key property 'RefreshToken.Id' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2022-09-21 12:17:53.932 +01:00 [DBG] A data reader was disposed.
2022-09-21 12:17:53.932 +01:00 [DBG] Committing transaction.
2022-09-21 12:17:53.933 +01:00 [DBG] Committed transaction.
2022-09-21 12:17:53.934 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 12:17:53.935 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-21 12:17:53.935 +01:00 [DBG] Disposing transaction.
2022-09-21 12:17:53.936 +01:00 [DBG] An entity of type 'RefreshToken' tracked by 'PostgresContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 12:17:53.938 +01:00 [DBG] An entity of type 'User' tracked by 'PostgresContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 12:17:53.942 +01:00 [DBG] An entity of type 'RefreshToken' tracked by 'PostgresContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 12:17:53.943 +01:00 [DBG] SaveChanges completed for 'PostgresContext' with 3 entities written to the database.
2022-09-21 12:18:09.421 +01:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2022-09-21 12:18:09.431 +01:00 [DBG] Attempting to select an output formatter based on Accept header '["text/plain"]'.
2022-09-21 12:18:09.433 +01:00 [DBG] Could not find an output formatter based on content negotiation. Accepted types were (["text/plain"])
2022-09-21 12:18:09.434 +01:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2022-09-21 12:18:09.435 +01:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2022-09-21 12:18:09.435 +01:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2022-09-21 12:18:09.436 +01:00 [INF] Executing OkObjectResult, writing value of type 'APIBank.Models.Users.Responses.LoginResponse'.
2022-09-21 12:18:09.437 +01:00 [INF] Executed action APIBank.Controllers.UsersController.RefreshToken (APIBank) in 165281.9695ms
2022-09-21 12:18:09.438 +01:00 [INF] Executed endpoint 'APIBank.Controllers.UsersController.RefreshToken (APIBank)'
2022-09-21 12:18:12.203 +01:00 [DBG] 'PostgresContext' disposed.
2022-09-21 12:18:12.209 +01:00 [INF] Request finished HTTP/2 POST https://localhost:7036/api/Users/refreshToken - 0 - 200 - application/json;+charset=utf-8 168110.2773ms
2022-09-21 12:18:20.234 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/api/Users/1/refresh-tokens - -
2022-09-21 12:18:20.248 +01:00 [DBG] 1 candidate(s) found for the request path '/api/Users/1/refresh-tokens'
2022-09-21 12:18:20.250 +01:00 [DBG] Endpoint 'APIBank.Controllers.UsersController.GetRefreshTokens (APIBank)' with route pattern 'api/Users/{id}/refresh-tokens' is valid for the request path '/api/Users/1/refresh-tokens'
2022-09-21 12:18:20.255 +01:00 [DBG] Request matched endpoint 'APIBank.Controllers.UsersController.GetRefreshTokens (APIBank)'
2022-09-21 12:18:20.257 +01:00 [DBG] Static files was skipped as the request already matched an endpoint.
2022-09-21 12:18:20.259 +01:00 [INF] Entity Framework Core 6.0.9 initialized 'PostgresContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:6.0.7+5b98e4b74de93b590b44aef8dd7967c03acc433c' with options: None
2022-09-21 12:18:20.261 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-21 12:18:20.262 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2022-09-21 12:18:20.262 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-21 12:18:20.263 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 12:18:20.265 +01:00 [DBG] Executing DbCommand [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.id = @__p_0
LIMIT 1
2022-09-21 12:18:20.269 +01:00 [INF] Executed DbCommand (5ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.id = @__p_0
LIMIT 1
2022-09-21 12:18:20.271 +01:00 [DBG] Context 'PostgresContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 12:18:20.272 +01:00 [DBG] A data reader was disposed.
2022-09-21 12:18:20.273 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 12:18:20.273 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-21 12:18:20.274 +01:00 [INF] Executing endpoint 'APIBank.Controllers.UsersController.GetRefreshTokens (APIBank)'
2022-09-21 12:18:20.275 +01:00 [INF] Route matched with {action = "GetRefreshTokens", controller = "Users"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult GetRefreshTokens(Int32) on controller APIBank.Controllers.UsersController (APIBank).
2022-09-21 12:18:20.276 +01:00 [DBG] Execution plan of authorization filters (in the following order): ["APIBank.Authorization.AuthorizeAttribute"]
2022-09-21 12:18:20.277 +01:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2022-09-21 12:18:20.278 +01:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2022-09-21 12:18:20.280 +01:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2022-09-21 12:18:20.284 +01:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2022-09-21 12:18:20.285 +01:00 [DBG] Executing controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-21 12:18:20.286 +01:00 [DBG] Executed controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-21 12:18:20.287 +01:00 [DBG] Attempting to bind parameter 'id' of type 'System.Int32' ...
2022-09-21 12:18:20.288 +01:00 [DBG] Attempting to bind parameter 'id' of type 'System.Int32' using the name 'id' in request data ...
2022-09-21 12:18:20.289 +01:00 [DBG] Done attempting to bind parameter 'id' of type 'System.Int32'.
2022-09-21 12:18:20.290 +01:00 [DBG] Done attempting to bind parameter 'id' of type 'System.Int32'.
2022-09-21 12:18:20.290 +01:00 [DBG] Attempting to validate the bound parameter 'id' of type 'System.Int32' ...
2022-09-21 12:18:20.291 +01:00 [DBG] Done attempting to validate the bound parameter 'id' of type 'System.Int32'.
2022-09-21 12:18:22.618 +01:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2022-09-21 12:18:22.621 +01:00 [DBG] No information found on request to perform content negotiation.
2022-09-21 12:18:22.622 +01:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2022-09-21 12:18:22.624 +01:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2022-09-21 12:18:22.624 +01:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2022-09-21 12:18:22.625 +01:00 [INF] Executing OkObjectResult, writing value of type 'Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryable`1[[APIBank.ModelEntities.RefreshToken, APIBank, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2022-09-21 12:18:22.626 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-21 12:18:22.627 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2022-09-21 12:18:22.628 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-21 12:18:22.629 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 12:18:22.632 +01:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.user_id AS "UserId", r.token AS "RefToken", r.expires AS "Expires", r.created AS "Created", r.created_by_ip AS "CreatedByIp", r.revoked AS "Revoked", r.revoked_by_ip AS "RevokedByIp", r.replaced_by_token AS "ReplacedByToken", r.reason_revoked AS "ReasonRevoked", r.is_expired AS "IsExpired", r.is_revoked AS "IsRevoked", r.is_active AS "IsActive"
FROM refresh_token AS r
WHERE r.user_id = @__id_0
2022-09-21 12:18:22.642 +01:00 [INF] Executed DbCommand (10ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.user_id AS "UserId", r.token AS "RefToken", r.expires AS "Expires", r.created AS "Created", r.created_by_ip AS "CreatedByIp", r.revoked AS "Revoked", r.revoked_by_ip AS "RevokedByIp", r.replaced_by_token AS "ReplacedByToken", r.reason_revoked AS "ReasonRevoked", r.is_expired AS "IsExpired", r.is_revoked AS "IsRevoked", r.is_active AS "IsActive"
FROM refresh_token AS r
WHERE r.user_id = @__id_0
2022-09-21 12:18:22.655 +01:00 [DBG] A data reader was disposed.
2022-09-21 12:18:22.656 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 12:18:22.657 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-21 12:18:22.664 +01:00 [INF] Executed action APIBank.Controllers.UsersController.GetRefreshTokens (APIBank) in 2379.0221ms
2022-09-21 12:18:23.936 +01:00 [INF] Executed endpoint 'APIBank.Controllers.UsersController.GetRefreshTokens (APIBank)'
2022-09-21 12:18:24.918 +01:00 [DBG] 'PostgresContext' disposed.
2022-09-21 12:18:24.922 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/api/Users/1/refresh-tokens - - - 200 - application/json;+charset=utf-8 4688.0452ms
2022-09-21 12:19:54.868 +01:00 [INF] Request starting HTTP/2 POST https://localhost:7036/api/Users/refreshToken - 0
2022-09-21 12:19:54.884 +01:00 [DBG] 1 candidate(s) found for the request path '/api/Users/refreshToken'
2022-09-21 12:19:54.888 +01:00 [DBG] Endpoint 'APIBank.Controllers.UsersController.RefreshToken (APIBank)' with route pattern 'api/Users/refreshToken' is valid for the request path '/api/Users/refreshToken'
2022-09-21 12:19:54.890 +01:00 [DBG] Request matched endpoint 'APIBank.Controllers.UsersController.RefreshToken (APIBank)'
2022-09-21 12:19:54.891 +01:00 [DBG] Static files was skipped as the request already matched an endpoint.
2022-09-21 12:19:54.893 +01:00 [INF] Entity Framework Core 6.0.9 initialized 'PostgresContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:6.0.7+5b98e4b74de93b590b44aef8dd7967c03acc433c' with options: None
2022-09-21 12:19:54.895 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-21 12:19:54.895 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2022-09-21 12:19:54.896 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-21 12:19:54.962 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 12:19:54.966 +01:00 [DBG] Executing DbCommand [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.id = @__p_0
LIMIT 1
2022-09-21 12:19:54.970 +01:00 [INF] Executed DbCommand (4ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.id = @__p_0
LIMIT 1
2022-09-21 12:19:54.971 +01:00 [DBG] Context 'PostgresContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 12:19:54.972 +01:00 [DBG] A data reader was disposed.
2022-09-21 12:19:54.973 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 12:19:54.973 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-21 12:19:54.974 +01:00 [INF] Executing endpoint 'APIBank.Controllers.UsersController.RefreshToken (APIBank)'
2022-09-21 12:19:54.975 +01:00 [INF] Route matched with {action = "RefreshToken", controller = "Users"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult RefreshToken() on controller APIBank.Controllers.UsersController (APIBank).
2022-09-21 12:19:54.976 +01:00 [DBG] Execution plan of authorization filters (in the following order): ["APIBank.Authorization.AuthorizeAttribute"]
2022-09-21 12:19:54.977 +01:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2022-09-21 12:19:54.978 +01:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2022-09-21 12:19:54.981 +01:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2022-09-21 12:19:54.983 +01:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2022-09-21 12:19:54.984 +01:00 [DBG] Executing controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-21 12:19:54.985 +01:00 [DBG] Executed controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-21 12:19:57.719 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-21 12:19:57.723 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (3ms).
2022-09-21 12:19:57.725 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-21 12:19:57.727 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 12:19:57.728 +01:00 [DBG] Executing DbCommand [Parameters=[@__refToken_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE EXISTS (
    SELECT 1
    FROM refresh_token AS r
    WHERE (u.id = r.user_id) AND (r.token = @__refToken_0))
LIMIT 2
2022-09-21 12:19:57.735 +01:00 [INF] Executed DbCommand (7ms) [Parameters=[@__refToken_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE EXISTS (
    SELECT 1
    FROM refresh_token AS r
    WHERE (u.id = r.user_id) AND (r.token = @__refToken_0))
LIMIT 2
2022-09-21 12:19:57.736 +01:00 [DBG] A data reader was disposed.
2022-09-21 12:19:57.738 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 12:19:57.739 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-21 12:19:57.740 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-21 12:19:57.741 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2022-09-21 12:19:57.741 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-21 12:19:57.742 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 12:19:57.743 +01:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.user_id AS "UserId", r.token AS "RefToken", r.expires AS "Expires", r.created AS "Created", r.created_by_ip AS "CreatedByIp", r.revoked AS "Revoked", r.revoked_by_ip AS "RevokedByIp", r.replaced_by_token AS "ReplacedByToken", r.reason_revoked AS "ReasonRevoked", r.is_expired AS "IsExpired", r.is_revoked AS "IsRevoked", r.is_active AS "IsActive"
FROM refresh_token AS r
WHERE r.user_id = @__id_0
2022-09-21 12:19:57.745 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.user_id AS "UserId", r.token AS "RefToken", r.expires AS "Expires", r.created AS "Created", r.created_by_ip AS "CreatedByIp", r.revoked AS "Revoked", r.revoked_by_ip AS "RevokedByIp", r.replaced_by_token AS "ReplacedByToken", r.reason_revoked AS "ReasonRevoked", r.is_expired AS "IsExpired", r.is_revoked AS "IsRevoked", r.is_active AS "IsActive"
FROM refresh_token AS r
WHERE r.user_id = @__id_0
2022-09-21 12:19:57.748 +01:00 [DBG] A data reader was disposed.
2022-09-21 12:19:57.751 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 12:19:57.752 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-21 12:19:57.753 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-21 12:19:57.754 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2022-09-21 12:19:57.755 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-21 12:19:57.756 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 12:19:57.757 +01:00 [DBG] Executing DbCommand [Parameters=[@__token_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM users AS u
    WHERE EXISTS (
        SELECT 1
        FROM refresh_token AS r
        WHERE (u.id = r.user_id) AND (r.token = @__token_0)))
2022-09-21 12:19:57.759 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[@__token_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM users AS u
    WHERE EXISTS (
        SELECT 1
        FROM refresh_token AS r
        WHERE (u.id = r.user_id) AND (r.token = @__token_0)))
2022-09-21 12:19:57.760 +01:00 [DBG] A data reader was disposed.
2022-09-21 12:19:57.761 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 12:19:57.761 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-21 12:19:57.764 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-21 12:19:57.767 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (2ms).
2022-09-21 12:19:57.768 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-21 12:19:57.769 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 12:19:57.770 +01:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.user_id AS "UserId", r.token AS "RefToken", r.expires AS "Expires", r.created AS "Created", r.created_by_ip AS "CreatedByIp", r.revoked AS "Revoked", r.revoked_by_ip AS "RevokedByIp", r.replaced_by_token AS "ReplacedByToken", r.reason_revoked AS "ReasonRevoked", r.is_expired AS "IsExpired", r.is_revoked AS "IsRevoked", r.is_active AS "IsActive"
FROM refresh_token AS r
WHERE r.user_id = @__id_0
2022-09-21 12:19:57.773 +01:00 [INF] Executed DbCommand (3ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.user_id AS "UserId", r.token AS "RefToken", r.expires AS "Expires", r.created AS "Created", r.created_by_ip AS "CreatedByIp", r.revoked AS "Revoked", r.revoked_by_ip AS "RevokedByIp", r.replaced_by_token AS "ReplacedByToken", r.reason_revoked AS "ReasonRevoked", r.is_expired AS "IsExpired", r.is_revoked AS "IsRevoked", r.is_active AS "IsActive"
FROM refresh_token AS r
WHERE r.user_id = @__id_0
2022-09-21 12:19:57.775 +01:00 [DBG] A data reader was disposed.
2022-09-21 12:19:57.776 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 12:19:57.777 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-21 12:19:57.778 +01:00 [DBG] An entity of type 'User' tracked by 'PostgresContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 12:19:57.781 +01:00 [DBG] Context 'PostgresContext' started tracking 'RefreshToken' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 12:19:57.785 +01:00 [DBG] 'PostgresContext' generated a temporary value for the property 'Id.RefreshToken'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 12:19:57.786 +01:00 [DBG] Context 'PostgresContext' started tracking 'RefreshToken' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 12:19:57.787 +01:00 [DBG] SaveChanges starting for 'PostgresContext'.
2022-09-21 12:19:57.788 +01:00 [DBG] DetectChanges starting for 'PostgresContext'.
2022-09-21 12:19:57.789 +01:00 [DBG] 1 entities were added and 0 entities were removed from navigation 'User.RefreshTokenCollection'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 12:19:57.790 +01:00 [DBG] The foreign key property 'RefreshToken.UserId' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2022-09-21 12:19:57.791 +01:00 [DBG] DetectChanges completed for 'PostgresContext'.
2022-09-21 12:19:57.792 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-21 12:19:57.793 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 12:19:57.794 +01:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2022-09-21 12:19:57.794 +01:00 [DBG] Began transaction with isolation level 'ReadCommitted'.
2022-09-21 12:19:57.797 +01:00 [DBG] Executing 3 update commands as a batch.
2022-09-21 12:19:57.800 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-21 12:19:57.801 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2022-09-21 12:19:57.802 +01:00 [DBG] Executing DbCommand [Parameters=[@p12='?' (DbType = Int32), @p0='?' (DbType = DateTime), @p1='?', @p2='?' (DbType = DateTime), @p3='?' (DbType = Boolean), @p4='?' (DbType = Boolean), @p5='?' (DbType = Boolean), @p6='?', @p7='?', @p8='?', @p9='?' (DbType = DateTime), @p10='?', @p11='?' (DbType = Int32), @p13='?' (DbType = DateTime), @p14='?', @p15='?' (DbType = DateTime), @p16='?' (DbType = Boolean), @p17='?' (DbType = Boolean), @p18='?' (DbType = Boolean), @p19='?', @p20='?', @p21='?', @p22='?' (DbType = DateTime), @p23='?', @p24='?' (DbType = Int32), @p31='?' (DbType = Int32), @p25='?' (DbType = DateTime), @p26='?', @p27='?', @p28='?' (DbType = DateTime), @p29='?', @p30='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE refresh_token SET created = @p0, created_by_ip = @p1, expires = @p2, is_active = @p3, is_expired = @p4, is_revoked = @p5, reason_revoked = @p6, token = @p7, replaced_by_token = @p8, revoked = @p9, revoked_by_ip = @p10, user_id = @p11
WHERE id = @p12;
INSERT INTO refresh_token (created, created_by_ip, expires, is_active, is_expired, is_revoked, reason_revoked, token, replaced_by_token, revoked, revoked_by_ip, user_id)
VALUES (@p13, @p14, @p15, @p16, @p17, @p18, @p19, @p20, @p21, @p22, @p23, @p24)
RETURNING id;
UPDATE users SET created_at = @p25, email = @p26, full_name = @p27, password_changed_at = @p28, password_hash = @p29, username = @p30
WHERE id = @p31;
2022-09-21 12:19:57.805 +01:00 [INF] Executed DbCommand (3ms) [Parameters=[@p12='?' (DbType = Int32), @p0='?' (DbType = DateTime), @p1='?', @p2='?' (DbType = DateTime), @p3='?' (DbType = Boolean), @p4='?' (DbType = Boolean), @p5='?' (DbType = Boolean), @p6='?', @p7='?', @p8='?', @p9='?' (DbType = DateTime), @p10='?', @p11='?' (DbType = Int32), @p13='?' (DbType = DateTime), @p14='?', @p15='?' (DbType = DateTime), @p16='?' (DbType = Boolean), @p17='?' (DbType = Boolean), @p18='?' (DbType = Boolean), @p19='?', @p20='?', @p21='?', @p22='?' (DbType = DateTime), @p23='?', @p24='?' (DbType = Int32), @p31='?' (DbType = Int32), @p25='?' (DbType = DateTime), @p26='?', @p27='?', @p28='?' (DbType = DateTime), @p29='?', @p30='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE refresh_token SET created = @p0, created_by_ip = @p1, expires = @p2, is_active = @p3, is_expired = @p4, is_revoked = @p5, reason_revoked = @p6, token = @p7, replaced_by_token = @p8, revoked = @p9, revoked_by_ip = @p10, user_id = @p11
WHERE id = @p12;
INSERT INTO refresh_token (created, created_by_ip, expires, is_active, is_expired, is_revoked, reason_revoked, token, replaced_by_token, revoked, revoked_by_ip, user_id)
VALUES (@p13, @p14, @p15, @p16, @p17, @p18, @p19, @p20, @p21, @p22, @p23, @p24)
RETURNING id;
UPDATE users SET created_at = @p25, email = @p26, full_name = @p27, password_changed_at = @p28, password_hash = @p29, username = @p30
WHERE id = @p31;
2022-09-21 12:19:57.807 +01:00 [DBG] The foreign key property 'RefreshToken.Id' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2022-09-21 12:19:57.808 +01:00 [DBG] A data reader was disposed.
2022-09-21 12:19:57.809 +01:00 [DBG] Committing transaction.
2022-09-21 12:19:57.811 +01:00 [DBG] Committed transaction.
2022-09-21 12:19:57.812 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 12:19:57.814 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-21 12:19:57.815 +01:00 [DBG] Disposing transaction.
2022-09-21 12:19:57.817 +01:00 [DBG] An entity of type 'RefreshToken' tracked by 'PostgresContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 12:19:57.818 +01:00 [DBG] An entity of type 'User' tracked by 'PostgresContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 12:19:57.820 +01:00 [DBG] An entity of type 'RefreshToken' tracked by 'PostgresContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 12:19:57.821 +01:00 [DBG] SaveChanges completed for 'PostgresContext' with 3 entities written to the database.
2022-09-21 12:19:58.543 +01:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2022-09-21 12:19:58.549 +01:00 [DBG] Attempting to select an output formatter based on Accept header '["text/plain"]'.
2022-09-21 12:19:58.550 +01:00 [DBG] Could not find an output formatter based on content negotiation. Accepted types were (["text/plain"])
2022-09-21 12:19:58.551 +01:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2022-09-21 12:19:58.552 +01:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2022-09-21 12:19:58.553 +01:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2022-09-21 12:19:58.554 +01:00 [INF] Executing OkObjectResult, writing value of type 'APIBank.Models.Users.Responses.LoginResponse'.
2022-09-21 12:19:58.555 +01:00 [INF] Executed action APIBank.Controllers.UsersController.RefreshToken (APIBank) in 3571.4608ms
2022-09-21 12:19:58.557 +01:00 [INF] Executed endpoint 'APIBank.Controllers.UsersController.RefreshToken (APIBank)'
2022-09-21 12:20:00.664 +01:00 [DBG] 'PostgresContext' disposed.
2022-09-21 12:20:00.670 +01:00 [INF] Request finished HTTP/2 POST https://localhost:7036/api/Users/refreshToken - 0 - 200 - application/json;+charset=utf-8 5802.1964ms
2022-09-21 12:20:08.623 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/api/Users/1/refresh-tokens - -
2022-09-21 12:20:08.626 +01:00 [DBG] 1 candidate(s) found for the request path '/api/Users/1/refresh-tokens'
2022-09-21 12:20:08.627 +01:00 [DBG] Endpoint 'APIBank.Controllers.UsersController.GetRefreshTokens (APIBank)' with route pattern 'api/Users/{id}/refresh-tokens' is valid for the request path '/api/Users/1/refresh-tokens'
2022-09-21 12:20:08.630 +01:00 [DBG] Request matched endpoint 'APIBank.Controllers.UsersController.GetRefreshTokens (APIBank)'
2022-09-21 12:20:08.632 +01:00 [DBG] Static files was skipped as the request already matched an endpoint.
2022-09-21 12:20:08.633 +01:00 [INF] Entity Framework Core 6.0.9 initialized 'PostgresContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:6.0.7+5b98e4b74de93b590b44aef8dd7967c03acc433c' with options: None
2022-09-21 12:20:08.636 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-21 12:20:08.638 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2022-09-21 12:20:08.641 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-21 12:20:08.643 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 12:20:08.644 +01:00 [DBG] Executing DbCommand [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.id = @__p_0
LIMIT 1
2022-09-21 12:20:08.646 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.id = @__p_0
LIMIT 1
2022-09-21 12:20:08.648 +01:00 [DBG] Context 'PostgresContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 12:20:08.649 +01:00 [DBG] A data reader was disposed.
2022-09-21 12:20:08.650 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 12:20:08.650 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-21 12:20:08.651 +01:00 [INF] Executing endpoint 'APIBank.Controllers.UsersController.GetRefreshTokens (APIBank)'
2022-09-21 12:20:08.652 +01:00 [INF] Route matched with {action = "GetRefreshTokens", controller = "Users"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult GetRefreshTokens(Int32) on controller APIBank.Controllers.UsersController (APIBank).
2022-09-21 12:20:08.654 +01:00 [DBG] Execution plan of authorization filters (in the following order): ["APIBank.Authorization.AuthorizeAttribute"]
2022-09-21 12:20:08.659 +01:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2022-09-21 12:20:08.660 +01:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2022-09-21 12:20:08.661 +01:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2022-09-21 12:20:08.662 +01:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2022-09-21 12:20:08.663 +01:00 [DBG] Executing controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-21 12:20:08.664 +01:00 [DBG] Executed controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-21 12:20:08.665 +01:00 [DBG] Attempting to bind parameter 'id' of type 'System.Int32' ...
2022-09-21 12:20:08.666 +01:00 [DBG] Attempting to bind parameter 'id' of type 'System.Int32' using the name 'id' in request data ...
2022-09-21 12:20:08.667 +01:00 [DBG] Done attempting to bind parameter 'id' of type 'System.Int32'.
2022-09-21 12:20:08.668 +01:00 [DBG] Done attempting to bind parameter 'id' of type 'System.Int32'.
2022-09-21 12:20:08.668 +01:00 [DBG] Attempting to validate the bound parameter 'id' of type 'System.Int32' ...
2022-09-21 12:20:08.669 +01:00 [DBG] Done attempting to validate the bound parameter 'id' of type 'System.Int32'.
2022-09-21 12:20:20.245 +01:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2022-09-21 12:20:20.252 +01:00 [DBG] No information found on request to perform content negotiation.
2022-09-21 12:20:20.252 +01:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2022-09-21 12:20:20.253 +01:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2022-09-21 12:20:20.253 +01:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2022-09-21 12:20:20.254 +01:00 [INF] Executing OkObjectResult, writing value of type 'Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryable`1[[APIBank.ModelEntities.RefreshToken, APIBank, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2022-09-21 12:20:20.255 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-21 12:20:20.256 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2022-09-21 12:20:20.257 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-21 12:20:20.258 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 12:20:20.259 +01:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.user_id AS "UserId", r.token AS "RefToken", r.expires AS "Expires", r.created AS "Created", r.created_by_ip AS "CreatedByIp", r.revoked AS "Revoked", r.revoked_by_ip AS "RevokedByIp", r.replaced_by_token AS "ReplacedByToken", r.reason_revoked AS "ReasonRevoked", r.is_expired AS "IsExpired", r.is_revoked AS "IsRevoked", r.is_active AS "IsActive"
FROM refresh_token AS r
WHERE r.user_id = @__id_0
2022-09-21 12:20:20.268 +01:00 [INF] Executed DbCommand (9ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.user_id AS "UserId", r.token AS "RefToken", r.expires AS "Expires", r.created AS "Created", r.created_by_ip AS "CreatedByIp", r.revoked AS "Revoked", r.revoked_by_ip AS "RevokedByIp", r.replaced_by_token AS "ReplacedByToken", r.reason_revoked AS "ReasonRevoked", r.is_expired AS "IsExpired", r.is_revoked AS "IsRevoked", r.is_active AS "IsActive"
FROM refresh_token AS r
WHERE r.user_id = @__id_0
2022-09-21 12:20:20.271 +01:00 [DBG] A data reader was disposed.
2022-09-21 12:20:20.272 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 12:20:20.278 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-21 12:20:20.286 +01:00 [INF] Executed action APIBank.Controllers.UsersController.GetRefreshTokens (APIBank) in 11622.8582ms
2022-09-21 12:20:20.287 +01:00 [INF] Executed endpoint 'APIBank.Controllers.UsersController.GetRefreshTokens (APIBank)'
2022-09-21 12:20:20.288 +01:00 [DBG] 'PostgresContext' disposed.
2022-09-21 12:20:20.289 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/api/Users/1/refresh-tokens - - - 200 - application/json;+charset=utf-8 11665.8300ms
2022-09-21 12:26:52.067 +01:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2022-09-21 12:26:52.179 +01:00 [DBG] Hosting starting
2022-09-21 12:26:52.412 +01:00 [DBG] Using development certificate: CN=localhost (Thumbprint: 9CC642E9838495A6C3C202DECA6A8AD300396DD2)
2022-09-21 12:26:52.471 +01:00 [INF] Now listening on: https://localhost:7036
2022-09-21 12:26:52.486 +01:00 [INF] Now listening on: http://localhost:5036
2022-09-21 12:26:52.488 +01:00 [DBG] Loaded hosting startup assembly APIBank
2022-09-21 12:26:52.489 +01:00 [DBG] Loaded hosting startup assembly Microsoft.AspNetCore.Watch.BrowserRefresh
2022-09-21 12:26:52.490 +01:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.BrowserLink.Net
2022-09-21 12:26:52.492 +01:00 [INF] Application started. Press Ctrl+C to shut down.
2022-09-21 12:26:52.493 +01:00 [INF] Hosting environment: Development
2022-09-21 12:26:52.493 +01:00 [INF] Content root path: C:\Users\mguedesa\OneDrive - NTT DATA EMEAL\Documentos\GitHub\OpenBankAPI-NTT\APIBank\APIBank\
2022-09-21 12:26:52.495 +01:00 [DBG] Hosting started
2022-09-21 12:26:52.715 +01:00 [DBG] Connection id "0HMKROGNCGLLF" accepted.
2022-09-21 12:26:52.715 +01:00 [DBG] Connection id "0HMKROGNCGLLE" accepted.
2022-09-21 12:26:52.724 +01:00 [DBG] Connection id "0HMKROGNCGLLF" started.
2022-09-21 12:26:52.724 +01:00 [DBG] Connection id "0HMKROGNCGLLE" started.
2022-09-21 12:26:52.727 +01:00 [DBG] Connection id "0HMKROGNCGLLF" received FIN.
2022-09-21 12:26:52.727 +01:00 [DBG] Connection id "0HMKROGNCGLLE" received FIN.
2022-09-21 12:26:52.756 +01:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException:  Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveBlobAsync[TIOAdapter](TIOAdapter adapter)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](TIOAdapter adapter, Boolean receiveFirst, Byte[] reAuthenticationData, Boolean isApm)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2022-09-21 12:26:52.756 +01:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException:  Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveBlobAsync[TIOAdapter](TIOAdapter adapter)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](TIOAdapter adapter, Boolean receiveFirst, Byte[] reAuthenticationData, Boolean isApm)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2022-09-21 12:26:52.807 +01:00 [DBG] Connection id "0HMKROGNCGLLE" stopped.
2022-09-21 12:26:52.807 +01:00 [DBG] Connection id "0HMKROGNCGLLF" stopped.
2022-09-21 12:26:52.811 +01:00 [DBG] Connection id "0HMKROGNCGLLE" sending FIN because: "The Socket transport's send loop completed gracefully."
2022-09-21 12:26:52.811 +01:00 [DBG] Connection id "0HMKROGNCGLLF" sending FIN because: "The Socket transport's send loop completed gracefully."
2022-09-21 12:26:52.870 +01:00 [DBG] Connection id "0HMKROGNCGLLG" accepted.
2022-09-21 12:26:52.871 +01:00 [DBG] Connection id "0HMKROGNCGLLG" started.
2022-09-21 12:26:52.919 +01:00 [DBG] Connection 0HMKROGNCGLLG established using the following protocol: "Tls12"
2022-09-21 12:26:53.012 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/swagger/index.html - -
2022-09-21 12:26:53.055 +01:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2022-09-21 12:26:53.080 +01:00 [DBG] No candidates found for the request path '/swagger/index.html'
2022-09-21 12:26:53.082 +01:00 [DBG] Request did not match any endpoints
2022-09-21 12:26:53.208 +01:00 [DBG] Response markup is scheduled to include browser refresh script injection.
2022-09-21 12:26:53.382 +01:00 [DBG] Response markup was updated to include browser refresh script injection.
2022-09-21 12:26:53.402 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/swagger/index.html - - - 200 - text/html;charset=utf-8 390.0497ms
2022-09-21 12:26:53.409 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/_framework/aspnetcore-browser-refresh.js - -
2022-09-21 12:26:53.417 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/_vs/browserLink - -
2022-09-21 12:26:53.428 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/_framework/aspnetcore-browser-refresh.js - - - 200 11984 application/javascript;+charset=utf-8 18.9145ms
2022-09-21 12:26:53.450 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/_vs/browserLink - - - 200 - text/javascript;+charset=UTF-8 32.3207ms
2022-09-21 12:26:53.543 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/swagger/v1/swagger.json - -
2022-09-21 12:26:53.544 +01:00 [DBG] No candidates found for the request path '/swagger/v1/swagger.json'
2022-09-21 12:26:53.545 +01:00 [DBG] Request did not match any endpoints
2022-09-21 12:26:53.757 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/swagger/v1/swagger.json - - - 200 - application/json;charset=utf-8 214.2505ms
2022-09-21 12:27:06.011 +01:00 [INF] Request starting HTTP/2 POST https://localhost:7036/api/Users/Login application/json 58
2022-09-21 12:27:06.027 +01:00 [DBG] 1 candidate(s) found for the request path '/api/Users/Login'
2022-09-21 12:27:06.035 +01:00 [DBG] Endpoint 'APIBank.Controllers.UsersController.Login (APIBank)' with route pattern 'api/Users/Login' is valid for the request path '/api/Users/Login'
2022-09-21 12:27:06.045 +01:00 [DBG] Request matched endpoint 'APIBank.Controllers.UsersController.Login (APIBank)'
2022-09-21 12:27:06.048 +01:00 [DBG] Static files was skipped as the request already matched an endpoint.
2022-09-21 12:27:06.581 +01:00 [INF] Executing endpoint 'APIBank.Controllers.UsersController.Login (APIBank)'
2022-09-21 12:27:06.611 +01:00 [INF] Route matched with {action = "Login", controller = "Users"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult Login(APIBank.Models.Requests.LoginRequest) on controller APIBank.Controllers.UsersController (APIBank).
2022-09-21 12:27:06.616 +01:00 [DBG] Execution plan of authorization filters (in the following order): ["APIBank.Authorization.AuthorizeAttribute"]
2022-09-21 12:27:06.617 +01:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2022-09-21 12:27:06.618 +01:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2022-09-21 12:27:06.619 +01:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2022-09-21 12:27:06.620 +01:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2022-09-21 12:27:06.625 +01:00 [DBG] Executing controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-21 12:27:06.626 +01:00 [DBG] Executed controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-21 12:27:06.643 +01:00 [DBG] Attempting to bind parameter 'model' of type 'APIBank.Models.Requests.LoginRequest' ...
2022-09-21 12:27:06.648 +01:00 [DBG] Attempting to bind parameter 'model' of type 'APIBank.Models.Requests.LoginRequest' using the name '' in request data ...
2022-09-21 12:27:06.650 +01:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2022-09-21 12:27:06.656 +01:00 [DBG] Connection id "0HMKROGNCGLLG", Request id "0HMKROGNCGLLG:00000009": started reading request body.
2022-09-21 12:27:06.658 +01:00 [DBG] Connection id "0HMKROGNCGLLG", Request id "0HMKROGNCGLLG:00000009": done reading request body.
2022-09-21 12:27:06.665 +01:00 [DBG] JSON input formatter succeeded, deserializing to type 'APIBank.Models.Requests.LoginRequest'
2022-09-21 12:27:06.666 +01:00 [DBG] Done attempting to bind parameter 'model' of type 'APIBank.Models.Requests.LoginRequest'.
2022-09-21 12:27:06.667 +01:00 [DBG] Done attempting to bind parameter 'model' of type 'APIBank.Models.Requests.LoginRequest'.
2022-09-21 12:27:06.667 +01:00 [DBG] Attempting to validate the bound parameter 'model' of type 'APIBank.Models.Requests.LoginRequest' ...
2022-09-21 12:27:06.677 +01:00 [DBG] Done attempting to validate the bound parameter 'model' of type 'APIBank.Models.Requests.LoginRequest'.
2022-09-21 12:27:06.820 +01:00 [DBG] An additional 'IServiceProvider' was created for internal use by Entity Framework. An existing service provider was not used due to the following configuration changes: configuration changed for 'Core:ConfigureWarnings', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:UseAdminDatabase', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:SetPostgresVersion', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:UseRedshift', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:ReverseNullOrdering', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:RemoteCertificateValidationCallback', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:ProvideClientCertificatesCallback', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:ProvidePasswordCallback'.
2022-09-21 12:27:08.452 +01:00 [INF] Entity Framework Core 6.0.9 initialized 'PostgresContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:6.0.7+5b98e4b74de93b590b44aef8dd7967c03acc433c' with options: None
2022-09-21 12:27:08.532 +01:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .SingleOrDefault(x => x.Username == __model_Username_0)'
2022-09-21 12:27:09.084 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<User>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: User.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: User.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 1], [Property: User.Email (string) Required Index MaxLength(254), 2], [Property: User.FullName (string) Required MaxLength(100), 3], [Property: User.PasswordChangedAt (DateTime) Required ValueGenerated.OnAdd, 4], [Property: User.PasswordHash (string) Required MaxLength(200), 5], [Property: User.Username (string) Required Index MaxLength(50), 6] }
        SELECT TOP(2) u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
        FROM users AS u
        WHERE u.username == @__model_Username_0), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, User>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)
    .SingleOrDefault()'
2022-09-21 12:27:09.152 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-21 12:27:09.271 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (116ms).
2022-09-21 12:27:09.286 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-21 12:27:09.606 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 12:27:09.636 +01:00 [DBG] Executing DbCommand [Parameters=[@__model_Username_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.username = @__model_Username_0
LIMIT 2
2022-09-21 12:27:09.777 +01:00 [INF] Executed DbCommand (155ms) [Parameters=[@__model_Username_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.username = @__model_Username_0
LIMIT 2
2022-09-21 12:27:09.853 +01:00 [DBG] Context 'PostgresContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 12:27:09.923 +01:00 [DBG] A data reader was disposed.
2022-09-21 12:27:09.933 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 12:27:09.948 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-21 12:27:10.459 +01:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .Any(user => user.RefreshTokenCollection
        .Any(reftoken => reftoken.RefToken == __token_0))'
2022-09-21 12:27:10.614 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<bool>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            EmptyProjectionMember -> 0
        SELECT EXISTS (
            SELECT 1
            FROM users AS u
            WHERE EXISTS (
                SELECT 1
                FROM refresh_token AS r
                WHERE ((u.id != NULL) && (u.id == r.user_id)) && (r.token == @__token_0)))), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, bool>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)
    .Single()'
2022-09-21 12:27:10.631 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-21 12:27:10.633 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (2ms).
2022-09-21 12:27:10.635 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-21 12:27:10.638 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 12:27:10.639 +01:00 [DBG] Executing DbCommand [Parameters=[@__token_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM users AS u
    WHERE EXISTS (
        SELECT 1
        FROM refresh_token AS r
        WHERE (u.id = r.user_id) AND (r.token = @__token_0)))
2022-09-21 12:27:10.642 +01:00 [INF] Executed DbCommand (3ms) [Parameters=[@__token_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM users AS u
    WHERE EXISTS (
        SELECT 1
        FROM refresh_token AS r
        WHERE (u.id = r.user_id) AND (r.token = @__token_0)))
2022-09-21 12:27:10.646 +01:00 [DBG] A data reader was disposed.
2022-09-21 12:27:10.647 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 12:27:10.648 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-21 12:27:10.662 +01:00 [DBG] Compiling query expression: 
'DbSet<RefreshToken>()
    .Where(rt => rt.UserId == __id_0)
    .AsNoTracking()
    .Select(rt => new RefreshToken{ 
        Id = rt.Id, 
        UserId = rt.UserId, 
        RefToken = rt.RefToken, 
        Expires = rt.Expires, 
        Created = rt.Created, 
        CreatedByIp = rt.CreatedByIp, 
        Revoked = rt.Revoked, 
        RevokedByIp = rt.RevokedByIp, 
        ReplacedByToken = rt.ReplacedByToken, 
        ReasonRevoked = rt.ReasonRevoked, 
        IsExpired = rt.IsExpired, 
        IsRevoked = rt.IsRevoked, 
        IsActive = rt.IsActive 
    }
    )'
2022-09-21 12:27:10.693 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<RefreshToken>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            Id -> 0
            UserId -> 1
            RefToken -> 2
            Expires -> 3
            Created -> 4
            CreatedByIp -> 5
            Revoked -> 6
            RevokedByIp -> 7
            ReplacedByToken -> 8
            ReasonRevoked -> 9
            IsExpired -> 10
            IsRevoked -> 11
            IsActive -> 12
        SELECT r.id AS Id, r.user_id AS UserId, r.token AS RefToken, r.expires AS Expires, r.created AS Created, r.created_by_ip AS CreatedByIp, r.revoked AS Revoked, r.revoked_by_ip AS RevokedByIp, r.replaced_by_token AS ReplacedByToken, r.reason_revoked AS ReasonRevoked, r.is_expired AS IsExpired, r.is_revoked AS IsRevoked, r.is_active AS IsActive
        FROM refresh_token AS r
        WHERE r.user_id == @__id_0), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, RefreshToken>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)'
2022-09-21 12:27:10.699 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-21 12:27:10.700 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2022-09-21 12:27:10.701 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-21 12:27:10.703 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 12:27:10.705 +01:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.user_id AS "UserId", r.token AS "RefToken", r.expires AS "Expires", r.created AS "Created", r.created_by_ip AS "CreatedByIp", r.revoked AS "Revoked", r.revoked_by_ip AS "RevokedByIp", r.replaced_by_token AS "ReplacedByToken", r.reason_revoked AS "ReasonRevoked", r.is_expired AS "IsExpired", r.is_revoked AS "IsRevoked", r.is_active AS "IsActive"
FROM refresh_token AS r
WHERE r.user_id = @__id_0
2022-09-21 12:27:10.712 +01:00 [INF] Executed DbCommand (7ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.user_id AS "UserId", r.token AS "RefToken", r.expires AS "Expires", r.created AS "Created", r.created_by_ip AS "CreatedByIp", r.revoked AS "Revoked", r.revoked_by_ip AS "RevokedByIp", r.replaced_by_token AS "ReplacedByToken", r.reason_revoked AS "ReasonRevoked", r.is_expired AS "IsExpired", r.is_revoked AS "IsRevoked", r.is_active AS "IsActive"
FROM refresh_token AS r
WHERE r.user_id = @__id_0
2022-09-21 12:27:10.723 +01:00 [DBG] A data reader was disposed.
2022-09-21 12:27:10.725 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 12:27:10.727 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-21 12:27:10.748 +01:00 [DBG] An entity of type 'User' tracked by 'PostgresContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 12:27:44.647 +01:00 [INF] Executed action APIBank.Controllers.UsersController.Login (APIBank) in 38017.7506ms
2022-09-21 12:27:44.654 +01:00 [INF] Executed endpoint 'APIBank.Controllers.UsersController.Login (APIBank)'
2022-09-21 12:27:46.625 +01:00 [INF] Global Error was found:
2022-09-21 12:27:46.651 +01:00 [DBG] 'PostgresContext' disposed.
2022-09-21 12:27:46.664 +01:00 [INF] Request finished HTTP/2 POST https://localhost:7036/api/Users/Login application/json 58 - 500 - application/json 40653.4283ms
2022-09-21 12:28:31.266 +01:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2022-09-21 12:28:31.391 +01:00 [DBG] Hosting starting
2022-09-21 12:28:31.643 +01:00 [DBG] Using development certificate: CN=localhost (Thumbprint: 9CC642E9838495A6C3C202DECA6A8AD300396DD2)
2022-09-21 12:28:31.786 +01:00 [INF] Now listening on: https://localhost:7036
2022-09-21 12:28:31.789 +01:00 [INF] Now listening on: http://localhost:5036
2022-09-21 12:28:31.790 +01:00 [DBG] Loaded hosting startup assembly APIBank
2022-09-21 12:28:31.791 +01:00 [DBG] Loaded hosting startup assembly Microsoft.AspNetCore.Watch.BrowserRefresh
2022-09-21 12:28:31.792 +01:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.BrowserLink.Net
2022-09-21 12:28:31.793 +01:00 [INF] Application started. Press Ctrl+C to shut down.
2022-09-21 12:28:31.794 +01:00 [INF] Hosting environment: Development
2022-09-21 12:28:31.795 +01:00 [INF] Content root path: C:\Users\mguedesa\OneDrive - NTT DATA EMEAL\Documentos\GitHub\OpenBankAPI-NTT\APIBank\APIBank\
2022-09-21 12:28:31.796 +01:00 [DBG] Hosting started
2022-09-21 12:28:31.878 +01:00 [DBG] Connection id "0HMKROHKU4BAM" accepted.
2022-09-21 12:28:31.878 +01:00 [DBG] Connection id "0HMKROHKU4BAN" accepted.
2022-09-21 12:28:31.879 +01:00 [DBG] Connection id "0HMKROHKU4BAM" received FIN.
2022-09-21 12:28:31.879 +01:00 [DBG] Connection id "0HMKROHKU4BAN" received FIN.
2022-09-21 12:28:31.881 +01:00 [DBG] Connection id "0HMKROHKU4BAM" started.
2022-09-21 12:28:31.881 +01:00 [DBG] Connection id "0HMKROHKU4BAN" started.
2022-09-21 12:28:31.910 +01:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException:  Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveBlobAsync[TIOAdapter](TIOAdapter adapter)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](TIOAdapter adapter, Boolean receiveFirst, Byte[] reAuthenticationData, Boolean isApm)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2022-09-21 12:28:31.910 +01:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException:  Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveBlobAsync[TIOAdapter](TIOAdapter adapter)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](TIOAdapter adapter, Boolean receiveFirst, Byte[] reAuthenticationData, Boolean isApm)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2022-09-21 12:28:31.976 +01:00 [DBG] Connection id "0HMKROHKU4BAN" stopped.
2022-09-21 12:28:31.976 +01:00 [DBG] Connection id "0HMKROHKU4BAM" stopped.
2022-09-21 12:28:31.981 +01:00 [DBG] Connection id "0HMKROHKU4BAN" sending FIN because: "The Socket transport's send loop completed gracefully."
2022-09-21 12:28:31.981 +01:00 [DBG] Connection id "0HMKROHKU4BAM" sending FIN because: "The Socket transport's send loop completed gracefully."
2022-09-21 12:28:32.055 +01:00 [DBG] Connection id "0HMKROHKU4BAO" accepted.
2022-09-21 12:28:32.058 +01:00 [DBG] Connection id "0HMKROHKU4BAO" started.
2022-09-21 12:28:32.123 +01:00 [DBG] Connection 0HMKROHKU4BAO established using the following protocol: "Tls12"
2022-09-21 12:28:32.209 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/swagger/index.html - -
2022-09-21 12:28:32.257 +01:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2022-09-21 12:28:32.279 +01:00 [DBG] No candidates found for the request path '/swagger/index.html'
2022-09-21 12:28:32.286 +01:00 [DBG] Request did not match any endpoints
2022-09-21 12:28:32.396 +01:00 [DBG] Response markup is scheduled to include browser refresh script injection.
2022-09-21 12:28:32.559 +01:00 [DBG] Response markup was updated to include browser refresh script injection.
2022-09-21 12:28:32.568 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/swagger/index.html - - - 200 - text/html;charset=utf-8 364.1876ms
2022-09-21 12:28:32.590 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/_framework/aspnetcore-browser-refresh.js - -
2022-09-21 12:28:32.590 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/_vs/browserLink - -
2022-09-21 12:28:32.603 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/_framework/aspnetcore-browser-refresh.js - - - 200 11984 application/javascript;+charset=utf-8 10.1237ms
2022-09-21 12:28:32.613 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/_vs/browserLink - - - 200 - text/javascript;+charset=UTF-8 23.2459ms
2022-09-21 12:28:32.691 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/swagger/v1/swagger.json - -
2022-09-21 12:28:32.693 +01:00 [DBG] No candidates found for the request path '/swagger/v1/swagger.json'
2022-09-21 12:28:32.694 +01:00 [DBG] Request did not match any endpoints
2022-09-21 12:28:32.896 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/swagger/v1/swagger.json - - - 200 - application/json;charset=utf-8 204.6157ms
2022-09-21 12:29:30.860 +01:00 [INF] Request starting HTTP/2 POST https://localhost:7036/api/Users/Login application/json 58
2022-09-21 12:29:30.895 +01:00 [DBG] 1 candidate(s) found for the request path '/api/Users/Login'
2022-09-21 12:29:30.904 +01:00 [DBG] Endpoint 'APIBank.Controllers.UsersController.Login (APIBank)' with route pattern 'api/Users/Login' is valid for the request path '/api/Users/Login'
2022-09-21 12:29:30.910 +01:00 [DBG] Request matched endpoint 'APIBank.Controllers.UsersController.Login (APIBank)'
2022-09-21 12:29:30.912 +01:00 [DBG] Static files was skipped as the request already matched an endpoint.
2022-09-21 12:29:31.390 +01:00 [INF] Executing endpoint 'APIBank.Controllers.UsersController.Login (APIBank)'
2022-09-21 12:29:31.421 +01:00 [INF] Route matched with {action = "Login", controller = "Users"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult Login(APIBank.Models.Requests.LoginRequest) on controller APIBank.Controllers.UsersController (APIBank).
2022-09-21 12:29:31.425 +01:00 [DBG] Execution plan of authorization filters (in the following order): ["APIBank.Authorization.AuthorizeAttribute"]
2022-09-21 12:29:31.426 +01:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2022-09-21 12:29:31.427 +01:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2022-09-21 12:29:31.429 +01:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2022-09-21 12:29:31.432 +01:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2022-09-21 12:29:31.434 +01:00 [DBG] Executing controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-21 12:29:31.437 +01:00 [DBG] Executed controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-21 12:29:31.457 +01:00 [DBG] Attempting to bind parameter 'model' of type 'APIBank.Models.Requests.LoginRequest' ...
2022-09-21 12:29:31.461 +01:00 [DBG] Attempting to bind parameter 'model' of type 'APIBank.Models.Requests.LoginRequest' using the name '' in request data ...
2022-09-21 12:29:31.465 +01:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2022-09-21 12:29:31.471 +01:00 [DBG] Connection id "0HMKROHKU4BAO", Request id "0HMKROHKU4BAO:00000009": started reading request body.
2022-09-21 12:29:31.472 +01:00 [DBG] Connection id "0HMKROHKU4BAO", Request id "0HMKROHKU4BAO:00000009": done reading request body.
2022-09-21 12:29:31.477 +01:00 [DBG] JSON input formatter succeeded, deserializing to type 'APIBank.Models.Requests.LoginRequest'
2022-09-21 12:29:31.478 +01:00 [DBG] Done attempting to bind parameter 'model' of type 'APIBank.Models.Requests.LoginRequest'.
2022-09-21 12:29:31.481 +01:00 [DBG] Done attempting to bind parameter 'model' of type 'APIBank.Models.Requests.LoginRequest'.
2022-09-21 12:29:31.483 +01:00 [DBG] Attempting to validate the bound parameter 'model' of type 'APIBank.Models.Requests.LoginRequest' ...
2022-09-21 12:29:31.490 +01:00 [DBG] Done attempting to validate the bound parameter 'model' of type 'APIBank.Models.Requests.LoginRequest'.
2022-09-21 12:29:31.620 +01:00 [DBG] An additional 'IServiceProvider' was created for internal use by Entity Framework. An existing service provider was not used due to the following configuration changes: configuration changed for 'Core:ConfigureWarnings', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:UseAdminDatabase', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:SetPostgresVersion', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:UseRedshift', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:ReverseNullOrdering', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:RemoteCertificateValidationCallback', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:ProvideClientCertificatesCallback', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:ProvidePasswordCallback'.
2022-09-21 12:29:33.305 +01:00 [INF] Entity Framework Core 6.0.9 initialized 'PostgresContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:6.0.7+5b98e4b74de93b590b44aef8dd7967c03acc433c' with options: None
2022-09-21 12:29:33.382 +01:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .SingleOrDefault(x => x.Username == __model_Username_0)'
2022-09-21 12:29:33.951 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<User>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: User.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: User.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 1], [Property: User.Email (string) Required Index MaxLength(254), 2], [Property: User.FullName (string) Required MaxLength(100), 3], [Property: User.PasswordChangedAt (DateTime) Required ValueGenerated.OnAdd, 4], [Property: User.PasswordHash (string) Required MaxLength(200), 5], [Property: User.Username (string) Required Index MaxLength(50), 6] }
        SELECT TOP(2) u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
        FROM users AS u
        WHERE u.username == @__model_Username_0), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, User>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)
    .SingleOrDefault()'
2022-09-21 12:29:34.040 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-21 12:29:34.144 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (101ms).
2022-09-21 12:29:34.156 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-21 12:29:34.526 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 12:29:34.559 +01:00 [DBG] Executing DbCommand [Parameters=[@__model_Username_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.username = @__model_Username_0
LIMIT 2
2022-09-21 12:29:34.705 +01:00 [INF] Executed DbCommand (163ms) [Parameters=[@__model_Username_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.username = @__model_Username_0
LIMIT 2
2022-09-21 12:29:34.787 +01:00 [DBG] Context 'PostgresContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 12:29:34.880 +01:00 [DBG] A data reader was disposed.
2022-09-21 12:29:34.891 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 12:29:34.911 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-21 12:29:35.414 +01:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .Any(user => user.RefreshTokenCollection
        .Any(reftoken => reftoken.RefToken == __token_0))'
2022-09-21 12:29:35.562 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<bool>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            EmptyProjectionMember -> 0
        SELECT EXISTS (
            SELECT 1
            FROM users AS u
            WHERE EXISTS (
                SELECT 1
                FROM refresh_token AS r
                WHERE ((u.id != NULL) && (u.id == r.user_id)) && (r.token == @__token_0)))), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, bool>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)
    .Single()'
2022-09-21 12:29:35.575 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-21 12:29:35.577 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2022-09-21 12:29:35.579 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-21 12:29:35.580 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 12:29:35.580 +01:00 [DBG] Executing DbCommand [Parameters=[@__token_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM users AS u
    WHERE EXISTS (
        SELECT 1
        FROM refresh_token AS r
        WHERE (u.id = r.user_id) AND (r.token = @__token_0)))
2022-09-21 12:29:35.583 +01:00 [INF] Executed DbCommand (3ms) [Parameters=[@__token_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM users AS u
    WHERE EXISTS (
        SELECT 1
        FROM refresh_token AS r
        WHERE (u.id = r.user_id) AND (r.token = @__token_0)))
2022-09-21 12:29:35.588 +01:00 [DBG] A data reader was disposed.
2022-09-21 12:29:35.590 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 12:29:35.590 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-21 12:29:35.602 +01:00 [DBG] Compiling query expression: 
'DbSet<RefreshToken>()
    .Where(rt => rt.UserId == __id_0)
    .AsNoTracking()
    .Select(rt => new RefreshToken{ 
        Id = rt.Id, 
        UserId = rt.UserId, 
        RefToken = rt.RefToken, 
        Expires = rt.Expires, 
        Created = rt.Created, 
        CreatedByIp = rt.CreatedByIp, 
        Revoked = rt.Revoked, 
        RevokedByIp = rt.RevokedByIp, 
        ReplacedByToken = rt.ReplacedByToken, 
        ReasonRevoked = rt.ReasonRevoked, 
        IsExpired = rt.IsExpired, 
        IsRevoked = rt.IsRevoked, 
        IsActive = rt.IsActive 
    }
    )'
2022-09-21 12:29:35.631 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<RefreshToken>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            Id -> 0
            UserId -> 1
            RefToken -> 2
            Expires -> 3
            Created -> 4
            CreatedByIp -> 5
            Revoked -> 6
            RevokedByIp -> 7
            ReplacedByToken -> 8
            ReasonRevoked -> 9
            IsExpired -> 10
            IsRevoked -> 11
            IsActive -> 12
        SELECT r.id AS Id, r.user_id AS UserId, r.token AS RefToken, r.expires AS Expires, r.created AS Created, r.created_by_ip AS CreatedByIp, r.revoked AS Revoked, r.revoked_by_ip AS RevokedByIp, r.replaced_by_token AS ReplacedByToken, r.reason_revoked AS ReasonRevoked, r.is_expired AS IsExpired, r.is_revoked AS IsRevoked, r.is_active AS IsActive
        FROM refresh_token AS r
        WHERE r.user_id == @__id_0), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, RefreshToken>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)'
2022-09-21 12:29:35.635 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-21 12:29:35.637 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (2ms).
2022-09-21 12:29:35.638 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-21 12:29:35.638 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 12:29:35.639 +01:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.user_id AS "UserId", r.token AS "RefToken", r.expires AS "Expires", r.created AS "Created", r.created_by_ip AS "CreatedByIp", r.revoked AS "Revoked", r.revoked_by_ip AS "RevokedByIp", r.replaced_by_token AS "ReplacedByToken", r.reason_revoked AS "ReasonRevoked", r.is_expired AS "IsExpired", r.is_revoked AS "IsRevoked", r.is_active AS "IsActive"
FROM refresh_token AS r
WHERE r.user_id = @__id_0
2022-09-21 12:29:35.647 +01:00 [INF] Executed DbCommand (8ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.user_id AS "UserId", r.token AS "RefToken", r.expires AS "Expires", r.created AS "Created", r.created_by_ip AS "CreatedByIp", r.revoked AS "Revoked", r.revoked_by_ip AS "RevokedByIp", r.replaced_by_token AS "ReplacedByToken", r.reason_revoked AS "ReasonRevoked", r.is_expired AS "IsExpired", r.is_revoked AS "IsRevoked", r.is_active AS "IsActive"
FROM refresh_token AS r
WHERE r.user_id = @__id_0
2022-09-21 12:29:35.650 +01:00 [DBG] A data reader was disposed.
2022-09-21 12:29:35.651 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 12:29:35.653 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-21 12:29:35.671 +01:00 [DBG] An entity of type 'User' tracked by 'PostgresContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 12:29:35.676 +01:00 [DBG] SaveChanges starting for 'PostgresContext'.
2022-09-21 12:29:35.681 +01:00 [DBG] DetectChanges starting for 'PostgresContext'.
2022-09-21 12:29:35.706 +01:00 [DBG] 1 entities were added and 0 entities were removed from navigation 'User.RefreshTokenCollection'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 12:29:35.742 +01:00 [DBG] 'PostgresContext' generated a temporary value for the property 'Id.RefreshToken'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 12:29:35.804 +01:00 [DBG] Context 'PostgresContext' started tracking 'RefreshToken' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 12:29:35.813 +01:00 [DBG] DetectChanges completed for 'PostgresContext'.
2022-09-21 12:29:35.831 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-21 12:29:35.834 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 12:29:35.837 +01:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2022-09-21 12:29:35.848 +01:00 [DBG] Began transaction with isolation level 'ReadCommitted'.
2022-09-21 12:29:35.928 +01:00 [DBG] Executing 2 update commands as a batch.
2022-09-21 12:29:35.966 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-21 12:29:35.970 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (3ms).
2022-09-21 12:29:35.971 +01:00 [DBG] Executing DbCommand [Parameters=[@p0='?' (DbType = DateTime), @p1='?', @p2='?' (DbType = DateTime), @p3='?' (DbType = Boolean), @p4='?' (DbType = Boolean), @p5='?' (DbType = Boolean), @p6='?', @p7='?', @p8='?', @p9='?' (DbType = DateTime), @p10='?', @p11='?' (DbType = Int32), @p18='?' (DbType = Int32), @p12='?' (DbType = DateTime), @p13='?', @p14='?', @p15='?' (DbType = DateTime), @p16='?', @p17='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO refresh_token (created, created_by_ip, expires, is_active, is_expired, is_revoked, reason_revoked, token, replaced_by_token, revoked, revoked_by_ip, user_id)
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11)
RETURNING id;
UPDATE users SET created_at = @p12, email = @p13, full_name = @p14, password_changed_at = @p15, password_hash = @p16, username = @p17
WHERE id = @p18;
2022-09-21 12:29:35.985 +01:00 [INF] Executed DbCommand (14ms) [Parameters=[@p0='?' (DbType = DateTime), @p1='?', @p2='?' (DbType = DateTime), @p3='?' (DbType = Boolean), @p4='?' (DbType = Boolean), @p5='?' (DbType = Boolean), @p6='?', @p7='?', @p8='?', @p9='?' (DbType = DateTime), @p10='?', @p11='?' (DbType = Int32), @p18='?' (DbType = Int32), @p12='?' (DbType = DateTime), @p13='?', @p14='?', @p15='?' (DbType = DateTime), @p16='?', @p17='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO refresh_token (created, created_by_ip, expires, is_active, is_expired, is_revoked, reason_revoked, token, replaced_by_token, revoked, revoked_by_ip, user_id)
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11)
RETURNING id;
UPDATE users SET created_at = @p12, email = @p13, full_name = @p14, password_changed_at = @p15, password_hash = @p16, username = @p17
WHERE id = @p18;
2022-09-21 12:29:36.011 +01:00 [DBG] The foreign key property 'RefreshToken.Id' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2022-09-21 12:29:36.019 +01:00 [DBG] A data reader was disposed.
2022-09-21 12:29:36.025 +01:00 [DBG] Committing transaction.
2022-09-21 12:29:36.044 +01:00 [DBG] Committed transaction.
2022-09-21 12:29:36.046 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 12:29:36.049 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-21 12:29:36.052 +01:00 [DBG] Disposing transaction.
2022-09-21 12:29:36.056 +01:00 [DBG] An entity of type 'RefreshToken' tracked by 'PostgresContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 12:29:36.061 +01:00 [DBG] An entity of type 'User' tracked by 'PostgresContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 12:29:36.066 +01:00 [DBG] SaveChanges completed for 'PostgresContext' with 2 entities written to the database.
2022-09-21 12:29:36.068 +01:00 [DBG] An entity of type 'User' tracked by 'PostgresContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 12:29:36.072 +01:00 [DBG] An entity of type 'RefreshToken' tracked by 'PostgresContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 12:29:36.073 +01:00 [DBG] SaveChanges starting for 'PostgresContext'.
2022-09-21 12:29:36.075 +01:00 [DBG] DetectChanges starting for 'PostgresContext'.
2022-09-21 12:29:36.078 +01:00 [DBG] DetectChanges completed for 'PostgresContext'.
2022-09-21 12:29:36.080 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-21 12:29:36.081 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 12:29:36.082 +01:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2022-09-21 12:29:36.083 +01:00 [DBG] Began transaction with isolation level 'ReadCommitted'.
2022-09-21 12:29:36.088 +01:00 [DBG] Executing 2 update commands as a batch.
2022-09-21 12:29:36.089 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-21 12:29:36.090 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2022-09-21 12:29:36.090 +01:00 [DBG] Executing DbCommand [Parameters=[@p12='?' (DbType = Int32), @p0='?' (DbType = DateTime), @p1='?', @p2='?' (DbType = DateTime), @p3='?' (DbType = Boolean), @p4='?' (DbType = Boolean), @p5='?' (DbType = Boolean), @p6='?', @p7='?', @p8='?', @p9='?' (DbType = DateTime), @p10='?', @p11='?' (DbType = Int32), @p19='?' (DbType = Int32), @p13='?' (DbType = DateTime), @p14='?', @p15='?', @p16='?' (DbType = DateTime), @p17='?', @p18='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE refresh_token SET created = @p0, created_by_ip = @p1, expires = @p2, is_active = @p3, is_expired = @p4, is_revoked = @p5, reason_revoked = @p6, token = @p7, replaced_by_token = @p8, revoked = @p9, revoked_by_ip = @p10, user_id = @p11
WHERE id = @p12;
UPDATE users SET created_at = @p13, email = @p14, full_name = @p15, password_changed_at = @p16, password_hash = @p17, username = @p18
WHERE id = @p19;
2022-09-21 12:29:36.095 +01:00 [INF] Executed DbCommand (5ms) [Parameters=[@p12='?' (DbType = Int32), @p0='?' (DbType = DateTime), @p1='?', @p2='?' (DbType = DateTime), @p3='?' (DbType = Boolean), @p4='?' (DbType = Boolean), @p5='?' (DbType = Boolean), @p6='?', @p7='?', @p8='?', @p9='?' (DbType = DateTime), @p10='?', @p11='?' (DbType = Int32), @p19='?' (DbType = Int32), @p13='?' (DbType = DateTime), @p14='?', @p15='?', @p16='?' (DbType = DateTime), @p17='?', @p18='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE refresh_token SET created = @p0, created_by_ip = @p1, expires = @p2, is_active = @p3, is_expired = @p4, is_revoked = @p5, reason_revoked = @p6, token = @p7, replaced_by_token = @p8, revoked = @p9, revoked_by_ip = @p10, user_id = @p11
WHERE id = @p12;
UPDATE users SET created_at = @p13, email = @p14, full_name = @p15, password_changed_at = @p16, password_hash = @p17, username = @p18
WHERE id = @p19;
2022-09-21 12:29:36.098 +01:00 [DBG] A data reader was disposed.
2022-09-21 12:29:36.098 +01:00 [DBG] Committing transaction.
2022-09-21 12:29:36.100 +01:00 [DBG] Committed transaction.
2022-09-21 12:29:36.101 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 12:29:36.102 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-21 12:29:36.102 +01:00 [DBG] Disposing transaction.
2022-09-21 12:29:36.103 +01:00 [DBG] An entity of type 'User' tracked by 'PostgresContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 12:29:36.104 +01:00 [DBG] An entity of type 'RefreshToken' tracked by 'PostgresContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 12:29:36.105 +01:00 [DBG] SaveChanges completed for 'PostgresContext' with 2 entities written to the database.
2022-09-21 12:29:36.112 +01:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2022-09-21 12:29:36.119 +01:00 [DBG] Attempting to select an output formatter based on Accept header '["text/plain"]'.
2022-09-21 12:29:36.120 +01:00 [DBG] Could not find an output formatter based on content negotiation. Accepted types were (["text/plain"])
2022-09-21 12:29:36.121 +01:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2022-09-21 12:29:36.122 +01:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2022-09-21 12:29:36.123 +01:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2022-09-21 12:29:36.124 +01:00 [INF] Executing OkObjectResult, writing value of type 'APIBank.Models.Users.Responses.LoginResponse'.
2022-09-21 12:29:36.144 +01:00 [INF] Executed action APIBank.Controllers.UsersController.Login (APIBank) in 4704.0475ms
2022-09-21 12:29:36.146 +01:00 [INF] Executed endpoint 'APIBank.Controllers.UsersController.Login (APIBank)'
2022-09-21 12:29:36.151 +01:00 [DBG] 'PostgresContext' disposed.
2022-09-21 12:29:36.157 +01:00 [INF] Request finished HTTP/2 POST https://localhost:7036/api/Users/Login application/json 58 - 200 - application/json;+charset=utf-8 5298.1318ms
2022-09-21 12:30:58.116 +01:00 [INF] Request starting HTTP/2 POST https://localhost:7036/api/Users/refreshToken - 0
2022-09-21 12:30:58.138 +01:00 [DBG] 1 candidate(s) found for the request path '/api/Users/refreshToken'
2022-09-21 12:30:58.145 +01:00 [DBG] Endpoint 'APIBank.Controllers.UsersController.RefreshToken (APIBank)' with route pattern 'api/Users/refreshToken' is valid for the request path '/api/Users/refreshToken'
2022-09-21 12:30:58.147 +01:00 [DBG] Request matched endpoint 'APIBank.Controllers.UsersController.RefreshToken (APIBank)'
2022-09-21 12:30:58.148 +01:00 [DBG] Static files was skipped as the request already matched an endpoint.
2022-09-21 12:30:58.285 +01:00 [INF] Entity Framework Core 6.0.9 initialized 'PostgresContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:6.0.7+5b98e4b74de93b590b44aef8dd7967c03acc433c' with options: None
2022-09-21 12:30:58.307 +01:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .FirstOrDefault(e => EF.Property<int>(e, "Id") == __p_0)'
2022-09-21 12:30:58.312 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<User>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: User.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: User.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 1], [Property: User.Email (string) Required Index MaxLength(254), 2], [Property: User.FullName (string) Required MaxLength(100), 3], [Property: User.PasswordChangedAt (DateTime) Required ValueGenerated.OnAdd, 4], [Property: User.PasswordHash (string) Required MaxLength(200), 5], [Property: User.Username (string) Required Index MaxLength(50), 6] }
        SELECT TOP(1) u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
        FROM users AS u
        WHERE u.id == @__p_0), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, User>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)
    .SingleOrDefault()'
2022-09-21 12:30:58.314 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-21 12:30:58.315 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2022-09-21 12:30:58.316 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-21 12:30:58.317 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 12:30:58.318 +01:00 [DBG] Executing DbCommand [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.id = @__p_0
LIMIT 1
2022-09-21 12:30:58.322 +01:00 [INF] Executed DbCommand (4ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.id = @__p_0
LIMIT 1
2022-09-21 12:30:58.325 +01:00 [DBG] Context 'PostgresContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 12:30:58.326 +01:00 [DBG] A data reader was disposed.
2022-09-21 12:30:58.326 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 12:30:58.327 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-21 12:30:58.328 +01:00 [INF] Executing endpoint 'APIBank.Controllers.UsersController.RefreshToken (APIBank)'
2022-09-21 12:30:58.330 +01:00 [INF] Route matched with {action = "RefreshToken", controller = "Users"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult RefreshToken() on controller APIBank.Controllers.UsersController (APIBank).
2022-09-21 12:30:58.332 +01:00 [DBG] Execution plan of authorization filters (in the following order): ["APIBank.Authorization.AuthorizeAttribute"]
2022-09-21 12:30:58.333 +01:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2022-09-21 12:30:58.334 +01:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2022-09-21 12:30:58.335 +01:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2022-09-21 12:30:58.337 +01:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2022-09-21 12:30:58.339 +01:00 [DBG] Executing controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-21 12:30:58.340 +01:00 [DBG] Executed controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-21 12:31:08.586 +01:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .SingleOrDefault(userQuery => userQuery.RefreshTokenCollection
        .Any(refTokenQuery => refTokenQuery.RefToken == __refToken_0))'
2022-09-21 12:31:08.595 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<User>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: User.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: User.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 1], [Property: User.Email (string) Required Index MaxLength(254), 2], [Property: User.FullName (string) Required MaxLength(100), 3], [Property: User.PasswordChangedAt (DateTime) Required ValueGenerated.OnAdd, 4], [Property: User.PasswordHash (string) Required MaxLength(200), 5], [Property: User.Username (string) Required Index MaxLength(50), 6] }
        SELECT TOP(2) u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
        FROM users AS u
        WHERE EXISTS (
            SELECT 1
            FROM refresh_token AS r
            WHERE ((u.id != NULL) && (u.id == r.user_id)) && (r.token == @__refToken_0))), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, User>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)
    .SingleOrDefault()'
2022-09-21 12:31:08.599 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-21 12:31:08.600 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2022-09-21 12:31:08.601 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-21 12:31:08.602 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 12:31:08.603 +01:00 [DBG] Executing DbCommand [Parameters=[@__refToken_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE EXISTS (
    SELECT 1
    FROM refresh_token AS r
    WHERE (u.id = r.user_id) AND (r.token = @__refToken_0))
LIMIT 2
2022-09-21 12:31:08.606 +01:00 [INF] Executed DbCommand (3ms) [Parameters=[@__refToken_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE EXISTS (
    SELECT 1
    FROM refresh_token AS r
    WHERE (u.id = r.user_id) AND (r.token = @__refToken_0))
LIMIT 2
2022-09-21 12:31:08.608 +01:00 [DBG] A data reader was disposed.
2022-09-21 12:31:08.608 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 12:31:08.609 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-21 12:31:09.017 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-21 12:31:09.019 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (2ms).
2022-09-21 12:31:09.020 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-21 12:31:09.021 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 12:31:09.022 +01:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.user_id AS "UserId", r.token AS "RefToken", r.expires AS "Expires", r.created AS "Created", r.created_by_ip AS "CreatedByIp", r.revoked AS "Revoked", r.revoked_by_ip AS "RevokedByIp", r.replaced_by_token AS "ReplacedByToken", r.reason_revoked AS "ReasonRevoked", r.is_expired AS "IsExpired", r.is_revoked AS "IsRevoked", r.is_active AS "IsActive"
FROM refresh_token AS r
WHERE r.user_id = @__id_0
2022-09-21 12:31:09.024 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.user_id AS "UserId", r.token AS "RefToken", r.expires AS "Expires", r.created AS "Created", r.created_by_ip AS "CreatedByIp", r.revoked AS "Revoked", r.revoked_by_ip AS "RevokedByIp", r.replaced_by_token AS "ReplacedByToken", r.reason_revoked AS "ReasonRevoked", r.is_expired AS "IsExpired", r.is_revoked AS "IsRevoked", r.is_active AS "IsActive"
FROM refresh_token AS r
WHERE r.user_id = @__id_0
2022-09-21 12:31:09.025 +01:00 [DBG] A data reader was disposed.
2022-09-21 12:31:09.032 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 12:31:09.033 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-21 12:31:10.240 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-21 12:31:10.247 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (6ms).
2022-09-21 12:31:10.249 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-21 12:31:10.250 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 12:31:10.251 +01:00 [DBG] Executing DbCommand [Parameters=[@__token_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM users AS u
    WHERE EXISTS (
        SELECT 1
        FROM refresh_token AS r
        WHERE (u.id = r.user_id) AND (r.token = @__token_0)))
2022-09-21 12:31:10.254 +01:00 [INF] Executed DbCommand (3ms) [Parameters=[@__token_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM users AS u
    WHERE EXISTS (
        SELECT 1
        FROM refresh_token AS r
        WHERE (u.id = r.user_id) AND (r.token = @__token_0)))
2022-09-21 12:31:10.256 +01:00 [DBG] A data reader was disposed.
2022-09-21 12:31:10.257 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 12:31:10.257 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-21 12:31:11.267 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-21 12:31:11.269 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2022-09-21 12:31:11.270 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-21 12:31:11.271 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 12:31:11.273 +01:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.user_id AS "UserId", r.token AS "RefToken", r.expires AS "Expires", r.created AS "Created", r.created_by_ip AS "CreatedByIp", r.revoked AS "Revoked", r.revoked_by_ip AS "RevokedByIp", r.replaced_by_token AS "ReplacedByToken", r.reason_revoked AS "ReasonRevoked", r.is_expired AS "IsExpired", r.is_revoked AS "IsRevoked", r.is_active AS "IsActive"
FROM refresh_token AS r
WHERE r.user_id = @__id_0
2022-09-21 12:31:11.277 +01:00 [INF] Executed DbCommand (4ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.user_id AS "UserId", r.token AS "RefToken", r.expires AS "Expires", r.created AS "Created", r.created_by_ip AS "CreatedByIp", r.revoked AS "Revoked", r.revoked_by_ip AS "RevokedByIp", r.replaced_by_token AS "ReplacedByToken", r.reason_revoked AS "ReasonRevoked", r.is_expired AS "IsExpired", r.is_revoked AS "IsRevoked", r.is_active AS "IsActive"
FROM refresh_token AS r
WHERE r.user_id = @__id_0
2022-09-21 12:31:11.280 +01:00 [DBG] A data reader was disposed.
2022-09-21 12:31:11.281 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 12:31:11.282 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-21 12:31:11.282 +01:00 [DBG] An entity of type 'User' tracked by 'PostgresContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 12:31:11.284 +01:00 [DBG] SaveChanges starting for 'PostgresContext'.
2022-09-21 12:31:11.284 +01:00 [DBG] DetectChanges starting for 'PostgresContext'.
2022-09-21 12:31:11.285 +01:00 [DBG] 1 entities were added and 0 entities were removed from navigation 'User.RefreshTokenCollection'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 12:31:11.287 +01:00 [DBG] 'PostgresContext' generated a temporary value for the property 'Id.RefreshToken'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 12:31:11.288 +01:00 [DBG] Context 'PostgresContext' started tracking 'RefreshToken' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 12:31:11.289 +01:00 [DBG] DetectChanges completed for 'PostgresContext'.
2022-09-21 12:31:11.290 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-21 12:31:11.291 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 12:31:11.293 +01:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2022-09-21 12:31:11.294 +01:00 [DBG] Began transaction with isolation level 'ReadCommitted'.
2022-09-21 12:31:11.295 +01:00 [DBG] Executing 2 update commands as a batch.
2022-09-21 12:31:11.296 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-21 12:31:11.296 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2022-09-21 12:31:11.297 +01:00 [DBG] Executing DbCommand [Parameters=[@p0='?' (DbType = DateTime), @p1='?', @p2='?' (DbType = DateTime), @p3='?' (DbType = Boolean), @p4='?' (DbType = Boolean), @p5='?' (DbType = Boolean), @p6='?', @p7='?', @p8='?', @p9='?' (DbType = DateTime), @p10='?', @p11='?' (DbType = Int32), @p18='?' (DbType = Int32), @p12='?' (DbType = DateTime), @p13='?', @p14='?', @p15='?' (DbType = DateTime), @p16='?', @p17='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO refresh_token (created, created_by_ip, expires, is_active, is_expired, is_revoked, reason_revoked, token, replaced_by_token, revoked, revoked_by_ip, user_id)
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11)
RETURNING id;
UPDATE users SET created_at = @p12, email = @p13, full_name = @p14, password_changed_at = @p15, password_hash = @p16, username = @p17
WHERE id = @p18;
2022-09-21 12:31:11.300 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[@p0='?' (DbType = DateTime), @p1='?', @p2='?' (DbType = DateTime), @p3='?' (DbType = Boolean), @p4='?' (DbType = Boolean), @p5='?' (DbType = Boolean), @p6='?', @p7='?', @p8='?', @p9='?' (DbType = DateTime), @p10='?', @p11='?' (DbType = Int32), @p18='?' (DbType = Int32), @p12='?' (DbType = DateTime), @p13='?', @p14='?', @p15='?' (DbType = DateTime), @p16='?', @p17='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO refresh_token (created, created_by_ip, expires, is_active, is_expired, is_revoked, reason_revoked, token, replaced_by_token, revoked, revoked_by_ip, user_id)
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11)
RETURNING id;
UPDATE users SET created_at = @p12, email = @p13, full_name = @p14, password_changed_at = @p15, password_hash = @p16, username = @p17
WHERE id = @p18;
2022-09-21 12:31:11.304 +01:00 [DBG] The foreign key property 'RefreshToken.Id' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2022-09-21 12:31:11.306 +01:00 [DBG] A data reader was disposed.
2022-09-21 12:31:11.307 +01:00 [DBG] Committing transaction.
2022-09-21 12:31:11.310 +01:00 [DBG] Committed transaction.
2022-09-21 12:31:11.312 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 12:31:11.313 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-21 12:31:11.314 +01:00 [DBG] Disposing transaction.
2022-09-21 12:31:11.315 +01:00 [DBG] An entity of type 'RefreshToken' tracked by 'PostgresContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 12:31:11.316 +01:00 [DBG] An entity of type 'User' tracked by 'PostgresContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 12:31:11.318 +01:00 [DBG] SaveChanges completed for 'PostgresContext' with 2 entities written to the database.
2022-09-21 12:31:11.814 +01:00 [DBG] An entity of type 'User' tracked by 'PostgresContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 12:31:12.170 +01:00 [DBG] An entity of type 'RefreshToken' tracked by 'PostgresContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 12:31:12.967 +01:00 [DBG] SaveChanges starting for 'PostgresContext'.
2022-09-21 12:31:12.969 +01:00 [DBG] DetectChanges starting for 'PostgresContext'.
2022-09-21 12:31:12.970 +01:00 [DBG] DetectChanges completed for 'PostgresContext'.
2022-09-21 12:31:12.971 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-21 12:31:12.972 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 12:31:12.973 +01:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2022-09-21 12:31:12.975 +01:00 [DBG] Began transaction with isolation level 'ReadCommitted'.
2022-09-21 12:31:12.977 +01:00 [DBG] Executing 2 update commands as a batch.
2022-09-21 12:31:12.977 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-21 12:31:12.978 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2022-09-21 12:31:12.979 +01:00 [DBG] Executing DbCommand [Parameters=[@p12='?' (DbType = Int32), @p0='?' (DbType = DateTime), @p1='?', @p2='?' (DbType = DateTime), @p3='?' (DbType = Boolean), @p4='?' (DbType = Boolean), @p5='?' (DbType = Boolean), @p6='?', @p7='?', @p8='?', @p9='?' (DbType = DateTime), @p10='?', @p11='?' (DbType = Int32), @p19='?' (DbType = Int32), @p13='?' (DbType = DateTime), @p14='?', @p15='?', @p16='?' (DbType = DateTime), @p17='?', @p18='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE refresh_token SET created = @p0, created_by_ip = @p1, expires = @p2, is_active = @p3, is_expired = @p4, is_revoked = @p5, reason_revoked = @p6, token = @p7, replaced_by_token = @p8, revoked = @p9, revoked_by_ip = @p10, user_id = @p11
WHERE id = @p12;
UPDATE users SET created_at = @p13, email = @p14, full_name = @p15, password_changed_at = @p16, password_hash = @p17, username = @p18
WHERE id = @p19;
2022-09-21 12:31:12.981 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[@p12='?' (DbType = Int32), @p0='?' (DbType = DateTime), @p1='?', @p2='?' (DbType = DateTime), @p3='?' (DbType = Boolean), @p4='?' (DbType = Boolean), @p5='?' (DbType = Boolean), @p6='?', @p7='?', @p8='?', @p9='?' (DbType = DateTime), @p10='?', @p11='?' (DbType = Int32), @p19='?' (DbType = Int32), @p13='?' (DbType = DateTime), @p14='?', @p15='?', @p16='?' (DbType = DateTime), @p17='?', @p18='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE refresh_token SET created = @p0, created_by_ip = @p1, expires = @p2, is_active = @p3, is_expired = @p4, is_revoked = @p5, reason_revoked = @p6, token = @p7, replaced_by_token = @p8, revoked = @p9, revoked_by_ip = @p10, user_id = @p11
WHERE id = @p12;
UPDATE users SET created_at = @p13, email = @p14, full_name = @p15, password_changed_at = @p16, password_hash = @p17, username = @p18
WHERE id = @p19;
2022-09-21 12:31:12.983 +01:00 [DBG] A data reader was disposed.
2022-09-21 12:31:12.984 +01:00 [DBG] Committing transaction.
2022-09-21 12:31:12.985 +01:00 [DBG] Committed transaction.
2022-09-21 12:31:12.986 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 12:31:12.986 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-21 12:31:12.987 +01:00 [DBG] Disposing transaction.
2022-09-21 12:31:12.988 +01:00 [DBG] An entity of type 'User' tracked by 'PostgresContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 12:31:12.992 +01:00 [DBG] An entity of type 'RefreshToken' tracked by 'PostgresContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 12:31:12.995 +01:00 [DBG] SaveChanges completed for 'PostgresContext' with 2 entities written to the database.
2022-09-21 12:31:15.952 +01:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2022-09-21 12:31:15.959 +01:00 [DBG] Attempting to select an output formatter based on Accept header '["text/plain"]'.
2022-09-21 12:31:15.960 +01:00 [DBG] Could not find an output formatter based on content negotiation. Accepted types were (["text/plain"])
2022-09-21 12:31:15.962 +01:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2022-09-21 12:31:15.962 +01:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2022-09-21 12:31:15.963 +01:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2022-09-21 12:31:15.964 +01:00 [INF] Executing OkObjectResult, writing value of type 'APIBank.Models.Users.Responses.LoginResponse'.
2022-09-21 12:31:15.965 +01:00 [INF] Executed action APIBank.Controllers.UsersController.RefreshToken (APIBank) in 17626.0204ms
2022-09-21 12:31:15.967 +01:00 [INF] Executed endpoint 'APIBank.Controllers.UsersController.RefreshToken (APIBank)'
2022-09-21 12:31:15.969 +01:00 [DBG] 'PostgresContext' disposed.
2022-09-21 12:31:15.970 +01:00 [INF] Request finished HTTP/2 POST https://localhost:7036/api/Users/refreshToken - 0 - 200 - application/json;+charset=utf-8 17854.3138ms
2022-09-21 12:31:24.781 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/api/Users/1/refresh-tokens - -
2022-09-21 12:31:24.785 +01:00 [DBG] 1 candidate(s) found for the request path '/api/Users/1/refresh-tokens'
2022-09-21 12:31:24.787 +01:00 [DBG] Endpoint 'APIBank.Controllers.UsersController.GetRefreshTokens (APIBank)' with route pattern 'api/Users/{id}/refresh-tokens' is valid for the request path '/api/Users/1/refresh-tokens'
2022-09-21 12:31:24.791 +01:00 [DBG] Request matched endpoint 'APIBank.Controllers.UsersController.GetRefreshTokens (APIBank)'
2022-09-21 12:31:24.792 +01:00 [DBG] Static files was skipped as the request already matched an endpoint.
2022-09-21 12:31:24.843 +01:00 [INF] Entity Framework Core 6.0.9 initialized 'PostgresContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:6.0.7+5b98e4b74de93b590b44aef8dd7967c03acc433c' with options: None
2022-09-21 12:31:24.852 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-21 12:31:24.853 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2022-09-21 12:31:24.854 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-21 12:31:24.855 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 12:31:24.856 +01:00 [DBG] Executing DbCommand [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.id = @__p_0
LIMIT 1
2022-09-21 12:31:24.858 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.id = @__p_0
LIMIT 1
2022-09-21 12:31:24.860 +01:00 [DBG] Context 'PostgresContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 12:31:24.861 +01:00 [DBG] A data reader was disposed.
2022-09-21 12:31:24.862 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 12:31:24.863 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-21 12:31:24.864 +01:00 [INF] Executing endpoint 'APIBank.Controllers.UsersController.GetRefreshTokens (APIBank)'
2022-09-21 12:31:24.868 +01:00 [INF] Route matched with {action = "GetRefreshTokens", controller = "Users"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult GetRefreshTokens(Int32) on controller APIBank.Controllers.UsersController (APIBank).
2022-09-21 12:31:24.872 +01:00 [DBG] Execution plan of authorization filters (in the following order): ["APIBank.Authorization.AuthorizeAttribute"]
2022-09-21 12:31:24.874 +01:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2022-09-21 12:31:24.876 +01:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2022-09-21 12:31:24.879 +01:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2022-09-21 12:31:24.881 +01:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2022-09-21 12:31:24.883 +01:00 [DBG] Executing controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-21 12:31:24.886 +01:00 [DBG] Executed controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-21 12:31:24.888 +01:00 [DBG] Attempting to bind parameter 'id' of type 'System.Int32' ...
2022-09-21 12:31:24.892 +01:00 [DBG] Attempting to bind parameter 'id' of type 'System.Int32' using the name 'id' in request data ...
2022-09-21 12:31:24.895 +01:00 [DBG] Done attempting to bind parameter 'id' of type 'System.Int32'.
2022-09-21 12:31:24.896 +01:00 [DBG] Done attempting to bind parameter 'id' of type 'System.Int32'.
2022-09-21 12:31:24.897 +01:00 [DBG] Attempting to validate the bound parameter 'id' of type 'System.Int32' ...
2022-09-21 12:31:24.901 +01:00 [DBG] Done attempting to validate the bound parameter 'id' of type 'System.Int32'.
2022-09-21 12:31:27.230 +01:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2022-09-21 12:31:27.235 +01:00 [DBG] No information found on request to perform content negotiation.
2022-09-21 12:31:27.236 +01:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2022-09-21 12:31:27.237 +01:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2022-09-21 12:31:27.238 +01:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2022-09-21 12:31:27.240 +01:00 [INF] Executing OkObjectResult, writing value of type 'Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryable`1[[APIBank.ModelEntities.RefreshToken, APIBank, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2022-09-21 12:31:27.252 +01:00 [DBG] Compiling query expression: 
'DbSet<RefreshToken>()
    .Where(rt => rt.UserId == __id_0)
    .AsNoTracking()
    .Select(rt => new RefreshToken{ 
        Id = rt.Id, 
        UserId = rt.UserId, 
        RefToken = rt.RefToken, 
        Expires = rt.Expires, 
        Created = rt.Created, 
        CreatedByIp = rt.CreatedByIp, 
        Revoked = rt.Revoked, 
        RevokedByIp = rt.RevokedByIp, 
        ReplacedByToken = rt.ReplacedByToken, 
        ReasonRevoked = rt.ReasonRevoked, 
        IsExpired = rt.IsExpired, 
        IsRevoked = rt.IsRevoked, 
        IsActive = rt.IsActive 
    }
    )'
2022-09-21 12:31:27.259 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<RefreshToken>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            Id -> 0
            UserId -> 1
            RefToken -> 2
            Expires -> 3
            Created -> 4
            CreatedByIp -> 5
            Revoked -> 6
            RevokedByIp -> 7
            ReplacedByToken -> 8
            ReasonRevoked -> 9
            IsExpired -> 10
            IsRevoked -> 11
            IsActive -> 12
        SELECT r.id AS Id, r.user_id AS UserId, r.token AS RefToken, r.expires AS Expires, r.created AS Created, r.created_by_ip AS CreatedByIp, r.revoked AS Revoked, r.revoked_by_ip AS RevokedByIp, r.replaced_by_token AS ReplacedByToken, r.reason_revoked AS ReasonRevoked, r.is_expired AS IsExpired, r.is_revoked AS IsRevoked, r.is_active AS IsActive
        FROM refresh_token AS r
        WHERE r.user_id == @__id_0), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, RefreshToken>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)'
2022-09-21 12:31:27.285 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-21 12:31:27.288 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (2ms).
2022-09-21 12:31:27.301 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-21 12:31:27.305 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 12:31:27.307 +01:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.user_id AS "UserId", r.token AS "RefToken", r.expires AS "Expires", r.created AS "Created", r.created_by_ip AS "CreatedByIp", r.revoked AS "Revoked", r.revoked_by_ip AS "RevokedByIp", r.replaced_by_token AS "ReplacedByToken", r.reason_revoked AS "ReasonRevoked", r.is_expired AS "IsExpired", r.is_revoked AS "IsRevoked", r.is_active AS "IsActive"
FROM refresh_token AS r
WHERE r.user_id = @__id_0
2022-09-21 12:31:27.317 +01:00 [INF] Executed DbCommand (10ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.user_id AS "UserId", r.token AS "RefToken", r.expires AS "Expires", r.created AS "Created", r.created_by_ip AS "CreatedByIp", r.revoked AS "Revoked", r.revoked_by_ip AS "RevokedByIp", r.replaced_by_token AS "ReplacedByToken", r.reason_revoked AS "ReasonRevoked", r.is_expired AS "IsExpired", r.is_revoked AS "IsRevoked", r.is_active AS "IsActive"
FROM refresh_token AS r
WHERE r.user_id = @__id_0
2022-09-21 12:31:27.338 +01:00 [DBG] A data reader was disposed.
2022-09-21 12:31:27.350 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 12:31:27.353 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-21 12:31:27.354 +01:00 [INF] Executed action APIBank.Controllers.UsersController.GetRefreshTokens (APIBank) in 2471.5759ms
2022-09-21 12:31:27.355 +01:00 [INF] Executed endpoint 'APIBank.Controllers.UsersController.GetRefreshTokens (APIBank)'
2022-09-21 12:31:27.356 +01:00 [DBG] 'PostgresContext' disposed.
2022-09-21 12:31:27.357 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/api/Users/1/refresh-tokens - - - 200 - application/json;+charset=utf-8 2575.7544ms
2022-09-21 12:37:00.089 +01:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2022-09-21 12:37:00.226 +01:00 [DBG] Hosting starting
2022-09-21 12:37:07.852 +01:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2022-09-21 12:37:07.977 +01:00 [DBG] Hosting starting
2022-09-21 12:37:08.159 +01:00 [DBG] Using development certificate: CN=localhost (Thumbprint: 9CC642E9838495A6C3C202DECA6A8AD300396DD2)
2022-09-21 12:37:08.209 +01:00 [INF] Now listening on: https://localhost:7036
2022-09-21 12:37:08.211 +01:00 [INF] Now listening on: http://localhost:5036
2022-09-21 12:37:08.212 +01:00 [DBG] Loaded hosting startup assembly APIBank
2022-09-21 12:37:08.213 +01:00 [DBG] Loaded hosting startup assembly Microsoft.AspNetCore.Watch.BrowserRefresh
2022-09-21 12:37:08.214 +01:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.BrowserLink.Net
2022-09-21 12:37:08.215 +01:00 [INF] Application started. Press Ctrl+C to shut down.
2022-09-21 12:37:08.216 +01:00 [INF] Hosting environment: Development
2022-09-21 12:37:08.217 +01:00 [INF] Content root path: C:\Users\mguedesa\OneDrive - NTT DATA EMEAL\Documentos\GitHub\OpenBankAPI-NTT\APIBank\APIBank\
2022-09-21 12:37:08.217 +01:00 [DBG] Hosting started
2022-09-21 12:37:08.290 +01:00 [DBG] Connection id "0HMKROMER42AQ" received FIN.
2022-09-21 12:37:08.290 +01:00 [DBG] Connection id "0HMKROMER42AR" received FIN.
2022-09-21 12:37:08.293 +01:00 [DBG] Connection id "0HMKROMER42AR" accepted.
2022-09-21 12:37:08.293 +01:00 [DBG] Connection id "0HMKROMER42AQ" accepted.
2022-09-21 12:37:08.295 +01:00 [DBG] Connection id "0HMKROMER42AR" started.
2022-09-21 12:37:08.295 +01:00 [DBG] Connection id "0HMKROMER42AQ" started.
2022-09-21 12:37:08.319 +01:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException:  Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveBlobAsync[TIOAdapter](TIOAdapter adapter)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](TIOAdapter adapter, Boolean receiveFirst, Byte[] reAuthenticationData, Boolean isApm)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2022-09-21 12:37:08.319 +01:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException:  Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveBlobAsync[TIOAdapter](TIOAdapter adapter)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](TIOAdapter adapter, Boolean receiveFirst, Byte[] reAuthenticationData, Boolean isApm)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2022-09-21 12:37:08.374 +01:00 [DBG] Connection id "0HMKROMER42AR" stopped.
2022-09-21 12:37:08.374 +01:00 [DBG] Connection id "0HMKROMER42AQ" stopped.
2022-09-21 12:37:08.377 +01:00 [DBG] Connection id "0HMKROMER42AQ" sending FIN because: "The Socket transport's send loop completed gracefully."
2022-09-21 12:37:08.377 +01:00 [DBG] Connection id "0HMKROMER42AR" sending FIN because: "The Socket transport's send loop completed gracefully."
2022-09-21 12:37:09.067 +01:00 [DBG] Connection id "0HMKROMER42AS" accepted.
2022-09-21 12:37:09.074 +01:00 [DBG] Connection id "0HMKROMER42AS" started.
2022-09-21 12:37:09.146 +01:00 [DBG] Connection 0HMKROMER42AS established using the following protocol: "Tls12"
2022-09-21 12:37:09.246 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/swagger/index.html - -
2022-09-21 12:37:09.313 +01:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2022-09-21 12:37:09.343 +01:00 [DBG] No candidates found for the request path '/swagger/index.html'
2022-09-21 12:37:09.344 +01:00 [DBG] Request did not match any endpoints
2022-09-21 12:37:09.452 +01:00 [DBG] Response markup is scheduled to include browser refresh script injection.
2022-09-21 12:37:09.620 +01:00 [DBG] Response markup was updated to include browser refresh script injection.
2022-09-21 12:37:09.627 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/swagger/index.html - - - 200 - text/html;charset=utf-8 384.3484ms
2022-09-21 12:37:09.653 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/_vs/browserLink - -
2022-09-21 12:37:09.653 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/_framework/aspnetcore-browser-refresh.js - -
2022-09-21 12:37:09.667 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/_framework/aspnetcore-browser-refresh.js - - - 200 11984 application/javascript;+charset=utf-8 13.8929ms
2022-09-21 12:37:09.685 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/_vs/browserLink - - - 200 - text/javascript;+charset=UTF-8 31.5142ms
2022-09-21 12:37:09.776 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/swagger/v1/swagger.json - -
2022-09-21 12:37:09.777 +01:00 [DBG] No candidates found for the request path '/swagger/v1/swagger.json'
2022-09-21 12:37:09.778 +01:00 [DBG] Request did not match any endpoints
2022-09-21 12:37:09.964 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/swagger/v1/swagger.json - - - 200 - application/json;charset=utf-8 187.7049ms
2022-09-21 12:37:21.369 +01:00 [INF] Request starting HTTP/2 POST https://localhost:7036/api/Users/Login application/json 58
2022-09-21 12:37:21.386 +01:00 [DBG] 1 candidate(s) found for the request path '/api/Users/Login'
2022-09-21 12:37:21.394 +01:00 [DBG] Endpoint 'APIBank.Controllers.UsersController.Login (APIBank)' with route pattern 'api/Users/Login' is valid for the request path '/api/Users/Login'
2022-09-21 12:37:21.398 +01:00 [DBG] Request matched endpoint 'APIBank.Controllers.UsersController.Login (APIBank)'
2022-09-21 12:37:21.400 +01:00 [DBG] Static files was skipped as the request already matched an endpoint.
2022-09-21 12:37:21.873 +01:00 [INF] Executing endpoint 'APIBank.Controllers.UsersController.Login (APIBank)'
2022-09-21 12:37:21.906 +01:00 [INF] Route matched with {action = "Login", controller = "Users"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult Login(APIBank.Models.Requests.LoginRequest) on controller APIBank.Controllers.UsersController (APIBank).
2022-09-21 12:37:21.909 +01:00 [DBG] Execution plan of authorization filters (in the following order): ["APIBank.Authorization.AuthorizeAttribute"]
2022-09-21 12:37:21.911 +01:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2022-09-21 12:37:21.912 +01:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2022-09-21 12:37:21.913 +01:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2022-09-21 12:37:21.914 +01:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2022-09-21 12:37:21.916 +01:00 [DBG] Executing controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-21 12:37:21.918 +01:00 [DBG] Executed controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-21 12:37:21.937 +01:00 [DBG] Attempting to bind parameter 'model' of type 'APIBank.Models.Requests.LoginRequest' ...
2022-09-21 12:37:21.941 +01:00 [DBG] Attempting to bind parameter 'model' of type 'APIBank.Models.Requests.LoginRequest' using the name '' in request data ...
2022-09-21 12:37:21.943 +01:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2022-09-21 12:37:21.949 +01:00 [DBG] Connection id "0HMKROMER42AS", Request id "0HMKROMER42AS:00000009": started reading request body.
2022-09-21 12:37:21.950 +01:00 [DBG] Connection id "0HMKROMER42AS", Request id "0HMKROMER42AS:00000009": done reading request body.
2022-09-21 12:37:21.961 +01:00 [DBG] JSON input formatter succeeded, deserializing to type 'APIBank.Models.Requests.LoginRequest'
2022-09-21 12:37:21.963 +01:00 [DBG] Done attempting to bind parameter 'model' of type 'APIBank.Models.Requests.LoginRequest'.
2022-09-21 12:37:21.964 +01:00 [DBG] Done attempting to bind parameter 'model' of type 'APIBank.Models.Requests.LoginRequest'.
2022-09-21 12:37:21.965 +01:00 [DBG] Attempting to validate the bound parameter 'model' of type 'APIBank.Models.Requests.LoginRequest' ...
2022-09-21 12:37:21.976 +01:00 [DBG] Done attempting to validate the bound parameter 'model' of type 'APIBank.Models.Requests.LoginRequest'.
2022-09-21 12:37:22.126 +01:00 [DBG] An additional 'IServiceProvider' was created for internal use by Entity Framework. An existing service provider was not used due to the following configuration changes: configuration changed for 'Core:ConfigureWarnings', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:UseAdminDatabase', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:SetPostgresVersion', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:UseRedshift', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:ReverseNullOrdering', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:RemoteCertificateValidationCallback', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:ProvideClientCertificatesCallback', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:ProvidePasswordCallback'.
2022-09-21 12:37:23.721 +01:00 [INF] Entity Framework Core 6.0.9 initialized 'PostgresContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:6.0.7+5b98e4b74de93b590b44aef8dd7967c03acc433c' with options: None
2022-09-21 12:37:23.808 +01:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .SingleOrDefault(x => x.Username == __model_Username_0)'
2022-09-21 12:37:24.356 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<User>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: User.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: User.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 1], [Property: User.Email (string) Required Index MaxLength(254), 2], [Property: User.FullName (string) Required MaxLength(100), 3], [Property: User.PasswordChangedAt (DateTime) Required ValueGenerated.OnAdd, 4], [Property: User.PasswordHash (string) Required MaxLength(200), 5], [Property: User.Username (string) Required Index MaxLength(50), 6] }
        SELECT TOP(2) u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
        FROM users AS u
        WHERE u.username == @__model_Username_0), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, User>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)
    .SingleOrDefault()'
2022-09-21 12:37:24.440 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-21 12:37:24.546 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (107ms).
2022-09-21 12:37:24.560 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-21 12:37:24.987 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 12:37:25.019 +01:00 [DBG] Executing DbCommand [Parameters=[@__model_Username_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.username = @__model_Username_0
LIMIT 2
2022-09-21 12:37:25.162 +01:00 [INF] Executed DbCommand (159ms) [Parameters=[@__model_Username_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.username = @__model_Username_0
LIMIT 2
2022-09-21 12:37:25.240 +01:00 [DBG] Context 'PostgresContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 12:37:25.318 +01:00 [DBG] A data reader was disposed.
2022-09-21 12:37:25.328 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 12:37:25.342 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-21 12:37:25.874 +01:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .Any(user => user.RefreshTokenCollection
        .Any(reftoken => reftoken.RefToken == __token_0))'
2022-09-21 12:37:26.022 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<bool>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            EmptyProjectionMember -> 0
        SELECT EXISTS (
            SELECT 1
            FROM users AS u
            WHERE EXISTS (
                SELECT 1
                FROM refresh_token AS r
                WHERE ((u.id != NULL) && (u.id == r.user_id)) && (r.token == @__token_0)))), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, bool>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)
    .Single()'
2022-09-21 12:37:26.041 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-21 12:37:26.043 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2022-09-21 12:37:26.045 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-21 12:37:26.049 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 12:37:26.053 +01:00 [DBG] Executing DbCommand [Parameters=[@__token_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM users AS u
    WHERE EXISTS (
        SELECT 1
        FROM refresh_token AS r
        WHERE (u.id = r.user_id) AND (r.token = @__token_0)))
2022-09-21 12:37:26.059 +01:00 [INF] Executed DbCommand (6ms) [Parameters=[@__token_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM users AS u
    WHERE EXISTS (
        SELECT 1
        FROM refresh_token AS r
        WHERE (u.id = r.user_id) AND (r.token = @__token_0)))
2022-09-21 12:37:26.069 +01:00 [DBG] A data reader was disposed.
2022-09-21 12:37:26.070 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 12:37:26.071 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-21 12:37:26.090 +01:00 [DBG] Compiling query expression: 
'DbSet<RefreshToken>()
    .Where(rt => rt.UserId == __id_0)
    .AsNoTracking()
    .Select(rt => new RefreshToken{ 
        Id = rt.Id, 
        UserId = rt.UserId, 
        RefToken = rt.RefToken, 
        Expires = rt.Expires, 
        Created = rt.Created, 
        CreatedByIp = rt.CreatedByIp, 
        Revoked = rt.Revoked, 
        RevokedByIp = rt.RevokedByIp, 
        ReplacedByToken = rt.ReplacedByToken, 
        ReasonRevoked = rt.ReasonRevoked, 
        IsExpired = rt.IsExpired, 
        IsRevoked = rt.IsRevoked, 
        IsActive = rt.IsActive 
    }
    )'
2022-09-21 12:37:26.128 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<RefreshToken>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            Id -> 0
            UserId -> 1
            RefToken -> 2
            Expires -> 3
            Created -> 4
            CreatedByIp -> 5
            Revoked -> 6
            RevokedByIp -> 7
            ReplacedByToken -> 8
            ReasonRevoked -> 9
            IsExpired -> 10
            IsRevoked -> 11
            IsActive -> 12
        SELECT r.id AS Id, r.user_id AS UserId, r.token AS RefToken, r.expires AS Expires, r.created AS Created, r.created_by_ip AS CreatedByIp, r.revoked AS Revoked, r.revoked_by_ip AS RevokedByIp, r.replaced_by_token AS ReplacedByToken, r.reason_revoked AS ReasonRevoked, r.is_expired AS IsExpired, r.is_revoked AS IsRevoked, r.is_active AS IsActive
        FROM refresh_token AS r
        WHERE r.user_id == @__id_0), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, RefreshToken>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)'
2022-09-21 12:37:26.135 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-21 12:37:26.138 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (2ms).
2022-09-21 12:37:26.140 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-21 12:37:26.143 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 12:37:26.144 +01:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.user_id AS "UserId", r.token AS "RefToken", r.expires AS "Expires", r.created AS "Created", r.created_by_ip AS "CreatedByIp", r.revoked AS "Revoked", r.revoked_by_ip AS "RevokedByIp", r.replaced_by_token AS "ReplacedByToken", r.reason_revoked AS "ReasonRevoked", r.is_expired AS "IsExpired", r.is_revoked AS "IsRevoked", r.is_active AS "IsActive"
FROM refresh_token AS r
WHERE r.user_id = @__id_0
2022-09-21 12:37:26.158 +01:00 [INF] Executed DbCommand (13ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.user_id AS "UserId", r.token AS "RefToken", r.expires AS "Expires", r.created AS "Created", r.created_by_ip AS "CreatedByIp", r.revoked AS "Revoked", r.revoked_by_ip AS "RevokedByIp", r.replaced_by_token AS "ReplacedByToken", r.reason_revoked AS "ReasonRevoked", r.is_expired AS "IsExpired", r.is_revoked AS "IsRevoked", r.is_active AS "IsActive"
FROM refresh_token AS r
WHERE r.user_id = @__id_0
2022-09-21 12:37:26.161 +01:00 [DBG] A data reader was disposed.
2022-09-21 12:37:26.161 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 12:37:26.162 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-21 12:37:26.271 +01:00 [DBG] Context 'PostgresContext' started tracking 'RefreshToken' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 12:37:26.290 +01:00 [DBG] An entity of type 'RefreshToken' tracked by 'PostgresContext' changed state from '"Unchanged"' to '"Deleted"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 12:37:26.310 +01:00 [DBG] SaveChanges starting for 'PostgresContext'.
2022-09-21 12:37:26.317 +01:00 [DBG] DetectChanges starting for 'PostgresContext'.
2022-09-21 12:37:26.365 +01:00 [DBG] 1 entities were added and 0 entities were removed from navigation 'User.RefreshTokenCollection'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 12:37:26.396 +01:00 [DBG] 'PostgresContext' generated a temporary value for the property 'Id.RefreshToken'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 12:37:26.407 +01:00 [DBG] Context 'PostgresContext' started tracking 'RefreshToken' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 12:37:26.411 +01:00 [DBG] DetectChanges completed for 'PostgresContext'.
2022-09-21 12:37:26.428 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-21 12:37:26.430 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 12:37:26.453 +01:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2022-09-21 12:37:26.468 +01:00 [DBG] Began transaction with isolation level 'ReadCommitted'.
2022-09-21 12:37:26.544 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-21 12:37:26.546 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (2ms).
2022-09-21 12:37:26.548 +01:00 [DBG] Executing DbCommand [Parameters=[@p0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
DELETE FROM refresh_token
WHERE id = @p0;
2022-09-21 12:37:26.551 +01:00 [INF] Executed DbCommand (3ms) [Parameters=[@p0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
DELETE FROM refresh_token
WHERE id = @p0;
2022-09-21 12:37:26.554 +01:00 [DBG] A data reader was disposed.
2022-09-21 12:37:26.561 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-21 12:37:26.561 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2022-09-21 12:37:26.562 +01:00 [DBG] Executing DbCommand [Parameters=[@p1='?' (DbType = DateTime), @p2='?', @p3='?' (DbType = DateTime), @p4='?' (DbType = Boolean), @p5='?' (DbType = Boolean), @p6='?' (DbType = Boolean), @p7='?', @p8='?', @p9='?', @p10='?' (DbType = DateTime), @p11='?', @p12='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO refresh_token (created, created_by_ip, expires, is_active, is_expired, is_revoked, reason_revoked, token, replaced_by_token, revoked, revoked_by_ip, user_id)
VALUES (@p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12)
RETURNING id;
2022-09-21 12:37:26.574 +01:00 [INF] Executed DbCommand (12ms) [Parameters=[@p1='?' (DbType = DateTime), @p2='?', @p3='?' (DbType = DateTime), @p4='?' (DbType = Boolean), @p5='?' (DbType = Boolean), @p6='?' (DbType = Boolean), @p7='?', @p8='?', @p9='?', @p10='?' (DbType = DateTime), @p11='?', @p12='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
INSERT INTO refresh_token (created, created_by_ip, expires, is_active, is_expired, is_revoked, reason_revoked, token, replaced_by_token, revoked, revoked_by_ip, user_id)
VALUES (@p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11, @p12)
RETURNING id;
2022-09-21 12:37:26.596 +01:00 [DBG] The foreign key property 'RefreshToken.Id' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2022-09-21 12:37:26.609 +01:00 [DBG] A data reader was disposed.
2022-09-21 12:37:26.614 +01:00 [DBG] Committing transaction.
2022-09-21 12:37:26.630 +01:00 [DBG] Committed transaction.
2022-09-21 12:37:26.635 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 12:37:26.639 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-21 12:37:26.642 +01:00 [DBG] Disposing transaction.
2022-09-21 12:37:26.645 +01:00 [DBG] An entity of type 'RefreshToken' tracked by 'PostgresContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 12:37:26.654 +01:00 [DBG] An entity of type 'RefreshToken' tracked by 'PostgresContext' changed state from '"Deleted"' to '"Detached"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 12:37:26.657 +01:00 [DBG] SaveChanges completed for 'PostgresContext' with 2 entities written to the database.
2022-09-21 12:37:26.659 +01:00 [DBG] An entity of type 'User' tracked by 'PostgresContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 12:37:26.661 +01:00 [DBG] An entity of type 'RefreshToken' tracked by 'PostgresContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 12:37:26.663 +01:00 [DBG] SaveChanges starting for 'PostgresContext'.
2022-09-21 12:37:26.665 +01:00 [DBG] DetectChanges starting for 'PostgresContext'.
2022-09-21 12:37:26.667 +01:00 [DBG] DetectChanges completed for 'PostgresContext'.
2022-09-21 12:37:26.669 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-21 12:37:26.670 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 12:37:26.671 +01:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2022-09-21 12:37:26.673 +01:00 [DBG] Began transaction with isolation level 'ReadCommitted'.
2022-09-21 12:37:26.690 +01:00 [DBG] Executing 2 update commands as a batch.
2022-09-21 12:37:26.693 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-21 12:37:26.693 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2022-09-21 12:37:26.694 +01:00 [DBG] Executing DbCommand [Parameters=[@p12='?' (DbType = Int32), @p0='?' (DbType = DateTime), @p1='?', @p2='?' (DbType = DateTime), @p3='?' (DbType = Boolean), @p4='?' (DbType = Boolean), @p5='?' (DbType = Boolean), @p6='?', @p7='?', @p8='?', @p9='?' (DbType = DateTime), @p10='?', @p11='?' (DbType = Int32), @p19='?' (DbType = Int32), @p13='?' (DbType = DateTime), @p14='?', @p15='?', @p16='?' (DbType = DateTime), @p17='?', @p18='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE refresh_token SET created = @p0, created_by_ip = @p1, expires = @p2, is_active = @p3, is_expired = @p4, is_revoked = @p5, reason_revoked = @p6, token = @p7, replaced_by_token = @p8, revoked = @p9, revoked_by_ip = @p10, user_id = @p11
WHERE id = @p12;
UPDATE users SET created_at = @p13, email = @p14, full_name = @p15, password_changed_at = @p16, password_hash = @p17, username = @p18
WHERE id = @p19;
2022-09-21 12:37:26.698 +01:00 [INF] Executed DbCommand (4ms) [Parameters=[@p12='?' (DbType = Int32), @p0='?' (DbType = DateTime), @p1='?', @p2='?' (DbType = DateTime), @p3='?' (DbType = Boolean), @p4='?' (DbType = Boolean), @p5='?' (DbType = Boolean), @p6='?', @p7='?', @p8='?', @p9='?' (DbType = DateTime), @p10='?', @p11='?' (DbType = Int32), @p19='?' (DbType = Int32), @p13='?' (DbType = DateTime), @p14='?', @p15='?', @p16='?' (DbType = DateTime), @p17='?', @p18='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE refresh_token SET created = @p0, created_by_ip = @p1, expires = @p2, is_active = @p3, is_expired = @p4, is_revoked = @p5, reason_revoked = @p6, token = @p7, replaced_by_token = @p8, revoked = @p9, revoked_by_ip = @p10, user_id = @p11
WHERE id = @p12;
UPDATE users SET created_at = @p13, email = @p14, full_name = @p15, password_changed_at = @p16, password_hash = @p17, username = @p18
WHERE id = @p19;
2022-09-21 12:37:26.701 +01:00 [DBG] A data reader was disposed.
2022-09-21 12:37:26.702 +01:00 [DBG] Committing transaction.
2022-09-21 12:37:26.703 +01:00 [DBG] Committed transaction.
2022-09-21 12:37:26.704 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 12:37:26.704 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-21 12:37:26.705 +01:00 [DBG] Disposing transaction.
2022-09-21 12:37:26.706 +01:00 [DBG] An entity of type 'User' tracked by 'PostgresContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 12:37:26.707 +01:00 [DBG] An entity of type 'RefreshToken' tracked by 'PostgresContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 12:37:26.708 +01:00 [DBG] SaveChanges completed for 'PostgresContext' with 2 entities written to the database.
2022-09-21 12:37:26.715 +01:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2022-09-21 12:37:26.722 +01:00 [DBG] Attempting to select an output formatter based on Accept header '["text/plain"]'.
2022-09-21 12:37:26.724 +01:00 [DBG] Could not find an output formatter based on content negotiation. Accepted types were (["text/plain"])
2022-09-21 12:37:26.725 +01:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2022-09-21 12:37:26.726 +01:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2022-09-21 12:37:26.727 +01:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2022-09-21 12:37:26.728 +01:00 [INF] Executing OkObjectResult, writing value of type 'APIBank.Models.Users.Responses.LoginResponse'.
2022-09-21 12:37:26.754 +01:00 [INF] Executed action APIBank.Controllers.UsersController.Login (APIBank) in 4830.9497ms
2022-09-21 12:37:26.758 +01:00 [INF] Executed endpoint 'APIBank.Controllers.UsersController.Login (APIBank)'
2022-09-21 12:37:26.765 +01:00 [DBG] 'PostgresContext' disposed.
2022-09-21 12:37:26.773 +01:00 [INF] Request finished HTTP/2 POST https://localhost:7036/api/Users/Login application/json 58 - 200 - application/json;+charset=utf-8 5403.7916ms
2022-09-21 12:37:39.918 +01:00 [INF] Request starting HTTP/2 POST https://localhost:7036/api/Users/refreshToken - 0
2022-09-21 12:37:39.926 +01:00 [DBG] 1 candidate(s) found for the request path '/api/Users/refreshToken'
2022-09-21 12:37:39.929 +01:00 [DBG] Endpoint 'APIBank.Controllers.UsersController.RefreshToken (APIBank)' with route pattern 'api/Users/refreshToken' is valid for the request path '/api/Users/refreshToken'
2022-09-21 12:37:39.930 +01:00 [DBG] Request matched endpoint 'APIBank.Controllers.UsersController.RefreshToken (APIBank)'
2022-09-21 12:37:39.931 +01:00 [DBG] Static files was skipped as the request already matched an endpoint.
2022-09-21 12:37:40.081 +01:00 [INF] Entity Framework Core 6.0.9 initialized 'PostgresContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:6.0.7+5b98e4b74de93b590b44aef8dd7967c03acc433c' with options: None
2022-09-21 12:37:40.095 +01:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .FirstOrDefault(e => EF.Property<int>(e, "Id") == __p_0)'
2022-09-21 12:37:40.099 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<User>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: User.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: User.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 1], [Property: User.Email (string) Required Index MaxLength(254), 2], [Property: User.FullName (string) Required MaxLength(100), 3], [Property: User.PasswordChangedAt (DateTime) Required ValueGenerated.OnAdd, 4], [Property: User.PasswordHash (string) Required MaxLength(200), 5], [Property: User.Username (string) Required Index MaxLength(50), 6] }
        SELECT TOP(1) u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
        FROM users AS u
        WHERE u.id == @__p_0), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, User>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)
    .SingleOrDefault()'
2022-09-21 12:37:40.101 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-21 12:37:40.101 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2022-09-21 12:37:40.103 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-21 12:37:40.107 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 12:37:40.107 +01:00 [DBG] Executing DbCommand [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.id = @__p_0
LIMIT 1
2022-09-21 12:37:40.109 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.id = @__p_0
LIMIT 1
2022-09-21 12:37:40.110 +01:00 [DBG] Context 'PostgresContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 12:37:40.111 +01:00 [DBG] A data reader was disposed.
2022-09-21 12:37:40.112 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 12:37:40.112 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-21 12:37:40.113 +01:00 [INF] Executing endpoint 'APIBank.Controllers.UsersController.RefreshToken (APIBank)'
2022-09-21 12:37:40.115 +01:00 [INF] Route matched with {action = "RefreshToken", controller = "Users"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult RefreshToken() on controller APIBank.Controllers.UsersController (APIBank).
2022-09-21 12:37:40.116 +01:00 [DBG] Execution plan of authorization filters (in the following order): ["APIBank.Authorization.AuthorizeAttribute"]
2022-09-21 12:37:40.117 +01:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2022-09-21 12:37:40.118 +01:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2022-09-21 12:37:40.122 +01:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2022-09-21 12:37:40.123 +01:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2022-09-21 12:37:40.124 +01:00 [DBG] Executing controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-21 12:37:40.124 +01:00 [DBG] Executed controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-21 12:37:54.793 +01:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .SingleOrDefault(userQuery => userQuery.RefreshTokenCollection
        .Any(refTokenQuery => refTokenQuery.RefToken == __refToken_0))'
2022-09-21 12:37:54.800 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<User>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: User.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: User.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 1], [Property: User.Email (string) Required Index MaxLength(254), 2], [Property: User.FullName (string) Required MaxLength(100), 3], [Property: User.PasswordChangedAt (DateTime) Required ValueGenerated.OnAdd, 4], [Property: User.PasswordHash (string) Required MaxLength(200), 5], [Property: User.Username (string) Required Index MaxLength(50), 6] }
        SELECT TOP(2) u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
        FROM users AS u
        WHERE EXISTS (
            SELECT 1
            FROM refresh_token AS r
            WHERE ((u.id != NULL) && (u.id == r.user_id)) && (r.token == @__refToken_0))), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, User>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)
    .SingleOrDefault()'
2022-09-21 12:37:54.802 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-21 12:37:54.803 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2022-09-21 12:37:54.803 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-21 12:37:54.804 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 12:37:54.805 +01:00 [DBG] Executing DbCommand [Parameters=[@__refToken_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE EXISTS (
    SELECT 1
    FROM refresh_token AS r
    WHERE (u.id = r.user_id) AND (r.token = @__refToken_0))
LIMIT 2
2022-09-21 12:37:54.809 +01:00 [INF] Executed DbCommand (4ms) [Parameters=[@__refToken_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE EXISTS (
    SELECT 1
    FROM refresh_token AS r
    WHERE (u.id = r.user_id) AND (r.token = @__refToken_0))
LIMIT 2
2022-09-21 12:37:54.811 +01:00 [DBG] A data reader was disposed.
2022-09-21 12:37:54.811 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 12:37:54.812 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-21 12:37:55.372 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-21 12:37:55.375 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (3ms).
2022-09-21 12:37:55.379 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-21 12:37:55.380 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 12:37:55.381 +01:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.user_id AS "UserId", r.token AS "RefToken", r.expires AS "Expires", r.created AS "Created", r.created_by_ip AS "CreatedByIp", r.revoked AS "Revoked", r.revoked_by_ip AS "RevokedByIp", r.replaced_by_token AS "ReplacedByToken", r.reason_revoked AS "ReasonRevoked", r.is_expired AS "IsExpired", r.is_revoked AS "IsRevoked", r.is_active AS "IsActive"
FROM refresh_token AS r
WHERE r.user_id = @__id_0
2022-09-21 12:37:55.383 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.user_id AS "UserId", r.token AS "RefToken", r.expires AS "Expires", r.created AS "Created", r.created_by_ip AS "CreatedByIp", r.revoked AS "Revoked", r.revoked_by_ip AS "RevokedByIp", r.replaced_by_token AS "ReplacedByToken", r.reason_revoked AS "ReasonRevoked", r.is_expired AS "IsExpired", r.is_revoked AS "IsRevoked", r.is_active AS "IsActive"
FROM refresh_token AS r
WHERE r.user_id = @__id_0
2022-09-21 12:37:55.385 +01:00 [DBG] A data reader was disposed.
2022-09-21 12:37:55.385 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 12:37:55.386 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-21 12:37:58.065 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-21 12:37:58.067 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2022-09-21 12:37:58.068 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-21 12:37:58.072 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 12:37:58.073 +01:00 [DBG] Executing DbCommand [Parameters=[@__token_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM users AS u
    WHERE EXISTS (
        SELECT 1
        FROM refresh_token AS r
        WHERE (u.id = r.user_id) AND (r.token = @__token_0)))
2022-09-21 12:37:58.075 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[@__token_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM users AS u
    WHERE EXISTS (
        SELECT 1
        FROM refresh_token AS r
        WHERE (u.id = r.user_id) AND (r.token = @__token_0)))
2022-09-21 12:37:58.076 +01:00 [DBG] A data reader was disposed.
2022-09-21 12:37:58.078 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 12:37:58.078 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-21 12:38:08.038 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-21 12:38:08.043 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (4ms).
2022-09-21 12:38:08.044 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-21 12:38:08.045 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 12:38:08.046 +01:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.user_id AS "UserId", r.token AS "RefToken", r.expires AS "Expires", r.created AS "Created", r.created_by_ip AS "CreatedByIp", r.revoked AS "Revoked", r.revoked_by_ip AS "RevokedByIp", r.replaced_by_token AS "ReplacedByToken", r.reason_revoked AS "ReasonRevoked", r.is_expired AS "IsExpired", r.is_revoked AS "IsRevoked", r.is_active AS "IsActive"
FROM refresh_token AS r
WHERE r.user_id = @__id_0
2022-09-21 12:38:08.049 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.user_id AS "UserId", r.token AS "RefToken", r.expires AS "Expires", r.created AS "Created", r.created_by_ip AS "CreatedByIp", r.revoked AS "Revoked", r.revoked_by_ip AS "RevokedByIp", r.replaced_by_token AS "ReplacedByToken", r.reason_revoked AS "ReasonRevoked", r.is_expired AS "IsExpired", r.is_revoked AS "IsRevoked", r.is_active AS "IsActive"
FROM refresh_token AS r
WHERE r.user_id = @__id_0
2022-09-21 12:38:08.051 +01:00 [DBG] A data reader was disposed.
2022-09-21 12:38:08.051 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 12:38:08.052 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-21 12:38:12.151 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-21 12:38:12.153 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2022-09-21 12:38:12.154 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-21 12:38:12.155 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 12:38:12.156 +01:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.user_id AS "UserId", r.token AS "RefToken", r.expires AS "Expires", r.created AS "Created", r.created_by_ip AS "CreatedByIp", r.revoked AS "Revoked", r.revoked_by_ip AS "RevokedByIp", r.replaced_by_token AS "ReplacedByToken", r.reason_revoked AS "ReasonRevoked", r.is_expired AS "IsExpired", r.is_revoked AS "IsRevoked", r.is_active AS "IsActive"
FROM refresh_token AS r
WHERE r.user_id = @__id_0
2022-09-21 12:38:12.162 +01:00 [INF] Executed DbCommand (5ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.user_id AS "UserId", r.token AS "RefToken", r.expires AS "Expires", r.created AS "Created", r.created_by_ip AS "CreatedByIp", r.revoked AS "Revoked", r.revoked_by_ip AS "RevokedByIp", r.replaced_by_token AS "ReplacedByToken", r.reason_revoked AS "ReasonRevoked", r.is_expired AS "IsExpired", r.is_revoked AS "IsRevoked", r.is_active AS "IsActive"
FROM refresh_token AS r
WHERE r.user_id = @__id_0
2022-09-21 12:38:12.188 +01:00 [DBG] A data reader was disposed.
2022-09-21 12:38:12.190 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 12:38:12.191 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-21 12:39:34.242 +01:00 [DBG] An entity of type 'User' tracked by 'PostgresContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 12:39:35.890 +01:00 [DBG] 'PostgresContext' generated a temporary value for the property 'Id.RefreshToken'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 12:39:35.894 +01:00 [DBG] Context 'PostgresContext' started tracking 'RefreshToken' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 12:39:58.228 +01:00 [INF] Executed action APIBank.Controllers.UsersController.RefreshToken (APIBank) in 138104.7516ms
2022-09-21 12:39:58.237 +01:00 [INF] Executed endpoint 'APIBank.Controllers.UsersController.RefreshToken (APIBank)'
2022-09-21 12:40:04.336 +01:00 [INF] Global Error was found:
2022-09-21 12:40:08.834 +01:00 [DBG] 'PostgresContext' disposed.
2022-09-21 12:40:08.838 +01:00 [INF] Request finished HTTP/2 POST https://localhost:7036/api/Users/refreshToken - 0 - 500 - application/json 148919.3973ms
2022-09-21 12:40:42.256 +01:00 [INF] Request starting HTTP/2 POST https://localhost:7036/api/Users/refreshToken - 0
2022-09-21 12:40:42.274 +01:00 [DBG] 1 candidate(s) found for the request path '/api/Users/refreshToken'
2022-09-21 12:40:42.275 +01:00 [DBG] Endpoint 'APIBank.Controllers.UsersController.RefreshToken (APIBank)' with route pattern 'api/Users/refreshToken' is valid for the request path '/api/Users/refreshToken'
2022-09-21 12:40:42.279 +01:00 [DBG] Request matched endpoint 'APIBank.Controllers.UsersController.RefreshToken (APIBank)'
2022-09-21 12:40:42.280 +01:00 [DBG] Static files was skipped as the request already matched an endpoint.
2022-09-21 12:40:42.336 +01:00 [INF] Entity Framework Core 6.0.9 initialized 'PostgresContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:6.0.7+5b98e4b74de93b590b44aef8dd7967c03acc433c' with options: None
2022-09-21 12:40:42.339 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-21 12:40:42.340 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2022-09-21 12:40:42.341 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-21 12:40:42.341 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 12:40:42.342 +01:00 [DBG] Executing DbCommand [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.id = @__p_0
LIMIT 1
2022-09-21 12:40:42.347 +01:00 [INF] Executed DbCommand (4ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.id = @__p_0
LIMIT 1
2022-09-21 12:40:42.349 +01:00 [DBG] Context 'PostgresContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 12:40:42.350 +01:00 [DBG] A data reader was disposed.
2022-09-21 12:40:42.350 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 12:40:42.351 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-21 12:40:42.352 +01:00 [INF] Executing endpoint 'APIBank.Controllers.UsersController.RefreshToken (APIBank)'
2022-09-21 12:40:42.352 +01:00 [INF] Route matched with {action = "RefreshToken", controller = "Users"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult RefreshToken() on controller APIBank.Controllers.UsersController (APIBank).
2022-09-21 12:40:42.354 +01:00 [DBG] Execution plan of authorization filters (in the following order): ["APIBank.Authorization.AuthorizeAttribute"]
2022-09-21 12:40:42.356 +01:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2022-09-21 12:40:42.356 +01:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2022-09-21 12:40:42.358 +01:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2022-09-21 12:40:42.358 +01:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2022-09-21 12:40:42.359 +01:00 [DBG] Executing controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-21 12:40:42.360 +01:00 [DBG] Executed controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-21 12:40:49.048 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-21 12:40:49.052 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (3ms).
2022-09-21 12:40:49.060 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-21 12:40:49.063 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 12:40:49.064 +01:00 [DBG] Executing DbCommand [Parameters=[@__refToken_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE EXISTS (
    SELECT 1
    FROM refresh_token AS r
    WHERE (u.id = r.user_id) AND (r.token = @__refToken_0))
LIMIT 2
2022-09-21 12:40:49.067 +01:00 [INF] Executed DbCommand (3ms) [Parameters=[@__refToken_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE EXISTS (
    SELECT 1
    FROM refresh_token AS r
    WHERE (u.id = r.user_id) AND (r.token = @__refToken_0))
LIMIT 2
2022-09-21 12:40:49.070 +01:00 [DBG] A data reader was disposed.
2022-09-21 12:40:49.072 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 12:40:49.074 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-21 12:40:49.463 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-21 12:40:49.464 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2022-09-21 12:40:49.465 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-21 12:40:49.467 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 12:40:49.468 +01:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.user_id AS "UserId", r.token AS "RefToken", r.expires AS "Expires", r.created AS "Created", r.created_by_ip AS "CreatedByIp", r.revoked AS "Revoked", r.revoked_by_ip AS "RevokedByIp", r.replaced_by_token AS "ReplacedByToken", r.reason_revoked AS "ReasonRevoked", r.is_expired AS "IsExpired", r.is_revoked AS "IsRevoked", r.is_active AS "IsActive"
FROM refresh_token AS r
WHERE r.user_id = @__id_0
2022-09-21 12:40:49.472 +01:00 [INF] Executed DbCommand (4ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.user_id AS "UserId", r.token AS "RefToken", r.expires AS "Expires", r.created AS "Created", r.created_by_ip AS "CreatedByIp", r.revoked AS "Revoked", r.revoked_by_ip AS "RevokedByIp", r.replaced_by_token AS "ReplacedByToken", r.reason_revoked AS "ReasonRevoked", r.is_expired AS "IsExpired", r.is_revoked AS "IsRevoked", r.is_active AS "IsActive"
FROM refresh_token AS r
WHERE r.user_id = @__id_0
2022-09-21 12:40:49.477 +01:00 [DBG] A data reader was disposed.
2022-09-21 12:40:49.478 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 12:40:49.479 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-21 12:40:50.188 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-21 12:40:50.191 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (3ms).
2022-09-21 12:40:50.192 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-21 12:40:50.193 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 12:40:50.194 +01:00 [DBG] Executing DbCommand [Parameters=[@__token_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM users AS u
    WHERE EXISTS (
        SELECT 1
        FROM refresh_token AS r
        WHERE (u.id = r.user_id) AND (r.token = @__token_0)))
2022-09-21 12:40:50.196 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[@__token_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM users AS u
    WHERE EXISTS (
        SELECT 1
        FROM refresh_token AS r
        WHERE (u.id = r.user_id) AND (r.token = @__token_0)))
2022-09-21 12:40:50.198 +01:00 [DBG] A data reader was disposed.
2022-09-21 12:40:50.199 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 12:40:50.200 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-21 12:40:50.506 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-21 12:40:50.508 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2022-09-21 12:40:50.509 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-21 12:40:50.511 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 12:40:50.512 +01:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.user_id AS "UserId", r.token AS "RefToken", r.expires AS "Expires", r.created AS "Created", r.created_by_ip AS "CreatedByIp", r.revoked AS "Revoked", r.revoked_by_ip AS "RevokedByIp", r.replaced_by_token AS "ReplacedByToken", r.reason_revoked AS "ReasonRevoked", r.is_expired AS "IsExpired", r.is_revoked AS "IsRevoked", r.is_active AS "IsActive"
FROM refresh_token AS r
WHERE r.user_id = @__id_0
2022-09-21 12:40:50.514 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.user_id AS "UserId", r.token AS "RefToken", r.expires AS "Expires", r.created AS "Created", r.created_by_ip AS "CreatedByIp", r.revoked AS "Revoked", r.revoked_by_ip AS "RevokedByIp", r.replaced_by_token AS "ReplacedByToken", r.reason_revoked AS "ReasonRevoked", r.is_expired AS "IsExpired", r.is_revoked AS "IsRevoked", r.is_active AS "IsActive"
FROM refresh_token AS r
WHERE r.user_id = @__id_0
2022-09-21 12:40:50.516 +01:00 [DBG] A data reader was disposed.
2022-09-21 12:40:50.516 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 12:40:50.517 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-21 12:41:18.352 +01:00 [DBG] An entity of type 'User' tracked by 'PostgresContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 12:41:35.707 +01:00 [DBG] SaveChanges starting for 'PostgresContext'.
2022-09-21 12:41:35.710 +01:00 [DBG] DetectChanges starting for 'PostgresContext'.
2022-09-21 12:41:35.712 +01:00 [DBG] 1 entities were added and 0 entities were removed from navigation 'User.RefreshTokenCollection'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 12:41:35.717 +01:00 [DBG] 'PostgresContext' generated a temporary value for the property 'Id.RefreshToken'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 12:41:35.719 +01:00 [DBG] Context 'PostgresContext' started tracking 'RefreshToken' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 12:41:35.763 +01:00 [DBG] DetectChanges completed for 'PostgresContext'.
2022-09-21 12:41:35.765 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-21 12:41:35.768 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 12:41:35.770 +01:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2022-09-21 12:41:35.771 +01:00 [DBG] Began transaction with isolation level 'ReadCommitted'.
2022-09-21 12:41:35.772 +01:00 [DBG] Executing 2 update commands as a batch.
2022-09-21 12:41:35.774 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-21 12:41:35.775 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2022-09-21 12:41:35.776 +01:00 [DBG] Executing DbCommand [Parameters=[@p0='?' (DbType = DateTime), @p1='?', @p2='?' (DbType = DateTime), @p3='?' (DbType = Boolean), @p4='?' (DbType = Boolean), @p5='?' (DbType = Boolean), @p6='?', @p7='?', @p8='?', @p9='?' (DbType = DateTime), @p10='?', @p11='?' (DbType = Int32), @p18='?' (DbType = Int32), @p12='?' (DbType = DateTime), @p13='?', @p14='?', @p15='?' (DbType = DateTime), @p16='?', @p17='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO refresh_token (created, created_by_ip, expires, is_active, is_expired, is_revoked, reason_revoked, token, replaced_by_token, revoked, revoked_by_ip, user_id)
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11)
RETURNING id;
UPDATE users SET created_at = @p12, email = @p13, full_name = @p14, password_changed_at = @p15, password_hash = @p16, username = @p17
WHERE id = @p18;
2022-09-21 12:41:35.779 +01:00 [INF] Executed DbCommand (3ms) [Parameters=[@p0='?' (DbType = DateTime), @p1='?', @p2='?' (DbType = DateTime), @p3='?' (DbType = Boolean), @p4='?' (DbType = Boolean), @p5='?' (DbType = Boolean), @p6='?', @p7='?', @p8='?', @p9='?' (DbType = DateTime), @p10='?', @p11='?' (DbType = Int32), @p18='?' (DbType = Int32), @p12='?' (DbType = DateTime), @p13='?', @p14='?', @p15='?' (DbType = DateTime), @p16='?', @p17='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO refresh_token (created, created_by_ip, expires, is_active, is_expired, is_revoked, reason_revoked, token, replaced_by_token, revoked, revoked_by_ip, user_id)
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11)
RETURNING id;
UPDATE users SET created_at = @p12, email = @p13, full_name = @p14, password_changed_at = @p15, password_hash = @p16, username = @p17
WHERE id = @p18;
2022-09-21 12:41:35.789 +01:00 [DBG] The foreign key property 'RefreshToken.Id' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2022-09-21 12:41:35.790 +01:00 [DBG] A data reader was disposed.
2022-09-21 12:41:35.790 +01:00 [DBG] Committing transaction.
2022-09-21 12:41:35.792 +01:00 [DBG] Committed transaction.
2022-09-21 12:41:35.793 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 12:41:35.793 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-21 12:41:35.794 +01:00 [DBG] Disposing transaction.
2022-09-21 12:41:35.795 +01:00 [DBG] An entity of type 'RefreshToken' tracked by 'PostgresContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 12:41:35.796 +01:00 [DBG] An entity of type 'User' tracked by 'PostgresContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 12:41:35.798 +01:00 [DBG] SaveChanges completed for 'PostgresContext' with 2 entities written to the database.
2022-09-21 12:41:35.800 +01:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2022-09-21 12:41:35.802 +01:00 [DBG] Attempting to select an output formatter based on Accept header '["text/plain"]'.
2022-09-21 12:41:35.803 +01:00 [DBG] Could not find an output formatter based on content negotiation. Accepted types were (["text/plain"])
2022-09-21 12:41:35.805 +01:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2022-09-21 12:41:35.806 +01:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2022-09-21 12:41:35.806 +01:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2022-09-21 12:41:35.807 +01:00 [INF] Executing OkObjectResult, writing value of type 'APIBank.Models.Users.Responses.LoginResponse'.
2022-09-21 12:41:35.808 +01:00 [INF] Executed action APIBank.Controllers.UsersController.RefreshToken (APIBank) in 53448.8475ms
2022-09-21 12:41:35.809 +01:00 [INF] Executed endpoint 'APIBank.Controllers.UsersController.RefreshToken (APIBank)'
2022-09-21 12:41:35.810 +01:00 [DBG] 'PostgresContext' disposed.
2022-09-21 12:41:35.811 +01:00 [INF] Request finished HTTP/2 POST https://localhost:7036/api/Users/refreshToken - 0 - 200 - application/json;+charset=utf-8 53554.3430ms
2022-09-21 12:41:52.941 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/api/Users/1/refresh-tokens - -
2022-09-21 12:41:52.948 +01:00 [DBG] 1 candidate(s) found for the request path '/api/Users/1/refresh-tokens'
2022-09-21 12:41:52.950 +01:00 [DBG] Endpoint 'APIBank.Controllers.UsersController.GetRefreshTokens (APIBank)' with route pattern 'api/Users/{id}/refresh-tokens' is valid for the request path '/api/Users/1/refresh-tokens'
2022-09-21 12:41:52.958 +01:00 [DBG] Request matched endpoint 'APIBank.Controllers.UsersController.GetRefreshTokens (APIBank)'
2022-09-21 12:41:52.961 +01:00 [DBG] Static files was skipped as the request already matched an endpoint.
2022-09-21 12:41:58.410 +01:00 [INF] Entity Framework Core 6.0.9 initialized 'PostgresContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:6.0.7+5b98e4b74de93b590b44aef8dd7967c03acc433c' with options: None
2022-09-21 12:41:58.420 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-21 12:41:58.420 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2022-09-21 12:41:58.421 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-21 12:41:58.422 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 12:41:58.423 +01:00 [DBG] Executing DbCommand [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.id = @__p_0
LIMIT 1
2022-09-21 12:41:58.425 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.id = @__p_0
LIMIT 1
2022-09-21 12:41:58.426 +01:00 [DBG] Context 'PostgresContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 12:41:58.429 +01:00 [DBG] A data reader was disposed.
2022-09-21 12:41:58.432 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 12:41:58.433 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-21 12:41:58.434 +01:00 [INF] Executing endpoint 'APIBank.Controllers.UsersController.GetRefreshTokens (APIBank)'
2022-09-21 12:41:58.436 +01:00 [INF] Route matched with {action = "GetRefreshTokens", controller = "Users"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult GetRefreshTokens(Int32) on controller APIBank.Controllers.UsersController (APIBank).
2022-09-21 12:41:58.438 +01:00 [DBG] Execution plan of authorization filters (in the following order): ["APIBank.Authorization.AuthorizeAttribute"]
2022-09-21 12:41:58.439 +01:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2022-09-21 12:41:58.440 +01:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2022-09-21 12:41:58.441 +01:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2022-09-21 12:41:58.442 +01:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2022-09-21 12:41:58.443 +01:00 [DBG] Executing controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-21 12:41:58.448 +01:00 [DBG] Executed controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-21 12:41:58.449 +01:00 [DBG] Attempting to bind parameter 'id' of type 'System.Int32' ...
2022-09-21 12:41:58.451 +01:00 [DBG] Attempting to bind parameter 'id' of type 'System.Int32' using the name 'id' in request data ...
2022-09-21 12:41:58.452 +01:00 [DBG] Done attempting to bind parameter 'id' of type 'System.Int32'.
2022-09-21 12:41:58.453 +01:00 [DBG] Done attempting to bind parameter 'id' of type 'System.Int32'.
2022-09-21 12:41:58.454 +01:00 [DBG] Attempting to validate the bound parameter 'id' of type 'System.Int32' ...
2022-09-21 12:41:58.455 +01:00 [DBG] Done attempting to validate the bound parameter 'id' of type 'System.Int32'.
2022-09-21 12:42:01.134 +01:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2022-09-21 12:42:01.137 +01:00 [DBG] No information found on request to perform content negotiation.
2022-09-21 12:42:01.138 +01:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2022-09-21 12:42:01.140 +01:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2022-09-21 12:42:01.143 +01:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2022-09-21 12:42:01.144 +01:00 [INF] Executing OkObjectResult, writing value of type 'Microsoft.EntityFrameworkCore.Query.Internal.EntityQueryable`1[[APIBank.ModelEntities.RefreshToken, APIBank, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2022-09-21 12:42:01.150 +01:00 [DBG] Compiling query expression: 
'DbSet<RefreshToken>()
    .Where(rt => rt.UserId == __id_0)
    .AsNoTracking()
    .Select(rt => new RefreshToken{ 
        Id = rt.Id, 
        UserId = rt.UserId, 
        RefToken = rt.RefToken, 
        Expires = rt.Expires, 
        Created = rt.Created, 
        CreatedByIp = rt.CreatedByIp, 
        Revoked = rt.Revoked, 
        RevokedByIp = rt.RevokedByIp, 
        ReplacedByToken = rt.ReplacedByToken, 
        ReasonRevoked = rt.ReasonRevoked, 
        IsExpired = rt.IsExpired, 
        IsRevoked = rt.IsRevoked, 
        IsActive = rt.IsActive 
    }
    )'
2022-09-21 12:42:01.155 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<RefreshToken>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            Id -> 0
            UserId -> 1
            RefToken -> 2
            Expires -> 3
            Created -> 4
            CreatedByIp -> 5
            Revoked -> 6
            RevokedByIp -> 7
            ReplacedByToken -> 8
            ReasonRevoked -> 9
            IsExpired -> 10
            IsRevoked -> 11
            IsActive -> 12
        SELECT r.id AS Id, r.user_id AS UserId, r.token AS RefToken, r.expires AS Expires, r.created AS Created, r.created_by_ip AS CreatedByIp, r.revoked AS Revoked, r.revoked_by_ip AS RevokedByIp, r.replaced_by_token AS ReplacedByToken, r.reason_revoked AS ReasonRevoked, r.is_expired AS IsExpired, r.is_revoked AS IsRevoked, r.is_active AS IsActive
        FROM refresh_token AS r
        WHERE r.user_id == @__id_0), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, RefreshToken>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)'
2022-09-21 12:42:01.180 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-21 12:42:01.183 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (2ms).
2022-09-21 12:42:01.190 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-21 12:42:01.196 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 12:42:01.198 +01:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.user_id AS "UserId", r.token AS "RefToken", r.expires AS "Expires", r.created AS "Created", r.created_by_ip AS "CreatedByIp", r.revoked AS "Revoked", r.revoked_by_ip AS "RevokedByIp", r.replaced_by_token AS "ReplacedByToken", r.reason_revoked AS "ReasonRevoked", r.is_expired AS "IsExpired", r.is_revoked AS "IsRevoked", r.is_active AS "IsActive"
FROM refresh_token AS r
WHERE r.user_id = @__id_0
2022-09-21 12:42:01.205 +01:00 [INF] Executed DbCommand (6ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.user_id AS "UserId", r.token AS "RefToken", r.expires AS "Expires", r.created AS "Created", r.created_by_ip AS "CreatedByIp", r.revoked AS "Revoked", r.revoked_by_ip AS "RevokedByIp", r.replaced_by_token AS "ReplacedByToken", r.reason_revoked AS "ReasonRevoked", r.is_expired AS "IsExpired", r.is_revoked AS "IsRevoked", r.is_active AS "IsActive"
FROM refresh_token AS r
WHERE r.user_id = @__id_0
2022-09-21 12:42:01.233 +01:00 [DBG] A data reader was disposed.
2022-09-21 12:42:01.248 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 12:42:01.251 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-21 12:42:01.253 +01:00 [INF] Executed action APIBank.Controllers.UsersController.GetRefreshTokens (APIBank) in 2810.3487ms
2022-09-21 12:42:01.254 +01:00 [INF] Executed endpoint 'APIBank.Controllers.UsersController.GetRefreshTokens (APIBank)'
2022-09-21 12:42:01.255 +01:00 [DBG] 'PostgresContext' disposed.
2022-09-21 12:42:01.256 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/api/Users/1/refresh-tokens - - - 200 - application/json;+charset=utf-8 8315.3245ms
2022-09-21 13:45:44.046 +01:00 [DBG] Connection id "0HMKROMER42AS" received FIN.
2022-09-21 13:45:44.079 +01:00 [DBG] Connection id "0HMKROMER42AS" is closed. The last processed stream ID was 15.
2022-09-21 13:45:44.081 +01:00 [DBG] Connection id "0HMKROMER42AS" sending FIN because: "The client closed the connection."
2022-09-21 13:45:44.084 +01:00 [DBG] Connection id "0HMKROMER42AS" stopped.
2022-09-21 17:27:21.702 +01:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2022-09-21 17:27:21.782 +01:00 [DBG] Hosting starting
2022-09-21 17:27:21.894 +01:00 [DBG] Using development certificate: CN=localhost (Thumbprint: 9CC642E9838495A6C3C202DECA6A8AD300396DD2)
2022-09-21 17:27:21.933 +01:00 [INF] Now listening on: https://localhost:7036
2022-09-21 17:27:21.935 +01:00 [INF] Now listening on: http://localhost:5036
2022-09-21 17:27:21.936 +01:00 [DBG] Loaded hosting startup assembly APIBank
2022-09-21 17:27:21.936 +01:00 [DBG] Loaded hosting startup assembly Microsoft.AspNetCore.Watch.BrowserRefresh
2022-09-21 17:27:21.937 +01:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.BrowserLink.Net
2022-09-21 17:27:21.937 +01:00 [INF] Application started. Press Ctrl+C to shut down.
2022-09-21 17:27:21.938 +01:00 [INF] Hosting environment: Development
2022-09-21 17:27:21.939 +01:00 [INF] Content root path: C:\Users\mguedesa\OneDrive - NTT DATA EMEAL\Documentos\GitHub\OpenBankAPI-NTT\APIBank\APIBank\
2022-09-21 17:27:21.939 +01:00 [DBG] Hosting started
2022-09-21 17:27:22.011 +01:00 [DBG] Connection id "0HMKRTOKH9MAS" accepted.
2022-09-21 17:27:22.014 +01:00 [DBG] Connection id "0HMKRTOKH9MAS" started.
2022-09-21 17:27:22.016 +01:00 [DBG] Connection id "0HMKRTOKH9MAT" accepted.
2022-09-21 17:27:22.017 +01:00 [DBG] Connection id "0HMKRTOKH9MAT" started.
2022-09-21 17:27:22.026 +01:00 [DBG] Connection id "0HMKRTOKH9MAT" received FIN.
2022-09-21 17:27:22.026 +01:00 [DBG] Connection id "0HMKRTOKH9MAS" received FIN.
2022-09-21 17:27:22.034 +01:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException:  Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.<FillHandshakeBufferAsync>g__InternalFillHandshakeBufferAsync|189_0[TIOAdapter](TIOAdapter adap, ValueTask`1 task, Int32 minSize)
   at System.Net.Security.SslStream.ReceiveBlobAsync[TIOAdapter](TIOAdapter adapter)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](TIOAdapter adapter, Boolean receiveFirst, Byte[] reAuthenticationData, Boolean isApm)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2022-09-21 17:27:22.034 +01:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException:  Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.<FillHandshakeBufferAsync>g__InternalFillHandshakeBufferAsync|189_0[TIOAdapter](TIOAdapter adap, ValueTask`1 task, Int32 minSize)
   at System.Net.Security.SslStream.ReceiveBlobAsync[TIOAdapter](TIOAdapter adapter)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](TIOAdapter adapter, Boolean receiveFirst, Byte[] reAuthenticationData, Boolean isApm)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2022-09-21 17:27:22.071 +01:00 [DBG] Connection id "0HMKRTOKH9MAS" stopped.
2022-09-21 17:27:22.071 +01:00 [DBG] Connection id "0HMKRTOKH9MAT" stopped.
2022-09-21 17:27:22.073 +01:00 [DBG] Connection id "0HMKRTOKH9MAS" sending FIN because: "The Socket transport's send loop completed gracefully."
2022-09-21 17:27:22.073 +01:00 [DBG] Connection id "0HMKRTOKH9MAT" sending FIN because: "The Socket transport's send loop completed gracefully."
2022-09-21 17:27:22.213 +01:00 [DBG] Connection id "0HMKRTOKH9MAU" accepted.
2022-09-21 17:27:22.216 +01:00 [DBG] Connection id "0HMKRTOKH9MAU" started.
2022-09-21 17:27:22.263 +01:00 [DBG] Connection 0HMKRTOKH9MAU established using the following protocol: "Tls12"
2022-09-21 17:27:22.327 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/swagger/index.html - -
2022-09-21 17:27:22.361 +01:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2022-09-21 17:27:22.381 +01:00 [DBG] No candidates found for the request path '/swagger/index.html'
2022-09-21 17:27:22.382 +01:00 [DBG] Request did not match any endpoints
2022-09-21 17:27:22.466 +01:00 [DBG] Response markup is scheduled to include browser refresh script injection.
2022-09-21 17:27:22.565 +01:00 [DBG] Response markup was updated to include browser refresh script injection.
2022-09-21 17:27:22.570 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/swagger/index.html - - - 200 - text/html;charset=utf-8 248.8054ms
2022-09-21 17:27:22.602 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/_framework/aspnetcore-browser-refresh.js - -
2022-09-21 17:27:22.603 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/_vs/browserLink - -
2022-09-21 17:27:22.607 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/_framework/aspnetcore-browser-refresh.js - - - 200 11984 application/javascript;+charset=utf-8 5.4609ms
2022-09-21 17:27:22.623 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/_vs/browserLink - - - 200 - text/javascript;+charset=UTF-8 20.3772ms
2022-09-21 17:27:22.767 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/swagger/v1/swagger.json - -
2022-09-21 17:27:22.769 +01:00 [DBG] No candidates found for the request path '/swagger/v1/swagger.json'
2022-09-21 17:27:22.771 +01:00 [DBG] Request did not match any endpoints
2022-09-21 17:27:22.955 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/swagger/v1/swagger.json - - - 200 - application/json;charset=utf-8 187.3072ms
2022-09-21 17:27:35.359 +01:00 [INF] Request starting HTTP/2 POST https://localhost:7036/api/Users/Login application/json 58
2022-09-21 17:27:35.370 +01:00 [DBG] 1 candidate(s) found for the request path '/api/Users/Login'
2022-09-21 17:27:35.378 +01:00 [DBG] Endpoint 'APIBank.Controllers.UsersController.Login (APIBank)' with route pattern 'api/Users/Login' is valid for the request path '/api/Users/Login'
2022-09-21 17:27:35.387 +01:00 [DBG] Request matched endpoint 'APIBank.Controllers.UsersController.Login (APIBank)'
2022-09-21 17:27:35.393 +01:00 [DBG] Static files was skipped as the request already matched an endpoint.
2022-09-21 17:27:35.726 +01:00 [INF] Executing endpoint 'APIBank.Controllers.UsersController.Login (APIBank)'
2022-09-21 17:27:35.748 +01:00 [INF] Route matched with {action = "Login", controller = "Users"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult Login(APIBank.Models.Requests.LoginRequest) on controller APIBank.Controllers.UsersController (APIBank).
2022-09-21 17:27:35.754 +01:00 [DBG] Execution plan of authorization filters (in the following order): ["APIBank.Authorization.AuthorizeAttribute"]
2022-09-21 17:27:35.758 +01:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2022-09-21 17:27:35.759 +01:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2022-09-21 17:27:35.760 +01:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2022-09-21 17:27:35.761 +01:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2022-09-21 17:27:35.765 +01:00 [DBG] Executing controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-21 17:27:35.768 +01:00 [DBG] Executed controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-21 17:27:35.776 +01:00 [DBG] Attempting to bind parameter 'model' of type 'APIBank.Models.Requests.LoginRequest' ...
2022-09-21 17:27:35.778 +01:00 [DBG] Attempting to bind parameter 'model' of type 'APIBank.Models.Requests.LoginRequest' using the name '' in request data ...
2022-09-21 17:27:35.782 +01:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2022-09-21 17:27:35.786 +01:00 [DBG] Connection id "0HMKRTOKH9MAU", Request id "0HMKRTOKH9MAU:00000009": started reading request body.
2022-09-21 17:27:35.788 +01:00 [DBG] Connection id "0HMKRTOKH9MAU", Request id "0HMKRTOKH9MAU:00000009": done reading request body.
2022-09-21 17:27:35.792 +01:00 [DBG] JSON input formatter succeeded, deserializing to type 'APIBank.Models.Requests.LoginRequest'
2022-09-21 17:27:35.793 +01:00 [DBG] Done attempting to bind parameter 'model' of type 'APIBank.Models.Requests.LoginRequest'.
2022-09-21 17:27:35.794 +01:00 [DBG] Done attempting to bind parameter 'model' of type 'APIBank.Models.Requests.LoginRequest'.
2022-09-21 17:27:35.794 +01:00 [DBG] Attempting to validate the bound parameter 'model' of type 'APIBank.Models.Requests.LoginRequest' ...
2022-09-21 17:27:35.805 +01:00 [DBG] Done attempting to validate the bound parameter 'model' of type 'APIBank.Models.Requests.LoginRequest'.
2022-09-21 17:27:35.898 +01:00 [DBG] An additional 'IServiceProvider' was created for internal use by Entity Framework. An existing service provider was not used due to the following configuration changes: configuration changed for 'Core:ConfigureWarnings', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:UseAdminDatabase', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:SetPostgresVersion', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:UseRedshift', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:ReverseNullOrdering', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:RemoteCertificateValidationCallback', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:ProvideClientCertificatesCallback', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:ProvidePasswordCallback'.
2022-09-21 17:27:36.855 +01:00 [INF] Entity Framework Core 6.0.9 initialized 'PostgresContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:6.0.7+5b98e4b74de93b590b44aef8dd7967c03acc433c' with options: None
2022-09-21 17:27:36.901 +01:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .SingleOrDefault(x => x.Username == __model_Username_0)'
2022-09-21 17:27:37.164 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<User>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: User.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: User.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 1], [Property: User.Email (string) Required Index MaxLength(254), 2], [Property: User.FullName (string) Required MaxLength(100), 3], [Property: User.PasswordChangedAt (DateTime) Required ValueGenerated.OnAdd, 4], [Property: User.PasswordHash (string) Required MaxLength(200), 5], [Property: User.Username (string) Required Index MaxLength(50), 6] }
        SELECT TOP(2) u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
        FROM users AS u
        WHERE u.username == @__model_Username_0), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, User>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)
    .SingleOrDefault()'
2022-09-21 17:27:37.202 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-21 17:27:37.241 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (35ms).
2022-09-21 17:27:37.249 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-21 17:27:37.552 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 17:27:37.568 +01:00 [DBG] Executing DbCommand [Parameters=[@__model_Username_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.username = @__model_Username_0
LIMIT 2
2022-09-21 17:27:37.662 +01:00 [INF] Executed DbCommand (97ms) [Parameters=[@__model_Username_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.username = @__model_Username_0
LIMIT 2
2022-09-21 17:27:37.700 +01:00 [DBG] Context 'PostgresContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 17:27:37.743 +01:00 [DBG] A data reader was disposed.
2022-09-21 17:27:37.750 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 17:27:37.756 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-21 17:27:38.123 +01:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .Any(user => user.RefreshTokenCollection
        .Any(reftoken => reftoken.RefToken == __token_0))'
2022-09-21 17:27:38.190 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<bool>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            EmptyProjectionMember -> 0
        SELECT EXISTS (
            SELECT 1
            FROM users AS u
            WHERE EXISTS (
                SELECT 1
                FROM refresh_token AS r
                WHERE ((u.id != NULL) && (u.id == r.user_id)) && (r.token == @__token_0)))), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, bool>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)
    .Single()'
2022-09-21 17:27:38.204 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-21 17:27:38.206 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2022-09-21 17:27:38.206 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-21 17:27:38.207 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 17:27:38.208 +01:00 [DBG] Executing DbCommand [Parameters=[@__token_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM users AS u
    WHERE EXISTS (
        SELECT 1
        FROM refresh_token AS r
        WHERE (u.id = r.user_id) AND (r.token = @__token_0)))
2022-09-21 17:27:38.213 +01:00 [INF] Executed DbCommand (5ms) [Parameters=[@__token_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM users AS u
    WHERE EXISTS (
        SELECT 1
        FROM refresh_token AS r
        WHERE (u.id = r.user_id) AND (r.token = @__token_0)))
2022-09-21 17:27:38.218 +01:00 [DBG] A data reader was disposed.
2022-09-21 17:27:38.219 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 17:27:38.219 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-21 17:27:38.227 +01:00 [DBG] Compiling query expression: 
'DbSet<RefreshToken>()
    .Where(rt => rt.UserId == __id_0)
    .AsNoTracking()
    .Select(rt => new RefreshToken{ 
        Id = rt.Id, 
        UserId = rt.UserId, 
        RefToken = rt.RefToken, 
        Expires = rt.Expires, 
        Created = rt.Created, 
        CreatedByIp = rt.CreatedByIp, 
        Revoked = rt.Revoked, 
        RevokedByIp = rt.RevokedByIp, 
        ReplacedByToken = rt.ReplacedByToken, 
        ReasonRevoked = rt.ReasonRevoked, 
        IsExpired = rt.IsExpired, 
        IsRevoked = rt.IsRevoked, 
        IsActive = rt.IsActive 
    }
    )'
2022-09-21 17:27:38.243 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<RefreshToken>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            Id -> 0
            UserId -> 1
            RefToken -> 2
            Expires -> 3
            Created -> 4
            CreatedByIp -> 5
            Revoked -> 6
            RevokedByIp -> 7
            ReplacedByToken -> 8
            ReasonRevoked -> 9
            IsExpired -> 10
            IsRevoked -> 11
            IsActive -> 12
        SELECT r.id AS Id, r.user_id AS UserId, r.token AS RefToken, r.expires AS Expires, r.created AS Created, r.created_by_ip AS CreatedByIp, r.revoked AS Revoked, r.revoked_by_ip AS RevokedByIp, r.replaced_by_token AS ReplacedByToken, r.reason_revoked AS ReasonRevoked, r.is_expired AS IsExpired, r.is_revoked AS IsRevoked, r.is_active AS IsActive
        FROM refresh_token AS r
        WHERE r.user_id == @__id_0), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, RefreshToken>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)'
2022-09-21 17:27:38.249 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-21 17:27:38.250 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2022-09-21 17:27:38.251 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-21 17:27:38.251 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 17:27:38.252 +01:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.user_id AS "UserId", r.token AS "RefToken", r.expires AS "Expires", r.created AS "Created", r.created_by_ip AS "CreatedByIp", r.revoked AS "Revoked", r.revoked_by_ip AS "RevokedByIp", r.replaced_by_token AS "ReplacedByToken", r.reason_revoked AS "ReasonRevoked", r.is_expired AS "IsExpired", r.is_revoked AS "IsRevoked", r.is_active AS "IsActive"
FROM refresh_token AS r
WHERE r.user_id = @__id_0
2022-09-21 17:27:38.256 +01:00 [INF] Executed DbCommand (3ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.user_id AS "UserId", r.token AS "RefToken", r.expires AS "Expires", r.created AS "Created", r.created_by_ip AS "CreatedByIp", r.revoked AS "Revoked", r.revoked_by_ip AS "RevokedByIp", r.replaced_by_token AS "ReplacedByToken", r.reason_revoked AS "ReasonRevoked", r.is_expired AS "IsExpired", r.is_revoked AS "IsRevoked", r.is_active AS "IsActive"
FROM refresh_token AS r
WHERE r.user_id = @__id_0
2022-09-21 17:27:38.258 +01:00 [DBG] A data reader was disposed.
2022-09-21 17:27:38.258 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 17:27:38.259 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-21 17:27:38.273 +01:00 [DBG] An entity of type 'User' tracked by 'PostgresContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 17:27:38.294 +01:00 [DBG] 'PostgresContext' generated a temporary value for the property 'Id.RefreshToken'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 17:27:38.332 +01:00 [DBG] Context 'PostgresContext' started tracking 'RefreshToken' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 17:27:38.336 +01:00 [DBG] SaveChanges starting for 'PostgresContext'.
2022-09-21 17:27:38.339 +01:00 [DBG] DetectChanges starting for 'PostgresContext'.
2022-09-21 17:27:38.373 +01:00 [DBG] 1 entities were added and 0 entities were removed from navigation 'User.RefreshTokenCollection'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 17:27:38.385 +01:00 [DBG] The foreign key property 'RefreshToken.UserId' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2022-09-21 17:27:38.398 +01:00 [DBG] DetectChanges completed for 'PostgresContext'.
2022-09-21 17:27:38.411 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-21 17:27:38.414 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 17:27:38.416 +01:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2022-09-21 17:27:38.422 +01:00 [DBG] Began transaction with isolation level 'ReadCommitted'.
2022-09-21 17:27:38.474 +01:00 [DBG] Executing 2 update commands as a batch.
2022-09-21 17:27:38.490 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-21 17:27:38.493 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (2ms).
2022-09-21 17:27:38.497 +01:00 [DBG] Executing DbCommand [Parameters=[@p0='?' (DbType = DateTime), @p1='?', @p2='?' (DbType = DateTime), @p3='?' (DbType = Boolean), @p4='?' (DbType = Boolean), @p5='?' (DbType = Boolean), @p6='?', @p7='?', @p8='?', @p9='?' (DbType = DateTime), @p10='?', @p11='?' (DbType = Int32), @p18='?' (DbType = Int32), @p12='?' (DbType = DateTime), @p13='?', @p14='?', @p15='?' (DbType = DateTime), @p16='?', @p17='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO refresh_token (created, created_by_ip, expires, is_active, is_expired, is_revoked, reason_revoked, token, replaced_by_token, revoked, revoked_by_ip, user_id)
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11)
RETURNING id;
UPDATE users SET created_at = @p12, email = @p13, full_name = @p14, password_changed_at = @p15, password_hash = @p16, username = @p17
WHERE id = @p18;
2022-09-21 17:27:38.505 +01:00 [INF] Executed DbCommand (8ms) [Parameters=[@p0='?' (DbType = DateTime), @p1='?', @p2='?' (DbType = DateTime), @p3='?' (DbType = Boolean), @p4='?' (DbType = Boolean), @p5='?' (DbType = Boolean), @p6='?', @p7='?', @p8='?', @p9='?' (DbType = DateTime), @p10='?', @p11='?' (DbType = Int32), @p18='?' (DbType = Int32), @p12='?' (DbType = DateTime), @p13='?', @p14='?', @p15='?' (DbType = DateTime), @p16='?', @p17='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO refresh_token (created, created_by_ip, expires, is_active, is_expired, is_revoked, reason_revoked, token, replaced_by_token, revoked, revoked_by_ip, user_id)
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11)
RETURNING id;
UPDATE users SET created_at = @p12, email = @p13, full_name = @p14, password_changed_at = @p15, password_hash = @p16, username = @p17
WHERE id = @p18;
2022-09-21 17:27:38.523 +01:00 [DBG] The foreign key property 'RefreshToken.Id' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2022-09-21 17:27:38.530 +01:00 [DBG] A data reader was disposed.
2022-09-21 17:27:38.532 +01:00 [DBG] Committing transaction.
2022-09-21 17:27:38.536 +01:00 [DBG] Committed transaction.
2022-09-21 17:27:38.538 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 17:27:38.539 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-21 17:27:38.540 +01:00 [DBG] Disposing transaction.
2022-09-21 17:27:38.546 +01:00 [DBG] An entity of type 'RefreshToken' tracked by 'PostgresContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 17:27:38.549 +01:00 [DBG] An entity of type 'User' tracked by 'PostgresContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 17:27:38.551 +01:00 [DBG] SaveChanges completed for 'PostgresContext' with 2 entities written to the database.
2022-09-21 17:27:38.554 +01:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2022-09-21 17:27:38.557 +01:00 [DBG] Attempting to select an output formatter based on Accept header '["text/plain"]'.
2022-09-21 17:27:38.559 +01:00 [DBG] Could not find an output formatter based on content negotiation. Accepted types were (["text/plain"])
2022-09-21 17:27:38.559 +01:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2022-09-21 17:27:38.561 +01:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2022-09-21 17:27:38.562 +01:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2022-09-21 17:27:38.563 +01:00 [INF] Executing OkObjectResult, writing value of type 'APIBank.Models.Users.Responses.LoginResponse'.
2022-09-21 17:27:38.574 +01:00 [INF] Executed action APIBank.Controllers.UsersController.Login (APIBank) in 2808.1326ms
2022-09-21 17:27:38.576 +01:00 [INF] Executed endpoint 'APIBank.Controllers.UsersController.Login (APIBank)'
2022-09-21 17:27:38.580 +01:00 [DBG] 'PostgresContext' disposed.
2022-09-21 17:27:38.583 +01:00 [INF] Request finished HTTP/2 POST https://localhost:7036/api/Users/Login application/json 58 - 200 - application/json;+charset=utf-8 3223.4275ms
2022-09-21 17:27:55.361 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/api/Accounts/GetAll - -
2022-09-21 17:27:55.365 +01:00 [DBG] 1 candidate(s) found for the request path '/api/Accounts/GetAll'
2022-09-21 17:27:55.366 +01:00 [DBG] Endpoint 'APIBank.Controllers.AccountsController.GetAllFromUser (APIBank)' with route pattern 'api/Accounts/GetAll' is valid for the request path '/api/Accounts/GetAll'
2022-09-21 17:27:55.369 +01:00 [DBG] Request matched endpoint 'APIBank.Controllers.AccountsController.GetAllFromUser (APIBank)'
2022-09-21 17:27:55.372 +01:00 [DBG] Static files was skipped as the request already matched an endpoint.
2022-09-21 17:27:55.476 +01:00 [INF] Entity Framework Core 6.0.9 initialized 'PostgresContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:6.0.7+5b98e4b74de93b590b44aef8dd7967c03acc433c' with options: None
2022-09-21 17:27:55.490 +01:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .FirstOrDefault(e => EF.Property<int>(e, "Id") == __p_0)'
2022-09-21 17:27:55.495 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<User>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: User.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: User.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 1], [Property: User.Email (string) Required Index MaxLength(254), 2], [Property: User.FullName (string) Required MaxLength(100), 3], [Property: User.PasswordChangedAt (DateTime) Required ValueGenerated.OnAdd, 4], [Property: User.PasswordHash (string) Required MaxLength(200), 5], [Property: User.Username (string) Required Index MaxLength(50), 6] }
        SELECT TOP(1) u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
        FROM users AS u
        WHERE u.id == @__p_0), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, User>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)
    .SingleOrDefault()'
2022-09-21 17:27:55.498 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-21 17:27:55.499 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2022-09-21 17:27:55.501 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-21 17:27:55.502 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 17:27:55.503 +01:00 [DBG] Executing DbCommand [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.id = @__p_0
LIMIT 1
2022-09-21 17:27:55.505 +01:00 [INF] Executed DbCommand (3ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.id = @__p_0
LIMIT 1
2022-09-21 17:27:55.507 +01:00 [DBG] Context 'PostgresContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 17:27:55.508 +01:00 [DBG] A data reader was disposed.
2022-09-21 17:27:55.509 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 17:27:55.509 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-21 17:27:55.510 +01:00 [INF] Executing endpoint 'APIBank.Controllers.AccountsController.GetAllFromUser (APIBank)'
2022-09-21 17:27:55.512 +01:00 [INF] Route matched with {action = "GetAllFromUser", controller = "Accounts"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult GetAllFromUser() on controller APIBank.Controllers.AccountsController (APIBank).
2022-09-21 17:27:55.515 +01:00 [DBG] Execution plan of authorization filters (in the following order): ["APIBank.Authorization.AuthorizeAttribute"]
2022-09-21 17:27:55.516 +01:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2022-09-21 17:27:55.518 +01:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2022-09-21 17:27:55.522 +01:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2022-09-21 17:27:55.523 +01:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2022-09-21 17:27:55.524 +01:00 [DBG] Executing controller factory for controller APIBank.Controllers.AccountsController (APIBank)
2022-09-21 17:27:55.525 +01:00 [DBG] Executed controller factory for controller APIBank.Controllers.AccountsController (APIBank)
2022-09-21 17:27:55.529 +01:00 [DBG] Compiling query expression: 
'DbSet<Account>()
    .Where(u => u.UserId == __userId_0)
    .Select(u => new AccountRe{ 
        Balance = u.Balance, 
        CreatedAt = u.CreatedAt, 
        Currency = u.Currency, 
        Id = u.Id 
    }
    )'
2022-09-21 17:27:55.535 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<AccountRe>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            Balance -> 0
            CreatedAt -> 1
            Currency -> 2
            Id -> 3
        SELECT a.balance AS Balance, a.created_at AS CreatedAt, a.currency AS Currency, a.id AS Id
        FROM accounts AS a
        WHERE a.user_id == @__userId_0), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, AccountRe>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)'
2022-09-21 17:27:55.537 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-21 17:27:55.538 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2022-09-21 17:27:55.539 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-21 17:27:55.539 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 17:27:55.540 +01:00 [DBG] Executing DbCommand [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a.balance AS "Balance", a.created_at AS "CreatedAt", a.currency AS "Currency", a.id AS "Id"
FROM accounts AS a
WHERE a.user_id = @__userId_0
2022-09-21 17:27:55.543 +01:00 [INF] Executed DbCommand (3ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a.balance AS "Balance", a.created_at AS "CreatedAt", a.currency AS "Currency", a.id AS "Id"
FROM accounts AS a
WHERE a.user_id = @__userId_0
2022-09-21 17:27:55.553 +01:00 [DBG] A data reader was disposed.
2022-09-21 17:27:55.555 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 17:27:55.556 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-21 17:27:55.557 +01:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2022-09-21 17:27:55.559 +01:00 [DBG] Attempting to select an output formatter based on Accept header '["text/plain"]'.
2022-09-21 17:27:55.560 +01:00 [DBG] Could not find an output formatter based on content negotiation. Accepted types were (["text/plain"])
2022-09-21 17:27:55.560 +01:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2022-09-21 17:27:55.561 +01:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2022-09-21 17:27:55.562 +01:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2022-09-21 17:27:55.563 +01:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[APIBank.Models.Accounts.AccountRe, APIBank, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2022-09-21 17:27:55.572 +01:00 [INF] Executed action APIBank.Controllers.AccountsController.GetAllFromUser (APIBank) in 48.5826ms
2022-09-21 17:27:55.575 +01:00 [INF] Executed endpoint 'APIBank.Controllers.AccountsController.GetAllFromUser (APIBank)'
2022-09-21 17:27:55.576 +01:00 [DBG] 'PostgresContext' disposed.
2022-09-21 17:27:55.578 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/api/Accounts/GetAll - - - 200 - application/json;+charset=utf-8 216.2052ms
2022-09-21 17:30:07.374 +01:00 [DBG] Connection id "0HMKRTOKH9MAU" is closing.
2022-09-21 17:30:07.377 +01:00 [DBG] Connection id "0HMKRTOKH9MAU" is closed. The last processed stream ID was 11.
2022-09-21 17:30:07.379 +01:00 [DBG] Connection id "0HMKRTOKH9MAU" received FIN.
2022-09-21 17:30:07.381 +01:00 [DBG] Connection id "0HMKRTOKH9MAU" sending FIN because: "The client closed the connection."
2022-09-21 17:30:07.389 +01:00 [DBG] Connection id "0HMKRTOKH9MAU" stopped.
2022-09-21 17:36:42.235 +01:00 [DBG] Connection id "0HMKRTOKH9MAV" accepted.
2022-09-21 17:36:42.239 +01:00 [DBG] Connection id "0HMKRTOKH9MAV" started.
2022-09-21 17:36:42.243 +01:00 [DBG] Connection 0HMKRTOKH9MAV established using the following protocol: "Tls12"
2022-09-21 17:36:42.246 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/api/Accounts/GetAll - -
2022-09-21 17:36:42.251 +01:00 [DBG] 1 candidate(s) found for the request path '/api/Accounts/GetAll'
2022-09-21 17:36:42.261 +01:00 [DBG] Endpoint 'APIBank.Controllers.AccountsController.GetAllFromUser (APIBank)' with route pattern 'api/Accounts/GetAll' is valid for the request path '/api/Accounts/GetAll'
2022-09-21 17:36:42.265 +01:00 [DBG] Request matched endpoint 'APIBank.Controllers.AccountsController.GetAllFromUser (APIBank)'
2022-09-21 17:36:42.267 +01:00 [DBG] Static files was skipped as the request already matched an endpoint.
2022-09-21 17:36:42.279 +01:00 [INF] Executing endpoint 'APIBank.Controllers.AccountsController.GetAllFromUser (APIBank)'
2022-09-21 17:36:42.280 +01:00 [INF] Route matched with {action = "GetAllFromUser", controller = "Accounts"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult GetAllFromUser() on controller APIBank.Controllers.AccountsController (APIBank).
2022-09-21 17:36:42.282 +01:00 [DBG] Execution plan of authorization filters (in the following order): ["APIBank.Authorization.AuthorizeAttribute"]
2022-09-21 17:36:42.284 +01:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2022-09-21 17:36:42.285 +01:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2022-09-21 17:36:42.288 +01:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2022-09-21 17:36:42.291 +01:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2022-09-21 17:36:42.293 +01:00 [INF] Authorization failed for the request at filter 'APIBank.Authorization.AuthorizeAttribute'.
2022-09-21 17:36:42.296 +01:00 [INF] Executing JsonResult, writing value of type '<>f__AnonymousType0`1[[System.String, System.Private.CoreLib, Version=6.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2022-09-21 17:36:42.299 +01:00 [INF] Executed action APIBank.Controllers.AccountsController.GetAllFromUser (APIBank) in 5.8507ms
2022-09-21 17:36:42.301 +01:00 [INF] Executed endpoint 'APIBank.Controllers.AccountsController.GetAllFromUser (APIBank)'
2022-09-21 17:36:42.302 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/api/Accounts/GetAll - - - 401 - application/json;+charset=utf-8 55.4864ms
2022-09-21 17:36:47.827 +01:00 [INF] Request starting HTTP/2 POST https://localhost:7036/api/Users/refreshToken - 0
2022-09-21 17:36:47.832 +01:00 [DBG] 1 candidate(s) found for the request path '/api/Users/refreshToken'
2022-09-21 17:36:47.834 +01:00 [DBG] Endpoint 'APIBank.Controllers.UsersController.RefreshToken (APIBank)' with route pattern 'api/Users/refreshToken' is valid for the request path '/api/Users/refreshToken'
2022-09-21 17:36:47.836 +01:00 [DBG] Request matched endpoint 'APIBank.Controllers.UsersController.RefreshToken (APIBank)'
2022-09-21 17:36:47.838 +01:00 [DBG] Static files was skipped as the request already matched an endpoint.
2022-09-21 17:36:47.840 +01:00 [INF] Executing endpoint 'APIBank.Controllers.UsersController.RefreshToken (APIBank)'
2022-09-21 17:36:47.843 +01:00 [INF] Route matched with {action = "RefreshToken", controller = "Users"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult RefreshToken() on controller APIBank.Controllers.UsersController (APIBank).
2022-09-21 17:36:47.844 +01:00 [DBG] Execution plan of authorization filters (in the following order): ["APIBank.Authorization.AuthorizeAttribute"]
2022-09-21 17:36:47.845 +01:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2022-09-21 17:36:47.846 +01:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2022-09-21 17:36:47.850 +01:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2022-09-21 17:36:47.852 +01:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2022-09-21 17:36:47.854 +01:00 [DBG] Executing controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-21 17:36:47.855 +01:00 [DBG] Executed controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-21 17:36:47.922 +01:00 [INF] Entity Framework Core 6.0.9 initialized 'PostgresContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:6.0.7+5b98e4b74de93b590b44aef8dd7967c03acc433c' with options: None
2022-09-21 17:36:47.927 +01:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .SingleOrDefault(userQuery => userQuery.RefreshTokenCollection
        .Any(refTokenQuery => refTokenQuery.RefToken == __refToken_0))'
2022-09-21 17:36:47.932 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<User>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: User.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: User.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 1], [Property: User.Email (string) Required Index MaxLength(254), 2], [Property: User.FullName (string) Required MaxLength(100), 3], [Property: User.PasswordChangedAt (DateTime) Required ValueGenerated.OnAdd, 4], [Property: User.PasswordHash (string) Required MaxLength(200), 5], [Property: User.Username (string) Required Index MaxLength(50), 6] }
        SELECT TOP(2) u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
        FROM users AS u
        WHERE EXISTS (
            SELECT 1
            FROM refresh_token AS r
            WHERE ((u.id != NULL) && (u.id == r.user_id)) && (r.token == @__refToken_0))), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, User>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)
    .SingleOrDefault()'
2022-09-21 17:36:47.937 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-21 17:36:47.938 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2022-09-21 17:36:47.938 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-21 17:36:48.122 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 17:36:48.125 +01:00 [DBG] Executing DbCommand [Parameters=[@__refToken_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE EXISTS (
    SELECT 1
    FROM refresh_token AS r
    WHERE (u.id = r.user_id) AND (r.token = @__refToken_0))
LIMIT 2
2022-09-21 17:36:48.129 +01:00 [INF] Executed DbCommand (4ms) [Parameters=[@__refToken_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE EXISTS (
    SELECT 1
    FROM refresh_token AS r
    WHERE (u.id = r.user_id) AND (r.token = @__refToken_0))
LIMIT 2
2022-09-21 17:36:48.133 +01:00 [DBG] Context 'PostgresContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 17:36:48.135 +01:00 [DBG] A data reader was disposed.
2022-09-21 17:36:48.136 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 17:36:48.137 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-21 17:36:48.141 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-21 17:36:48.141 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2022-09-21 17:36:48.142 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-21 17:36:48.143 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 17:36:48.144 +01:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.user_id AS "UserId", r.token AS "RefToken", r.expires AS "Expires", r.created AS "Created", r.created_by_ip AS "CreatedByIp", r.revoked AS "Revoked", r.revoked_by_ip AS "RevokedByIp", r.replaced_by_token AS "ReplacedByToken", r.reason_revoked AS "ReasonRevoked", r.is_expired AS "IsExpired", r.is_revoked AS "IsRevoked", r.is_active AS "IsActive"
FROM refresh_token AS r
WHERE r.user_id = @__id_0
2022-09-21 17:36:48.147 +01:00 [INF] Executed DbCommand (3ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.user_id AS "UserId", r.token AS "RefToken", r.expires AS "Expires", r.created AS "Created", r.created_by_ip AS "CreatedByIp", r.revoked AS "Revoked", r.revoked_by_ip AS "RevokedByIp", r.replaced_by_token AS "ReplacedByToken", r.reason_revoked AS "ReasonRevoked", r.is_expired AS "IsExpired", r.is_revoked AS "IsRevoked", r.is_active AS "IsActive"
FROM refresh_token AS r
WHERE r.user_id = @__id_0
2022-09-21 17:36:48.152 +01:00 [DBG] A data reader was disposed.
2022-09-21 17:36:48.153 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 17:36:48.154 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-21 17:36:48.155 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-21 17:36:48.156 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2022-09-21 17:36:48.157 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-21 17:36:48.158 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 17:36:48.159 +01:00 [DBG] Executing DbCommand [Parameters=[@__token_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM users AS u
    WHERE EXISTS (
        SELECT 1
        FROM refresh_token AS r
        WHERE (u.id = r.user_id) AND (r.token = @__token_0)))
2022-09-21 17:36:48.161 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[@__token_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM users AS u
    WHERE EXISTS (
        SELECT 1
        FROM refresh_token AS r
        WHERE (u.id = r.user_id) AND (r.token = @__token_0)))
2022-09-21 17:36:48.163 +01:00 [DBG] A data reader was disposed.
2022-09-21 17:36:48.163 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 17:36:48.164 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-21 17:36:48.167 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-21 17:36:48.168 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2022-09-21 17:36:48.169 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-21 17:36:48.170 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 17:36:48.171 +01:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.user_id AS "UserId", r.token AS "RefToken", r.expires AS "Expires", r.created AS "Created", r.created_by_ip AS "CreatedByIp", r.revoked AS "Revoked", r.revoked_by_ip AS "RevokedByIp", r.replaced_by_token AS "ReplacedByToken", r.reason_revoked AS "ReasonRevoked", r.is_expired AS "IsExpired", r.is_revoked AS "IsRevoked", r.is_active AS "IsActive"
FROM refresh_token AS r
WHERE r.user_id = @__id_0
2022-09-21 17:36:48.173 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.user_id AS "UserId", r.token AS "RefToken", r.expires AS "Expires", r.created AS "Created", r.created_by_ip AS "CreatedByIp", r.revoked AS "Revoked", r.revoked_by_ip AS "RevokedByIp", r.replaced_by_token AS "ReplacedByToken", r.reason_revoked AS "ReasonRevoked", r.is_expired AS "IsExpired", r.is_revoked AS "IsRevoked", r.is_active AS "IsActive"
FROM refresh_token AS r
WHERE r.user_id = @__id_0
2022-09-21 17:36:48.175 +01:00 [DBG] A data reader was disposed.
2022-09-21 17:36:48.177 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 17:36:48.178 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-21 17:36:48.178 +01:00 [DBG] An entity of type 'User' tracked by 'PostgresContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 17:36:48.180 +01:00 [DBG] SaveChanges starting for 'PostgresContext'.
2022-09-21 17:36:48.181 +01:00 [DBG] DetectChanges starting for 'PostgresContext'.
2022-09-21 17:36:48.182 +01:00 [DBG] 1 entities were added and 0 entities were removed from navigation 'User.RefreshTokenCollection'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 17:36:48.187 +01:00 [DBG] 'PostgresContext' generated a temporary value for the property 'Id.RefreshToken'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 17:36:48.189 +01:00 [DBG] Context 'PostgresContext' started tracking 'RefreshToken' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 17:36:48.190 +01:00 [DBG] DetectChanges completed for 'PostgresContext'.
2022-09-21 17:36:48.191 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-21 17:36:48.194 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 17:36:48.195 +01:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2022-09-21 17:36:48.196 +01:00 [DBG] Began transaction with isolation level 'ReadCommitted'.
2022-09-21 17:36:48.197 +01:00 [DBG] Executing 2 update commands as a batch.
2022-09-21 17:36:48.199 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-21 17:36:48.201 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (2ms).
2022-09-21 17:36:48.202 +01:00 [DBG] Executing DbCommand [Parameters=[@p0='?' (DbType = DateTime), @p1='?', @p2='?' (DbType = DateTime), @p3='?' (DbType = Boolean), @p4='?' (DbType = Boolean), @p5='?' (DbType = Boolean), @p6='?', @p7='?', @p8='?', @p9='?' (DbType = DateTime), @p10='?', @p11='?' (DbType = Int32), @p18='?' (DbType = Int32), @p12='?' (DbType = DateTime), @p13='?', @p14='?', @p15='?' (DbType = DateTime), @p16='?', @p17='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO refresh_token (created, created_by_ip, expires, is_active, is_expired, is_revoked, reason_revoked, token, replaced_by_token, revoked, revoked_by_ip, user_id)
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11)
RETURNING id;
UPDATE users SET created_at = @p12, email = @p13, full_name = @p14, password_changed_at = @p15, password_hash = @p16, username = @p17
WHERE id = @p18;
2022-09-21 17:36:48.205 +01:00 [INF] Executed DbCommand (3ms) [Parameters=[@p0='?' (DbType = DateTime), @p1='?', @p2='?' (DbType = DateTime), @p3='?' (DbType = Boolean), @p4='?' (DbType = Boolean), @p5='?' (DbType = Boolean), @p6='?', @p7='?', @p8='?', @p9='?' (DbType = DateTime), @p10='?', @p11='?' (DbType = Int32), @p18='?' (DbType = Int32), @p12='?' (DbType = DateTime), @p13='?', @p14='?', @p15='?' (DbType = DateTime), @p16='?', @p17='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO refresh_token (created, created_by_ip, expires, is_active, is_expired, is_revoked, reason_revoked, token, replaced_by_token, revoked, revoked_by_ip, user_id)
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11)
RETURNING id;
UPDATE users SET created_at = @p12, email = @p13, full_name = @p14, password_changed_at = @p15, password_hash = @p16, username = @p17
WHERE id = @p18;
2022-09-21 17:36:48.208 +01:00 [DBG] The foreign key property 'RefreshToken.Id' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2022-09-21 17:36:48.209 +01:00 [DBG] A data reader was disposed.
2022-09-21 17:36:48.210 +01:00 [DBG] Committing transaction.
2022-09-21 17:36:48.211 +01:00 [DBG] Committed transaction.
2022-09-21 17:36:48.212 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 17:36:48.213 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-21 17:36:48.214 +01:00 [DBG] Disposing transaction.
2022-09-21 17:36:48.215 +01:00 [DBG] An entity of type 'RefreshToken' tracked by 'PostgresContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 17:36:48.219 +01:00 [DBG] An entity of type 'User' tracked by 'PostgresContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 17:36:48.220 +01:00 [DBG] SaveChanges completed for 'PostgresContext' with 2 entities written to the database.
2022-09-21 17:36:48.221 +01:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2022-09-21 17:36:48.225 +01:00 [DBG] Attempting to select an output formatter based on Accept header '["text/plain"]'.
2022-09-21 17:36:48.226 +01:00 [DBG] Could not find an output formatter based on content negotiation. Accepted types were (["text/plain"])
2022-09-21 17:36:48.226 +01:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2022-09-21 17:36:48.227 +01:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2022-09-21 17:36:48.228 +01:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2022-09-21 17:36:48.229 +01:00 [INF] Executing OkObjectResult, writing value of type 'APIBank.Models.Users.Responses.LoginResponse'.
2022-09-21 17:36:48.229 +01:00 [INF] Executed action APIBank.Controllers.UsersController.RefreshToken (APIBank) in 375.9261ms
2022-09-21 17:36:48.231 +01:00 [INF] Executed endpoint 'APIBank.Controllers.UsersController.RefreshToken (APIBank)'
2022-09-21 17:36:48.233 +01:00 [DBG] 'PostgresContext' disposed.
2022-09-21 17:36:48.235 +01:00 [INF] Request finished HTTP/2 POST https://localhost:7036/api/Users/refreshToken - 0 - 200 - application/json;+charset=utf-8 407.2390ms
2022-09-21 17:37:00.468 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/api/Accounts/GetAll - -
2022-09-21 17:37:00.472 +01:00 [DBG] 1 candidate(s) found for the request path '/api/Accounts/GetAll'
2022-09-21 17:37:00.474 +01:00 [DBG] Endpoint 'APIBank.Controllers.AccountsController.GetAllFromUser (APIBank)' with route pattern 'api/Accounts/GetAll' is valid for the request path '/api/Accounts/GetAll'
2022-09-21 17:37:00.476 +01:00 [DBG] Request matched endpoint 'APIBank.Controllers.AccountsController.GetAllFromUser (APIBank)'
2022-09-21 17:37:00.480 +01:00 [DBG] Static files was skipped as the request already matched an endpoint.
2022-09-21 17:37:00.484 +01:00 [INF] Entity Framework Core 6.0.9 initialized 'PostgresContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:6.0.7+5b98e4b74de93b590b44aef8dd7967c03acc433c' with options: None
2022-09-21 17:37:00.492 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-21 17:37:00.495 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (2ms).
2022-09-21 17:37:00.497 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-21 17:37:00.498 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 17:37:00.499 +01:00 [DBG] Executing DbCommand [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.id = @__p_0
LIMIT 1
2022-09-21 17:37:00.501 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.id = @__p_0
LIMIT 1
2022-09-21 17:37:00.507 +01:00 [DBG] Context 'PostgresContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 17:37:00.508 +01:00 [DBG] A data reader was disposed.
2022-09-21 17:37:00.509 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 17:37:00.511 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-21 17:37:00.512 +01:00 [INF] Executing endpoint 'APIBank.Controllers.AccountsController.GetAllFromUser (APIBank)'
2022-09-21 17:37:00.513 +01:00 [INF] Route matched with {action = "GetAllFromUser", controller = "Accounts"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult GetAllFromUser() on controller APIBank.Controllers.AccountsController (APIBank).
2022-09-21 17:37:00.514 +01:00 [DBG] Execution plan of authorization filters (in the following order): ["APIBank.Authorization.AuthorizeAttribute"]
2022-09-21 17:37:00.515 +01:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2022-09-21 17:37:00.516 +01:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2022-09-21 17:37:00.517 +01:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2022-09-21 17:37:00.518 +01:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2022-09-21 17:37:00.521 +01:00 [DBG] Executing controller factory for controller APIBank.Controllers.AccountsController (APIBank)
2022-09-21 17:37:00.524 +01:00 [DBG] Executed controller factory for controller APIBank.Controllers.AccountsController (APIBank)
2022-09-21 17:37:00.527 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-21 17:37:00.528 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2022-09-21 17:37:00.529 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-21 17:37:00.529 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 17:37:00.530 +01:00 [DBG] Executing DbCommand [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a.balance AS "Balance", a.created_at AS "CreatedAt", a.currency AS "Currency", a.id AS "Id"
FROM accounts AS a
WHERE a.user_id = @__userId_0
2022-09-21 17:37:00.533 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a.balance AS "Balance", a.created_at AS "CreatedAt", a.currency AS "Currency", a.id AS "Id"
FROM accounts AS a
WHERE a.user_id = @__userId_0
2022-09-21 17:37:00.536 +01:00 [DBG] A data reader was disposed.
2022-09-21 17:37:00.537 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 17:37:00.540 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-21 17:37:00.542 +01:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2022-09-21 17:37:00.544 +01:00 [DBG] Attempting to select an output formatter based on Accept header '["text/plain"]'.
2022-09-21 17:37:00.545 +01:00 [DBG] Could not find an output formatter based on content negotiation. Accepted types were (["text/plain"])
2022-09-21 17:37:00.545 +01:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2022-09-21 17:37:00.546 +01:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2022-09-21 17:37:00.547 +01:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2022-09-21 17:37:00.548 +01:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[APIBank.Models.Accounts.AccountRe, APIBank, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2022-09-21 17:37:00.549 +01:00 [INF] Executed action APIBank.Controllers.AccountsController.GetAllFromUser (APIBank) in 28.0358ms
2022-09-21 17:37:00.551 +01:00 [INF] Executed endpoint 'APIBank.Controllers.AccountsController.GetAllFromUser (APIBank)'
2022-09-21 17:37:00.552 +01:00 [DBG] 'PostgresContext' disposed.
2022-09-21 17:37:00.553 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/api/Accounts/GetAll - - - 200 - application/json;+charset=utf-8 84.4811ms
2022-09-21 17:37:21.126 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/api/Accounts/GetAll - -
2022-09-21 17:37:21.137 +01:00 [DBG] 1 candidate(s) found for the request path '/api/Accounts/GetAll'
2022-09-21 17:37:21.141 +01:00 [DBG] Endpoint 'APIBank.Controllers.AccountsController.GetAllFromUser (APIBank)' with route pattern 'api/Accounts/GetAll' is valid for the request path '/api/Accounts/GetAll'
2022-09-21 17:37:21.143 +01:00 [DBG] Request matched endpoint 'APIBank.Controllers.AccountsController.GetAllFromUser (APIBank)'
2022-09-21 17:37:21.144 +01:00 [DBG] Static files was skipped as the request already matched an endpoint.
2022-09-21 17:37:21.149 +01:00 [INF] Entity Framework Core 6.0.9 initialized 'PostgresContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:6.0.7+5b98e4b74de93b590b44aef8dd7967c03acc433c' with options: None
2022-09-21 17:37:21.153 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-21 17:37:21.156 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (2ms).
2022-09-21 17:37:21.157 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-21 17:37:21.158 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 17:37:21.159 +01:00 [DBG] Executing DbCommand [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.id = @__p_0
LIMIT 1
2022-09-21 17:37:21.161 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.id = @__p_0
LIMIT 1
2022-09-21 17:37:21.165 +01:00 [DBG] Context 'PostgresContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 17:37:21.165 +01:00 [DBG] A data reader was disposed.
2022-09-21 17:37:21.166 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 17:37:21.167 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-21 17:37:21.167 +01:00 [INF] Executing endpoint 'APIBank.Controllers.AccountsController.GetAllFromUser (APIBank)'
2022-09-21 17:37:21.168 +01:00 [INF] Route matched with {action = "GetAllFromUser", controller = "Accounts"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult GetAllFromUser() on controller APIBank.Controllers.AccountsController (APIBank).
2022-09-21 17:37:21.172 +01:00 [DBG] Execution plan of authorization filters (in the following order): ["APIBank.Authorization.AuthorizeAttribute"]
2022-09-21 17:37:21.173 +01:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2022-09-21 17:37:21.174 +01:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2022-09-21 17:37:21.176 +01:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2022-09-21 17:37:21.176 +01:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2022-09-21 17:37:21.177 +01:00 [DBG] Executing controller factory for controller APIBank.Controllers.AccountsController (APIBank)
2022-09-21 17:37:21.181 +01:00 [DBG] Executed controller factory for controller APIBank.Controllers.AccountsController (APIBank)
2022-09-21 17:37:21.182 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-21 17:37:21.183 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2022-09-21 17:37:21.184 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-21 17:37:21.185 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 17:37:21.186 +01:00 [DBG] Executing DbCommand [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a.balance AS "Balance", a.created_at AS "CreatedAt", a.currency AS "Currency", a.id AS "Id"
FROM accounts AS a
WHERE a.user_id = @__userId_0
2022-09-21 17:37:21.189 +01:00 [INF] Executed DbCommand (3ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a.balance AS "Balance", a.created_at AS "CreatedAt", a.currency AS "Currency", a.id AS "Id"
FROM accounts AS a
WHERE a.user_id = @__userId_0
2022-09-21 17:37:21.191 +01:00 [DBG] A data reader was disposed.
2022-09-21 17:37:21.192 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 17:37:21.192 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-21 17:37:21.193 +01:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2022-09-21 17:37:21.196 +01:00 [DBG] Attempting to select an output formatter based on Accept header '["text/plain"]'.
2022-09-21 17:37:21.196 +01:00 [DBG] Could not find an output formatter based on content negotiation. Accepted types were (["text/plain"])
2022-09-21 17:37:21.197 +01:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2022-09-21 17:37:21.198 +01:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2022-09-21 17:37:21.198 +01:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2022-09-21 17:37:21.199 +01:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[APIBank.Models.Accounts.AccountRe, APIBank, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2022-09-21 17:37:21.200 +01:00 [INF] Executed action APIBank.Controllers.AccountsController.GetAllFromUser (APIBank) in 22.7534ms
2022-09-21 17:37:21.201 +01:00 [INF] Executed endpoint 'APIBank.Controllers.AccountsController.GetAllFromUser (APIBank)'
2022-09-21 17:37:21.202 +01:00 [DBG] 'PostgresContext' disposed.
2022-09-21 17:37:21.205 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/api/Accounts/GetAll - - - 200 - application/json;+charset=utf-8 78.5064ms
2022-09-21 17:38:01.998 +01:00 [INF] Request starting HTTP/2 POST https://localhost:7036/api/Users/revoke-token application/json 19
2022-09-21 17:38:02.003 +01:00 [DBG] 1 candidate(s) found for the request path '/api/Users/revoke-token'
2022-09-21 17:38:02.019 +01:00 [DBG] Endpoint 'APIBank.Controllers.UsersController.RevokeToken (APIBank)' with route pattern 'api/Users/revoke-token' is valid for the request path '/api/Users/revoke-token'
2022-09-21 17:38:02.026 +01:00 [DBG] Request matched endpoint 'APIBank.Controllers.UsersController.RevokeToken (APIBank)'
2022-09-21 17:38:02.029 +01:00 [DBG] Static files was skipped as the request already matched an endpoint.
2022-09-21 17:38:02.031 +01:00 [INF] Executing endpoint 'APIBank.Controllers.UsersController.RevokeToken (APIBank)'
2022-09-21 17:38:02.040 +01:00 [INF] Route matched with {action = "RevokeToken", controller = "Users"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult RevokeToken(APIBank.Models.Users.Requests.RevokeTokenRequest) on controller APIBank.Controllers.UsersController (APIBank).
2022-09-21 17:38:02.043 +01:00 [DBG] Execution plan of authorization filters (in the following order): ["APIBank.Authorization.AuthorizeAttribute"]
2022-09-21 17:38:02.045 +01:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2022-09-21 17:38:02.047 +01:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2022-09-21 17:38:02.048 +01:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2022-09-21 17:38:02.050 +01:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2022-09-21 17:38:02.056 +01:00 [INF] Authorization failed for the request at filter 'APIBank.Authorization.AuthorizeAttribute'.
2022-09-21 17:38:02.057 +01:00 [INF] Executing JsonResult, writing value of type '<>f__AnonymousType0`1[[System.String, System.Private.CoreLib, Version=6.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2022-09-21 17:38:02.058 +01:00 [INF] Executed action APIBank.Controllers.UsersController.RevokeToken (APIBank) in 2.1521ms
2022-09-21 17:38:02.059 +01:00 [INF] Executed endpoint 'APIBank.Controllers.UsersController.RevokeToken (APIBank)'
2022-09-21 17:38:02.060 +01:00 [INF] Request finished HTTP/2 POST https://localhost:7036/api/Users/revoke-token application/json 19 - 401 - application/json;+charset=utf-8 62.7447ms
2022-09-21 17:38:02.061 +01:00 [DBG] Connection id "0HMKRTOKH9MAV", Request id "0HMKRTOKH9MAV:00000009": started reading request body.
2022-09-21 17:38:02.062 +01:00 [DBG] Connection id "0HMKRTOKH9MAV", Request id "0HMKRTOKH9MAV:00000009": done reading request body.
2022-09-21 17:38:11.920 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/api/Accounts/GetAll - -
2022-09-21 17:38:11.923 +01:00 [DBG] 1 candidate(s) found for the request path '/api/Accounts/GetAll'
2022-09-21 17:38:11.925 +01:00 [DBG] Endpoint 'APIBank.Controllers.AccountsController.GetAllFromUser (APIBank)' with route pattern 'api/Accounts/GetAll' is valid for the request path '/api/Accounts/GetAll'
2022-09-21 17:38:11.928 +01:00 [DBG] Request matched endpoint 'APIBank.Controllers.AccountsController.GetAllFromUser (APIBank)'
2022-09-21 17:38:11.930 +01:00 [DBG] Static files was skipped as the request already matched an endpoint.
2022-09-21 17:38:11.935 +01:00 [INF] Executing endpoint 'APIBank.Controllers.AccountsController.GetAllFromUser (APIBank)'
2022-09-21 17:38:11.937 +01:00 [INF] Route matched with {action = "GetAllFromUser", controller = "Accounts"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult GetAllFromUser() on controller APIBank.Controllers.AccountsController (APIBank).
2022-09-21 17:38:11.939 +01:00 [DBG] Execution plan of authorization filters (in the following order): ["APIBank.Authorization.AuthorizeAttribute"]
2022-09-21 17:38:11.940 +01:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2022-09-21 17:38:11.945 +01:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2022-09-21 17:38:11.947 +01:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2022-09-21 17:38:11.949 +01:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2022-09-21 17:38:11.951 +01:00 [INF] Authorization failed for the request at filter 'APIBank.Authorization.AuthorizeAttribute'.
2022-09-21 17:38:11.952 +01:00 [INF] Executing JsonResult, writing value of type '<>f__AnonymousType0`1[[System.String, System.Private.CoreLib, Version=6.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2022-09-21 17:38:11.953 +01:00 [INF] Executed action APIBank.Controllers.AccountsController.GetAllFromUser (APIBank) in 2.2734ms
2022-09-21 17:38:11.954 +01:00 [INF] Executed endpoint 'APIBank.Controllers.AccountsController.GetAllFromUser (APIBank)'
2022-09-21 17:38:11.956 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/api/Accounts/GetAll - - - 401 - application/json;+charset=utf-8 35.4923ms
2022-09-21 17:38:16.704 +01:00 [INF] Request starting HTTP/2 POST https://localhost:7036/api/Users/refreshToken - 0
2022-09-21 17:38:16.707 +01:00 [DBG] 1 candidate(s) found for the request path '/api/Users/refreshToken'
2022-09-21 17:38:16.708 +01:00 [DBG] Endpoint 'APIBank.Controllers.UsersController.RefreshToken (APIBank)' with route pattern 'api/Users/refreshToken' is valid for the request path '/api/Users/refreshToken'
2022-09-21 17:38:16.710 +01:00 [DBG] Request matched endpoint 'APIBank.Controllers.UsersController.RefreshToken (APIBank)'
2022-09-21 17:38:16.712 +01:00 [DBG] Static files was skipped as the request already matched an endpoint.
2022-09-21 17:38:16.713 +01:00 [INF] Executing endpoint 'APIBank.Controllers.UsersController.RefreshToken (APIBank)'
2022-09-21 17:38:16.717 +01:00 [INF] Route matched with {action = "RefreshToken", controller = "Users"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult RefreshToken() on controller APIBank.Controllers.UsersController (APIBank).
2022-09-21 17:38:16.721 +01:00 [DBG] Execution plan of authorization filters (in the following order): ["APIBank.Authorization.AuthorizeAttribute"]
2022-09-21 17:38:16.725 +01:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2022-09-21 17:38:16.727 +01:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2022-09-21 17:38:16.728 +01:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2022-09-21 17:38:16.729 +01:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2022-09-21 17:38:16.730 +01:00 [DBG] Executing controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-21 17:38:16.731 +01:00 [DBG] Executed controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-21 17:38:16.733 +01:00 [INF] Entity Framework Core 6.0.9 initialized 'PostgresContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:6.0.7+5b98e4b74de93b590b44aef8dd7967c03acc433c' with options: None
2022-09-21 17:38:16.738 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-21 17:38:16.740 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (2ms).
2022-09-21 17:38:16.742 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-21 17:38:16.743 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 17:38:16.745 +01:00 [DBG] Executing DbCommand [Parameters=[@__refToken_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE EXISTS (
    SELECT 1
    FROM refresh_token AS r
    WHERE (u.id = r.user_id) AND (r.token = @__refToken_0))
LIMIT 2
2022-09-21 17:38:16.747 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[@__refToken_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE EXISTS (
    SELECT 1
    FROM refresh_token AS r
    WHERE (u.id = r.user_id) AND (r.token = @__refToken_0))
LIMIT 2
2022-09-21 17:38:16.749 +01:00 [DBG] Context 'PostgresContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 17:38:16.750 +01:00 [DBG] A data reader was disposed.
2022-09-21 17:38:16.752 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 17:38:16.754 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-21 17:38:16.757 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-21 17:38:16.759 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (2ms).
2022-09-21 17:38:16.760 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-21 17:38:16.761 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 17:38:16.762 +01:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.user_id AS "UserId", r.token AS "RefToken", r.expires AS "Expires", r.created AS "Created", r.created_by_ip AS "CreatedByIp", r.revoked AS "Revoked", r.revoked_by_ip AS "RevokedByIp", r.replaced_by_token AS "ReplacedByToken", r.reason_revoked AS "ReasonRevoked", r.is_expired AS "IsExpired", r.is_revoked AS "IsRevoked", r.is_active AS "IsActive"
FROM refresh_token AS r
WHERE r.user_id = @__id_0
2022-09-21 17:38:16.764 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.user_id AS "UserId", r.token AS "RefToken", r.expires AS "Expires", r.created AS "Created", r.created_by_ip AS "CreatedByIp", r.revoked AS "Revoked", r.revoked_by_ip AS "RevokedByIp", r.replaced_by_token AS "ReplacedByToken", r.reason_revoked AS "ReasonRevoked", r.is_expired AS "IsExpired", r.is_revoked AS "IsRevoked", r.is_active AS "IsActive"
FROM refresh_token AS r
WHERE r.user_id = @__id_0
2022-09-21 17:38:16.768 +01:00 [DBG] A data reader was disposed.
2022-09-21 17:38:16.769 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 17:38:16.770 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-21 17:38:16.773 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-21 17:38:16.774 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2022-09-21 17:38:16.775 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-21 17:38:16.776 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 17:38:16.777 +01:00 [DBG] Executing DbCommand [Parameters=[@__token_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM users AS u
    WHERE EXISTS (
        SELECT 1
        FROM refresh_token AS r
        WHERE (u.id = r.user_id) AND (r.token = @__token_0)))
2022-09-21 17:38:16.779 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[@__token_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM users AS u
    WHERE EXISTS (
        SELECT 1
        FROM refresh_token AS r
        WHERE (u.id = r.user_id) AND (r.token = @__token_0)))
2022-09-21 17:38:16.780 +01:00 [DBG] A data reader was disposed.
2022-09-21 17:38:16.782 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 17:38:16.783 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-21 17:38:16.784 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-21 17:38:16.784 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2022-09-21 17:38:16.785 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-21 17:38:16.786 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 17:38:16.788 +01:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.user_id AS "UserId", r.token AS "RefToken", r.expires AS "Expires", r.created AS "Created", r.created_by_ip AS "CreatedByIp", r.revoked AS "Revoked", r.revoked_by_ip AS "RevokedByIp", r.replaced_by_token AS "ReplacedByToken", r.reason_revoked AS "ReasonRevoked", r.is_expired AS "IsExpired", r.is_revoked AS "IsRevoked", r.is_active AS "IsActive"
FROM refresh_token AS r
WHERE r.user_id = @__id_0
2022-09-21 17:38:16.792 +01:00 [INF] Executed DbCommand (4ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.user_id AS "UserId", r.token AS "RefToken", r.expires AS "Expires", r.created AS "Created", r.created_by_ip AS "CreatedByIp", r.revoked AS "Revoked", r.revoked_by_ip AS "RevokedByIp", r.replaced_by_token AS "ReplacedByToken", r.reason_revoked AS "ReasonRevoked", r.is_expired AS "IsExpired", r.is_revoked AS "IsRevoked", r.is_active AS "IsActive"
FROM refresh_token AS r
WHERE r.user_id = @__id_0
2022-09-21 17:38:16.793 +01:00 [DBG] A data reader was disposed.
2022-09-21 17:38:16.794 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 17:38:16.795 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-21 17:38:16.796 +01:00 [DBG] An entity of type 'User' tracked by 'PostgresContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 17:38:16.798 +01:00 [DBG] SaveChanges starting for 'PostgresContext'.
2022-09-21 17:38:16.799 +01:00 [DBG] DetectChanges starting for 'PostgresContext'.
2022-09-21 17:38:16.800 +01:00 [DBG] 1 entities were added and 0 entities were removed from navigation 'User.RefreshTokenCollection'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 17:38:16.801 +01:00 [DBG] 'PostgresContext' generated a temporary value for the property 'Id.RefreshToken'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 17:38:16.802 +01:00 [DBG] Context 'PostgresContext' started tracking 'RefreshToken' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 17:38:16.804 +01:00 [DBG] DetectChanges completed for 'PostgresContext'.
2022-09-21 17:38:16.804 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-21 17:38:16.806 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 17:38:16.807 +01:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2022-09-21 17:38:16.808 +01:00 [DBG] Began transaction with isolation level 'ReadCommitted'.
2022-09-21 17:38:16.811 +01:00 [DBG] Executing 2 update commands as a batch.
2022-09-21 17:38:16.812 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-21 17:38:16.813 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2022-09-21 17:38:16.814 +01:00 [DBG] Executing DbCommand [Parameters=[@p0='?' (DbType = DateTime), @p1='?', @p2='?' (DbType = DateTime), @p3='?' (DbType = Boolean), @p4='?' (DbType = Boolean), @p5='?' (DbType = Boolean), @p6='?', @p7='?', @p8='?', @p9='?' (DbType = DateTime), @p10='?', @p11='?' (DbType = Int32), @p18='?' (DbType = Int32), @p12='?' (DbType = DateTime), @p13='?', @p14='?', @p15='?' (DbType = DateTime), @p16='?', @p17='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO refresh_token (created, created_by_ip, expires, is_active, is_expired, is_revoked, reason_revoked, token, replaced_by_token, revoked, revoked_by_ip, user_id)
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11)
RETURNING id;
UPDATE users SET created_at = @p12, email = @p13, full_name = @p14, password_changed_at = @p15, password_hash = @p16, username = @p17
WHERE id = @p18;
2022-09-21 17:38:16.817 +01:00 [INF] Executed DbCommand (3ms) [Parameters=[@p0='?' (DbType = DateTime), @p1='?', @p2='?' (DbType = DateTime), @p3='?' (DbType = Boolean), @p4='?' (DbType = Boolean), @p5='?' (DbType = Boolean), @p6='?', @p7='?', @p8='?', @p9='?' (DbType = DateTime), @p10='?', @p11='?' (DbType = Int32), @p18='?' (DbType = Int32), @p12='?' (DbType = DateTime), @p13='?', @p14='?', @p15='?' (DbType = DateTime), @p16='?', @p17='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO refresh_token (created, created_by_ip, expires, is_active, is_expired, is_revoked, reason_revoked, token, replaced_by_token, revoked, revoked_by_ip, user_id)
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11)
RETURNING id;
UPDATE users SET created_at = @p12, email = @p13, full_name = @p14, password_changed_at = @p15, password_hash = @p16, username = @p17
WHERE id = @p18;
2022-09-21 17:38:16.819 +01:00 [DBG] The foreign key property 'RefreshToken.Id' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2022-09-21 17:38:16.820 +01:00 [DBG] A data reader was disposed.
2022-09-21 17:38:16.821 +01:00 [DBG] Committing transaction.
2022-09-21 17:38:16.824 +01:00 [DBG] Committed transaction.
2022-09-21 17:38:16.827 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 17:38:16.830 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-21 17:38:16.831 +01:00 [DBG] Disposing transaction.
2022-09-21 17:38:16.831 +01:00 [DBG] An entity of type 'RefreshToken' tracked by 'PostgresContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 17:38:16.833 +01:00 [DBG] An entity of type 'User' tracked by 'PostgresContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 17:38:16.834 +01:00 [DBG] SaveChanges completed for 'PostgresContext' with 2 entities written to the database.
2022-09-21 17:38:16.835 +01:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2022-09-21 17:38:16.837 +01:00 [DBG] Attempting to select an output formatter based on Accept header '["text/plain"]'.
2022-09-21 17:38:16.838 +01:00 [DBG] Could not find an output formatter based on content negotiation. Accepted types were (["text/plain"])
2022-09-21 17:38:16.840 +01:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2022-09-21 17:38:16.841 +01:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2022-09-21 17:38:16.842 +01:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2022-09-21 17:38:16.845 +01:00 [INF] Executing OkObjectResult, writing value of type 'APIBank.Models.Users.Responses.LoginResponse'.
2022-09-21 17:38:16.847 +01:00 [INF] Executed action APIBank.Controllers.UsersController.RefreshToken (APIBank) in 116.6582ms
2022-09-21 17:38:16.848 +01:00 [INF] Executed endpoint 'APIBank.Controllers.UsersController.RefreshToken (APIBank)'
2022-09-21 17:38:16.849 +01:00 [DBG] 'PostgresContext' disposed.
2022-09-21 17:38:16.850 +01:00 [INF] Request finished HTTP/2 POST https://localhost:7036/api/Users/refreshToken - 0 - 200 - application/json;+charset=utf-8 145.3713ms
2022-09-21 17:38:34.239 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/api/Accounts/GetAll - -
2022-09-21 17:38:34.241 +01:00 [DBG] 1 candidate(s) found for the request path '/api/Accounts/GetAll'
2022-09-21 17:38:34.243 +01:00 [DBG] Endpoint 'APIBank.Controllers.AccountsController.GetAllFromUser (APIBank)' with route pattern 'api/Accounts/GetAll' is valid for the request path '/api/Accounts/GetAll'
2022-09-21 17:38:34.256 +01:00 [DBG] Request matched endpoint 'APIBank.Controllers.AccountsController.GetAllFromUser (APIBank)'
2022-09-21 17:38:34.258 +01:00 [DBG] Static files was skipped as the request already matched an endpoint.
2022-09-21 17:38:34.266 +01:00 [INF] Entity Framework Core 6.0.9 initialized 'PostgresContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:6.0.7+5b98e4b74de93b590b44aef8dd7967c03acc433c' with options: None
2022-09-21 17:38:34.268 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-21 17:38:34.270 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2022-09-21 17:38:34.272 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-21 17:38:34.273 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 17:38:34.277 +01:00 [DBG] Executing DbCommand [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.id = @__p_0
LIMIT 1
2022-09-21 17:38:34.282 +01:00 [INF] Executed DbCommand (4ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.id = @__p_0
LIMIT 1
2022-09-21 17:38:34.283 +01:00 [DBG] Context 'PostgresContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 17:38:34.284 +01:00 [DBG] A data reader was disposed.
2022-09-21 17:38:34.285 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 17:38:34.286 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-21 17:38:34.287 +01:00 [INF] Executing endpoint 'APIBank.Controllers.AccountsController.GetAllFromUser (APIBank)'
2022-09-21 17:38:34.288 +01:00 [INF] Route matched with {action = "GetAllFromUser", controller = "Accounts"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult GetAllFromUser() on controller APIBank.Controllers.AccountsController (APIBank).
2022-09-21 17:38:34.292 +01:00 [DBG] Execution plan of authorization filters (in the following order): ["APIBank.Authorization.AuthorizeAttribute"]
2022-09-21 17:38:34.294 +01:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2022-09-21 17:38:34.295 +01:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2022-09-21 17:38:34.296 +01:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2022-09-21 17:38:34.297 +01:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2022-09-21 17:38:34.298 +01:00 [DBG] Executing controller factory for controller APIBank.Controllers.AccountsController (APIBank)
2022-09-21 17:38:34.299 +01:00 [DBG] Executed controller factory for controller APIBank.Controllers.AccountsController (APIBank)
2022-09-21 17:38:34.300 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-21 17:38:34.301 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2022-09-21 17:38:34.301 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-21 17:38:34.303 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 17:38:34.303 +01:00 [DBG] Executing DbCommand [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a.balance AS "Balance", a.created_at AS "CreatedAt", a.currency AS "Currency", a.id AS "Id"
FROM accounts AS a
WHERE a.user_id = @__userId_0
2022-09-21 17:38:34.306 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a.balance AS "Balance", a.created_at AS "CreatedAt", a.currency AS "Currency", a.id AS "Id"
FROM accounts AS a
WHERE a.user_id = @__userId_0
2022-09-21 17:38:34.308 +01:00 [DBG] A data reader was disposed.
2022-09-21 17:38:34.309 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 17:38:34.311 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-21 17:38:34.311 +01:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2022-09-21 17:38:34.313 +01:00 [DBG] Attempting to select an output formatter based on Accept header '["text/plain"]'.
2022-09-21 17:38:34.314 +01:00 [DBG] Could not find an output formatter based on content negotiation. Accepted types were (["text/plain"])
2022-09-21 17:38:34.315 +01:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2022-09-21 17:38:34.316 +01:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2022-09-21 17:38:34.316 +01:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2022-09-21 17:38:34.317 +01:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[APIBank.Models.Accounts.AccountRe, APIBank, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2022-09-21 17:38:34.319 +01:00 [INF] Executed action APIBank.Controllers.AccountsController.GetAllFromUser (APIBank) in 20.6267ms
2022-09-21 17:38:34.320 +01:00 [INF] Executed endpoint 'APIBank.Controllers.AccountsController.GetAllFromUser (APIBank)'
2022-09-21 17:38:34.320 +01:00 [DBG] 'PostgresContext' disposed.
2022-09-21 17:38:34.323 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/api/Accounts/GetAll - - - 200 - application/json;+charset=utf-8 84.5030ms
2022-09-21 17:38:41.187 +01:00 [INF] Request starting HTTP/2 POST https://localhost:7036/api/Users/revoke-token application/json 19
2022-09-21 17:38:41.190 +01:00 [DBG] 1 candidate(s) found for the request path '/api/Users/revoke-token'
2022-09-21 17:38:41.192 +01:00 [DBG] Endpoint 'APIBank.Controllers.UsersController.RevokeToken (APIBank)' with route pattern 'api/Users/revoke-token' is valid for the request path '/api/Users/revoke-token'
2022-09-21 17:38:41.193 +01:00 [DBG] Request matched endpoint 'APIBank.Controllers.UsersController.RevokeToken (APIBank)'
2022-09-21 17:38:41.194 +01:00 [DBG] Static files was skipped as the request already matched an endpoint.
2022-09-21 17:38:41.203 +01:00 [INF] Entity Framework Core 6.0.9 initialized 'PostgresContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:6.0.7+5b98e4b74de93b590b44aef8dd7967c03acc433c' with options: None
2022-09-21 17:38:41.207 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-21 17:38:41.208 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2022-09-21 17:38:41.209 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-21 17:38:41.209 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 17:38:41.210 +01:00 [DBG] Executing DbCommand [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.id = @__p_0
LIMIT 1
2022-09-21 17:38:41.212 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.id = @__p_0
LIMIT 1
2022-09-21 17:38:41.213 +01:00 [DBG] Context 'PostgresContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 17:38:41.214 +01:00 [DBG] A data reader was disposed.
2022-09-21 17:38:41.215 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 17:38:41.219 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-21 17:38:41.221 +01:00 [INF] Executing endpoint 'APIBank.Controllers.UsersController.RevokeToken (APIBank)'
2022-09-21 17:38:41.224 +01:00 [INF] Route matched with {action = "RevokeToken", controller = "Users"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult RevokeToken(APIBank.Models.Users.Requests.RevokeTokenRequest) on controller APIBank.Controllers.UsersController (APIBank).
2022-09-21 17:38:41.225 +01:00 [DBG] Execution plan of authorization filters (in the following order): ["APIBank.Authorization.AuthorizeAttribute"]
2022-09-21 17:38:41.226 +01:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2022-09-21 17:38:41.227 +01:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2022-09-21 17:38:41.228 +01:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2022-09-21 17:38:41.229 +01:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2022-09-21 17:38:41.230 +01:00 [DBG] Executing controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-21 17:38:41.231 +01:00 [DBG] Executed controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-21 17:38:41.236 +01:00 [DBG] Attempting to bind parameter 'model' of type 'APIBank.Models.Users.Requests.RevokeTokenRequest' ...
2022-09-21 17:38:41.237 +01:00 [DBG] Attempting to bind parameter 'model' of type 'APIBank.Models.Users.Requests.RevokeTokenRequest' using the name '' in request data ...
2022-09-21 17:38:41.239 +01:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2022-09-21 17:38:41.240 +01:00 [DBG] Connection id "0HMKRTOKH9MAV", Request id "0HMKRTOKH9MAV:00000011": started reading request body.
2022-09-21 17:38:41.242 +01:00 [DBG] Connection id "0HMKRTOKH9MAV", Request id "0HMKRTOKH9MAV:00000011": done reading request body.
2022-09-21 17:38:41.243 +01:00 [DBG] JSON input formatter succeeded, deserializing to type 'APIBank.Models.Users.Requests.RevokeTokenRequest'
2022-09-21 17:38:41.244 +01:00 [DBG] Done attempting to bind parameter 'model' of type 'APIBank.Models.Users.Requests.RevokeTokenRequest'.
2022-09-21 17:38:41.245 +01:00 [DBG] Done attempting to bind parameter 'model' of type 'APIBank.Models.Users.Requests.RevokeTokenRequest'.
2022-09-21 17:38:41.246 +01:00 [DBG] Attempting to validate the bound parameter 'model' of type 'APIBank.Models.Users.Requests.RevokeTokenRequest' ...
2022-09-21 17:38:41.252 +01:00 [DBG] Done attempting to validate the bound parameter 'model' of type 'APIBank.Models.Users.Requests.RevokeTokenRequest'.
2022-09-21 17:38:41.255 +01:00 [DBG] The request has model state errors, returning an error response.
2022-09-21 17:38:41.256 +01:00 [DBG] Request was short circuited at action filter 'Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter'.
2022-09-21 17:38:41.257 +01:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2022-09-21 17:38:41.259 +01:00 [DBG] No information found on request to perform content negotiation.
2022-09-21 17:38:41.260 +01:00 [DBG] Attempting to select the first output formatter in the output formatters list which supports a content type from the explicitly specified content types '["application/problem+json","application/problem+xml","application/problem+json","application/problem+xml"]'.
2022-09-21 17:38:41.261 +01:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/problem+json' to write the response.
2022-09-21 17:38:41.262 +01:00 [INF] Executing BadRequestObjectResult, writing value of type 'Microsoft.AspNetCore.Mvc.ValidationProblemDetails'.
2022-09-21 17:38:41.268 +01:00 [INF] Executed action APIBank.Controllers.UsersController.RevokeToken (APIBank) in 37.5681ms
2022-09-21 17:38:41.270 +01:00 [INF] Executed endpoint 'APIBank.Controllers.UsersController.RevokeToken (APIBank)'
2022-09-21 17:38:41.271 +01:00 [DBG] 'PostgresContext' disposed.
2022-09-21 17:38:41.272 +01:00 [INF] Request finished HTTP/2 POST https://localhost:7036/api/Users/revoke-token application/json 19 - 400 - application/problem+json;+charset=utf-8 84.3466ms
2022-09-21 17:40:10.014 +01:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2022-09-21 17:40:10.093 +01:00 [DBG] Hosting starting
2022-09-21 17:40:10.170 +01:00 [DBG] Using development certificate: CN=localhost (Thumbprint: 9CC642E9838495A6C3C202DECA6A8AD300396DD2)
2022-09-21 17:40:10.208 +01:00 [INF] Now listening on: https://localhost:7036
2022-09-21 17:40:10.210 +01:00 [INF] Now listening on: http://localhost:5036
2022-09-21 17:40:10.212 +01:00 [DBG] Loaded hosting startup assembly APIBank
2022-09-21 17:40:10.213 +01:00 [DBG] Loaded hosting startup assembly Microsoft.AspNetCore.Watch.BrowserRefresh
2022-09-21 17:40:10.214 +01:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.BrowserLink.Net
2022-09-21 17:40:10.214 +01:00 [INF] Application started. Press Ctrl+C to shut down.
2022-09-21 17:40:10.215 +01:00 [INF] Hosting environment: Development
2022-09-21 17:40:10.215 +01:00 [INF] Content root path: C:\Users\mguedesa\OneDrive - NTT DATA EMEAL\Documentos\GitHub\OpenBankAPI-NTT\APIBank\APIBank\
2022-09-21 17:40:10.216 +01:00 [DBG] Hosting started
2022-09-21 17:40:10.661 +01:00 [DBG] Connection id "0HMKRTVPJMNFO" accepted.
2022-09-21 17:40:10.661 +01:00 [DBG] Connection id "0HMKRTVPJMNFP" accepted.
2022-09-21 17:40:10.663 +01:00 [DBG] Connection id "0HMKRTVPJMNFO" started.
2022-09-21 17:40:10.663 +01:00 [DBG] Connection id "0HMKRTVPJMNFP" started.
2022-09-21 17:40:10.671 +01:00 [DBG] Connection id "0HMKRTVPJMNFO" received FIN.
2022-09-21 17:40:10.671 +01:00 [DBG] Connection id "0HMKRTVPJMNFP" received FIN.
2022-09-21 17:40:10.680 +01:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException:  Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveBlobAsync[TIOAdapter](TIOAdapter adapter)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](TIOAdapter adapter, Boolean receiveFirst, Byte[] reAuthenticationData, Boolean isApm)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2022-09-21 17:40:10.680 +01:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException:  Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveBlobAsync[TIOAdapter](TIOAdapter adapter)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](TIOAdapter adapter, Boolean receiveFirst, Byte[] reAuthenticationData, Boolean isApm)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2022-09-21 17:40:10.703 +01:00 [DBG] Connection id "0HMKRTVPJMNFP" stopped.
2022-09-21 17:40:10.703 +01:00 [DBG] Connection id "0HMKRTVPJMNFO" stopped.
2022-09-21 17:40:10.706 +01:00 [DBG] Connection id "0HMKRTVPJMNFP" sending FIN because: "The Socket transport's send loop completed gracefully."
2022-09-21 17:40:10.706 +01:00 [DBG] Connection id "0HMKRTVPJMNFO" sending FIN because: "The Socket transport's send loop completed gracefully."
2022-09-21 17:40:10.837 +01:00 [DBG] Connection id "0HMKRTVPJMNFQ" accepted.
2022-09-21 17:40:10.840 +01:00 [DBG] Connection id "0HMKRTVPJMNFQ" started.
2022-09-21 17:40:10.877 +01:00 [DBG] Connection 0HMKRTVPJMNFQ established using the following protocol: "Tls12"
2022-09-21 17:40:10.919 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/swagger/index.html - -
2022-09-21 17:40:10.939 +01:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2022-09-21 17:40:10.963 +01:00 [DBG] No candidates found for the request path '/swagger/index.html'
2022-09-21 17:40:10.965 +01:00 [DBG] Request did not match any endpoints
2022-09-21 17:40:11.071 +01:00 [DBG] Response markup is scheduled to include browser refresh script injection.
2022-09-21 17:40:11.200 +01:00 [DBG] Response markup was updated to include browser refresh script injection.
2022-09-21 17:40:11.208 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/swagger/index.html - - - 200 - text/html;charset=utf-8 291.3984ms
2022-09-21 17:40:11.244 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/_vs/browserLink - -
2022-09-21 17:40:11.244 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/_framework/aspnetcore-browser-refresh.js - -
2022-09-21 17:40:11.254 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/_framework/aspnetcore-browser-refresh.js - - - 200 11984 application/javascript;+charset=utf-8 10.0085ms
2022-09-21 17:40:11.278 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/_vs/browserLink - - - 200 - text/javascript;+charset=UTF-8 34.3521ms
2022-09-21 17:40:11.464 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/swagger/v1/swagger.json - -
2022-09-21 17:40:11.466 +01:00 [DBG] No candidates found for the request path '/swagger/v1/swagger.json'
2022-09-21 17:40:11.467 +01:00 [DBG] Request did not match any endpoints
2022-09-21 17:40:11.609 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/swagger/v1/swagger.json - - - 200 - application/json;charset=utf-8 144.7199ms
2022-09-21 17:40:17.963 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/api/Accounts/GetAll - -
2022-09-21 17:40:17.972 +01:00 [DBG] 1 candidate(s) found for the request path '/api/Accounts/GetAll'
2022-09-21 17:40:17.979 +01:00 [DBG] Endpoint 'APIBank.Controllers.AccountsController.GetAllFromUser (APIBank)' with route pattern 'api/Accounts/GetAll' is valid for the request path '/api/Accounts/GetAll'
2022-09-21 17:40:17.985 +01:00 [DBG] Request matched endpoint 'APIBank.Controllers.AccountsController.GetAllFromUser (APIBank)'
2022-09-21 17:40:17.991 +01:00 [DBG] Static files was skipped as the request already matched an endpoint.
2022-09-21 17:40:18.308 +01:00 [INF] Executing endpoint 'APIBank.Controllers.AccountsController.GetAllFromUser (APIBank)'
2022-09-21 17:40:18.323 +01:00 [INF] Route matched with {action = "GetAllFromUser", controller = "Accounts"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult GetAllFromUser() on controller APIBank.Controllers.AccountsController (APIBank).
2022-09-21 17:40:18.326 +01:00 [DBG] Execution plan of authorization filters (in the following order): ["APIBank.Authorization.AuthorizeAttribute"]
2022-09-21 17:40:18.327 +01:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2022-09-21 17:40:18.328 +01:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2022-09-21 17:40:18.329 +01:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2022-09-21 17:40:18.332 +01:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2022-09-21 17:40:18.335 +01:00 [INF] Authorization failed for the request at filter 'APIBank.Authorization.AuthorizeAttribute'.
2022-09-21 17:40:18.337 +01:00 [INF] Executing JsonResult, writing value of type '<>f__AnonymousType0`1[[System.String, System.Private.CoreLib, Version=6.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2022-09-21 17:40:18.344 +01:00 [INF] Executed action APIBank.Controllers.AccountsController.GetAllFromUser (APIBank) in 6.5088ms
2022-09-21 17:40:18.345 +01:00 [INF] Executed endpoint 'APIBank.Controllers.AccountsController.GetAllFromUser (APIBank)'
2022-09-21 17:40:18.348 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/api/Accounts/GetAll - - - 401 - application/json;+charset=utf-8 385.9995ms
2022-09-21 17:40:31.461 +01:00 [INF] Request starting HTTP/2 POST https://localhost:7036/api/Users/Login application/json 58
2022-09-21 17:40:31.466 +01:00 [DBG] 1 candidate(s) found for the request path '/api/Users/Login'
2022-09-21 17:40:31.468 +01:00 [DBG] Endpoint 'APIBank.Controllers.UsersController.Login (APIBank)' with route pattern 'api/Users/Login' is valid for the request path '/api/Users/Login'
2022-09-21 17:40:31.471 +01:00 [DBG] Request matched endpoint 'APIBank.Controllers.UsersController.Login (APIBank)'
2022-09-21 17:40:31.474 +01:00 [DBG] Static files was skipped as the request already matched an endpoint.
2022-09-21 17:40:31.480 +01:00 [INF] Executing endpoint 'APIBank.Controllers.UsersController.Login (APIBank)'
2022-09-21 17:40:31.494 +01:00 [INF] Route matched with {action = "Login", controller = "Users"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult Login(APIBank.Models.Requests.LoginRequest) on controller APIBank.Controllers.UsersController (APIBank).
2022-09-21 17:40:31.495 +01:00 [DBG] Execution plan of authorization filters (in the following order): ["APIBank.Authorization.AuthorizeAttribute"]
2022-09-21 17:40:31.496 +01:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2022-09-21 17:40:31.497 +01:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2022-09-21 17:40:31.498 +01:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2022-09-21 17:40:31.499 +01:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2022-09-21 17:40:31.500 +01:00 [DBG] Executing controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-21 17:40:31.502 +01:00 [DBG] Executed controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-21 17:40:31.509 +01:00 [DBG] Attempting to bind parameter 'model' of type 'APIBank.Models.Requests.LoginRequest' ...
2022-09-21 17:40:31.511 +01:00 [DBG] Attempting to bind parameter 'model' of type 'APIBank.Models.Requests.LoginRequest' using the name '' in request data ...
2022-09-21 17:40:31.513 +01:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2022-09-21 17:40:31.515 +01:00 [DBG] Connection id "0HMKRTVPJMNFQ", Request id "0HMKRTVPJMNFQ:0000000B": started reading request body.
2022-09-21 17:40:31.516 +01:00 [DBG] Connection id "0HMKRTVPJMNFQ", Request id "0HMKRTVPJMNFQ:0000000B": done reading request body.
2022-09-21 17:40:31.522 +01:00 [DBG] JSON input formatter succeeded, deserializing to type 'APIBank.Models.Requests.LoginRequest'
2022-09-21 17:40:31.524 +01:00 [DBG] Done attempting to bind parameter 'model' of type 'APIBank.Models.Requests.LoginRequest'.
2022-09-21 17:40:31.525 +01:00 [DBG] Done attempting to bind parameter 'model' of type 'APIBank.Models.Requests.LoginRequest'.
2022-09-21 17:40:31.526 +01:00 [DBG] Attempting to validate the bound parameter 'model' of type 'APIBank.Models.Requests.LoginRequest' ...
2022-09-21 17:40:31.532 +01:00 [DBG] Done attempting to validate the bound parameter 'model' of type 'APIBank.Models.Requests.LoginRequest'.
2022-09-21 17:40:31.590 +01:00 [DBG] An additional 'IServiceProvider' was created for internal use by Entity Framework. An existing service provider was not used due to the following configuration changes: configuration changed for 'Core:ConfigureWarnings', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:UseAdminDatabase', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:SetPostgresVersion', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:UseRedshift', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:ReverseNullOrdering', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:RemoteCertificateValidationCallback', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:ProvideClientCertificatesCallback', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:ProvidePasswordCallback'.
2022-09-21 17:40:32.676 +01:00 [INF] Entity Framework Core 6.0.9 initialized 'PostgresContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:6.0.7+5b98e4b74de93b590b44aef8dd7967c03acc433c' with options: None
2022-09-21 17:40:32.729 +01:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .SingleOrDefault(x => x.Username == __model_Username_0)'
2022-09-21 17:40:32.970 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<User>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: User.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: User.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 1], [Property: User.Email (string) Required Index MaxLength(254), 2], [Property: User.FullName (string) Required MaxLength(100), 3], [Property: User.PasswordChangedAt (DateTime) Required ValueGenerated.OnAdd, 4], [Property: User.PasswordHash (string) Required MaxLength(200), 5], [Property: User.Username (string) Required Index MaxLength(50), 6] }
        SELECT TOP(2) u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
        FROM users AS u
        WHERE u.username == @__model_Username_0), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, User>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)
    .SingleOrDefault()'
2022-09-21 17:40:33.007 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-21 17:40:33.058 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (44ms).
2022-09-21 17:40:33.067 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-21 17:40:33.303 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 17:40:33.317 +01:00 [DBG] Executing DbCommand [Parameters=[@__model_Username_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.username = @__model_Username_0
LIMIT 2
2022-09-21 17:40:33.414 +01:00 [INF] Executed DbCommand (102ms) [Parameters=[@__model_Username_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.username = @__model_Username_0
LIMIT 2
2022-09-21 17:40:33.456 +01:00 [DBG] Context 'PostgresContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 17:40:33.501 +01:00 [DBG] A data reader was disposed.
2022-09-21 17:40:33.506 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 17:40:33.510 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-21 17:40:33.844 +01:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .Any(user => user.RefreshTokenCollection
        .Any(reftoken => reftoken.RefToken == __token_0))'
2022-09-21 17:40:33.925 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<bool>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            EmptyProjectionMember -> 0
        SELECT EXISTS (
            SELECT 1
            FROM users AS u
            WHERE EXISTS (
                SELECT 1
                FROM refresh_token AS r
                WHERE ((u.id != NULL) && (u.id == r.user_id)) && (r.token == @__token_0)))), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, bool>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)
    .Single()'
2022-09-21 17:40:33.935 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-21 17:40:33.938 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (2ms).
2022-09-21 17:40:33.939 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-21 17:40:33.939 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 17:40:33.940 +01:00 [DBG] Executing DbCommand [Parameters=[@__token_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM users AS u
    WHERE EXISTS (
        SELECT 1
        FROM refresh_token AS r
        WHERE (u.id = r.user_id) AND (r.token = @__token_0)))
2022-09-21 17:40:33.943 +01:00 [INF] Executed DbCommand (3ms) [Parameters=[@__token_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM users AS u
    WHERE EXISTS (
        SELECT 1
        FROM refresh_token AS r
        WHERE (u.id = r.user_id) AND (r.token = @__token_0)))
2022-09-21 17:40:33.946 +01:00 [DBG] A data reader was disposed.
2022-09-21 17:40:33.946 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 17:40:33.947 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-21 17:40:33.958 +01:00 [DBG] Compiling query expression: 
'DbSet<RefreshToken>()
    .Where(rt => rt.UserId == __id_0)
    .AsNoTracking()
    .Select(rt => new RefreshToken{ 
        Id = rt.Id, 
        UserId = rt.UserId, 
        RefToken = rt.RefToken, 
        Expires = rt.Expires, 
        Created = rt.Created, 
        CreatedByIp = rt.CreatedByIp, 
        Revoked = rt.Revoked, 
        RevokedByIp = rt.RevokedByIp, 
        ReplacedByToken = rt.ReplacedByToken, 
        ReasonRevoked = rt.ReasonRevoked, 
        IsExpired = rt.IsExpired, 
        IsRevoked = rt.IsRevoked, 
        IsActive = rt.IsActive 
    }
    )'
2022-09-21 17:40:33.978 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<RefreshToken>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            Id -> 0
            UserId -> 1
            RefToken -> 2
            Expires -> 3
            Created -> 4
            CreatedByIp -> 5
            Revoked -> 6
            RevokedByIp -> 7
            ReplacedByToken -> 8
            ReasonRevoked -> 9
            IsExpired -> 10
            IsRevoked -> 11
            IsActive -> 12
        SELECT r.id AS Id, r.user_id AS UserId, r.token AS RefToken, r.expires AS Expires, r.created AS Created, r.created_by_ip AS CreatedByIp, r.revoked AS Revoked, r.revoked_by_ip AS RevokedByIp, r.replaced_by_token AS ReplacedByToken, r.reason_revoked AS ReasonRevoked, r.is_expired AS IsExpired, r.is_revoked AS IsRevoked, r.is_active AS IsActive
        FROM refresh_token AS r
        WHERE r.user_id == @__id_0), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, RefreshToken>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)'
2022-09-21 17:40:33.984 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-21 17:40:33.985 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2022-09-21 17:40:33.986 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-21 17:40:33.987 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 17:40:33.988 +01:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.user_id AS "UserId", r.token AS "RefToken", r.expires AS "Expires", r.created AS "Created", r.created_by_ip AS "CreatedByIp", r.revoked AS "Revoked", r.revoked_by_ip AS "RevokedByIp", r.replaced_by_token AS "ReplacedByToken", r.reason_revoked AS "ReasonRevoked", r.is_expired AS "IsExpired", r.is_revoked AS "IsRevoked", r.is_active AS "IsActive"
FROM refresh_token AS r
WHERE r.user_id = @__id_0
2022-09-21 17:40:33.991 +01:00 [INF] Executed DbCommand (3ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.user_id AS "UserId", r.token AS "RefToken", r.expires AS "Expires", r.created AS "Created", r.created_by_ip AS "CreatedByIp", r.revoked AS "Revoked", r.revoked_by_ip AS "RevokedByIp", r.replaced_by_token AS "ReplacedByToken", r.reason_revoked AS "ReasonRevoked", r.is_expired AS "IsExpired", r.is_revoked AS "IsRevoked", r.is_active AS "IsActive"
FROM refresh_token AS r
WHERE r.user_id = @__id_0
2022-09-21 17:40:33.993 +01:00 [DBG] A data reader was disposed.
2022-09-21 17:40:33.993 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 17:40:33.994 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-21 17:40:34.006 +01:00 [DBG] An entity of type 'User' tracked by 'PostgresContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 17:40:34.025 +01:00 [DBG] 'PostgresContext' generated a temporary value for the property 'Id.RefreshToken'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 17:40:34.060 +01:00 [DBG] Context 'PostgresContext' started tracking 'RefreshToken' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 17:40:34.065 +01:00 [DBG] SaveChanges starting for 'PostgresContext'.
2022-09-21 17:40:34.068 +01:00 [DBG] DetectChanges starting for 'PostgresContext'.
2022-09-21 17:40:34.089 +01:00 [DBG] 1 entities were added and 0 entities were removed from navigation 'User.RefreshTokenCollection'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 17:40:34.104 +01:00 [DBG] The foreign key property 'RefreshToken.UserId' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2022-09-21 17:40:34.119 +01:00 [DBG] DetectChanges completed for 'PostgresContext'.
2022-09-21 17:40:34.127 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-21 17:40:34.128 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 17:40:34.130 +01:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2022-09-21 17:40:34.137 +01:00 [DBG] Began transaction with isolation level 'ReadCommitted'.
2022-09-21 17:40:34.192 +01:00 [DBG] Executing 2 update commands as a batch.
2022-09-21 17:40:34.208 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-21 17:40:34.209 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2022-09-21 17:40:34.210 +01:00 [DBG] Executing DbCommand [Parameters=[@p0='?' (DbType = DateTime), @p1='?', @p2='?' (DbType = DateTime), @p3='?' (DbType = Boolean), @p4='?' (DbType = Boolean), @p5='?' (DbType = Boolean), @p6='?', @p7='?', @p8='?', @p9='?' (DbType = DateTime), @p10='?', @p11='?' (DbType = Int32), @p18='?' (DbType = Int32), @p12='?' (DbType = DateTime), @p13='?', @p14='?', @p15='?' (DbType = DateTime), @p16='?', @p17='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO refresh_token (created, created_by_ip, expires, is_active, is_expired, is_revoked, reason_revoked, token, replaced_by_token, revoked, revoked_by_ip, user_id)
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11)
RETURNING id;
UPDATE users SET created_at = @p12, email = @p13, full_name = @p14, password_changed_at = @p15, password_hash = @p16, username = @p17
WHERE id = @p18;
2022-09-21 17:40:34.217 +01:00 [INF] Executed DbCommand (6ms) [Parameters=[@p0='?' (DbType = DateTime), @p1='?', @p2='?' (DbType = DateTime), @p3='?' (DbType = Boolean), @p4='?' (DbType = Boolean), @p5='?' (DbType = Boolean), @p6='?', @p7='?', @p8='?', @p9='?' (DbType = DateTime), @p10='?', @p11='?' (DbType = Int32), @p18='?' (DbType = Int32), @p12='?' (DbType = DateTime), @p13='?', @p14='?', @p15='?' (DbType = DateTime), @p16='?', @p17='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO refresh_token (created, created_by_ip, expires, is_active, is_expired, is_revoked, reason_revoked, token, replaced_by_token, revoked, revoked_by_ip, user_id)
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11)
RETURNING id;
UPDATE users SET created_at = @p12, email = @p13, full_name = @p14, password_changed_at = @p15, password_hash = @p16, username = @p17
WHERE id = @p18;
2022-09-21 17:40:34.229 +01:00 [DBG] The foreign key property 'RefreshToken.Id' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2022-09-21 17:40:34.233 +01:00 [DBG] A data reader was disposed.
2022-09-21 17:40:34.236 +01:00 [DBG] Committing transaction.
2022-09-21 17:40:34.240 +01:00 [DBG] Committed transaction.
2022-09-21 17:40:34.241 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 17:40:34.242 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-21 17:40:34.243 +01:00 [DBG] Disposing transaction.
2022-09-21 17:40:34.246 +01:00 [DBG] An entity of type 'RefreshToken' tracked by 'PostgresContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 17:40:34.249 +01:00 [DBG] An entity of type 'User' tracked by 'PostgresContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 17:40:34.253 +01:00 [DBG] SaveChanges completed for 'PostgresContext' with 2 entities written to the database.
2022-09-21 17:40:34.256 +01:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2022-09-21 17:40:34.259 +01:00 [DBG] Attempting to select an output formatter based on Accept header '["text/plain"]'.
2022-09-21 17:40:34.260 +01:00 [DBG] Could not find an output formatter based on content negotiation. Accepted types were (["text/plain"])
2022-09-21 17:40:34.261 +01:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2022-09-21 17:40:34.262 +01:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2022-09-21 17:40:34.264 +01:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2022-09-21 17:40:34.265 +01:00 [INF] Executing OkObjectResult, writing value of type 'APIBank.Models.Users.Responses.LoginResponse'.
2022-09-21 17:40:34.272 +01:00 [INF] Executed action APIBank.Controllers.UsersController.Login (APIBank) in 2772.0566ms
2022-09-21 17:40:34.273 +01:00 [INF] Executed endpoint 'APIBank.Controllers.UsersController.Login (APIBank)'
2022-09-21 17:40:34.274 +01:00 [DBG] 'PostgresContext' disposed.
2022-09-21 17:40:34.277 +01:00 [INF] Request finished HTTP/2 POST https://localhost:7036/api/Users/Login application/json 58 - 200 - application/json;+charset=utf-8 2816.0203ms
2022-09-21 17:40:52.378 +01:00 [INF] Request starting HTTP/2 POST https://localhost:7036/api/Users/revoke-token application/json 17
2022-09-21 17:40:52.397 +01:00 [DBG] 1 candidate(s) found for the request path '/api/Users/revoke-token'
2022-09-21 17:40:52.398 +01:00 [DBG] Endpoint 'APIBank.Controllers.UsersController.RevokeToken (APIBank)' with route pattern 'api/Users/revoke-token' is valid for the request path '/api/Users/revoke-token'
2022-09-21 17:40:52.407 +01:00 [DBG] Request matched endpoint 'APIBank.Controllers.UsersController.RevokeToken (APIBank)'
2022-09-21 17:40:52.409 +01:00 [DBG] Static files was skipped as the request already matched an endpoint.
2022-09-21 17:40:52.489 +01:00 [INF] Entity Framework Core 6.0.9 initialized 'PostgresContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:6.0.7+5b98e4b74de93b590b44aef8dd7967c03acc433c' with options: None
2022-09-21 17:40:52.500 +01:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .FirstOrDefault(e => EF.Property<int>(e, "Id") == __p_0)'
2022-09-21 17:40:52.508 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<User>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: User.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: User.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 1], [Property: User.Email (string) Required Index MaxLength(254), 2], [Property: User.FullName (string) Required MaxLength(100), 3], [Property: User.PasswordChangedAt (DateTime) Required ValueGenerated.OnAdd, 4], [Property: User.PasswordHash (string) Required MaxLength(200), 5], [Property: User.Username (string) Required Index MaxLength(50), 6] }
        SELECT TOP(1) u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
        FROM users AS u
        WHERE u.id == @__p_0), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, User>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)
    .SingleOrDefault()'
2022-09-21 17:40:52.512 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-21 17:40:52.513 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2022-09-21 17:40:52.514 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-21 17:40:52.514 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 17:40:52.515 +01:00 [DBG] Executing DbCommand [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.id = @__p_0
LIMIT 1
2022-09-21 17:40:52.519 +01:00 [INF] Executed DbCommand (4ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.id = @__p_0
LIMIT 1
2022-09-21 17:40:52.522 +01:00 [DBG] Context 'PostgresContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 17:40:52.524 +01:00 [DBG] A data reader was disposed.
2022-09-21 17:40:52.527 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 17:40:52.528 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-21 17:40:52.529 +01:00 [INF] Executing endpoint 'APIBank.Controllers.UsersController.RevokeToken (APIBank)'
2022-09-21 17:40:52.531 +01:00 [INF] Route matched with {action = "RevokeToken", controller = "Users"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult RevokeToken(APIBank.Models.Users.Requests.RevokeTokenRequest) on controller APIBank.Controllers.UsersController (APIBank).
2022-09-21 17:40:52.533 +01:00 [DBG] Execution plan of authorization filters (in the following order): ["APIBank.Authorization.AuthorizeAttribute"]
2022-09-21 17:40:52.536 +01:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2022-09-21 17:40:52.538 +01:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2022-09-21 17:40:52.542 +01:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2022-09-21 17:40:52.543 +01:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2022-09-21 17:40:52.545 +01:00 [DBG] Executing controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-21 17:40:52.546 +01:00 [DBG] Executed controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-21 17:40:52.547 +01:00 [DBG] Attempting to bind parameter 'model' of type 'APIBank.Models.Users.Requests.RevokeTokenRequest' ...
2022-09-21 17:40:52.548 +01:00 [DBG] Attempting to bind parameter 'model' of type 'APIBank.Models.Users.Requests.RevokeTokenRequest' using the name '' in request data ...
2022-09-21 17:40:52.550 +01:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2022-09-21 17:40:52.553 +01:00 [DBG] Connection id "0HMKRTVPJMNFQ", Request id "0HMKRTVPJMNFQ:0000000D": started reading request body.
2022-09-21 17:40:52.556 +01:00 [DBG] Connection id "0HMKRTVPJMNFQ", Request id "0HMKRTVPJMNFQ:0000000D": done reading request body.
2022-09-21 17:40:52.559 +01:00 [DBG] JSON input formatter succeeded, deserializing to type 'APIBank.Models.Users.Requests.RevokeTokenRequest'
2022-09-21 17:40:52.560 +01:00 [DBG] Done attempting to bind parameter 'model' of type 'APIBank.Models.Users.Requests.RevokeTokenRequest'.
2022-09-21 17:40:52.562 +01:00 [DBG] Done attempting to bind parameter 'model' of type 'APIBank.Models.Users.Requests.RevokeTokenRequest'.
2022-09-21 17:40:52.563 +01:00 [DBG] Attempting to validate the bound parameter 'model' of type 'APIBank.Models.Users.Requests.RevokeTokenRequest' ...
2022-09-21 17:40:52.565 +01:00 [DBG] Done attempting to validate the bound parameter 'model' of type 'APIBank.Models.Users.Requests.RevokeTokenRequest'.
2022-09-21 17:40:52.573 +01:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .SingleOrDefault(userQuery => userQuery.RefreshTokenCollection
        .Any(refTokenQuery => refTokenQuery.RefToken == __refToken_0))'
2022-09-21 17:40:52.580 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<User>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: User.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: User.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 1], [Property: User.Email (string) Required Index MaxLength(254), 2], [Property: User.FullName (string) Required MaxLength(100), 3], [Property: User.PasswordChangedAt (DateTime) Required ValueGenerated.OnAdd, 4], [Property: User.PasswordHash (string) Required MaxLength(200), 5], [Property: User.Username (string) Required Index MaxLength(50), 6] }
        SELECT TOP(2) u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
        FROM users AS u
        WHERE EXISTS (
            SELECT 1
            FROM refresh_token AS r
            WHERE ((u.id != NULL) && (u.id == r.user_id)) && (r.token == @__refToken_0))), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, User>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)
    .SingleOrDefault()'
2022-09-21 17:40:52.582 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-21 17:40:52.583 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2022-09-21 17:40:52.585 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-21 17:40:52.589 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 17:40:52.590 +01:00 [DBG] Executing DbCommand [Parameters=[@__refToken_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE EXISTS (
    SELECT 1
    FROM refresh_token AS r
    WHERE (u.id = r.user_id) AND (r.token = @__refToken_0))
LIMIT 2
2022-09-21 17:40:52.594 +01:00 [INF] Executed DbCommand (4ms) [Parameters=[@__refToken_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE EXISTS (
    SELECT 1
    FROM refresh_token AS r
    WHERE (u.id = r.user_id) AND (r.token = @__refToken_0))
LIMIT 2
2022-09-21 17:40:52.596 +01:00 [DBG] A data reader was disposed.
2022-09-21 17:40:52.596 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 17:40:52.597 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-21 17:40:52.601 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-21 17:40:52.605 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (4ms).
2022-09-21 17:40:52.606 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-21 17:40:52.608 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 17:40:52.610 +01:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.user_id AS "UserId", r.token AS "RefToken", r.expires AS "Expires", r.created AS "Created", r.created_by_ip AS "CreatedByIp", r.revoked AS "Revoked", r.revoked_by_ip AS "RevokedByIp", r.replaced_by_token AS "ReplacedByToken", r.reason_revoked AS "ReasonRevoked", r.is_expired AS "IsExpired", r.is_revoked AS "IsRevoked", r.is_active AS "IsActive"
FROM refresh_token AS r
WHERE r.user_id = @__id_0
2022-09-21 17:40:52.612 +01:00 [INF] Executed DbCommand (3ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.user_id AS "UserId", r.token AS "RefToken", r.expires AS "Expires", r.created AS "Created", r.created_by_ip AS "CreatedByIp", r.revoked AS "Revoked", r.revoked_by_ip AS "RevokedByIp", r.replaced_by_token AS "ReplacedByToken", r.reason_revoked AS "ReasonRevoked", r.is_expired AS "IsExpired", r.is_revoked AS "IsRevoked", r.is_active AS "IsActive"
FROM refresh_token AS r
WHERE r.user_id = @__id_0
2022-09-21 17:40:52.614 +01:00 [DBG] A data reader was disposed.
2022-09-21 17:40:52.615 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 17:40:52.617 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-21 17:40:52.622 +01:00 [DBG] An entity of type 'User' tracked by 'PostgresContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 17:40:52.626 +01:00 [DBG] Context 'PostgresContext' started tracking 'RefreshToken' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 17:40:52.628 +01:00 [DBG] SaveChanges starting for 'PostgresContext'.
2022-09-21 17:40:52.629 +01:00 [DBG] DetectChanges starting for 'PostgresContext'.
2022-09-21 17:40:52.630 +01:00 [DBG] DetectChanges completed for 'PostgresContext'.
2022-09-21 17:40:52.631 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-21 17:40:52.633 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 17:40:52.636 +01:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2022-09-21 17:40:52.638 +01:00 [DBG] Began transaction with isolation level 'ReadCommitted'.
2022-09-21 17:40:52.644 +01:00 [DBG] Executing 2 update commands as a batch.
2022-09-21 17:40:52.645 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-21 17:40:52.646 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2022-09-21 17:40:52.647 +01:00 [DBG] Executing DbCommand [Parameters=[@p12='?' (DbType = Int32), @p0='?' (DbType = DateTime), @p1='?', @p2='?' (DbType = DateTime), @p3='?' (DbType = Boolean), @p4='?' (DbType = Boolean), @p5='?' (DbType = Boolean), @p6='?', @p7='?', @p8='?', @p9='?' (DbType = DateTime), @p10='?', @p11='?' (DbType = Int32), @p19='?' (DbType = Int32), @p13='?' (DbType = DateTime), @p14='?', @p15='?', @p16='?' (DbType = DateTime), @p17='?', @p18='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE refresh_token SET created = @p0, created_by_ip = @p1, expires = @p2, is_active = @p3, is_expired = @p4, is_revoked = @p5, reason_revoked = @p6, token = @p7, replaced_by_token = @p8, revoked = @p9, revoked_by_ip = @p10, user_id = @p11
WHERE id = @p12;
UPDATE users SET created_at = @p13, email = @p14, full_name = @p15, password_changed_at = @p16, password_hash = @p17, username = @p18
WHERE id = @p19;
2022-09-21 17:40:52.654 +01:00 [INF] Executed DbCommand (7ms) [Parameters=[@p12='?' (DbType = Int32), @p0='?' (DbType = DateTime), @p1='?', @p2='?' (DbType = DateTime), @p3='?' (DbType = Boolean), @p4='?' (DbType = Boolean), @p5='?' (DbType = Boolean), @p6='?', @p7='?', @p8='?', @p9='?' (DbType = DateTime), @p10='?', @p11='?' (DbType = Int32), @p19='?' (DbType = Int32), @p13='?' (DbType = DateTime), @p14='?', @p15='?', @p16='?' (DbType = DateTime), @p17='?', @p18='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE refresh_token SET created = @p0, created_by_ip = @p1, expires = @p2, is_active = @p3, is_expired = @p4, is_revoked = @p5, reason_revoked = @p6, token = @p7, replaced_by_token = @p8, revoked = @p9, revoked_by_ip = @p10, user_id = @p11
WHERE id = @p12;
UPDATE users SET created_at = @p13, email = @p14, full_name = @p15, password_changed_at = @p16, password_hash = @p17, username = @p18
WHERE id = @p19;
2022-09-21 17:40:52.658 +01:00 [DBG] A data reader was disposed.
2022-09-21 17:40:52.659 +01:00 [DBG] Committing transaction.
2022-09-21 17:40:52.662 +01:00 [DBG] Committed transaction.
2022-09-21 17:40:52.663 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 17:40:52.665 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-21 17:40:52.666 +01:00 [DBG] Disposing transaction.
2022-09-21 17:40:52.666 +01:00 [DBG] An entity of type 'User' tracked by 'PostgresContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 17:40:52.670 +01:00 [DBG] An entity of type 'RefreshToken' tracked by 'PostgresContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 17:40:52.672 +01:00 [DBG] SaveChanges completed for 'PostgresContext' with 2 entities written to the database.
2022-09-21 17:40:52.674 +01:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2022-09-21 17:40:52.677 +01:00 [DBG] No information found on request to perform content negotiation.
2022-09-21 17:40:52.678 +01:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2022-09-21 17:40:52.680 +01:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2022-09-21 17:40:52.681 +01:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2022-09-21 17:40:52.682 +01:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType0`1[[System.String, System.Private.CoreLib, Version=6.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2022-09-21 17:40:52.683 +01:00 [INF] Executed action APIBank.Controllers.UsersController.RevokeToken (APIBank) in 138.201ms
2022-09-21 17:40:52.686 +01:00 [INF] Executed endpoint 'APIBank.Controllers.UsersController.RevokeToken (APIBank)'
2022-09-21 17:40:52.688 +01:00 [DBG] 'PostgresContext' disposed.
2022-09-21 17:40:52.690 +01:00 [INF] Request finished HTTP/2 POST https://localhost:7036/api/Users/revoke-token application/json 17 - 200 - application/json;+charset=utf-8 310.9369ms
2022-09-21 17:41:05.571 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/api/Accounts/GetAll - -
2022-09-21 17:41:05.576 +01:00 [DBG] 1 candidate(s) found for the request path '/api/Accounts/GetAll'
2022-09-21 17:41:05.578 +01:00 [DBG] Endpoint 'APIBank.Controllers.AccountsController.GetAllFromUser (APIBank)' with route pattern 'api/Accounts/GetAll' is valid for the request path '/api/Accounts/GetAll'
2022-09-21 17:41:05.581 +01:00 [DBG] Request matched endpoint 'APIBank.Controllers.AccountsController.GetAllFromUser (APIBank)'
2022-09-21 17:41:05.583 +01:00 [DBG] Static files was skipped as the request already matched an endpoint.
2022-09-21 17:41:05.661 +01:00 [INF] Entity Framework Core 6.0.9 initialized 'PostgresContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:6.0.7+5b98e4b74de93b590b44aef8dd7967c03acc433c' with options: None
2022-09-21 17:41:05.665 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-21 17:41:05.666 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2022-09-21 17:41:05.667 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-21 17:41:05.668 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 17:41:05.669 +01:00 [DBG] Executing DbCommand [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.id = @__p_0
LIMIT 1
2022-09-21 17:41:05.671 +01:00 [INF] Executed DbCommand (3ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.id = @__p_0
LIMIT 1
2022-09-21 17:41:05.673 +01:00 [DBG] Context 'PostgresContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 17:41:05.675 +01:00 [DBG] A data reader was disposed.
2022-09-21 17:41:05.676 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 17:41:05.677 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-21 17:41:05.678 +01:00 [INF] Executing endpoint 'APIBank.Controllers.AccountsController.GetAllFromUser (APIBank)'
2022-09-21 17:41:05.679 +01:00 [INF] Route matched with {action = "GetAllFromUser", controller = "Accounts"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult GetAllFromUser() on controller APIBank.Controllers.AccountsController (APIBank).
2022-09-21 17:41:05.680 +01:00 [DBG] Execution plan of authorization filters (in the following order): ["APIBank.Authorization.AuthorizeAttribute"]
2022-09-21 17:41:05.681 +01:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2022-09-21 17:41:05.683 +01:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2022-09-21 17:41:05.684 +01:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2022-09-21 17:41:05.685 +01:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2022-09-21 17:41:05.686 +01:00 [DBG] Executing controller factory for controller APIBank.Controllers.AccountsController (APIBank)
2022-09-21 17:41:05.687 +01:00 [DBG] Executed controller factory for controller APIBank.Controllers.AccountsController (APIBank)
2022-09-21 17:41:05.692 +01:00 [DBG] Compiling query expression: 
'DbSet<Account>()
    .Where(u => u.UserId == __userId_0)
    .Select(u => new AccountRe{ 
        Balance = u.Balance, 
        CreatedAt = u.CreatedAt, 
        Currency = u.Currency, 
        Id = u.Id 
    }
    )'
2022-09-21 17:41:05.697 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<AccountRe>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            Balance -> 0
            CreatedAt -> 1
            Currency -> 2
            Id -> 3
        SELECT a.balance AS Balance, a.created_at AS CreatedAt, a.currency AS Currency, a.id AS Id
        FROM accounts AS a
        WHERE a.user_id == @__userId_0), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, AccountRe>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)'
2022-09-21 17:41:05.699 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-21 17:41:05.700 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2022-09-21 17:41:05.701 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-21 17:41:05.702 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 17:41:05.703 +01:00 [DBG] Executing DbCommand [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a.balance AS "Balance", a.created_at AS "CreatedAt", a.currency AS "Currency", a.id AS "Id"
FROM accounts AS a
WHERE a.user_id = @__userId_0
2022-09-21 17:41:05.706 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a.balance AS "Balance", a.created_at AS "CreatedAt", a.currency AS "Currency", a.id AS "Id"
FROM accounts AS a
WHERE a.user_id = @__userId_0
2022-09-21 17:41:05.716 +01:00 [DBG] A data reader was disposed.
2022-09-21 17:41:05.716 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 17:41:05.719 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-21 17:41:05.720 +01:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2022-09-21 17:41:05.723 +01:00 [DBG] Attempting to select an output formatter based on Accept header '["text/plain"]'.
2022-09-21 17:41:05.724 +01:00 [DBG] Could not find an output formatter based on content negotiation. Accepted types were (["text/plain"])
2022-09-21 17:41:05.725 +01:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2022-09-21 17:41:05.726 +01:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2022-09-21 17:41:05.726 +01:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2022-09-21 17:41:05.728 +01:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[APIBank.Models.Accounts.AccountRe, APIBank, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2022-09-21 17:41:05.734 +01:00 [INF] Executed action APIBank.Controllers.AccountsController.GetAllFromUser (APIBank) in 47.2852ms
2022-09-21 17:41:05.735 +01:00 [INF] Executed endpoint 'APIBank.Controllers.AccountsController.GetAllFromUser (APIBank)'
2022-09-21 17:41:05.736 +01:00 [DBG] 'PostgresContext' disposed.
2022-09-21 17:41:05.737 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/api/Accounts/GetAll - - - 200 - application/json;+charset=utf-8 165.6821ms
2022-09-21 17:43:03.346 +01:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2022-09-21 17:43:03.427 +01:00 [DBG] Hosting starting
2022-09-21 17:43:03.528 +01:00 [DBG] Using development certificate: CN=localhost (Thumbprint: 9CC642E9838495A6C3C202DECA6A8AD300396DD2)
2022-09-21 17:43:03.581 +01:00 [INF] Now listening on: https://localhost:7036
2022-09-21 17:43:03.584 +01:00 [INF] Now listening on: http://localhost:5036
2022-09-21 17:43:03.586 +01:00 [DBG] Loaded hosting startup assembly APIBank
2022-09-21 17:43:03.586 +01:00 [DBG] Loaded hosting startup assembly Microsoft.AspNetCore.Watch.BrowserRefresh
2022-09-21 17:43:03.587 +01:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.BrowserLink.Net
2022-09-21 17:43:03.588 +01:00 [INF] Application started. Press Ctrl+C to shut down.
2022-09-21 17:43:03.589 +01:00 [INF] Hosting environment: Development
2022-09-21 17:43:03.590 +01:00 [INF] Content root path: C:\Users\mguedesa\OneDrive - NTT DATA EMEAL\Documentos\GitHub\OpenBankAPI-NTT\APIBank\APIBank\
2022-09-21 17:43:03.593 +01:00 [DBG] Hosting started
2022-09-21 17:43:03.618 +01:00 [DBG] Connection id "0HMKRU1D55BBO" accepted.
2022-09-21 17:43:03.618 +01:00 [DBG] Connection id "0HMKRU1D55BBN" accepted.
2022-09-21 17:43:03.619 +01:00 [DBG] Connection id "0HMKRU1D55BBO" started.
2022-09-21 17:43:03.620 +01:00 [DBG] Connection id "0HMKRU1D55BBN" started.
2022-09-21 17:43:03.633 +01:00 [DBG] Connection id "0HMKRU1D55BBO" received FIN.
2022-09-21 17:43:03.633 +01:00 [DBG] Connection id "0HMKRU1D55BBN" received FIN.
2022-09-21 17:43:03.644 +01:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException:  Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.<FillHandshakeBufferAsync>g__InternalFillHandshakeBufferAsync|189_0[TIOAdapter](TIOAdapter adap, ValueTask`1 task, Int32 minSize)
   at System.Net.Security.SslStream.ReceiveBlobAsync[TIOAdapter](TIOAdapter adapter)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](TIOAdapter adapter, Boolean receiveFirst, Byte[] reAuthenticationData, Boolean isApm)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2022-09-21 17:43:03.644 +01:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException:  Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.<FillHandshakeBufferAsync>g__InternalFillHandshakeBufferAsync|189_0[TIOAdapter](TIOAdapter adap, ValueTask`1 task, Int32 minSize)
   at System.Net.Security.SslStream.ReceiveBlobAsync[TIOAdapter](TIOAdapter adapter)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](TIOAdapter adapter, Boolean receiveFirst, Byte[] reAuthenticationData, Boolean isApm)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2022-09-21 17:43:03.664 +01:00 [DBG] Connection id "0HMKRU1D55BBO" stopped.
2022-09-21 17:43:03.664 +01:00 [DBG] Connection id "0HMKRU1D55BBN" stopped.
2022-09-21 17:43:03.666 +01:00 [DBG] Connection id "0HMKRU1D55BBO" sending FIN because: "The Socket transport's send loop completed gracefully."
2022-09-21 17:43:03.666 +01:00 [DBG] Connection id "0HMKRU1D55BBN" sending FIN because: "The Socket transport's send loop completed gracefully."
2022-09-21 17:43:03.740 +01:00 [DBG] Connection id "0HMKRU1D55BBP" accepted.
2022-09-21 17:43:03.744 +01:00 [DBG] Connection id "0HMKRU1D55BBP" started.
2022-09-21 17:43:03.784 +01:00 [DBG] Connection 0HMKRU1D55BBP established using the following protocol: "Tls12"
2022-09-21 17:43:03.855 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/swagger/index.html - -
2022-09-21 17:43:03.882 +01:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2022-09-21 17:43:03.915 +01:00 [DBG] No candidates found for the request path '/swagger/index.html'
2022-09-21 17:43:03.918 +01:00 [DBG] Request did not match any endpoints
2022-09-21 17:43:04.004 +01:00 [DBG] Response markup is scheduled to include browser refresh script injection.
2022-09-21 17:43:04.075 +01:00 [DBG] Response markup was updated to include browser refresh script injection.
2022-09-21 17:43:04.081 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/swagger/index.html - - - 200 - text/html;charset=utf-8 229.8583ms
2022-09-21 17:43:04.104 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/_vs/browserLink - -
2022-09-21 17:43:04.104 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/_framework/aspnetcore-browser-refresh.js - -
2022-09-21 17:43:04.113 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/_framework/aspnetcore-browser-refresh.js - - - 200 11984 application/javascript;+charset=utf-8 8.9209ms
2022-09-21 17:43:04.129 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/_vs/browserLink - - - 200 - text/javascript;+charset=UTF-8 24.3278ms
2022-09-21 17:43:04.328 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/swagger/v1/swagger.json - -
2022-09-21 17:43:04.330 +01:00 [DBG] No candidates found for the request path '/swagger/v1/swagger.json'
2022-09-21 17:43:04.331 +01:00 [DBG] Request did not match any endpoints
2022-09-21 17:43:04.534 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/swagger/v1/swagger.json - - - 200 - application/json;charset=utf-8 205.9956ms
2022-09-21 17:43:19.249 +01:00 [INF] Request starting HTTP/2 POST https://localhost:7036/api/Users/Login application/json 58
2022-09-21 17:43:19.262 +01:00 [DBG] 1 candidate(s) found for the request path '/api/Users/Login'
2022-09-21 17:43:19.268 +01:00 [DBG] Endpoint 'APIBank.Controllers.UsersController.Login (APIBank)' with route pattern 'api/Users/Login' is valid for the request path '/api/Users/Login'
2022-09-21 17:43:19.270 +01:00 [DBG] Request matched endpoint 'APIBank.Controllers.UsersController.Login (APIBank)'
2022-09-21 17:43:19.271 +01:00 [DBG] Static files was skipped as the request already matched an endpoint.
2022-09-21 17:43:19.512 +01:00 [INF] Executing endpoint 'APIBank.Controllers.UsersController.Login (APIBank)'
2022-09-21 17:43:19.542 +01:00 [INF] Route matched with {action = "Login", controller = "Users"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult Login(APIBank.Models.Requests.LoginRequest) on controller APIBank.Controllers.UsersController (APIBank).
2022-09-21 17:43:19.548 +01:00 [DBG] Execution plan of authorization filters (in the following order): ["APIBank.Authorization.AuthorizeAttribute"]
2022-09-21 17:43:19.549 +01:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2022-09-21 17:43:19.550 +01:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2022-09-21 17:43:19.554 +01:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2022-09-21 17:43:19.555 +01:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2022-09-21 17:43:19.559 +01:00 [DBG] Executing controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-21 17:43:19.561 +01:00 [DBG] Executed controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-21 17:43:19.568 +01:00 [DBG] Attempting to bind parameter 'model' of type 'APIBank.Models.Requests.LoginRequest' ...
2022-09-21 17:43:19.571 +01:00 [DBG] Attempting to bind parameter 'model' of type 'APIBank.Models.Requests.LoginRequest' using the name '' in request data ...
2022-09-21 17:43:19.573 +01:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2022-09-21 17:43:19.578 +01:00 [DBG] Connection id "0HMKRU1D55BBP", Request id "0HMKRU1D55BBP:00000009": started reading request body.
2022-09-21 17:43:19.580 +01:00 [DBG] Connection id "0HMKRU1D55BBP", Request id "0HMKRU1D55BBP:00000009": done reading request body.
2022-09-21 17:43:19.585 +01:00 [DBG] JSON input formatter succeeded, deserializing to type 'APIBank.Models.Requests.LoginRequest'
2022-09-21 17:43:19.586 +01:00 [DBG] Done attempting to bind parameter 'model' of type 'APIBank.Models.Requests.LoginRequest'.
2022-09-21 17:43:19.587 +01:00 [DBG] Done attempting to bind parameter 'model' of type 'APIBank.Models.Requests.LoginRequest'.
2022-09-21 17:43:19.587 +01:00 [DBG] Attempting to validate the bound parameter 'model' of type 'APIBank.Models.Requests.LoginRequest' ...
2022-09-21 17:43:19.598 +01:00 [DBG] Done attempting to validate the bound parameter 'model' of type 'APIBank.Models.Requests.LoginRequest'.
2022-09-21 17:43:19.653 +01:00 [DBG] An additional 'IServiceProvider' was created for internal use by Entity Framework. An existing service provider was not used due to the following configuration changes: configuration changed for 'Core:ConfigureWarnings', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:UseAdminDatabase', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:SetPostgresVersion', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:UseRedshift', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:ReverseNullOrdering', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:RemoteCertificateValidationCallback', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:ProvideClientCertificatesCallback', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:ProvidePasswordCallback'.
2022-09-21 17:43:20.653 +01:00 [INF] Entity Framework Core 6.0.9 initialized 'PostgresContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:6.0.7+5b98e4b74de93b590b44aef8dd7967c03acc433c' with options: None
2022-09-21 17:43:20.716 +01:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .SingleOrDefault(x => x.Username == __model_Username_0)'
2022-09-21 17:43:20.978 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<User>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: User.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: User.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 1], [Property: User.Email (string) Required Index MaxLength(254), 2], [Property: User.FullName (string) Required MaxLength(100), 3], [Property: User.PasswordChangedAt (DateTime) Required ValueGenerated.OnAdd, 4], [Property: User.PasswordHash (string) Required MaxLength(200), 5], [Property: User.Username (string) Required Index MaxLength(50), 6] }
        SELECT TOP(2) u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
        FROM users AS u
        WHERE u.username == @__model_Username_0), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, User>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)
    .SingleOrDefault()'
2022-09-21 17:43:21.027 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-21 17:43:21.067 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (34ms).
2022-09-21 17:43:21.075 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-21 17:43:21.326 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 17:43:21.337 +01:00 [DBG] Executing DbCommand [Parameters=[@__model_Username_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.username = @__model_Username_0
LIMIT 2
2022-09-21 17:43:21.416 +01:00 [INF] Executed DbCommand (82ms) [Parameters=[@__model_Username_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.username = @__model_Username_0
LIMIT 2
2022-09-21 17:43:21.457 +01:00 [DBG] Context 'PostgresContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 17:43:21.501 +01:00 [DBG] A data reader was disposed.
2022-09-21 17:43:21.508 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 17:43:21.514 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-21 17:43:21.894 +01:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .Any(user => user.RefreshTokenCollection
        .Any(reftoken => reftoken.RefToken == __token_0))'
2022-09-21 17:43:21.967 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<bool>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            EmptyProjectionMember -> 0
        SELECT EXISTS (
            SELECT 1
            FROM users AS u
            WHERE EXISTS (
                SELECT 1
                FROM refresh_token AS r
                WHERE ((u.id != NULL) && (u.id == r.user_id)) && (r.token == @__token_0)))), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, bool>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)
    .Single()'
2022-09-21 17:43:21.980 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-21 17:43:21.983 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (2ms).
2022-09-21 17:43:21.984 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-21 17:43:21.984 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 17:43:21.985 +01:00 [DBG] Executing DbCommand [Parameters=[@__token_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM users AS u
    WHERE EXISTS (
        SELECT 1
        FROM refresh_token AS r
        WHERE (u.id = r.user_id) AND (r.token = @__token_0)))
2022-09-21 17:43:21.991 +01:00 [INF] Executed DbCommand (5ms) [Parameters=[@__token_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM users AS u
    WHERE EXISTS (
        SELECT 1
        FROM refresh_token AS r
        WHERE (u.id = r.user_id) AND (r.token = @__token_0)))
2022-09-21 17:43:21.995 +01:00 [DBG] A data reader was disposed.
2022-09-21 17:43:21.996 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 17:43:21.997 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-21 17:43:22.009 +01:00 [DBG] Compiling query expression: 
'DbSet<RefreshToken>()
    .Where(rt => rt.UserId == __id_0)
    .AsNoTracking()
    .Select(rt => new RefreshToken{ 
        Id = rt.Id, 
        UserId = rt.UserId, 
        RefToken = rt.RefToken, 
        Expires = rt.Expires, 
        Created = rt.Created, 
        CreatedByIp = rt.CreatedByIp, 
        Revoked = rt.Revoked, 
        RevokedByIp = rt.RevokedByIp, 
        ReplacedByToken = rt.ReplacedByToken, 
        ReasonRevoked = rt.ReasonRevoked, 
        IsExpired = rt.IsExpired, 
        IsRevoked = rt.IsRevoked, 
        IsActive = rt.IsActive 
    }
    )'
2022-09-21 17:43:22.028 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<RefreshToken>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            Id -> 0
            UserId -> 1
            RefToken -> 2
            Expires -> 3
            Created -> 4
            CreatedByIp -> 5
            Revoked -> 6
            RevokedByIp -> 7
            ReplacedByToken -> 8
            ReasonRevoked -> 9
            IsExpired -> 10
            IsRevoked -> 11
            IsActive -> 12
        SELECT r.id AS Id, r.user_id AS UserId, r.token AS RefToken, r.expires AS Expires, r.created AS Created, r.created_by_ip AS CreatedByIp, r.revoked AS Revoked, r.revoked_by_ip AS RevokedByIp, r.replaced_by_token AS ReplacedByToken, r.reason_revoked AS ReasonRevoked, r.is_expired AS IsExpired, r.is_revoked AS IsRevoked, r.is_active AS IsActive
        FROM refresh_token AS r
        WHERE r.user_id == @__id_0), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, RefreshToken>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)'
2022-09-21 17:43:22.030 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-21 17:43:22.031 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2022-09-21 17:43:22.032 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-21 17:43:22.032 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 17:43:22.034 +01:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.user_id AS "UserId", r.token AS "RefToken", r.expires AS "Expires", r.created AS "Created", r.created_by_ip AS "CreatedByIp", r.revoked AS "Revoked", r.revoked_by_ip AS "RevokedByIp", r.replaced_by_token AS "ReplacedByToken", r.reason_revoked AS "ReasonRevoked", r.is_expired AS "IsExpired", r.is_revoked AS "IsRevoked", r.is_active AS "IsActive"
FROM refresh_token AS r
WHERE r.user_id = @__id_0
2022-09-21 17:43:22.039 +01:00 [INF] Executed DbCommand (5ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.user_id AS "UserId", r.token AS "RefToken", r.expires AS "Expires", r.created AS "Created", r.created_by_ip AS "CreatedByIp", r.revoked AS "Revoked", r.revoked_by_ip AS "RevokedByIp", r.replaced_by_token AS "ReplacedByToken", r.reason_revoked AS "ReasonRevoked", r.is_expired AS "IsExpired", r.is_revoked AS "IsRevoked", r.is_active AS "IsActive"
FROM refresh_token AS r
WHERE r.user_id = @__id_0
2022-09-21 17:43:22.041 +01:00 [DBG] A data reader was disposed.
2022-09-21 17:43:22.042 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 17:43:22.042 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-21 17:43:22.052 +01:00 [DBG] An entity of type 'User' tracked by 'PostgresContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 17:43:22.072 +01:00 [DBG] 'PostgresContext' generated a temporary value for the property 'Id.RefreshToken'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 17:43:22.096 +01:00 [DBG] Context 'PostgresContext' started tracking 'RefreshToken' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 17:43:22.100 +01:00 [DBG] SaveChanges starting for 'PostgresContext'.
2022-09-21 17:43:22.101 +01:00 [DBG] DetectChanges starting for 'PostgresContext'.
2022-09-21 17:43:22.119 +01:00 [DBG] 1 entities were added and 0 entities were removed from navigation 'User.RefreshTokenCollection'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 17:43:22.130 +01:00 [DBG] The foreign key property 'RefreshToken.UserId' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2022-09-21 17:43:22.148 +01:00 [DBG] DetectChanges completed for 'PostgresContext'.
2022-09-21 17:43:22.158 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-21 17:43:22.160 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 17:43:22.162 +01:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2022-09-21 17:43:22.170 +01:00 [DBG] Began transaction with isolation level 'ReadCommitted'.
2022-09-21 17:43:22.234 +01:00 [DBG] Executing 2 update commands as a batch.
2022-09-21 17:43:22.249 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-21 17:43:22.252 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (2ms).
2022-09-21 17:43:22.256 +01:00 [DBG] Executing DbCommand [Parameters=[@p0='?' (DbType = DateTime), @p1='?', @p2='?' (DbType = DateTime), @p3='?' (DbType = Boolean), @p4='?' (DbType = Boolean), @p5='?' (DbType = Boolean), @p6='?', @p7='?', @p8='?', @p9='?' (DbType = DateTime), @p10='?', @p11='?' (DbType = Int32), @p18='?' (DbType = Int32), @p12='?' (DbType = DateTime), @p13='?', @p14='?', @p15='?' (DbType = DateTime), @p16='?', @p17='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO refresh_token (created, created_by_ip, expires, is_active, is_expired, is_revoked, reason_revoked, token, replaced_by_token, revoked, revoked_by_ip, user_id)
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11)
RETURNING id;
UPDATE users SET created_at = @p12, email = @p13, full_name = @p14, password_changed_at = @p15, password_hash = @p16, username = @p17
WHERE id = @p18;
2022-09-21 17:43:22.262 +01:00 [INF] Executed DbCommand (6ms) [Parameters=[@p0='?' (DbType = DateTime), @p1='?', @p2='?' (DbType = DateTime), @p3='?' (DbType = Boolean), @p4='?' (DbType = Boolean), @p5='?' (DbType = Boolean), @p6='?', @p7='?', @p8='?', @p9='?' (DbType = DateTime), @p10='?', @p11='?' (DbType = Int32), @p18='?' (DbType = Int32), @p12='?' (DbType = DateTime), @p13='?', @p14='?', @p15='?' (DbType = DateTime), @p16='?', @p17='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO refresh_token (created, created_by_ip, expires, is_active, is_expired, is_revoked, reason_revoked, token, replaced_by_token, revoked, revoked_by_ip, user_id)
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11)
RETURNING id;
UPDATE users SET created_at = @p12, email = @p13, full_name = @p14, password_changed_at = @p15, password_hash = @p16, username = @p17
WHERE id = @p18;
2022-09-21 17:43:22.274 +01:00 [DBG] The foreign key property 'RefreshToken.Id' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2022-09-21 17:43:22.276 +01:00 [DBG] A data reader was disposed.
2022-09-21 17:43:22.278 +01:00 [DBG] Committing transaction.
2022-09-21 17:43:22.281 +01:00 [DBG] Committed transaction.
2022-09-21 17:43:22.282 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 17:43:22.283 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-21 17:43:22.286 +01:00 [DBG] Disposing transaction.
2022-09-21 17:43:22.291 +01:00 [DBG] An entity of type 'RefreshToken' tracked by 'PostgresContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 17:43:22.293 +01:00 [DBG] An entity of type 'User' tracked by 'PostgresContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 17:43:22.294 +01:00 [DBG] SaveChanges completed for 'PostgresContext' with 2 entities written to the database.
2022-09-21 17:43:22.298 +01:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2022-09-21 17:43:22.302 +01:00 [DBG] Attempting to select an output formatter based on Accept header '["text/plain"]'.
2022-09-21 17:43:22.305 +01:00 [DBG] Could not find an output formatter based on content negotiation. Accepted types were (["text/plain"])
2022-09-21 17:43:22.307 +01:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2022-09-21 17:43:22.307 +01:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2022-09-21 17:43:22.308 +01:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2022-09-21 17:43:22.309 +01:00 [INF] Executing OkObjectResult, writing value of type 'APIBank.Models.Users.Responses.LoginResponse'.
2022-09-21 17:43:22.321 +01:00 [INF] Executed action APIBank.Controllers.UsersController.Login (APIBank) in 2757.8206ms
2022-09-21 17:43:22.323 +01:00 [INF] Executed endpoint 'APIBank.Controllers.UsersController.Login (APIBank)'
2022-09-21 17:43:22.325 +01:00 [DBG] 'PostgresContext' disposed.
2022-09-21 17:43:22.328 +01:00 [INF] Request finished HTTP/2 POST https://localhost:7036/api/Users/Login application/json 58 - 200 - application/json;+charset=utf-8 3078.7359ms
2022-09-21 17:44:00.866 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/api/Accounts/GetAll - -
2022-09-21 17:44:00.870 +01:00 [DBG] 1 candidate(s) found for the request path '/api/Accounts/GetAll'
2022-09-21 17:44:00.871 +01:00 [DBG] Endpoint 'APIBank.Controllers.AccountsController.GetAllFromUser (APIBank)' with route pattern 'api/Accounts/GetAll' is valid for the request path '/api/Accounts/GetAll'
2022-09-21 17:44:00.874 +01:00 [DBG] Request matched endpoint 'APIBank.Controllers.AccountsController.GetAllFromUser (APIBank)'
2022-09-21 17:44:00.877 +01:00 [DBG] Static files was skipped as the request already matched an endpoint.
2022-09-21 17:44:00.950 +01:00 [INF] Entity Framework Core 6.0.9 initialized 'PostgresContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:6.0.7+5b98e4b74de93b590b44aef8dd7967c03acc433c' with options: None
2022-09-21 17:44:00.961 +01:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .FirstOrDefault(e => EF.Property<int>(e, "Id") == __p_0)'
2022-09-21 17:44:00.966 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<User>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: User.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: User.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 1], [Property: User.Email (string) Required Index MaxLength(254), 2], [Property: User.FullName (string) Required MaxLength(100), 3], [Property: User.PasswordChangedAt (DateTime) Required ValueGenerated.OnAdd, 4], [Property: User.PasswordHash (string) Required MaxLength(200), 5], [Property: User.Username (string) Required Index MaxLength(50), 6] }
        SELECT TOP(1) u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
        FROM users AS u
        WHERE u.id == @__p_0), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, User>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)
    .SingleOrDefault()'
2022-09-21 17:44:00.967 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-21 17:44:00.968 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2022-09-21 17:44:00.969 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-21 17:44:00.971 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 17:44:00.973 +01:00 [DBG] Executing DbCommand [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.id = @__p_0
LIMIT 1
2022-09-21 17:44:00.975 +01:00 [INF] Executed DbCommand (3ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.id = @__p_0
LIMIT 1
2022-09-21 17:44:00.977 +01:00 [DBG] Context 'PostgresContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 17:44:00.979 +01:00 [DBG] A data reader was disposed.
2022-09-21 17:44:00.979 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 17:44:00.980 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-21 17:44:00.981 +01:00 [INF] Executing endpoint 'APIBank.Controllers.AccountsController.GetAllFromUser (APIBank)'
2022-09-21 17:44:00.983 +01:00 [INF] Route matched with {action = "GetAllFromUser", controller = "Accounts"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult GetAllFromUser() on controller APIBank.Controllers.AccountsController (APIBank).
2022-09-21 17:44:00.984 +01:00 [DBG] Execution plan of authorization filters (in the following order): ["APIBank.Authorization.AuthorizeAttribute"]
2022-09-21 17:44:00.985 +01:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2022-09-21 17:44:00.987 +01:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2022-09-21 17:44:00.989 +01:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2022-09-21 17:44:00.991 +01:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2022-09-21 17:44:00.992 +01:00 [DBG] Executing controller factory for controller APIBank.Controllers.AccountsController (APIBank)
2022-09-21 17:44:00.994 +01:00 [DBG] Executed controller factory for controller APIBank.Controllers.AccountsController (APIBank)
2022-09-21 17:44:00.997 +01:00 [DBG] Compiling query expression: 
'DbSet<Account>()
    .Where(u => u.UserId == __userId_0)
    .Select(u => new AccountRe{ 
        Balance = u.Balance, 
        CreatedAt = u.CreatedAt, 
        Currency = u.Currency, 
        Id = u.Id 
    }
    )'
2022-09-21 17:44:01.000 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<AccountRe>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            Balance -> 0
            CreatedAt -> 1
            Currency -> 2
            Id -> 3
        SELECT a.balance AS Balance, a.created_at AS CreatedAt, a.currency AS Currency, a.id AS Id
        FROM accounts AS a
        WHERE a.user_id == @__userId_0), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, AccountRe>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)'
2022-09-21 17:44:01.002 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-21 17:44:01.003 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2022-09-21 17:44:01.005 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-21 17:44:01.006 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 17:44:01.007 +01:00 [DBG] Executing DbCommand [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a.balance AS "Balance", a.created_at AS "CreatedAt", a.currency AS "Currency", a.id AS "Id"
FROM accounts AS a
WHERE a.user_id = @__userId_0
2022-09-21 17:44:01.012 +01:00 [INF] Executed DbCommand (4ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a.balance AS "Balance", a.created_at AS "CreatedAt", a.currency AS "Currency", a.id AS "Id"
FROM accounts AS a
WHERE a.user_id = @__userId_0
2022-09-21 17:44:01.020 +01:00 [DBG] A data reader was disposed.
2022-09-21 17:44:01.022 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 17:44:01.023 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-21 17:44:01.025 +01:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2022-09-21 17:44:01.027 +01:00 [DBG] Attempting to select an output formatter based on Accept header '["text/plain"]'.
2022-09-21 17:44:01.028 +01:00 [DBG] Could not find an output formatter based on content negotiation. Accepted types were (["text/plain"])
2022-09-21 17:44:01.029 +01:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2022-09-21 17:44:01.029 +01:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2022-09-21 17:44:01.030 +01:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2022-09-21 17:44:01.031 +01:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[APIBank.Models.Accounts.AccountRe, APIBank, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2022-09-21 17:44:01.036 +01:00 [INF] Executed action APIBank.Controllers.AccountsController.GetAllFromUser (APIBank) in 43.5812ms
2022-09-21 17:44:01.039 +01:00 [INF] Executed endpoint 'APIBank.Controllers.AccountsController.GetAllFromUser (APIBank)'
2022-09-21 17:44:01.043 +01:00 [DBG] 'PostgresContext' disposed.
2022-09-21 17:44:01.045 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/api/Accounts/GetAll - - - 200 - application/json;+charset=utf-8 178.8988ms
2022-09-21 17:44:08.200 +01:00 [INF] Request starting HTTP/2 POST https://localhost:7036/api/Users/revoke-token application/json 17
2022-09-21 17:44:08.203 +01:00 [DBG] 1 candidate(s) found for the request path '/api/Users/revoke-token'
2022-09-21 17:44:08.205 +01:00 [DBG] Endpoint 'APIBank.Controllers.UsersController.RevokeToken (APIBank)' with route pattern 'api/Users/revoke-token' is valid for the request path '/api/Users/revoke-token'
2022-09-21 17:44:08.207 +01:00 [DBG] Request matched endpoint 'APIBank.Controllers.UsersController.RevokeToken (APIBank)'
2022-09-21 17:44:08.209 +01:00 [DBG] Static files was skipped as the request already matched an endpoint.
2022-09-21 17:44:08.302 +01:00 [INF] Entity Framework Core 6.0.9 initialized 'PostgresContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:6.0.7+5b98e4b74de93b590b44aef8dd7967c03acc433c' with options: None
2022-09-21 17:44:08.309 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-21 17:44:08.310 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2022-09-21 17:44:08.311 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-21 17:44:08.311 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 17:44:08.312 +01:00 [DBG] Executing DbCommand [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.id = @__p_0
LIMIT 1
2022-09-21 17:44:08.317 +01:00 [INF] Executed DbCommand (4ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.id = @__p_0
LIMIT 1
2022-09-21 17:44:08.319 +01:00 [DBG] Context 'PostgresContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 17:44:08.320 +01:00 [DBG] A data reader was disposed.
2022-09-21 17:44:08.320 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 17:44:08.321 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-21 17:44:08.322 +01:00 [INF] Executing endpoint 'APIBank.Controllers.UsersController.RevokeToken (APIBank)'
2022-09-21 17:44:08.323 +01:00 [INF] Route matched with {action = "RevokeToken", controller = "Users"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult RevokeToken(APIBank.Models.Users.Requests.RevokeTokenRequest) on controller APIBank.Controllers.UsersController (APIBank).
2022-09-21 17:44:08.328 +01:00 [DBG] Execution plan of authorization filters (in the following order): ["APIBank.Authorization.AuthorizeAttribute"]
2022-09-21 17:44:08.329 +01:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2022-09-21 17:44:08.330 +01:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2022-09-21 17:44:08.331 +01:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2022-09-21 17:44:08.333 +01:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2022-09-21 17:44:08.335 +01:00 [DBG] Executing controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-21 17:44:08.336 +01:00 [DBG] Executed controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-21 17:44:08.337 +01:00 [DBG] Attempting to bind parameter 'model' of type 'APIBank.Models.Users.Requests.RevokeTokenRequest' ...
2022-09-21 17:44:08.338 +01:00 [DBG] Attempting to bind parameter 'model' of type 'APIBank.Models.Users.Requests.RevokeTokenRequest' using the name '' in request data ...
2022-09-21 17:44:08.338 +01:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2022-09-21 17:44:08.341 +01:00 [DBG] Connection id "0HMKRU1D55BBP", Request id "0HMKRU1D55BBP:0000000D": started reading request body.
2022-09-21 17:44:08.341 +01:00 [DBG] Connection id "0HMKRU1D55BBP", Request id "0HMKRU1D55BBP:0000000D": done reading request body.
2022-09-21 17:44:08.342 +01:00 [DBG] JSON input formatter succeeded, deserializing to type 'APIBank.Models.Users.Requests.RevokeTokenRequest'
2022-09-21 17:44:08.343 +01:00 [DBG] Done attempting to bind parameter 'model' of type 'APIBank.Models.Users.Requests.RevokeTokenRequest'.
2022-09-21 17:44:08.344 +01:00 [DBG] Done attempting to bind parameter 'model' of type 'APIBank.Models.Users.Requests.RevokeTokenRequest'.
2022-09-21 17:44:08.345 +01:00 [DBG] Attempting to validate the bound parameter 'model' of type 'APIBank.Models.Users.Requests.RevokeTokenRequest' ...
2022-09-21 17:44:08.346 +01:00 [DBG] Done attempting to validate the bound parameter 'model' of type 'APIBank.Models.Users.Requests.RevokeTokenRequest'.
2022-09-21 17:44:08.351 +01:00 [INF] Executed action APIBank.Controllers.UsersController.RevokeToken (APIBank) in 16.6949ms
2022-09-21 17:44:08.356 +01:00 [INF] Executed endpoint 'APIBank.Controllers.UsersController.RevokeToken (APIBank)'
2022-09-21 17:44:08.357 +01:00 [INF] Global Error was found:
2022-09-21 17:44:08.359 +01:00 [DBG] 'PostgresContext' disposed.
2022-09-21 17:44:08.360 +01:00 [INF] Request finished HTTP/2 POST https://localhost:7036/api/Users/revoke-token application/json 17 - 400 - application/json 159.8536ms
2022-09-21 17:44:25.450 +01:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2022-09-21 17:44:25.534 +01:00 [DBG] Hosting starting
2022-09-21 17:44:25.621 +01:00 [DBG] Using development certificate: CN=localhost (Thumbprint: 9CC642E9838495A6C3C202DECA6A8AD300396DD2)
2022-09-21 17:44:25.664 +01:00 [INF] Now listening on: https://localhost:7036
2022-09-21 17:44:25.667 +01:00 [INF] Now listening on: http://localhost:5036
2022-09-21 17:44:25.669 +01:00 [DBG] Loaded hosting startup assembly APIBank
2022-09-21 17:44:25.670 +01:00 [DBG] Loaded hosting startup assembly Microsoft.AspNetCore.Watch.BrowserRefresh
2022-09-21 17:44:25.670 +01:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.BrowserLink.Net
2022-09-21 17:44:25.671 +01:00 [INF] Application started. Press Ctrl+C to shut down.
2022-09-21 17:44:25.672 +01:00 [INF] Hosting environment: Development
2022-09-21 17:44:25.672 +01:00 [INF] Content root path: C:\Users\mguedesa\OneDrive - NTT DATA EMEAL\Documentos\GitHub\OpenBankAPI-NTT\APIBank\APIBank\
2022-09-21 17:44:25.673 +01:00 [DBG] Hosting started
2022-09-21 17:44:25.690 +01:00 [DBG] Connection id "0HMKRU25JRKI6" accepted.
2022-09-21 17:44:25.690 +01:00 [DBG] Connection id "0HMKRU25JRKI7" accepted.
2022-09-21 17:44:25.691 +01:00 [DBG] Connection id "0HMKRU25JRKI6" started.
2022-09-21 17:44:25.692 +01:00 [DBG] Connection id "0HMKRU25JRKI7" started.
2022-09-21 17:44:25.696 +01:00 [DBG] Connection id "0HMKRU25JRKI7" received FIN.
2022-09-21 17:44:25.696 +01:00 [DBG] Connection id "0HMKRU25JRKI6" received FIN.
2022-09-21 17:44:25.707 +01:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException:  Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveBlobAsync[TIOAdapter](TIOAdapter adapter)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](TIOAdapter adapter, Boolean receiveFirst, Byte[] reAuthenticationData, Boolean isApm)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2022-09-21 17:44:25.707 +01:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException:  Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveBlobAsync[TIOAdapter](TIOAdapter adapter)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](TIOAdapter adapter, Boolean receiveFirst, Byte[] reAuthenticationData, Boolean isApm)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2022-09-21 17:44:25.719 +01:00 [DBG] Connection id "0HMKRU25JRKI8" accepted.
2022-09-21 17:44:25.733 +01:00 [DBG] Connection id "0HMKRU25JRKI8" started.
2022-09-21 17:44:25.733 +01:00 [DBG] Connection id "0HMKRU25JRKI6" stopped.
2022-09-21 17:44:25.733 +01:00 [DBG] Connection id "0HMKRU25JRKI7" stopped.
2022-09-21 17:44:25.735 +01:00 [DBG] Connection id "0HMKRU25JRKI6" sending FIN because: "The Socket transport's send loop completed gracefully."
2022-09-21 17:44:25.735 +01:00 [DBG] Connection id "0HMKRU25JRKI7" sending FIN because: "The Socket transport's send loop completed gracefully."
2022-09-21 17:44:25.764 +01:00 [DBG] Connection 0HMKRU25JRKI8 established using the following protocol: "Tls12"
2022-09-21 17:44:25.804 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/swagger/index.html - -
2022-09-21 17:44:25.823 +01:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2022-09-21 17:44:25.838 +01:00 [DBG] No candidates found for the request path '/swagger/index.html'
2022-09-21 17:44:25.840 +01:00 [DBG] Request did not match any endpoints
2022-09-21 17:44:25.902 +01:00 [DBG] Response markup is scheduled to include browser refresh script injection.
2022-09-21 17:44:25.974 +01:00 [DBG] Response markup was updated to include browser refresh script injection.
2022-09-21 17:44:25.978 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/swagger/index.html - - - 200 - text/html;charset=utf-8 178.4023ms
2022-09-21 17:44:26.001 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/_framework/aspnetcore-browser-refresh.js - -
2022-09-21 17:44:26.001 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/_vs/browserLink - -
2022-09-21 17:44:26.008 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/_framework/aspnetcore-browser-refresh.js - - - 200 11984 application/javascript;+charset=utf-8 7.1858ms
2022-09-21 17:44:26.027 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/_vs/browserLink - - - 200 - text/javascript;+charset=UTF-8 26.2381ms
2022-09-21 17:44:26.114 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/swagger/v1/swagger.json - -
2022-09-21 17:44:26.116 +01:00 [DBG] No candidates found for the request path '/swagger/v1/swagger.json'
2022-09-21 17:44:26.116 +01:00 [DBG] Request did not match any endpoints
2022-09-21 17:44:26.240 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/swagger/v1/swagger.json - - - 200 - application/json;charset=utf-8 126.2970ms
2022-09-21 17:44:41.505 +01:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2022-09-21 17:44:41.688 +01:00 [DBG] Hosting starting
2022-09-21 17:44:41.909 +01:00 [DBG] Using development certificate: CN=localhost (Thumbprint: 9CC642E9838495A6C3C202DECA6A8AD300396DD2)
2022-09-21 17:44:41.981 +01:00 [INF] Now listening on: https://localhost:7036
2022-09-21 17:44:41.986 +01:00 [INF] Now listening on: http://localhost:5036
2022-09-21 17:44:41.987 +01:00 [DBG] Loaded hosting startup assembly APIBank
2022-09-21 17:44:41.988 +01:00 [DBG] Loaded hosting startup assembly Microsoft.AspNetCore.Watch.BrowserRefresh
2022-09-21 17:44:41.989 +01:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.BrowserLink.Net
2022-09-21 17:44:41.990 +01:00 [INF] Application started. Press Ctrl+C to shut down.
2022-09-21 17:44:41.992 +01:00 [INF] Hosting environment: Development
2022-09-21 17:44:41.992 +01:00 [INF] Content root path: C:\Users\mguedesa\OneDrive - NTT DATA EMEAL\Documentos\GitHub\OpenBankAPI-NTT\APIBank\APIBank\
2022-09-21 17:44:41.993 +01:00 [DBG] Hosting started
2022-09-21 17:44:42.355 +01:00 [DBG] Connection id "0HMKRU2AIPU8B" received FIN.
2022-09-21 17:44:42.355 +01:00 [DBG] Connection id "0HMKRU2AIPU8A" received FIN.
2022-09-21 17:44:42.366 +01:00 [DBG] Connection id "0HMKRU2AIPU8A" accepted.
2022-09-21 17:44:42.366 +01:00 [DBG] Connection id "0HMKRU2AIPU8B" accepted.
2022-09-21 17:44:42.369 +01:00 [DBG] Connection id "0HMKRU2AIPU8A" started.
2022-09-21 17:44:42.369 +01:00 [DBG] Connection id "0HMKRU2AIPU8B" started.
2022-09-21 17:44:42.391 +01:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException:  Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveBlobAsync[TIOAdapter](TIOAdapter adapter)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](TIOAdapter adapter, Boolean receiveFirst, Byte[] reAuthenticationData, Boolean isApm)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2022-09-21 17:44:42.391 +01:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException:  Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveBlobAsync[TIOAdapter](TIOAdapter adapter)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](TIOAdapter adapter, Boolean receiveFirst, Byte[] reAuthenticationData, Boolean isApm)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2022-09-21 17:44:42.454 +01:00 [DBG] Connection id "0HMKRU2AIPU8A" stopped.
2022-09-21 17:44:42.454 +01:00 [DBG] Connection id "0HMKRU2AIPU8B" stopped.
2022-09-21 17:44:42.469 +01:00 [DBG] Connection id "0HMKRU2AIPU8B" sending FIN because: "The Socket transport's send loop completed gracefully."
2022-09-21 17:44:42.469 +01:00 [DBG] Connection id "0HMKRU2AIPU8A" sending FIN because: "The Socket transport's send loop completed gracefully."
2022-09-21 17:44:42.520 +01:00 [DBG] Connection id "0HMKRU2AIPU8C" accepted.
2022-09-21 17:44:42.524 +01:00 [DBG] Connection id "0HMKRU2AIPU8C" started.
2022-09-21 17:44:42.579 +01:00 [DBG] Connection 0HMKRU2AIPU8C established using the following protocol: "Tls12"
2022-09-21 17:44:42.663 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/swagger/index.html - -
2022-09-21 17:44:42.710 +01:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2022-09-21 17:44:42.737 +01:00 [DBG] No candidates found for the request path '/swagger/index.html'
2022-09-21 17:44:42.738 +01:00 [DBG] Request did not match any endpoints
2022-09-21 17:44:42.847 +01:00 [DBG] Response markup is scheduled to include browser refresh script injection.
2022-09-21 17:44:42.996 +01:00 [DBG] Response markup was updated to include browser refresh script injection.
2022-09-21 17:44:43.007 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/swagger/index.html - - - 200 - text/html;charset=utf-8 346.3638ms
2022-09-21 17:44:43.031 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/_vs/browserLink - -
2022-09-21 17:44:43.031 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/_framework/aspnetcore-browser-refresh.js - -
2022-09-21 17:44:43.040 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/_framework/aspnetcore-browser-refresh.js - - - 200 11984 application/javascript;+charset=utf-8 8.4618ms
2022-09-21 17:44:43.084 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/_vs/browserLink - - - 200 - text/javascript;+charset=UTF-8 52.2235ms
2022-09-21 17:44:43.146 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/swagger/v1/swagger.json - -
2022-09-21 17:44:43.147 +01:00 [DBG] No candidates found for the request path '/swagger/v1/swagger.json'
2022-09-21 17:44:43.149 +01:00 [DBG] Request did not match any endpoints
2022-09-21 17:44:43.339 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/swagger/v1/swagger.json - - - 200 - application/json;charset=utf-8 192.7513ms
2022-09-21 17:45:00.360 +01:00 [INF] Request starting HTTP/2 POST https://localhost:7036/api/Users/Login application/json 58
2022-09-21 17:45:00.383 +01:00 [DBG] 1 candidate(s) found for the request path '/api/Users/Login'
2022-09-21 17:45:00.394 +01:00 [DBG] Endpoint 'APIBank.Controllers.UsersController.Login (APIBank)' with route pattern 'api/Users/Login' is valid for the request path '/api/Users/Login'
2022-09-21 17:45:00.397 +01:00 [DBG] Request matched endpoint 'APIBank.Controllers.UsersController.Login (APIBank)'
2022-09-21 17:45:00.404 +01:00 [DBG] Static files was skipped as the request already matched an endpoint.
2022-09-21 17:45:00.846 +01:00 [INF] Executing endpoint 'APIBank.Controllers.UsersController.Login (APIBank)'
2022-09-21 17:45:00.876 +01:00 [INF] Route matched with {action = "Login", controller = "Users"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult Login(APIBank.Models.Requests.LoginRequest) on controller APIBank.Controllers.UsersController (APIBank).
2022-09-21 17:45:00.880 +01:00 [DBG] Execution plan of authorization filters (in the following order): ["APIBank.Authorization.AuthorizeAttribute"]
2022-09-21 17:45:00.882 +01:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2022-09-21 17:45:00.883 +01:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2022-09-21 17:45:00.886 +01:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2022-09-21 17:45:00.887 +01:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2022-09-21 17:45:00.889 +01:00 [DBG] Executing controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-21 17:45:00.890 +01:00 [DBG] Executed controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-21 17:45:00.908 +01:00 [DBG] Attempting to bind parameter 'model' of type 'APIBank.Models.Requests.LoginRequest' ...
2022-09-21 17:45:00.912 +01:00 [DBG] Attempting to bind parameter 'model' of type 'APIBank.Models.Requests.LoginRequest' using the name '' in request data ...
2022-09-21 17:45:00.914 +01:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2022-09-21 17:45:00.921 +01:00 [DBG] Connection id "0HMKRU2AIPU8C", Request id "0HMKRU2AIPU8C:00000009": started reading request body.
2022-09-21 17:45:00.922 +01:00 [DBG] Connection id "0HMKRU2AIPU8C", Request id "0HMKRU2AIPU8C:00000009": done reading request body.
2022-09-21 17:45:00.928 +01:00 [DBG] JSON input formatter succeeded, deserializing to type 'APIBank.Models.Requests.LoginRequest'
2022-09-21 17:45:00.929 +01:00 [DBG] Done attempting to bind parameter 'model' of type 'APIBank.Models.Requests.LoginRequest'.
2022-09-21 17:45:00.930 +01:00 [DBG] Done attempting to bind parameter 'model' of type 'APIBank.Models.Requests.LoginRequest'.
2022-09-21 17:45:00.931 +01:00 [DBG] Attempting to validate the bound parameter 'model' of type 'APIBank.Models.Requests.LoginRequest' ...
2022-09-21 17:45:00.939 +01:00 [DBG] Done attempting to validate the bound parameter 'model' of type 'APIBank.Models.Requests.LoginRequest'.
2022-09-21 17:45:01.109 +01:00 [DBG] An additional 'IServiceProvider' was created for internal use by Entity Framework. An existing service provider was not used due to the following configuration changes: configuration changed for 'Core:ConfigureWarnings', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:UseAdminDatabase', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:SetPostgresVersion', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:UseRedshift', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:ReverseNullOrdering', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:RemoteCertificateValidationCallback', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:ProvideClientCertificatesCallback', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:ProvidePasswordCallback'.
2022-09-21 17:45:02.635 +01:00 [INF] Entity Framework Core 6.0.9 initialized 'PostgresContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:6.0.7+5b98e4b74de93b590b44aef8dd7967c03acc433c' with options: None
2022-09-21 17:45:02.728 +01:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .SingleOrDefault(x => x.Username == __model_Username_0)'
2022-09-21 17:45:03.305 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<User>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: User.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: User.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 1], [Property: User.Email (string) Required Index MaxLength(254), 2], [Property: User.FullName (string) Required MaxLength(100), 3], [Property: User.PasswordChangedAt (DateTime) Required ValueGenerated.OnAdd, 4], [Property: User.PasswordHash (string) Required MaxLength(200), 5], [Property: User.Username (string) Required Index MaxLength(50), 6] }
        SELECT TOP(2) u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
        FROM users AS u
        WHERE u.username == @__model_Username_0), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, User>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)
    .SingleOrDefault()'
2022-09-21 17:45:03.375 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-21 17:45:03.481 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (102ms).
2022-09-21 17:45:03.497 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-21 17:45:03.833 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 17:45:03.858 +01:00 [DBG] Executing DbCommand [Parameters=[@__model_Username_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.username = @__model_Username_0
LIMIT 2
2022-09-21 17:45:04.010 +01:00 [INF] Executed DbCommand (158ms) [Parameters=[@__model_Username_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.username = @__model_Username_0
LIMIT 2
2022-09-21 17:45:04.113 +01:00 [DBG] Context 'PostgresContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 17:45:04.201 +01:00 [DBG] A data reader was disposed.
2022-09-21 17:45:04.209 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 17:45:04.220 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-21 17:45:04.727 +01:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .Any(user => user.RefreshTokenCollection
        .Any(reftoken => reftoken.RefToken == __token_0))'
2022-09-21 17:45:04.878 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<bool>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            EmptyProjectionMember -> 0
        SELECT EXISTS (
            SELECT 1
            FROM users AS u
            WHERE EXISTS (
                SELECT 1
                FROM refresh_token AS r
                WHERE ((u.id != NULL) && (u.id == r.user_id)) && (r.token == @__token_0)))), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, bool>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)
    .Single()'
2022-09-21 17:45:04.893 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-21 17:45:04.894 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2022-09-21 17:45:04.895 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-21 17:45:04.896 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 17:45:04.899 +01:00 [DBG] Executing DbCommand [Parameters=[@__token_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM users AS u
    WHERE EXISTS (
        SELECT 1
        FROM refresh_token AS r
        WHERE (u.id = r.user_id) AND (r.token = @__token_0)))
2022-09-21 17:45:04.903 +01:00 [INF] Executed DbCommand (5ms) [Parameters=[@__token_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM users AS u
    WHERE EXISTS (
        SELECT 1
        FROM refresh_token AS r
        WHERE (u.id = r.user_id) AND (r.token = @__token_0)))
2022-09-21 17:45:04.907 +01:00 [DBG] A data reader was disposed.
2022-09-21 17:45:04.908 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 17:45:04.910 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-21 17:45:04.923 +01:00 [DBG] Compiling query expression: 
'DbSet<RefreshToken>()
    .Where(rt => rt.UserId == __id_0)
    .AsNoTracking()
    .Select(rt => new RefreshToken{ 
        Id = rt.Id, 
        UserId = rt.UserId, 
        RefToken = rt.RefToken, 
        Expires = rt.Expires, 
        Created = rt.Created, 
        CreatedByIp = rt.CreatedByIp, 
        Revoked = rt.Revoked, 
        RevokedByIp = rt.RevokedByIp, 
        ReplacedByToken = rt.ReplacedByToken, 
        ReasonRevoked = rt.ReasonRevoked, 
        IsExpired = rt.IsExpired, 
        IsRevoked = rt.IsRevoked, 
        IsActive = rt.IsActive 
    }
    )'
2022-09-21 17:45:04.954 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<RefreshToken>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            Id -> 0
            UserId -> 1
            RefToken -> 2
            Expires -> 3
            Created -> 4
            CreatedByIp -> 5
            Revoked -> 6
            RevokedByIp -> 7
            ReplacedByToken -> 8
            ReasonRevoked -> 9
            IsExpired -> 10
            IsRevoked -> 11
            IsActive -> 12
        SELECT r.id AS Id, r.user_id AS UserId, r.token AS RefToken, r.expires AS Expires, r.created AS Created, r.created_by_ip AS CreatedByIp, r.revoked AS Revoked, r.revoked_by_ip AS RevokedByIp, r.replaced_by_token AS ReplacedByToken, r.reason_revoked AS ReasonRevoked, r.is_expired AS IsExpired, r.is_revoked AS IsRevoked, r.is_active AS IsActive
        FROM refresh_token AS r
        WHERE r.user_id == @__id_0), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, RefreshToken>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)'
2022-09-21 17:45:04.959 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-21 17:45:04.960 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2022-09-21 17:45:04.961 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-21 17:45:04.962 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 17:45:04.963 +01:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.user_id AS "UserId", r.token AS "RefToken", r.expires AS "Expires", r.created AS "Created", r.created_by_ip AS "CreatedByIp", r.revoked AS "Revoked", r.revoked_by_ip AS "RevokedByIp", r.replaced_by_token AS "ReplacedByToken", r.reason_revoked AS "ReasonRevoked", r.is_expired AS "IsExpired", r.is_revoked AS "IsRevoked", r.is_active AS "IsActive"
FROM refresh_token AS r
WHERE r.user_id = @__id_0
2022-09-21 17:45:04.974 +01:00 [INF] Executed DbCommand (11ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.user_id AS "UserId", r.token AS "RefToken", r.expires AS "Expires", r.created AS "Created", r.created_by_ip AS "CreatedByIp", r.revoked AS "Revoked", r.revoked_by_ip AS "RevokedByIp", r.replaced_by_token AS "ReplacedByToken", r.reason_revoked AS "ReasonRevoked", r.is_expired AS "IsExpired", r.is_revoked AS "IsRevoked", r.is_active AS "IsActive"
FROM refresh_token AS r
WHERE r.user_id = @__id_0
2022-09-21 17:45:04.978 +01:00 [DBG] A data reader was disposed.
2022-09-21 17:45:04.979 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 17:45:04.982 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-21 17:45:05.001 +01:00 [DBG] An entity of type 'User' tracked by 'PostgresContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 17:45:05.045 +01:00 [DBG] 'PostgresContext' generated a temporary value for the property 'Id.RefreshToken'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 17:45:05.101 +01:00 [DBG] Context 'PostgresContext' started tracking 'RefreshToken' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 17:45:05.108 +01:00 [DBG] SaveChanges starting for 'PostgresContext'.
2022-09-21 17:45:05.115 +01:00 [DBG] DetectChanges starting for 'PostgresContext'.
2022-09-21 17:45:05.158 +01:00 [DBG] 1 entities were added and 0 entities were removed from navigation 'User.RefreshTokenCollection'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 17:45:05.184 +01:00 [DBG] The foreign key property 'RefreshToken.UserId' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2022-09-21 17:45:05.216 +01:00 [DBG] DetectChanges completed for 'PostgresContext'.
2022-09-21 17:45:05.231 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-21 17:45:05.233 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 17:45:05.238 +01:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2022-09-21 17:45:05.248 +01:00 [DBG] Began transaction with isolation level 'ReadCommitted'.
2022-09-21 17:45:05.314 +01:00 [DBG] Executing 2 update commands as a batch.
2022-09-21 17:45:05.336 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-21 17:45:05.338 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (2ms).
2022-09-21 17:45:05.339 +01:00 [DBG] Executing DbCommand [Parameters=[@p0='?' (DbType = DateTime), @p1='?', @p2='?' (DbType = DateTime), @p3='?' (DbType = Boolean), @p4='?' (DbType = Boolean), @p5='?' (DbType = Boolean), @p6='?', @p7='?', @p8='?', @p9='?' (DbType = DateTime), @p10='?', @p11='?' (DbType = Int32), @p18='?' (DbType = Int32), @p12='?' (DbType = DateTime), @p13='?', @p14='?', @p15='?' (DbType = DateTime), @p16='?', @p17='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO refresh_token (created, created_by_ip, expires, is_active, is_expired, is_revoked, reason_revoked, token, replaced_by_token, revoked, revoked_by_ip, user_id)
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11)
RETURNING id;
UPDATE users SET created_at = @p12, email = @p13, full_name = @p14, password_changed_at = @p15, password_hash = @p16, username = @p17
WHERE id = @p18;
2022-09-21 17:45:05.352 +01:00 [INF] Executed DbCommand (13ms) [Parameters=[@p0='?' (DbType = DateTime), @p1='?', @p2='?' (DbType = DateTime), @p3='?' (DbType = Boolean), @p4='?' (DbType = Boolean), @p5='?' (DbType = Boolean), @p6='?', @p7='?', @p8='?', @p9='?' (DbType = DateTime), @p10='?', @p11='?' (DbType = Int32), @p18='?' (DbType = Int32), @p12='?' (DbType = DateTime), @p13='?', @p14='?', @p15='?' (DbType = DateTime), @p16='?', @p17='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO refresh_token (created, created_by_ip, expires, is_active, is_expired, is_revoked, reason_revoked, token, replaced_by_token, revoked, revoked_by_ip, user_id)
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11)
RETURNING id;
UPDATE users SET created_at = @p12, email = @p13, full_name = @p14, password_changed_at = @p15, password_hash = @p16, username = @p17
WHERE id = @p18;
2022-09-21 17:45:05.373 +01:00 [DBG] The foreign key property 'RefreshToken.Id' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2022-09-21 17:45:05.379 +01:00 [DBG] A data reader was disposed.
2022-09-21 17:45:05.387 +01:00 [DBG] Committing transaction.
2022-09-21 17:45:05.403 +01:00 [DBG] Committed transaction.
2022-09-21 17:45:05.405 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 17:45:05.408 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-21 17:45:05.411 +01:00 [DBG] Disposing transaction.
2022-09-21 17:45:05.417 +01:00 [DBG] An entity of type 'RefreshToken' tracked by 'PostgresContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 17:45:05.420 +01:00 [DBG] An entity of type 'User' tracked by 'PostgresContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 17:45:05.425 +01:00 [DBG] SaveChanges completed for 'PostgresContext' with 2 entities written to the database.
2022-09-21 17:45:05.433 +01:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2022-09-21 17:45:05.439 +01:00 [DBG] Attempting to select an output formatter based on Accept header '["text/plain"]'.
2022-09-21 17:45:05.440 +01:00 [DBG] Could not find an output formatter based on content negotiation. Accepted types were (["text/plain"])
2022-09-21 17:45:05.441 +01:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2022-09-21 17:45:05.442 +01:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2022-09-21 17:45:05.443 +01:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2022-09-21 17:45:05.444 +01:00 [INF] Executing OkObjectResult, writing value of type 'APIBank.Models.Users.Responses.LoginResponse'.
2022-09-21 17:45:05.469 +01:00 [INF] Executed action APIBank.Controllers.UsersController.Login (APIBank) in 4569.5876ms
2022-09-21 17:45:05.472 +01:00 [INF] Executed endpoint 'APIBank.Controllers.UsersController.Login (APIBank)'
2022-09-21 17:45:05.477 +01:00 [DBG] 'PostgresContext' disposed.
2022-09-21 17:45:05.488 +01:00 [INF] Request finished HTTP/2 POST https://localhost:7036/api/Users/Login application/json 58 - 200 - application/json;+charset=utf-8 5128.0168ms
2022-09-21 17:45:23.972 +01:00 [INF] Request starting HTTP/2 POST https://localhost:7036/api/Users/revoke-token application/json 15
2022-09-21 17:45:23.979 +01:00 [DBG] 1 candidate(s) found for the request path '/api/Users/revoke-token'
2022-09-21 17:45:23.981 +01:00 [DBG] Endpoint 'APIBank.Controllers.UsersController.RevokeToken (APIBank)' with route pattern 'api/Users/revoke-token' is valid for the request path '/api/Users/revoke-token'
2022-09-21 17:45:23.989 +01:00 [DBG] Request matched endpoint 'APIBank.Controllers.UsersController.RevokeToken (APIBank)'
2022-09-21 17:45:23.990 +01:00 [DBG] Static files was skipped as the request already matched an endpoint.
2022-09-21 17:45:24.124 +01:00 [INF] Executing endpoint 'APIBank.Controllers.UsersController.RevokeToken (APIBank)'
2022-09-21 17:45:24.127 +01:00 [INF] Route matched with {action = "RevokeToken", controller = "Users"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult RevokeToken(APIBank.Models.Users.Requests.RevokeTokenRequest) on controller APIBank.Controllers.UsersController (APIBank).
2022-09-21 17:45:24.129 +01:00 [DBG] Execution plan of authorization filters (in the following order): ["APIBank.Authorization.AuthorizeAttribute"]
2022-09-21 17:45:24.130 +01:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2022-09-21 17:45:24.131 +01:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2022-09-21 17:45:24.133 +01:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2022-09-21 17:45:24.135 +01:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2022-09-21 17:45:24.140 +01:00 [INF] Authorization failed for the request at filter 'APIBank.Authorization.AuthorizeAttribute'.
2022-09-21 17:45:24.143 +01:00 [INF] Executing JsonResult, writing value of type '<>f__AnonymousType0`1[[System.String, System.Private.CoreLib, Version=6.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2022-09-21 17:45:24.145 +01:00 [INF] Executed action APIBank.Controllers.UsersController.RevokeToken (APIBank) in 5.2364ms
2022-09-21 17:45:24.146 +01:00 [INF] Executed endpoint 'APIBank.Controllers.UsersController.RevokeToken (APIBank)'
2022-09-21 17:45:24.147 +01:00 [INF] Request finished HTTP/2 POST https://localhost:7036/api/Users/revoke-token application/json 15 - 401 - application/json;+charset=utf-8 175.0156ms
2022-09-21 17:45:24.148 +01:00 [DBG] Connection id "0HMKRU2AIPU8C", Request id "0HMKRU2AIPU8C:0000000B": started reading request body.
2022-09-21 17:45:24.149 +01:00 [DBG] Connection id "0HMKRU2AIPU8C", Request id "0HMKRU2AIPU8C:0000000B": done reading request body.
2022-09-21 17:45:32.875 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/api/Accounts/GetAll - -
2022-09-21 17:45:32.881 +01:00 [DBG] 1 candidate(s) found for the request path '/api/Accounts/GetAll'
2022-09-21 17:45:32.883 +01:00 [DBG] Endpoint 'APIBank.Controllers.AccountsController.GetAllFromUser (APIBank)' with route pattern 'api/Accounts/GetAll' is valid for the request path '/api/Accounts/GetAll'
2022-09-21 17:45:32.886 +01:00 [DBG] Request matched endpoint 'APIBank.Controllers.AccountsController.GetAllFromUser (APIBank)'
2022-09-21 17:45:32.888 +01:00 [DBG] Static files was skipped as the request already matched an endpoint.
2022-09-21 17:45:32.915 +01:00 [INF] Executing endpoint 'APIBank.Controllers.AccountsController.GetAllFromUser (APIBank)'
2022-09-21 17:45:32.918 +01:00 [INF] Route matched with {action = "GetAllFromUser", controller = "Accounts"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult GetAllFromUser() on controller APIBank.Controllers.AccountsController (APIBank).
2022-09-21 17:45:32.919 +01:00 [DBG] Execution plan of authorization filters (in the following order): ["APIBank.Authorization.AuthorizeAttribute"]
2022-09-21 17:45:32.921 +01:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2022-09-21 17:45:32.922 +01:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2022-09-21 17:45:32.923 +01:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2022-09-21 17:45:32.928 +01:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2022-09-21 17:45:32.929 +01:00 [INF] Authorization failed for the request at filter 'APIBank.Authorization.AuthorizeAttribute'.
2022-09-21 17:45:32.930 +01:00 [INF] Executing JsonResult, writing value of type '<>f__AnonymousType0`1[[System.String, System.Private.CoreLib, Version=6.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2022-09-21 17:45:32.931 +01:00 [INF] Executed action APIBank.Controllers.AccountsController.GetAllFromUser (APIBank) in 1.7539ms
2022-09-21 17:45:32.932 +01:00 [INF] Executed endpoint 'APIBank.Controllers.AccountsController.GetAllFromUser (APIBank)'
2022-09-21 17:45:32.933 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/api/Accounts/GetAll - - - 401 - application/json;+charset=utf-8 57.2782ms
2022-09-21 17:45:38.803 +01:00 [INF] Request starting HTTP/2 POST https://localhost:7036/api/Users/Login application/json 58
2022-09-21 17:45:38.806 +01:00 [DBG] 1 candidate(s) found for the request path '/api/Users/Login'
2022-09-21 17:45:38.808 +01:00 [DBG] Endpoint 'APIBank.Controllers.UsersController.Login (APIBank)' with route pattern 'api/Users/Login' is valid for the request path '/api/Users/Login'
2022-09-21 17:45:38.810 +01:00 [DBG] Request matched endpoint 'APIBank.Controllers.UsersController.Login (APIBank)'
2022-09-21 17:45:38.811 +01:00 [DBG] Static files was skipped as the request already matched an endpoint.
2022-09-21 17:45:38.844 +01:00 [INF] Executing endpoint 'APIBank.Controllers.UsersController.Login (APIBank)'
2022-09-21 17:45:38.846 +01:00 [INF] Route matched with {action = "Login", controller = "Users"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult Login(APIBank.Models.Requests.LoginRequest) on controller APIBank.Controllers.UsersController (APIBank).
2022-09-21 17:45:38.849 +01:00 [DBG] Execution plan of authorization filters (in the following order): ["APIBank.Authorization.AuthorizeAttribute"]
2022-09-21 17:45:38.852 +01:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2022-09-21 17:45:38.854 +01:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2022-09-21 17:45:38.856 +01:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2022-09-21 17:45:38.858 +01:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2022-09-21 17:45:38.859 +01:00 [DBG] Executing controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-21 17:45:38.862 +01:00 [DBG] Executed controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-21 17:45:38.863 +01:00 [DBG] Attempting to bind parameter 'model' of type 'APIBank.Models.Requests.LoginRequest' ...
2022-09-21 17:45:38.864 +01:00 [DBG] Attempting to bind parameter 'model' of type 'APIBank.Models.Requests.LoginRequest' using the name '' in request data ...
2022-09-21 17:45:38.865 +01:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2022-09-21 17:45:38.866 +01:00 [DBG] Connection id "0HMKRU2AIPU8C", Request id "0HMKRU2AIPU8C:0000000F": started reading request body.
2022-09-21 17:45:38.867 +01:00 [DBG] Connection id "0HMKRU2AIPU8C", Request id "0HMKRU2AIPU8C:0000000F": done reading request body.
2022-09-21 17:45:38.868 +01:00 [DBG] JSON input formatter succeeded, deserializing to type 'APIBank.Models.Requests.LoginRequest'
2022-09-21 17:45:38.869 +01:00 [DBG] Done attempting to bind parameter 'model' of type 'APIBank.Models.Requests.LoginRequest'.
2022-09-21 17:45:38.872 +01:00 [DBG] Done attempting to bind parameter 'model' of type 'APIBank.Models.Requests.LoginRequest'.
2022-09-21 17:45:38.874 +01:00 [DBG] Attempting to validate the bound parameter 'model' of type 'APIBank.Models.Requests.LoginRequest' ...
2022-09-21 17:45:38.875 +01:00 [DBG] Done attempting to validate the bound parameter 'model' of type 'APIBank.Models.Requests.LoginRequest'.
2022-09-21 17:45:38.913 +01:00 [INF] Entity Framework Core 6.0.9 initialized 'PostgresContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:6.0.7+5b98e4b74de93b590b44aef8dd7967c03acc433c' with options: None
2022-09-21 17:45:38.917 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-21 17:45:38.918 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2022-09-21 17:45:38.919 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-21 17:45:38.920 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 17:45:38.921 +01:00 [DBG] Executing DbCommand [Parameters=[@__model_Username_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.username = @__model_Username_0
LIMIT 2
2022-09-21 17:45:38.926 +01:00 [INF] Executed DbCommand (5ms) [Parameters=[@__model_Username_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.username = @__model_Username_0
LIMIT 2
2022-09-21 17:45:38.928 +01:00 [DBG] Context 'PostgresContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 17:45:38.929 +01:00 [DBG] A data reader was disposed.
2022-09-21 17:45:38.929 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 17:45:38.930 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-21 17:45:39.143 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-21 17:45:39.147 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (4ms).
2022-09-21 17:45:39.148 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-21 17:45:39.149 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 17:45:39.150 +01:00 [DBG] Executing DbCommand [Parameters=[@__token_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM users AS u
    WHERE EXISTS (
        SELECT 1
        FROM refresh_token AS r
        WHERE (u.id = r.user_id) AND (r.token = @__token_0)))
2022-09-21 17:45:39.152 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[@__token_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM users AS u
    WHERE EXISTS (
        SELECT 1
        FROM refresh_token AS r
        WHERE (u.id = r.user_id) AND (r.token = @__token_0)))
2022-09-21 17:45:39.154 +01:00 [DBG] A data reader was disposed.
2022-09-21 17:45:39.155 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 17:45:39.160 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-21 17:45:39.163 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-21 17:45:39.164 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2022-09-21 17:45:39.165 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-21 17:45:39.166 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 17:45:39.167 +01:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.user_id AS "UserId", r.token AS "RefToken", r.expires AS "Expires", r.created AS "Created", r.created_by_ip AS "CreatedByIp", r.revoked AS "Revoked", r.revoked_by_ip AS "RevokedByIp", r.replaced_by_token AS "ReplacedByToken", r.reason_revoked AS "ReasonRevoked", r.is_expired AS "IsExpired", r.is_revoked AS "IsRevoked", r.is_active AS "IsActive"
FROM refresh_token AS r
WHERE r.user_id = @__id_0
2022-09-21 17:45:39.169 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.user_id AS "UserId", r.token AS "RefToken", r.expires AS "Expires", r.created AS "Created", r.created_by_ip AS "CreatedByIp", r.revoked AS "Revoked", r.revoked_by_ip AS "RevokedByIp", r.replaced_by_token AS "ReplacedByToken", r.reason_revoked AS "ReasonRevoked", r.is_expired AS "IsExpired", r.is_revoked AS "IsRevoked", r.is_active AS "IsActive"
FROM refresh_token AS r
WHERE r.user_id = @__id_0
2022-09-21 17:45:39.178 +01:00 [DBG] A data reader was disposed.
2022-09-21 17:45:39.178 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 17:45:39.180 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-21 17:45:39.180 +01:00 [DBG] An entity of type 'User' tracked by 'PostgresContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 17:45:39.182 +01:00 [DBG] 'PostgresContext' generated a temporary value for the property 'Id.RefreshToken'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 17:45:39.183 +01:00 [DBG] Context 'PostgresContext' started tracking 'RefreshToken' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 17:45:39.184 +01:00 [DBG] SaveChanges starting for 'PostgresContext'.
2022-09-21 17:45:39.185 +01:00 [DBG] DetectChanges starting for 'PostgresContext'.
2022-09-21 17:45:39.186 +01:00 [DBG] 1 entities were added and 0 entities were removed from navigation 'User.RefreshTokenCollection'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 17:45:39.189 +01:00 [DBG] The foreign key property 'RefreshToken.UserId' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2022-09-21 17:45:39.190 +01:00 [DBG] DetectChanges completed for 'PostgresContext'.
2022-09-21 17:45:39.191 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-21 17:45:39.194 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 17:45:39.195 +01:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2022-09-21 17:45:39.196 +01:00 [DBG] Began transaction with isolation level 'ReadCommitted'.
2022-09-21 17:45:39.197 +01:00 [DBG] Executing 2 update commands as a batch.
2022-09-21 17:45:39.197 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-21 17:45:39.198 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2022-09-21 17:45:39.199 +01:00 [DBG] Executing DbCommand [Parameters=[@p0='?' (DbType = DateTime), @p1='?', @p2='?' (DbType = DateTime), @p3='?' (DbType = Boolean), @p4='?' (DbType = Boolean), @p5='?' (DbType = Boolean), @p6='?', @p7='?', @p8='?', @p9='?' (DbType = DateTime), @p10='?', @p11='?' (DbType = Int32), @p18='?' (DbType = Int32), @p12='?' (DbType = DateTime), @p13='?', @p14='?', @p15='?' (DbType = DateTime), @p16='?', @p17='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO refresh_token (created, created_by_ip, expires, is_active, is_expired, is_revoked, reason_revoked, token, replaced_by_token, revoked, revoked_by_ip, user_id)
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11)
RETURNING id;
UPDATE users SET created_at = @p12, email = @p13, full_name = @p14, password_changed_at = @p15, password_hash = @p16, username = @p17
WHERE id = @p18;
2022-09-21 17:45:39.201 +01:00 [INF] Executed DbCommand (3ms) [Parameters=[@p0='?' (DbType = DateTime), @p1='?', @p2='?' (DbType = DateTime), @p3='?' (DbType = Boolean), @p4='?' (DbType = Boolean), @p5='?' (DbType = Boolean), @p6='?', @p7='?', @p8='?', @p9='?' (DbType = DateTime), @p10='?', @p11='?' (DbType = Int32), @p18='?' (DbType = Int32), @p12='?' (DbType = DateTime), @p13='?', @p14='?', @p15='?' (DbType = DateTime), @p16='?', @p17='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO refresh_token (created, created_by_ip, expires, is_active, is_expired, is_revoked, reason_revoked, token, replaced_by_token, revoked, revoked_by_ip, user_id)
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11)
RETURNING id;
UPDATE users SET created_at = @p12, email = @p13, full_name = @p14, password_changed_at = @p15, password_hash = @p16, username = @p17
WHERE id = @p18;
2022-09-21 17:45:39.207 +01:00 [DBG] The foreign key property 'RefreshToken.Id' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2022-09-21 17:45:39.211 +01:00 [DBG] A data reader was disposed.
2022-09-21 17:45:39.212 +01:00 [DBG] Committing transaction.
2022-09-21 17:45:39.213 +01:00 [DBG] Committed transaction.
2022-09-21 17:45:39.213 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 17:45:39.214 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-21 17:45:39.215 +01:00 [DBG] Disposing transaction.
2022-09-21 17:45:39.215 +01:00 [DBG] An entity of type 'RefreshToken' tracked by 'PostgresContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 17:45:39.217 +01:00 [DBG] An entity of type 'User' tracked by 'PostgresContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 17:45:39.220 +01:00 [DBG] SaveChanges completed for 'PostgresContext' with 2 entities written to the database.
2022-09-21 17:45:39.222 +01:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2022-09-21 17:45:39.226 +01:00 [DBG] Attempting to select an output formatter based on Accept header '["text/plain"]'.
2022-09-21 17:45:39.228 +01:00 [DBG] Could not find an output formatter based on content negotiation. Accepted types were (["text/plain"])
2022-09-21 17:45:39.228 +01:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2022-09-21 17:45:39.229 +01:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2022-09-21 17:45:39.229 +01:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2022-09-21 17:45:39.230 +01:00 [INF] Executing OkObjectResult, writing value of type 'APIBank.Models.Users.Responses.LoginResponse'.
2022-09-21 17:45:39.231 +01:00 [INF] Executed action APIBank.Controllers.UsersController.Login (APIBank) in 372.0436ms
2022-09-21 17:45:39.232 +01:00 [INF] Executed endpoint 'APIBank.Controllers.UsersController.Login (APIBank)'
2022-09-21 17:45:39.233 +01:00 [DBG] 'PostgresContext' disposed.
2022-09-21 17:45:39.236 +01:00 [INF] Request finished HTTP/2 POST https://localhost:7036/api/Users/Login application/json 58 - 200 - application/json;+charset=utf-8 433.1703ms
2022-09-21 17:45:52.341 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/api/Accounts/GetAll - -
2022-09-21 17:45:52.344 +01:00 [DBG] 1 candidate(s) found for the request path '/api/Accounts/GetAll'
2022-09-21 17:45:52.345 +01:00 [DBG] Endpoint 'APIBank.Controllers.AccountsController.GetAllFromUser (APIBank)' with route pattern 'api/Accounts/GetAll' is valid for the request path '/api/Accounts/GetAll'
2022-09-21 17:45:52.348 +01:00 [DBG] Request matched endpoint 'APIBank.Controllers.AccountsController.GetAllFromUser (APIBank)'
2022-09-21 17:45:52.350 +01:00 [DBG] Static files was skipped as the request already matched an endpoint.
2022-09-21 17:45:52.438 +01:00 [INF] Entity Framework Core 6.0.9 initialized 'PostgresContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:6.0.7+5b98e4b74de93b590b44aef8dd7967c03acc433c' with options: None
2022-09-21 17:45:52.456 +01:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .FirstOrDefault(e => EF.Property<int>(e, "Id") == __p_0)'
2022-09-21 17:45:52.465 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<User>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: User.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: User.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 1], [Property: User.Email (string) Required Index MaxLength(254), 2], [Property: User.FullName (string) Required MaxLength(100), 3], [Property: User.PasswordChangedAt (DateTime) Required ValueGenerated.OnAdd, 4], [Property: User.PasswordHash (string) Required MaxLength(200), 5], [Property: User.Username (string) Required Index MaxLength(50), 6] }
        SELECT TOP(1) u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
        FROM users AS u
        WHERE u.id == @__p_0), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, User>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)
    .SingleOrDefault()'
2022-09-21 17:45:52.469 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-21 17:45:52.470 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2022-09-21 17:45:52.471 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-21 17:45:52.471 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 17:45:52.472 +01:00 [DBG] Executing DbCommand [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.id = @__p_0
LIMIT 1
2022-09-21 17:45:52.476 +01:00 [INF] Executed DbCommand (3ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.id = @__p_0
LIMIT 1
2022-09-21 17:45:52.479 +01:00 [DBG] Context 'PostgresContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 17:45:52.480 +01:00 [DBG] A data reader was disposed.
2022-09-21 17:45:52.481 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 17:45:52.482 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-21 17:45:52.482 +01:00 [INF] Executing endpoint 'APIBank.Controllers.AccountsController.GetAllFromUser (APIBank)'
2022-09-21 17:45:52.483 +01:00 [INF] Route matched with {action = "GetAllFromUser", controller = "Accounts"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult GetAllFromUser() on controller APIBank.Controllers.AccountsController (APIBank).
2022-09-21 17:45:52.484 +01:00 [DBG] Execution plan of authorization filters (in the following order): ["APIBank.Authorization.AuthorizeAttribute"]
2022-09-21 17:45:52.485 +01:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2022-09-21 17:45:52.486 +01:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2022-09-21 17:45:52.487 +01:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2022-09-21 17:45:52.491 +01:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2022-09-21 17:45:52.493 +01:00 [DBG] Executing controller factory for controller APIBank.Controllers.AccountsController (APIBank)
2022-09-21 17:45:52.495 +01:00 [DBG] Executed controller factory for controller APIBank.Controllers.AccountsController (APIBank)
2022-09-21 17:45:52.500 +01:00 [DBG] Compiling query expression: 
'DbSet<Account>()
    .Where(u => u.UserId == __userId_0)
    .Select(u => new AccountRe{ 
        Balance = u.Balance, 
        CreatedAt = u.CreatedAt, 
        Currency = u.Currency, 
        Id = u.Id 
    }
    )'
2022-09-21 17:45:52.504 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<AccountRe>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            Balance -> 0
            CreatedAt -> 1
            Currency -> 2
            Id -> 3
        SELECT a.balance AS Balance, a.created_at AS CreatedAt, a.currency AS Currency, a.id AS Id
        FROM accounts AS a
        WHERE a.user_id == @__userId_0), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, AccountRe>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)'
2022-09-21 17:45:52.506 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-21 17:45:52.507 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2022-09-21 17:45:52.509 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-21 17:45:52.510 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 17:45:52.511 +01:00 [DBG] Executing DbCommand [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a.balance AS "Balance", a.created_at AS "CreatedAt", a.currency AS "Currency", a.id AS "Id"
FROM accounts AS a
WHERE a.user_id = @__userId_0
2022-09-21 17:45:52.514 +01:00 [INF] Executed DbCommand (3ms) [Parameters=[@__userId_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT a.balance AS "Balance", a.created_at AS "CreatedAt", a.currency AS "Currency", a.id AS "Id"
FROM accounts AS a
WHERE a.user_id = @__userId_0
2022-09-21 17:45:52.525 +01:00 [DBG] A data reader was disposed.
2022-09-21 17:45:52.526 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 17:45:52.527 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-21 17:45:52.530 +01:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2022-09-21 17:45:52.532 +01:00 [DBG] Attempting to select an output formatter based on Accept header '["text/plain"]'.
2022-09-21 17:45:52.532 +01:00 [DBG] Could not find an output formatter based on content negotiation. Accepted types were (["text/plain"])
2022-09-21 17:45:52.533 +01:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2022-09-21 17:45:52.535 +01:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2022-09-21 17:45:52.535 +01:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2022-09-21 17:45:52.536 +01:00 [INF] Executing OkObjectResult, writing value of type 'System.Collections.Generic.List`1[[APIBank.Models.Accounts.AccountRe, APIBank, Version=1.0.0.0, Culture=neutral, PublicKeyToken=null]]'.
2022-09-21 17:45:52.544 +01:00 [INF] Executed action APIBank.Controllers.AccountsController.GetAllFromUser (APIBank) in 50.5802ms
2022-09-21 17:45:52.547 +01:00 [INF] Executed endpoint 'APIBank.Controllers.AccountsController.GetAllFromUser (APIBank)'
2022-09-21 17:45:52.549 +01:00 [DBG] 'PostgresContext' disposed.
2022-09-21 17:45:52.551 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/api/Accounts/GetAll - - - 200 - application/json;+charset=utf-8 209.5707ms
2022-09-21 17:45:57.198 +01:00 [INF] Request starting HTTP/2 POST https://localhost:7036/api/Users/revoke-token application/json 15
2022-09-21 17:45:57.201 +01:00 [DBG] 1 candidate(s) found for the request path '/api/Users/revoke-token'
2022-09-21 17:45:57.205 +01:00 [DBG] Endpoint 'APIBank.Controllers.UsersController.RevokeToken (APIBank)' with route pattern 'api/Users/revoke-token' is valid for the request path '/api/Users/revoke-token'
2022-09-21 17:45:57.209 +01:00 [DBG] Request matched endpoint 'APIBank.Controllers.UsersController.RevokeToken (APIBank)'
2022-09-21 17:45:57.210 +01:00 [DBG] Static files was skipped as the request already matched an endpoint.
2022-09-21 17:45:57.211 +01:00 [INF] Entity Framework Core 6.0.9 initialized 'PostgresContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:6.0.7+5b98e4b74de93b590b44aef8dd7967c03acc433c' with options: None
2022-09-21 17:45:57.214 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-21 17:45:57.214 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2022-09-21 17:45:57.215 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-21 17:45:57.216 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 17:45:57.217 +01:00 [DBG] Executing DbCommand [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.id = @__p_0
LIMIT 1
2022-09-21 17:45:57.222 +01:00 [INF] Executed DbCommand (5ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.id = @__p_0
LIMIT 1
2022-09-21 17:45:57.225 +01:00 [DBG] Context 'PostgresContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 17:45:57.225 +01:00 [DBG] A data reader was disposed.
2022-09-21 17:45:57.226 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 17:45:57.227 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-21 17:45:57.227 +01:00 [INF] Executing endpoint 'APIBank.Controllers.UsersController.RevokeToken (APIBank)'
2022-09-21 17:45:57.228 +01:00 [INF] Route matched with {action = "RevokeToken", controller = "Users"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult RevokeToken(APIBank.Models.Users.Requests.RevokeTokenRequest) on controller APIBank.Controllers.UsersController (APIBank).
2022-09-21 17:45:57.229 +01:00 [DBG] Execution plan of authorization filters (in the following order): ["APIBank.Authorization.AuthorizeAttribute"]
2022-09-21 17:45:57.230 +01:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2022-09-21 17:45:57.231 +01:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2022-09-21 17:45:57.232 +01:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2022-09-21 17:45:57.234 +01:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2022-09-21 17:45:57.236 +01:00 [DBG] Executing controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-21 17:45:57.238 +01:00 [DBG] Executed controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-21 17:45:57.239 +01:00 [DBG] Attempting to bind parameter 'model' of type 'APIBank.Models.Users.Requests.RevokeTokenRequest' ...
2022-09-21 17:45:57.239 +01:00 [DBG] Attempting to bind parameter 'model' of type 'APIBank.Models.Users.Requests.RevokeTokenRequest' using the name '' in request data ...
2022-09-21 17:45:57.240 +01:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2022-09-21 17:45:57.242 +01:00 [DBG] Connection id "0HMKRU2AIPU8C", Request id "0HMKRU2AIPU8C:00000013": started reading request body.
2022-09-21 17:45:57.242 +01:00 [DBG] Connection id "0HMKRU2AIPU8C", Request id "0HMKRU2AIPU8C:00000013": done reading request body.
2022-09-21 17:45:57.250 +01:00 [DBG] JSON input formatter threw an exception: '}' is an invalid start of a value. Path: $.token | LineNumber: 2 | BytePositionInLine: 0.
2022-09-21 17:45:57.252 +01:00 [DBG] Done attempting to bind parameter 'model' of type 'APIBank.Models.Users.Requests.RevokeTokenRequest'.
2022-09-21 17:45:57.253 +01:00 [DBG] Done attempting to bind parameter 'model' of type 'APIBank.Models.Users.Requests.RevokeTokenRequest'.
2022-09-21 17:45:57.255 +01:00 [DBG] Attempting to validate the bound parameter 'model' of type 'APIBank.Models.Users.Requests.RevokeTokenRequest' ...
2022-09-21 17:45:57.256 +01:00 [DBG] Done attempting to validate the bound parameter 'model' of type 'APIBank.Models.Users.Requests.RevokeTokenRequest'.
2022-09-21 17:45:57.258 +01:00 [DBG] The request has model state errors, returning an error response.
2022-09-21 17:45:57.259 +01:00 [DBG] Request was short circuited at action filter 'Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter'.
2022-09-21 17:45:57.260 +01:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2022-09-21 17:45:57.262 +01:00 [DBG] No information found on request to perform content negotiation.
2022-09-21 17:45:57.263 +01:00 [DBG] Attempting to select the first output formatter in the output formatters list which supports a content type from the explicitly specified content types '["application/problem+json","application/problem+xml","application/problem+json","application/problem+xml"]'.
2022-09-21 17:45:57.264 +01:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/problem+json' to write the response.
2022-09-21 17:45:57.266 +01:00 [INF] Executing BadRequestObjectResult, writing value of type 'Microsoft.AspNetCore.Mvc.ValidationProblemDetails'.
2022-09-21 17:45:57.270 +01:00 [INF] Executed action APIBank.Controllers.UsersController.RevokeToken (APIBank) in 33.8172ms
2022-09-21 17:45:57.272 +01:00 [INF] Executed endpoint 'APIBank.Controllers.UsersController.RevokeToken (APIBank)'
2022-09-21 17:45:57.273 +01:00 [DBG] 'PostgresContext' disposed.
2022-09-21 17:45:57.273 +01:00 [INF] Request finished HTTP/2 POST https://localhost:7036/api/Users/revoke-token application/json 15 - 400 - application/problem+json;+charset=utf-8 75.5743ms
2022-09-21 17:46:07.985 +01:00 [INF] Request starting HTTP/2 POST https://localhost:7036/api/Users/revoke-token application/json 17
2022-09-21 17:46:07.988 +01:00 [DBG] 1 candidate(s) found for the request path '/api/Users/revoke-token'
2022-09-21 17:46:07.991 +01:00 [DBG] Endpoint 'APIBank.Controllers.UsersController.RevokeToken (APIBank)' with route pattern 'api/Users/revoke-token' is valid for the request path '/api/Users/revoke-token'
2022-09-21 17:46:07.992 +01:00 [DBG] Request matched endpoint 'APIBank.Controllers.UsersController.RevokeToken (APIBank)'
2022-09-21 17:46:07.995 +01:00 [DBG] Static files was skipped as the request already matched an endpoint.
2022-09-21 17:46:07.999 +01:00 [INF] Entity Framework Core 6.0.9 initialized 'PostgresContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:6.0.7+5b98e4b74de93b590b44aef8dd7967c03acc433c' with options: None
2022-09-21 17:46:08.003 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-21 17:46:08.004 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2022-09-21 17:46:08.005 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-21 17:46:08.005 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 17:46:08.006 +01:00 [DBG] Executing DbCommand [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.id = @__p_0
LIMIT 1
2022-09-21 17:46:08.008 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.id = @__p_0
LIMIT 1
2022-09-21 17:46:08.011 +01:00 [DBG] Context 'PostgresContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 17:46:08.013 +01:00 [DBG] A data reader was disposed.
2022-09-21 17:46:08.013 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 17:46:08.014 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-21 17:46:08.015 +01:00 [INF] Executing endpoint 'APIBank.Controllers.UsersController.RevokeToken (APIBank)'
2022-09-21 17:46:08.016 +01:00 [INF] Route matched with {action = "RevokeToken", controller = "Users"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult RevokeToken(APIBank.Models.Users.Requests.RevokeTokenRequest) on controller APIBank.Controllers.UsersController (APIBank).
2022-09-21 17:46:08.018 +01:00 [DBG] Execution plan of authorization filters (in the following order): ["APIBank.Authorization.AuthorizeAttribute"]
2022-09-21 17:46:08.018 +01:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2022-09-21 17:46:08.019 +01:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2022-09-21 17:46:08.020 +01:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2022-09-21 17:46:08.021 +01:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2022-09-21 17:46:08.022 +01:00 [DBG] Executing controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-21 17:46:08.023 +01:00 [DBG] Executed controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-21 17:46:08.024 +01:00 [DBG] Attempting to bind parameter 'model' of type 'APIBank.Models.Users.Requests.RevokeTokenRequest' ...
2022-09-21 17:46:08.024 +01:00 [DBG] Attempting to bind parameter 'model' of type 'APIBank.Models.Users.Requests.RevokeTokenRequest' using the name '' in request data ...
2022-09-21 17:46:08.026 +01:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2022-09-21 17:46:08.029 +01:00 [DBG] Connection id "0HMKRU2AIPU8C", Request id "0HMKRU2AIPU8C:00000015": started reading request body.
2022-09-21 17:46:08.030 +01:00 [DBG] Connection id "0HMKRU2AIPU8C", Request id "0HMKRU2AIPU8C:00000015": done reading request body.
2022-09-21 17:46:08.032 +01:00 [DBG] JSON input formatter succeeded, deserializing to type 'APIBank.Models.Users.Requests.RevokeTokenRequest'
2022-09-21 17:46:08.033 +01:00 [DBG] Done attempting to bind parameter 'model' of type 'APIBank.Models.Users.Requests.RevokeTokenRequest'.
2022-09-21 17:46:08.034 +01:00 [DBG] Done attempting to bind parameter 'model' of type 'APIBank.Models.Users.Requests.RevokeTokenRequest'.
2022-09-21 17:46:08.034 +01:00 [DBG] Attempting to validate the bound parameter 'model' of type 'APIBank.Models.Users.Requests.RevokeTokenRequest' ...
2022-09-21 17:46:08.036 +01:00 [DBG] Done attempting to validate the bound parameter 'model' of type 'APIBank.Models.Users.Requests.RevokeTokenRequest'.
2022-09-21 17:46:32.494 +01:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .SingleOrDefault(userQuery => userQuery.RefreshTokenCollection
        .Any(refTokenQuery => refTokenQuery.RefToken == __refToken_0))'
2022-09-21 17:46:32.501 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<User>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: User.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: User.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 1], [Property: User.Email (string) Required Index MaxLength(254), 2], [Property: User.FullName (string) Required MaxLength(100), 3], [Property: User.PasswordChangedAt (DateTime) Required ValueGenerated.OnAdd, 4], [Property: User.PasswordHash (string) Required MaxLength(200), 5], [Property: User.Username (string) Required Index MaxLength(50), 6] }
        SELECT TOP(2) u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
        FROM users AS u
        WHERE EXISTS (
            SELECT 1
            FROM refresh_token AS r
            WHERE ((u.id != NULL) && (u.id == r.user_id)) && (r.token == @__refToken_0))), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, User>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)
    .SingleOrDefault()'
2022-09-21 17:46:32.503 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-21 17:46:32.504 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2022-09-21 17:46:32.506 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-21 17:46:32.507 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 17:46:32.508 +01:00 [DBG] Executing DbCommand [Parameters=[@__refToken_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE EXISTS (
    SELECT 1
    FROM refresh_token AS r
    WHERE (u.id = r.user_id) AND (r.token = @__refToken_0))
LIMIT 2
2022-09-21 17:46:32.512 +01:00 [INF] Executed DbCommand (3ms) [Parameters=[@__refToken_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE EXISTS (
    SELECT 1
    FROM refresh_token AS r
    WHERE (u.id = r.user_id) AND (r.token = @__refToken_0))
LIMIT 2
2022-09-21 17:46:32.513 +01:00 [DBG] A data reader was disposed.
2022-09-21 17:46:32.514 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 17:46:32.515 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-21 17:46:54.394 +01:00 [INF] Executed action APIBank.Controllers.UsersController.RevokeToken (APIBank) in 46371.4664ms
2022-09-21 17:46:54.400 +01:00 [INF] Executed endpoint 'APIBank.Controllers.UsersController.RevokeToken (APIBank)'
2022-09-21 17:46:57.201 +01:00 [INF] Global Error was found:
2022-09-21 17:46:57.225 +01:00 [DBG] 'PostgresContext' disposed.
2022-09-21 17:46:57.228 +01:00 [INF] Request finished HTTP/2 POST https://localhost:7036/api/Users/revoke-token application/json 17 - 400 - application/json 49242.4694ms
2022-09-21 17:47:09.689 +01:00 [INF] Request starting HTTP/2 POST https://localhost:7036/api/Users/revoke-token application/json 19
2022-09-21 17:47:09.694 +01:00 [DBG] 1 candidate(s) found for the request path '/api/Users/revoke-token'
2022-09-21 17:47:09.698 +01:00 [DBG] Endpoint 'APIBank.Controllers.UsersController.RevokeToken (APIBank)' with route pattern 'api/Users/revoke-token' is valid for the request path '/api/Users/revoke-token'
2022-09-21 17:47:09.701 +01:00 [DBG] Request matched endpoint 'APIBank.Controllers.UsersController.RevokeToken (APIBank)'
2022-09-21 17:47:09.701 +01:00 [DBG] Static files was skipped as the request already matched an endpoint.
2022-09-21 17:47:09.729 +01:00 [INF] Executing endpoint 'APIBank.Controllers.UsersController.RevokeToken (APIBank)'
2022-09-21 17:47:09.732 +01:00 [INF] Route matched with {action = "RevokeToken", controller = "Users"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult RevokeToken(APIBank.Models.Users.Requests.RevokeTokenRequest) on controller APIBank.Controllers.UsersController (APIBank).
2022-09-21 17:47:09.734 +01:00 [DBG] Execution plan of authorization filters (in the following order): ["APIBank.Authorization.AuthorizeAttribute"]
2022-09-21 17:47:09.735 +01:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2022-09-21 17:47:09.736 +01:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2022-09-21 17:47:09.737 +01:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2022-09-21 17:47:09.739 +01:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2022-09-21 17:47:09.741 +01:00 [INF] Authorization failed for the request at filter 'APIBank.Authorization.AuthorizeAttribute'.
2022-09-21 17:47:09.742 +01:00 [INF] Executing JsonResult, writing value of type '<>f__AnonymousType0`1[[System.String, System.Private.CoreLib, Version=6.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2022-09-21 17:47:09.743 +01:00 [INF] Executed action APIBank.Controllers.UsersController.RevokeToken (APIBank) in 2.2372ms
2022-09-21 17:47:09.745 +01:00 [INF] Executed endpoint 'APIBank.Controllers.UsersController.RevokeToken (APIBank)'
2022-09-21 17:47:09.746 +01:00 [INF] Request finished HTTP/2 POST https://localhost:7036/api/Users/revoke-token application/json 19 - 401 - application/json;+charset=utf-8 56.5461ms
2022-09-21 17:47:09.747 +01:00 [DBG] Connection id "0HMKRU2AIPU8C", Request id "0HMKRU2AIPU8C:00000017": started reading request body.
2022-09-21 17:47:09.747 +01:00 [DBG] Connection id "0HMKRU2AIPU8C", Request id "0HMKRU2AIPU8C:00000017": done reading request body.
2022-09-21 17:47:15.659 +01:00 [INF] Request starting HTTP/2 POST https://localhost:7036/api/Users/refreshToken - 0
2022-09-21 17:47:15.661 +01:00 [DBG] 1 candidate(s) found for the request path '/api/Users/refreshToken'
2022-09-21 17:47:15.661 +01:00 [DBG] Endpoint 'APIBank.Controllers.UsersController.RefreshToken (APIBank)' with route pattern 'api/Users/refreshToken' is valid for the request path '/api/Users/refreshToken'
2022-09-21 17:47:15.662 +01:00 [DBG] Request matched endpoint 'APIBank.Controllers.UsersController.RefreshToken (APIBank)'
2022-09-21 17:47:15.664 +01:00 [DBG] Static files was skipped as the request already matched an endpoint.
2022-09-21 17:47:15.691 +01:00 [INF] Executing endpoint 'APIBank.Controllers.UsersController.RefreshToken (APIBank)'
2022-09-21 17:47:15.693 +01:00 [INF] Route matched with {action = "RefreshToken", controller = "Users"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult RefreshToken() on controller APIBank.Controllers.UsersController (APIBank).
2022-09-21 17:47:15.694 +01:00 [DBG] Execution plan of authorization filters (in the following order): ["APIBank.Authorization.AuthorizeAttribute"]
2022-09-21 17:47:15.696 +01:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2022-09-21 17:47:15.697 +01:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2022-09-21 17:47:15.698 +01:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2022-09-21 17:47:15.701 +01:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2022-09-21 17:47:15.703 +01:00 [DBG] Executing controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-21 17:47:15.704 +01:00 [DBG] Executed controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-21 17:47:20.289 +01:00 [INF] Entity Framework Core 6.0.9 initialized 'PostgresContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:6.0.7+5b98e4b74de93b590b44aef8dd7967c03acc433c' with options: None
2022-09-21 17:47:20.294 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-21 17:47:20.297 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (2ms).
2022-09-21 17:47:20.299 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-21 17:47:20.302 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 17:47:20.304 +01:00 [DBG] Executing DbCommand [Parameters=[@__refToken_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE EXISTS (
    SELECT 1
    FROM refresh_token AS r
    WHERE (u.id = r.user_id) AND (r.token = @__refToken_0))
LIMIT 2
2022-09-21 17:47:20.307 +01:00 [INF] Executed DbCommand (3ms) [Parameters=[@__refToken_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE EXISTS (
    SELECT 1
    FROM refresh_token AS r
    WHERE (u.id = r.user_id) AND (r.token = @__refToken_0))
LIMIT 2
2022-09-21 17:47:20.308 +01:00 [DBG] Context 'PostgresContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 17:47:20.309 +01:00 [DBG] A data reader was disposed.
2022-09-21 17:47:20.310 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 17:47:20.312 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-21 17:47:20.314 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-21 17:47:20.315 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2022-09-21 17:47:20.318 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-21 17:47:20.320 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 17:47:20.321 +01:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.user_id AS "UserId", r.token AS "RefToken", r.expires AS "Expires", r.created AS "Created", r.created_by_ip AS "CreatedByIp", r.revoked AS "Revoked", r.revoked_by_ip AS "RevokedByIp", r.replaced_by_token AS "ReplacedByToken", r.reason_revoked AS "ReasonRevoked", r.is_expired AS "IsExpired", r.is_revoked AS "IsRevoked", r.is_active AS "IsActive"
FROM refresh_token AS r
WHERE r.user_id = @__id_0
2022-09-21 17:47:20.323 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.user_id AS "UserId", r.token AS "RefToken", r.expires AS "Expires", r.created AS "Created", r.created_by_ip AS "CreatedByIp", r.revoked AS "Revoked", r.revoked_by_ip AS "RevokedByIp", r.replaced_by_token AS "ReplacedByToken", r.reason_revoked AS "ReasonRevoked", r.is_expired AS "IsExpired", r.is_revoked AS "IsRevoked", r.is_active AS "IsActive"
FROM refresh_token AS r
WHERE r.user_id = @__id_0
2022-09-21 17:47:20.325 +01:00 [DBG] A data reader was disposed.
2022-09-21 17:47:20.325 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 17:47:20.326 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-21 17:47:20.327 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-21 17:47:20.328 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2022-09-21 17:47:20.330 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-21 17:47:20.331 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 17:47:20.332 +01:00 [DBG] Executing DbCommand [Parameters=[@__token_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM users AS u
    WHERE EXISTS (
        SELECT 1
        FROM refresh_token AS r
        WHERE (u.id = r.user_id) AND (r.token = @__token_0)))
2022-09-21 17:47:20.335 +01:00 [INF] Executed DbCommand (3ms) [Parameters=[@__token_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM users AS u
    WHERE EXISTS (
        SELECT 1
        FROM refresh_token AS r
        WHERE (u.id = r.user_id) AND (r.token = @__token_0)))
2022-09-21 17:47:20.338 +01:00 [DBG] A data reader was disposed.
2022-09-21 17:47:20.339 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 17:47:20.340 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-21 17:47:20.341 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-21 17:47:20.342 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2022-09-21 17:47:20.342 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-21 17:47:20.343 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 17:47:20.344 +01:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.user_id AS "UserId", r.token AS "RefToken", r.expires AS "Expires", r.created AS "Created", r.created_by_ip AS "CreatedByIp", r.revoked AS "Revoked", r.revoked_by_ip AS "RevokedByIp", r.replaced_by_token AS "ReplacedByToken", r.reason_revoked AS "ReasonRevoked", r.is_expired AS "IsExpired", r.is_revoked AS "IsRevoked", r.is_active AS "IsActive"
FROM refresh_token AS r
WHERE r.user_id = @__id_0
2022-09-21 17:47:20.346 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.user_id AS "UserId", r.token AS "RefToken", r.expires AS "Expires", r.created AS "Created", r.created_by_ip AS "CreatedByIp", r.revoked AS "Revoked", r.revoked_by_ip AS "RevokedByIp", r.replaced_by_token AS "ReplacedByToken", r.reason_revoked AS "ReasonRevoked", r.is_expired AS "IsExpired", r.is_revoked AS "IsRevoked", r.is_active AS "IsActive"
FROM refresh_token AS r
WHERE r.user_id = @__id_0
2022-09-21 17:47:20.348 +01:00 [DBG] A data reader was disposed.
2022-09-21 17:47:20.350 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 17:47:20.351 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-21 17:47:20.353 +01:00 [DBG] An entity of type 'User' tracked by 'PostgresContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 17:47:20.355 +01:00 [DBG] SaveChanges starting for 'PostgresContext'.
2022-09-21 17:47:20.355 +01:00 [DBG] DetectChanges starting for 'PostgresContext'.
2022-09-21 17:47:20.356 +01:00 [DBG] 1 entities were added and 0 entities were removed from navigation 'User.RefreshTokenCollection'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 17:47:20.358 +01:00 [DBG] 'PostgresContext' generated a temporary value for the property 'Id.RefreshToken'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 17:47:20.360 +01:00 [DBG] Context 'PostgresContext' started tracking 'RefreshToken' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 17:47:20.362 +01:00 [DBG] DetectChanges completed for 'PostgresContext'.
2022-09-21 17:47:20.363 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-21 17:47:20.364 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 17:47:20.366 +01:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2022-09-21 17:47:20.368 +01:00 [DBG] Began transaction with isolation level 'ReadCommitted'.
2022-09-21 17:47:20.369 +01:00 [DBG] Executing 2 update commands as a batch.
2022-09-21 17:47:20.370 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-21 17:47:20.371 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2022-09-21 17:47:20.372 +01:00 [DBG] Executing DbCommand [Parameters=[@p0='?' (DbType = DateTime), @p1='?', @p2='?' (DbType = DateTime), @p3='?' (DbType = Boolean), @p4='?' (DbType = Boolean), @p5='?' (DbType = Boolean), @p6='?', @p7='?', @p8='?', @p9='?' (DbType = DateTime), @p10='?', @p11='?' (DbType = Int32), @p18='?' (DbType = Int32), @p12='?' (DbType = DateTime), @p13='?', @p14='?', @p15='?' (DbType = DateTime), @p16='?', @p17='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO refresh_token (created, created_by_ip, expires, is_active, is_expired, is_revoked, reason_revoked, token, replaced_by_token, revoked, revoked_by_ip, user_id)
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11)
RETURNING id;
UPDATE users SET created_at = @p12, email = @p13, full_name = @p14, password_changed_at = @p15, password_hash = @p16, username = @p17
WHERE id = @p18;
2022-09-21 17:47:20.374 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[@p0='?' (DbType = DateTime), @p1='?', @p2='?' (DbType = DateTime), @p3='?' (DbType = Boolean), @p4='?' (DbType = Boolean), @p5='?' (DbType = Boolean), @p6='?', @p7='?', @p8='?', @p9='?' (DbType = DateTime), @p10='?', @p11='?' (DbType = Int32), @p18='?' (DbType = Int32), @p12='?' (DbType = DateTime), @p13='?', @p14='?', @p15='?' (DbType = DateTime), @p16='?', @p17='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO refresh_token (created, created_by_ip, expires, is_active, is_expired, is_revoked, reason_revoked, token, replaced_by_token, revoked, revoked_by_ip, user_id)
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11)
RETURNING id;
UPDATE users SET created_at = @p12, email = @p13, full_name = @p14, password_changed_at = @p15, password_hash = @p16, username = @p17
WHERE id = @p18;
2022-09-21 17:47:20.376 +01:00 [DBG] The foreign key property 'RefreshToken.Id' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2022-09-21 17:47:20.377 +01:00 [DBG] A data reader was disposed.
2022-09-21 17:47:20.377 +01:00 [DBG] Committing transaction.
2022-09-21 17:47:20.380 +01:00 [DBG] Committed transaction.
2022-09-21 17:47:20.384 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 17:47:20.385 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-21 17:47:20.386 +01:00 [DBG] Disposing transaction.
2022-09-21 17:47:20.386 +01:00 [DBG] An entity of type 'RefreshToken' tracked by 'PostgresContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 17:47:20.387 +01:00 [DBG] An entity of type 'User' tracked by 'PostgresContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 17:47:20.388 +01:00 [DBG] SaveChanges completed for 'PostgresContext' with 2 entities written to the database.
2022-09-21 17:47:20.389 +01:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2022-09-21 17:47:20.390 +01:00 [DBG] Attempting to select an output formatter based on Accept header '["text/plain"]'.
2022-09-21 17:47:20.391 +01:00 [DBG] Could not find an output formatter based on content negotiation. Accepted types were (["text/plain"])
2022-09-21 17:47:20.392 +01:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2022-09-21 17:47:20.393 +01:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2022-09-21 17:47:20.393 +01:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2022-09-21 17:47:20.394 +01:00 [INF] Executing OkObjectResult, writing value of type 'APIBank.Models.Users.Responses.LoginResponse'.
2022-09-21 17:47:20.395 +01:00 [INF] Executed action APIBank.Controllers.UsersController.RefreshToken (APIBank) in 4692.4302ms
2022-09-21 17:47:20.397 +01:00 [INF] Executed endpoint 'APIBank.Controllers.UsersController.RefreshToken (APIBank)'
2022-09-21 17:47:20.401 +01:00 [DBG] 'PostgresContext' disposed.
2022-09-21 17:47:20.402 +01:00 [INF] Request finished HTTP/2 POST https://localhost:7036/api/Users/refreshToken - 0 - 200 - application/json;+charset=utf-8 4743.4834ms
2022-09-21 17:47:32.488 +01:00 [INF] Request starting HTTP/2 POST https://localhost:7036/api/Users/revoke-token application/json 19
2022-09-21 17:47:32.492 +01:00 [DBG] 1 candidate(s) found for the request path '/api/Users/revoke-token'
2022-09-21 17:47:32.493 +01:00 [DBG] Endpoint 'APIBank.Controllers.UsersController.RevokeToken (APIBank)' with route pattern 'api/Users/revoke-token' is valid for the request path '/api/Users/revoke-token'
2022-09-21 17:47:32.495 +01:00 [DBG] Request matched endpoint 'APIBank.Controllers.UsersController.RevokeToken (APIBank)'
2022-09-21 17:47:32.498 +01:00 [DBG] Static files was skipped as the request already matched an endpoint.
2022-09-21 17:47:32.500 +01:00 [INF] Entity Framework Core 6.0.9 initialized 'PostgresContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:6.0.7+5b98e4b74de93b590b44aef8dd7967c03acc433c' with options: None
2022-09-21 17:47:32.503 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-21 17:47:32.508 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (5ms).
2022-09-21 17:47:32.510 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-21 17:47:32.511 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 17:47:32.513 +01:00 [DBG] Executing DbCommand [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.id = @__p_0
LIMIT 1
2022-09-21 17:47:32.516 +01:00 [INF] Executed DbCommand (3ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.id = @__p_0
LIMIT 1
2022-09-21 17:47:32.518 +01:00 [DBG] Context 'PostgresContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 17:47:32.522 +01:00 [DBG] A data reader was disposed.
2022-09-21 17:47:32.524 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 17:47:32.525 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-21 17:47:32.527 +01:00 [INF] Executing endpoint 'APIBank.Controllers.UsersController.RevokeToken (APIBank)'
2022-09-21 17:47:32.528 +01:00 [INF] Route matched with {action = "RevokeToken", controller = "Users"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult RevokeToken(APIBank.Models.Users.Requests.RevokeTokenRequest) on controller APIBank.Controllers.UsersController (APIBank).
2022-09-21 17:47:32.530 +01:00 [DBG] Execution plan of authorization filters (in the following order): ["APIBank.Authorization.AuthorizeAttribute"]
2022-09-21 17:47:32.532 +01:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2022-09-21 17:47:32.533 +01:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2022-09-21 17:47:32.534 +01:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2022-09-21 17:47:32.536 +01:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2022-09-21 17:47:32.538 +01:00 [DBG] Executing controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-21 17:47:32.540 +01:00 [DBG] Executed controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-21 17:47:32.540 +01:00 [DBG] Attempting to bind parameter 'model' of type 'APIBank.Models.Users.Requests.RevokeTokenRequest' ...
2022-09-21 17:47:32.541 +01:00 [DBG] Attempting to bind parameter 'model' of type 'APIBank.Models.Users.Requests.RevokeTokenRequest' using the name '' in request data ...
2022-09-21 17:47:32.542 +01:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2022-09-21 17:47:32.543 +01:00 [DBG] Connection id "0HMKRU2AIPU8C", Request id "0HMKRU2AIPU8C:0000001B": started reading request body.
2022-09-21 17:47:32.544 +01:00 [DBG] Connection id "0HMKRU2AIPU8C", Request id "0HMKRU2AIPU8C:0000001B": done reading request body.
2022-09-21 17:47:32.545 +01:00 [DBG] JSON input formatter succeeded, deserializing to type 'APIBank.Models.Users.Requests.RevokeTokenRequest'
2022-09-21 17:47:32.546 +01:00 [DBG] Done attempting to bind parameter 'model' of type 'APIBank.Models.Users.Requests.RevokeTokenRequest'.
2022-09-21 17:47:32.547 +01:00 [DBG] Done attempting to bind parameter 'model' of type 'APIBank.Models.Users.Requests.RevokeTokenRequest'.
2022-09-21 17:47:32.547 +01:00 [DBG] Attempting to validate the bound parameter 'model' of type 'APIBank.Models.Users.Requests.RevokeTokenRequest' ...
2022-09-21 17:47:32.548 +01:00 [DBG] Done attempting to validate the bound parameter 'model' of type 'APIBank.Models.Users.Requests.RevokeTokenRequest'.
2022-09-21 17:47:32.549 +01:00 [DBG] The request has model state errors, returning an error response.
2022-09-21 17:47:32.550 +01:00 [DBG] Request was short circuited at action filter 'Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter'.
2022-09-21 17:47:32.553 +01:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2022-09-21 17:47:32.555 +01:00 [DBG] No information found on request to perform content negotiation.
2022-09-21 17:47:32.556 +01:00 [DBG] Attempting to select the first output formatter in the output formatters list which supports a content type from the explicitly specified content types '["application/problem+json","application/problem+xml","application/problem+json","application/problem+xml"]'.
2022-09-21 17:47:32.557 +01:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/problem+json' to write the response.
2022-09-21 17:47:32.558 +01:00 [INF] Executing BadRequestObjectResult, writing value of type 'Microsoft.AspNetCore.Mvc.ValidationProblemDetails'.
2022-09-21 17:47:32.559 +01:00 [INF] Executed action APIBank.Controllers.UsersController.RevokeToken (APIBank) in 21.0485ms
2022-09-21 17:47:32.560 +01:00 [INF] Executed endpoint 'APIBank.Controllers.UsersController.RevokeToken (APIBank)'
2022-09-21 17:47:32.561 +01:00 [DBG] 'PostgresContext' disposed.
2022-09-21 17:47:32.565 +01:00 [INF] Request finished HTTP/2 POST https://localhost:7036/api/Users/revoke-token application/json 19 - 400 - application/problem+json;+charset=utf-8 76.7216ms
2022-09-21 17:47:37.547 +01:00 [INF] Request starting HTTP/2 POST https://localhost:7036/api/Users/revoke-token application/json 19
2022-09-21 17:47:37.550 +01:00 [DBG] 1 candidate(s) found for the request path '/api/Users/revoke-token'
2022-09-21 17:47:37.551 +01:00 [DBG] Endpoint 'APIBank.Controllers.UsersController.RevokeToken (APIBank)' with route pattern 'api/Users/revoke-token' is valid for the request path '/api/Users/revoke-token'
2022-09-21 17:47:37.553 +01:00 [DBG] Request matched endpoint 'APIBank.Controllers.UsersController.RevokeToken (APIBank)'
2022-09-21 17:47:37.555 +01:00 [DBG] Static files was skipped as the request already matched an endpoint.
2022-09-21 17:47:37.559 +01:00 [INF] Entity Framework Core 6.0.9 initialized 'PostgresContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:6.0.7+5b98e4b74de93b590b44aef8dd7967c03acc433c' with options: None
2022-09-21 17:47:37.561 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-21 17:47:37.562 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2022-09-21 17:47:37.563 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-21 17:47:37.565 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 17:47:37.568 +01:00 [DBG] Executing DbCommand [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.id = @__p_0
LIMIT 1
2022-09-21 17:47:37.574 +01:00 [INF] Executed DbCommand (6ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.id = @__p_0
LIMIT 1
2022-09-21 17:47:37.576 +01:00 [DBG] Context 'PostgresContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 17:47:37.577 +01:00 [DBG] A data reader was disposed.
2022-09-21 17:47:37.578 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 17:47:37.579 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-21 17:47:37.580 +01:00 [INF] Executing endpoint 'APIBank.Controllers.UsersController.RevokeToken (APIBank)'
2022-09-21 17:47:37.582 +01:00 [INF] Route matched with {action = "RevokeToken", controller = "Users"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult RevokeToken(APIBank.Models.Users.Requests.RevokeTokenRequest) on controller APIBank.Controllers.UsersController (APIBank).
2022-09-21 17:47:37.586 +01:00 [DBG] Execution plan of authorization filters (in the following order): ["APIBank.Authorization.AuthorizeAttribute"]
2022-09-21 17:47:37.589 +01:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2022-09-21 17:47:37.590 +01:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2022-09-21 17:47:37.591 +01:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2022-09-21 17:47:37.592 +01:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2022-09-21 17:47:37.593 +01:00 [DBG] Executing controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-21 17:47:37.594 +01:00 [DBG] Executed controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-21 17:47:37.595 +01:00 [DBG] Attempting to bind parameter 'model' of type 'APIBank.Models.Users.Requests.RevokeTokenRequest' ...
2022-09-21 17:47:37.596 +01:00 [DBG] Attempting to bind parameter 'model' of type 'APIBank.Models.Users.Requests.RevokeTokenRequest' using the name '' in request data ...
2022-09-21 17:47:37.598 +01:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2022-09-21 17:47:37.601 +01:00 [DBG] Connection id "0HMKRU2AIPU8C", Request id "0HMKRU2AIPU8C:0000001D": started reading request body.
2022-09-21 17:47:37.603 +01:00 [DBG] Connection id "0HMKRU2AIPU8C", Request id "0HMKRU2AIPU8C:0000001D": done reading request body.
2022-09-21 17:47:37.604 +01:00 [DBG] JSON input formatter succeeded, deserializing to type 'APIBank.Models.Users.Requests.RevokeTokenRequest'
2022-09-21 17:47:37.605 +01:00 [DBG] Done attempting to bind parameter 'model' of type 'APIBank.Models.Users.Requests.RevokeTokenRequest'.
2022-09-21 17:47:37.606 +01:00 [DBG] Done attempting to bind parameter 'model' of type 'APIBank.Models.Users.Requests.RevokeTokenRequest'.
2022-09-21 17:47:37.606 +01:00 [DBG] Attempting to validate the bound parameter 'model' of type 'APIBank.Models.Users.Requests.RevokeTokenRequest' ...
2022-09-21 17:47:37.607 +01:00 [DBG] Done attempting to validate the bound parameter 'model' of type 'APIBank.Models.Users.Requests.RevokeTokenRequest'.
2022-09-21 17:47:37.608 +01:00 [DBG] The request has model state errors, returning an error response.
2022-09-21 17:47:37.609 +01:00 [DBG] Request was short circuited at action filter 'Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter'.
2022-09-21 17:47:37.609 +01:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2022-09-21 17:47:37.614 +01:00 [DBG] No information found on request to perform content negotiation.
2022-09-21 17:47:37.615 +01:00 [DBG] Attempting to select the first output formatter in the output formatters list which supports a content type from the explicitly specified content types '["application/problem+json","application/problem+xml","application/problem+json","application/problem+xml"]'.
2022-09-21 17:47:37.618 +01:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/problem+json' to write the response.
2022-09-21 17:47:37.619 +01:00 [INF] Executing BadRequestObjectResult, writing value of type 'Microsoft.AspNetCore.Mvc.ValidationProblemDetails'.
2022-09-21 17:47:37.620 +01:00 [INF] Executed action APIBank.Controllers.UsersController.RevokeToken (APIBank) in 26.9924ms
2022-09-21 17:47:37.621 +01:00 [INF] Executed endpoint 'APIBank.Controllers.UsersController.RevokeToken (APIBank)'
2022-09-21 17:47:37.622 +01:00 [DBG] 'PostgresContext' disposed.
2022-09-21 17:47:37.623 +01:00 [INF] Request finished HTTP/2 POST https://localhost:7036/api/Users/revoke-token application/json 19 - 400 - application/problem+json;+charset=utf-8 76.6444ms
2022-09-21 17:47:44.108 +01:00 [INF] Request starting HTTP/2 POST https://localhost:7036/api/Users/revoke-token application/json 19
2022-09-21 17:47:44.113 +01:00 [DBG] 1 candidate(s) found for the request path '/api/Users/revoke-token'
2022-09-21 17:47:44.116 +01:00 [DBG] Endpoint 'APIBank.Controllers.UsersController.RevokeToken (APIBank)' with route pattern 'api/Users/revoke-token' is valid for the request path '/api/Users/revoke-token'
2022-09-21 17:47:44.120 +01:00 [DBG] Request matched endpoint 'APIBank.Controllers.UsersController.RevokeToken (APIBank)'
2022-09-21 17:47:44.122 +01:00 [DBG] Static files was skipped as the request already matched an endpoint.
2022-09-21 17:47:44.124 +01:00 [INF] Entity Framework Core 6.0.9 initialized 'PostgresContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:6.0.7+5b98e4b74de93b590b44aef8dd7967c03acc433c' with options: None
2022-09-21 17:47:44.130 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-21 17:47:44.132 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (2ms).
2022-09-21 17:47:44.134 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-21 17:47:44.136 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 17:47:44.137 +01:00 [DBG] Executing DbCommand [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.id = @__p_0
LIMIT 1
2022-09-21 17:47:44.139 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.id = @__p_0
LIMIT 1
2022-09-21 17:47:44.141 +01:00 [DBG] Context 'PostgresContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 17:47:44.143 +01:00 [DBG] A data reader was disposed.
2022-09-21 17:47:44.145 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 17:47:44.149 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-21 17:47:44.151 +01:00 [INF] Executing endpoint 'APIBank.Controllers.UsersController.RevokeToken (APIBank)'
2022-09-21 17:47:44.152 +01:00 [INF] Route matched with {action = "RevokeToken", controller = "Users"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult RevokeToken(APIBank.Models.Users.Requests.RevokeTokenRequest) on controller APIBank.Controllers.UsersController (APIBank).
2022-09-21 17:47:44.153 +01:00 [DBG] Execution plan of authorization filters (in the following order): ["APIBank.Authorization.AuthorizeAttribute"]
2022-09-21 17:47:44.154 +01:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2022-09-21 17:47:44.155 +01:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2022-09-21 17:47:44.157 +01:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2022-09-21 17:47:44.159 +01:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2022-09-21 17:47:44.161 +01:00 [DBG] Executing controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-21 17:47:44.164 +01:00 [DBG] Executed controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-21 17:47:44.165 +01:00 [DBG] Attempting to bind parameter 'model' of type 'APIBank.Models.Users.Requests.RevokeTokenRequest' ...
2022-09-21 17:47:44.166 +01:00 [DBG] Attempting to bind parameter 'model' of type 'APIBank.Models.Users.Requests.RevokeTokenRequest' using the name '' in request data ...
2022-09-21 17:47:44.167 +01:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2022-09-21 17:47:44.168 +01:00 [DBG] Connection id "0HMKRU2AIPU8C", Request id "0HMKRU2AIPU8C:0000001F": started reading request body.
2022-09-21 17:47:44.169 +01:00 [DBG] Connection id "0HMKRU2AIPU8C", Request id "0HMKRU2AIPU8C:0000001F": done reading request body.
2022-09-21 17:47:44.170 +01:00 [DBG] JSON input formatter threw an exception: 'N' is an invalid start of a value. Path: $.token | LineNumber: 1 | BytePositionInLine: 11.
2022-09-21 17:47:44.172 +01:00 [DBG] Done attempting to bind parameter 'model' of type 'APIBank.Models.Users.Requests.RevokeTokenRequest'.
2022-09-21 17:47:44.173 +01:00 [DBG] Done attempting to bind parameter 'model' of type 'APIBank.Models.Users.Requests.RevokeTokenRequest'.
2022-09-21 17:47:44.174 +01:00 [DBG] Attempting to validate the bound parameter 'model' of type 'APIBank.Models.Users.Requests.RevokeTokenRequest' ...
2022-09-21 17:47:44.175 +01:00 [DBG] Done attempting to validate the bound parameter 'model' of type 'APIBank.Models.Users.Requests.RevokeTokenRequest'.
2022-09-21 17:47:44.176 +01:00 [DBG] The request has model state errors, returning an error response.
2022-09-21 17:47:44.179 +01:00 [DBG] Request was short circuited at action filter 'Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter'.
2022-09-21 17:47:44.182 +01:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2022-09-21 17:47:44.183 +01:00 [DBG] No information found on request to perform content negotiation.
2022-09-21 17:47:44.184 +01:00 [DBG] Attempting to select the first output formatter in the output formatters list which supports a content type from the explicitly specified content types '["application/problem+json","application/problem+xml","application/problem+json","application/problem+xml"]'.
2022-09-21 17:47:44.185 +01:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/problem+json' to write the response.
2022-09-21 17:47:44.186 +01:00 [INF] Executing BadRequestObjectResult, writing value of type 'Microsoft.AspNetCore.Mvc.ValidationProblemDetails'.
2022-09-21 17:47:44.189 +01:00 [INF] Executed action APIBank.Controllers.UsersController.RevokeToken (APIBank) in 28.2726ms
2022-09-21 17:47:44.190 +01:00 [INF] Executed endpoint 'APIBank.Controllers.UsersController.RevokeToken (APIBank)'
2022-09-21 17:47:44.191 +01:00 [DBG] 'PostgresContext' disposed.
2022-09-21 17:47:44.192 +01:00 [INF] Request finished HTTP/2 POST https://localhost:7036/api/Users/revoke-token application/json 19 - 400 - application/problem+json;+charset=utf-8 84.0680ms
2022-09-21 17:49:27.138 +01:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2022-09-21 17:49:27.205 +01:00 [DBG] Hosting starting
2022-09-21 17:49:27.268 +01:00 [DBG] Using development certificate: CN=localhost (Thumbprint: 9CC642E9838495A6C3C202DECA6A8AD300396DD2)
2022-09-21 17:49:27.302 +01:00 [INF] Now listening on: https://localhost:7036
2022-09-21 17:49:27.304 +01:00 [INF] Now listening on: http://localhost:5036
2022-09-21 17:49:27.307 +01:00 [DBG] Loaded hosting startup assembly APIBank
2022-09-21 17:49:27.308 +01:00 [DBG] Loaded hosting startup assembly Microsoft.AspNetCore.Watch.BrowserRefresh
2022-09-21 17:49:27.308 +01:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.BrowserLink.Net
2022-09-21 17:49:27.309 +01:00 [INF] Application started. Press Ctrl+C to shut down.
2022-09-21 17:49:27.310 +01:00 [INF] Hosting environment: Development
2022-09-21 17:49:27.310 +01:00 [INF] Content root path: C:\Users\mguedesa\OneDrive - NTT DATA EMEAL\Documentos\GitHub\OpenBankAPI-NTT\APIBank\APIBank\
2022-09-21 17:49:27.311 +01:00 [DBG] Hosting started
2022-09-21 17:49:27.438 +01:00 [DBG] Connection id "0HMKRU4VHHSE6" accepted.
2022-09-21 17:49:27.439 +01:00 [DBG] Connection id "0HMKRU4VHHSE6" started.
2022-09-21 17:49:27.446 +01:00 [DBG] Connection id "0HMKRU4VHHSE7" accepted.
2022-09-21 17:49:27.447 +01:00 [DBG] Connection id "0HMKRU4VHHSE7" started.
2022-09-21 17:49:27.462 +01:00 [DBG] Connection id "0HMKRU4VHHSE6" received FIN.
2022-09-21 17:49:27.462 +01:00 [DBG] Connection id "0HMKRU4VHHSE7" received FIN.
2022-09-21 17:49:27.469 +01:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException:  Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.<FillHandshakeBufferAsync>g__InternalFillHandshakeBufferAsync|189_0[TIOAdapter](TIOAdapter adap, ValueTask`1 task, Int32 minSize)
   at System.Net.Security.SslStream.ReceiveBlobAsync[TIOAdapter](TIOAdapter adapter)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](TIOAdapter adapter, Boolean receiveFirst, Byte[] reAuthenticationData, Boolean isApm)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2022-09-21 17:49:27.469 +01:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException:  Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.<FillHandshakeBufferAsync>g__InternalFillHandshakeBufferAsync|189_0[TIOAdapter](TIOAdapter adap, ValueTask`1 task, Int32 minSize)
   at System.Net.Security.SslStream.ReceiveBlobAsync[TIOAdapter](TIOAdapter adapter)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](TIOAdapter adapter, Boolean receiveFirst, Byte[] reAuthenticationData, Boolean isApm)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2022-09-21 17:49:27.494 +01:00 [DBG] Connection id "0HMKRU4VHHSE6" stopped.
2022-09-21 17:49:27.494 +01:00 [DBG] Connection id "0HMKRU4VHHSE7" stopped.
2022-09-21 17:49:27.496 +01:00 [DBG] Connection id "0HMKRU4VHHSE6" sending FIN because: "The Socket transport's send loop completed gracefully."
2022-09-21 17:49:27.497 +01:00 [DBG] Connection id "0HMKRU4VHHSE7" sending FIN because: "The Socket transport's send loop completed gracefully."
2022-09-21 17:49:27.614 +01:00 [DBG] Connection id "0HMKRU4VHHSE8" accepted.
2022-09-21 17:49:27.616 +01:00 [DBG] Connection id "0HMKRU4VHHSE8" started.
2022-09-21 17:49:27.656 +01:00 [DBG] Connection 0HMKRU4VHHSE8 established using the following protocol: "Tls12"
2022-09-21 17:49:27.709 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/swagger/index.html - -
2022-09-21 17:49:27.733 +01:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2022-09-21 17:49:27.751 +01:00 [DBG] No candidates found for the request path '/swagger/index.html'
2022-09-21 17:49:27.752 +01:00 [DBG] Request did not match any endpoints
2022-09-21 17:49:27.827 +01:00 [DBG] Response markup is scheduled to include browser refresh script injection.
2022-09-21 17:49:27.905 +01:00 [DBG] Response markup was updated to include browser refresh script injection.
2022-09-21 17:49:27.910 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/swagger/index.html - - - 200 - text/html;charset=utf-8 206.6970ms
2022-09-21 17:49:27.936 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/_framework/aspnetcore-browser-refresh.js - -
2022-09-21 17:49:27.942 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/_framework/aspnetcore-browser-refresh.js - - - 200 11984 application/javascript;+charset=utf-8 5.8913ms
2022-09-21 17:49:27.943 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/_vs/browserLink - -
2022-09-21 17:49:27.967 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/_vs/browserLink - - - 200 - text/javascript;+charset=UTF-8 23.4584ms
2022-09-21 17:49:28.047 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/swagger/v1/swagger.json - -
2022-09-21 17:49:28.048 +01:00 [DBG] No candidates found for the request path '/swagger/v1/swagger.json'
2022-09-21 17:49:28.049 +01:00 [DBG] Request did not match any endpoints
2022-09-21 17:49:28.161 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/swagger/v1/swagger.json - - - 200 - application/json;charset=utf-8 114.0642ms
2022-09-21 17:51:39.641 +01:00 [DBG] Connection id "0HMKRU4VHHSE8" is closing.
2022-09-21 17:51:39.649 +01:00 [DBG] Connection id "0HMKRU4VHHSE8" is closed. The last processed stream ID was 7.
2022-09-21 17:51:39.652 +01:00 [DBG] Connection id "0HMKRU4VHHSE8" received FIN.
2022-09-21 17:51:39.653 +01:00 [DBG] Connection id "0HMKRU4VHHSE8" sending FIN because: "The client closed the connection."
2022-09-21 17:51:39.656 +01:00 [DBG] Connection id "0HMKRU4VHHSE8" stopped.
2022-09-21 17:52:43.622 +01:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2022-09-21 17:52:43.829 +01:00 [DBG] Hosting starting
2022-09-21 17:52:44.614 +01:00 [DBG] Using development certificate: CN=localhost (Thumbprint: 9CC642E9838495A6C3C202DECA6A8AD300396DD2)
2022-09-21 17:52:44.753 +01:00 [INF] Now listening on: https://localhost:7036
2022-09-21 17:52:44.761 +01:00 [INF] Now listening on: http://localhost:5036
2022-09-21 17:52:44.763 +01:00 [DBG] Loaded hosting startup assembly APIBank
2022-09-21 17:52:44.763 +01:00 [DBG] Loaded hosting startup assembly Microsoft.AspNetCore.Watch.BrowserRefresh
2022-09-21 17:52:44.765 +01:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.BrowserLink.Net
2022-09-21 17:52:44.767 +01:00 [INF] Application started. Press Ctrl+C to shut down.
2022-09-21 17:52:44.768 +01:00 [INF] Hosting environment: Development
2022-09-21 17:52:44.769 +01:00 [INF] Content root path: C:\Users\mguedesa\OneDrive - NTT DATA EMEAL\Documentos\GitHub\OpenBankAPI-NTT\APIBank\APIBank\
2022-09-21 17:52:44.770 +01:00 [DBG] Hosting started
2022-09-21 17:52:45.183 +01:00 [DBG] Connection id "0HMKRU6QFCF75" accepted.
2022-09-21 17:52:45.183 +01:00 [DBG] Connection id "0HMKRU6QFCF74" accepted.
2022-09-21 17:52:45.186 +01:00 [DBG] Connection id "0HMKRU6QFCF75" started.
2022-09-21 17:52:45.186 +01:00 [DBG] Connection id "0HMKRU6QFCF74" started.
2022-09-21 17:52:45.200 +01:00 [DBG] Connection id "0HMKRU6QFCF75" received FIN.
2022-09-21 17:52:45.200 +01:00 [DBG] Connection id "0HMKRU6QFCF74" received FIN.
2022-09-21 17:52:45.221 +01:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException:  Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.<FillHandshakeBufferAsync>g__InternalFillHandshakeBufferAsync|189_0[TIOAdapter](TIOAdapter adap, ValueTask`1 task, Int32 minSize)
   at System.Net.Security.SslStream.ReceiveBlobAsync[TIOAdapter](TIOAdapter adapter)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](TIOAdapter adapter, Boolean receiveFirst, Byte[] reAuthenticationData, Boolean isApm)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2022-09-21 17:52:45.221 +01:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException:  Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.<FillHandshakeBufferAsync>g__InternalFillHandshakeBufferAsync|189_0[TIOAdapter](TIOAdapter adap, ValueTask`1 task, Int32 minSize)
   at System.Net.Security.SslStream.ReceiveBlobAsync[TIOAdapter](TIOAdapter adapter)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](TIOAdapter adapter, Boolean receiveFirst, Byte[] reAuthenticationData, Boolean isApm)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2022-09-21 17:52:45.288 +01:00 [DBG] Connection id "0HMKRU6QFCF74" stopped.
2022-09-21 17:52:45.288 +01:00 [DBG] Connection id "0HMKRU6QFCF75" stopped.
2022-09-21 17:52:45.293 +01:00 [DBG] Connection id "0HMKRU6QFCF74" sending FIN because: "The Socket transport's send loop completed gracefully."
2022-09-21 17:52:45.293 +01:00 [DBG] Connection id "0HMKRU6QFCF75" sending FIN because: "The Socket transport's send loop completed gracefully."
2022-09-21 17:52:45.947 +01:00 [DBG] Connection id "0HMKRU6QFCF76" accepted.
2022-09-21 17:52:45.954 +01:00 [DBG] Connection id "0HMKRU6QFCF76" started.
2022-09-21 17:52:46.049 +01:00 [DBG] Connection 0HMKRU6QFCF76 established using the following protocol: "Tls12"
2022-09-21 17:52:46.206 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/swagger/index.html - -
2022-09-21 17:52:46.294 +01:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2022-09-21 17:52:46.322 +01:00 [DBG] No candidates found for the request path '/swagger/index.html'
2022-09-21 17:52:46.323 +01:00 [DBG] Request did not match any endpoints
2022-09-21 17:52:46.474 +01:00 [DBG] Response markup is scheduled to include browser refresh script injection.
2022-09-21 17:52:46.669 +01:00 [DBG] Response markup was updated to include browser refresh script injection.
2022-09-21 17:52:46.693 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/_framework/aspnetcore-browser-refresh.js - -
2022-09-21 17:52:46.694 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/swagger/index.html - - - 200 - text/html;charset=utf-8 496.8154ms
2022-09-21 17:52:46.704 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/_vs/browserLink - -
2022-09-21 17:52:46.716 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/_framework/aspnetcore-browser-refresh.js - - - 200 11984 application/javascript;+charset=utf-8 23.5126ms
2022-09-21 17:52:46.740 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/_vs/browserLink - - - 200 - text/javascript;+charset=UTF-8 35.4316ms
2022-09-21 17:52:46.824 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/swagger/v1/swagger.json - -
2022-09-21 17:52:46.826 +01:00 [DBG] No candidates found for the request path '/swagger/v1/swagger.json'
2022-09-21 17:52:46.827 +01:00 [DBG] Request did not match any endpoints
2022-09-21 17:52:47.021 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/swagger/v1/swagger.json - - - 200 - application/json;charset=utf-8 196.9064ms
2022-09-21 17:53:18.960 +01:00 [INF] Request starting HTTP/2 POST https://localhost:7036/api/Users/Login application/json 58
2022-09-21 17:53:18.978 +01:00 [DBG] 1 candidate(s) found for the request path '/api/Users/Login'
2022-09-21 17:53:18.986 +01:00 [DBG] Endpoint 'APIBank.Controllers.UsersController.Login (APIBank)' with route pattern 'api/Users/Login' is valid for the request path '/api/Users/Login'
2022-09-21 17:53:18.991 +01:00 [DBG] Request matched endpoint 'APIBank.Controllers.UsersController.Login (APIBank)'
2022-09-21 17:53:18.995 +01:00 [DBG] Static files was skipped as the request already matched an endpoint.
2022-09-21 17:53:19.460 +01:00 [INF] Executing endpoint 'APIBank.Controllers.UsersController.Login (APIBank)'
2022-09-21 17:53:19.488 +01:00 [INF] Route matched with {action = "Login", controller = "Users"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult Login(APIBank.Models.Requests.LoginRequest) on controller APIBank.Controllers.UsersController (APIBank).
2022-09-21 17:53:19.491 +01:00 [DBG] Execution plan of authorization filters (in the following order): ["APIBank.Authorization.AuthorizeAttribute"]
2022-09-21 17:53:19.493 +01:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2022-09-21 17:53:19.494 +01:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2022-09-21 17:53:19.496 +01:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2022-09-21 17:53:19.497 +01:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2022-09-21 17:53:19.502 +01:00 [DBG] Executing controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-21 17:53:19.503 +01:00 [DBG] Executed controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-21 17:53:19.521 +01:00 [DBG] Attempting to bind parameter 'model' of type 'APIBank.Models.Requests.LoginRequest' ...
2022-09-21 17:53:19.524 +01:00 [DBG] Attempting to bind parameter 'model' of type 'APIBank.Models.Requests.LoginRequest' using the name '' in request data ...
2022-09-21 17:53:19.525 +01:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2022-09-21 17:53:19.531 +01:00 [DBG] Connection id "0HMKRU6QFCF76", Request id "0HMKRU6QFCF76:00000009": started reading request body.
2022-09-21 17:53:19.532 +01:00 [DBG] Connection id "0HMKRU6QFCF76", Request id "0HMKRU6QFCF76:00000009": done reading request body.
2022-09-21 17:53:19.540 +01:00 [DBG] JSON input formatter succeeded, deserializing to type 'APIBank.Models.Requests.LoginRequest'
2022-09-21 17:53:19.541 +01:00 [DBG] Done attempting to bind parameter 'model' of type 'APIBank.Models.Requests.LoginRequest'.
2022-09-21 17:53:19.542 +01:00 [DBG] Done attempting to bind parameter 'model' of type 'APIBank.Models.Requests.LoginRequest'.
2022-09-21 17:53:19.543 +01:00 [DBG] Attempting to validate the bound parameter 'model' of type 'APIBank.Models.Requests.LoginRequest' ...
2022-09-21 17:53:19.552 +01:00 [DBG] Done attempting to validate the bound parameter 'model' of type 'APIBank.Models.Requests.LoginRequest'.
2022-09-21 17:53:19.695 +01:00 [DBG] An additional 'IServiceProvider' was created for internal use by Entity Framework. An existing service provider was not used due to the following configuration changes: configuration changed for 'Core:ConfigureWarnings', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:UseAdminDatabase', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:SetPostgresVersion', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:UseRedshift', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:ReverseNullOrdering', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:RemoteCertificateValidationCallback', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:ProvideClientCertificatesCallback', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:ProvidePasswordCallback'.
2022-09-21 17:53:21.216 +01:00 [INF] Entity Framework Core 6.0.9 initialized 'PostgresContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:6.0.7+5b98e4b74de93b590b44aef8dd7967c03acc433c' with options: None
2022-09-21 17:53:21.326 +01:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .SingleOrDefault(x => x.Username == __model_Username_0)'
2022-09-21 17:53:21.849 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<User>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: User.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: User.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 1], [Property: User.Email (string) Required Index MaxLength(254), 2], [Property: User.FullName (string) Required MaxLength(100), 3], [Property: User.PasswordChangedAt (DateTime) Required ValueGenerated.OnAdd, 4], [Property: User.PasswordHash (string) Required MaxLength(200), 5], [Property: User.Username (string) Required Index MaxLength(50), 6] }
        SELECT TOP(2) u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
        FROM users AS u
        WHERE u.username == @__model_Username_0), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, User>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)
    .SingleOrDefault()'
2022-09-21 17:53:21.916 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-21 17:53:22.028 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (110ms).
2022-09-21 17:53:22.043 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-21 17:53:22.365 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 17:53:22.392 +01:00 [DBG] Executing DbCommand [Parameters=[@__model_Username_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.username = @__model_Username_0
LIMIT 2
2022-09-21 17:53:22.536 +01:00 [INF] Executed DbCommand (153ms) [Parameters=[@__model_Username_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.username = @__model_Username_0
LIMIT 2
2022-09-21 17:53:22.610 +01:00 [DBG] Context 'PostgresContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 17:53:22.691 +01:00 [DBG] A data reader was disposed.
2022-09-21 17:53:22.701 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 17:53:22.718 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-21 17:53:23.187 +01:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .Any(user => user.RefreshTokenCollection
        .Any(reftoken => reftoken.RefToken == __token_0))'
2022-09-21 17:53:23.332 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<bool>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            EmptyProjectionMember -> 0
        SELECT EXISTS (
            SELECT 1
            FROM users AS u
            WHERE EXISTS (
                SELECT 1
                FROM refresh_token AS r
                WHERE ((u.id != NULL) && (u.id == r.user_id)) && (r.token == @__token_0)))), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, bool>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)
    .Single()'
2022-09-21 17:53:23.347 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-21 17:53:23.349 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2022-09-21 17:53:23.350 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-21 17:53:23.351 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 17:53:23.352 +01:00 [DBG] Executing DbCommand [Parameters=[@__token_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM users AS u
    WHERE EXISTS (
        SELECT 1
        FROM refresh_token AS r
        WHERE (u.id = r.user_id) AND (r.token = @__token_0)))
2022-09-21 17:53:23.355 +01:00 [INF] Executed DbCommand (4ms) [Parameters=[@__token_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM users AS u
    WHERE EXISTS (
        SELECT 1
        FROM refresh_token AS r
        WHERE (u.id = r.user_id) AND (r.token = @__token_0)))
2022-09-21 17:53:23.361 +01:00 [DBG] A data reader was disposed.
2022-09-21 17:53:23.362 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 17:53:23.364 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-21 17:53:23.381 +01:00 [DBG] Compiling query expression: 
'DbSet<RefreshToken>()
    .Where(rt => rt.UserId == __id_0)
    .AsNoTracking()
    .Select(rt => new RefreshToken{ 
        Id = rt.Id, 
        UserId = rt.UserId, 
        RefToken = rt.RefToken, 
        Expires = rt.Expires, 
        Created = rt.Created, 
        CreatedByIp = rt.CreatedByIp, 
        Revoked = rt.Revoked, 
        RevokedByIp = rt.RevokedByIp, 
        ReplacedByToken = rt.ReplacedByToken, 
        ReasonRevoked = rt.ReasonRevoked, 
        IsExpired = rt.IsExpired, 
        IsRevoked = rt.IsRevoked, 
        IsActive = rt.IsActive 
    }
    )'
2022-09-21 17:53:23.413 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<RefreshToken>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            Id -> 0
            UserId -> 1
            RefToken -> 2
            Expires -> 3
            Created -> 4
            CreatedByIp -> 5
            Revoked -> 6
            RevokedByIp -> 7
            ReplacedByToken -> 8
            ReasonRevoked -> 9
            IsExpired -> 10
            IsRevoked -> 11
            IsActive -> 12
        SELECT r.id AS Id, r.user_id AS UserId, r.token AS RefToken, r.expires AS Expires, r.created AS Created, r.created_by_ip AS CreatedByIp, r.revoked AS Revoked, r.revoked_by_ip AS RevokedByIp, r.replaced_by_token AS ReplacedByToken, r.reason_revoked AS ReasonRevoked, r.is_expired AS IsExpired, r.is_revoked AS IsRevoked, r.is_active AS IsActive
        FROM refresh_token AS r
        WHERE r.user_id == @__id_0), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, RefreshToken>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)'
2022-09-21 17:53:23.417 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-21 17:53:23.419 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2022-09-21 17:53:23.420 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-21 17:53:23.421 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 17:53:23.422 +01:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.user_id AS "UserId", r.token AS "RefToken", r.expires AS "Expires", r.created AS "Created", r.created_by_ip AS "CreatedByIp", r.revoked AS "Revoked", r.revoked_by_ip AS "RevokedByIp", r.replaced_by_token AS "ReplacedByToken", r.reason_revoked AS "ReasonRevoked", r.is_expired AS "IsExpired", r.is_revoked AS "IsRevoked", r.is_active AS "IsActive"
FROM refresh_token AS r
WHERE r.user_id = @__id_0
2022-09-21 17:53:23.431 +01:00 [INF] Executed DbCommand (9ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.user_id AS "UserId", r.token AS "RefToken", r.expires AS "Expires", r.created AS "Created", r.created_by_ip AS "CreatedByIp", r.revoked AS "Revoked", r.revoked_by_ip AS "RevokedByIp", r.replaced_by_token AS "ReplacedByToken", r.reason_revoked AS "ReasonRevoked", r.is_expired AS "IsExpired", r.is_revoked AS "IsRevoked", r.is_active AS "IsActive"
FROM refresh_token AS r
WHERE r.user_id = @__id_0
2022-09-21 17:53:23.435 +01:00 [DBG] A data reader was disposed.
2022-09-21 17:53:23.436 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 17:53:23.437 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-21 17:53:23.453 +01:00 [DBG] An entity of type 'User' tracked by 'PostgresContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 17:53:23.490 +01:00 [DBG] 'PostgresContext' generated a temporary value for the property 'Id.RefreshToken'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 17:53:23.541 +01:00 [DBG] Context 'PostgresContext' started tracking 'RefreshToken' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 17:53:23.547 +01:00 [DBG] SaveChanges starting for 'PostgresContext'.
2022-09-21 17:53:23.551 +01:00 [DBG] DetectChanges starting for 'PostgresContext'.
2022-09-21 17:53:23.606 +01:00 [DBG] 1 entities were added and 0 entities were removed from navigation 'User.RefreshTokenCollection'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 17:53:23.636 +01:00 [DBG] The foreign key property 'RefreshToken.UserId' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2022-09-21 17:53:23.673 +01:00 [DBG] DetectChanges completed for 'PostgresContext'.
2022-09-21 17:53:23.686 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-21 17:53:23.687 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 17:53:23.690 +01:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2022-09-21 17:53:23.704 +01:00 [DBG] Began transaction with isolation level 'ReadCommitted'.
2022-09-21 17:53:23.768 +01:00 [DBG] Executing 2 update commands as a batch.
2022-09-21 17:53:23.808 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-21 17:53:23.811 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (3ms).
2022-09-21 17:53:23.815 +01:00 [DBG] Executing DbCommand [Parameters=[@p0='?' (DbType = DateTime), @p1='?', @p2='?' (DbType = DateTime), @p3='?' (DbType = Boolean), @p4='?' (DbType = Boolean), @p5='?' (DbType = Boolean), @p6='?', @p7='?', @p8='?', @p9='?' (DbType = DateTime), @p10='?', @p11='?' (DbType = Int32), @p18='?' (DbType = Int32), @p12='?' (DbType = DateTime), @p13='?', @p14='?', @p15='?' (DbType = DateTime), @p16='?', @p17='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO refresh_token (created, created_by_ip, expires, is_active, is_expired, is_revoked, reason_revoked, token, replaced_by_token, revoked, revoked_by_ip, user_id)
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11)
RETURNING id;
UPDATE users SET created_at = @p12, email = @p13, full_name = @p14, password_changed_at = @p15, password_hash = @p16, username = @p17
WHERE id = @p18;
2022-09-21 17:53:23.837 +01:00 [INF] Executed DbCommand (22ms) [Parameters=[@p0='?' (DbType = DateTime), @p1='?', @p2='?' (DbType = DateTime), @p3='?' (DbType = Boolean), @p4='?' (DbType = Boolean), @p5='?' (DbType = Boolean), @p6='?', @p7='?', @p8='?', @p9='?' (DbType = DateTime), @p10='?', @p11='?' (DbType = Int32), @p18='?' (DbType = Int32), @p12='?' (DbType = DateTime), @p13='?', @p14='?', @p15='?' (DbType = DateTime), @p16='?', @p17='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO refresh_token (created, created_by_ip, expires, is_active, is_expired, is_revoked, reason_revoked, token, replaced_by_token, revoked, revoked_by_ip, user_id)
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11)
RETURNING id;
UPDATE users SET created_at = @p12, email = @p13, full_name = @p14, password_changed_at = @p15, password_hash = @p16, username = @p17
WHERE id = @p18;
2022-09-21 17:53:23.872 +01:00 [DBG] The foreign key property 'RefreshToken.Id' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2022-09-21 17:53:23.880 +01:00 [DBG] A data reader was disposed.
2022-09-21 17:53:23.887 +01:00 [DBG] Committing transaction.
2022-09-21 17:53:23.902 +01:00 [DBG] Committed transaction.
2022-09-21 17:53:23.905 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 17:53:23.907 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-21 17:53:23.911 +01:00 [DBG] Disposing transaction.
2022-09-21 17:53:23.917 +01:00 [DBG] An entity of type 'RefreshToken' tracked by 'PostgresContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 17:53:23.920 +01:00 [DBG] An entity of type 'User' tracked by 'PostgresContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 17:53:23.924 +01:00 [DBG] SaveChanges completed for 'PostgresContext' with 2 entities written to the database.
2022-09-21 17:53:23.936 +01:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2022-09-21 17:53:23.943 +01:00 [DBG] Attempting to select an output formatter based on Accept header '["text/plain"]'.
2022-09-21 17:53:23.944 +01:00 [DBG] Could not find an output formatter based on content negotiation. Accepted types were (["text/plain"])
2022-09-21 17:53:23.947 +01:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2022-09-21 17:53:23.949 +01:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2022-09-21 17:53:23.950 +01:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2022-09-21 17:53:23.951 +01:00 [INF] Executing OkObjectResult, writing value of type 'APIBank.Models.Users.Responses.LoginResponse'.
2022-09-21 17:53:23.971 +01:00 [INF] Executed action APIBank.Controllers.UsersController.Login (APIBank) in 4466.9917ms
2022-09-21 17:53:23.974 +01:00 [INF] Executed endpoint 'APIBank.Controllers.UsersController.Login (APIBank)'
2022-09-21 17:53:23.981 +01:00 [DBG] 'PostgresContext' disposed.
2022-09-21 17:53:23.987 +01:00 [INF] Request finished HTTP/2 POST https://localhost:7036/api/Users/Login application/json 58 - 200 - application/json;+charset=utf-8 5027.1989ms
2022-09-21 17:53:39.118 +01:00 [INF] Request starting HTTP/2 POST https://localhost:7036/api/Users/revoke-token application/json 17
2022-09-21 17:53:39.130 +01:00 [DBG] 1 candidate(s) found for the request path '/api/Users/revoke-token'
2022-09-21 17:53:39.133 +01:00 [DBG] Endpoint 'APIBank.Controllers.UsersController.RevokeToken (APIBank)' with route pattern 'api/Users/revoke-token' is valid for the request path '/api/Users/revoke-token'
2022-09-21 17:53:39.137 +01:00 [DBG] Request matched endpoint 'APIBank.Controllers.UsersController.RevokeToken (APIBank)'
2022-09-21 17:53:39.138 +01:00 [DBG] Static files was skipped as the request already matched an endpoint.
2022-09-21 17:53:39.283 +01:00 [INF] Entity Framework Core 6.0.9 initialized 'PostgresContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:6.0.7+5b98e4b74de93b590b44aef8dd7967c03acc433c' with options: None
2022-09-21 17:53:39.296 +01:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .FirstOrDefault(e => EF.Property<int>(e, "Id") == __p_0)'
2022-09-21 17:53:39.304 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<User>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: User.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: User.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 1], [Property: User.Email (string) Required Index MaxLength(254), 2], [Property: User.FullName (string) Required MaxLength(100), 3], [Property: User.PasswordChangedAt (DateTime) Required ValueGenerated.OnAdd, 4], [Property: User.PasswordHash (string) Required MaxLength(200), 5], [Property: User.Username (string) Required Index MaxLength(50), 6] }
        SELECT TOP(1) u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
        FROM users AS u
        WHERE u.id == @__p_0), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, User>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)
    .SingleOrDefault()'
2022-09-21 17:53:39.306 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-21 17:53:39.307 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2022-09-21 17:53:39.308 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-21 17:53:39.308 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 17:53:39.309 +01:00 [DBG] Executing DbCommand [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.id = @__p_0
LIMIT 1
2022-09-21 17:53:39.311 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.id = @__p_0
LIMIT 1
2022-09-21 17:53:39.313 +01:00 [DBG] Context 'PostgresContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 17:53:39.314 +01:00 [DBG] A data reader was disposed.
2022-09-21 17:53:39.314 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 17:53:39.315 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-21 17:53:39.316 +01:00 [INF] Executing endpoint 'APIBank.Controllers.UsersController.RevokeToken (APIBank)'
2022-09-21 17:53:39.319 +01:00 [INF] Route matched with {action = "RevokeToken", controller = "Users"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult RevokeToken(APIBank.Models.Users.Requests.RevokeTokenRequest) on controller APIBank.Controllers.UsersController (APIBank).
2022-09-21 17:53:39.322 +01:00 [DBG] Execution plan of authorization filters (in the following order): ["APIBank.Authorization.AuthorizeAttribute"]
2022-09-21 17:53:39.324 +01:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2022-09-21 17:53:39.325 +01:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2022-09-21 17:53:39.326 +01:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2022-09-21 17:53:39.328 +01:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2022-09-21 17:53:39.329 +01:00 [DBG] Executing controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-21 17:53:39.329 +01:00 [DBG] Executed controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-21 17:53:39.330 +01:00 [DBG] Attempting to bind parameter 'model' of type 'APIBank.Models.Users.Requests.RevokeTokenRequest' ...
2022-09-21 17:53:39.331 +01:00 [DBG] Attempting to bind parameter 'model' of type 'APIBank.Models.Users.Requests.RevokeTokenRequest' using the name '' in request data ...
2022-09-21 17:53:39.333 +01:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2022-09-21 17:53:39.337 +01:00 [DBG] Connection id "0HMKRU6QFCF76", Request id "0HMKRU6QFCF76:0000000B": started reading request body.
2022-09-21 17:53:39.338 +01:00 [DBG] Connection id "0HMKRU6QFCF76", Request id "0HMKRU6QFCF76:0000000B": done reading request body.
2022-09-21 17:53:39.342 +01:00 [DBG] JSON input formatter succeeded, deserializing to type 'APIBank.Models.Users.Requests.RevokeTokenRequest'
2022-09-21 17:53:39.343 +01:00 [DBG] Done attempting to bind parameter 'model' of type 'APIBank.Models.Users.Requests.RevokeTokenRequest'.
2022-09-21 17:53:39.343 +01:00 [DBG] Done attempting to bind parameter 'model' of type 'APIBank.Models.Users.Requests.RevokeTokenRequest'.
2022-09-21 17:53:39.344 +01:00 [DBG] Attempting to validate the bound parameter 'model' of type 'APIBank.Models.Users.Requests.RevokeTokenRequest' ...
2022-09-21 17:53:39.345 +01:00 [DBG] Done attempting to validate the bound parameter 'model' of type 'APIBank.Models.Users.Requests.RevokeTokenRequest'.
2022-09-21 17:54:40.998 +01:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2022-09-21 17:54:41.232 +01:00 [DBG] Hosting starting
2022-09-21 17:54:41.733 +01:00 [DBG] Using development certificate: CN=localhost (Thumbprint: 9CC642E9838495A6C3C202DECA6A8AD300396DD2)
2022-09-21 17:54:41.813 +01:00 [INF] Now listening on: https://localhost:7036
2022-09-21 17:54:41.822 +01:00 [INF] Now listening on: http://localhost:5036
2022-09-21 17:54:41.822 +01:00 [DBG] Loaded hosting startup assembly APIBank
2022-09-21 17:54:41.823 +01:00 [DBG] Loaded hosting startup assembly Microsoft.AspNetCore.Watch.BrowserRefresh
2022-09-21 17:54:41.824 +01:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.BrowserLink.Net
2022-09-21 17:54:41.825 +01:00 [INF] Application started. Press Ctrl+C to shut down.
2022-09-21 17:54:41.826 +01:00 [INF] Hosting environment: Development
2022-09-21 17:54:41.827 +01:00 [INF] Content root path: C:\Users\mguedesa\OneDrive - NTT DATA EMEAL\Documentos\GitHub\OpenBankAPI-NTT\APIBank\APIBank\
2022-09-21 17:54:41.829 +01:00 [DBG] Hosting started
2022-09-21 17:54:42.287 +01:00 [DBG] Connection id "0HMKRU7TC6FEP" received FIN.
2022-09-21 17:54:42.287 +01:00 [DBG] Connection id "0HMKRU7TC6FEO" received FIN.
2022-09-21 17:54:42.291 +01:00 [DBG] Connection id "0HMKRU7TC6FEO" accepted.
2022-09-21 17:54:42.291 +01:00 [DBG] Connection id "0HMKRU7TC6FEN" accepted.
2022-09-21 17:54:42.295 +01:00 [DBG] Connection id "0HMKRU7TC6FEN" started.
2022-09-21 17:54:42.295 +01:00 [DBG] Connection id "0HMKRU7TC6FEO" started.
2022-09-21 17:54:42.330 +01:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException:  Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveBlobAsync[TIOAdapter](TIOAdapter adapter)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](TIOAdapter adapter, Boolean receiveFirst, Byte[] reAuthenticationData, Boolean isApm)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2022-09-21 17:54:42.330 +01:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException:  Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveBlobAsync[TIOAdapter](TIOAdapter adapter)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](TIOAdapter adapter, Boolean receiveFirst, Byte[] reAuthenticationData, Boolean isApm)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2022-09-21 17:54:42.446 +01:00 [DBG] Connection id "0HMKRU7TC6FEO" stopped.
2022-09-21 17:54:42.446 +01:00 [DBG] Connection id "0HMKRU7TC6FEN" stopped.
2022-09-21 17:54:42.453 +01:00 [DBG] Connection id "0HMKRU7TC6FEO" sending FIN because: "The Socket transport's send loop completed gracefully."
2022-09-21 17:54:42.453 +01:00 [DBG] Connection id "0HMKRU7TC6FEN" sending FIN because: "The Socket transport's send loop completed gracefully."
2022-09-21 17:54:42.554 +01:00 [DBG] Connection id "0HMKRU7TC6FEQ" accepted.
2022-09-21 17:54:42.573 +01:00 [DBG] Connection id "0HMKRU7TC6FEQ" started.
2022-09-21 17:54:42.685 +01:00 [DBG] Connection 0HMKRU7TC6FEQ established using the following protocol: "Tls12"
2022-09-21 17:54:42.778 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/swagger/index.html - -
2022-09-21 17:54:42.842 +01:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2022-09-21 17:54:42.872 +01:00 [DBG] No candidates found for the request path '/swagger/index.html'
2022-09-21 17:54:42.873 +01:00 [DBG] Request did not match any endpoints
2022-09-21 17:54:42.981 +01:00 [DBG] Response markup is scheduled to include browser refresh script injection.
2022-09-21 17:54:43.139 +01:00 [DBG] Response markup was updated to include browser refresh script injection.
2022-09-21 17:54:43.147 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/swagger/index.html - - - 200 - text/html;charset=utf-8 377.2675ms
2022-09-21 17:54:43.170 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/_vs/browserLink - -
2022-09-21 17:54:43.171 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/_framework/aspnetcore-browser-refresh.js - -
2022-09-21 17:54:43.183 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/_framework/aspnetcore-browser-refresh.js - - - 200 11984 application/javascript;+charset=utf-8 12.0681ms
2022-09-21 17:54:43.209 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/_vs/browserLink - - - 200 - text/javascript;+charset=UTF-8 38.2942ms
2022-09-21 17:54:43.281 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/swagger/v1/swagger.json - -
2022-09-21 17:54:43.283 +01:00 [DBG] No candidates found for the request path '/swagger/v1/swagger.json'
2022-09-21 17:54:43.284 +01:00 [DBG] Request did not match any endpoints
2022-09-21 17:54:43.477 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/swagger/v1/swagger.json - - - 200 - application/json;charset=utf-8 195.8628ms
2022-09-21 17:55:05.027 +01:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2022-09-21 17:55:05.168 +01:00 [DBG] Hosting starting
2022-09-21 17:55:05.874 +01:00 [DBG] Using development certificate: CN=localhost (Thumbprint: 9CC642E9838495A6C3C202DECA6A8AD300396DD2)
2022-09-21 17:55:05.992 +01:00 [INF] Now listening on: https://localhost:7036
2022-09-21 17:55:05.994 +01:00 [INF] Now listening on: http://localhost:5036
2022-09-21 17:55:05.995 +01:00 [DBG] Loaded hosting startup assembly APIBank
2022-09-21 17:55:05.996 +01:00 [DBG] Loaded hosting startup assembly Microsoft.AspNetCore.Watch.BrowserRefresh
2022-09-21 17:55:05.996 +01:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.BrowserLink.Net
2022-09-21 17:55:05.997 +01:00 [INF] Application started. Press Ctrl+C to shut down.
2022-09-21 17:55:05.998 +01:00 [INF] Hosting environment: Development
2022-09-21 17:55:05.999 +01:00 [INF] Content root path: C:\Users\mguedesa\OneDrive - NTT DATA EMEAL\Documentos\GitHub\OpenBankAPI-NTT\APIBank\APIBank\
2022-09-21 17:55:05.999 +01:00 [DBG] Hosting started
2022-09-21 17:55:06.136 +01:00 [DBG] Connection id "0HMKRU84FKR2G" received FIN.
2022-09-21 17:55:06.136 +01:00 [DBG] Connection id "0HMKRU84FKR2H" received FIN.
2022-09-21 17:55:06.145 +01:00 [DBG] Connection id "0HMKRU84FKR2G" accepted.
2022-09-21 17:55:06.145 +01:00 [DBG] Connection id "0HMKRU84FKR2H" accepted.
2022-09-21 17:55:06.147 +01:00 [DBG] Connection id "0HMKRU84FKR2G" started.
2022-09-21 17:55:06.147 +01:00 [DBG] Connection id "0HMKRU84FKR2H" started.
2022-09-21 17:55:06.164 +01:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException:  Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveBlobAsync[TIOAdapter](TIOAdapter adapter)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](TIOAdapter adapter, Boolean receiveFirst, Byte[] reAuthenticationData, Boolean isApm)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2022-09-21 17:55:06.164 +01:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException:  Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveBlobAsync[TIOAdapter](TIOAdapter adapter)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](TIOAdapter adapter, Boolean receiveFirst, Byte[] reAuthenticationData, Boolean isApm)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2022-09-21 17:55:06.202 +01:00 [DBG] Connection id "0HMKRU84FKR2H" stopped.
2022-09-21 17:55:06.202 +01:00 [DBG] Connection id "0HMKRU84FKR2G" stopped.
2022-09-21 17:55:06.206 +01:00 [DBG] Connection id "0HMKRU84FKR2G" sending FIN because: "The Socket transport's send loop completed gracefully."
2022-09-21 17:55:06.206 +01:00 [DBG] Connection id "0HMKRU84FKR2H" sending FIN because: "The Socket transport's send loop completed gracefully."
2022-09-21 17:55:06.752 +01:00 [DBG] Connection id "0HMKRU84FKR2I" accepted.
2022-09-21 17:55:06.760 +01:00 [DBG] Connection id "0HMKRU84FKR2I" started.
2022-09-21 17:55:06.886 +01:00 [DBG] Connection 0HMKRU84FKR2I established using the following protocol: "Tls12"
2022-09-21 17:55:06.978 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/swagger/index.html - -
2022-09-21 17:55:07.035 +01:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2022-09-21 17:55:07.067 +01:00 [DBG] No candidates found for the request path '/swagger/index.html'
2022-09-21 17:55:07.069 +01:00 [DBG] Request did not match any endpoints
2022-09-21 17:55:07.182 +01:00 [DBG] Response markup is scheduled to include browser refresh script injection.
2022-09-21 17:55:07.384 +01:00 [DBG] Response markup was updated to include browser refresh script injection.
2022-09-21 17:55:07.392 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/swagger/index.html - - - 200 - text/html;charset=utf-8 421.6694ms
2022-09-21 17:55:07.419 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/_vs/browserLink - -
2022-09-21 17:55:07.419 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/_framework/aspnetcore-browser-refresh.js - -
2022-09-21 17:55:07.435 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/_framework/aspnetcore-browser-refresh.js - - - 200 11984 application/javascript;+charset=utf-8 16.2989ms
2022-09-21 17:55:07.477 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/_vs/browserLink - - - 200 - text/javascript;+charset=UTF-8 58.6562ms
2022-09-21 17:55:07.551 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/swagger/v1/swagger.json - -
2022-09-21 17:55:07.552 +01:00 [DBG] No candidates found for the request path '/swagger/v1/swagger.json'
2022-09-21 17:55:07.553 +01:00 [DBG] Request did not match any endpoints
2022-09-21 17:55:07.734 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/swagger/v1/swagger.json - - - 200 - application/json;charset=utf-8 183.4091ms
2022-09-21 17:55:27.499 +01:00 [INF] Request starting HTTP/2 POST https://localhost:7036/api/Users/Login application/json 58
2022-09-21 17:55:27.517 +01:00 [DBG] 1 candidate(s) found for the request path '/api/Users/Login'
2022-09-21 17:55:27.524 +01:00 [DBG] Endpoint 'APIBank.Controllers.UsersController.Login (APIBank)' with route pattern 'api/Users/Login' is valid for the request path '/api/Users/Login'
2022-09-21 17:55:27.529 +01:00 [DBG] Request matched endpoint 'APIBank.Controllers.UsersController.Login (APIBank)'
2022-09-21 17:55:27.532 +01:00 [DBG] Static files was skipped as the request already matched an endpoint.
2022-09-21 17:55:28.014 +01:00 [INF] Executing endpoint 'APIBank.Controllers.UsersController.Login (APIBank)'
2022-09-21 17:55:28.041 +01:00 [INF] Route matched with {action = "Login", controller = "Users"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult Login(APIBank.Models.Requests.LoginRequest) on controller APIBank.Controllers.UsersController (APIBank).
2022-09-21 17:55:28.044 +01:00 [DBG] Execution plan of authorization filters (in the following order): ["APIBank.Authorization.AuthorizeAttribute"]
2022-09-21 17:55:28.045 +01:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2022-09-21 17:55:28.046 +01:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2022-09-21 17:55:28.048 +01:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2022-09-21 17:55:28.049 +01:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2022-09-21 17:55:28.052 +01:00 [DBG] Executing controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-21 17:55:28.053 +01:00 [DBG] Executed controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-21 17:55:28.076 +01:00 [DBG] Attempting to bind parameter 'model' of type 'APIBank.Models.Requests.LoginRequest' ...
2022-09-21 17:55:28.079 +01:00 [DBG] Attempting to bind parameter 'model' of type 'APIBank.Models.Requests.LoginRequest' using the name '' in request data ...
2022-09-21 17:55:28.081 +01:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2022-09-21 17:55:28.087 +01:00 [DBG] Connection id "0HMKRU84FKR2I", Request id "0HMKRU84FKR2I:00000009": started reading request body.
2022-09-21 17:55:28.090 +01:00 [DBG] Connection id "0HMKRU84FKR2I", Request id "0HMKRU84FKR2I:00000009": done reading request body.
2022-09-21 17:55:28.100 +01:00 [DBG] JSON input formatter succeeded, deserializing to type 'APIBank.Models.Requests.LoginRequest'
2022-09-21 17:55:28.101 +01:00 [DBG] Done attempting to bind parameter 'model' of type 'APIBank.Models.Requests.LoginRequest'.
2022-09-21 17:55:28.102 +01:00 [DBG] Done attempting to bind parameter 'model' of type 'APIBank.Models.Requests.LoginRequest'.
2022-09-21 17:55:28.103 +01:00 [DBG] Attempting to validate the bound parameter 'model' of type 'APIBank.Models.Requests.LoginRequest' ...
2022-09-21 17:55:28.113 +01:00 [DBG] Done attempting to validate the bound parameter 'model' of type 'APIBank.Models.Requests.LoginRequest'.
2022-09-21 17:55:28.241 +01:00 [DBG] An additional 'IServiceProvider' was created for internal use by Entity Framework. An existing service provider was not used due to the following configuration changes: configuration changed for 'Core:ConfigureWarnings', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:UseAdminDatabase', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:SetPostgresVersion', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:UseRedshift', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:ReverseNullOrdering', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:RemoteCertificateValidationCallback', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:ProvideClientCertificatesCallback', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:ProvidePasswordCallback'.
2022-09-21 17:55:29.861 +01:00 [INF] Entity Framework Core 6.0.9 initialized 'PostgresContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:6.0.7+5b98e4b74de93b590b44aef8dd7967c03acc433c' with options: None
2022-09-21 17:55:29.934 +01:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .SingleOrDefault(x => x.Username == __model_Username_0)'
2022-09-21 17:55:30.418 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<User>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: User.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: User.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 1], [Property: User.Email (string) Required Index MaxLength(254), 2], [Property: User.FullName (string) Required MaxLength(100), 3], [Property: User.PasswordChangedAt (DateTime) Required ValueGenerated.OnAdd, 4], [Property: User.PasswordHash (string) Required MaxLength(200), 5], [Property: User.Username (string) Required Index MaxLength(50), 6] }
        SELECT TOP(2) u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
        FROM users AS u
        WHERE u.username == @__model_Username_0), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, User>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)
    .SingleOrDefault()'
2022-09-21 17:55:30.505 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-21 17:55:30.626 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (118ms).
2022-09-21 17:55:30.641 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-21 17:55:30.985 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 17:55:31.008 +01:00 [DBG] Executing DbCommand [Parameters=[@__model_Username_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.username = @__model_Username_0
LIMIT 2
2022-09-21 17:55:31.148 +01:00 [INF] Executed DbCommand (151ms) [Parameters=[@__model_Username_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.username = @__model_Username_0
LIMIT 2
2022-09-21 17:55:31.214 +01:00 [DBG] Context 'PostgresContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 17:55:31.302 +01:00 [DBG] A data reader was disposed.
2022-09-21 17:55:31.313 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 17:55:31.326 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-21 17:55:31.795 +01:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .Any(user => user.RefreshTokenCollection
        .Any(reftoken => reftoken.RefToken == __token_0))'
2022-09-21 17:55:31.920 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<bool>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            EmptyProjectionMember -> 0
        SELECT EXISTS (
            SELECT 1
            FROM users AS u
            WHERE EXISTS (
                SELECT 1
                FROM refresh_token AS r
                WHERE ((u.id != NULL) && (u.id == r.user_id)) && (r.token == @__token_0)))), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, bool>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)
    .Single()'
2022-09-21 17:55:31.931 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-21 17:55:31.932 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2022-09-21 17:55:31.933 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-21 17:55:31.933 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 17:55:31.935 +01:00 [DBG] Executing DbCommand [Parameters=[@__token_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM users AS u
    WHERE EXISTS (
        SELECT 1
        FROM refresh_token AS r
        WHERE (u.id = r.user_id) AND (r.token = @__token_0)))
2022-09-21 17:55:31.939 +01:00 [INF] Executed DbCommand (4ms) [Parameters=[@__token_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM users AS u
    WHERE EXISTS (
        SELECT 1
        FROM refresh_token AS r
        WHERE (u.id = r.user_id) AND (r.token = @__token_0)))
2022-09-21 17:55:31.944 +01:00 [DBG] A data reader was disposed.
2022-09-21 17:55:31.944 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 17:55:31.945 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-21 17:55:31.959 +01:00 [DBG] Compiling query expression: 
'DbSet<RefreshToken>()
    .Where(rt => rt.UserId == __id_0)
    .AsNoTracking()
    .Select(rt => new RefreshToken{ 
        Id = rt.Id, 
        UserId = rt.UserId, 
        RefToken = rt.RefToken, 
        Expires = rt.Expires, 
        Created = rt.Created, 
        CreatedByIp = rt.CreatedByIp, 
        Revoked = rt.Revoked, 
        RevokedByIp = rt.RevokedByIp, 
        ReplacedByToken = rt.ReplacedByToken, 
        ReasonRevoked = rt.ReasonRevoked, 
        IsExpired = rt.IsExpired, 
        IsRevoked = rt.IsRevoked, 
        IsActive = rt.IsActive 
    }
    )'
2022-09-21 17:55:31.989 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<RefreshToken>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            Id -> 0
            UserId -> 1
            RefToken -> 2
            Expires -> 3
            Created -> 4
            CreatedByIp -> 5
            Revoked -> 6
            RevokedByIp -> 7
            ReplacedByToken -> 8
            ReasonRevoked -> 9
            IsExpired -> 10
            IsRevoked -> 11
            IsActive -> 12
        SELECT r.id AS Id, r.user_id AS UserId, r.token AS RefToken, r.expires AS Expires, r.created AS Created, r.created_by_ip AS CreatedByIp, r.revoked AS Revoked, r.revoked_by_ip AS RevokedByIp, r.replaced_by_token AS ReplacedByToken, r.reason_revoked AS ReasonRevoked, r.is_expired AS IsExpired, r.is_revoked AS IsRevoked, r.is_active AS IsActive
        FROM refresh_token AS r
        WHERE r.user_id == @__id_0), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, RefreshToken>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)'
2022-09-21 17:55:31.995 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-21 17:55:31.995 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2022-09-21 17:55:31.996 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-21 17:55:31.997 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 17:55:31.998 +01:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.user_id AS "UserId", r.token AS "RefToken", r.expires AS "Expires", r.created AS "Created", r.created_by_ip AS "CreatedByIp", r.revoked AS "Revoked", r.revoked_by_ip AS "RevokedByIp", r.replaced_by_token AS "ReplacedByToken", r.reason_revoked AS "ReasonRevoked", r.is_expired AS "IsExpired", r.is_revoked AS "IsRevoked", r.is_active AS "IsActive"
FROM refresh_token AS r
WHERE r.user_id = @__id_0
2022-09-21 17:55:32.008 +01:00 [INF] Executed DbCommand (10ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.user_id AS "UserId", r.token AS "RefToken", r.expires AS "Expires", r.created AS "Created", r.created_by_ip AS "CreatedByIp", r.revoked AS "Revoked", r.revoked_by_ip AS "RevokedByIp", r.replaced_by_token AS "ReplacedByToken", r.reason_revoked AS "ReasonRevoked", r.is_expired AS "IsExpired", r.is_revoked AS "IsRevoked", r.is_active AS "IsActive"
FROM refresh_token AS r
WHERE r.user_id = @__id_0
2022-09-21 17:55:32.012 +01:00 [DBG] A data reader was disposed.
2022-09-21 17:55:32.012 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 17:55:32.013 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-21 17:55:32.029 +01:00 [DBG] An entity of type 'User' tracked by 'PostgresContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 17:55:32.065 +01:00 [DBG] 'PostgresContext' generated a temporary value for the property 'Id.RefreshToken'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 17:55:32.128 +01:00 [DBG] Context 'PostgresContext' started tracking 'RefreshToken' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 17:55:32.137 +01:00 [DBG] SaveChanges starting for 'PostgresContext'.
2022-09-21 17:55:32.145 +01:00 [DBG] DetectChanges starting for 'PostgresContext'.
2022-09-21 17:55:32.188 +01:00 [DBG] 1 entities were added and 0 entities were removed from navigation 'User.RefreshTokenCollection'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 17:55:32.212 +01:00 [DBG] The foreign key property 'RefreshToken.UserId' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2022-09-21 17:55:32.234 +01:00 [DBG] DetectChanges completed for 'PostgresContext'.
2022-09-21 17:55:32.247 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-21 17:55:32.249 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 17:55:32.255 +01:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2022-09-21 17:55:32.264 +01:00 [DBG] Began transaction with isolation level 'ReadCommitted'.
2022-09-21 17:55:32.328 +01:00 [DBG] Executing 2 update commands as a batch.
2022-09-21 17:55:32.358 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-21 17:55:32.361 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (3ms).
2022-09-21 17:55:32.363 +01:00 [DBG] Executing DbCommand [Parameters=[@p0='?' (DbType = DateTime), @p1='?', @p2='?' (DbType = DateTime), @p3='?' (DbType = Boolean), @p4='?' (DbType = Boolean), @p5='?' (DbType = Boolean), @p6='?', @p7='?', @p8='?', @p9='?' (DbType = DateTime), @p10='?', @p11='?' (DbType = Int32), @p18='?' (DbType = Int32), @p12='?' (DbType = DateTime), @p13='?', @p14='?', @p15='?' (DbType = DateTime), @p16='?', @p17='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO refresh_token (created, created_by_ip, expires, is_active, is_expired, is_revoked, reason_revoked, token, replaced_by_token, revoked, revoked_by_ip, user_id)
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11)
RETURNING id;
UPDATE users SET created_at = @p12, email = @p13, full_name = @p14, password_changed_at = @p15, password_hash = @p16, username = @p17
WHERE id = @p18;
2022-09-21 17:55:32.379 +01:00 [INF] Executed DbCommand (16ms) [Parameters=[@p0='?' (DbType = DateTime), @p1='?', @p2='?' (DbType = DateTime), @p3='?' (DbType = Boolean), @p4='?' (DbType = Boolean), @p5='?' (DbType = Boolean), @p6='?', @p7='?', @p8='?', @p9='?' (DbType = DateTime), @p10='?', @p11='?' (DbType = Int32), @p18='?' (DbType = Int32), @p12='?' (DbType = DateTime), @p13='?', @p14='?', @p15='?' (DbType = DateTime), @p16='?', @p17='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO refresh_token (created, created_by_ip, expires, is_active, is_expired, is_revoked, reason_revoked, token, replaced_by_token, revoked, revoked_by_ip, user_id)
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11)
RETURNING id;
UPDATE users SET created_at = @p12, email = @p13, full_name = @p14, password_changed_at = @p15, password_hash = @p16, username = @p17
WHERE id = @p18;
2022-09-21 17:55:32.398 +01:00 [DBG] The foreign key property 'RefreshToken.Id' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2022-09-21 17:55:32.404 +01:00 [DBG] A data reader was disposed.
2022-09-21 17:55:32.410 +01:00 [DBG] Committing transaction.
2022-09-21 17:55:32.424 +01:00 [DBG] Committed transaction.
2022-09-21 17:55:32.426 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 17:55:32.427 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-21 17:55:32.430 +01:00 [DBG] Disposing transaction.
2022-09-21 17:55:32.433 +01:00 [DBG] An entity of type 'RefreshToken' tracked by 'PostgresContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 17:55:32.437 +01:00 [DBG] An entity of type 'User' tracked by 'PostgresContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 17:55:32.441 +01:00 [DBG] SaveChanges completed for 'PostgresContext' with 2 entities written to the database.
2022-09-21 17:55:32.446 +01:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2022-09-21 17:55:32.453 +01:00 [DBG] Attempting to select an output formatter based on Accept header '["text/plain"]'.
2022-09-21 17:55:32.456 +01:00 [DBG] Could not find an output formatter based on content negotiation. Accepted types were (["text/plain"])
2022-09-21 17:55:32.458 +01:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2022-09-21 17:55:32.459 +01:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2022-09-21 17:55:32.460 +01:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2022-09-21 17:55:32.461 +01:00 [INF] Executing OkObjectResult, writing value of type 'APIBank.Models.Users.Responses.LoginResponse'.
2022-09-21 17:55:32.482 +01:00 [INF] Executed action APIBank.Controllers.UsersController.Login (APIBank) in 4424.9137ms
2022-09-21 17:55:32.489 +01:00 [INF] Executed endpoint 'APIBank.Controllers.UsersController.Login (APIBank)'
2022-09-21 17:55:32.494 +01:00 [DBG] 'PostgresContext' disposed.
2022-09-21 17:55:32.501 +01:00 [INF] Request finished HTTP/2 POST https://localhost:7036/api/Users/Login application/json 58 - 200 - application/json;+charset=utf-8 5002.2759ms
2022-09-21 17:55:48.291 +01:00 [INF] Request starting HTTP/2 POST https://localhost:7036/api/Users/revoke-token application/json 17
2022-09-21 17:55:48.307 +01:00 [DBG] 1 candidate(s) found for the request path '/api/Users/revoke-token'
2022-09-21 17:55:48.309 +01:00 [DBG] Endpoint 'APIBank.Controllers.UsersController.RevokeToken (APIBank)' with route pattern 'api/Users/revoke-token' is valid for the request path '/api/Users/revoke-token'
2022-09-21 17:55:48.311 +01:00 [DBG] Request matched endpoint 'APIBank.Controllers.UsersController.RevokeToken (APIBank)'
2022-09-21 17:55:48.312 +01:00 [DBG] Static files was skipped as the request already matched an endpoint.
2022-09-21 17:55:48.428 +01:00 [INF] Entity Framework Core 6.0.9 initialized 'PostgresContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:6.0.7+5b98e4b74de93b590b44aef8dd7967c03acc433c' with options: None
2022-09-21 17:55:48.441 +01:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .FirstOrDefault(e => EF.Property<int>(e, "Id") == __p_0)'
2022-09-21 17:55:48.447 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<User>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: User.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: User.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 1], [Property: User.Email (string) Required Index MaxLength(254), 2], [Property: User.FullName (string) Required MaxLength(100), 3], [Property: User.PasswordChangedAt (DateTime) Required ValueGenerated.OnAdd, 4], [Property: User.PasswordHash (string) Required MaxLength(200), 5], [Property: User.Username (string) Required Index MaxLength(50), 6] }
        SELECT TOP(1) u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
        FROM users AS u
        WHERE u.id == @__p_0), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, User>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)
    .SingleOrDefault()'
2022-09-21 17:55:48.449 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-21 17:55:48.450 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2022-09-21 17:55:48.450 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-21 17:55:48.451 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 17:55:48.452 +01:00 [DBG] Executing DbCommand [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.id = @__p_0
LIMIT 1
2022-09-21 17:55:48.455 +01:00 [INF] Executed DbCommand (3ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.id = @__p_0
LIMIT 1
2022-09-21 17:55:48.459 +01:00 [DBG] Context 'PostgresContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 17:55:48.459 +01:00 [DBG] A data reader was disposed.
2022-09-21 17:55:48.460 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 17:55:48.461 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-21 17:55:48.461 +01:00 [INF] Executing endpoint 'APIBank.Controllers.UsersController.RevokeToken (APIBank)'
2022-09-21 17:55:48.463 +01:00 [INF] Route matched with {action = "RevokeToken", controller = "Users"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult RevokeToken(APIBank.Models.Users.Requests.RevokeTokenRequest) on controller APIBank.Controllers.UsersController (APIBank).
2022-09-21 17:55:48.464 +01:00 [DBG] Execution plan of authorization filters (in the following order): ["APIBank.Authorization.AuthorizeAttribute"]
2022-09-21 17:55:48.465 +01:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2022-09-21 17:55:48.466 +01:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2022-09-21 17:55:48.467 +01:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2022-09-21 17:55:48.468 +01:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2022-09-21 17:55:48.469 +01:00 [DBG] Executing controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-21 17:55:48.472 +01:00 [DBG] Executed controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-21 17:55:48.475 +01:00 [DBG] Attempting to bind parameter 'model' of type 'APIBank.Models.Users.Requests.RevokeTokenRequest' ...
2022-09-21 17:55:48.476 +01:00 [DBG] Attempting to bind parameter 'model' of type 'APIBank.Models.Users.Requests.RevokeTokenRequest' using the name '' in request data ...
2022-09-21 17:55:48.477 +01:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2022-09-21 17:55:48.478 +01:00 [DBG] Connection id "0HMKRU84FKR2I", Request id "0HMKRU84FKR2I:0000000B": started reading request body.
2022-09-21 17:55:48.479 +01:00 [DBG] Connection id "0HMKRU84FKR2I", Request id "0HMKRU84FKR2I:0000000B": done reading request body.
2022-09-21 17:55:48.480 +01:00 [DBG] JSON input formatter succeeded, deserializing to type 'APIBank.Models.Users.Requests.RevokeTokenRequest'
2022-09-21 17:55:48.481 +01:00 [DBG] Done attempting to bind parameter 'model' of type 'APIBank.Models.Users.Requests.RevokeTokenRequest'.
2022-09-21 17:55:48.482 +01:00 [DBG] Done attempting to bind parameter 'model' of type 'APIBank.Models.Users.Requests.RevokeTokenRequest'.
2022-09-21 17:55:48.482 +01:00 [DBG] Attempting to validate the bound parameter 'model' of type 'APIBank.Models.Users.Requests.RevokeTokenRequest' ...
2022-09-21 17:55:48.484 +01:00 [DBG] Done attempting to validate the bound parameter 'model' of type 'APIBank.Models.Users.Requests.RevokeTokenRequest'.
2022-09-21 17:56:18.405 +01:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .SingleOrDefault(userQuery => userQuery.RefreshTokenCollection
        .Any(refTokenQuery => refTokenQuery.RefToken == __refToken_0))'
2022-09-21 17:56:18.412 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<User>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: User.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: User.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 1], [Property: User.Email (string) Required Index MaxLength(254), 2], [Property: User.FullName (string) Required MaxLength(100), 3], [Property: User.PasswordChangedAt (DateTime) Required ValueGenerated.OnAdd, 4], [Property: User.PasswordHash (string) Required MaxLength(200), 5], [Property: User.Username (string) Required Index MaxLength(50), 6] }
        SELECT TOP(2) u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
        FROM users AS u
        WHERE EXISTS (
            SELECT 1
            FROM refresh_token AS r
            WHERE ((u.id != NULL) && (u.id == r.user_id)) && (r.token == @__refToken_0))), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, User>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)
    .SingleOrDefault()'
2022-09-21 17:56:18.415 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-21 17:56:18.416 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2022-09-21 17:56:18.416 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-21 17:56:18.417 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 17:56:18.418 +01:00 [DBG] Executing DbCommand [Parameters=[@__refToken_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE EXISTS (
    SELECT 1
    FROM refresh_token AS r
    WHERE (u.id = r.user_id) AND (r.token = @__refToken_0))
LIMIT 2
2022-09-21 17:56:18.420 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[@__refToken_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE EXISTS (
    SELECT 1
    FROM refresh_token AS r
    WHERE (u.id = r.user_id) AND (r.token = @__refToken_0))
LIMIT 2
2022-09-21 17:56:18.422 +01:00 [DBG] A data reader was disposed.
2022-09-21 17:56:18.422 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 17:56:18.423 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-21 17:56:32.010 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-21 17:56:32.014 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (3ms).
2022-09-21 17:56:32.016 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-21 17:56:32.017 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 17:56:32.018 +01:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.user_id AS "UserId", r.token AS "RefToken", r.expires AS "Expires", r.created AS "Created", r.created_by_ip AS "CreatedByIp", r.revoked AS "Revoked", r.revoked_by_ip AS "RevokedByIp", r.replaced_by_token AS "ReplacedByToken", r.reason_revoked AS "ReasonRevoked", r.is_expired AS "IsExpired", r.is_revoked AS "IsRevoked", r.is_active AS "IsActive"
FROM refresh_token AS r
WHERE r.user_id = @__id_0
2022-09-21 17:56:32.020 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.user_id AS "UserId", r.token AS "RefToken", r.expires AS "Expires", r.created AS "Created", r.created_by_ip AS "CreatedByIp", r.revoked AS "Revoked", r.revoked_by_ip AS "RevokedByIp", r.replaced_by_token AS "ReplacedByToken", r.reason_revoked AS "ReasonRevoked", r.is_expired AS "IsExpired", r.is_revoked AS "IsRevoked", r.is_active AS "IsActive"
FROM refresh_token AS r
WHERE r.user_id = @__id_0
2022-09-21 17:56:32.051 +01:00 [DBG] A data reader was disposed.
2022-09-21 17:56:32.055 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 17:56:32.057 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-21 17:57:00.983 +01:00 [DBG] An entity of type 'User' tracked by 'PostgresContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 17:57:02.035 +01:00 [DBG] Context 'PostgresContext' started tracking 'RefreshToken' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 17:57:02.963 +01:00 [DBG] SaveChanges starting for 'PostgresContext'.
2022-09-21 17:57:02.965 +01:00 [DBG] DetectChanges starting for 'PostgresContext'.
2022-09-21 17:57:02.968 +01:00 [DBG] DetectChanges completed for 'PostgresContext'.
2022-09-21 17:57:02.969 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-21 17:57:02.970 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 17:57:02.970 +01:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2022-09-21 17:57:02.973 +01:00 [DBG] Began transaction with isolation level 'ReadCommitted'.
2022-09-21 17:57:02.978 +01:00 [DBG] Executing 2 update commands as a batch.
2022-09-21 17:57:02.994 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-21 17:57:02.995 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2022-09-21 17:57:02.997 +01:00 [DBG] Executing DbCommand [Parameters=[@p12='?' (DbType = Int32), @p0='?' (DbType = DateTime), @p1='?', @p2='?' (DbType = DateTime), @p3='?' (DbType = Boolean), @p4='?' (DbType = Boolean), @p5='?' (DbType = Boolean), @p6='?', @p7='?', @p8='?', @p9='?' (DbType = DateTime), @p10='?', @p11='?' (DbType = Int32), @p19='?' (DbType = Int32), @p13='?' (DbType = DateTime), @p14='?', @p15='?', @p16='?' (DbType = DateTime), @p17='?', @p18='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE refresh_token SET created = @p0, created_by_ip = @p1, expires = @p2, is_active = @p3, is_expired = @p4, is_revoked = @p5, reason_revoked = @p6, token = @p7, replaced_by_token = @p8, revoked = @p9, revoked_by_ip = @p10, user_id = @p11
WHERE id = @p12;
UPDATE users SET created_at = @p13, email = @p14, full_name = @p15, password_changed_at = @p16, password_hash = @p17, username = @p18
WHERE id = @p19;
2022-09-21 17:57:03.002 +01:00 [INF] Executed DbCommand (5ms) [Parameters=[@p12='?' (DbType = Int32), @p0='?' (DbType = DateTime), @p1='?', @p2='?' (DbType = DateTime), @p3='?' (DbType = Boolean), @p4='?' (DbType = Boolean), @p5='?' (DbType = Boolean), @p6='?', @p7='?', @p8='?', @p9='?' (DbType = DateTime), @p10='?', @p11='?' (DbType = Int32), @p19='?' (DbType = Int32), @p13='?' (DbType = DateTime), @p14='?', @p15='?', @p16='?' (DbType = DateTime), @p17='?', @p18='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE refresh_token SET created = @p0, created_by_ip = @p1, expires = @p2, is_active = @p3, is_expired = @p4, is_revoked = @p5, reason_revoked = @p6, token = @p7, replaced_by_token = @p8, revoked = @p9, revoked_by_ip = @p10, user_id = @p11
WHERE id = @p12;
UPDATE users SET created_at = @p13, email = @p14, full_name = @p15, password_changed_at = @p16, password_hash = @p17, username = @p18
WHERE id = @p19;
2022-09-21 17:57:03.006 +01:00 [DBG] A data reader was disposed.
2022-09-21 17:57:03.008 +01:00 [DBG] Committing transaction.
2022-09-21 17:57:03.009 +01:00 [DBG] Committed transaction.
2022-09-21 17:57:03.010 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 17:57:03.011 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-21 17:57:03.012 +01:00 [DBG] Disposing transaction.
2022-09-21 17:57:03.012 +01:00 [DBG] An entity of type 'User' tracked by 'PostgresContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 17:57:03.014 +01:00 [DBG] An entity of type 'RefreshToken' tracked by 'PostgresContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 17:57:03.015 +01:00 [DBG] SaveChanges completed for 'PostgresContext' with 2 entities written to the database.
2022-09-21 17:57:08.170 +01:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2022-09-21 17:57:08.175 +01:00 [DBG] No information found on request to perform content negotiation.
2022-09-21 17:57:08.175 +01:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2022-09-21 17:57:08.176 +01:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2022-09-21 17:57:08.177 +01:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2022-09-21 17:57:08.177 +01:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType0`1[[System.String, System.Private.CoreLib, Version=6.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2022-09-21 17:57:08.204 +01:00 [INF] Executed action APIBank.Controllers.UsersController.RevokeToken (APIBank) in 79735.1265ms
2022-09-21 17:57:08.207 +01:00 [INF] Executed endpoint 'APIBank.Controllers.UsersController.RevokeToken (APIBank)'
2022-09-21 17:57:14.377 +01:00 [DBG] 'PostgresContext' disposed.
2022-09-21 17:57:14.382 +01:00 [INF] Request finished HTTP/2 POST https://localhost:7036/api/Users/revoke-token application/json 17 - 200 - application/json;+charset=utf-8 86090.4156ms
2022-09-21 17:57:24.223 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/api/Accounts/GetAll - -
2022-09-21 17:57:24.226 +01:00 [DBG] 1 candidate(s) found for the request path '/api/Accounts/GetAll'
2022-09-21 17:57:24.229 +01:00 [DBG] Endpoint 'APIBank.Controllers.AccountsController.GetAllFromUser (APIBank)' with route pattern 'api/Accounts/GetAll' is valid for the request path '/api/Accounts/GetAll'
2022-09-21 17:57:24.233 +01:00 [DBG] Request matched endpoint 'APIBank.Controllers.AccountsController.GetAllFromUser (APIBank)'
2022-09-21 17:57:24.237 +01:00 [DBG] Static files was skipped as the request already matched an endpoint.
2022-09-21 17:57:29.355 +01:00 [INF] Executing endpoint 'APIBank.Controllers.AccountsController.GetAllFromUser (APIBank)'
2022-09-21 17:57:29.359 +01:00 [INF] Route matched with {action = "GetAllFromUser", controller = "Accounts"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult GetAllFromUser() on controller APIBank.Controllers.AccountsController (APIBank).
2022-09-21 17:57:29.361 +01:00 [DBG] Execution plan of authorization filters (in the following order): ["APIBank.Authorization.AuthorizeAttribute"]
2022-09-21 17:57:29.362 +01:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2022-09-21 17:57:29.365 +01:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2022-09-21 17:57:29.369 +01:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2022-09-21 17:57:29.370 +01:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2022-09-21 17:57:29.371 +01:00 [INF] Authorization failed for the request at filter 'APIBank.Authorization.AuthorizeAttribute'.
2022-09-21 17:57:29.374 +01:00 [INF] Executing JsonResult, writing value of type '<>f__AnonymousType0`1[[System.String, System.Private.CoreLib, Version=6.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2022-09-21 17:57:29.375 +01:00 [INF] Executed action APIBank.Controllers.AccountsController.GetAllFromUser (APIBank) in 4.2481ms
2022-09-21 17:57:29.376 +01:00 [INF] Executed endpoint 'APIBank.Controllers.AccountsController.GetAllFromUser (APIBank)'
2022-09-21 17:57:29.377 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/api/Accounts/GetAll - - - 401 - application/json;+charset=utf-8 5153.7602ms
2022-09-21 17:57:58.921 +01:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2022-09-21 17:57:59.017 +01:00 [DBG] Hosting starting
2022-09-21 17:57:59.169 +01:00 [DBG] Using development certificate: CN=localhost (Thumbprint: 9CC642E9838495A6C3C202DECA6A8AD300396DD2)
2022-09-21 17:57:59.247 +01:00 [INF] Now listening on: https://localhost:7036
2022-09-21 17:57:59.248 +01:00 [INF] Now listening on: http://localhost:5036
2022-09-21 17:57:59.249 +01:00 [DBG] Loaded hosting startup assembly APIBank
2022-09-21 17:57:59.251 +01:00 [DBG] Loaded hosting startup assembly Microsoft.AspNetCore.Watch.BrowserRefresh
2022-09-21 17:57:59.251 +01:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.BrowserLink.Net
2022-09-21 17:57:59.252 +01:00 [INF] Application started. Press Ctrl+C to shut down.
2022-09-21 17:57:59.254 +01:00 [INF] Hosting environment: Development
2022-09-21 17:57:59.255 +01:00 [INF] Content root path: C:\Users\mguedesa\OneDrive - NTT DATA EMEAL\Documentos\GitHub\OpenBankAPI-NTT\APIBank\APIBank\
2022-09-21 17:57:59.256 +01:00 [DBG] Hosting started
2022-09-21 17:57:59.637 +01:00 [DBG] Connection id "0HMKRU9O686VQ" accepted.
2022-09-21 17:57:59.637 +01:00 [DBG] Connection id "0HMKRU9O686VR" accepted.
2022-09-21 17:57:59.639 +01:00 [DBG] Connection id "0HMKRU9O686VR" started.
2022-09-21 17:57:59.639 +01:00 [DBG] Connection id "0HMKRU9O686VQ" started.
2022-09-21 17:57:59.651 +01:00 [DBG] Connection id "0HMKRU9O686VQ" received FIN.
2022-09-21 17:57:59.651 +01:00 [DBG] Connection id "0HMKRU9O686VR" received FIN.
2022-09-21 17:57:59.657 +01:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException:  Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.ReceiveBlobAsync[TIOAdapter](TIOAdapter adapter)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](TIOAdapter adapter, Boolean receiveFirst, Byte[] reAuthenticationData, Boolean isApm)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2022-09-21 17:57:59.657 +01:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException:  Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.<FillHandshakeBufferAsync>g__InternalFillHandshakeBufferAsync|189_0[TIOAdapter](TIOAdapter adap, ValueTask`1 task, Int32 minSize)
   at System.Net.Security.SslStream.ReceiveBlobAsync[TIOAdapter](TIOAdapter adapter)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](TIOAdapter adapter, Boolean receiveFirst, Byte[] reAuthenticationData, Boolean isApm)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2022-09-21 17:57:59.696 +01:00 [DBG] Connection id "0HMKRU9O686VR" stopped.
2022-09-21 17:57:59.696 +01:00 [DBG] Connection id "0HMKRU9O686VQ" stopped.
2022-09-21 17:57:59.698 +01:00 [DBG] Connection id "0HMKRU9O686VQ" sending FIN because: "The Socket transport's send loop completed gracefully."
2022-09-21 17:57:59.698 +01:00 [DBG] Connection id "0HMKRU9O686VR" sending FIN because: "The Socket transport's send loop completed gracefully."
2022-09-21 17:58:00.101 +01:00 [DBG] Connection id "0HMKRU9O686VS" accepted.
2022-09-21 17:58:00.118 +01:00 [DBG] Connection id "0HMKRU9O686VS" started.
2022-09-21 17:58:00.298 +01:00 [DBG] Connection 0HMKRU9O686VS established using the following protocol: "Tls12"
2022-09-21 17:58:00.483 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/swagger/index.html - -
2022-09-21 17:58:00.775 +01:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2022-09-21 17:58:00.829 +01:00 [DBG] No candidates found for the request path '/swagger/index.html'
2022-09-21 17:58:00.834 +01:00 [DBG] Request did not match any endpoints
2022-09-21 17:58:01.041 +01:00 [DBG] Response markup is scheduled to include browser refresh script injection.
2022-09-21 17:58:01.192 +01:00 [DBG] Response markup was updated to include browser refresh script injection.
2022-09-21 17:58:01.198 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/swagger/index.html - - - 200 - text/html;charset=utf-8 751.1646ms
2022-09-21 17:58:01.232 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/_vs/browserLink - -
2022-09-21 17:58:01.232 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/_framework/aspnetcore-browser-refresh.js - -
2022-09-21 17:58:01.244 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/_framework/aspnetcore-browser-refresh.js - - - 200 11984 application/javascript;+charset=utf-8 11.9569ms
2022-09-21 17:58:01.345 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/_vs/browserLink - - - 200 - text/javascript;+charset=UTF-8 113.4000ms
2022-09-21 17:58:01.423 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/swagger/v1/swagger.json - -
2022-09-21 17:58:01.426 +01:00 [DBG] No candidates found for the request path '/swagger/v1/swagger.json'
2022-09-21 17:58:01.427 +01:00 [DBG] Request did not match any endpoints
2022-09-21 17:58:01.645 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/swagger/v1/swagger.json - - - 200 - application/json;charset=utf-8 222.6327ms
2022-09-21 17:58:13.119 +01:00 [INF] Request starting HTTP/2 POST https://localhost:7036/api/Users/Login application/json 58
2022-09-21 17:58:13.144 +01:00 [DBG] 1 candidate(s) found for the request path '/api/Users/Login'
2022-09-21 17:58:13.154 +01:00 [DBG] Endpoint 'APIBank.Controllers.UsersController.Login (APIBank)' with route pattern 'api/Users/Login' is valid for the request path '/api/Users/Login'
2022-09-21 17:58:13.157 +01:00 [DBG] Request matched endpoint 'APIBank.Controllers.UsersController.Login (APIBank)'
2022-09-21 17:58:13.160 +01:00 [DBG] Static files was skipped as the request already matched an endpoint.
2022-09-21 17:58:13.624 +01:00 [INF] Executing endpoint 'APIBank.Controllers.UsersController.Login (APIBank)'
2022-09-21 17:58:13.656 +01:00 [INF] Route matched with {action = "Login", controller = "Users"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult Login(APIBank.Models.Requests.LoginRequest) on controller APIBank.Controllers.UsersController (APIBank).
2022-09-21 17:58:13.663 +01:00 [DBG] Execution plan of authorization filters (in the following order): ["APIBank.Authorization.AuthorizeAttribute"]
2022-09-21 17:58:13.666 +01:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2022-09-21 17:58:13.667 +01:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2022-09-21 17:58:13.669 +01:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2022-09-21 17:58:13.670 +01:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2022-09-21 17:58:13.672 +01:00 [DBG] Executing controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-21 17:58:13.673 +01:00 [DBG] Executed controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-21 17:58:13.691 +01:00 [DBG] Attempting to bind parameter 'model' of type 'APIBank.Models.Requests.LoginRequest' ...
2022-09-21 17:58:13.697 +01:00 [DBG] Attempting to bind parameter 'model' of type 'APIBank.Models.Requests.LoginRequest' using the name '' in request data ...
2022-09-21 17:58:13.699 +01:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2022-09-21 17:58:13.704 +01:00 [DBG] Connection id "0HMKRU9O686VS", Request id "0HMKRU9O686VS:00000009": started reading request body.
2022-09-21 17:58:13.705 +01:00 [DBG] Connection id "0HMKRU9O686VS", Request id "0HMKRU9O686VS:00000009": done reading request body.
2022-09-21 17:58:13.715 +01:00 [DBG] JSON input formatter succeeded, deserializing to type 'APIBank.Models.Requests.LoginRequest'
2022-09-21 17:58:13.716 +01:00 [DBG] Done attempting to bind parameter 'model' of type 'APIBank.Models.Requests.LoginRequest'.
2022-09-21 17:58:13.717 +01:00 [DBG] Done attempting to bind parameter 'model' of type 'APIBank.Models.Requests.LoginRequest'.
2022-09-21 17:58:13.718 +01:00 [DBG] Attempting to validate the bound parameter 'model' of type 'APIBank.Models.Requests.LoginRequest' ...
2022-09-21 17:58:13.724 +01:00 [DBG] Done attempting to validate the bound parameter 'model' of type 'APIBank.Models.Requests.LoginRequest'.
2022-09-21 17:58:13.847 +01:00 [DBG] An additional 'IServiceProvider' was created for internal use by Entity Framework. An existing service provider was not used due to the following configuration changes: configuration changed for 'Core:ConfigureWarnings', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:UseAdminDatabase', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:SetPostgresVersion', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:UseRedshift', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:ReverseNullOrdering', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:RemoteCertificateValidationCallback', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:ProvideClientCertificatesCallback', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:ProvidePasswordCallback'.
2022-09-21 17:58:15.376 +01:00 [INF] Entity Framework Core 6.0.9 initialized 'PostgresContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:6.0.7+5b98e4b74de93b590b44aef8dd7967c03acc433c' with options: None
2022-09-21 17:58:15.449 +01:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .SingleOrDefault(x => x.Username == __model_Username_0)'
2022-09-21 17:58:16.003 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<User>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: User.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: User.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 1], [Property: User.Email (string) Required Index MaxLength(254), 2], [Property: User.FullName (string) Required MaxLength(100), 3], [Property: User.PasswordChangedAt (DateTime) Required ValueGenerated.OnAdd, 4], [Property: User.PasswordHash (string) Required MaxLength(200), 5], [Property: User.Username (string) Required Index MaxLength(50), 6] }
        SELECT TOP(2) u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
        FROM users AS u
        WHERE u.username == @__model_Username_0), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, User>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)
    .SingleOrDefault()'
2022-09-21 17:58:16.086 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-21 17:58:16.211 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (115ms).
2022-09-21 17:58:16.222 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-21 17:58:16.533 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 17:58:16.556 +01:00 [DBG] Executing DbCommand [Parameters=[@__model_Username_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.username = @__model_Username_0
LIMIT 2
2022-09-21 17:58:16.706 +01:00 [INF] Executed DbCommand (157ms) [Parameters=[@__model_Username_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.username = @__model_Username_0
LIMIT 2
2022-09-21 17:58:16.815 +01:00 [DBG] Context 'PostgresContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 17:58:16.898 +01:00 [DBG] A data reader was disposed.
2022-09-21 17:58:16.913 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 17:58:16.929 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-21 17:58:17.429 +01:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .Any(user => user.RefreshTokenCollection
        .Any(reftoken => reftoken.RefToken == __token_0))'
2022-09-21 17:58:17.587 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<bool>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            EmptyProjectionMember -> 0
        SELECT EXISTS (
            SELECT 1
            FROM users AS u
            WHERE EXISTS (
                SELECT 1
                FROM refresh_token AS r
                WHERE ((u.id != NULL) && (u.id == r.user_id)) && (r.token == @__token_0)))), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, bool>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)
    .Single()'
2022-09-21 17:58:17.605 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-21 17:58:17.609 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (4ms).
2022-09-21 17:58:17.612 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-21 17:58:17.612 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 17:58:17.613 +01:00 [DBG] Executing DbCommand [Parameters=[@__token_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM users AS u
    WHERE EXISTS (
        SELECT 1
        FROM refresh_token AS r
        WHERE (u.id = r.user_id) AND (r.token = @__token_0)))
2022-09-21 17:58:17.616 +01:00 [INF] Executed DbCommand (3ms) [Parameters=[@__token_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM users AS u
    WHERE EXISTS (
        SELECT 1
        FROM refresh_token AS r
        WHERE (u.id = r.user_id) AND (r.token = @__token_0)))
2022-09-21 17:58:17.621 +01:00 [DBG] A data reader was disposed.
2022-09-21 17:58:17.621 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 17:58:17.625 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-21 17:58:17.636 +01:00 [DBG] Compiling query expression: 
'DbSet<RefreshToken>()
    .Where(rt => rt.UserId == __id_0)
    .AsNoTracking()
    .Select(rt => new RefreshToken{ 
        Id = rt.Id, 
        UserId = rt.UserId, 
        RefToken = rt.RefToken, 
        Expires = rt.Expires, 
        Created = rt.Created, 
        CreatedByIp = rt.CreatedByIp, 
        Revoked = rt.Revoked, 
        RevokedByIp = rt.RevokedByIp, 
        ReplacedByToken = rt.ReplacedByToken, 
        ReasonRevoked = rt.ReasonRevoked, 
        IsExpired = rt.IsExpired, 
        IsRevoked = rt.IsRevoked, 
        IsActive = rt.IsActive 
    }
    )'
2022-09-21 17:58:17.668 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<RefreshToken>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            Id -> 0
            UserId -> 1
            RefToken -> 2
            Expires -> 3
            Created -> 4
            CreatedByIp -> 5
            Revoked -> 6
            RevokedByIp -> 7
            ReplacedByToken -> 8
            ReasonRevoked -> 9
            IsExpired -> 10
            IsRevoked -> 11
            IsActive -> 12
        SELECT r.id AS Id, r.user_id AS UserId, r.token AS RefToken, r.expires AS Expires, r.created AS Created, r.created_by_ip AS CreatedByIp, r.revoked AS Revoked, r.revoked_by_ip AS RevokedByIp, r.replaced_by_token AS ReplacedByToken, r.reason_revoked AS ReasonRevoked, r.is_expired AS IsExpired, r.is_revoked AS IsRevoked, r.is_active AS IsActive
        FROM refresh_token AS r
        WHERE r.user_id == @__id_0), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, RefreshToken>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)'
2022-09-21 17:58:17.675 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-21 17:58:17.676 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2022-09-21 17:58:17.678 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-21 17:58:17.679 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 17:58:17.680 +01:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.user_id AS "UserId", r.token AS "RefToken", r.expires AS "Expires", r.created AS "Created", r.created_by_ip AS "CreatedByIp", r.revoked AS "Revoked", r.revoked_by_ip AS "RevokedByIp", r.replaced_by_token AS "ReplacedByToken", r.reason_revoked AS "ReasonRevoked", r.is_expired AS "IsExpired", r.is_revoked AS "IsRevoked", r.is_active AS "IsActive"
FROM refresh_token AS r
WHERE r.user_id = @__id_0
2022-09-21 17:58:17.687 +01:00 [INF] Executed DbCommand (8ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.user_id AS "UserId", r.token AS "RefToken", r.expires AS "Expires", r.created AS "Created", r.created_by_ip AS "CreatedByIp", r.revoked AS "Revoked", r.revoked_by_ip AS "RevokedByIp", r.replaced_by_token AS "ReplacedByToken", r.reason_revoked AS "ReasonRevoked", r.is_expired AS "IsExpired", r.is_revoked AS "IsRevoked", r.is_active AS "IsActive"
FROM refresh_token AS r
WHERE r.user_id = @__id_0
2022-09-21 17:58:17.692 +01:00 [DBG] A data reader was disposed.
2022-09-21 17:58:17.693 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 17:58:17.694 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-21 17:58:17.710 +01:00 [DBG] An entity of type 'User' tracked by 'PostgresContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 17:58:17.754 +01:00 [DBG] 'PostgresContext' generated a temporary value for the property 'Id.RefreshToken'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 17:58:17.809 +01:00 [DBG] Context 'PostgresContext' started tracking 'RefreshToken' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 17:58:17.815 +01:00 [DBG] SaveChanges starting for 'PostgresContext'.
2022-09-21 17:58:17.818 +01:00 [DBG] DetectChanges starting for 'PostgresContext'.
2022-09-21 17:58:17.855 +01:00 [DBG] 1 entities were added and 0 entities were removed from navigation 'User.RefreshTokenCollection'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 17:58:17.881 +01:00 [DBG] The foreign key property 'RefreshToken.UserId' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2022-09-21 17:58:17.910 +01:00 [DBG] DetectChanges completed for 'PostgresContext'.
2022-09-21 17:58:17.924 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-21 17:58:17.925 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 17:58:17.929 +01:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2022-09-21 17:58:17.938 +01:00 [DBG] Began transaction with isolation level 'ReadCommitted'.
2022-09-21 17:58:18.017 +01:00 [DBG] Executing 2 update commands as a batch.
2022-09-21 17:58:18.042 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-21 17:58:18.045 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (2ms).
2022-09-21 17:58:18.047 +01:00 [DBG] Executing DbCommand [Parameters=[@p0='?' (DbType = DateTime), @p1='?', @p2='?' (DbType = DateTime), @p3='?' (DbType = Boolean), @p4='?' (DbType = Boolean), @p5='?' (DbType = Boolean), @p6='?', @p7='?', @p8='?', @p9='?' (DbType = DateTime), @p10='?', @p11='?' (DbType = Int32), @p18='?' (DbType = Int32), @p12='?' (DbType = DateTime), @p13='?', @p14='?', @p15='?' (DbType = DateTime), @p16='?', @p17='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO refresh_token (created, created_by_ip, expires, is_active, is_expired, is_revoked, reason_revoked, token, replaced_by_token, revoked, revoked_by_ip, user_id)
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11)
RETURNING id;
UPDATE users SET created_at = @p12, email = @p13, full_name = @p14, password_changed_at = @p15, password_hash = @p16, username = @p17
WHERE id = @p18;
2022-09-21 17:58:18.064 +01:00 [INF] Executed DbCommand (17ms) [Parameters=[@p0='?' (DbType = DateTime), @p1='?', @p2='?' (DbType = DateTime), @p3='?' (DbType = Boolean), @p4='?' (DbType = Boolean), @p5='?' (DbType = Boolean), @p6='?', @p7='?', @p8='?', @p9='?' (DbType = DateTime), @p10='?', @p11='?' (DbType = Int32), @p18='?' (DbType = Int32), @p12='?' (DbType = DateTime), @p13='?', @p14='?', @p15='?' (DbType = DateTime), @p16='?', @p17='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO refresh_token (created, created_by_ip, expires, is_active, is_expired, is_revoked, reason_revoked, token, replaced_by_token, revoked, revoked_by_ip, user_id)
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11)
RETURNING id;
UPDATE users SET created_at = @p12, email = @p13, full_name = @p14, password_changed_at = @p15, password_hash = @p16, username = @p17
WHERE id = @p18;
2022-09-21 17:58:18.090 +01:00 [DBG] The foreign key property 'RefreshToken.Id' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2022-09-21 17:58:18.096 +01:00 [DBG] A data reader was disposed.
2022-09-21 17:58:18.099 +01:00 [DBG] Committing transaction.
2022-09-21 17:58:18.112 +01:00 [DBG] Committed transaction.
2022-09-21 17:58:18.114 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 17:58:18.116 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-21 17:58:18.119 +01:00 [DBG] Disposing transaction.
2022-09-21 17:58:18.125 +01:00 [DBG] An entity of type 'RefreshToken' tracked by 'PostgresContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 17:58:18.128 +01:00 [DBG] An entity of type 'User' tracked by 'PostgresContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 17:58:18.130 +01:00 [DBG] SaveChanges completed for 'PostgresContext' with 2 entities written to the database.
2022-09-21 17:58:18.135 +01:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2022-09-21 17:58:18.142 +01:00 [DBG] Attempting to select an output formatter based on Accept header '["text/plain"]'.
2022-09-21 17:58:18.143 +01:00 [DBG] Could not find an output formatter based on content negotiation. Accepted types were (["text/plain"])
2022-09-21 17:58:18.144 +01:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2022-09-21 17:58:18.145 +01:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2022-09-21 17:58:18.146 +01:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2022-09-21 17:58:18.147 +01:00 [INF] Executing OkObjectResult, writing value of type 'APIBank.Models.Users.Responses.LoginResponse'.
2022-09-21 17:58:18.163 +01:00 [INF] Executed action APIBank.Controllers.UsersController.Login (APIBank) in 4487.3961ms
2022-09-21 17:58:18.165 +01:00 [INF] Executed endpoint 'APIBank.Controllers.UsersController.Login (APIBank)'
2022-09-21 17:58:18.171 +01:00 [DBG] 'PostgresContext' disposed.
2022-09-21 17:58:18.179 +01:00 [INF] Request finished HTTP/2 POST https://localhost:7036/api/Users/Login application/json 58 - 200 - application/json;+charset=utf-8 5059.9813ms
2022-09-21 17:58:35.352 +01:00 [INF] Request starting HTTP/2 POST https://localhost:7036/api/Users/revoke-token application/json 17
2022-09-21 17:58:35.359 +01:00 [DBG] 1 candidate(s) found for the request path '/api/Users/revoke-token'
2022-09-21 17:58:35.361 +01:00 [DBG] Endpoint 'APIBank.Controllers.UsersController.RevokeToken (APIBank)' with route pattern 'api/Users/revoke-token' is valid for the request path '/api/Users/revoke-token'
2022-09-21 17:58:35.363 +01:00 [DBG] Request matched endpoint 'APIBank.Controllers.UsersController.RevokeToken (APIBank)'
2022-09-21 17:58:35.364 +01:00 [DBG] Static files was skipped as the request already matched an endpoint.
2022-09-21 17:58:35.505 +01:00 [INF] Entity Framework Core 6.0.9 initialized 'PostgresContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:6.0.7+5b98e4b74de93b590b44aef8dd7967c03acc433c' with options: None
2022-09-21 17:58:35.527 +01:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .FirstOrDefault(e => EF.Property<int>(e, "Id") == __p_0)'
2022-09-21 17:58:35.535 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<User>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: User.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: User.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 1], [Property: User.Email (string) Required Index MaxLength(254), 2], [Property: User.FullName (string) Required MaxLength(100), 3], [Property: User.PasswordChangedAt (DateTime) Required ValueGenerated.OnAdd, 4], [Property: User.PasswordHash (string) Required MaxLength(200), 5], [Property: User.Username (string) Required Index MaxLength(50), 6] }
        SELECT TOP(1) u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
        FROM users AS u
        WHERE u.id == @__p_0), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, User>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)
    .SingleOrDefault()'
2022-09-21 17:58:35.539 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-21 17:58:35.540 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2022-09-21 17:58:35.541 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-21 17:58:35.542 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 17:58:35.544 +01:00 [DBG] Executing DbCommand [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.id = @__p_0
LIMIT 1
2022-09-21 17:58:35.548 +01:00 [INF] Executed DbCommand (5ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.id = @__p_0
LIMIT 1
2022-09-21 17:58:35.550 +01:00 [DBG] Context 'PostgresContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 17:58:35.552 +01:00 [DBG] A data reader was disposed.
2022-09-21 17:58:35.553 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 17:58:35.554 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-21 17:58:35.555 +01:00 [INF] Executing endpoint 'APIBank.Controllers.UsersController.RevokeToken (APIBank)'
2022-09-21 17:58:35.556 +01:00 [INF] Route matched with {action = "RevokeToken", controller = "Users"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult RevokeToken(APIBank.Models.Users.Requests.RevokeTokenRequest) on controller APIBank.Controllers.UsersController (APIBank).
2022-09-21 17:58:35.558 +01:00 [DBG] Execution plan of authorization filters (in the following order): ["APIBank.Authorization.AuthorizeAttribute"]
2022-09-21 17:58:35.560 +01:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2022-09-21 17:58:35.561 +01:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2022-09-21 17:58:35.565 +01:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2022-09-21 17:58:35.566 +01:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2022-09-21 17:58:35.568 +01:00 [DBG] Executing controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-21 17:58:35.569 +01:00 [DBG] Executed controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-21 17:58:35.570 +01:00 [DBG] Attempting to bind parameter 'model' of type 'APIBank.Models.Users.Requests.RevokeTokenRequest' ...
2022-09-21 17:58:35.571 +01:00 [DBG] Attempting to bind parameter 'model' of type 'APIBank.Models.Users.Requests.RevokeTokenRequest' using the name '' in request data ...
2022-09-21 17:58:35.572 +01:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2022-09-21 17:58:35.574 +01:00 [DBG] Connection id "0HMKRU9O686VS", Request id "0HMKRU9O686VS:0000000B": started reading request body.
2022-09-21 17:58:35.575 +01:00 [DBG] Connection id "0HMKRU9O686VS", Request id "0HMKRU9O686VS:0000000B": done reading request body.
2022-09-21 17:58:35.577 +01:00 [DBG] JSON input formatter succeeded, deserializing to type 'APIBank.Models.Users.Requests.RevokeTokenRequest'
2022-09-21 17:58:35.580 +01:00 [DBG] Done attempting to bind parameter 'model' of type 'APIBank.Models.Users.Requests.RevokeTokenRequest'.
2022-09-21 17:58:35.585 +01:00 [DBG] Done attempting to bind parameter 'model' of type 'APIBank.Models.Users.Requests.RevokeTokenRequest'.
2022-09-21 17:58:35.586 +01:00 [DBG] Attempting to validate the bound parameter 'model' of type 'APIBank.Models.Users.Requests.RevokeTokenRequest' ...
2022-09-21 17:58:35.588 +01:00 [DBG] Done attempting to validate the bound parameter 'model' of type 'APIBank.Models.Users.Requests.RevokeTokenRequest'.
2022-09-21 17:59:02.604 +01:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .SingleOrDefault(userQuery => userQuery.RefreshTokenCollection
        .Any(refTokenQuery => refTokenQuery.RefToken == __refToken_0))'
2022-09-21 17:59:02.610 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<User>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: User.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: User.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 1], [Property: User.Email (string) Required Index MaxLength(254), 2], [Property: User.FullName (string) Required MaxLength(100), 3], [Property: User.PasswordChangedAt (DateTime) Required ValueGenerated.OnAdd, 4], [Property: User.PasswordHash (string) Required MaxLength(200), 5], [Property: User.Username (string) Required Index MaxLength(50), 6] }
        SELECT TOP(2) u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
        FROM users AS u
        WHERE EXISTS (
            SELECT 1
            FROM refresh_token AS r
            WHERE ((u.id != NULL) && (u.id == r.user_id)) && (r.token == @__refToken_0))), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, User>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)
    .SingleOrDefault()'
2022-09-21 17:59:02.612 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-21 17:59:02.613 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2022-09-21 17:59:02.614 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-21 17:59:02.614 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 17:59:02.615 +01:00 [DBG] Executing DbCommand [Parameters=[@__refToken_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE EXISTS (
    SELECT 1
    FROM refresh_token AS r
    WHERE (u.id = r.user_id) AND (r.token = @__refToken_0))
LIMIT 2
2022-09-21 17:59:02.619 +01:00 [INF] Executed DbCommand (4ms) [Parameters=[@__refToken_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE EXISTS (
    SELECT 1
    FROM refresh_token AS r
    WHERE (u.id = r.user_id) AND (r.token = @__refToken_0))
LIMIT 2
2022-09-21 17:59:02.621 +01:00 [DBG] A data reader was disposed.
2022-09-21 17:59:02.622 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 17:59:02.622 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-21 17:59:02.628 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-21 17:59:02.629 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2022-09-21 17:59:02.630 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-21 17:59:02.631 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 17:59:02.632 +01:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.user_id AS "UserId", r.token AS "RefToken", r.expires AS "Expires", r.created AS "Created", r.created_by_ip AS "CreatedByIp", r.revoked AS "Revoked", r.revoked_by_ip AS "RevokedByIp", r.replaced_by_token AS "ReplacedByToken", r.reason_revoked AS "ReasonRevoked", r.is_expired AS "IsExpired", r.is_revoked AS "IsRevoked", r.is_active AS "IsActive"
FROM refresh_token AS r
WHERE r.user_id = @__id_0
2022-09-21 17:59:02.635 +01:00 [INF] Executed DbCommand (3ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.user_id AS "UserId", r.token AS "RefToken", r.expires AS "Expires", r.created AS "Created", r.created_by_ip AS "CreatedByIp", r.revoked AS "Revoked", r.revoked_by_ip AS "RevokedByIp", r.replaced_by_token AS "ReplacedByToken", r.reason_revoked AS "ReasonRevoked", r.is_expired AS "IsExpired", r.is_revoked AS "IsRevoked", r.is_active AS "IsActive"
FROM refresh_token AS r
WHERE r.user_id = @__id_0
2022-09-21 17:59:02.637 +01:00 [DBG] A data reader was disposed.
2022-09-21 17:59:02.638 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 17:59:02.639 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-21 17:59:02.641 +01:00 [DBG] An entity of type 'User' tracked by 'PostgresContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 17:59:02.644 +01:00 [DBG] Context 'PostgresContext' started tracking 'RefreshToken' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 17:59:02.646 +01:00 [DBG] SaveChanges starting for 'PostgresContext'.
2022-09-21 17:59:02.647 +01:00 [DBG] DetectChanges starting for 'PostgresContext'.
2022-09-21 17:59:02.648 +01:00 [DBG] DetectChanges completed for 'PostgresContext'.
2022-09-21 17:59:02.648 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-21 17:59:02.649 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 17:59:02.650 +01:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2022-09-21 17:59:02.651 +01:00 [DBG] Began transaction with isolation level 'ReadCommitted'.
2022-09-21 17:59:02.658 +01:00 [DBG] Executing 2 update commands as a batch.
2022-09-21 17:59:02.659 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-21 17:59:02.659 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2022-09-21 17:59:02.660 +01:00 [DBG] Executing DbCommand [Parameters=[@p12='?' (DbType = Int32), @p0='?' (DbType = DateTime), @p1='?', @p2='?' (DbType = DateTime), @p3='?' (DbType = Boolean), @p4='?' (DbType = Boolean), @p5='?' (DbType = Boolean), @p6='?', @p7='?', @p8='?', @p9='?' (DbType = DateTime), @p10='?', @p11='?' (DbType = Int32), @p19='?' (DbType = Int32), @p13='?' (DbType = DateTime), @p14='?', @p15='?', @p16='?' (DbType = DateTime), @p17='?', @p18='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE refresh_token SET created = @p0, created_by_ip = @p1, expires = @p2, is_active = @p3, is_expired = @p4, is_revoked = @p5, reason_revoked = @p6, token = @p7, replaced_by_token = @p8, revoked = @p9, revoked_by_ip = @p10, user_id = @p11
WHERE id = @p12;
UPDATE users SET created_at = @p13, email = @p14, full_name = @p15, password_changed_at = @p16, password_hash = @p17, username = @p18
WHERE id = @p19;
2022-09-21 17:59:02.662 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[@p12='?' (DbType = Int32), @p0='?' (DbType = DateTime), @p1='?', @p2='?' (DbType = DateTime), @p3='?' (DbType = Boolean), @p4='?' (DbType = Boolean), @p5='?' (DbType = Boolean), @p6='?', @p7='?', @p8='?', @p9='?' (DbType = DateTime), @p10='?', @p11='?' (DbType = Int32), @p19='?' (DbType = Int32), @p13='?' (DbType = DateTime), @p14='?', @p15='?', @p16='?' (DbType = DateTime), @p17='?', @p18='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE refresh_token SET created = @p0, created_by_ip = @p1, expires = @p2, is_active = @p3, is_expired = @p4, is_revoked = @p5, reason_revoked = @p6, token = @p7, replaced_by_token = @p8, revoked = @p9, revoked_by_ip = @p10, user_id = @p11
WHERE id = @p12;
UPDATE users SET created_at = @p13, email = @p14, full_name = @p15, password_changed_at = @p16, password_hash = @p17, username = @p18
WHERE id = @p19;
2022-09-21 17:59:02.664 +01:00 [DBG] A data reader was disposed.
2022-09-21 17:59:02.664 +01:00 [DBG] Committing transaction.
2022-09-21 17:59:02.666 +01:00 [DBG] Committed transaction.
2022-09-21 17:59:02.666 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 17:59:02.667 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-21 17:59:02.668 +01:00 [DBG] Disposing transaction.
2022-09-21 17:59:02.669 +01:00 [DBG] An entity of type 'User' tracked by 'PostgresContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 17:59:02.670 +01:00 [DBG] An entity of type 'RefreshToken' tracked by 'PostgresContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 17:59:02.673 +01:00 [DBG] SaveChanges completed for 'PostgresContext' with 2 entities written to the database.
2022-09-21 17:59:02.674 +01:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2022-09-21 17:59:02.677 +01:00 [DBG] No information found on request to perform content negotiation.
2022-09-21 17:59:02.677 +01:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2022-09-21 17:59:02.678 +01:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2022-09-21 17:59:02.678 +01:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2022-09-21 17:59:02.679 +01:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType0`1[[System.String, System.Private.CoreLib, Version=6.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2022-09-21 17:59:02.681 +01:00 [INF] Executed action APIBank.Controllers.UsersController.RevokeToken (APIBank) in 27113.648ms
2022-09-21 17:59:02.684 +01:00 [INF] Executed endpoint 'APIBank.Controllers.UsersController.RevokeToken (APIBank)'
2022-09-21 17:59:02.690 +01:00 [DBG] 'PostgresContext' disposed.
2022-09-21 17:59:02.691 +01:00 [INF] Request finished HTTP/2 POST https://localhost:7036/api/Users/revoke-token application/json 17 - 200 - application/json;+charset=utf-8 27339.5161ms
2022-09-21 18:02:09.311 +01:00 [DBG] Registered model binder providers, in the following order: ["Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BinderTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ServicesModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.BodyModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.HeaderModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FloatingPointTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.EnumTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DateTimeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.SimpleTypeModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CancellationTokenModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ByteArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormFileModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.FormCollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.KeyValuePairModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.DictionaryModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ArrayModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.CollectionModelBinderProvider","Microsoft.AspNetCore.Mvc.ModelBinding.Binders.ComplexObjectModelBinderProvider"]
2022-09-21 18:02:09.372 +01:00 [DBG] Hosting starting
2022-09-21 18:02:09.442 +01:00 [DBG] Using development certificate: CN=localhost (Thumbprint: 9CC642E9838495A6C3C202DECA6A8AD300396DD2)
2022-09-21 18:02:09.483 +01:00 [INF] Now listening on: https://localhost:7036
2022-09-21 18:02:09.485 +01:00 [INF] Now listening on: http://localhost:5036
2022-09-21 18:02:09.487 +01:00 [DBG] Loaded hosting startup assembly APIBank
2022-09-21 18:02:09.488 +01:00 [DBG] Loaded hosting startup assembly Microsoft.AspNetCore.Watch.BrowserRefresh
2022-09-21 18:02:09.488 +01:00 [DBG] Loaded hosting startup assembly Microsoft.WebTools.BrowserLink.Net
2022-09-21 18:02:09.489 +01:00 [INF] Application started. Press Ctrl+C to shut down.
2022-09-21 18:02:09.490 +01:00 [INF] Hosting environment: Development
2022-09-21 18:02:09.490 +01:00 [INF] Content root path: C:\Users\mguedesa\OneDrive - NTT DATA EMEAL\Documentos\GitHub\OpenBankAPI-NTT\APIBank\APIBank\
2022-09-21 18:02:09.491 +01:00 [DBG] Hosting started
2022-09-21 18:02:09.535 +01:00 [DBG] Connection id "0HMKRUC2LFJIL" accepted.
2022-09-21 18:02:09.536 +01:00 [DBG] Connection id "0HMKRUC2LFJIM" accepted.
2022-09-21 18:02:09.539 +01:00 [DBG] Connection id "0HMKRUC2LFJIL" started.
2022-09-21 18:02:09.539 +01:00 [DBG] Connection id "0HMKRUC2LFJIM" started.
2022-09-21 18:02:09.554 +01:00 [DBG] Connection id "0HMKRUC2LFJIM" received FIN.
2022-09-21 18:02:09.554 +01:00 [DBG] Connection id "0HMKRUC2LFJIL" received FIN.
2022-09-21 18:02:09.562 +01:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException:  Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.<FillHandshakeBufferAsync>g__InternalFillHandshakeBufferAsync|189_0[TIOAdapter](TIOAdapter adap, ValueTask`1 task, Int32 minSize)
   at System.Net.Security.SslStream.ReceiveBlobAsync[TIOAdapter](TIOAdapter adapter)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](TIOAdapter adapter, Boolean receiveFirst, Byte[] reAuthenticationData, Boolean isApm)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2022-09-21 18:02:09.562 +01:00 [DBG] Failed to authenticate HTTPS connection.
System.IO.IOException:  Received an unexpected EOF or 0 bytes from the transport stream.
   at System.Net.Security.SslStream.<FillHandshakeBufferAsync>g__InternalFillHandshakeBufferAsync|189_0[TIOAdapter](TIOAdapter adap, ValueTask`1 task, Int32 minSize)
   at System.Net.Security.SslStream.ReceiveBlobAsync[TIOAdapter](TIOAdapter adapter)
   at System.Net.Security.SslStream.ForceAuthenticationAsync[TIOAdapter](TIOAdapter adapter, Boolean receiveFirst, Byte[] reAuthenticationData, Boolean isApm)
   at Microsoft.AspNetCore.Server.Kestrel.Https.Internal.HttpsConnectionMiddleware.OnConnectionAsync(ConnectionContext context)
2022-09-21 18:02:09.593 +01:00 [DBG] Connection id "0HMKRUC2LFJIM" stopped.
2022-09-21 18:02:09.594 +01:00 [DBG] Connection id "0HMKRUC2LFJIL" stopped.
2022-09-21 18:02:09.595 +01:00 [DBG] Connection id "0HMKRUC2LFJIM" sending FIN because: "The Socket transport's send loop completed gracefully."
2022-09-21 18:02:09.595 +01:00 [DBG] Connection id "0HMKRUC2LFJIL" sending FIN because: "The Socket transport's send loop completed gracefully."
2022-09-21 18:02:09.711 +01:00 [DBG] Connection id "0HMKRUC2LFJIN" accepted.
2022-09-21 18:02:09.713 +01:00 [DBG] Connection id "0HMKRUC2LFJIN" started.
2022-09-21 18:02:09.754 +01:00 [DBG] Connection 0HMKRUC2LFJIN established using the following protocol: "Tls12"
2022-09-21 18:02:09.814 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/swagger/index.html - -
2022-09-21 18:02:09.836 +01:00 [DBG] Wildcard detected, all requests with hosts will be allowed.
2022-09-21 18:02:09.860 +01:00 [DBG] No candidates found for the request path '/swagger/index.html'
2022-09-21 18:02:09.861 +01:00 [DBG] Request did not match any endpoints
2022-09-21 18:02:09.940 +01:00 [DBG] Response markup is scheduled to include browser refresh script injection.
2022-09-21 18:02:10.026 +01:00 [DBG] Response markup was updated to include browser refresh script injection.
2022-09-21 18:02:10.030 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/swagger/index.html - - - 200 - text/html;charset=utf-8 218.6234ms
2022-09-21 18:02:10.058 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/_framework/aspnetcore-browser-refresh.js - -
2022-09-21 18:02:10.061 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/_vs/browserLink - -
2022-09-21 18:02:10.066 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/_framework/aspnetcore-browser-refresh.js - - - 200 11984 application/javascript;+charset=utf-8 7.9417ms
2022-09-21 18:02:10.092 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/_vs/browserLink - - - 200 - text/javascript;+charset=UTF-8 31.2768ms
2022-09-21 18:02:10.197 +01:00 [INF] Request starting HTTP/2 GET https://localhost:7036/swagger/v1/swagger.json - -
2022-09-21 18:02:10.200 +01:00 [DBG] No candidates found for the request path '/swagger/v1/swagger.json'
2022-09-21 18:02:10.202 +01:00 [DBG] Request did not match any endpoints
2022-09-21 18:02:10.346 +01:00 [INF] Request finished HTTP/2 GET https://localhost:7036/swagger/v1/swagger.json - - - 200 - application/json;charset=utf-8 148.7617ms
2022-09-21 18:02:19.980 +01:00 [INF] Request starting HTTP/2 POST https://localhost:7036/api/Users/Login application/json 58
2022-09-21 18:02:20.001 +01:00 [DBG] 1 candidate(s) found for the request path '/api/Users/Login'
2022-09-21 18:02:20.006 +01:00 [DBG] Endpoint 'APIBank.Controllers.UsersController.Login (APIBank)' with route pattern 'api/Users/Login' is valid for the request path '/api/Users/Login'
2022-09-21 18:02:20.013 +01:00 [DBG] Request matched endpoint 'APIBank.Controllers.UsersController.Login (APIBank)'
2022-09-21 18:02:20.019 +01:00 [DBG] Static files was skipped as the request already matched an endpoint.
2022-09-21 18:02:20.322 +01:00 [INF] Executing endpoint 'APIBank.Controllers.UsersController.Login (APIBank)'
2022-09-21 18:02:20.345 +01:00 [INF] Route matched with {action = "Login", controller = "Users"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult Login(APIBank.Models.Requests.LoginRequest) on controller APIBank.Controllers.UsersController (APIBank).
2022-09-21 18:02:20.353 +01:00 [DBG] Execution plan of authorization filters (in the following order): ["APIBank.Authorization.AuthorizeAttribute"]
2022-09-21 18:02:20.355 +01:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2022-09-21 18:02:20.356 +01:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2022-09-21 18:02:20.357 +01:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2022-09-21 18:02:20.358 +01:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2022-09-21 18:02:20.360 +01:00 [DBG] Executing controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-21 18:02:20.362 +01:00 [DBG] Executed controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-21 18:02:20.371 +01:00 [DBG] Attempting to bind parameter 'model' of type 'APIBank.Models.Requests.LoginRequest' ...
2022-09-21 18:02:20.374 +01:00 [DBG] Attempting to bind parameter 'model' of type 'APIBank.Models.Requests.LoginRequest' using the name '' in request data ...
2022-09-21 18:02:20.376 +01:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2022-09-21 18:02:20.383 +01:00 [DBG] Connection id "0HMKRUC2LFJIN", Request id "0HMKRUC2LFJIN:00000009": started reading request body.
2022-09-21 18:02:20.386 +01:00 [DBG] Connection id "0HMKRUC2LFJIN", Request id "0HMKRUC2LFJIN:00000009": done reading request body.
2022-09-21 18:02:20.391 +01:00 [DBG] JSON input formatter succeeded, deserializing to type 'APIBank.Models.Requests.LoginRequest'
2022-09-21 18:02:20.392 +01:00 [DBG] Done attempting to bind parameter 'model' of type 'APIBank.Models.Requests.LoginRequest'.
2022-09-21 18:02:20.392 +01:00 [DBG] Done attempting to bind parameter 'model' of type 'APIBank.Models.Requests.LoginRequest'.
2022-09-21 18:02:20.394 +01:00 [DBG] Attempting to validate the bound parameter 'model' of type 'APIBank.Models.Requests.LoginRequest' ...
2022-09-21 18:02:20.406 +01:00 [DBG] Done attempting to validate the bound parameter 'model' of type 'APIBank.Models.Requests.LoginRequest'.
2022-09-21 18:02:20.474 +01:00 [DBG] An additional 'IServiceProvider' was created for internal use by Entity Framework. An existing service provider was not used due to the following configuration changes: configuration changed for 'Core:ConfigureWarnings', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:UseAdminDatabase', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:SetPostgresVersion', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:UseRedshift', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:ReverseNullOrdering', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:RemoteCertificateValidationCallback', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:ProvideClientCertificatesCallback', configuration added for 'Npgsql.EntityFrameworkCore.PostgreSQL:ProvidePasswordCallback'.
2022-09-21 18:02:21.473 +01:00 [INF] Entity Framework Core 6.0.9 initialized 'PostgresContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:6.0.7+5b98e4b74de93b590b44aef8dd7967c03acc433c' with options: None
2022-09-21 18:02:21.512 +01:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .SingleOrDefault(x => x.Username == __model_Username_0)'
2022-09-21 18:02:21.718 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<User>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: User.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: User.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 1], [Property: User.Email (string) Required Index MaxLength(254), 2], [Property: User.FullName (string) Required MaxLength(100), 3], [Property: User.PasswordChangedAt (DateTime) Required ValueGenerated.OnAdd, 4], [Property: User.PasswordHash (string) Required MaxLength(200), 5], [Property: User.Username (string) Required Index MaxLength(50), 6] }
        SELECT TOP(2) u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
        FROM users AS u
        WHERE u.username == @__model_Username_0), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, User>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)
    .SingleOrDefault()'
2022-09-21 18:02:21.762 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-21 18:02:21.803 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (39ms).
2022-09-21 18:02:21.812 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-21 18:02:22.023 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 18:02:22.041 +01:00 [DBG] Executing DbCommand [Parameters=[@__model_Username_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.username = @__model_Username_0
LIMIT 2
2022-09-21 18:02:22.134 +01:00 [INF] Executed DbCommand (101ms) [Parameters=[@__model_Username_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.username = @__model_Username_0
LIMIT 2
2022-09-21 18:02:22.172 +01:00 [DBG] Context 'PostgresContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 18:02:22.209 +01:00 [DBG] A data reader was disposed.
2022-09-21 18:02:22.214 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 18:02:22.218 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-21 18:02:22.550 +01:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .Any(user => user.RefreshTokenCollection
        .Any(reftoken => reftoken.RefToken == __token_0))'
2022-09-21 18:02:22.637 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<bool>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            EmptyProjectionMember -> 0
        SELECT EXISTS (
            SELECT 1
            FROM users AS u
            WHERE EXISTS (
                SELECT 1
                FROM refresh_token AS r
                WHERE ((u.id != NULL) && (u.id == r.user_id)) && (r.token == @__token_0)))), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, bool>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)
    .Single()'
2022-09-21 18:02:22.650 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-21 18:02:22.652 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2022-09-21 18:02:22.652 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-21 18:02:22.653 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 18:02:22.654 +01:00 [DBG] Executing DbCommand [Parameters=[@__token_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM users AS u
    WHERE EXISTS (
        SELECT 1
        FROM refresh_token AS r
        WHERE (u.id = r.user_id) AND (r.token = @__token_0)))
2022-09-21 18:02:22.658 +01:00 [INF] Executed DbCommand (4ms) [Parameters=[@__token_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT EXISTS (
    SELECT 1
    FROM users AS u
    WHERE EXISTS (
        SELECT 1
        FROM refresh_token AS r
        WHERE (u.id = r.user_id) AND (r.token = @__token_0)))
2022-09-21 18:02:22.662 +01:00 [DBG] A data reader was disposed.
2022-09-21 18:02:22.663 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 18:02:22.665 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-21 18:02:22.672 +01:00 [DBG] Compiling query expression: 
'DbSet<RefreshToken>()
    .Where(rt => rt.UserId == __id_0)
    .AsNoTracking()
    .Select(rt => new RefreshToken{ 
        Id = rt.Id, 
        UserId = rt.UserId, 
        RefToken = rt.RefToken, 
        Expires = rt.Expires, 
        Created = rt.Created, 
        CreatedByIp = rt.CreatedByIp, 
        Revoked = rt.Revoked, 
        RevokedByIp = rt.RevokedByIp, 
        ReplacedByToken = rt.ReplacedByToken, 
        ReasonRevoked = rt.ReasonRevoked, 
        IsExpired = rt.IsExpired, 
        IsRevoked = rt.IsRevoked, 
        IsActive = rt.IsActive 
    }
    )'
2022-09-21 18:02:22.688 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<RefreshToken>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            Id -> 0
            UserId -> 1
            RefToken -> 2
            Expires -> 3
            Created -> 4
            CreatedByIp -> 5
            Revoked -> 6
            RevokedByIp -> 7
            ReplacedByToken -> 8
            ReasonRevoked -> 9
            IsExpired -> 10
            IsRevoked -> 11
            IsActive -> 12
        SELECT r.id AS Id, r.user_id AS UserId, r.token AS RefToken, r.expires AS Expires, r.created AS Created, r.created_by_ip AS CreatedByIp, r.revoked AS Revoked, r.revoked_by_ip AS RevokedByIp, r.replaced_by_token AS ReplacedByToken, r.reason_revoked AS ReasonRevoked, r.is_expired AS IsExpired, r.is_revoked AS IsRevoked, r.is_active AS IsActive
        FROM refresh_token AS r
        WHERE r.user_id == @__id_0), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, RefreshToken>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)'
2022-09-21 18:02:22.691 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-21 18:02:22.693 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2022-09-21 18:02:22.695 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-21 18:02:22.697 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 18:02:22.697 +01:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.user_id AS "UserId", r.token AS "RefToken", r.expires AS "Expires", r.created AS "Created", r.created_by_ip AS "CreatedByIp", r.revoked AS "Revoked", r.revoked_by_ip AS "RevokedByIp", r.replaced_by_token AS "ReplacedByToken", r.reason_revoked AS "ReasonRevoked", r.is_expired AS "IsExpired", r.is_revoked AS "IsRevoked", r.is_active AS "IsActive"
FROM refresh_token AS r
WHERE r.user_id = @__id_0
2022-09-21 18:02:22.701 +01:00 [INF] Executed DbCommand (3ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.user_id AS "UserId", r.token AS "RefToken", r.expires AS "Expires", r.created AS "Created", r.created_by_ip AS "CreatedByIp", r.revoked AS "Revoked", r.revoked_by_ip AS "RevokedByIp", r.replaced_by_token AS "ReplacedByToken", r.reason_revoked AS "ReasonRevoked", r.is_expired AS "IsExpired", r.is_revoked AS "IsRevoked", r.is_active AS "IsActive"
FROM refresh_token AS r
WHERE r.user_id = @__id_0
2022-09-21 18:02:22.704 +01:00 [DBG] A data reader was disposed.
2022-09-21 18:02:22.705 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 18:02:22.706 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-21 18:02:22.719 +01:00 [DBG] An entity of type 'User' tracked by 'PostgresContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 18:02:22.738 +01:00 [DBG] 'PostgresContext' generated a temporary value for the property 'Id.RefreshToken'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 18:02:22.777 +01:00 [DBG] Context 'PostgresContext' started tracking 'RefreshToken' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 18:02:22.783 +01:00 [DBG] SaveChanges starting for 'PostgresContext'.
2022-09-21 18:02:22.785 +01:00 [DBG] DetectChanges starting for 'PostgresContext'.
2022-09-21 18:02:22.808 +01:00 [DBG] 1 entities were added and 0 entities were removed from navigation 'User.RefreshTokenCollection'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 18:02:22.822 +01:00 [DBG] The foreign key property 'RefreshToken.UserId' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2022-09-21 18:02:22.838 +01:00 [DBG] DetectChanges completed for 'PostgresContext'.
2022-09-21 18:02:22.853 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-21 18:02:22.857 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 18:02:22.862 +01:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2022-09-21 18:02:22.867 +01:00 [DBG] Began transaction with isolation level 'ReadCommitted'.
2022-09-21 18:02:22.920 +01:00 [DBG] Executing 2 update commands as a batch.
2022-09-21 18:02:22.935 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-21 18:02:22.939 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (3ms).
2022-09-21 18:02:22.941 +01:00 [DBG] Executing DbCommand [Parameters=[@p0='?' (DbType = DateTime), @p1='?', @p2='?' (DbType = DateTime), @p3='?' (DbType = Boolean), @p4='?' (DbType = Boolean), @p5='?' (DbType = Boolean), @p6='?', @p7='?', @p8='?', @p9='?' (DbType = DateTime), @p10='?', @p11='?' (DbType = Int32), @p18='?' (DbType = Int32), @p12='?' (DbType = DateTime), @p13='?', @p14='?', @p15='?' (DbType = DateTime), @p16='?', @p17='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO refresh_token (created, created_by_ip, expires, is_active, is_expired, is_revoked, reason_revoked, token, replaced_by_token, revoked, revoked_by_ip, user_id)
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11)
RETURNING id;
UPDATE users SET created_at = @p12, email = @p13, full_name = @p14, password_changed_at = @p15, password_hash = @p16, username = @p17
WHERE id = @p18;
2022-09-21 18:02:22.948 +01:00 [INF] Executed DbCommand (7ms) [Parameters=[@p0='?' (DbType = DateTime), @p1='?', @p2='?' (DbType = DateTime), @p3='?' (DbType = Boolean), @p4='?' (DbType = Boolean), @p5='?' (DbType = Boolean), @p6='?', @p7='?', @p8='?', @p9='?' (DbType = DateTime), @p10='?', @p11='?' (DbType = Int32), @p18='?' (DbType = Int32), @p12='?' (DbType = DateTime), @p13='?', @p14='?', @p15='?' (DbType = DateTime), @p16='?', @p17='?'], CommandType='"Text"', CommandTimeout='30']
INSERT INTO refresh_token (created, created_by_ip, expires, is_active, is_expired, is_revoked, reason_revoked, token, replaced_by_token, revoked, revoked_by_ip, user_id)
VALUES (@p0, @p1, @p2, @p3, @p4, @p5, @p6, @p7, @p8, @p9, @p10, @p11)
RETURNING id;
UPDATE users SET created_at = @p12, email = @p13, full_name = @p14, password_changed_at = @p15, password_hash = @p16, username = @p17
WHERE id = @p18;
2022-09-21 18:02:22.963 +01:00 [DBG] The foreign key property 'RefreshToken.Id' was detected as changed. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see property values.
2022-09-21 18:02:22.966 +01:00 [DBG] A data reader was disposed.
2022-09-21 18:02:22.968 +01:00 [DBG] Committing transaction.
2022-09-21 18:02:22.973 +01:00 [DBG] Committed transaction.
2022-09-21 18:02:22.974 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 18:02:22.976 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-21 18:02:22.979 +01:00 [DBG] Disposing transaction.
2022-09-21 18:02:22.983 +01:00 [DBG] An entity of type 'RefreshToken' tracked by 'PostgresContext' changed state from '"Added"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 18:02:22.986 +01:00 [DBG] An entity of type 'User' tracked by 'PostgresContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 18:02:22.988 +01:00 [DBG] SaveChanges completed for 'PostgresContext' with 2 entities written to the database.
2022-09-21 18:02:22.992 +01:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2022-09-21 18:02:22.996 +01:00 [DBG] Attempting to select an output formatter based on Accept header '["text/plain"]'.
2022-09-21 18:02:22.998 +01:00 [DBG] Could not find an output formatter based on content negotiation. Accepted types were (["text/plain"])
2022-09-21 18:02:22.999 +01:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2022-09-21 18:02:23.000 +01:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2022-09-21 18:02:23.002 +01:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2022-09-21 18:02:23.003 +01:00 [INF] Executing OkObjectResult, writing value of type 'APIBank.Models.Users.Responses.LoginResponse'.
2022-09-21 18:02:23.016 +01:00 [INF] Executed action APIBank.Controllers.UsersController.Login (APIBank) in 2652.3801ms
2022-09-21 18:02:23.018 +01:00 [INF] Executed endpoint 'APIBank.Controllers.UsersController.Login (APIBank)'
2022-09-21 18:02:23.021 +01:00 [DBG] 'PostgresContext' disposed.
2022-09-21 18:02:23.024 +01:00 [INF] Request finished HTTP/2 POST https://localhost:7036/api/Users/Login application/json 58 - 200 - application/json;+charset=utf-8 3043.2491ms
2022-09-21 18:02:38.400 +01:00 [INF] Request starting HTTP/2 POST https://localhost:7036/api/Users/revoke-token application/json 17
2022-09-21 18:02:38.406 +01:00 [DBG] 1 candidate(s) found for the request path '/api/Users/revoke-token'
2022-09-21 18:02:38.409 +01:00 [DBG] Endpoint 'APIBank.Controllers.UsersController.RevokeToken (APIBank)' with route pattern 'api/Users/revoke-token' is valid for the request path '/api/Users/revoke-token'
2022-09-21 18:02:38.411 +01:00 [DBG] Request matched endpoint 'APIBank.Controllers.UsersController.RevokeToken (APIBank)'
2022-09-21 18:02:38.412 +01:00 [DBG] Static files was skipped as the request already matched an endpoint.
2022-09-21 18:02:38.496 +01:00 [INF] Entity Framework Core 6.0.9 initialized 'PostgresContext' using provider 'Npgsql.EntityFrameworkCore.PostgreSQL:6.0.7+5b98e4b74de93b590b44aef8dd7967c03acc433c' with options: None
2022-09-21 18:02:38.516 +01:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .FirstOrDefault(e => EF.Property<int>(e, "Id") == __p_0)'
2022-09-21 18:02:38.525 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<User>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: User.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: User.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 1], [Property: User.Email (string) Required Index MaxLength(254), 2], [Property: User.FullName (string) Required MaxLength(100), 3], [Property: User.PasswordChangedAt (DateTime) Required ValueGenerated.OnAdd, 4], [Property: User.PasswordHash (string) Required MaxLength(200), 5], [Property: User.Username (string) Required Index MaxLength(50), 6] }
        SELECT TOP(1) u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
        FROM users AS u
        WHERE u.id == @__p_0), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, User>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)
    .SingleOrDefault()'
2022-09-21 18:02:38.526 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-21 18:02:38.527 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2022-09-21 18:02:38.528 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-21 18:02:38.529 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 18:02:38.531 +01:00 [DBG] Executing DbCommand [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.id = @__p_0
LIMIT 1
2022-09-21 18:02:38.536 +01:00 [INF] Executed DbCommand (4ms) [Parameters=[@__p_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE u.id = @__p_0
LIMIT 1
2022-09-21 18:02:38.539 +01:00 [DBG] Context 'PostgresContext' started tracking 'User' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 18:02:38.539 +01:00 [DBG] A data reader was disposed.
2022-09-21 18:02:38.540 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 18:02:38.541 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-21 18:02:38.542 +01:00 [INF] Executing endpoint 'APIBank.Controllers.UsersController.RevokeToken (APIBank)'
2022-09-21 18:02:38.543 +01:00 [INF] Route matched with {action = "RevokeToken", controller = "Users"}. Executing controller action with signature Microsoft.AspNetCore.Mvc.IActionResult RevokeToken(APIBank.Models.Users.Requests.RevokeTokenRequest) on controller APIBank.Controllers.UsersController (APIBank).
2022-09-21 18:02:38.545 +01:00 [DBG] Execution plan of authorization filters (in the following order): ["APIBank.Authorization.AuthorizeAttribute"]
2022-09-21 18:02:38.546 +01:00 [DBG] Execution plan of resource filters (in the following order): ["None"]
2022-09-21 18:02:38.548 +01:00 [DBG] Execution plan of action filters (in the following order): ["Microsoft.AspNetCore.Mvc.ModelBinding.UnsupportedContentTypeFilter (Order: -3000)","Microsoft.AspNetCore.Mvc.Infrastructure.ModelStateInvalidFilter (Order: -2000)"]
2022-09-21 18:02:38.550 +01:00 [DBG] Execution plan of exception filters (in the following order): ["None"]
2022-09-21 18:02:38.554 +01:00 [DBG] Execution plan of result filters (in the following order): ["Microsoft.AspNetCore.Mvc.Infrastructure.ClientErrorResultFilter (Order: -2000)"]
2022-09-21 18:02:38.555 +01:00 [DBG] Executing controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-21 18:02:38.556 +01:00 [DBG] Executed controller factory for controller APIBank.Controllers.UsersController (APIBank)
2022-09-21 18:02:38.557 +01:00 [DBG] Attempting to bind parameter 'model' of type 'APIBank.Models.Users.Requests.RevokeTokenRequest' ...
2022-09-21 18:02:38.558 +01:00 [DBG] Attempting to bind parameter 'model' of type 'APIBank.Models.Users.Requests.RevokeTokenRequest' using the name '' in request data ...
2022-09-21 18:02:38.559 +01:00 [DBG] Selected input formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonInputFormatter' for content type 'application/json'.
2022-09-21 18:02:38.560 +01:00 [DBG] Connection id "0HMKRUC2LFJIN", Request id "0HMKRUC2LFJIN:0000000B": started reading request body.
2022-09-21 18:02:38.560 +01:00 [DBG] Connection id "0HMKRUC2LFJIN", Request id "0HMKRUC2LFJIN:0000000B": done reading request body.
2022-09-21 18:02:38.562 +01:00 [DBG] JSON input formatter succeeded, deserializing to type 'APIBank.Models.Users.Requests.RevokeTokenRequest'
2022-09-21 18:02:38.563 +01:00 [DBG] Done attempting to bind parameter 'model' of type 'APIBank.Models.Users.Requests.RevokeTokenRequest'.
2022-09-21 18:02:38.564 +01:00 [DBG] Done attempting to bind parameter 'model' of type 'APIBank.Models.Users.Requests.RevokeTokenRequest'.
2022-09-21 18:02:38.565 +01:00 [DBG] Attempting to validate the bound parameter 'model' of type 'APIBank.Models.Users.Requests.RevokeTokenRequest' ...
2022-09-21 18:02:38.570 +01:00 [DBG] Done attempting to validate the bound parameter 'model' of type 'APIBank.Models.Users.Requests.RevokeTokenRequest'.
2022-09-21 18:02:38.574 +01:00 [DBG] Compiling query expression: 
'DbSet<User>()
    .SingleOrDefault(userQuery => userQuery.RefreshTokenCollection
        .Any(refTokenQuery => refTokenQuery.RefToken == __refToken_0))'
2022-09-21 18:02:38.578 +01:00 [DBG] Generated query execution expression: 
'queryContext => new SingleQueryingEnumerable<User>(
    (RelationalQueryContext)queryContext, 
    RelationalCommandCache.SelectExpression(
        Projection Mapping:
            EmptyProjectionMember -> Dictionary<IProperty, int> { [Property: User.Id (int) Required PK AfterSave:Throw ValueGenerated.OnAdd, 0], [Property: User.CreatedAt (DateTime) Required ValueGenerated.OnAdd, 1], [Property: User.Email (string) Required Index MaxLength(254), 2], [Property: User.FullName (string) Required MaxLength(100), 3], [Property: User.PasswordChangedAt (DateTime) Required ValueGenerated.OnAdd, 4], [Property: User.PasswordHash (string) Required MaxLength(200), 5], [Property: User.Username (string) Required Index MaxLength(50), 6] }
        SELECT TOP(2) u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
        FROM users AS u
        WHERE EXISTS (
            SELECT 1
            FROM refresh_token AS r
            WHERE ((u.id != NULL) && (u.id == r.user_id)) && (r.token == @__refToken_0))), 
    Func<QueryContext, DbDataReader, ResultContext, SingleQueryResultCoordinator, User>, 
    APIBank.Helpers.PostgresContext, 
    False, 
    False, 
    True
)
    .SingleOrDefault()'
2022-09-21 18:02:38.581 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-21 18:02:38.582 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (0ms).
2022-09-21 18:02:38.586 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-21 18:02:38.588 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 18:02:38.589 +01:00 [DBG] Executing DbCommand [Parameters=[@__refToken_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE EXISTS (
    SELECT 1
    FROM refresh_token AS r
    WHERE (u.id = r.user_id) AND (r.token = @__refToken_0))
LIMIT 2
2022-09-21 18:02:38.591 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[@__refToken_0='?'], CommandType='"Text"', CommandTimeout='30']
SELECT u.id, u.created_at, u.email, u.full_name, u.password_changed_at, u.password_hash, u.username
FROM users AS u
WHERE EXISTS (
    SELECT 1
    FROM refresh_token AS r
    WHERE (u.id = r.user_id) AND (r.token = @__refToken_0))
LIMIT 2
2022-09-21 18:02:38.592 +01:00 [DBG] A data reader was disposed.
2022-09-21 18:02:38.593 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 18:02:38.593 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-21 18:02:38.597 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-21 18:02:38.599 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2022-09-21 18:02:38.602 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-21 18:02:38.603 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 18:02:38.604 +01:00 [DBG] Executing DbCommand [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.user_id AS "UserId", r.token AS "RefToken", r.expires AS "Expires", r.created AS "Created", r.created_by_ip AS "CreatedByIp", r.revoked AS "Revoked", r.revoked_by_ip AS "RevokedByIp", r.replaced_by_token AS "ReplacedByToken", r.reason_revoked AS "ReasonRevoked", r.is_expired AS "IsExpired", r.is_revoked AS "IsRevoked", r.is_active AS "IsActive"
FROM refresh_token AS r
WHERE r.user_id = @__id_0
2022-09-21 18:02:38.605 +01:00 [INF] Executed DbCommand (2ms) [Parameters=[@__id_0='?' (DbType = Int32)], CommandType='"Text"', CommandTimeout='30']
SELECT r.id AS "Id", r.user_id AS "UserId", r.token AS "RefToken", r.expires AS "Expires", r.created AS "Created", r.created_by_ip AS "CreatedByIp", r.revoked AS "Revoked", r.revoked_by_ip AS "RevokedByIp", r.replaced_by_token AS "ReplacedByToken", r.reason_revoked AS "ReasonRevoked", r.is_expired AS "IsExpired", r.is_revoked AS "IsRevoked", r.is_active AS "IsActive"
FROM refresh_token AS r
WHERE r.user_id = @__id_0
2022-09-21 18:02:38.608 +01:00 [DBG] A data reader was disposed.
2022-09-21 18:02:38.608 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 18:02:38.609 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-21 18:02:38.610 +01:00 [DBG] An entity of type 'User' tracked by 'PostgresContext' changed state from '"Unchanged"' to '"Modified"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 18:02:38.612 +01:00 [DBG] Context 'PostgresContext' started tracking 'RefreshToken' entity. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 18:02:38.616 +01:00 [DBG] SaveChanges starting for 'PostgresContext'.
2022-09-21 18:02:38.620 +01:00 [DBG] DetectChanges starting for 'PostgresContext'.
2022-09-21 18:02:38.621 +01:00 [DBG] DetectChanges completed for 'PostgresContext'.
2022-09-21 18:02:38.621 +01:00 [DBG] Opening connection to database 'BankAPI' on server ''.
2022-09-21 18:02:38.622 +01:00 [DBG] Opened connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 18:02:38.623 +01:00 [DBG] Beginning transaction with isolation level 'Unspecified'.
2022-09-21 18:02:38.624 +01:00 [DBG] Began transaction with isolation level 'ReadCommitted'.
2022-09-21 18:02:38.627 +01:00 [DBG] Executing 2 update commands as a batch.
2022-09-21 18:02:38.628 +01:00 [DBG] Creating DbCommand for 'ExecuteReader'.
2022-09-21 18:02:38.629 +01:00 [DBG] Created DbCommand for 'ExecuteReader' (1ms).
2022-09-21 18:02:38.631 +01:00 [DBG] Executing DbCommand [Parameters=[@p12='?' (DbType = Int32), @p0='?' (DbType = DateTime), @p1='?', @p2='?' (DbType = DateTime), @p3='?' (DbType = Boolean), @p4='?' (DbType = Boolean), @p5='?' (DbType = Boolean), @p6='?', @p7='?', @p8='?', @p9='?' (DbType = DateTime), @p10='?', @p11='?' (DbType = Int32), @p19='?' (DbType = Int32), @p13='?' (DbType = DateTime), @p14='?', @p15='?', @p16='?' (DbType = DateTime), @p17='?', @p18='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE refresh_token SET created = @p0, created_by_ip = @p1, expires = @p2, is_active = @p3, is_expired = @p4, is_revoked = @p5, reason_revoked = @p6, token = @p7, replaced_by_token = @p8, revoked = @p9, revoked_by_ip = @p10, user_id = @p11
WHERE id = @p12;
UPDATE users SET created_at = @p13, email = @p14, full_name = @p15, password_changed_at = @p16, password_hash = @p17, username = @p18
WHERE id = @p19;
2022-09-21 18:02:38.635 +01:00 [INF] Executed DbCommand (5ms) [Parameters=[@p12='?' (DbType = Int32), @p0='?' (DbType = DateTime), @p1='?', @p2='?' (DbType = DateTime), @p3='?' (DbType = Boolean), @p4='?' (DbType = Boolean), @p5='?' (DbType = Boolean), @p6='?', @p7='?', @p8='?', @p9='?' (DbType = DateTime), @p10='?', @p11='?' (DbType = Int32), @p19='?' (DbType = Int32), @p13='?' (DbType = DateTime), @p14='?', @p15='?', @p16='?' (DbType = DateTime), @p17='?', @p18='?'], CommandType='"Text"', CommandTimeout='30']
UPDATE refresh_token SET created = @p0, created_by_ip = @p1, expires = @p2, is_active = @p3, is_expired = @p4, is_revoked = @p5, reason_revoked = @p6, token = @p7, replaced_by_token = @p8, revoked = @p9, revoked_by_ip = @p10, user_id = @p11
WHERE id = @p12;
UPDATE users SET created_at = @p13, email = @p14, full_name = @p15, password_changed_at = @p16, password_hash = @p17, username = @p18
WHERE id = @p19;
2022-09-21 18:02:38.637 +01:00 [DBG] A data reader was disposed.
2022-09-21 18:02:38.638 +01:00 [DBG] Committing transaction.
2022-09-21 18:02:38.640 +01:00 [DBG] Committed transaction.
2022-09-21 18:02:38.640 +01:00 [DBG] Closing connection to database 'BankAPI' on server 'tcp://localhost:5433'.
2022-09-21 18:02:38.641 +01:00 [DBG] Closed connection to database 'BankAPI' on server ''.
2022-09-21 18:02:38.641 +01:00 [DBG] Disposing transaction.
2022-09-21 18:02:38.642 +01:00 [DBG] An entity of type 'User' tracked by 'PostgresContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 18:02:38.643 +01:00 [DBG] An entity of type 'RefreshToken' tracked by 'PostgresContext' changed state from '"Modified"' to '"Unchanged"'. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see key values.
2022-09-21 18:02:38.644 +01:00 [DBG] SaveChanges completed for 'PostgresContext' with 2 entities written to the database.
2022-09-21 18:02:38.646 +01:00 [DBG] List of registered output formatters, in the following order: ["Microsoft.AspNetCore.Mvc.Formatters.HttpNoContentOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StringOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.StreamOutputFormatter","Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter"]
2022-09-21 18:02:38.650 +01:00 [DBG] No information found on request to perform content negotiation.
2022-09-21 18:02:38.651 +01:00 [DBG] Attempting to select an output formatter without using a content type as no explicit content types were specified for the response.
2022-09-21 18:02:38.652 +01:00 [DBG] Attempting to select the first formatter in the output formatters list which can write the result.
2022-09-21 18:02:38.653 +01:00 [DBG] Selected output formatter 'Microsoft.AspNetCore.Mvc.Formatters.SystemTextJsonOutputFormatter' and content type 'application/json' to write the response.
2022-09-21 18:02:38.653 +01:00 [INF] Executing OkObjectResult, writing value of type '<>f__AnonymousType0`1[[System.String, System.Private.CoreLib, Version=6.0.0.0, Culture=neutral, PublicKeyToken=7cec85d7bea7798e]]'.
2022-09-21 18:02:38.655 +01:00 [INF] Executed action APIBank.Controllers.UsersController.RevokeToken (APIBank) in 99.7462ms
2022-09-21 18:02:38.656 +01:00 [INF] Executed endpoint 'APIBank.Controllers.UsersController.RevokeToken (APIBank)'
2022-09-21 18:02:38.656 +01:00 [DBG] 'PostgresContext' disposed.
2022-09-21 18:02:38.657 +01:00 [INF] Request finished HTTP/2 POST https://localhost:7036/api/Users/revoke-token application/json 17 - 200 - application/json;+charset=utf-8 257.5371ms
2022-09-21 18:04:49.083 +01:00 [DBG] Connection id "0HMKRUC2LFJIN" is closing.
2022-09-21 18:04:49.087 +01:00 [DBG] Connection id "0HMKRUC2LFJIN" is closed. The last processed stream ID was 11.
2022-09-21 18:04:49.089 +01:00 [DBG] Connection id "0HMKRUC2LFJIN" received FIN.
2022-09-21 18:04:49.092 +01:00 [DBG] Connection id "0HMKRUC2LFJIN" stopped.
2022-09-21 18:04:49.094 +01:00 [DBG] Connection id "0HMKRUC2LFJIN" sending FIN because: "The Socket transport's send loop completed gracefully."
